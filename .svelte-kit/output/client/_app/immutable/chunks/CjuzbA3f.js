import{s as Le,l as Te,i as B,n as De,d as p,I as on,q as hn,e as T,t as ke,k as Q,a4 as ia,c as V,a as S,b as Ee,o as x,a5 as aa,f as m,g as k,h as Ce,O as ul,M as it,u as Se,y as Ae,T as $e,A as Ge,j as re,p as Ot,C as tt,r as Qt,v as xt,w as $t,x as en,P as vn,D as _e,E as be,G as sn,V as Yn,J as $n,z as Eo,B as In,at as lt,W as Ut,X as vt,Y as zn,_ as gn,H as ln,a3 as de,a6 as Ul,au as ho,ap as ca,a2 as mo,ao as dt,a7 as yl,ar as ic,av as ac,as as cc,F as Es,$ as Is,Q as Ss,N as oo,m as uc}from"./Dc4_ziGv.js";import{S as Oe,i as He,t as C,g as Ve,a as H,c as ze,j as Ds,f as Xe,b as ee,d as le,m as te,e as ne,h as Ro}from"./CAZSMy3J.js";import{g as ua}from"./D0QH3NT1.js";import{e as ht,u as Io,o as So}from"./C6kX8Nm-.js";import{t as ct}from"./gLvYLTeg.js";import{C as fc,D as dc,F as hc,a as fa,b as mc,P as gc}from"./Dc_RRW4s.js";import{g as Uo}from"./RkzYe8eb.js";import{p as pc}from"./XbtbQPSN.js";import{b as Fl,a as Cs,P as Ms}from"./CisIfe-u.js";import{t as fl,u as Kn,c as Do,l as da,p as ha,k as ma,m as hl,a as Fn,d as rs,T as Qo,J as En,D as Zt,h as Co,K as Qn,C as Ln,W as ga,b as Jn,s as xo,A as _c,f as Ts,v as bc,w as gl,n as vc,E as so,B as wc,x as pl,j as yc}from"./DhUbH0v9.js";import{v as Hn,a as kc,B as Ec,C as Ic,D as Sc,E as Dc,F as Cc,G as Ll,H as Vs,t as Mc,b as bn,I as Tc,m as pa,n as Vc,h as go,d as zc,J as Nc,K as Pc,L as Oc}from"./DWuYzDxc.js";import{f as $o,C as zs,i as Hl,d as Hc,a as Ac,u as Ns}from"./BHQ31hte.js";import{h as Lc}from"./CgEzuEYe.js";import{p as Bc,h as Rc}from"./BrvI1VY2.js";import{h as Uc,i as Ps,j as Fc}from"./CT-9KHnD.js";import{p as Wc,q as jc,r as Yc,s as Kc,t as Gc}from"./CJ33GILj.js";import{g as is,j as Xc,k as Zc,l as qc}from"./Dcxv1G0C.js";import{f as Bl}from"./CduAUGNl.js";import{m as kl,p as Os}from"./_0_gBwjO.js";import{r as Jc,u as Hs}from"./DsszLngi.js";import{u as As,b as Ls}from"./pKnnkZ93.js";import"./CPKI64Ek.js";import{D as Mo,M as dn}from"./C16jRFgG.js";import{b as To}from"./DOIyYfji.js";import{f as ql}from"./g5t9vw8M.js";import{T as Ft}from"./Cj5D4_dy.js";import{S as Qc}from"./DI3yu46Z.js";import{W as xc}from"./BL51IiYw.js";import{V as $c,R as eu}from"./BHyjy2lL.js";import{g as tu}from"./CWaNF0lq.js";import{g as nu}from"./Czxj3Xk6.js";import{F as _a}from"./CU2r43ac.js";import{d as lu,r as ou}from"./Bi9B0bt2.js";import{S as Vo}from"./7Z-YgjJE.js";import{F as as}from"./BFv3ac4I.js";import{h as Tn,ba,bb as cs,bc as Fo,bd as Wo,ah as su,be as ru,bf as iu,af as va,bg as au}from"./DU_ylw5L.js";import{X as zo}from"./B9KCSGTn.js";import{G as cu}from"./EPCuDX70.js";import{K as uu,E as fu,M as du}from"./DfmjpK2E.js";import{M as hu,a as mu,b as gu,T as pu,S as _u,P as bu}from"./BnToFUap.js";import{S as vu}from"./C_QwKIUc.js";import{f as wu}from"./0n0hRmjK.js";import{a as yu}from"./CCZdU0IT.js";import{U as ku}from"./CjaVEhGW.js";import{M as Eu}from"./DlyqcGL7.js";import{M as Iu}from"./MKheDeAE.js";import{A as Su}from"./BTo1mJ7J.js";import{g as Du,j as Cu,k as Mu,l as Tu}from"./CFk3bLww.js";import{V as Vu,H as zu}from"./Bfu78tpJ.js";import{C as fo}from"./CDFoU-NH.js";import{s as Nu,t as Pu}from"./BtKK8PL-.js";import{D as Ou}from"./BCv4kF9c.js";import{w as xe,a as Mn,d as bl}from"./03rUxzUZ.js";import{g as xn,a as Wl}from"./CgU5AtxT.js";import{E as Hu}from"./B-W18FY2.js";import{C as Au}from"./DJpY-x4S.js";function Lu(l){let e;for(;e=l.sourceEvent;)l=e;return l}function An(l,e){if(l=Lu(l),e===void 0&&(e=l.currentTarget),e){var t=e.ownerSVGElement||e;if(t.createSVGPoint){var n=t.createSVGPoint();return n.x=l.clientX,n.y=l.clientY,n=n.matrixTransform(e.getScreenCTM().inverse()),[n.x,n.y]}if(e.getBoundingClientRect){var o=e.getBoundingClientRect();return[l.clientX-o.left-e.clientLeft,l.clientY-o.top-e.clientTop]}}return[l.pageX,l.pageY]}const Bu={passive:!1},jl={capture:!0,passive:!1};function jo(l){l.stopImmediatePropagation()}function vl(l){l.preventDefault(),l.stopImmediatePropagation()}function wa(l){var e=l.document.documentElement,t=Tn(l).on("dragstart.drag",vl,jl);"onselectstart"in e?t.on("selectstart.drag",vl,jl):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function ya(l,e){var t=l.document.documentElement,n=Tn(l).on("dragstart.drag",null);e&&(n.on("click.drag",vl,jl),setTimeout(function(){n.on("click.drag",null)},0)),"onselectstart"in t?n.on("selectstart.drag",null):(t.style.MozUserSelect=t.__noselect,delete t.__noselect)}const ro=l=>()=>l;function es(l,{sourceEvent:e,subject:t,target:n,identifier:o,active:s,x:i,y:r,dx:a,dy:c,dispatch:u}){Object.defineProperties(this,{type:{value:l,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},identifier:{value:o,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:i,enumerable:!0,configurable:!0},y:{value:r,enumerable:!0,configurable:!0},dx:{value:a,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:u}})}es.prototype.on=function(){var l=this._.on.apply(this._,arguments);return l===this._?this:l};function Ru(l){return!l.ctrlKey&&!l.button}function Uu(){return this.parentNode}function Fu(l,e){return e??{x:l.x,y:l.y}}function Wu(){return navigator.maxTouchPoints||"ontouchstart"in this}function ju(){var l=Ru,e=Uu,t=Fu,n=Wu,o={},s=ba("start","drag","end"),i=0,r,a,c,u,f=0;function d(E){E.on("mousedown.drag",h).filter(n).on("touchstart.drag",w).on("touchmove.drag",g,Bu).on("touchend.drag touchcancel.drag",v).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(E,z){if(!(u||!l.call(this,E,z))){var D=y(this,e.call(this,E,z),E,z,"mouse");D&&(Tn(E.view).on("mousemove.drag",_,jl).on("mouseup.drag",b,jl),wa(E.view),jo(E),c=!1,r=E.clientX,a=E.clientY,D("start",E))}}function _(E){if(vl(E),!c){var z=E.clientX-r,D=E.clientY-a;c=z*z+D*D>f}o.mouse("drag",E)}function b(E){Tn(E.view).on("mousemove.drag mouseup.drag",null),ya(E.view,c),vl(E),o.mouse("end",E)}function w(E,z){if(l.call(this,E,z)){var D=E.changedTouches,M=e.call(this,E,z),A=D.length,O,L;for(O=0;O<A;++O)(L=y(this,M,E,z,D[O].identifier,D[O]))&&(jo(E),L("start",E,D[O]))}}function g(E){var z=E.changedTouches,D=z.length,M,A;for(M=0;M<D;++M)(A=o[z[M].identifier])&&(vl(E),A("drag",E,z[M]))}function v(E){var z=E.changedTouches,D=z.length,M,A;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),M=0;M<D;++M)(A=o[z[M].identifier])&&(jo(E),A("end",E,z[M]))}function y(E,z,D,M,A,O){var L=s.copy(),W=An(O||D,z),K,R,I;if((I=t.call(E,new es("beforestart",{sourceEvent:D,target:d,identifier:A,active:i,x:W[0],y:W[1],dx:0,dy:0,dispatch:L}),M))!=null)return K=I.x-W[0]||0,R=I.y-W[1]||0,function P(N,Y,Z){var F=W,X;switch(N){case"start":o[A]=P,X=i++;break;case"end":delete o[A],--i;case"drag":W=An(Z||Y,z),X=i;break}L.call(N,E,new es(N,{sourceEvent:Y,subject:I,target:d,identifier:A,active:X,x:W[0]+K,y:W[1]+R,dx:W[0]-F[0],dy:W[1]-F[1],dispatch:L}),M)}}return d.filter=function(E){return arguments.length?(l=typeof E=="function"?E:ro(!!E),d):l},d.container=function(E){return arguments.length?(e=typeof E=="function"?E:ro(E),d):e},d.subject=function(E){return arguments.length?(t=typeof E=="function"?E:ro(E),d):t},d.touchable=function(E){return arguments.length?(n=typeof E=="function"?E:ro(!!E),d):n},d.on=function(){var E=s.on.apply(s,arguments);return E===s?d:E},d.clickDistance=function(E){return arguments.length?(f=(E=+E)*E,d):Math.sqrt(f)},d}var Yu=1e-12;function Bs(l){return((l=Math.exp(l))+1/l)/2}function Ku(l){return((l=Math.exp(l))-1/l)/2}function Gu(l){return((l=Math.exp(2*l))-1)/(l+1)}const Xu=function l(e,t,n){function o(s,i){var r=s[0],a=s[1],c=s[2],u=i[0],f=i[1],d=i[2],h=u-r,_=f-a,b=h*h+_*_,w,g;if(b<Yu)g=Math.log(d/c)/e,w=function(M){return[r+M*h,a+M*_,c*Math.exp(e*M*g)]};else{var v=Math.sqrt(b),y=(d*d-c*c+n*b)/(2*c*t*v),E=(d*d-c*c-n*b)/(2*d*t*v),z=Math.log(Math.sqrt(y*y+1)-y),D=Math.log(Math.sqrt(E*E+1)-E);g=(D-z)/e,w=function(M){var A=M*g,O=Bs(z),L=c/(t*v)*(O*Gu(e*A+z)-Ku(z));return[r+L*h,a+L*_,c*O/Bs(e*A+z)]}}return w.duration=g*1e3*e/Math.SQRT2,w}return o.rho=function(s){var i=Math.max(.001,+s),r=i*i,a=r*r;return l(i,r,a)},o}(Math.SQRT2,2,4),io=l=>()=>l;function Zu(l,{sourceEvent:e,target:t,transform:n,dispatch:o}){Object.defineProperties(this,{type:{value:l,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:t,enumerable:!0,configurable:!0},transform:{value:n,enumerable:!0,configurable:!0},_:{value:o}})}function Yo(l){l.stopImmediatePropagation()}function Al(l){l.preventDefault(),l.stopImmediatePropagation()}function qu(l){return(!l.ctrlKey||l.type==="wheel")&&!l.button}function Ju(){var l=this;return l instanceof SVGElement?(l=l.ownerSVGElement||l,l.hasAttribute("viewBox")?(l=l.viewBox.baseVal,[[l.x,l.y],[l.x+l.width,l.y+l.height]]):[[0,0],[l.width.baseVal.value,l.height.baseVal.value]]):[[0,0],[l.clientWidth,l.clientHeight]]}function Rs(){return this.__zoom||cs}function Qu(l){return-l.deltaY*(l.deltaMode===1?.05:l.deltaMode?1:.002)*(l.ctrlKey?10:1)}function xu(){return navigator.maxTouchPoints||"ontouchstart"in this}function $u(l,e,t){var n=l.invertX(e[0][0])-t[0][0],o=l.invertX(e[1][0])-t[1][0],s=l.invertY(e[0][1])-t[0][1],i=l.invertY(e[1][1])-t[1][1];return l.translate(o>n?(n+o)/2:Math.min(0,n)||Math.max(0,o),i>s?(s+i)/2:Math.min(0,s)||Math.max(0,i))}function ef(){var l=qu,e=Ju,t=$u,n=Qu,o=xu,s=[0,1/0],i=[[-1/0,-1/0],[1/0,1/0]],r=250,a=Xu,c=ba("start","zoom","end"),u,f,d,h=500,_=150,b=0,w=10;function g(I){I.property("__zoom",Rs).on("wheel.zoom",A,{passive:!1}).on("mousedown.zoom",O).on("dblclick.zoom",L).filter(o).on("touchstart.zoom",W).on("touchmove.zoom",K).on("touchend.zoom touchcancel.zoom",R).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}g.transform=function(I,P,N,Y){var Z=I.selection?I.selection():I;Z.property("__zoom",Rs),I!==Z?z(I,P,N,Y):Z.interrupt().each(function(){D(this,arguments).event(Y).start().zoom(null,typeof P=="function"?P.apply(this,arguments):P).end()})},g.scaleBy=function(I,P,N,Y){g.scaleTo(I,function(){var Z=this.__zoom.k,F=typeof P=="function"?P.apply(this,arguments):P;return Z*F},N,Y)},g.scaleTo=function(I,P,N,Y){g.transform(I,function(){var Z=e.apply(this,arguments),F=this.__zoom,X=N==null?E(Z):typeof N=="function"?N.apply(this,arguments):N,se=F.invert(X),q=typeof P=="function"?P.apply(this,arguments):P;return t(y(v(F,q),X,se),Z,i)},N,Y)},g.translateBy=function(I,P,N,Y){g.transform(I,function(){return t(this.__zoom.translate(typeof P=="function"?P.apply(this,arguments):P,typeof N=="function"?N.apply(this,arguments):N),e.apply(this,arguments),i)},null,Y)},g.translateTo=function(I,P,N,Y,Z){g.transform(I,function(){var F=e.apply(this,arguments),X=this.__zoom,se=Y==null?E(F):typeof Y=="function"?Y.apply(this,arguments):Y;return t(cs.translate(se[0],se[1]).scale(X.k).translate(typeof P=="function"?-P.apply(this,arguments):-P,typeof N=="function"?-N.apply(this,arguments):-N),F,i)},Y,Z)};function v(I,P){return P=Math.max(s[0],Math.min(s[1],P)),P===I.k?I:new Fo(P,I.x,I.y)}function y(I,P,N){var Y=P[0]-N[0]*I.k,Z=P[1]-N[1]*I.k;return Y===I.x&&Z===I.y?I:new Fo(I.k,Y,Z)}function E(I){return[(+I[0][0]+ +I[1][0])/2,(+I[0][1]+ +I[1][1])/2]}function z(I,P,N,Y){I.on("start.zoom",function(){D(this,arguments).event(Y).start()}).on("interrupt.zoom end.zoom",function(){D(this,arguments).event(Y).end()}).tween("zoom",function(){var Z=this,F=arguments,X=D(Z,F).event(Y),se=e.apply(Z,F),q=N==null?E(se):typeof N=="function"?N.apply(Z,F):N,G=Math.max(se[1][0]-se[0][0],se[1][1]-se[0][1]),oe=Z.__zoom,ae=typeof P=="function"?P.apply(Z,F):P,ve=a(oe.invert(q).concat(G/oe.k),ae.invert(q).concat(G/ae.k));return function($){if($===1)$=ae;else{var Ie=ve($),Ne=G/Ie[2];$=new Fo(Ne,q[0]-Ie[0]*Ne,q[1]-Ie[1]*Ne)}X.zoom(null,$)}})}function D(I,P,N){return!N&&I.__zooming||new M(I,P)}function M(I,P){this.that=I,this.args=P,this.active=0,this.sourceEvent=null,this.extent=e.apply(I,P),this.taps=0}M.prototype={event:function(I){return I&&(this.sourceEvent=I),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(I,P){return this.mouse&&I!=="mouse"&&(this.mouse[1]=P.invert(this.mouse[0])),this.touch0&&I!=="touch"&&(this.touch0[1]=P.invert(this.touch0[0])),this.touch1&&I!=="touch"&&(this.touch1[1]=P.invert(this.touch1[0])),this.that.__zoom=P,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(I){var P=Tn(this.that).datum();c.call(I,this.that,new Zu(I,{sourceEvent:this.sourceEvent,target:g,type:I,transform:this.that.__zoom,dispatch:c}),P)}};function A(I,...P){if(!l.apply(this,arguments))return;var N=D(this,P).event(I),Y=this.__zoom,Z=Math.max(s[0],Math.min(s[1],Y.k*Math.pow(2,n.apply(this,arguments)))),F=An(I);if(N.wheel)(N.mouse[0][0]!==F[0]||N.mouse[0][1]!==F[1])&&(N.mouse[1]=Y.invert(N.mouse[0]=F)),clearTimeout(N.wheel);else{if(Y.k===Z)return;N.mouse=[F,Y.invert(F)],Wo(this),N.start()}Al(I),N.wheel=setTimeout(X,_),N.zoom("mouse",t(y(v(Y,Z),N.mouse[0],N.mouse[1]),N.extent,i));function X(){N.wheel=null,N.end()}}function O(I,...P){if(d||!l.apply(this,arguments))return;var N=I.currentTarget,Y=D(this,P,!0).event(I),Z=Tn(I.view).on("mousemove.zoom",q,!0).on("mouseup.zoom",G,!0),F=An(I,N),X=I.clientX,se=I.clientY;wa(I.view),Yo(I),Y.mouse=[F,this.__zoom.invert(F)],Wo(this),Y.start();function q(oe){if(Al(oe),!Y.moved){var ae=oe.clientX-X,ve=oe.clientY-se;Y.moved=ae*ae+ve*ve>b}Y.event(oe).zoom("mouse",t(y(Y.that.__zoom,Y.mouse[0]=An(oe,N),Y.mouse[1]),Y.extent,i))}function G(oe){Z.on("mousemove.zoom mouseup.zoom",null),ya(oe.view,Y.moved),Al(oe),Y.event(oe).end()}}function L(I,...P){if(l.apply(this,arguments)){var N=this.__zoom,Y=An(I.changedTouches?I.changedTouches[0]:I,this),Z=N.invert(Y),F=N.k*(I.shiftKey?.5:2),X=t(y(v(N,F),Y,Z),e.apply(this,P),i);Al(I),r>0?Tn(this).transition().duration(r).call(z,X,Y,I):Tn(this).call(g.transform,X,Y,I)}}function W(I,...P){if(l.apply(this,arguments)){var N=I.touches,Y=N.length,Z=D(this,P,I.changedTouches.length===Y).event(I),F,X,se,q;for(Yo(I),X=0;X<Y;++X)se=N[X],q=An(se,this),q=[q,this.__zoom.invert(q),se.identifier],Z.touch0?!Z.touch1&&Z.touch0[2]!==q[2]&&(Z.touch1=q,Z.taps=0):(Z.touch0=q,F=!0,Z.taps=1+!!u);u&&(u=clearTimeout(u)),F&&(Z.taps<2&&(f=q[0],u=setTimeout(function(){u=null},h)),Wo(this),Z.start())}}function K(I,...P){if(this.__zooming){var N=D(this,P).event(I),Y=I.changedTouches,Z=Y.length,F,X,se,q;for(Al(I),F=0;F<Z;++F)X=Y[F],se=An(X,this),N.touch0&&N.touch0[2]===X.identifier?N.touch0[0]=se:N.touch1&&N.touch1[2]===X.identifier&&(N.touch1[0]=se);if(X=N.that.__zoom,N.touch1){var G=N.touch0[0],oe=N.touch0[1],ae=N.touch1[0],ve=N.touch1[1],$=($=ae[0]-G[0])*$+($=ae[1]-G[1])*$,Ie=(Ie=ve[0]-oe[0])*Ie+(Ie=ve[1]-oe[1])*Ie;X=v(X,Math.sqrt($/Ie)),se=[(G[0]+ae[0])/2,(G[1]+ae[1])/2],q=[(oe[0]+ve[0])/2,(oe[1]+ve[1])/2]}else if(N.touch0)se=N.touch0[0],q=N.touch0[1];else return;N.zoom("touch",t(y(X,se,q),N.extent,i))}}function R(I,...P){if(this.__zooming){var N=D(this,P).event(I),Y=I.changedTouches,Z=Y.length,F,X;for(Yo(I),d&&clearTimeout(d),d=setTimeout(function(){d=null},h),F=0;F<Z;++F)X=Y[F],N.touch0&&N.touch0[2]===X.identifier?delete N.touch0:N.touch1&&N.touch1[2]===X.identifier&&delete N.touch1;if(N.touch1&&!N.touch0&&(N.touch0=N.touch1,delete N.touch1),N.touch0)N.touch0[1]=this.__zoom.invert(N.touch0[0]);else if(N.end(),N.taps===2&&(X=An(X,this),Math.hypot(f[0]-X[0],f[1]-X[1])<w)){var se=Tn(this).on("dblclick.zoom");se&&se.apply(this,arguments)}}}return g.wheelDelta=function(I){return arguments.length?(n=typeof I=="function"?I:io(+I),g):n},g.filter=function(I){return arguments.length?(l=typeof I=="function"?I:io(!!I),g):l},g.touchable=function(I){return arguments.length?(o=typeof I=="function"?I:io(!!I),g):o},g.extent=function(I){return arguments.length?(e=typeof I=="function"?I:io([[+I[0][0],+I[0][1]],[+I[1][0],+I[1][1]]]),g):e},g.scaleExtent=function(I){return arguments.length?(s[0]=+I[0],s[1]=+I[1],g):[s[0],s[1]]},g.translateExtent=function(I){return arguments.length?(i[0][0]=+I[0][0],i[1][0]=+I[1][0],i[0][1]=+I[0][1],i[1][1]=+I[1][1],g):[[i[0][0],i[0][1]],[i[1][0],i[1][1]]]},g.constrain=function(I){return arguments.length?(t=I,g):t},g.duration=function(I){return arguments.length?(r=+I,g):r},g.interpolate=function(I){return arguments.length?(a=I,g):a},g.on=function(){var I=c.on.apply(c,arguments);return I===c?g:I},g.clickDistance=function(I){return arguments.length?(b=(I=+I)*I,g):Math.sqrt(b)},g.tapDistance=function(I){return arguments.length?(w=+I,g):w},g}function tf(l){let e,t,n,o,s,i,r;return a(),{feed:c,reset:a};function a(){e=!0,t="",n=0,o=-1,s=void 0,i=void 0,r=""}function c(f){t=t?t+f:f,e&&nf(t)&&(t=t.slice(ka.length)),e=!1;const d=t.length;let h=0,_=!1;for(;h<d;){_&&(t[h]===`
`&&++h,_=!1);let b=-1,w=o,g;for(let v=n;b<0&&v<d;++v)g=t[v],g===":"&&w<0?w=v-h:g==="\r"?(_=!0,b=v-h):g===`
`&&(b=v-h);if(b<0){n=d-h,o=w;break}else n=0,o=-1;u(t,h,w,b),h+=b+1}h===d?t="":h>0&&(t=t.slice(h))}function u(f,d,h,_){if(_===0){r.length>0&&(l({type:"event",id:s,event:i||void 0,data:r.slice(0,-1)}),r="",s=void 0),i=void 0;return}const b=h<0,w=f.slice(d,d+(b?_:h));let g=0;b?g=_:f[d+h+1]===" "?g=h+2:g=h+1;const v=d+g,y=_-g,E=f.slice(v,v+y).toString();if(w==="data")r+=E?"".concat(E,`
`):`
`;else if(w==="event")i=E;else if(w==="id"&&!E.includes("\0"))s=E;else if(w==="retry"){const z=parseInt(E,10);Number.isNaN(z)||l({type:"reconnect-interval",value:z})}}}const ka=[239,187,191];function nf(l){return ka.every((e,t)=>l.charCodeAt(t)===e)}class lf extends TransformStream{constructor(){let e;super({start(t){e=tf(n=>{n.type==="event"&&t.enqueue(n)})},transform(t){e.feed(t)}})}}async function of(l,e){const t=l.pipeThrough(new TextDecoderStream).pipeThrough(new lf).getReader();let n=sf(t);return e&&(n=rf(n)),n}async function*sf(l){var e,t,n;for(;;){const{value:o,done:s}=await l.read();if(s){yield{done:!0,value:""};break}if(!o)continue;const i=o.data;if(i.startsWith("[DONE]")){yield{done:!0,value:""};break}try{const r=JSON.parse(i);if(console.log(r),r.error){yield{done:!0,value:"",error:r.error};break}if(r.sources){yield{done:!1,value:"",sources:r.sources};continue}if(r.selected_model_id){yield{done:!1,value:"",selectedModelId:r.selected_model_id};continue}if(r.usage){yield{done:!1,value:"",usage:r.usage};continue}yield{done:!1,value:((n=(t=(e=r.choices)==null?void 0:e[0])==null?void 0:t.delta)==null?void 0:n.content)??""}}catch(r){console.error("Error extracting delta from SSE event:",r)}}}async function*rf(l){for await(const e of l){if(e.done){yield e;return}if(e.error){yield e;continue}if(e.sources){yield e;continue}if(e.selectedModelId){yield e;continue}if(e.usage){yield e;continue}let t=e.value;if(t.length<5){yield{done:!1,value:t};continue}for(;t!="";){const n=Math.min(Math.floor(Math.random()*3)+1,t.length);yield{done:!1,value:t.slice(0,n)},(document==null?void 0:document.visibilityState)!=="hidden"&&await af(5),t=t.slice(n)}}}const af=l=>new Promise(e=>setTimeout(e,l));function Us(l){let e,t=l[2]&&Fs(l);return{c(){t&&t.c(),e=Te()},l(n){t&&t.l(n),e=Te()},m(n,o){t&&t.m(n,o),B(n,e,o)},p(n,o){n[2]?t?(t.p(n,o),o&4&&C(t,1)):(t=Fs(n),t.c(),C(t,1),t.m(e.parentNode,e)):t&&(Ve(),H(t,1,1,()=>{t=null}),ze())},d(n){n&&p(e),t&&t.d(n)}}}function Fs(l){let e,t,n,o,s=l[1].type+"",i,r,a,c,u,f,d=kl.parse(Os.sanitize(l[1].content))+"",h,_,b,w,g,v=l[1].url&&Ws(),y=l[1].url&&js(),E=l[1].dismissible&&Ys(l);return{c(){e=T("div"),t=T("div"),n=T("div"),o=T("div"),i=ke(s),a=Q(),v&&v.c(),c=Q(),u=T("div"),f=new ia(!1),h=Q(),y&&y.c(),_=Q(),b=T("div"),E&&E.c(),this.h()},l(z){e=V(z,"DIV",{class:!0});var D=S(e);t=V(D,"DIV",{class:!0});var M=S(t);n=V(M,"DIV",{class:!0});var A=S(n);o=V(A,"DIV",{class:!0});var O=S(o);i=Ee(O,s),O.forEach(p),a=x(A),v&&v.l(A),A.forEach(p),c=x(M),u=V(M,"DIV",{class:!0});var L=S(u);f=aa(L,!1),L.forEach(p),M.forEach(p),h=x(D),y&&y.l(D),_=x(D),b=V(D,"DIV",{class:!0});var W=S(b);E&&E.l(W),W.forEach(p),D.forEach(p),this.h()},h(){m(o,"class",r="text-xs font-bold "+(l[3][l[1].type]??l[3].info)+" w-fit px-2 rounded-sm uppercase line-clamp-1 mr-0.5"),m(n,"class","flex justify-between self-start"),f.a=null,m(u,"class","flex-1 text-xs text-gray-700 dark:text-white"),m(t,"class","flex flex-col md:flex-row md:items-center flex-1 text-sm w-fit gap-1.5"),m(b,"class","flex self-start"),m(e,"class","top-0 left-0 right-0 p-2 mx-4 px-3 flex justify-center items-center relative rounded-xl border border-gray-100 dark:border-gray-850 text-gray-800 dark:text-gary-100 bg-white dark:bg-gray-900 backdrop-blur-xl z-30")},m(z,D){B(z,e,D),k(e,t),k(t,n),k(n,o),k(o,i),k(n,a),v&&v.m(n,null),k(t,c),k(t,u),f.m(d,u),k(e,h),y&&y.m(e,null),k(e,_),k(e,b),E&&E.m(b,null),g=!0},p(z,D){(!g||D&2)&&s!==(s=z[1].type+"")&&Ce(i,s),(!g||D&2&&r!==(r="text-xs font-bold "+(z[3][z[1].type]??z[3].info)+" w-fit px-2 rounded-sm uppercase line-clamp-1 mr-0.5"))&&m(o,"class",r),z[1].url?v||(v=Ws(),v.c(),v.m(n,null)):v&&(v.d(1),v=null),(!g||D&2)&&d!==(d=kl.parse(Os.sanitize(z[1].content))+"")&&f.p(d),z[1].url?y||(y=js(),y.c(),y.m(e,_)):y&&(y.d(1),y=null),z[1].dismissible?E?E.p(z,D):(E=Ys(z),E.c(),E.m(b,null)):E&&(E.d(1),E=null)},i(z){g||(z&&ul(()=>{g&&(w||(w=Ds(e,Bl,{delay:100,duration:300},!0)),w.run(1))}),g=!0)},o(z){z&&(w||(w=Ds(e,Bl,{delay:100,duration:300},!1)),w.run(0)),g=!1},d(z){z&&p(e),v&&v.d(),y&&y.d(),E&&E.d(),z&&w&&w.end()}}}function Ws(l){let e,t='<a class="text-gray-700 dark:text-white text-xs font-semibold underline" href="/assets/files/whitepaper.pdf" target="_blank">Learn More</a> <div class="ml-1 text-gray-400 group-hover:text-gray-600 dark:group-hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="w-4 h-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg></div>';return{c(){e=T("div"),e.innerHTML=t,this.h()},l(n){e=V(n,"DIV",{class:!0,"data-svelte-h":!0}),it(e)!=="svelte-o2pz5m"&&(e.innerHTML=t),this.h()},h(){m(e,"class","flex md:hidden group w-fit md:items-center")},m(n,o){B(n,e,o)},d(n){n&&p(e)}}}function js(l){let e,t='<a class="text-gray-700 dark:text-white text-xs font-semibold underline" href="/" target="_blank">Learn More</a> <div class="ml-1 text-gray-400 group-hover:text-gray-600 dark:group-hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg></div>';return{c(){e=T("div"),e.innerHTML=t,this.h()},l(n){e=V(n,"DIV",{class:!0,"data-svelte-h":!0}),it(e)!=="svelte-1wr7se3"&&(e.innerHTML=t),this.h()},h(){m(e,"class","hidden md:flex group w-fit md:items-center")},m(n,o){B(n,e,o)},d(n){n&&p(e)}}}function Ys(l){let e,t="Ã—",n,o;return{c(){e=T("button"),e.textContent=t,this.h()},l(s){e=V(s,"BUTTON",{class:!0,"data-svelte-h":!0}),it(e)!=="svelte-o8kh4p"&&(e.textContent=t),this.h()},h(){m(e,"class","-mt-1 -mb-2 -translate-y-[1px] ml-1.5 mr-1 text-gray-400 dark:hover:text-white")},m(s,i){B(s,e,i),n||(o=Se(e,"click",l[5]),n=!0)},p:De,d(s){s&&p(e),n=!1,o()}}}function cf(l){let e,t=!l[0]&&Us(l);return{c(){t&&t.c(),e=Te()},l(n){t&&t.l(n),e=Te()},m(n,o){t&&t.m(n,o),B(n,e,o)},p(n,[o]){n[0]?t&&(t.d(1),t=null):t?t.p(n,o):(t=Us(n),t.c(),t.m(e.parentNode,e))},i:De,o:De,d(n){n&&p(e),t&&t.d(n)}}}function uf(l,e,t){const n=on();let{banner:o={id:"",type:"info",title:"",content:"",url:"",dismissable:!0,timestamp:Math.floor(Date.now()/1e3)}}=e,{dismissed:s=!1}=e,i=!1;const r={info:"bg-blue-500/20 text-blue-700 dark:text-blue-200 ",success:"bg-green-500/20 text-green-700 dark:text-green-200",warning:"bg-yellow-500/20 text-yellow-700 dark:text-yellow-200",error:"bg-red-500/20 text-red-700 dark:text-red-200"},a=u=>{t(0,s=!0),n("dismiss",u)};hn(()=>{t(2,i=!0)});const c=()=>{a(o.id)};return l.$$set=u=>{"banner"in u&&t(1,o=u.banner),"dismissed"in u&&t(0,s=u.dismissed)},[s,o,i,r,a,c]}class ff extends Oe{constructor(e){super(),He(this,e,uf,cf,Le,{banner:1,dismissed:0})}}let Yl="",Kl="";async function df(){var t,n;const l=await fetch("/api/config");if(!l.ok)throw new Error("Failed to fetch Google Drive credentials");const e=await l.json();if(Yl=(t=e.google_drive)==null?void 0:t.api_key,Kl=(n=e.google_drive)==null?void 0:n.client_id,!Yl||!Kl)throw new Error("Google Drive API credentials not configured")}const hf=["https://www.googleapis.com/auth/drive.readonly","https://www.googleapis.com/auth/drive.file"],mf=()=>{if(!Yl||!Kl)throw new Error("Google Drive API credentials not configured");if(Yl===""||Kl==="")throw new Error("Please configure valid Google Drive API credentials")};let ao=null,Ks=!1;const gf=()=>new Promise((l,e)=>{if(typeof gapi>"u"){const t=document.createElement("script");t.src="https://apis.google.com/js/api.js",t.onload=()=>{gapi.load("picker",()=>{l(!0)})},t.onerror=e,document.body.appendChild(t)}else gapi.load("picker",()=>{l(!0)})}),pf=()=>new Promise((l,e)=>{if(typeof google>"u"){const t=document.createElement("script");t.src="https://accounts.google.com/gsi/client",t.onload=l,t.onerror=e,document.body.appendChild(t)}else l(!0)}),_f=async()=>ao||new Promise((l,e)=>{google.accounts.oauth2.initTokenClient({client_id:Kl,scope:hf.join(" "),callback:n=>{n.access_token?(ao=n.access_token,l(ao)):e(new Error("Failed to get access token"))},error_callback:n=>{e(new Error(n.message||"OAuth error occurred"))}}).requestAccessToken()}),bf=async()=>{Ks||(await df(),mf(),await Promise.all([gf(),pf()]),Ks=!0)},vf=()=>new Promise(async(l,e)=>{try{console.log("Initializing Google Drive Picker..."),await bf(),console.log("Getting auth token...");const t=await _f();if(!t)throw console.error("Failed to get OAuth token"),new Error("Unable to get OAuth token");console.log("Auth token obtained successfully"),new google.picker.PickerBuilder().enableFeature(google.picker.Feature.NAV_HIDDEN).enableFeature(google.picker.Feature.MULTISELECT_ENABLED).addView(new google.picker.DocsView().setIncludeFolders(!1).setSelectFolderEnabled(!1).setMimeTypes("application/pdf,text/plain,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.google-apps.document,application/vnd.google-apps.spreadsheet,application/vnd.google-apps.presentation")).setOAuthToken(t).setDeveloperKey(Yl).setCallback(async o=>{if(o[google.picker.Response.ACTION]===google.picker.Action.PICKED)try{const s=o[google.picker.Response.DOCUMENTS][0],i=s[google.picker.Document.ID],r=s[google.picker.Document.NAME],a=s[google.picker.Document.URL];if(!i||!r)throw new Error("Required file details missing");const c=s[google.picker.Document.MIME_TYPE];let u,f;c.includes("google-apps")?(c.includes("document")?f="text/plain":c.includes("spreadsheet")?f="text/csv":c.includes("presentation")?f="text/plain":f="application/pdf",u=`https://www.googleapis.com/drive/v3/files/${i}/export?mimeType=${encodeURIComponent(f)}`):u=`https://www.googleapis.com/drive/v3/files/${i}?alt=media`;const d=await fetch(u,{headers:{Authorization:`Bearer ${t}`,Accept:"*/*"}});if(!d.ok){const b=await d.text();throw console.error("Download failed:",{status:d.status,statusText:d.statusText,error:b}),new Error(`Failed to download file (${d.status}): ${b}`)}const h=await d.blob(),_={id:i,name:r,url:u,blob:h,headers:{Authorization:`Bearer ${t}`,Accept:"*/*"}};l(_)}catch(s){e(s)}else o[google.picker.Response.ACTION]===google.picker.Action.CANCEL&&l(null)}).build().setVisible(!0)}catch(t){console.error("Google Drive Picker error:",t),e(t)}});let Rl="";async function wf(){var t;if(Rl)return;const l=await fetch("/api/config");if(!l.ok)throw new Error("Failed to fetch OneDrive credentials");if(Rl=(t=(await l.json()).onedrive)==null?void 0:t.client_id,!Rl)throw new Error("OneDrive client ID not configured")}function yf(){return new Promise((l,e)=>{if(window.msal){l();return}const n=document.createElement("script");n.src="https://alcdn.msauth.net/browser/2.19.0/js/msal-browser.min.js",n.async=!0,n.onload=()=>l(),n.onerror=()=>e(new Error("Failed to load MSAL script")),document.head.appendChild(n)})}let cl;async function kf(){Rl||await wf();const l={auth:{authority:"https://login.microsoftonline.com/consumers",clientId:Rl}};try{await yf();const e=window;cl=new e.msal.PublicClientApplication(l),cl.initialize&&await cl.initialize()}catch(e){console.error("MSAL initialization error:",e)}}async function ts(){const l={scopes:["OneDrive.ReadWrite"]};let e="";try{await kf(),e=(await cl.acquireTokenSilent(l)).accessToken}catch{const n=await cl.loginPopup(l);cl.setActiveAccount(n.account),n.idToken&&(e=(await cl.acquireTokenSilent(l)).accessToken)}return e}const Ef="https://onedrive.live.com/picker";var ra;const Gs={sdk:"8.0",entry:{oneDrive:{files:{}}},authentication:{},messaging:{origin:(ra=window==null?void 0:window.location)==null?void 0:ra.origin,channelId:Hn()},typesAndSources:{mode:"files",pivots:{oneDrive:!0,recent:!0}}};async function If(l){const e=await ts();if(!e)throw new Error("Unable to retrieve OneDrive access token.");const t=`${l["@sharePoint.endpoint"]}/drives/${l.parentReference.driveId}/items/${l.id}`,n=await fetch(t,{headers:{Authorization:`Bearer ${e}`}});if(!n.ok)throw new Error("Failed to fetch file information.");const s=(await n.json())["@content.downloadUrl"],i=await fetch(s);if(!i.ok)throw new Error("Failed to download file.");return await i.blob()}async function Sf(){if(typeof window>"u")throw new Error("Not in browser environment");return new Promise((l,e)=>{let t=null,n=null;const o=a=>{var u;if(a.source!==t)return;const c=a.data;if((c==null?void 0:c.type)==="initialize"&&(c==null?void 0:c.channelId)===Gs.messaging.channelId){if(n=(u=a.ports)==null?void 0:u[0],!n)return;n.addEventListener("message",s),n.start(),n.postMessage({type:"activate"})}},s=async a=>{const c=a.data;switch(c.type){case"notification":break;case"command":{n==null||n.postMessage({type:"acknowledge",id:c.id});const u=c.data;switch(u.command){case"authenticate":{try{const f=await ts();if(f)n==null||n.postMessage({type:"result",id:c.id,data:{result:"token",token:f}});else throw new Error("Could not retrieve auth token")}catch(f){console.error(f),n==null||n.postMessage({result:"error",error:{code:"tokenError",message:"Failed to get token"},isExpected:!0})}break}case"close":{i(),l(null);break}case"pick":{n==null||n.postMessage({type:"result",id:c.id,data:{result:"success"}}),i(),l(u);break}default:{console.warn("Unsupported command:",u),n==null||n.postMessage({result:"error",error:{code:"unsupportedCommand",message:u.command},isExpected:!0});break}}break}}};function i(){window.removeEventListener("message",o),n&&n.removeEventListener("message",s),t&&(t.close(),t=null)}(async()=>{try{const a=await ts();if(!a)return e(new Error("Failed to acquire access token"));if(t=window.open("","OneDrivePicker","width=800,height=600"),!t)return e(new Error("Failed to open OneDrive picker window"));const c=new URLSearchParams({filePicker:JSON.stringify(Gs)}),u=`${Ef}?${c.toString()}`,f=t.document.createElement("form");f.setAttribute("action",u),f.setAttribute("method","POST");const d=t.document.createElement("input");d.setAttribute("type","hidden"),d.setAttribute("name","access_token"),d.setAttribute("value",a),f.appendChild(d),t.document.body.appendChild(f),f.submit(),window.addEventListener("message",o)}catch(a){t&&t.close(),e(a)}})()})}async function Df(){try{const l=await Sf();if(!l||!l.items||l.items.length===0)return null;const e=l.items[0];return{blob:await If(e),name:e.name}}catch(l){throw console.error("Error occurred during OneDrive file pick/download:",l),l}}function Xs(l,e,t){const n=l.slice();return n[28]=e[t],n}function Cf(l){let e;const t=l[16].default,n=Qt(t,l,l[25],null);return{c(){n&&n.c()},l(o){n&&n.l(o)},m(o,s){n&&n.m(o,s),e=!0},p(o,s){n&&n.p&&(!e||s&33554432)&&xt(n,t,o,o[25],e?en(t,o[25],s,null):$t(o[25]),null)},i(o){e||(C(n,o),e=!0)},o(o){H(n,o),e=!1},d(o){n&&n.d(o)}}}function Mf(l){let e,t;return e=new Ft({props:{content:l[9].t("More"),$$slots:{default:[Cf]},$$scope:{ctx:l}}}),{c(){ee(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,o){te(e,n,o),t=!0},p(n,o){const s={};o&512&&(s.content=n[9].t("More")),o&33554432&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}function Zs(l){let e,t,n,o,s=ht(Object.keys(l[7])),i=[];for(let a=0;a<s.length;a+=1)i[a]=qs(Xs(l,s,a));const r=a=>H(i[a],1,1,()=>{i[a]=null});return{c(){e=T("div");for(let a=0;a<i.length;a+=1)i[a].c();t=Q(),n=T("hr"),this.h()},l(a){e=V(a,"DIV",{class:!0});var c=S(e);for(let u=0;u<i.length;u+=1)i[u].l(c);c.forEach(p),t=x(a),n=V(a,"HR",{class:!0}),this.h()},h(){m(e,"class","max-h-28 overflow-y-auto scrollbar-hidden"),m(n,"class","border-black/5 dark:border-white/5 my-1")},m(a,c){B(a,e,c);for(let u=0;u<i.length;u+=1)i[u]&&i[u].m(e,null);B(a,t,c),B(a,n,c),o=!0},p(a,c){if(c&129){s=ht(Object.keys(a[7]));let u;for(u=0;u<s.length;u+=1){const f=Xs(a,s,u);i[u]?(i[u].p(f,c),C(i[u],1)):(i[u]=qs(f),i[u].c(),C(i[u],1),i[u].m(e,null))}for(Ve(),u=s.length;u<i.length;u+=1)r(u);ze()}},i(a){if(!o){for(let c=0;c<s.length;c+=1)C(i[c]);o=!0}},o(a){i=i.filter(Boolean);for(let c=0;c<i.length;c+=1)H(i[c]);o=!1},d(a){a&&(p(e),p(t),p(n)),vn(i,a)}}}function Tf(l){let e,t,n,o,s=l[7][l[28]].name+"",i,r;return t=new xc({}),{c(){e=T("div"),ee(t.$$.fragment),n=Q(),o=T("div"),i=ke(s),this.h()},l(a){e=V(a,"DIV",{class:!0});var c=S(e);le(t.$$.fragment,c),c.forEach(p),n=x(a),o=V(a,"DIV",{class:!0});var u=S(o);i=Ee(u,s),u.forEach(p),this.h()},h(){m(e,"class","shrink-0"),m(o,"class","truncate")},m(a,c){B(a,e,c),te(t,e,null),B(a,n,c),B(a,o,c),k(o,i),r=!0},p(a,c){(!r||c&128)&&s!==(s=a[7][a[28]].name+"")&&Ce(i,s)},i(a){r||(C(t.$$.fragment,a),r=!0)},o(a){H(t.$$.fragment,a),r=!1},d(a){a&&(p(e),p(n),p(o)),ne(t)}}}function qs(l){var h;let e,t,n,o,s,i,r,a,c,u;n=new Ft({props:{content:((h=l[7][l[28]])==null?void 0:h.description)??"",placement:"top-start",className:"flex flex-1 gap-2 items-center",$$slots:{default:[Tf]},$$scope:{ctx:l}}});function f(..._){return l[17](l[28],..._)}i=new Qc({props:{state:l[7][l[28]].enabled}}),i.$on("change",f);function d(){return l[18](l[28])}return{c(){e=T("button"),t=T("div"),ee(n.$$.fragment),o=Q(),s=T("div"),ee(i.$$.fragment),r=Q(),this.h()},l(_){e=V(_,"BUTTON",{class:!0});var b=S(e);t=V(b,"DIV",{class:!0});var w=S(t);le(n.$$.fragment,w),w.forEach(p),o=x(b),s=V(b,"DIV",{class:!0});var g=S(s);le(i.$$.fragment,g),g.forEach(p),r=x(b),b.forEach(p),this.h()},h(){m(t,"class","flex-1 truncate"),m(s,"class","shrink-0"),m(e,"class","flex w-full justify-between gap-2 items-center px-3 py-2 text-sm font-medium cursor-pointer rounded-xl")},m(_,b){B(_,e,b),k(e,t),te(n,t,null),k(e,o),k(e,s),te(i,s,null),k(e,r),a=!0,c||(u=Se(e,"click",d),c=!0)},p(_,b){var v;l=_;const w={};b&128&&(w.content=((v=l[7][l[28]])==null?void 0:v.description)??""),b&33554560&&(w.$$scope={dirty:b,ctx:l}),n.$set(w);const g={};b&128&&(g.state=l[7][l[28]].enabled),i.$set(g)},i(_){a||(C(n.$$.fragment,_),C(i.$$.fragment,_),a=!0)},o(_){H(n.$$.fragment,_),H(i.$$.fragment,_),a=!1},d(_){_&&p(e),ne(n),ne(i),c=!1,u()}}}function Vf(l){let e,t,n,o=l[9].t("Capture")+"",s,i;return e=new fc({}),{c(){ee(e.$$.fragment),t=Q(),n=T("div"),s=ke(o),this.h()},l(r){le(e.$$.fragment,r),t=x(r),n=V(r,"DIV",{class:!0});var a=S(n);s=Ee(a,o),a.forEach(p),this.h()},h(){m(n,"class","line-clamp-1")},m(r,a){te(e,r,a),B(r,t,a),B(r,n,a),k(n,s),i=!0},p(r,a){(!i||a&512)&&o!==(o=r[9].t("Capture")+"")&&Ce(s,o)},i(r){i||(C(e.$$.fragment,r),i=!0)},o(r){H(e.$$.fragment,r),i=!1},d(r){r&&(p(t),p(n)),ne(e,r)}}}function zf(l){let e,t;return e=new dn({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800  rounded-xl "+(l[8]?"":"opacity-50"),$$slots:{default:[Vf]},$$scope:{ctx:l}}}),e.$on("click",l[19]),{c(){ee(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,o){te(e,n,o),t=!0},p(n,o){const s={};o&256&&(s.class="flex gap-2 items-center px-3 py-2 text-sm  font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800  rounded-xl "+(n[8]?"":"opacity-50")),o&33554944&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}function Nf(l){let e,t,n,o=l[9].t("Upload Files")+"",s,i;return e=new dc({}),{c(){ee(e.$$.fragment),t=Q(),n=T("div"),s=ke(o),this.h()},l(r){le(e.$$.fragment,r),t=x(r),n=V(r,"DIV",{class:!0});var a=S(n);s=Ee(a,o),a.forEach(p),this.h()},h(){m(n,"class","line-clamp-1")},m(r,a){te(e,r,a),B(r,t,a),B(r,n,a),k(n,s),i=!0},p(r,a){(!i||a&512)&&o!==(o=r[9].t("Upload Files")+"")&&Ce(s,o)},i(r){i||(C(e.$$.fragment,r),i=!0)},o(r){H(e.$$.fragment,r),i=!1},d(r){r&&(p(t),p(n)),ne(e,r)}}}function Pf(l){let e,t;return e=new dn({props:{class:"flex gap-2 items-center px-3 py-2 text-sm font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl "+(l[8]?"":"opacity-50"),$$slots:{default:[Nf]},$$scope:{ctx:l}}}),e.$on("click",l[20]),{c(){ee(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,o){te(e,n,o),t=!0},p(n,o){const s={};o&256&&(s.class="flex gap-2 items-center px-3 py-2 text-sm font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl "+(n[8]?"":"opacity-50")),o&33554944&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}function Js(l){let e,t;return e=new dn({props:{class:"flex gap-2 items-center px-3 py-2 text-sm font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl",$$slots:{default:[Of]},$$scope:{ctx:l}}}),e.$on("click",l[21]),{c(){ee(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,o){te(e,n,o),t=!0},p(n,o){const s={};o&33554944&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}function Of(l){let e,t,n,o,s,i,r,a,c,u=l[9].t("Google Drive")+"",f;return{c(){e=_e("svg"),t=_e("path"),n=_e("path"),o=_e("path"),s=_e("path"),i=_e("path"),r=_e("path"),a=Q(),c=T("div"),f=ke(u),this.h()},l(d){e=be(d,"svg",{xmlns:!0,viewBox:!0,class:!0});var h=S(e);t=be(h,"path",{d:!0,fill:!0}),S(t).forEach(p),n=be(h,"path",{d:!0,fill:!0}),S(n).forEach(p),o=be(h,"path",{d:!0,fill:!0}),S(o).forEach(p),s=be(h,"path",{d:!0,fill:!0}),S(s).forEach(p),i=be(h,"path",{d:!0,fill:!0}),S(i).forEach(p),r=be(h,"path",{d:!0,fill:!0}),S(r).forEach(p),h.forEach(p),a=x(d),c=V(d,"DIV",{class:!0});var _=S(c);f=Ee(_,u),_.forEach(p),this.h()},h(){m(t,"d","m6.6 66.85 3.85 6.65c.8 1.4 1.95 2.5 3.3 3.3l13.75-23.8h-27.5c0 1.55.4 3.1 1.2 4.5z"),m(t,"fill","#0066da"),m(n,"d","m43.65 25-13.75-23.8c-1.35.8-2.5 1.9-3.3 3.3l-25.4 44a9.06 9.06 0 0 0 -1.2 4.5h27.5z"),m(n,"fill","#00ac47"),m(o,"d","m73.55 76.8c1.35-.8 2.5-1.9 3.3-3.3l1.6-2.75 7.65-13.25c.8-1.4 1.2-2.95 1.2-4.5h-27.502l5.852 11.5z"),m(o,"fill","#ea4335"),m(s,"d","m43.65 25 13.75-23.8c-1.35-.8-2.9-1.2-4.5-1.2h-18.5c-1.6 0-3.15.45-4.5 1.2z"),m(s,"fill","#00832d"),m(i,"d","m59.8 53h-32.3l-13.75 23.8c1.35.8 2.9 1.2 4.5 1.2h50.8c1.6 0 3.15-.45 4.5-1.2z"),m(i,"fill","#2684fc"),m(r,"d","m73.4 26.5-12.7-22c-.8-1.4-1.95-2.5-3.3-3.3l-13.75 23.8 16.15 28h27.45c0-1.55-.4-3.1-1.2-4.5z"),m(r,"fill","#ffba00"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"viewBox","0 0 87.3 78"),m(e,"class","w-5 h-5"),m(c,"class","line-clamp-1")},m(d,h){B(d,e,h),k(e,t),k(e,n),k(e,o),k(e,s),k(e,i),k(e,r),B(d,a,h),B(d,c,h),k(c,f)},p(d,h){h&512&&u!==(u=d[9].t("Google Drive")+"")&&Ce(f,u)},d(d){d&&(p(e),p(a),p(c))}}}function Qs(l){let e,t;return e=new dn({props:{class:"flex gap-2 items-center px-3 py-2 text-sm font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl",$$slots:{default:[Hf]},$$scope:{ctx:l}}}),e.$on("click",l[22]),{c(){ee(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,o){te(e,n,o),t=!0},p(n,o){const s={};o&33554944&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}function Hf(l){let e,t,n,o,s,i,r,a,c,u,f,d,h,_,b,w,g,v,y,E,z,D,M,A=l[9].t("OneDrive")+"",O;return{c(){e=_e("svg"),t=_e("mask"),n=_e("path"),o=_e("g"),s=_e("path"),i=_e("path"),r=_e("path"),a=_e("path"),c=_e("defs"),u=_e("linearGradient"),f=_e("stop"),d=_e("stop"),h=_e("linearGradient"),_=_e("stop"),b=_e("stop"),w=_e("linearGradient"),g=_e("stop"),v=_e("stop"),y=_e("linearGradient"),E=_e("stop"),z=_e("stop"),D=Q(),M=T("div"),O=ke(A),this.h()},l(L){e=be(L,"svg",{xmlns:!0,viewBox:!0,class:!0,fill:!0});var W=S(e);t=be(W,"mask",{id:!0,style:!0,maskUnits:!0,x:!0,y:!0,width:!0,height:!0});var K=S(t);n=be(K,"path",{d:!0,fill:!0}),S(n).forEach(p),K.forEach(p),o=be(W,"g",{mask:!0});var R=S(o);s=be(R,"path",{d:!0,fill:!0}),S(s).forEach(p),i=be(R,"path",{d:!0,fill:!0}),S(i).forEach(p),r=be(R,"path",{d:!0,fill:!0}),S(r).forEach(p),a=be(R,"path",{d:!0,fill:!0}),S(a).forEach(p),R.forEach(p),c=be(W,"defs",{});var I=S(c);u=be(I,"linearGradient",{id:!0,x1:!0,y1:!0,x2:!0,y2:!0,gradientUnits:!0});var P=S(u);f=be(P,"stop",{"stop-color":!0}),S(f).forEach(p),d=be(P,"stop",{offset:!0,"stop-color":!0}),S(d).forEach(p),P.forEach(p),h=be(I,"linearGradient",{id:!0,x1:!0,y1:!0,x2:!0,y2:!0,gradientUnits:!0});var N=S(h);_=be(N,"stop",{"stop-color":!0}),S(_).forEach(p),b=be(N,"stop",{offset:!0,"stop-color":!0}),S(b).forEach(p),N.forEach(p),w=be(I,"linearGradient",{id:!0,x1:!0,y1:!0,x2:!0,y2:!0,gradientUnits:!0});var Y=S(w);g=be(Y,"stop",{"stop-color":!0}),S(g).forEach(p),v=be(Y,"stop",{offset:!0,"stop-color":!0}),S(v).forEach(p),Y.forEach(p),y=be(I,"linearGradient",{id:!0,x1:!0,y1:!0,x2:!0,y2:!0,gradientUnits:!0});var Z=S(y);E=be(Z,"stop",{"stop-color":!0}),S(E).forEach(p),z=be(Z,"stop",{offset:!0,"stop-color":!0}),S(z).forEach(p),Z.forEach(p),I.forEach(p),W.forEach(p),D=x(L),M=V(L,"DIV",{class:!0});var F=S(M);O=Ee(F,A),F.forEach(p),this.h()},h(){m(n,"d","M7.82979 26C3.50549 26 0 22.5675 0 18.3333C0 14.1921 3.35322 10.8179 7.54613 10.6716C9.27535 7.87166 12.4144 6 16 6C20.6308 6 24.5169 9.12183 25.5829 13.3335C29.1316 13.3603 32 16.1855 32 19.6667C32 23.0527 29 26 25.8723 25.9914L7.82979 26Z"),m(n,"fill","#C4C4C4"),m(t,"id","mask0_87_7796"),$e(t,"mask-type","alpha"),m(t,"maskUnits","userSpaceOnUse"),m(t,"x","0"),m(t,"y","6"),m(t,"width","32"),m(t,"height","20"),m(s,"d","M7.83017 26.0001C5.37824 26.0001 3.18957 24.8966 1.75391 23.1691L18.0429 16.3335L30.7089 23.4647C29.5926 24.9211 27.9066 26.0001 26.0004 25.9915C23.1254 26.0001 12.0629 26.0001 7.83017 26.0001Z"),m(s,"fill","url(#paint0_linear_87_7796)"),m(i,"d","M25.5785 13.3149L18.043 16.3334L30.709 23.4647C31.5199 22.4065 32.0004 21.0916 32.0004 19.6669C32.0004 16.1857 29.1321 13.3605 25.5833 13.3337C25.5817 13.3274 25.5801 13.3212 25.5785 13.3149Z"),m(i,"fill","url(#paint1_linear_87_7796)"),m(r,"d","M7.06445 10.7028L18.0423 16.3333L25.5779 13.3148C24.5051 9.11261 20.6237 6 15.9997 6C12.4141 6 9.27508 7.87166 7.54586 10.6716C7.3841 10.6773 7.22358 10.6877 7.06445 10.7028Z"),m(r,"fill","url(#paint2_linear_87_7796)"),m(a,"d","M1.7535 23.1687L18.0425 16.3331L7.06471 10.7026C3.09947 11.0792 0 14.3517 0 18.3331C0 20.1665 0.657197 21.8495 1.7535 23.1687Z"),m(a,"fill","url(#paint3_linear_87_7796)"),m(o,"mask","url(#mask0_87_7796)"),m(f,"stop-color","#2086B8"),m(d,"offset","1"),m(d,"stop-color","#46D3F6"),m(u,"id","paint0_linear_87_7796"),m(u,"x1","4.42591"),m(u,"y1","24.6668"),m(u,"x2","27.2309"),m(u,"y2","23.2764"),m(u,"gradientUnits","userSpaceOnUse"),m(_,"stop-color","#1694DB"),m(b,"offset","1"),m(b,"stop-color","#62C3FE"),m(h,"id","paint1_linear_87_7796"),m(h,"x1","23.8302"),m(h,"y1","19.6668"),m(h,"x2","30.2108"),m(h,"y2","15.2082"),m(h,"gradientUnits","userSpaceOnUse"),m(g,"stop-color","#0D3D78"),m(v,"offset","1"),m(v,"stop-color","#063B83"),m(w,"id","paint2_linear_87_7796"),m(w,"x1","8.51037"),m(w,"y1","7.33333"),m(w,"x2","23.3335"),m(w,"y2","15.9348"),m(w,"gradientUnits","userSpaceOnUse"),m(E,"stop-color","#16589B"),m(z,"offset","1"),m(z,"stop-color","#1464B7"),m(y,"id","paint3_linear_87_7796"),m(y,"x1","-0.340429"),m(y,"y1","19.9998"),m(y,"x2","14.5634"),m(y,"y2","14.4649"),m(y,"gradientUnits","userSpaceOnUse"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"viewBox","0 0 32 32"),m(e,"class","w-5 h-5"),m(e,"fill","none"),m(M,"class","line-clamp-1")},m(L,W){B(L,e,W),k(e,t),k(t,n),k(e,o),k(o,s),k(o,i),k(o,r),k(o,a),k(e,c),k(c,u),k(u,f),k(u,d),k(c,h),k(h,_),k(h,b),k(c,w),k(w,g),k(w,v),k(c,y),k(y,E),k(y,z),B(L,D,W),B(L,M,W),k(M,O)},p(L,W){W&512&&A!==(A=L[9].t("OneDrive")+"")&&Ce(O,A)},d(L){L&&(p(e),p(D),p(M))}}}function Af(l){var h,_,b,w;let e=Object.keys(l[7]).length>0,t,n,o,s,i,r,a,c,u=e&&Zs(l);n=new Ft({props:{content:l[8]?"":l[9].t("You do not have permission to upload files"),className:"w-full",$$slots:{default:[zf]},$$scope:{ctx:l}}}),s=new Ft({props:{content:l[8]?"":l[9].t("You do not have permission to upload files"),className:"w-full",$$slots:{default:[Pf]},$$scope:{ctx:l}}});let f=((_=(h=l[10])==null?void 0:h.features)==null?void 0:_.enable_google_drive_integration)&&Js(l),d=((w=(b=l[10])==null?void 0:b.features)==null?void 0:w.enable_onedrive_integration)&&Qs(l);return{c(){u&&u.c(),t=Q(),ee(n.$$.fragment),o=Q(),ee(s.$$.fragment),i=Q(),f&&f.c(),r=Q(),d&&d.c(),a=Te()},l(g){u&&u.l(g),t=x(g),le(n.$$.fragment,g),o=x(g),le(s.$$.fragment,g),i=x(g),f&&f.l(g),r=x(g),d&&d.l(g),a=Te()},m(g,v){u&&u.m(g,v),B(g,t,v),te(n,g,v),B(g,o,v),te(s,g,v),B(g,i,v),f&&f.m(g,v),B(g,r,v),d&&d.m(g,v),B(g,a,v),c=!0},p(g,v){var z,D,M,A;v&128&&(e=Object.keys(g[7]).length>0),e?u?(u.p(g,v),v&128&&C(u,1)):(u=Zs(g),u.c(),C(u,1),u.m(t.parentNode,t)):u&&(Ve(),H(u,1,1,()=>{u=null}),ze());const y={};v&768&&(y.content=g[8]?"":g[9].t("You do not have permission to upload files")),v&33555202&&(y.$$scope={dirty:v,ctx:g}),n.$set(y);const E={};v&768&&(E.content=g[8]?"":g[9].t("You do not have permission to upload files")),v&33555204&&(E.$$scope={dirty:v,ctx:g}),s.$set(E),(D=(z=g[10])==null?void 0:z.features)!=null&&D.enable_google_drive_integration?f?(f.p(g,v),v&1024&&C(f,1)):(f=Js(g),f.c(),C(f,1),f.m(r.parentNode,r)):f&&(Ve(),H(f,1,1,()=>{f=null}),ze()),(A=(M=g[10])==null?void 0:M.features)!=null&&A.enable_onedrive_integration?d?(d.p(g,v),v&1024&&C(d,1)):(d=Qs(g),d.c(),C(d,1),d.m(a.parentNode,a)):d&&(Ve(),H(d,1,1,()=>{d=null}),ze())},i(g){c||(C(u),C(n.$$.fragment,g),C(s.$$.fragment,g),C(f),C(d),c=!0)},o(g){H(u),H(n.$$.fragment,g),H(s.$$.fragment,g),H(f),H(d),c=!1},d(g){g&&(p(t),p(o),p(i),p(r),p(a)),u&&u.d(g),ne(n,g),ne(s,g),f&&f.d(g),d&&d.d(g)}}}function Lf(l){let e,t,n;return t=new To({props:{class:"w-full max-w-[220px] rounded-xl px-1 py-1  border-gray-300/30 dark:border-gray-700/50 z-50 bg-white dark:bg-gray-850 dark:text-white shadow-sm",sideOffset:15,alignOffset:-8,side:"top",align:"start",transition:ql,$$slots:{default:[Af]},$$scope:{ctx:l}}}),{c(){e=T("div"),ee(t.$$.fragment),this.h()},l(o){e=V(o,"DIV",{slot:!0});var s=S(e);le(t.$$.fragment,s),s.forEach(p),this.h()},h(){m(e,"slot","content")},m(o,s){B(o,e,s),te(t,e,null),n=!0},p(o,s){const i={};s&33556383&&(i.$$scope={dirty:s,ctx:o}),t.$set(i)},i(o){n||(C(t.$$.fragment,o),n=!0)},o(o){H(t.$$.fragment,o),n=!1},d(o){o&&p(e),ne(t)}}}function Bf(l){let e,t,n,o,s,i,r;function a(u){l[23](u)}let c={$$slots:{content:[Lf],default:[Mf]},$$scope:{ctx:l}};return l[6]!==void 0&&(c.show=l[6]),n=new Mo({props:c}),Ae.push(()=>Xe(n,"show",a)),n.$on("change",l[24]),{c(){e=T("input"),t=Q(),ee(n.$$.fragment),this.h()},l(u){e=V(u,"INPUT",{id:!0,type:!0,accept:!0,capture:!0,style:!0}),t=x(u),le(n.$$.fragment,u),this.h()},h(){m(e,"id","camera-input"),m(e,"type","file"),m(e,"accept","image/*"),m(e,"capture","environment"),$e(e,"display","none")},m(u,f){B(u,e,f),B(u,t,f),te(n,u,f),s=!0,i||(r=Se(e,"change",l[13]),i=!0)},p(u,[f]){const d={};f&33556383&&(d.$$scope={dirty:f,ctx:u}),!o&&f&64&&(o=!0,d.show=u[6],Ge(()=>o=!1)),n.$set(d)},i(u){s||(C(n.$$.fragment,u),s=!0)},o(u){H(n.$$.fragment,u),s=!1},d(u){u&&(p(e),p(t)),ne(n,u),i=!1,r()}}}function Rf(l,e,t){let n,o,s,i;re(l,fl,P=>t(26,n=P)),re(l,Kn,P=>t(15,o=P)),re(l,Do,P=>t(10,i=P));let{$$slots:r={},$$scope:a}=e;const c=Ot("i18n");re(l,c,P=>t(9,s=P));let{screenCaptureHandler:u}=e,{uploadFilesHandler:f}=e,{inputFilesHandler:d}=e,{uploadGoogleDriveHandler:h}=e,{uploadOneDriveHandler:_}=e,{selectedToolIds:b=[]}=e,{onClose:w}=e,g={},v=!1,y=!0;const E=async()=>{n===null&&await fl.set(await is(localStorage.token)),t(7,g=n.reduce((P,N,Y,Z)=>(P[N.id]={name:N.name,description:N.meta.description,enabled:b.includes(N.id)},P),{}))},z=()=>{const P=navigator.userAgent||navigator.vendor||window.opera;return/android|iphone|ipad|ipod|windows phone/i.test(P)};function D(P){var Y;const N=Array.from((Y=P.target)==null?void 0:Y.files);N&&N.length>0&&(console.log(N),d(N))}const M=async(P,N)=>{const Y=N.detail;await tt(),Y?t(0,b=[...b,P]):t(0,b=b.filter(Z=>Z!==P))},A=P=>{t(7,g[P].enabled=!g[P].enabled,g)},O=()=>{if(y)if(!z())u();else{const P=document.getElementById("camera-input");P&&P.click()}},L=()=>{y&&f()},W=()=>{h()},K=()=>{_()};function R(P){v=P,t(6,v)}const I=P=>{P.detail===!1&&w()};return l.$$set=P=>{"screenCaptureHandler"in P&&t(1,u=P.screenCaptureHandler),"uploadFilesHandler"in P&&t(2,f=P.uploadFilesHandler),"inputFilesHandler"in P&&t(14,d=P.inputFilesHandler),"uploadGoogleDriveHandler"in P&&t(3,h=P.uploadGoogleDriveHandler),"uploadOneDriveHandler"in P&&t(4,_=P.uploadOneDriveHandler),"selectedToolIds"in P&&t(0,b=P.selectedToolIds),"onClose"in P&&t(5,w=P.onClose),"$$scope"in P&&t(25,a=P.$$scope)},l.$$.update=()=>{var P,N;l.$$.dirty&64&&v&&E(),l.$$.dirty&32768&&t(8,y=o.role==="admin"||((N=(P=o==null?void 0:o.permissions)==null?void 0:P.chat)==null?void 0:N.file_upload))},[b,u,f,h,_,w,v,g,y,s,i,c,z,D,d,o,r,M,A,O,L,W,K,R,I,a]}class Uf extends Oe{constructor(e){super(),He(this,e,Rf,Bf,Le,{screenCaptureHandler:1,uploadFilesHandler:2,inputFilesHandler:14,uploadGoogleDriveHandler:3,uploadOneDriveHandler:4,selectedToolIds:0,onClose:5})}}function xs(l,e,t){const n=l.slice();return n[0]=e[t],n[16]=t,n}function $s(l){let e,t,n,o,s,i,r,a='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-3 h-3"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg>',c,u,f=l[3].t("Tip: Update multiple variable slots consecutively by pressing the tab key in the chat input after each replacement.")+"",d,h=ht(l[2]),_=[];for(let b=0;b<h.length;b+=1)_[b]=er(xs(l,h,b));return{c(){e=T("div"),t=T("div"),n=T("div"),o=T("div");for(let b=0;b<_.length;b+=1)_[b].c();s=Q(),i=T("div"),r=T("div"),r.innerHTML=a,c=Q(),u=T("div"),d=ke(f),this.h()},l(b){e=V(b,"DIV",{id:!0,class:!0});var w=S(e);t=V(w,"DIV",{class:!0});var g=S(t);n=V(g,"DIV",{class:!0});var v=S(n);o=V(v,"DIV",{class:!0});var y=S(o);for(let D=0;D<_.length;D+=1)_[D].l(y);y.forEach(p),s=x(v),i=V(v,"DIV",{class:!0});var E=S(i);r=V(E,"DIV",{"data-svelte-h":!0}),it(r)!=="svelte-cdi12d"&&(r.innerHTML=a),c=x(E),u=V(E,"DIV",{class:!0});var z=S(u);d=Ee(z,f),z.forEach(p),E.forEach(p),v.forEach(p),g.forEach(p),w.forEach(p),this.h()},h(){m(o,"class","m-1 overflow-y-auto p-1 space-y-0.5 scrollbar-hidden"),m(u,"class","line-clamp-1"),m(i,"class","px-2 pt-0.5 pb-1 text-xs text-gray-600 dark:text-gray-100 bg-white dark:bg-gray-900 rounded-b-xl flex items-center space-x-1"),m(n,"class","max-h-60 flex flex-col w-full rounded-xl bg-white dark:bg-gray-900 dark:text-gray-100"),m(t,"class","flex w-full rounded-xl border border-gray-100 dark:border-gray-850"),m(e,"id","commands-container"),m(e,"class","px-2 mb-2 text-left w-full absolute bottom-0 left-0 right-0 z-10")},m(b,w){B(b,e,w),k(e,t),k(t,n),k(n,o);for(let g=0;g<_.length;g+=1)_[g]&&_[g].m(o,null);k(n,s),k(n,i),k(i,r),k(i,c),k(i,u),k(u,d)},p(b,w){if(w&38){h=ht(b[2]);let g;for(g=0;g<h.length;g+=1){const v=xs(b,h,g);_[g]?_[g].p(v,w):(_[g]=er(v),_[g].c(),_[g].m(o,null))}for(;g<_.length;g+=1)_[g].d(1);_.length=h.length}w&8&&f!==(f=b[3].t("Tip: Update multiple variable slots consecutively by pressing the tab key in the chat input after each replacement.")+"")&&Ce(d,f)},d(b){b&&p(e),vn(_,b)}}}function er(l){let e,t,n=l[0].command+"",o,s,i,r=l[0].title+"",a,c,u,f,d;function h(){return l[11](l[0])}function _(){return l[12](l[16])}return{c(){e=T("button"),t=T("div"),o=ke(n),s=Q(),i=T("div"),a=ke(r),c=Q(),this.h()},l(b){e=V(b,"BUTTON",{class:!0,type:!0});var w=S(e);t=V(w,"DIV",{class:!0});var g=S(t);o=Ee(g,n),g.forEach(p),s=x(w),i=V(w,"DIV",{class:!0});var v=S(i);a=Ee(v,r),v.forEach(p),c=x(w),w.forEach(p),this.h()},h(){m(t,"class","font-medium text-black dark:text-gray-100"),m(i,"class","text-xs text-gray-600 dark:text-gray-100"),m(e,"class",u="px-3 py-1.5 rounded-xl w-full text-left "+(l[16]===l[1]?"  bg-gray-50 dark:bg-gray-850 selected-command-option-button":"")),m(e,"type","button")},m(b,w){B(b,e,w),k(e,t),k(t,o),k(e,s),k(e,i),k(i,a),k(e,c),f||(d=[Se(e,"click",h),Se(e,"mousemove",_),Se(e,"focus",Wf)],f=!0)},p(b,w){l=b,w&4&&n!==(n=l[0].command+"")&&Ce(o,n),w&4&&r!==(r=l[0].title+"")&&Ce(a,r),w&2&&u!==(u="px-3 py-1.5 rounded-xl w-full text-left "+(l[16]===l[1]?"  bg-gray-50 dark:bg-gray-850 selected-command-option-button":""))&&m(e,"class",u)},d(b){b&&p(e),f=!1,sn(d)}}}function Ff(l){let e,t=l[2].length>0&&$s(l);return{c(){t&&t.c(),e=Te()},l(n){t&&t.l(n),e=Te()},m(n,o){t&&t.m(n,o),B(n,e,o)},p(n,[o]){n[2].length>0?t?t.p(n,o):(t=$s(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:De,o:De,d(n){n&&p(e),t&&t.d(n)}}}const Wf=()=>{};function jf(l,e,t){let n,o,s,i;re(l,da,v=>t(13,n=v)),re(l,Kn,v=>t(14,o=v)),re(l,ha,v=>t(10,i=v));const r=Ot("i18n");re(l,r,v=>t(3,s=v));let{files:a}=e,{prompt:c=""}=e,{command:u=""}=e,f=0,d=[];const h=()=>{t(1,f=Math.max(0,f-1))},_=()=>{t(1,f=Math.min(f+1,d.length-1))},b=async v=>{let y=v.content;if(v.content.includes("{{CLIPBOARD}}")){const D=await navigator.clipboard.readText().catch(O=>(ct.error(s.t("Failed to read clipboard contents")),"{{CLIPBOARD}}")),M=await navigator.clipboard.read();let A=null;for(const O of M)for(const L of O.types)if(L.startsWith("image/")){const W=await O.getType(L);A=URL.createObjectURL(W)}A&&t(6,a=[...a,{type:"image",url:A}]),y=y.replaceAll("{{CLIPBOARD}}",D)}if(v.content.includes("{{USER_LOCATION}}")){let D;try{D=await kc()}catch{ct.error(s.t("Location access not allowed")),D="LOCATION_UNKNOWN"}y=y.replaceAll("{{USER_LOCATION}}",String(D))}if(v.content.includes("{{USER_NAME}}")){console.log(o);const D=o.name||"User";y=y.replaceAll("{{USER_NAME}}",D)}if(v.content.includes("{{USER_LANGUAGE}}")){const D=localStorage.getItem("locale")||"en-US";y=y.replaceAll("{{USER_LANGUAGE}}",D)}if(v.content.includes("{{USER_API_KEY}}")){console.log("$userAPIKey in prompts",n);const D=n||"";y=y.replace(/{{USER_API_KEY}}/g,D)}if(v.content.includes("{{CURRENT_DATE}}")){const D=Ec();y=y.replaceAll("{{CURRENT_DATE}}",D)}if(v.content.includes("{{CURRENT_TIME}}")){const D=Ic();y=y.replaceAll("{{CURRENT_TIME}}",D)}if(v.content.includes("{{CURRENT_DATETIME}}")){const D=Sc();y=y.replaceAll("{{CURRENT_DATETIME}}",D)}if(v.content.includes("{{CURRENT_TIMEZONE}}")){const D=Dc();y=y.replaceAll("{{CURRENT_TIMEZONE}}",D)}if(v.content.includes("{{CURRENT_WEEKDAY}}")){const D=Cc();y=y.replaceAll("{{CURRENT_WEEKDAY}}",D)}t(0,c=y);const E=document.getElementById("chat-input-container"),z=document.getElementById("chat-input");await tt(),E&&(E.style.height="",E.style.height=Math.min(E.scrollHeight,200)+"px"),await tt(),z&&(z.focus(),z.dispatchEvent(new Event("input")))},w=v=>{b(v)},g=v=>{t(1,f=v)};return l.$$set=v=>{"files"in v&&t(6,a=v.files),"prompt"in v&&t(0,c=v.prompt),"command"in v&&t(7,u=v.command)},l.$$.update=()=>{l.$$.dirty&1152&&t(2,d=i.filter(v=>v.command.toLowerCase().includes(u.toLowerCase())).sort((v,y)=>v.title.localeCompare(y.title))),l.$$.dirty&128&&u&&t(1,f=0)},[c,f,d,s,r,b,a,u,h,_,i,w,g]}class Yf extends Oe{constructor(e){super(),He(this,e,jf,Ff,Le,{files:6,prompt:0,command:7,selectUp:8,selectDown:9})}get selectUp(){return this.$$.ctx[8]}get selectDown(){return this.$$.ctx[9]}}function tr(l,e,t){const n=l.slice();return n[19]=e[t],n[21]=t,n}function nr(l){let e,t,n,o,s,i,r,a=ht(l[2]),c=[];for(let h=0;h<a.length;h+=1)c[h]=lr(tr(l,a,h));function u(h,_){var b,w;if(_&1&&(i=null),_&1&&(r=null),i==null&&(i=!!h[0].split(" ").some(xf)),i)return Jf;if(r==null&&(r=!!((w=(b=h[0].split(" "))==null?void 0:b.at(0))!=null&&w.substring(1).startsWith("http"))),r)return qf}let f=u(l,-1),d=f&&f(l);return{c(){e=T("div"),t=T("div"),n=T("div"),o=T("div");for(let h=0;h<c.length;h+=1)c[h].c();s=Q(),d&&d.c(),this.h()},l(h){e=V(h,"DIV",{id:!0,class:!0});var _=S(e);t=V(_,"DIV",{class:!0});var b=S(t);n=V(b,"DIV",{class:!0});var w=S(n);o=V(w,"DIV",{class:!0});var g=S(o);for(let v=0;v<c.length;v+=1)c[v].l(g);s=x(g),d&&d.l(g),g.forEach(p),w.forEach(p),b.forEach(p),_.forEach(p),this.h()},h(){m(o,"class","m-1 overflow-y-auto p-1 rounded-r-xl space-y-0.5 scrollbar-hidden"),m(n,"class","max-h-60 flex flex-col w-full rounded-xl bg-white dark:bg-gray-900 dark:text-gray-100"),m(t,"class","flex w-full rounded-xl border border-gray-100 dark:border-gray-850"),m(e,"id","commands-container"),m(e,"class","px-2 mb-2 text-left w-full absolute bottom-0 left-0 right-0 z-10")},m(h,_){B(h,e,_),k(e,t),k(t,n),k(n,o);for(let b=0;b<c.length;b+=1)c[b]&&c[b].m(o,null);k(o,s),d&&d.m(o,null)},p(h,_){if(_&38){a=ht(h[2]);let b;for(b=0;b<a.length;b+=1){const w=tr(h,a,b);c[b]?c[b].p(w,_):(c[b]=lr(w),c[b].c(),c[b].m(o,s))}for(;b<c.length;b+=1)c[b].d(1);c.length=a.length}f===(f=u(h,_))&&d?d.p(h,_):(d&&d.d(1),d=f&&f(h),d&&(d.c(),d.m(o,null)))},d(h){h&&p(e),vn(c,h),d&&d.d()}}}function Kf(l){let e,t="Collection";return{c(){e=T("div"),e.textContent=t,this.h()},l(n){e=V(n,"DIV",{class:!0,"data-svelte-h":!0}),it(e)!=="svelte-1j93cxc"&&(e.textContent=t),this.h()},h(){m(e,"class","bg-green-500/20 text-green-700 dark:text-green-200 rounded-sm uppercase text-xs font-bold px-1 shrink-0")},m(n,o){B(n,e,o)},d(n){n&&p(e)}}}function Gf(l){let e,t="File";return{c(){e=T("div"),e.textContent=t,this.h()},l(n){e=V(n,"DIV",{class:!0,"data-svelte-h":!0}),it(e)!=="svelte-dn3g9i"&&(e.textContent=t),this.h()},h(){m(e,"class","bg-gray-500/20 text-gray-700 dark:text-gray-200 rounded-sm uppercase text-xs font-bold px-1 shrink-0")},m(n,o){B(n,e,o)},d(n){n&&p(e)}}}function Xf(l){let e,t="Document";return{c(){e=T("div"),e.textContent=t,this.h()},l(n){e=V(n,"DIV",{class:!0,"data-svelte-h":!0}),it(e)!=="svelte-2kpkct"&&(e.textContent=t),this.h()},h(){m(e,"class","bg-gray-500/20 text-gray-700 dark:text-gray-200 rounded-sm uppercase text-xs font-bold px-1 shrink-0")},m(n,o){B(n,e,o)},d(n){n&&p(e)}}}function Zf(l){let e,t="Legacy";return{c(){e=T("div"),e.textContent=t,this.h()},l(n){e=V(n,"DIV",{class:!0,"data-svelte-h":!0}),it(e)!=="svelte-8uyvzr"&&(e.textContent=t),this.h()},h(){m(e,"class","bg-gray-500/20 text-gray-700 dark:text-gray-200 rounded-sm uppercase text-xs font-bold px-1 shrink-0")},m(n,o){B(n,e,o)},d(n){n&&p(e)}}}function lr(l){var E,z;let e,t,n,o,s,i=((E=l[19])==null?void 0:E.name)+"",r,a,c,u=((z=l[19])==null?void 0:z.description)+"",f,d,h,_;function b(D,M){var A,O,L;return D[19].legacy?Zf:(O=(A=D[19])==null?void 0:A.meta)!=null&&O.document?Xf:((L=D[19])==null?void 0:L.type)==="file"?Gf:Kf}let w=b(l),g=w(l);function v(){return l[13](l[19])}function y(){return l[14](l[21])}return{c(){e=T("button"),t=T("div"),n=T("div"),g.c(),o=Q(),s=T("div"),r=ke(i),a=Q(),c=T("div"),f=ke(u),this.h()},l(D){e=V(D,"BUTTON",{class:!0,type:!0});var M=S(e);t=V(M,"DIV",{});var A=S(t);n=V(A,"DIV",{class:!0});var O=S(n);g.l(O),o=x(O),s=V(O,"DIV",{class:!0});var L=S(s);r=Ee(L,i),L.forEach(p),O.forEach(p),a=x(A),c=V(A,"DIV",{class:!0});var W=S(c);f=Ee(W,u),W.forEach(p),A.forEach(p),M.forEach(p),this.h()},h(){m(s,"class","line-clamp-1"),m(n,"class","font-medium text-black dark:text-gray-100 flex items-center gap-1"),m(c,"class","text-xs text-gray-600 dark:text-gray-100 line-clamp-1"),m(e,"class",d="px-3 py-1.5 rounded-xl w-full text-left flex justify-between items-center "+(l[21]===l[1]?" bg-gray-50 dark:bg-gray-850 dark:text-gray-100 selected-command-option-button":"")),m(e,"type","button")},m(D,M){B(D,e,M),k(e,t),k(t,n),g.m(n,null),k(n,o),k(n,s),k(s,r),k(t,a),k(t,c),k(c,f),h||(_=[Se(e,"click",v),Se(e,"mousemove",y)],h=!0)},p(D,M){var A,O;l=D,w!==(w=b(l))&&(g.d(1),g=w(l),g&&(g.c(),g.m(n,o))),M&4&&i!==(i=((A=l[19])==null?void 0:A.name)+"")&&Ce(r,i),M&4&&u!==(u=((O=l[19])==null?void 0:O.description)+"")&&Ce(f,u),M&2&&d!==(d="px-3 py-1.5 rounded-xl w-full text-left flex justify-between items-center "+(l[21]===l[1]?" bg-gray-50 dark:bg-gray-850 dark:text-gray-100 selected-command-option-button":""))&&m(e,"class",d)},d(D){D&&p(e),g.d(),h=!1,sn(_)}}}function qf(l){var f,d;let e,t,n=((d=(f=l[0].split(" "))==null?void 0:f.at(0))==null?void 0:d.substring(1))+"",o,s,i,r=l[3].t("Web")+"",a,c,u;return{c(){e=T("button"),t=T("div"),o=ke(n),s=Q(),i=T("div"),a=ke(r),this.h()},l(h){e=V(h,"BUTTON",{class:!0,type:!0});var _=S(e);t=V(_,"DIV",{class:!0});var b=S(t);o=Ee(b,n),b.forEach(p),s=x(_),i=V(_,"DIV",{class:!0});var w=S(i);a=Ee(w,r),w.forEach(p),_.forEach(p),this.h()},h(){m(t,"class","font-medium text-black dark:text-gray-100 line-clamp-1"),m(i,"class","text-xs text-gray-600 line-clamp-1"),m(e,"class","px-3 py-1.5 rounded-xl w-full text-left bg-gray-50 dark:bg-gray-850 dark:text-gray-100 selected-command-option-button"),m(e,"type","button")},m(h,_){B(h,e,_),k(e,t),k(t,o),k(e,s),k(e,i),k(i,a),c||(u=Se(e,"click",l[16]),c=!0)},p(h,_){var b,w;_&1&&n!==(n=((w=(b=h[0].split(" "))==null?void 0:b.at(0))==null?void 0:w.substring(1))+"")&&Ce(o,n),_&8&&r!==(r=h[3].t("Web")+"")&&Ce(a,r)},d(h){h&&p(e),c=!1,u()}}}function Jf(l){var f,d;let e,t,n=((d=(f=l[0].split(" "))==null?void 0:f.at(0))==null?void 0:d.substring(1))+"",o,s,i,r=l[3].t("Youtube")+"",a,c,u;return{c(){e=T("button"),t=T("div"),o=ke(n),s=Q(),i=T("div"),a=ke(r),this.h()},l(h){e=V(h,"BUTTON",{class:!0,type:!0});var _=S(e);t=V(_,"DIV",{class:!0});var b=S(t);o=Ee(b,n),b.forEach(p),s=x(_),i=V(_,"DIV",{class:!0});var w=S(i);a=Ee(w,r),w.forEach(p),_.forEach(p),this.h()},h(){m(t,"class","font-medium text-black dark:text-gray-100 line-clamp-1"),m(i,"class","text-xs text-gray-600 line-clamp-1"),m(e,"class","px-3 py-1.5 rounded-xl w-full text-left bg-gray-50 dark:bg-gray-850 dark:text-gray-100 selected-command-option-button"),m(e,"type","button")},m(h,_){B(h,e,_),k(e,t),k(t,o),k(e,s),k(e,i),k(i,a),c||(u=Se(e,"click",l[15]),c=!0)},p(h,_){var b,w;_&1&&n!==(n=((w=(b=h[0].split(" "))==null?void 0:b.at(0))==null?void 0:w.substring(1))+"")&&Ce(o,n),_&8&&r!==(r=h[3].t("Youtube")+"")&&Ce(a,r)},d(h){h&&p(e),c=!1,u()}}}function Qf(l){var o,s;let e=l[2].length>0||((s=(o=l[0].split(" "))==null?void 0:o.at(0))==null?void 0:s.substring(1).startsWith("http")),t,n=e&&nr(l);return{c(){n&&n.c(),t=Te()},l(i){n&&n.l(i),t=Te()},m(i,r){n&&n.m(i,r),B(i,t,r)},p(i,[r]){var a,c;r&5&&(e=i[2].length>0||((c=(a=i[0].split(" "))==null?void 0:a.at(0))==null?void 0:c.substring(1).startsWith("http"))),e?n?n.p(i,r):(n=nr(i),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},i:De,o:De,d(i){i&&p(t),n&&n.d(i)}}}const xf=l=>l.substring(1).startsWith("https://www.youtube.com")||l.substring(1).startsWith("https://youtu.be");function $f(l,e,t){let n,o;re(l,ma,D=>t(17,n=D)),lu.extend(ou);const s=Ot("i18n");re(l,s,D=>t(3,o=D));let{prompt:i=""}=e,{command:r=""}=e;const a=on();let c=0,u=[],f=null,d=[];const h=()=>{t(1,c=Math.max(0,c-1))},_=()=>{t(1,c=Math.min(c+1,d.length-1))},b=async D=>{a("select",D),t(0,i=Ll(i,r));const M=document.getElementById("chat-input");await tt(),M==null||M.focus(),await tt()},w=async D=>{a("url",D),t(0,i=Ll(i,r));const M=document.getElementById("chat-input");await tt(),M==null||M.focus(),await tt()},g=async D=>{a("youtube",D),t(0,i=Ll(i,r));const M=document.getElementById("chat-input");await tt(),M==null||M.focus(),await tt()};hn(()=>{let D=n.filter(L=>{var W;return(W=L==null?void 0:L.meta)==null?void 0:W.document}).map(L=>({...L,type:"file"})),M=D.length>0?[{name:"All Documents",legacy:!0,type:"collection",description:"Deprecated (legacy collection), please create a new knowledge base.",title:o.t("All Documents"),collection_names:D.map(L=>L.id)},...D.reduce((L,W)=>{var K;return[...new Set([...L,...(((K=W==null?void 0:W.meta)==null?void 0:K.tags)??[]).map(R=>R.name)])]},[]).map(L=>({name:L,legacy:!0,type:"collection",description:"Deprecated (legacy collection), please create a new knowledge base.",collection_names:D.filter(W=>{var K;return(((K=W==null?void 0:W.meta)==null?void 0:K.tags)??[]).map(R=>R.name).includes(L)}).map(W=>W.id)}))]:[],A=n.filter(L=>{var W;return!((W=L==null?void 0:L.meta)!=null&&W.document)}).map(L=>({...L,type:"collection"})),O=n.length>0?[...n.reduce((L,W)=>[...new Set([...L,...((W==null?void 0:W.files)??[]).map(K=>({...K,collection:{name:W.name,description:W.description}}))])],[]).map(L=>{var W,K,R;return{...L,name:(W=L==null?void 0:L.meta)==null?void 0:W.name,description:`${(K=L==null?void 0:L.collection)==null?void 0:K.name} - ${(R=L==null?void 0:L.collection)==null?void 0:R.description}`,type:"file"}})]:[];t(11,u=[...A,...O,...M,...D].map(L=>{var W,K;return{...L,...L!=null&&L.legacy||(W=L==null?void 0:L.meta)!=null&&W.legacy||(K=L==null?void 0:L.meta)!=null&&K.document?{legacy:!0}:{}}})),t(12,f=new _a(u,{keys:["name","description"]}))});const v=D=>{console.log(D),b(D)},y=D=>{t(1,c=D)},E=()=>{var M,A;const D=(A=(M=i.split(" "))==null?void 0:M.at(0))==null?void 0:A.substring(1);Vs(D)?g(D):ct.error(o.t("Oops! Looks like the URL is invalid. Please double-check and try again."))},z=()=>{var M,A;const D=(A=(M=i.split(" "))==null?void 0:M.at(0))==null?void 0:A.substring(1);Vs(D)?w(D):ct.error(o.t("Oops! Looks like the URL is invalid. Please double-check and try again."))};return l.$$set=D=>{"prompt"in D&&t(0,i=D.prompt),"command"in D&&t(8,r=D.command)},l.$$.update=()=>{l.$$.dirty&6400&&f&&t(2,d=r.slice(1)?f.search(r).map(D=>D.item):u),l.$$.dirty&256&&r&&t(1,c=0)},[i,c,d,o,s,b,w,g,r,h,_,u,f,v,y,E,z]}class ed extends Oe{constructor(e){super(),He(this,e,$f,Qf,Le,{prompt:0,command:8,selectUp:9,selectDown:10})}get selectUp(){return this.$$.ctx[9]}get selectDown(){return this.$$.ctx[10]}}function or(l,e,t){const n=l.slice();return n[12]=e[t],n[14]=t,n}function sr(l){let e,t,n,o,s=ht(l[1]),i=[];for(let r=0;r<s.length;r+=1)i[r]=rr(or(l,s,r));return{c(){e=T("div"),t=T("div"),n=T("div"),o=T("div");for(let r=0;r<i.length;r+=1)i[r].c();this.h()},l(r){e=V(r,"DIV",{id:!0,class:!0});var a=S(e);t=V(a,"DIV",{class:!0});var c=S(t);n=V(c,"DIV",{class:!0});var u=S(n);o=V(u,"DIV",{class:!0});var f=S(o);for(let d=0;d<i.length;d+=1)i[d].l(f);f.forEach(p),u.forEach(p),c.forEach(p),a.forEach(p),this.h()},h(){m(o,"class","m-1 overflow-y-auto p-1 rounded-r-lg space-y-0.5 scrollbar-hidden"),m(n,"class","max-h-60 flex flex-col w-full rounded-xl bg-white dark:bg-gray-900 dark:text-gray-100"),m(t,"class","flex w-full rounded-xl border border-gray-100 dark:border-gray-850"),m(e,"id","commands-container"),m(e,"class","px-2 mb-2 text-left w-full absolute bottom-0 left-0 right-0 z-10")},m(r,a){B(r,e,a),k(e,t),k(t,n),k(n,o);for(let c=0;c<i.length;c+=1)i[c]&&i[c].m(o,null)},p(r,a){if(a&7){s=ht(r[1]);let c;for(c=0;c<s.length;c+=1){const u=or(r,s,c);i[c]?i[c].p(u,a):(i[c]=rr(u),i[c].c(),i[c].m(o,null))}for(;c<i.length;c+=1)i[c].d(1);i.length=s.length}},d(r){r&&p(e),vn(i,r)}}}function rr(l){let e,t,n,o,s,i,r=l[12].name+"",a,c,u,f,d;function h(){return l[7](l[12])}function _(){return l[8](l[14])}return{c(){e=T("button"),t=T("div"),n=T("img"),i=Q(),a=ke(r),c=Q(),this.h()},l(b){e=V(b,"BUTTON",{class:!0,type:!0});var w=S(e);t=V(w,"DIV",{class:!0});var g=S(t);n=V(g,"IMG",{src:!0,alt:!0,class:!0}),i=x(g),a=Ee(g,r),g.forEach(p),c=x(w),w.forEach(p),this.h()},h(){var b,w,g,v;Yn(n.src,o=((g=(w=(b=l[12])==null?void 0:b.info)==null?void 0:w.meta)==null?void 0:g.profile_image_url)??"/static/favicon.png")||m(n,"src",o),m(n,"alt",s=((v=l[12])==null?void 0:v.name)??l[12].id),m(n,"class","rounded-full size-6 items-center mr-2"),m(t,"class","flex font-medium text-black dark:text-gray-100 line-clamp-1"),m(e,"class",u="px-3 py-1.5 rounded-xl w-full text-left "+(l[14]===l[0]?"bg-gray-50 dark:bg-gray-850 selected-command-option-button":"")),m(e,"type","button")},m(b,w){B(b,e,w),k(e,t),k(t,n),k(t,i),k(t,a),k(e,c),f||(d=[Se(e,"click",h),Se(e,"mousemove",_),Se(e,"focus",nd)],f=!0)},p(b,w){var g,v,y,E;l=b,w&2&&!Yn(n.src,o=((y=(v=(g=l[12])==null?void 0:g.info)==null?void 0:v.meta)==null?void 0:y.profile_image_url)??"/static/favicon.png")&&m(n,"src",o),w&2&&s!==(s=((E=l[12])==null?void 0:E.name)??l[12].id)&&m(n,"alt",s),w&2&&r!==(r=l[12].name+"")&&Ce(a,r),w&1&&u!==(u="px-3 py-1.5 rounded-xl w-full text-left "+(l[14]===l[0]?"bg-gray-50 dark:bg-gray-850 selected-command-option-button":""))&&m(e,"class",u)},d(b){b&&p(e),f=!1,sn(d)}}}function td(l){let e,t=l[1].length>0&&sr(l);return{c(){t&&t.c(),e=Te()},l(n){t&&t.l(n),e=Te()},m(n,o){t&&t.m(n,o),B(n,e,o)},p(n,[o]){n[1].length>0?t?t.p(n,o):(t=sr(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:De,o:De,d(n){n&&p(e),t&&t.d(n)}}}const nd=()=>{};function ld(l,e,t){let n;re(l,hl,_=>t(6,n=_)),Ot("i18n");const o=on();let{command:s=""}=e,i=0,r=[],a=new _a(n.filter(_=>{var b,w;return!((w=(b=_==null?void 0:_.info)==null?void 0:b.meta)!=null&&w.hidden)}).map(_=>{var w,g,v,y,E;return{..._,modelName:_==null?void 0:_.name,tags:(v=(g=(w=_==null?void 0:_.info)==null?void 0:w.meta)==null?void 0:g.tags)==null?void 0:v.map(z=>z.name).join(" "),desc:(E=(y=_==null?void 0:_.info)==null?void 0:y.meta)==null?void 0:E.description}}),{keys:["value","tags","modelName"],threshold:.3});const c=()=>{t(0,i=Math.max(0,i-1))},u=()=>{t(0,i=Math.min(i+1,r.length-1))},f=async _=>{t(3,s=""),o("select",_)};hn(async()=>{await tt();const _=document.getElementById("chat-input");await tt(),_==null||_.focus(),await tt()});const d=_=>{f(_)},h=_=>{t(0,i=_)};return l.$$set=_=>{"command"in _&&t(3,s=_.command)},l.$$.update=()=>{l.$$.dirty&72&&t(1,r=s.slice(1)?a.search(s).map(_=>_.item):n.filter(_=>{var b,w;return!((w=(b=_==null?void 0:_.info)==null?void 0:b.meta)!=null&&w.hidden)})),l.$$.dirty&8&&s&&t(0,i=0)},[i,r,f,s,c,u,n,d,h]}class od extends Oe{constructor(e){super(),He(this,e,ld,td,Le,{command:3,selectUp:4,selectDown:5})}get selectUp(){return this.$$.ctx[4]}get selectDown(){return this.$$.ctx[5]}}function ir(l,e,t){const n=l.slice();return n[12]=e[t],n[14]=t,n}function ar(l){let e,t,n,o,s=ht(l[0]),i=[];for(let r=0;r<s.length;r+=1)i[r]=cr(ir(l,s,r));return{c(){e=T("div"),t=T("div"),n=T("div"),o=T("div");for(let r=0;r<i.length;r+=1)i[r].c();this.h()},l(r){e=V(r,"DIV",{id:!0,class:!0});var a=S(e);t=V(a,"DIV",{class:!0});var c=S(t);n=V(c,"DIV",{class:!0});var u=S(n);o=V(u,"DIV",{class:!0});var f=S(o);for(let d=0;d<i.length;d+=1)i[d].l(f);f.forEach(p),u.forEach(p),c.forEach(p),a.forEach(p),this.h()},h(){m(o,"class","m-1 overflow-y-auto p-1 rounded-r-lg space-y-0.5 scrollbar-hidden"),m(n,"class","max-h-60 flex flex-col w-full rounded-xl bg-white dark:bg-gray-900 dark:text-gray-100"),m(t,"class","flex w-full rounded-xl border border-gray-100 dark:border-gray-850"),m(e,"id","commands-container"),m(e,"class","px-2 mb-2 text-left w-full absolute bottom-0 left-0 right-0 z-10")},m(r,a){B(r,e,a),k(e,t),k(t,n),k(n,o);for(let c=0;c<i.length;c+=1)i[c]&&i[c].m(o,null)},p(r,a){if(a&23){s=ht(r[0]);let c;for(c=0;c<s.length;c+=1){const u=ir(r,s,c);i[c]?i[c].p(u,a):(i[c]=cr(u),i[c].c(),i[c].m(o,null))}for(;c<i.length;c+=1)i[c].d(1);i.length=s.length}},d(r){r&&p(e),vn(i,r)}}}function cr(l){let e,t,n,o='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M20.25 6.375c0 2.278-3.694 4.125-8.25 4.125S3.75 8.653 3.75 6.375m16.5 0c0-2.278-3.694-4.125-8.25-4.125S3.75 4.097 3.75 6.375m16.5 0v11.25c0 2.278-3.694 4.125-8.25 4.125s-8.25-1.847-8.25-4.125V6.375m16.5 0v3.75m-16.5-3.75v3.75m16.5 0v3.75C20.25 16.153 16.556 18 12 18s-8.25-1.847-8.25-4.125v-3.75m16.5 0c0 2.278-3.694 4.125-8.25 4.125s-8.25-1.847-8.25-4.125"></path></svg>',s,i=l[12]+"",r,a,c,u=l[2].t("Reference database table")+"",f,d,h,_,b;function w(){return l[9](l[12])}function g(){return l[10](l[14])}return{c(){e=T("button"),t=T("div"),n=T("div"),n.innerHTML=o,s=ke(`
								@`),r=ke(i),a=Q(),c=T("div"),f=ke(u),d=Q(),this.h()},l(v){e=V(v,"BUTTON",{class:!0,type:!0});var y=S(e);t=V(y,"DIV",{class:!0});var E=S(t);n=V(E,"DIV",{class:!0,"data-svelte-h":!0}),it(n)!=="svelte-ditnfh"&&(n.innerHTML=o),s=Ee(E,`
								@`),r=Ee(E,i),E.forEach(p),a=x(y),c=V(y,"DIV",{class:!0});var z=S(c);f=Ee(z,u),z.forEach(p),d=x(y),y.forEach(p),this.h()},h(){m(n,"class","flex items-center mr-2"),m(t,"class","flex font-medium text-black dark:text-gray-100 line-clamp-1"),m(c,"class","text-xs text-gray-500 ml-7"),m(e,"class",h="px-3 py-1.5 rounded-xl w-full text-left "+(l[14]===l[1]?"bg-gray-50 dark:bg-gray-850 selected-command-option-button":"")),m(e,"type","button")},m(v,y){B(v,e,y),k(e,t),k(t,n),k(t,s),k(t,r),k(e,a),k(e,c),k(c,f),k(e,d),_||(b=[Se(e,"click",w),Se(e,"mousemove",g)],_=!0)},p(v,y){l=v,y&1&&i!==(i=l[12]+"")&&Ce(r,i),y&4&&u!==(u=l[2].t("Reference database table")+"")&&Ce(f,u),y&2&&h!==(h="px-3 py-1.5 rounded-xl w-full text-left "+(l[14]===l[1]?"bg-gray-50 dark:bg-gray-850 selected-command-option-button":""))&&m(e,"class",h)},d(v){v&&p(e),_=!1,sn(b)}}}function sd(l){let e,t=l[0].length>0&&ar(l);return{c(){t&&t.c(),e=Te()},l(n){t&&t.l(n),e=Te()},m(n,o){t&&t.m(n,o),B(n,e,o)},p(n,[o]){n[0].length>0?t?t.p(n,o):(t=ar(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:De,o:De,d(n){n&&p(e),t&&t.d(n)}}}function rd(l,e,t){let n;const o=Ot("i18n");re(l,o,b=>t(2,n=b));const s=on();let{command:i=""}=e,{dbReferences:r=["T0"]}=e,a=0,c=[];const u=()=>{t(1,a=Math.max(0,a-1))},f=()=>{t(1,a=Math.min(a+1,c.length-1))},d=async b=>{s("select",b)};hn(async()=>{await tt();const b=document.getElementById("chat-input");b&&(await tt(),b==null||b.focus())});const h=b=>{d(b)},_=b=>{t(1,a=b)};return l.$$set=b=>{"command"in b&&t(5,i=b.command),"dbReferences"in b&&t(6,r=b.dbReferences)},l.$$.update=()=>{if(l.$$.dirty&97){const b=i.slice(1).toLowerCase();b?t(0,c=r.filter(w=>w.toLowerCase().includes(b))):t(0,c=[...r]),c.length===0&&b&&/^\d+$/.test(b)&&t(0,c=[`T${b}`]),t(1,a=0)}},[c,a,n,o,d,i,r,u,f,h,_]}class id extends Oe{constructor(e){super(),He(this,e,rd,sd,Le,{command:5,dbReferences:6,selectUp:7,selectDown:8})}get selectUp(){return this.$$.ctx[7]}get selectDown(){return this.$$.ctx[8]}}function ur(l){let e,t,n,o;const s=[cd,ad],i=[];function r(a,c){return a[5]?1:0}return e=r(l),t=i[e]=s[e](l),{c(){t.c(),n=Te()},l(a){t.l(a),n=Te()},m(a,c){i[e].m(a,c),B(a,n,c),o=!0},p(a,c){let u=e;e=r(a),e===u?i[e].p(a,c):(Ve(),H(i[u],1,1,()=>{i[u]=null}),ze(),t=i[e],t?t.p(a,c):(t=i[e]=s[e](a),t.c()),C(t,1),t.m(n.parentNode,n))},i(a){o||(C(t),o=!0)},o(a){H(t),o=!1},d(a){a&&p(n),i[e].d(a)}}}function ad(l){let e,t,n,o,s;return o=new Vo({}),{c(){e=T("div"),t=T("div"),n=T("div"),ee(o.$$.fragment),this.h()},l(i){e=V(i,"DIV",{id:!0,class:!0});var r=S(e);t=V(r,"DIV",{class:!0});var a=S(t);n=V(a,"DIV",{class:!0});var c=S(n);le(o.$$.fragment,c),c.forEach(p),a.forEach(p),r.forEach(p),this.h()},h(){m(n,"class","max-h-60 flex flex-col w-full rounded-xl bg-white dark:bg-gray-900 dark:text-gray-100"),m(t,"class","flex w-full rounded-xl border border-gray-100 dark:border-gray-850"),m(e,"id","commands-container"),m(e,"class","px-2 mb-2 text-left w-full absolute bottom-0 left-0 right-0 z-10")},m(i,r){B(i,e,r),k(e,t),k(t,n),te(o,n,null),s=!0},p:De,i(i){s||(C(o.$$.fragment,i),s=!0)},o(i){H(o.$$.fragment,i),s=!1},d(i){i&&p(e),ne(o)}}}function cd(l){let e,t,n,o,s,i,r;const a=[dd,fd,ud],c=[];function u(f,d){var h,_,b;return d&8&&(e=null),d&8&&(t=null),d&8&&(n=null),e==null&&(e=((h=f[3])==null?void 0:h.charAt(0))==="/"),e?0:(t==null&&(t=!!(((_=f[3])==null?void 0:_.charAt(0))==="#"&&f[3].startsWith("#")&&!f[3].includes("# ")||f[3].slice(0,2)==="\\#"&&f[3].startsWith("#")&&!f[3].includes("# "))),t?1:(n==null&&(n=((b=f[3])==null?void 0:b.charAt(0))==="@"),n?2:-1))}return~(o=u(l,-1))&&(s=c[o]=a[o](l)),{c(){s&&s.c(),i=Te()},l(f){s&&s.l(f),i=Te()},m(f,d){~o&&c[o].m(f,d),B(f,i,d),r=!0},p(f,d){let h=o;o=u(f,d),o===h?~o&&c[o].p(f,d):(s&&(Ve(),H(c[h],1,1,()=>{c[h]=null}),ze()),~o?(s=c[o],s?s.p(f,d):(s=c[o]=a[o](f),s.c()),C(s,1),s.m(i.parentNode,i)):s=null)},i(f){r||(C(s),r=!0)},o(f){H(s),r=!1},d(f){f&&p(i),~o&&c[o].d(f)}}}function ud(l){let e,t,n,o;const s=[md,hd],i=[];function r(a,c){return a[7]?0:1}return e=r(l),t=i[e]=s[e](l),{c(){t.c(),n=Te()},l(a){t.l(a),n=Te()},m(a,c){i[e].m(a,c),B(a,n,c),o=!0},p(a,c){let u=e;e=r(a),e===u?i[e].p(a,c):(Ve(),H(i[u],1,1,()=>{i[u]=null}),ze(),t=i[e],t?t.p(a,c):(t=i[e]=s[e](a),t.c()),C(t,1),t.m(n.parentNode,n))},i(a){o||(C(t),o=!0)},o(a){H(t),o=!1},d(a){a&&p(n),i[e].d(a)}}}function fd(l){let e,t,n;function o(i){l[16](i)}let s={command:l[3].includes("\\#")?l[3].slice(2):l[3]};return l[0]!==void 0&&(s.prompt=l[0]),e=new ed({props:s}),l[15](e),Ae.push(()=>Xe(e,"prompt",o)),e.$on("youtube",l[17]),e.$on("url",l[18]),e.$on("select",l[19]),{c(){ee(e.$$.fragment)},l(i){le(e.$$.fragment,i)},m(i,r){te(e,i,r),n=!0},p(i,r){const a={};r&8&&(a.command=i[3].includes("\\#")?i[3].slice(2):i[3]),!t&&r&1&&(t=!0,a.prompt=i[0],Ge(()=>t=!1)),e.$set(a)},i(i){n||(C(e.$$.fragment,i),n=!0)},o(i){H(e.$$.fragment,i),n=!1},d(i){l[15](null),ne(e,i)}}}function dd(l){let e,t,n,o;function s(a){l[13](a)}function i(a){l[14](a)}let r={command:l[3]};return l[0]!==void 0&&(r.prompt=l[0]),l[1]!==void 0&&(r.files=l[1]),e=new Yf({props:r}),l[12](e),Ae.push(()=>Xe(e,"prompt",s)),Ae.push(()=>Xe(e,"files",i)),{c(){ee(e.$$.fragment)},l(a){le(e.$$.fragment,a)},m(a,c){te(e,a,c),o=!0},p(a,c){const u={};c&8&&(u.command=a[3]),!t&&c&1&&(t=!0,u.prompt=a[0],Ge(()=>t=!1)),!n&&c&2&&(n=!0,u.files=a[1],Ge(()=>n=!1)),e.$set(u)},i(a){o||(C(e.$$.fragment,a),o=!0)},o(a){H(e.$$.fragment,a),o=!1},d(a){l[12](null),ne(e,a)}}}function hd(l){let e,t,n={command:l[3]};return e=new od({props:n}),l[22](e),e.$on("select",l[23]),{c(){ee(e.$$.fragment)},l(o){le(e.$$.fragment,o)},m(o,s){te(e,o,s),t=!0},p(o,s){const i={};s&8&&(i.command=o[3]),e.$set(i)},i(o){t||(C(e.$$.fragment,o),t=!0)},o(o){H(e.$$.fragment,o),t=!1},d(o){l[22](null),ne(e,o)}}}function md(l){let e,t,n={command:l[3],dbReferences:l[2]};return e=new id({props:n}),l[20](e),e.$on("select",l[21]),{c(){ee(e.$$.fragment)},l(o){le(e.$$.fragment,o)},m(o,s){te(e,o,s),t=!0},p(o,s){const i={};s&8&&(i.command=o[3]),s&4&&(i.dbReferences=o[2]),e.$set(i)},i(o){t||(C(e.$$.fragment,o),t=!0)},o(o){H(e.$$.fragment,o),t=!1},d(o){l[20](null),ne(e,o)}}}function gd(l){let e,t,n=l[4]&&ur(l);return{c(){n&&n.c(),e=Te()},l(o){n&&n.l(o),e=Te()},m(o,s){n&&n.m(o,s),B(o,e,s),t=!0},p(o,[s]){o[4]?n?(n.p(o,s),s&16&&C(n,1)):(n=ur(o),n.c(),C(n,1),n.m(e.parentNode,e)):n&&(Ve(),H(n,1,1,()=>{n=null}),ze())},i(o){t||(C(n),t=!0)},o(o){H(n),t=!1},d(o){o&&p(e),n&&n.d(o)}}}function pd(l,e,t){const n=on();let{prompt:o=""}=e,{files:s=[]}=e,{history:i=null}=e,r=!1,a=null,c=!1,u=[];const f=()=>{if(!i||!i.messages)return[];const R=[];let I=-1;if(Object.values(i.messages).forEach(P=>{if(P.role==="assistant"&&P.content)try{const N=P.content.match(/Generated Table T(\d+)/i);if(N){const Y=parseInt(N[1]);Y>I&&(I=Y)}}catch(N){console.log("Error parsing message content:",N)}}),I>=0)for(let P=0;P<=I;P++)R.push(`T${P}`);else R.push("T0");return R},d=()=>{a==null||a.selectUp()},h=()=>{a==null||a.selectDown()};let _="",b=!1;const w=async()=>{t(5,r=!0),await Promise.all([(async()=>{ha.set(await tu(localStorage.token))})(),(async()=>{ma.set(await nu(localStorage.token))})()]),t(5,r=!1)};function g(R){Ae[R?"unshift":"push"](()=>{a=R,t(6,a)})}function v(R){o=R,t(0,o)}function y(R){s=R,t(1,s)}function E(R){Ae[R?"unshift":"push"](()=>{a=R,t(6,a)})}function z(R){o=R,t(0,o)}const D=R=>{console.log(R),n("upload",{type:"youtube",data:R.detail})},M=R=>{console.log(R),n("upload",{type:"web",data:R.detail})},A=R=>{console.log(R),!s.find(I=>I.id===R.detail.id)&&(t(1,s=[...s,{...R.detail,status:"processed"}]),n("select"))};function O(R){Ae[R?"unshift":"push"](()=>{a=R,t(6,a)})}const L=R=>{t(0,o=Ll(o,_)),t(0,o+=`@${R.detail}`),n("select")};function W(R){Ae[R?"unshift":"push"](()=>{a=R,t(6,a)})}const K=R=>{t(0,o=Ll(o,_)),n("select",{type:"model",data:R.detail})};return l.$$set=R=>{"prompt"in R&&t(0,o=R.prompt),"files"in R&&t(1,s=R.files),"history"in R&&t(9,i=R.history)},l.$$.update=()=>{var R,I;l.$$.dirty&1&&t(3,_=((I=(R=o==null?void 0:o.split(`
`).pop())==null?void 0:R.split(" "))==null?void 0:I.pop())??""),l.$$.dirty&8&&t(4,b=["/","#","@"].includes(_==null?void 0:_.charAt(0))||_.slice(0,2)==="\\#"),l.$$.dirty&16&&b&&w(),l.$$.dirty&28&&b&&(_==null?void 0:_.charAt(0))==="@"&&(t(2,u=f()),t(7,c=u.length>0))},[o,s,u,_,b,r,a,c,n,i,d,h,g,v,y,E,z,D,M,A,O,L,W,K]}class _d extends Oe{constructor(e){super(),He(this,e,pd,gd,Le,{prompt:0,files:1,history:9,selectUp:10,selectDown:11})}get selectUp(){return this.$$.ctx[10]}get selectDown(){return this.$$.ctx[11]}}function bd(l){let e,t;return{c(){e=_e("svg"),t=_e("path"),this.h()},l(n){e=be(n,"svg",{"aria-hidden":!0,xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var o=S(e);t=be(o,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),S(t).forEach(p),o.forEach(p),this.h()},h(){m(t,"fill-rule","evenodd"),m(t,"d","M12 5a7 7 0 0 0-7 7v1.17c.313-.11.65-.17 1-.17h2a1 1 0 0 1 1 1v6a1 1 0 0 1-1 1H6a3 3 0 0 1-3-3v-6a9 9 0 0 1 18 0v6a3 3 0 0 1-3 3h-2a1 1 0 0 1-1-1v-6a1 1 0 0 1 1-1h2c.35 0 .687.06 1 .17V12a7 7 0 0 0-7-7Z"),m(t,"clip-rule","evenodd"),m(e,"aria-hidden","true"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"fill","currentColor"),m(e,"viewBox","0 0 24 24"),m(e,"stroke-width",l[1]),m(e,"stroke","currentColor"),m(e,"class",l[0])},m(n,o){B(n,e,o),k(e,t)},p(n,[o]){o&2&&m(e,"stroke-width",n[1]),o&1&&m(e,"class",n[0])},i:De,o:De,d(n){n&&p(e)}}}function vd(l,e,t){let{className:n="w-4 h-4"}=e,{strokeWidth:o="0"}=e;return l.$$set=s=>{"className"in s&&t(0,n=s.className),"strokeWidth"in s&&t(1,o=s.strokeWidth)},[n,o]}class wd extends Oe{constructor(e){super(),He(this,e,vd,bd,Le,{className:0,strokeWidth:1})}}function yd(l){let e,t;return{c(){e=_e("svg"),t=_e("path"),this.h()},l(n){e=be(n,"svg",{class:!0,"stroke-width":!0,"aria-hidden":!0,xmlns:!0,fill:!0,viewBox:!0});var o=S(e);t=be(o,"path",{stroke:!0,"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),S(t).forEach(p),o.forEach(p),this.h()},h(){m(t,"stroke","currentColor"),m(t,"stroke-linecap","round"),m(t,"stroke-linejoin","round"),m(t,"stroke-width","2"),m(t,"d","m3 16 5-7 6 6.5m6.5 2.5L16 13l-4.286 6M14 10h.01M4 19h16a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1Z"),m(e,"class",l[0]),m(e,"stroke-width",l[1]),m(e,"aria-hidden","true"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"fill","none"),m(e,"viewBox","0 0 24 24")},m(n,o){B(n,e,o),k(e,t)},p(n,[o]){o&1&&m(e,"class",n[0]),o&2&&m(e,"stroke-width",n[1])},i:De,o:De,d(n){n&&p(e)}}}function kd(l,e,t){let{className:n="size-4"}=e,{strokeWidth:o="1.5"}=e;return l.$$set=s=>{"className"in s&&t(0,n=s.className),"strokeWidth"in s&&t(1,o=s.strokeWidth)},[n,o]}class Ed extends Oe{constructor(e){super(),He(this,e,kd,yd,Le,{className:0,strokeWidth:1})}}function fr(l,e,t){const n=l.slice();return n[88]=e[t],n[90]=t,n}function dr(l,e,t){const n=l.slice();return n[91]=e[t],n[93]=t,n}function hr(l){var Y,Z;let e,t,n,o,s,i,r,a,c,u,f,d,h,_,b,w,g,v,y,E,z,D,M,A,O=l[6]===!1&&((Y=l[12])==null?void 0:Y.currentId)&&mr(l),L=(l[0]!==void 0||l[3].length>0||l[5]||(((Z=l[25])==null?void 0:Z.webSearch)??!1)==="always"||l[4]||l[7])&&gr(l);function W(F){l[43](F)}function K(F){l[44](F)}let R={history:l[12]};l[1]!==void 0&&(R.prompt=l[1]),l[2]!==void 0&&(R.files=l[2]),a=new _d({props:R}),l[42](a),Ae.push(()=>Xe(a,"prompt",W)),Ae.push(()=>Xe(a,"files",K)),a.$on("upload",l[45]),a.$on("select",l[46]);const I=[Dd,Sd],P=[];function N(F,X){return F[17]?0:1}return v=N(l),y=P[v]=I[v](l),{c(){e=T("div"),t=T("div"),n=T("div"),o=T("div"),O&&O.c(),s=Q(),i=T("div"),L&&L.c(),r=Q(),ee(a.$$.fragment),d=Q(),h=T("div"),_=T("div"),b=T("div"),w=T("input"),g=Q(),y.c(),this.h()},l(F){e=V(F,"DIV",{class:!0});var X=S(e);t=V(X,"DIV",{class:!0});var se=S(t);n=V(se,"DIV",{class:!0});var q=S(n);o=V(q,"DIV",{class:!0});var G=S(o);O&&O.l(G),G.forEach(p),s=x(q),i=V(q,"DIV",{class:!0});var oe=S(i);L&&L.l(oe),r=x(oe),le(a.$$.fragment,oe),oe.forEach(p),q.forEach(p),se.forEach(p),d=x(X),h=V(X,"DIV",{class:!0});var ae=S(h);_=V(ae,"DIV",{class:!0});var ve=S(_);b=V(ve,"DIV",{class:!0});var $=S(b);w=V($,"INPUT",{type:!0}),g=x($),y.l($),$.forEach(p),ve.forEach(p),ae.forEach(p),X.forEach(p),this.h()},h(){var F,X;m(o,"class","relative"),m(i,"class","w-full relative"),m(n,"class",f="flex flex-col px-3 "+(((F=l[25])==null?void 0:F.widescreenMode)??null?"max-w-full":"max-w-6xl")+" w-full"),m(t,"class","mx-auto inset-x-0 bg-transparent flex justify-center"),m(w,"type","file"),w.hidden=!0,w.multiple=!0,m(b,"class",""),m(_,"class",E=(((X=l[25])==null?void 0:X.widescreenMode)??null?"max-w-full":"max-w-6xl")+" px-2.5 mx-auto inset-x-0"),m(h,"class",z=l[8]?"bg-transparent":"bg-white dark:bg-gray-900"),m(e,"class","w-full font-primary")},m(F,X){B(F,e,X),k(e,t),k(t,n),k(n,o),O&&O.m(o,null),k(n,s),k(n,i),L&&L.m(i,null),k(i,r),te(a,i,null),k(e,d),k(e,h),k(h,_),k(_,b),k(b,w),l[47](w),k(b,g),P[v].m(b,null),D=!0,M||(A=[Se(w,"change",l[48]),Se(w,"change",l[49])],M=!0)},p(F,X){var G,oe,ae,ve;F[6]===!1&&((G=F[12])!=null&&G.currentId)?O?O.p(F,X):(O=mr(F),O.c(),O.m(o,null)):O&&(O.d(1),O=null),F[0]!==void 0||F[3].length>0||F[5]||(((oe=F[25])==null?void 0:oe.webSearch)??!1)==="always"||F[4]||F[7]?L?(L.p(F,X),X[0]&33554617&&C(L,1)):(L=gr(F),L.c(),C(L,1),L.m(i,r)):L&&(Ve(),H(L,1,1,()=>{L=null}),ze());const se={};X[0]&4096&&(se.history=F[12]),!c&&X[0]&2&&(c=!0,se.prompt=F[1],Ge(()=>c=!1)),!u&&X[0]&4&&(u=!0,se.files=F[2],Ge(()=>u=!1)),a.$set(se),(!D||X[0]&33554432&&f!==(f="flex flex-col px-3 "+(((ae=F[25])==null?void 0:ae.widescreenMode)??null?"max-w-full":"max-w-6xl")+" w-full"))&&m(n,"class",f);let q=v;v=N(F),v===q?P[v].p(F,X):(Ve(),H(P[q],1,1,()=>{P[q]=null}),ze(),y=P[v],y?y.p(F,X):(y=P[v]=I[v](F),y.c()),C(y,1),y.m(b,null)),(!D||X[0]&33554432&&E!==(E=(((ve=F[25])==null?void 0:ve.widescreenMode)??null?"max-w-full":"max-w-6xl")+" px-2.5 mx-auto inset-x-0"))&&m(_,"class",E),(!D||X[0]&256&&z!==(z=F[8]?"bg-transparent":"bg-white dark:bg-gray-900"))&&m(h,"class",z)},i(F){D||(C(L),C(a.$$.fragment,F),C(y),D=!0)},o(F){H(L),H(a.$$.fragment,F),H(y),D=!1},d(F){F&&p(e),O&&O.d(),L&&L.d(),l[42](null),ne(a),l[47](null),P[v].d(),M=!1,sn(A)}}}function mr(l){let e,t,n='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path fill-rule="evenodd" d="M10 3a.75.75 0 01.75.75v10.638l3.96-4.158a.75.75 0 111.08 1.04l-5.25 5.5a.75.75 0 01-1.08 0l-5.25-5.5a.75.75 0 111.08-1.04l3.96 4.158V3.75A.75.75 0 0110 3z" clip-rule="evenodd"></path></svg>',o,s;return{c(){e=T("div"),t=T("button"),t.innerHTML=n,this.h()},l(i){e=V(i,"DIV",{class:!0});var r=S(e);t=V(r,"BUTTON",{class:!0,"data-svelte-h":!0}),it(t)!=="svelte-h8r9o0"&&(t.innerHTML=n),r.forEach(p),this.h()},h(){m(t,"class","bg-white border border-gray-100 dark:border-none dark:bg-white/20 p-1.5 rounded-full pointer-events-auto"),m(e,"class","absolute -top-12 left-0 right-0 flex justify-center z-30 pointer-events-none")},m(i,r){B(i,e,r),k(e,t),o||(s=Se(t,"click",l[38]),o=!0)},p:De,d(i){i&&p(e),o=!1,s()}}}function gr(l){var d,h,_;let e,t,n,o,s,i,r=l[3].length>0&&pr(l),a=(l[5]||(((h=(d=l[26])==null?void 0:d.features)==null?void 0:h.enable_web_search)&&(((_=l[25])==null?void 0:_.webSearch)??!1))==="always")&&vr(l),c=l[4]&&wr(l),u=l[7]&&yr(l),f=l[0]!==void 0&&kr(l);return{c(){e=T("div"),r&&r.c(),t=Q(),a&&a.c(),n=Q(),c&&c.c(),o=Q(),u&&u.c(),s=Q(),f&&f.c(),this.h()},l(b){e=V(b,"DIV",{class:!0});var w=S(e);r&&r.l(w),t=x(w),a&&a.l(w),n=x(w),c&&c.l(w),o=x(w),u&&u.l(w),s=x(w),f&&f.l(w),w.forEach(p),this.h()},h(){m(e,"class","px-3 pb-0.5 pt-1.5 text-left w-full flex flex-col absolute bottom-0 left-0 right-0 bg-linear-to-t from-white dark:from-gray-900 z-10")},m(b,w){B(b,e,w),r&&r.m(e,null),k(e,t),a&&a.m(e,null),k(e,n),c&&c.m(e,null),k(e,o),u&&u.m(e,null),k(e,s),f&&f.m(e,null),i=!0},p(b,w){var g,v,y;b[3].length>0?r?(r.p(b,w),w[0]&8&&C(r,1)):(r=pr(b),r.c(),C(r,1),r.m(e,t)):r&&(Ve(),H(r,1,1,()=>{r=null}),ze()),b[5]||(((v=(g=b[26])==null?void 0:g.features)==null?void 0:v.enable_web_search)&&(((y=b[25])==null?void 0:y.webSearch)??!1))==="always"?a?a.p(b,w):(a=vr(b),a.c(),a.m(e,n)):a&&(a.d(1),a=null),b[4]?c?c.p(b,w):(c=wr(b),c.c(),c.m(e,o)):c&&(c.d(1),c=null),b[7]?u?u.p(b,w):(u=yr(b),u.c(),u.m(e,s)):u&&(u.d(1),u=null),b[0]!==void 0?f?(f.p(b,w),w[0]&1&&C(f,1)):(f=kr(b),f.c(),C(f,1),f.m(e,null)):f&&(Ve(),H(f,1,1,()=>{f=null}),ze())},i(b){i||(C(r),C(f),i=!0)},o(b){H(r),H(f),i=!1},d(b){b&&p(e),r&&r.d(),a&&a.d(),c&&c.d(),u&&u.d(),f&&f.d()}}}function pr(l){let e,t,n,o='<span class="relative flex size-2"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-yellow-400 opacity-75"></span> <span class="relative inline-flex rounded-full size-2 bg-yellow-500"></span></span>',s,i,r=[],a=new Map,c,u=ht(l[3].map(l[39]));const f=d=>d[93];for(let d=0;d<u.length;d+=1){let h=dr(l,u,d),_=f(h);a.set(_,r[d]=br(_,h))}return{c(){e=T("div"),t=T("div"),n=T("div"),n.innerHTML=o,s=Q(),i=T("div");for(let d=0;d<r.length;d+=1)r[d].c();this.h()},l(d){e=V(d,"DIV",{class:!0});var h=S(e);t=V(h,"DIV",{class:!0});var _=S(t);n=V(_,"DIV",{class:!0,"data-svelte-h":!0}),it(n)!=="svelte-1exsj7u"&&(n.innerHTML=o),s=x(_),i=V(_,"DIV",{class:!0});var b=S(i);for(let w=0;w<r.length;w+=1)r[w].l(b);b.forEach(p),_.forEach(p),h.forEach(p),this.h()},h(){m(n,"class","pl-1"),m(i,"class","text-ellipsis line-clamp-1 flex"),m(t,"class","flex items-center gap-2.5 text-sm dark:text-gray-500"),m(e,"class","flex items-center justify-between w-full")},m(d,h){B(d,e,h),k(e,t),k(t,n),k(t,s),k(t,i);for(let _=0;_<r.length;_+=1)r[_]&&r[_].m(i,null);c=!0},p(d,h){h[0]&134217736&&(u=ht(d[3].map(d[39])),Ve(),r=Io(r,h,f,1,d,u,a,i,So,br,null,dr),ze())},i(d){if(!c){for(let h=0;h<u.length;h+=1)C(r[h]);c=!0}},o(d){for(let h=0;h<r.length;h+=1)H(r[h]);c=!1},d(d){d&&p(e);for(let h=0;h<r.length;h+=1)r[h].d()}}}function Id(l){let e=l[91].name+"",t;return{c(){t=ke(e)},l(n){t=Ee(n,e)},m(n,o){B(n,t,o)},p(n,o){o[0]&134217736&&e!==(e=n[91].name+"")&&Ce(t,e)},d(n){n&&p(t)}}}function _r(l){let e,t=", ";return{c(){e=T("span"),e.textContent=t},l(n){e=V(n,"SPAN",{"data-svelte-h":!0}),it(e)!=="svelte-1okzske"&&(e.textContent=t)},m(n,o){B(n,e,o)},d(n){n&&p(e)}}}function br(l,e){var a,c;let t,n,o,s,i;n=new Ft({props:{content:((c=(a=e[91])==null?void 0:a.meta)==null?void 0:c.description)??"",className:" "+(e[93]!==0?"pl-0.5":"")+" shrink-0",placement:"top",$$slots:{default:[Id]},$$scope:{ctx:e}}});let r=e[93]!==e[3].length-1&&_r();return{key:l,first:null,c(){t=Te(),ee(n.$$.fragment),o=Q(),r&&r.c(),s=Te(),this.h()},l(u){t=Te(),le(n.$$.fragment,u),o=x(u),r&&r.l(u),s=Te(),this.h()},h(){this.first=t},m(u,f){B(u,t,f),te(n,u,f),B(u,o,f),r&&r.m(u,f),B(u,s,f),i=!0},p(u,f){var h,_;e=u;const d={};f[0]&134217736&&(d.content=((_=(h=e[91])==null?void 0:h.meta)==null?void 0:_.description)??""),f[0]&134217736&&(d.className=" "+(e[93]!==0?"pl-0.5":"")+" shrink-0"),f[0]&134217736|f[3]&2&&(d.$$scope={dirty:f,ctx:e}),n.$set(d),e[93]!==e[3].length-1?r||(r=_r(),r.c(),r.m(s.parentNode,s)):r&&(r.d(1),r=null)},i(u){i||(C(n.$$.fragment,u),i=!0)},o(u){H(n.$$.fragment,u),i=!1},d(u){u&&(p(t),p(o),p(s)),ne(n,u),r&&r.d(u)}}}function vr(l){let e,t,n,o='<span class="relative flex size-2"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-blue-400 opacity-75"></span> <span class="relative inline-flex rounded-full size-2 bg-blue-500"></span></span>',s,i,r=l[24].t("Search the internet")+"",a;return{c(){e=T("div"),t=T("div"),n=T("div"),n.innerHTML=o,s=Q(),i=T("div"),a=ke(r),this.h()},l(c){e=V(c,"DIV",{class:!0});var u=S(e);t=V(u,"DIV",{class:!0});var f=S(t);n=V(f,"DIV",{class:!0,"data-svelte-h":!0}),it(n)!=="svelte-19sghfm"&&(n.innerHTML=o),s=x(f),i=V(f,"DIV",{class:!0});var d=S(i);a=Ee(d,r),d.forEach(p),f.forEach(p),u.forEach(p),this.h()},h(){m(n,"class","pl-1"),m(i,"class","translate-y-[0.5px]"),m(t,"class","flex items-center gap-2.5 text-sm dark:text-gray-500"),m(e,"class","flex items-center justify-between w-full")},m(c,u){B(c,e,u),k(e,t),k(t,n),k(t,s),k(t,i),k(i,a)},p(c,u){u[0]&16777216&&r!==(r=c[24].t("Search the internet")+"")&&Ce(a,r)},d(c){c&&p(e)}}}function wr(l){let e,t,n,o='<span class="relative flex size-2"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-teal-400 opacity-75"></span> <span class="relative inline-flex rounded-full size-2 bg-teal-500"></span></span>',s,i,r=l[24].t("Generate an image")+"",a;return{c(){e=T("div"),t=T("div"),n=T("div"),n.innerHTML=o,s=Q(),i=T("div"),a=ke(r),this.h()},l(c){e=V(c,"DIV",{class:!0});var u=S(e);t=V(u,"DIV",{class:!0});var f=S(t);n=V(f,"DIV",{class:!0,"data-svelte-h":!0}),it(n)!=="svelte-kf1e3u"&&(n.innerHTML=o),s=x(f),i=V(f,"DIV",{class:!0});var d=S(i);a=Ee(d,r),d.forEach(p),f.forEach(p),u.forEach(p),this.h()},h(){m(n,"class","pl-1"),m(i,"class","translate-y-[0.5px]"),m(t,"class","flex items-center gap-2.5 text-sm dark:text-gray-500"),m(e,"class","flex items-center justify-between w-full")},m(c,u){B(c,e,u),k(e,t),k(t,n),k(t,s),k(t,i),k(i,a)},p(c,u){u[0]&16777216&&r!==(r=c[24].t("Generate an image")+"")&&Ce(a,r)},d(c){c&&p(e)}}}function yr(l){let e,t,n,o='<span class="relative flex size-2"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"></span> <span class="relative inline-flex rounded-full size-2 bg-green-500"></span></span>',s,i,r=l[24].t("Execute code for analysis")+"",a;return{c(){e=T("div"),t=T("div"),n=T("div"),n.innerHTML=o,s=Q(),i=T("div"),a=ke(r),this.h()},l(c){e=V(c,"DIV",{class:!0});var u=S(e);t=V(u,"DIV",{class:!0});var f=S(t);n=V(f,"DIV",{class:!0,"data-svelte-h":!0}),it(n)!=="svelte-12j611w"&&(n.innerHTML=o),s=x(f),i=V(f,"DIV",{class:!0});var d=S(i);a=Ee(d,r),d.forEach(p),f.forEach(p),u.forEach(p),this.h()},h(){m(n,"class","pl-1"),m(i,"class","translate-y-[0.5px]"),m(t,"class","flex items-center gap-2.5 text-sm dark:text-gray-500"),m(e,"class","flex items-center justify-between w-full")},m(c,u){B(c,e,u),k(e,t),k(t,n),k(t,s),k(t,i),k(i,a)},p(c,u){u[0]&16777216&&r!==(r=c[24].t("Execute code for analysis")+"")&&Ce(a,r)},d(c){c&&p(e)}}}function kr(l){let e,t,n,o,s,i,r,a,c=l[0].name+"",u,f,d,h,_,b,w,g;return _=new zo({}),{c(){e=T("div"),t=T("div"),n=T("img"),s=Q(),i=T("div"),r=ke("Talking to "),a=T("span"),u=ke(c),f=Q(),d=T("div"),h=T("button"),ee(_.$$.fragment),this.h()},l(v){e=V(v,"DIV",{class:!0});var y=S(e);t=V(y,"DIV",{class:!0});var E=S(t);n=V(E,"IMG",{crossorigin:!0,alt:!0,class:!0,src:!0}),s=x(E),i=V(E,"DIV",{class:!0});var z=S(i);r=Ee(z,"Talking to "),a=V(z,"SPAN",{class:!0});var D=S(a);u=Ee(D,c),D.forEach(p),z.forEach(p),E.forEach(p),f=x(y),d=V(y,"DIV",{});var M=S(d);h=V(M,"BUTTON",{class:!0});var A=S(h);le(_.$$.fragment,A),A.forEach(p),M.forEach(p),y.forEach(p),this.h()},h(){var v,y,E;m(n,"crossorigin","anonymous"),m(n,"alt","model profile"),m(n,"class","size-3.5 max-w-[28px] object-cover rounded-full"),Yn(n.src,o=((E=(y=(v=l[14].find(l[40]))==null?void 0:v.info)==null?void 0:y.meta)==null?void 0:E.profile_image_url)??(l[24].language==="dg-DG"?"/doge.png":`${Fl}/static/favicon.png`))||m(n,"src",o),m(a,"class","font-medium"),m(i,"class","translate-y-[0.5px]"),m(t,"class","pl-[1px] flex items-center gap-2 text-sm dark:text-gray-500"),m(h,"class","flex items-center dark:text-gray-500"),m(e,"class","flex items-center justify-between w-full")},m(v,y){B(v,e,y),k(e,t),k(t,n),k(t,s),k(t,i),k(i,r),k(i,a),k(a,u),k(e,f),k(e,d),k(d,h),te(_,h,null),b=!0,w||(g=Se(h,"click",l[41]),w=!0)},p(v,y){var E,z,D;(!b||y[0]&16793601&&!Yn(n.src,o=((D=(z=(E=v[14].find(v[40]))==null?void 0:E.info)==null?void 0:z.meta)==null?void 0:D.profile_image_url)??(v[24].language==="dg-DG"?"/doge.png":`${Fl}/static/favicon.png`)))&&m(n,"src",o),(!b||y[0]&1)&&c!==(c=v[0].name+"")&&Ce(u,c)},i(v){b||(C(_.$$.fragment,v),b=!0)},o(v){H(_.$$.fragment,v),b=!1},d(v){v&&p(e),ne(_),w=!1,g()}}}function Sd(l){var Z,F;let e,t,n,o,s,i,r,a,c,u,f,d,h,_,b,w,g,v,y,E,z,D,M=l[2].length>0&&Er(l);const A=[Nd,zd],O=[];function L(X,se){var q;return((q=X[25])==null?void 0:q.richTextInput)??!0?0:1}s=L(l),i=O[s]=A[s](l);function W(X){l[74](X)}let K={screenCaptureHandler:l[34],inputFilesHandler:l[36],uploadFilesHandler:l[70],uploadGoogleDriveHandler:l[71],uploadOneDriveHandler:l[72],onClose:l[73],$$slots:{default:[Pd]},$$scope:{ctx:l}};l[3]!==void 0&&(K.selectedToolIds=l[3]),u=new Uf({props:K}),Ae.push(()=>Xe(u,"selectedToolIds",W));let R=l[29]&&Dr(l),I=(!((Z=l[12])!=null&&Z.currentId)||((F=l[12].messages[l[12].currentId])==null?void 0:F.done)==!0)&&Tr(l);const P=[Bd,Ld],N=[];function Y(X,se){var q;return!X[12].currentId||((q=X[12].messages[X[12].currentId])==null?void 0:q.done)==!0?0:1}return g=Y(l),v=N[g]=P[g](l),{c(){e=T("form"),t=T("div"),M&&M.c(),n=Q(),o=T("div"),i.c(),r=Q(),a=T("div"),c=T("div"),ee(u.$$.fragment),d=Q(),h=T("div"),R&&R.c(),_=Q(),b=T("div"),I&&I.c(),w=Q(),v.c(),this.h()},l(X){e=V(X,"FORM",{class:!0});var se=S(e);t=V(se,"DIV",{class:!0,dir:!0});var q=S(t);M&&M.l(q),n=x(q),o=V(q,"DIV",{class:!0});var G=S(o);i.l(G),G.forEach(p),r=x(q),a=V(q,"DIV",{class:!0});var oe=S(a);c=V(oe,"DIV",{class:!0});var ae=S(c);le(u.$$.fragment,ae),d=x(ae),h=V(ae,"DIV",{class:!0});var ve=S(h);R&&R.l(ve),ve.forEach(p),ae.forEach(p),_=x(oe),b=V(oe,"DIV",{class:!0});var $=S(b);I&&I.l($),w=x($),v.l($),$.forEach(p),oe.forEach(p),q.forEach(p),se.forEach(p),this.h()},h(){var X;m(o,"class","px-2.5"),m(h,"class","flex gap-0.5 items-center overflow-x-auto scrollbar-none flex-1"),m(c,"class","ml-1 self-end gap-0.5 flex items-center flex-1 max-w-[80%]"),m(b,"class","self-end flex space-x-1 mr-1 shrink-0"),m(a,"class","flex justify-between mt-1.5 mb-2.5 mx-0.5 max-w-full"),m(t,"class","flex-1 flex flex-col relative w-full rounded-3xl px-1 bg-gray-600/5 dark:bg-gray-400/5 dark:text-gray-100"),m(t,"dir",y=((X=l[25])==null?void 0:X.chatDirection)??"LTR"),m(e,"class","w-full flex gap-1.5")},m(X,se){B(X,e,se),k(e,t),M&&M.m(t,null),k(t,n),k(t,o),O[s].m(o,null),k(t,r),k(t,a),k(a,c),te(u,c,null),k(c,d),k(c,h),R&&R.m(h,null),k(a,_),k(a,b),I&&I.m(b,null),k(b,w),N[g].m(b,null),E=!0,z||(D=Se(e,"submit",Eo(l[81])),z=!0)},p(X,se){var ae,ve,$;X[2].length>0?M?(M.p(X,se),se[0]&4&&C(M,1)):(M=Er(X),M.c(),C(M,1),M.m(t,n)):M&&(Ve(),H(M,1,1,()=>{M=null}),ze());let q=s;s=L(X),s===q?O[s].p(X,se):(Ve(),H(O[q],1,1,()=>{O[q]=null}),ze(),i=O[s],i?i.p(X,se):(i=O[s]=A[s](X),i.c()),C(i,1),i.m(o,null));const G={};se[0]&524288&&(G.uploadFilesHandler=X[70]),se[0]&16777216&&(G.uploadGoogleDriveHandler=X[71]),se[3]&2&&(G.$$scope={dirty:se,ctx:X}),!f&&se[0]&8&&(f=!0,G.selectedToolIds=X[3],Ge(()=>f=!1)),u.$set(G),X[29]?R?(R.p(X,se),se[0]&536870912&&C(R,1)):(R=Dr(X),R.c(),C(R,1),R.m(h,null)):R&&(Ve(),H(R,1,1,()=>{R=null}),ze()),!((ae=X[12])!=null&&ae.currentId)||((ve=X[12].messages[X[12].currentId])==null?void 0:ve.done)==!0?I?(I.p(X,se),se[0]&4096&&C(I,1)):(I=Tr(X),I.c(),C(I,1),I.m(b,w)):I&&(Ve(),H(I,1,1,()=>{I=null}),ze());let oe=g;g=Y(X),g===oe?N[g].p(X,se):(Ve(),H(N[oe],1,1,()=>{N[oe]=null}),ze(),v=N[g],v?v.p(X,se):(v=N[g]=P[g](X),v.c()),C(v,1),v.m(b,null)),(!E||se[0]&33554432&&y!==(y=(($=X[25])==null?void 0:$.chatDirection)??"LTR"))&&m(t,"dir",y)},i(X){E||(C(M),C(i),C(u.$$.fragment,X),C(R),C(I),C(v),E=!0)},o(X){H(M),H(i),H(u.$$.fragment,X),H(R),H(I),H(v),E=!1},d(X){X&&p(e),M&&M.d(),O[s].d(),ne(u),R&&R.d(),I&&I.d(),N[g].d(),z=!1,D()}}}function Dd(l){let e,t,n;function o(i){l[50](i)}let s={};return l[17]!==void 0&&(s.recording=l[17]),e=new $c({props:s}),Ae.push(()=>Xe(e,"recording",o)),e.$on("cancel",l[51]),e.$on("confirm",l[52]),{c(){ee(e.$$.fragment)},l(i){le(e.$$.fragment,i)},m(i,r){te(e,i,r),n=!0},p(i,r){const a={};!t&&r[0]&131072&&(t=!0,a.recording=i[17],Ge(()=>t=!1)),e.$set(a)},i(i){n||(C(e.$$.fragment,i),n=!0)},o(i){H(e.$$.fragment,i),n=!1},d(i){ne(e,i)}}}function Er(l){let e,t,n=ht(l[2]),o=[];for(let i=0;i<n.length;i+=1)o[i]=Sr(fr(l,n,i));const s=i=>H(o[i],1,1,()=>{o[i]=null});return{c(){e=T("div");for(let i=0;i<o.length;i+=1)o[i].c();this.h()},l(i){e=V(i,"DIV",{class:!0});var r=S(e);for(let a=0;a<o.length;a+=1)o[a].l(r);r.forEach(p),this.h()},h(){m(e,"class","mx-2 mt-2.5 -mb-1 flex items-center flex-wrap gap-2")},m(i,r){B(i,e,r);for(let a=0;a<o.length;a+=1)o[a]&&o[a].m(e,null);t=!0},p(i,r){if(r[0]&25167877){n=ht(i[2]);let a;for(a=0;a<n.length;a+=1){const c=fr(i,n,a);o[a]?(o[a].p(c,r),C(o[a],1)):(o[a]=Sr(c),o[a].c(),C(o[a],1),o[a].m(e,null))}for(Ve(),a=n.length;a<o.length;a+=1)s(a);ze()}},i(i){if(!t){for(let r=0;r<n.length;r+=1)C(o[r]);t=!0}},o(i){o=o.filter(Boolean);for(let r=0;r<o.length;r+=1)H(o[r]);t=!1},d(i){i&&p(e),vn(o,i)}}}function Cd(l){var s;let e,t;function n(){return l[56](l[88],l[90])}function o(){return l[57](l[88])}return e=new as({props:{item:l[88],name:l[88].name,type:l[88].type,size:(s=l[88])==null?void 0:s.size,loading:l[88].status==="uploading",dismissible:!0,edit:!0}}),e.$on("dismiss",n),e.$on("click",o),{c(){ee(e.$$.fragment)},l(i){le(e.$$.fragment,i)},m(i,r){te(e,i,r),t=!0},p(i,r){var c;l=i;const a={};r[0]&4&&(a.item=l[88]),r[0]&4&&(a.name=l[88].name),r[0]&4&&(a.type=l[88].type),r[0]&4&&(a.size=(c=l[88])==null?void 0:c.size),r[0]&4&&(a.loading=l[88].status==="uploading"),e.$set(a)},i(i){t||(C(e.$$.fragment,i),t=!0)},o(i){H(e.$$.fragment,i),t=!1},d(i){ne(e,i)}}}function Md(l){var o;let e,t;function n(){return l[55](l[88],l[90])}return e=new as({props:{item:l[88],name:l[88].name,type:"excel",size:(o=l[88])==null?void 0:o.size,loading:l[88].status==="uploading",dismissible:!0,edit:!0}}),e.$on("dismiss",n),{c(){ee(e.$$.fragment)},l(s){le(e.$$.fragment,s)},m(s,i){te(e,s,i),t=!0},p(s,i){var a;l=s;const r={};i[0]&4&&(r.item=l[88]),i[0]&4&&(r.name=l[88].name),i[0]&4&&(r.size=(a=l[88])==null?void 0:a.size),i[0]&4&&(r.loading=l[88].status==="uploading"),e.$set(r)},i(s){t||(C(e.$$.fragment,s),t=!0)},o(s){H(e.$$.fragment,s),t=!1},d(s){ne(e,s)}}}function Td(l){let e,t,n,o,s,i,r,a='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-4"><path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"></path></svg>',c,u,f,d;n=new su({props:{src:l[88].url,alt:"input",imageClassName:" size-14 rounded-xl object-cover"}});let h=(l[0]?l[23].length===0:l[11].length!==l[23].length)&&Ir(l);function _(){return l[54](l[90])}return{c(){e=T("div"),t=T("div"),ee(n.$$.fragment),o=Q(),h&&h.c(),s=Q(),i=T("div"),r=T("button"),r.innerHTML=a,c=Q(),this.h()},l(b){e=V(b,"DIV",{class:!0});var w=S(e);t=V(w,"DIV",{class:!0});var g=S(t);le(n.$$.fragment,g),o=x(g),h&&h.l(g),g.forEach(p),s=x(w),i=V(w,"DIV",{class:!0});var v=S(i);r=V(v,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),it(r)!=="svelte-4ewxlv"&&(r.innerHTML=a),v.forEach(p),c=x(w),w.forEach(p),this.h()},h(){m(t,"class","relative flex items-center"),m(r,"class","bg-white text-black border border-white rounded-full group-hover:visible invisible transition"),m(r,"type","button"),m(i,"class","absolute -top-1 -right-1"),m(e,"class","relative group")},m(b,w){B(b,e,w),k(e,t),te(n,t,null),k(t,o),h&&h.m(t,null),k(e,s),k(e,i),k(i,r),k(e,c),u=!0,f||(d=Se(r,"click",_),f=!0)},p(b,w){l=b;const g={};w[0]&4&&(g.src=l[88].url),n.$set(g),(l[0]?l[23].length===0:l[11].length!==l[23].length)?h?(h.p(l,w),w[0]&8390657&&C(h,1)):(h=Ir(l),h.c(),C(h,1),h.m(t,null)):h&&(Ve(),H(h,1,1,()=>{h=null}),ze())},i(b){u||(C(n.$$.fragment,b),C(h),u=!0)},o(b){H(n.$$.fragment,b),H(h),u=!1},d(b){b&&p(e),ne(n),h&&h.d(),f=!1,d()}}}function Ir(l){let e,t;return e=new Ft({props:{className:" absolute top-1 left-1",content:l[24].t("{{ models }}",{models:[...l[0]?[l[0]]:l[11]].filter(l[53]).join(", ")}),$$slots:{default:[Vd]},$$scope:{ctx:l}}}),{c(){ee(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,o){te(e,n,o),t=!0},p(n,o){const s={};o[0]&25167873&&(s.content=n[24].t("{{ models }}",{models:[...n[0]?[n[0]]:n[11]].filter(n[53]).join(", ")})),o[3]&2&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}function Vd(l){let e,t;return{c(){e=_e("svg"),t=_e("path"),this.h()},l(n){e=be(n,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var o=S(e);t=be(o,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),S(t).forEach(p),o.forEach(p),this.h()},h(){m(t,"fill-rule","evenodd"),m(t,"d","M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003ZM12 8.25a.75.75 0 0 1 .75.75v3.75a.75.75 0 0 1-1.5 0V9a.75.75 0 0 1 .75-.75Zm0 8.25a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z"),m(t,"clip-rule","evenodd"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"viewBox","0 0 24 24"),m(e,"fill","currentColor"),m(e,"class","size-4 fill-yellow-300")},m(n,o){B(n,e,o),k(e,t)},p:De,d(n){n&&p(e)}}}function Sr(l){let e,t,n,o,s;const i=[Td,Md,Cd],r=[];function a(c,u){return u[0]&4&&(e=null),c[88].type==="image"?0:(e==null&&(e=!!Kd(c[88])),e?1:2)}return t=a(l,[-1,-1,-1,-1]),n=r[t]=i[t](l),{c(){n.c(),o=Te()},l(c){n.l(c),o=Te()},m(c,u){r[t].m(c,u),B(c,o,u),s=!0},p(c,u){let f=t;t=a(c,u),t===f?r[t].p(c,u):(Ve(),H(r[f],1,1,()=>{r[f]=null}),ze(),n=r[t],n?n.p(c,u):(n=r[t]=i[t](c),n.c()),C(n,1),n.m(o.parentNode,o))},i(c){s||(C(n),s=!0)},o(c){H(n),s=!1},d(c){c&&p(o),r[t].d(c)}}}function zd(l){let e,t,n,o;return{c(){e=T("textarea"),this.h()},l(s){e=V(s,"TEXTAREA",{id:!0,class:!0,placeholder:!0,rows:!0}),S(e).forEach(p),this.h()},h(){m(e,"id","chat-input"),m(e,"class","scrollbar-hidden bg-transparent dark:text-gray-100 outline-hidden w-full pt-3 px-1 resize-none"),m(e,"placeholder",t=l[13]?l[13]:l[24].t("Send a Message")),m(e,"rows","1")},m(s,i){B(s,e,i),l[63](e),In(e,l[1]),n||(o=[Se(e,"input",l[64]),Se(e,"keypress",l[65]),Se(e,"keydown",l[66]),Se(e,"input",l[67]),Se(e,"focus",l[68]),Se(e,"paste",l[69])],n=!0)},p(s,i){i[0]&16785408&&t!==(t=s[13]?s[13]:s[24].t("Send a Message"))&&m(e,"placeholder",t),i[0]&2&&In(e,s[1])},i:De,o:De,d(s){s&&p(e),l[63](null),n=!1,sn(o)}}}function Nd(l){var r,a;let e,t,n,o;function s(c){l[60](c)}let i={id:"chat-input",messageInput:!0,shiftEnter:!l[28]||!("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0),placeholder:l[13]?l[13]:l[24].t("Send a Message"),largeTextAsFile:((r=l[25])==null?void 0:r.largeTextAsFile)??!1,autocomplete:(a=l[26])==null?void 0:a.features.enable_autocomplete_generation,generateAutoCompletion:l[58]};return l[1]!==void 0&&(i.value=l[1]),t=new eu({props:i}),l[59](t),Ae.push(()=>Xe(t,"value",s)),t.$on("keydown",l[61]),t.$on("paste",l[62]),{c(){e=T("div"),ee(t.$$.fragment),this.h()},l(c){e=V(c,"DIV",{class:!0});var u=S(e);le(t.$$.fragment,u),u.forEach(p),this.h()},h(){m(e,"class","scrollbar-hidden text-left bg-transparent dark:text-gray-100 outline-hidden w-full pt-3 px-1 resize-none h-fit max-h-80 overflow-auto")},m(c,u){B(c,e,u),te(t,e,null),o=!0},p(c,u){var d,h;const f={};u[0]&268435456&&(f.shiftEnter=!c[28]||!("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0)),u[0]&16785408&&(f.placeholder=c[13]?c[13]:c[24].t("Send a Message")),u[0]&33554432&&(f.largeTextAsFile=((d=c[25])==null?void 0:d.largeTextAsFile)??!1),u[0]&67108864&&(f.autocomplete=(h=c[26])==null?void 0:h.features.enable_autocomplete_generation),u[0]&16814080&&(f.generateAutoCompletion=c[58]),!n&&u[0]&2&&(n=!0,f.value=c[1],Ge(()=>n=!1)),t.$set(f)},i(c){o||(C(t.$$.fragment,c),o=!0)},o(c){H(t.$$.fragment,c),o=!1},d(c){c&&p(e),l[59](null),ne(t)}}}function Pd(l){let e,t='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-5"><path d="M10.75 4.75a.75.75 0 0 0-1.5 0v4.5h-4.5a.75.75 0 0 0 0 1.5h4.5v4.5a.75.75 0 0 0 1.5 0v-4.5h4.5a.75.75 0 0 0 0-1.5h-4.5v-4.5Z"></path></svg>';return{c(){e=T("button"),e.innerHTML=t,this.h()},l(n){e=V(n,"BUTTON",{class:!0,type:!0,"aria-label":!0,"data-svelte-h":!0}),it(e)!=="svelte-ys0us"&&(e.innerHTML=t),this.h()},h(){m(e,"class","bg-transparent hover:bg-gray-100 text-gray-800 dark:text-white dark:hover:bg-gray-800 transition rounded-full p-1.5 outline-hidden focus:outline-hidden"),m(e,"type","button"),m(e,"aria-label","More")},m(n,o){B(n,e,o)},p:De,d(n){n&&p(e)}}}function Dr(l){var a,c,u,f,d,h,_,b,w,g;let e,t,n,o,s=((c=(a=l[26])==null?void 0:a.features)==null?void 0:c.enable_web_search)&&(l[29].role==="admin"||((d=(f=(u=l[29])==null?void 0:u.permissions)==null?void 0:f.features)==null?void 0:d.web_search))&&Cr(l),i=((_=(h=l[26])==null?void 0:h.features)==null?void 0:_.enable_image_generation)&&(l[29].role==="admin"||((g=(w=(b=l[29])==null?void 0:b.permissions)==null?void 0:w.features)==null?void 0:g.image_generation))&&Mr(l),r=!1;return{c(){s&&s.c(),e=Q(),i&&i.c(),t=Q(),n=Te()},l(v){s&&s.l(v),e=x(v),i&&i.l(v),t=x(v),n=Te()},m(v,y){s&&s.m(v,y),B(v,e,y),i&&i.m(v,y),B(v,t,y),B(v,n,y),o=!0},p(v,y){var E,z,D,M,A,O,L,W,K,R;(z=(E=v[26])==null?void 0:E.features)!=null&&z.enable_web_search&&(v[29].role==="admin"||(A=(M=(D=v[29])==null?void 0:D.permissions)==null?void 0:M.features)!=null&&A.web_search)?s?(s.p(v,y),y[0]&603979776&&C(s,1)):(s=Cr(v),s.c(),C(s,1),s.m(e.parentNode,e)):s&&(Ve(),H(s,1,1,()=>{s=null}),ze()),(L=(O=v[26])==null?void 0:O.features)!=null&&L.enable_image_generation&&(v[29].role==="admin"||(R=(K=(W=v[29])==null?void 0:W.permissions)==null?void 0:K.features)!=null&&R.image_generation)?i?(i.p(v,y),y[0]&603979776&&C(i,1)):(i=Mr(v),i.c(),C(i,1),i.m(t.parentNode,t)):i&&(Ve(),H(i,1,1,()=>{i=null}),ze())},i(v){o||(C(s),C(i),C(r),o=!0)},o(v){H(s),H(i),H(r),o=!1},d(v){v&&(p(e),p(t),p(n)),s&&s.d(v),i&&i.d(v)}}}function Cr(l){let e,t;return e=new Ft({props:{content:l[24].t("Search the internet"),placement:"top",$$slots:{default:[Od]},$$scope:{ctx:l}}}),{c(){ee(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,o){te(e,n,o),t=!0},p(n,o){const s={};o[0]&16777216&&(s.content=n[24].t("Search the internet")),o[0]&50331680|o[3]&2&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}function Od(l){let e,t,n,o,s=l[24].t("Web Search")+"",i,r,a,c,u;return t=new cu({props:{className:"size-5",strokeWidth:"1.75"}}),{c(){e=T("button"),ee(t.$$.fragment),n=Q(),o=T("span"),i=ke(s),this.h()},l(f){e=V(f,"BUTTON",{type:!0,class:!0});var d=S(e);le(t.$$.fragment,d),n=x(d),o=V(d,"SPAN",{class:!0});var h=S(o);i=Ee(h,s),h.forEach(p),d.forEach(p),this.h()},h(){var f;m(o,"class","hidden @sm:block whitespace-nowrap overflow-hidden text-ellipsis translate-y-[0.5px] mr-0.5"),m(e,"type","button"),m(e,"class",r="px-1.5 @sm:px-2.5 py-1.5 flex gap-1.5 items-center text-sm rounded-full font-medium transition-colors duration-300 focus:outline-hidden max-w-full overflow-hidden "+(l[5]||(((f=l[25])==null?void 0:f.webSearch)??!1)==="always"?"bg-blue-100 dark:bg-blue-500/20 text-blue-500 dark:text-blue-400":"bg-transparent text-gray-600 dark:text-gray-300 border-gray-200 hover:bg-gray-100 dark:hover:bg-gray-800"))},m(f,d){B(f,e,d),te(t,e,null),k(e,n),k(e,o),k(o,i),a=!0,c||(u=Se(e,"click",Eo(l[75])),c=!0)},p(f,d){var h;(!a||d[0]&16777216)&&s!==(s=f[24].t("Web Search")+"")&&Ce(i,s),(!a||d[0]&33554464&&r!==(r="px-1.5 @sm:px-2.5 py-1.5 flex gap-1.5 items-center text-sm rounded-full font-medium transition-colors duration-300 focus:outline-hidden max-w-full overflow-hidden "+(f[5]||(((h=f[25])==null?void 0:h.webSearch)??!1)==="always"?"bg-blue-100 dark:bg-blue-500/20 text-blue-500 dark:text-blue-400":"bg-transparent text-gray-600 dark:text-gray-300 border-gray-200 hover:bg-gray-100 dark:hover:bg-gray-800")))&&m(e,"class",r)},i(f){a||(C(t.$$.fragment,f),a=!0)},o(f){H(t.$$.fragment,f),a=!1},d(f){f&&p(e),ne(t),c=!1,u()}}}function Mr(l){let e,t;return e=new Ft({props:{content:l[24].t("Generate an image"),placement:"top",$$slots:{default:[Hd]},$$scope:{ctx:l}}}),{c(){ee(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,o){te(e,n,o),t=!0},p(n,o){const s={};o[0]&16777216&&(s.content=n[24].t("Generate an image")),o[0]&16777232|o[3]&2&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}function Hd(l){let e,t,n,o,s=l[24].t("Image")+"",i,r,a,c,u;return t=new Ed({props:{className:"size-5",strokeWidth:"1.75"}}),{c(){e=T("button"),ee(t.$$.fragment),n=Q(),o=T("span"),i=ke(s),this.h()},l(f){e=V(f,"BUTTON",{type:!0,class:!0});var d=S(e);le(t.$$.fragment,d),n=x(d),o=V(d,"SPAN",{class:!0});var h=S(o);i=Ee(h,s),h.forEach(p),d.forEach(p),this.h()},h(){m(o,"class","hidden @sm:block whitespace-nowrap overflow-hidden text-ellipsis translate-y-[0.5px] mr-0.5"),m(e,"type","button"),m(e,"class",r="px-1.5 @sm:px-2.5 py-1.5 flex gap-1.5 items-center text-sm rounded-full font-medium transition-colors duration-300 focus:outline-hidden max-w-full overflow-hidden "+(l[4]?"bg-gray-100 dark:bg-gray-500/20 text-gray-600 dark:text-gray-400":"bg-transparent text-gray-600 dark:text-gray-300 border-gray-200 hover:bg-gray-100 dark:hover:bg-gray-800 "))},m(f,d){B(f,e,d),te(t,e,null),k(e,n),k(e,o),k(o,i),a=!0,c||(u=Se(e,"click",Eo(l[76])),c=!0)},p(f,d){(!a||d[0]&16777216)&&s!==(s=f[24].t("Image")+"")&&Ce(i,s),(!a||d[0]&16&&r!==(r="px-1.5 @sm:px-2.5 py-1.5 flex gap-1.5 items-center text-sm rounded-full font-medium transition-colors duration-300 focus:outline-hidden max-w-full overflow-hidden "+(f[4]?"bg-gray-100 dark:bg-gray-500/20 text-gray-600 dark:text-gray-400":"bg-transparent text-gray-600 dark:text-gray-300 border-gray-200 hover:bg-gray-100 dark:hover:bg-gray-800 ")))&&m(e,"class",r)},i(f){a||(C(t.$$.fragment,f),a=!0)},o(f){H(t.$$.fragment,f),a=!1},d(f){f&&p(e),ne(t),c=!1,u()}}}function Tr(l){let e,t;return e=new Ft({props:{content:l[24].t("Record voice"),$$slots:{default:[Ad]},$$scope:{ctx:l}}}),{c(){ee(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,o){te(e,n,o),t=!0},p(n,o){const s={};o[0]&16777216&&(s.content=n[24].t("Record voice")),o[0]&16908288|o[3]&2&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}function Ad(l){let e,t='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5 translate-y-[0.5px]"><path d="M7 4a3 3 0 016 0v6a3 3 0 11-6 0V4z"></path><path d="M5.5 9.643a.75.75 0 00-1.5 0V10c0 3.06 2.29 5.585 5.25 5.954V17.5h-1.5a.75.75 0 000 1.5h4.5a.75.75 0 000-1.5h-1.5v-1.546A6.001 6.001 0 0016 10v-.357a.75.75 0 00-1.5 0V10a4.5 4.5 0 01-9 0v-.357z"></path></svg>',n,o;return{c(){e=T("button"),e.innerHTML=t,this.h()},l(s){e=V(s,"BUTTON",{id:!0,class:!0,type:!0,"aria-label":!0,"data-svelte-h":!0}),it(e)!=="svelte-4nqm9k"&&(e.innerHTML=t),this.h()},h(){m(e,"id","voice-input-button"),m(e,"class","text-gray-600 dark:text-gray-300 hover:text-gray-700 dark:hover:text-gray-200 transition rounded-full p-1.5 mr-0.5 self-center"),m(e,"type","button"),m(e,"aria-label","Voice Input")},m(s,i){B(s,e,i),n||(o=Se(e,"click",l[78]),n=!0)},p:De,d(s){s&&p(e),n=!1,o()}}}function Ld(l){let e,t,n;return t=new Ft({props:{content:l[24].t("Stop"),$$slots:{default:[Rd]},$$scope:{ctx:l}}}),{c(){e=T("div"),ee(t.$$.fragment),this.h()},l(o){e=V(o,"DIV",{class:!0});var s=S(e);le(t.$$.fragment,s),s.forEach(p),this.h()},h(){m(e,"class","flex items-center")},m(o,s){B(o,e,s),te(t,e,null),n=!0},p(o,s){const i={};s[0]&16777216&&(i.content=o[24].t("Stop")),s[0]&1024|s[3]&2&&(i.$$scope={dirty:s,ctx:o}),t.$set(i)},i(o){n||(C(t.$$.fragment,o),n=!0)},o(o){H(t.$$.fragment,o),n=!1},d(o){o&&p(e),ne(t)}}}function Bd(l){let e,t,n,o;const s=[Fd,Ud],i=[];function r(a,c){return a[1]===""&&a[2].length===0?0:1}return e=r(l),t=i[e]=s[e](l),{c(){t.c(),n=Te()},l(a){t.l(a),n=Te()},m(a,c){i[e].m(a,c),B(a,n,c),o=!0},p(a,c){let u=e;e=r(a),e===u?i[e].p(a,c):(Ve(),H(i[u],1,1,()=>{i[u]=null}),ze(),t=i[e],t?t.p(a,c):(t=i[e]=s[e](a),t.c()),C(t,1),t.m(n.parentNode,n))},i(a){o||(C(t),o=!0)},o(a){H(t),o=!1},d(a){a&&p(n),i[e].d(a)}}}function Rd(l){let e,t='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-5"><path fill-rule="evenodd" d="M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm6-2.438c0-.724.588-1.312 1.313-1.312h4.874c.725 0 1.313.588 1.313 1.313v4.874c0 .725-.588 1.313-1.313 1.313H9.564a1.312 1.312 0 01-1.313-1.313V9.564z" clip-rule="evenodd"></path></svg>',n,o;return{c(){e=T("button"),e.innerHTML=t,this.h()},l(s){e=V(s,"BUTTON",{class:!0,"data-svelte-h":!0}),it(e)!=="svelte-nqxd5x"&&(e.innerHTML=t),this.h()},h(){m(e,"class","bg-white hover:bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-white dark:hover:bg-gray-800 transition rounded-full p-1.5")},m(s,i){B(s,e,i),n||(o=Se(e,"click",l[80]),n=!0)},p:De,d(s){s&&p(e),n=!1,o()}}}function Ud(l){let e,t,n;return t=new Ft({props:{content:l[24].t("Send message"),$$slots:{default:[Wd]},$$scope:{ctx:l}}}),{c(){e=T("div"),ee(t.$$.fragment),this.h()},l(o){e=V(o,"DIV",{class:!0});var s=S(e);le(t.$$.fragment,s),s.forEach(p),this.h()},h(){m(e,"class","flex items-center")},m(o,s){B(o,e,s),te(t,e,null),n=!0},p(o,s){const i={};s[0]&16777216&&(i.content=o[24].t("Send message")),s[0]&33554470|s[3]&2&&(i.$$scope={dirty:s,ctx:o}),t.$set(i)},i(o){n||(C(t.$$.fragment,o),n=!0)},o(o){H(t.$$.fragment,o),n=!1},d(o){o&&p(e),ne(t)}}}function Fd(l){let e,t,n;return t=new Ft({props:{content:l[24].t("Call"),$$slots:{default:[jd]},$$scope:{ctx:l}}}),{c(){e=T("div"),ee(t.$$.fragment),this.h()},l(o){e=V(o,"DIV",{class:!0});var s=S(e);le(t.$$.fragment,s),s.forEach(p),this.h()},h(){m(e,"class","flex items-center")},m(o,s){B(o,e,s),te(t,e,null),n=!0},p(o,s){const i={};s[0]&16777216&&(i.content=o[24].t("Call")),s[0]&1191184416|s[3]&2&&(i.$$scope={dirty:s,ctx:o}),t.$set(i)},i(o){n||(C(t.$$.fragment,o),n=!0)},o(o){H(t.$$.fragment,o),n=!1},d(o){o&&p(e),ne(t)}}}function Wd(l){let e,t,n,o,s;return{c(){e=T("button"),t=_e("svg"),n=_e("path"),this.h()},l(i){e=V(i,"BUTTON",{id:!0,class:!0,type:!0});var r=S(e);t=be(r,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var a=S(t);n=be(a,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),S(n).forEach(p),a.forEach(p),r.forEach(p),this.h()},h(){var i;m(n,"fill-rule","evenodd"),m(n,"d","M8 14a.75.75 0 0 1-.75-.75V4.56L4.03 7.78a.75.75 0 0 1-1.06-1.06l4.5-4.5a.75.75 0 0 1 1.06 0l4.5 4.5a.75.75 0 0 1-1.06 1.06L8.75 4.56v8.69A.75.75 0 0 1 8 14Z"),m(n,"clip-rule","evenodd"),m(t,"xmlns","http://www.w3.org/2000/svg"),m(t,"viewBox","0 0 16 16"),m(t,"fill","currentColor"),m(t,"class","size-5"),m(e,"id","send-message-button"),m(e,"class",o=(l[1]===""&&l[2].length===0?"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled":l[5]||(((i=l[25])==null?void 0:i.webSearch)??!1)==="always"?"bg-blue-500 text-white hover:bg-blue-400 ":"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ")+" transition rounded-full p-1.5 self-center"),m(e,"type","submit"),e.disabled=s=l[1]===""&&l[2].length===0},m(i,r){B(i,e,r),k(e,t),k(t,n)},p(i,r){var a;r[0]&33554470&&o!==(o=(i[1]===""&&i[2].length===0?"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled":i[5]||(((a=i[25])==null?void 0:a.webSearch)??!1)==="always"?"bg-blue-500 text-white hover:bg-blue-400 ":"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ")+" transition rounded-full p-1.5 self-center")&&m(e,"class",o),r[0]&6&&s!==(s=i[1]===""&&i[2].length===0)&&(e.disabled=s)},d(i){i&&p(e)}}}function jd(l){let e,t,n,o,s,i;return t=new wd({props:{className:"size-5"}}),{c(){e=T("button"),ee(t.$$.fragment),this.h()},l(r){e=V(r,"BUTTON",{class:!0,type:!0,"aria-label":!0});var a=S(e);le(t.$$.fragment,a),a.forEach(p),this.h()},h(){var r;m(e,"class",n=(l[5]||(((r=l[25])==null?void 0:r.webSearch)??!1)==="always"?"bg-blue-500 text-white hover:bg-blue-400 ":"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100")+" transition rounded-full p-1.5 self-center"),m(e,"type","button"),m(e,"aria-label","Call")},m(r,a){B(r,e,a),te(t,e,null),o=!0,s||(i=Se(e,"click",l[79]),s=!0)},p(r,a){var c;(!o||a[0]&33554464&&n!==(n=(r[5]||(((c=r[25])==null?void 0:c.webSearch)??!1)==="always"?"bg-blue-500 text-white hover:bg-blue-400 ":"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100")+" transition rounded-full p-1.5 self-center"))&&m(e,"class",n)},i(r){o||(C(t.$$.fragment,r),o=!0)},o(r){H(t.$$.fragment,r),o=!1},d(r){r&&p(e),ne(t),s=!1,i()}}}function Yd(l){let e,t,n,o;e=new hc({props:{show:l[22]}});let s=l[16]&&hr(l);return{c(){ee(e.$$.fragment),t=Q(),s&&s.c(),n=Te()},l(i){le(e.$$.fragment,i),t=x(i),s&&s.l(i),n=Te()},m(i,r){te(e,i,r),B(i,t,r),s&&s.m(i,r),B(i,n,r),o=!0},p(i,r){const a={};r[0]&4194304&&(a.show=i[22]),e.$set(a),i[16]?s?(s.p(i,r),r[0]&65536&&C(s,1)):(s=hr(i),s.c(),C(s,1),s.m(n.parentNode,n)):s&&(Ve(),H(s,1,1,()=>{s=null}),ze())},i(i){o||(C(e.$$.fragment,i),C(s),o=!0)},o(i){H(e.$$.fragment,i),H(s),o=!1},d(i){i&&(p(t),p(n)),ne(e,i),s&&s.d(i)}}}function Kd(l){const e=["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.oasis.opendocument.spreadsheet","text/csv"],t=[".xls",".xlsx",".csv",".ods"];return l.file&&e.includes(l.file.type)||l.name&&t.some(n=>l.name.toLowerCase().endsWith(n))}function Gd(l,e,t){let n,o,s,i,r,a,c,u;re(l,Fn,j=>t(25,o=j)),re(l,Do,j=>t(26,s=j)),re(l,hl,j=>t(14,i=j)),re(l,fl,j=>t(27,r=j)),re(l,rs,j=>t(28,a=j)),re(l,Kn,j=>t(29,c=j)),re(l,Qo,j=>t(30,u=j));const f=on(),d=Ot("i18n");re(l,d,j=>t(24,n=j));let{transparentBackground:h=!1}=e,{onChange:_=()=>{}}=e,{createMessagePair:b}=e,{stopResponse:w}=e,{autoScroll:g=!1}=e,{atSelectedModel:v=void 0}=e,{selectedModels:y}=e,E=[],{history:z}=e,{prompt:D=""}=e,{files:M=[]}=e,{selectedToolIds:A=[]}=e,{imageGenerationEnabled:O=!1}=e,{webSearchEnabled:L=!1}=e,{codeInterpreterEnabled:W=!1}=e,K=!1,R=!1,I,P,N,Y,Z=!1,{placeholder:F=""}=e,X=[];const se=()=>{const j=document.getElementById("messages-container");j.scrollTo({top:j.scrollHeight,behavior:"smooth"})},q=async()=>{try{const j=await navigator.mediaDevices.getDisplayMedia({video:{cursor:"never"},audio:!1}),we=document.createElement("video");we.srcObject=j,await we.play();const Fe=document.createElement("canvas");Fe.width=we.videoWidth,Fe.height=we.videoHeight,Fe.getContext("2d").drawImage(we,0,0,Fe.width,Fe.height),j.getTracks().forEach(Ye=>Ye.stop()),window.focus();const Me=Fe.toDataURL("image/png");t(2,M=[...M,{type:"image",url:Me}]),we.srcObject=null}catch(j){console.error("Error capturing screen:",j)}},G=async(j,we=!1)=>{const Fe="."+j.name.split(".").pop().toLowerCase(),qe=j.type.startsWith("application/vnd.ms-excel")||j.type==="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"||Fe===".xlsx"||Fe===".xls"||Fe===".csv",Me=Hn(),Ye={type:qe?"excel":"file",file:"",id:null,url:"",name:j.name,collection_name:"",status:"uploading",size:j.size,error:"",itemId:Me,conversionResult:null,...we?{context:"full"}:{}};if(Ye.size==0)return ct.error(n.t("You cannot upload an empty file.")),null;t(2,M=[...M,Ye]);try{const Dt=new FormData;if(Dt.append("file",j),qe){console.log("Processing Excel file:",j.name,"Size:",j.size);let rt=null;try{rt=await oe(j),Dt.append("metadata",JSON.stringify({sheetNames:rt.sheetNames,rowCount:rt.rowCount,columnCount:rt.columnCount,headers:rt.headers,previewData:rt.previewData})),console.log("Excel metadata extracted successfully",rt)}catch(nn){console.error("Failed to extract Excel metadata:",nn)}console.log("FormData å†…å®¹:",Array.from(Dt.entries()).map(([nn,Jt])=>({key:nn,value:Jt instanceof File?Jt.name:Jt})));const cn=await fetch("http://localhost:8080/proxy/excel-to-sql",{method:"POST",headers:{Authorization:"Bearer token_59b8b43a_aiurmmm0","Accept-Language":"en"},body:Dt});if(!cn.ok){const nn=await cn.json();throw new Error(nn.detail||"Excel conversion failed")}const Gt=await cn.json();Ye.conversionResult=Gt;const un=await As(localStorage.token,j,Dt);un&&(Ye.file=un,Ye.id=un.id,Ye.url=`${Cs}/files/${un.id}`)}else{const rt=await As(localStorage.token,j,Dt);rt&&(Ye.file=rt,Ye.id=rt.id,Ye.url=`${Cs}/files/${rt.id}`)}t(2,M=M.map(rt=>rt.itemId===Me?{...Ye,status:"processed"}:rt))}catch(Dt){t(2,M=M.map(rt=>rt.itemId===Me?{...rt,status:"error",error:Dt.message}:rt)),ct.error(n.t("File processing failed: {{error}}",{error:Dt.message}))}},oe=async j=>new Promise((we,Fe)=>{const qe=new FileReader;qe.onload=async Me=>{try{const Ye=Jc(Me.target.result,{type:"array"}),Dt=Ye.SheetNames[0],rt=Ye.Sheets[Dt],cn=Hs.sheet_to_json(rt,{header:1})[0],Gt=Hs.sheet_to_json(rt,{header:1}),un=Gt.length-1,nn=Gt.slice(1,4);we({columnNames:cn,rowCount:un,sampleRows:nn})}catch(Ye){Fe(Ye)}},qe.onerror=Me=>Fe(Me),qe.readAsArrayBuffer(j)}),ae=async j=>{console.log("Input files handler called with:",j),j.forEach(we=>{var qe,Me,Ye,Dt;if(console.log("Processing file:",{name:we.name,type:we.type,size:we.size,extension:we.name.split(".").at(-1)}),(((qe=s==null?void 0:s.file)==null?void 0:qe.max_size)??null)!==null&&we.size>(((Me=s==null?void 0:s.file)==null?void 0:Me.max_size)??0)*1024*1024){console.log("File exceeds max size limit:",{fileSize:we.size,maxSize:(((Ye=s==null?void 0:s.file)==null?void 0:Ye.max_size)??0)*1024*1024}),ct.error(n.t("File size should not exceed {{maxSize}} MB.",{maxSize:(Dt=s==null?void 0:s.file)==null?void 0:Dt.max_size}));return}""+we.name.split(".").pop().toLowerCase();const Fe=["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.oasis.opendocument.spreadsheet","text/csv"].includes(we.type)||[".xls",".xlsx",".csv",".ods"].includes("."+we.name.split(".").pop().toLowerCase());if(["image/gif","image/webp","image/jpeg","image/png","image/avif"].includes(we.type)){if(X.length===0){ct.error(n.t("Selected model(s) do not support image inputs"));return}let rt=new FileReader;rt.onload=async cn=>{var un,nn;let Gt=cn.target.result;if((o==null?void 0:o.imageCompression)??!1){const Jt=((un=o==null?void 0:o.imageCompressionSize)==null?void 0:un.width)??null,pn=((nn=o==null?void 0:o.imageCompressionSize)==null?void 0:nn.height)??null;(Jt||pn)&&(Gt=await Mc(Gt,Jt,pn))}t(2,M=[...M,{type:"image",url:`${Gt}`}])},rt.readAsDataURL(we)}else Fe?(console.log("Excel file detected:",we.name),(async()=>{try{const rt=await oe(we);console.log("Excel metadata:",rt);const cn=new File([we],we.name,{type:we.type});cn.excelMetadata=rt,G(we,!0)}catch(rt){console.error("Error extracting Excel metadata:",rt),ct.error(n.t("Error processing Excel file: {{error}}",{error:rt.message}))}})()):G(we)})},ve=j=>{j.key==="Escape"&&(console.log("Escape"),t(22,Z=!1))},$=j=>{var we,Fe;j.preventDefault(),(Fe=(we=j.dataTransfer)==null?void 0:we.types)!=null&&Fe.includes("Files")?t(22,Z=!0):t(22,Z=!1)},Ie=()=>{t(22,Z=!1)},Ne=async j=>{var we,Fe;if(j.preventDefault(),console.log(j),(we=j.dataTransfer)!=null&&we.files){const qe=Array.from((Fe=j.dataTransfer)==null?void 0:Fe.files);qe&&qe.length>0&&(console.log(qe),ae(qe))}t(22,Z=!1)};hn(async()=>{t(16,K=!0),window.setTimeout(()=>{const we=document.getElementById("chat-input");we==null||we.focus()},0),window.addEventListener("keydown",ve),await tt();const j=document.getElementById("chat-container");j==null||j.addEventListener("dragover",$),j==null||j.addEventListener("drop",Ne),j==null||j.addEventListener("dragleave",Ie)}),$n(()=>{console.log("destroy"),window.removeEventListener("keydown",ve);const j=document.getElementById("chat-container");j&&(j==null||j.removeEventListener("dragover",$),j==null||j.removeEventListener("drop",Ne),j==null||j.removeEventListener("dragleave",Ie))});const ce=()=>{t(6,g=!0),se()},Ze=j=>r?r.find(we=>we.id===j):{id:j,name:j},Qe=j=>j.id===v.id,ge=()=>{t(0,v=void 0)};function ie(j){Ae[j?"unshift":"push"](()=>{N=j,t(20,N)})}function Ue(j){D=j,t(1,D)}function et(j){M=j,t(2,M)}const at=j=>{f("upload",j.detail)},_t=j=>{const we=j.detail;(we==null?void 0:we.type)==="model"&&t(0,v=we.data);const Fe=document.getElementById("chat-input");Fe==null||Fe.focus()};function nt(j){Ae[j?"unshift":"push"](()=>{P=j,t(19,P)})}function mt(){Y=this.files,t(21,Y)}const jt=async()=>{if(Y&&Y.length>0){const j=Array.from(Y);ae(j)}else ct.error(n.t("File not found."));t(19,P.value="",P)};function Ht(j){R=j,t(17,R)}const gt=async()=>{var j;t(17,R=!1),await tt(),(j=document.getElementById("chat-input"))==null||j.focus()},At=async j=>{var qe;const{text:we,filename:Fe}=j.detail;t(1,D=`${D}${we} `),t(17,R=!1),await tt(),(qe=document.getElementById("chat-input"))==null||qe.focus(),((o==null?void 0:o.speechAutoSend)??!1)&&f("submit",D)},me=j=>!X.includes(j),Lt=j=>{M.splice(j,1),t(2,M)},Et=async(j,we)=>{j.id&&await Ls(localStorage.token,j.id),M.splice(we,1),t(2,M)},Ct=async(j,we)=>{j.type!=="collection"&&!(j!=null&&j.collection)&&j.id&&await Ls(localStorage.token,j.id),M.splice(we,1),t(2,M)},Pe=j=>{console.log(j)},qt=async j=>{(E.length===0||!E.at(0))&&ct.error(n.t("Please select a model first."));const we=await Wc(localStorage.token,E.at(0),j,z!=null&&z.currentId?bn(z,z.currentId):null).catch(Fe=>(console.log(Fe),null));return console.log(we),we};function It(j){Ae[j?"unshift":"push"](()=>{I=j,t(18,I)})}function fe(j){D=j,t(1,D)}const We=async j=>{var qe;j=j.detail.event;const we=j.ctrlKey||j.metaKey,Fe=document.getElementById("commands-container");if(j.key==="Escape"&&w(),we&&j.key==="Enter"&&j.shiftKey&&(j.preventDefault(),b(D)),D===""&&we&&j.key.toLowerCase()==="r"){j.preventDefault(),console.log("regenerate");const Me=[...document.getElementsByClassName("regenerate-response-button")].at(-1);Me==null||Me.click()}if(D===""&&j.key=="ArrowUp"){j.preventDefault();const Me=[...document.getElementsByClassName("user-message")].at(-1);if(Me){Me.scrollIntoView({block:"center"});const Ye=[...document.getElementsByClassName("edit-user-message-button")].at(-1);Ye==null||Ye.click()}}if(Fe){if(Fe&&j.key==="ArrowUp"&&(j.preventDefault(),N.selectUp(),[...document.getElementsByClassName("selected-command-option-button")].at(-1).scrollIntoView({block:"center"})),Fe&&j.key==="ArrowDown"&&(j.preventDefault(),N.selectDown(),[...document.getElementsByClassName("selected-command-option-button")].at(-1).scrollIntoView({block:"center"})),Fe&&j.key==="Tab"){j.preventDefault();const Me=[...document.getElementsByClassName("selected-command-option-button")].at(-1);Me==null||Me.click()}if(Fe&&j.key==="Enter"){j.preventDefault();const Me=[...document.getElementsByClassName("selected-command-option-button")].at(-1);Me?Me==null||Me.click():(qe=document.getElementById("send-message-button"))==null||qe.click()}}else(!a||!("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0))&&(j.keyCode===13&&!j.shiftKey&&j.preventDefault(),(D!==""||M.length>0)&&j.keyCode===13&&!j.shiftKey&&f("submit",D));j.key==="Escape"&&(console.log("Escape"),t(0,v=void 0),t(3,A=[]),t(5,L=!1),t(4,O=!1))},Be=async j=>{j=j.detail.event,console.log(j);const we=j.clipboardData||window.clipboardData;if(we&&we.items){for(const Fe of we.items)if(Fe.type.indexOf("image")!==-1){const qe=Fe.getAsFile(),Me=new FileReader;Me.onload=function(Ye){t(2,M=[...M,{type:"image",url:`${Ye.target.result}`}])},Me.readAsDataURL(qe)}else if(Fe.type==="text/plain"&&((o==null?void 0:o.largeTextAsFile)??!1)){const qe=we.getData("text/plain");if(qe.length>Ms){j.preventDefault();const Me=new Blob([qe],{type:"text/plain"}),Ye=new File([Me],`Pasted_Text_${Date.now()}.txt`,{type:"text/plain"});await G(Ye,!0)}}}};function Je(j){Ae[j?"unshift":"push"](()=>{I=j,t(18,I)})}function wt(){D=this.value,t(1,D)}const bt=j=>{(!a||!("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0))&&(j.key==="Enter"&&!j.shiftKey&&j.preventDefault(),(D!==""||M.length>0)&&j.key==="Enter"&&!j.shiftKey&&f("submit",D))},Mt=async j=>{var qe;const we=j.ctrlKey||j.metaKey,Fe=document.getElementById("commands-container");if(j.key==="Escape"&&w(),we&&j.key==="Enter"&&j.shiftKey&&(j.preventDefault(),b(D)),D===""&&we&&j.key.toLowerCase()==="r"){j.preventDefault(),console.log("regenerate");const Me=[...document.getElementsByClassName("regenerate-response-button")].at(-1);Me==null||Me.click()}if(D===""&&j.key=="ArrowUp"){j.preventDefault();const Me=[...document.getElementsByClassName("user-message")].at(-1),Ye=[...document.getElementsByClassName("edit-user-message-button")].at(-1);console.log(Me),Me.scrollIntoView({block:"center"}),Ye==null||Ye.click()}if(Fe&&j.key==="ArrowUp"&&(j.preventDefault(),N.selectUp(),[...document.getElementsByClassName("selected-command-option-button")].at(-1).scrollIntoView({block:"center"})),Fe&&j.key==="ArrowDown"&&(j.preventDefault(),N.selectDown(),[...document.getElementsByClassName("selected-command-option-button")].at(-1).scrollIntoView({block:"center"})),Fe&&j.key==="Enter"){j.preventDefault();const Me=[...document.getElementsByClassName("selected-command-option-button")].at(-1);j.shiftKey?t(1,D=`${D}
`):Me?Me==null||Me.click():(qe=document.getElementById("send-message-button"))==null||qe.click()}if(Fe&&j.key==="Tab"){j.preventDefault();const Me=[...document.getElementsByClassName("selected-command-option-button")].at(-1);Me==null||Me.click()}else if(j.key==="Tab"){const Me=Tc(D);if(Me.length>0){const Ye=Me.at(0),Dt=D;t(1,D=D.substring(0,(Ye==null?void 0:Ye.endIndex)+1)),await tt(),j.target.scrollTop=j.target.scrollHeight,t(1,D=Dt),await tt(),j.preventDefault(),j.target.setSelectionRange(Ye==null?void 0:Ye.startIndex,Ye.endIndex+1)}j.target.style.height="",j.target.style.height=Math.min(j.target.scrollHeight,320)+"px"}j.key==="Escape"&&(console.log("Escape"),t(0,v=void 0),t(3,A=[]),t(5,L=!1),t(4,O=!1))},Tt=async j=>{j.target.style.height="",j.target.style.height=Math.min(j.target.scrollHeight,320)+"px"},rn=async j=>{j.target.style.height="",j.target.style.height=Math.min(j.target.scrollHeight,320)+"px"},Bt=async j=>{const we=j.clipboardData||window.clipboardData;if(we&&we.items){for(const Fe of we.items)if(Fe.type.indexOf("image")!==-1){const qe=Fe.getAsFile(),Me=new FileReader;Me.onload=function(Ye){t(2,M=[...M,{type:"image",url:`${Ye.target.result}`}])},Me.readAsDataURL(qe)}else if(Fe.type==="text/plain"&&((o==null?void 0:o.largeTextAsFile)??!1)){const qe=we.getData("text/plain");if(qe.length>Ms){j.preventDefault();const Me=new Blob([qe],{type:"text/plain"}),Ye=new File([Me],`Pasted_Text_${Date.now()}.txt`,{type:"text/plain"});await G(Ye,!0)}}}},Rt=()=>{P.click()},Yt=async()=>{try{const j=await vf();if(j){const we=new File([j.blob],j.name,{type:j.blob.type});await G(we)}else console.log("No file was selected from Google Drive")}catch(j){console.error("Google Drive Error:",j),ct.error(n.t("Error accessing Google Drive: {{error}}",{error:j.message}))}},Kt=async()=>{try{const j=await Df();if(j){const we=new File([j.blob],j.name,{type:j.blob.type||"application/octet-stream"});await G(we)}else console.log("No file was selected from OneDrive")}catch(j){console.error("OneDrive Error:",j)}},tn=async()=>{await tt();const j=document.getElementById("chat-input");j==null||j.focus()};function an(j){A=j,t(3,A)}const Pt=()=>t(5,L=!L),yt=()=>t(4,O=!O),wn=()=>t(7,W=!W),mn=async()=>{try{let j=await navigator.mediaDevices.getUserMedia({audio:!0}).catch(function(we){return ct.error(n.t("Permission denied when accessing microphone: {{error}}",{error:we})),null});j&&(t(17,R=!0),j.getTracks().forEach(Fe=>Fe.stop())),j=null}catch{ct.error(n.t("Permission denied when accessing microphone"))}},yn=async()=>{var j,we,Fe,qe,Me;if(y.length>1){ct.error(n.t("Select only one model to call"));return}if(s.audio.stt.engine==="web"){ct.error(n.t("Call feature is not supported when using Web STT engine"));return}try{let Ye=await navigator.mediaDevices.getUserMedia({audio:!0});Ye&&Ye.getTracks().forEach(rt=>rt.stop()),Ye=null,((we=(j=o.audio)==null?void 0:j.tts)==null?void 0:we.engine)==="browser-kokoro"&&(u||(await Qo.set(new uu({dtype:((Me=(qe=(Fe=o.audio)==null?void 0:Fe.tts)==null?void 0:qe.engineConfig)==null?void 0:Me.dtype)??"fp32"})),await u.init())),En.set(!0),Zt.set(!0)}catch{ct.error(n.t("Permission denied when accessing media devices"))}},Sn=()=>{w()},Nn=()=>{f("submit",D)};return l.$$set=j=>{"transparentBackground"in j&&t(8,h=j.transparentBackground),"onChange"in j&&t(37,_=j.onChange),"createMessagePair"in j&&t(9,b=j.createMessagePair),"stopResponse"in j&&t(10,w=j.stopResponse),"autoScroll"in j&&t(6,g=j.autoScroll),"atSelectedModel"in j&&t(0,v=j.atSelectedModel),"selectedModels"in j&&t(11,y=j.selectedModels),"history"in j&&t(12,z=j.history),"prompt"in j&&t(1,D=j.prompt),"files"in j&&t(2,M=j.files),"selectedToolIds"in j&&t(3,A=j.selectedToolIds),"imageGenerationEnabled"in j&&t(4,O=j.imageGenerationEnabled),"webSearchEnabled"in j&&t(5,L=j.webSearchEnabled),"codeInterpreterEnabled"in j&&t(7,W=j.codeInterpreterEnabled),"placeholder"in j&&t(13,F=j.placeholder)},l.$$.update=()=>{l.$$.dirty[0]&2049&&t(15,E=v!==void 0?[v.id]:y),l.$$.dirty[0]&62|l.$$.dirty[1]&64&&_({prompt:D,files:M,selectedToolIds:A,imageGenerationEnabled:O,webSearchEnabled:L}),l.$$.dirty[0]&18433&&t(23,X=[...v?[v]:y].filter(j=>{var we,Fe,qe,Me;return((Me=(qe=(Fe=(we=i.find(Ye=>Ye.id===j))==null?void 0:we.info)==null?void 0:Fe.meta)==null?void 0:qe.capabilities)==null?void 0:Me.vision)??!0}))},[v,D,M,A,O,L,g,W,h,b,w,y,z,F,i,E,K,R,I,P,N,Y,Z,X,n,o,s,r,a,c,u,f,d,se,q,G,ae,_,ce,Ze,Qe,ge,ie,Ue,et,at,_t,nt,mt,jt,Ht,gt,At,me,Lt,Et,Ct,Pe,qt,It,fe,We,Be,Je,wt,bt,Mt,Tt,rn,Bt,Rt,Yt,Kt,tn,an,Pt,yt,wn,mn,yn,Sn,Nn]}class Ea extends Oe{constructor(e){super(),He(this,e,Gd,Yd,Le,{transparentBackground:8,onChange:37,createMessagePair:9,stopResponse:10,autoScroll:6,atSelectedModel:0,selectedModels:11,history:12,prompt:1,files:2,selectedToolIds:3,imageGenerationEnabled:4,webSearchEnabled:5,codeInterpreterEnabled:7,placeholder:13},null,[-1,-1,-1,-1])}}function Vr(l,e,t){const n=l.slice();return n[12]=e[t],n[13]=e,n[14]=t,n}function Xd(l){let e,t,n;return t=new Ft({props:{content:l[4].t("Remove Model"),$$slots:{default:[qd]},$$scope:{ctx:l}}}),{c(){e=T("div"),ee(t.$$.fragment),this.h()},l(o){e=V(o,"DIV",{class:!0});var s=S(e);le(t.$$.fragment,s),s.forEach(p),this.h()},h(){m(e,"class","self-center mx-1 disabled:text-gray-600 disabled:hover:text-gray-600 -translate-y-[0.5px]")},m(o,s){B(o,e,s),te(t,e,null),n=!0},p(o,s){const i={};s&16&&(i.content=o[4].t("Remove Model")),s&32771&&(i.$$scope={dirty:s,ctx:o}),t.$set(i)},i(o){n||(C(t.$$.fragment,o),n=!0)},o(o){H(t.$$.fragment,o),n=!1},d(o){o&&p(e),ne(t)}}}function Zd(l){let e,t,n;return t=new Ft({props:{content:l[4].t("Add Model"),$$slots:{default:[Jd]},$$scope:{ctx:l}}}),{c(){e=T("div"),ee(t.$$.fragment),this.h()},l(o){e=V(o,"DIV",{class:!0});var s=S(e);le(t.$$.fragment,s),s.forEach(p),this.h()},h(){m(e,"class","self-center mx-1 disabled:text-gray-600 disabled:hover:text-gray-600 -translate-y-[0.5px]")},m(o,s){B(o,e,s),te(t,e,null),n=!0},p(o,s){const i={};s&16&&(i.content=o[4].t("Add Model")),s&32771&&(i.$$scope={dirty:s,ctx:o}),t.$set(i)},i(o){n||(C(t.$$.fragment,o),n=!0)},o(o){H(t.$$.fragment,o),n=!1},d(o){o&&p(e),ne(t)}}}function qd(l){let e,t,n,o,s;function i(){return l[10](l[14])}return{c(){e=T("button"),t=_e("svg"),n=_e("path"),this.h()},l(r){e=V(r,"BUTTON",{"aria-label":!0});var a=S(e);t=be(a,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var c=S(t);n=be(c,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),S(n).forEach(p),c.forEach(p),a.forEach(p),this.h()},h(){m(n,"stroke-linecap","round"),m(n,"stroke-linejoin","round"),m(n,"d","M19.5 12h-15"),m(t,"xmlns","http://www.w3.org/2000/svg"),m(t,"fill","none"),m(t,"viewBox","0 0 24 24"),m(t,"stroke-width","2"),m(t,"stroke","currentColor"),m(t,"class","size-3"),e.disabled=l[1],m(e,"aria-label","Remove Model")},m(r,a){B(r,e,a),k(e,t),k(t,n),o||(s=Se(e,"click",i),o=!0)},p(r,a){l=r,a&2&&(e.disabled=l[1])},d(r){r&&p(e),o=!1,s()}}}function Jd(l){let e,t,n,o,s;return{c(){e=T("button"),t=_e("svg"),n=_e("path"),this.h()},l(i){e=V(i,"BUTTON",{class:!0,"aria-label":!0});var r=S(e);t=be(r,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var a=S(t);n=be(a,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),S(n).forEach(p),a.forEach(p),r.forEach(p),this.h()},h(){m(n,"stroke-linecap","round"),m(n,"stroke-linejoin","round"),m(n,"d","M12 6v12m6-6H6"),m(t,"xmlns","http://www.w3.org/2000/svg"),m(t,"fill","none"),m(t,"viewBox","0 0 24 24"),m(t,"stroke-width","2"),m(t,"stroke","currentColor"),m(t,"class","size-3.5"),m(e,"class",""),e.disabled=l[1],m(e,"aria-label","Add Model")},m(i,r){B(i,e,r),k(e,t),k(t,n),o||(s=Se(e,"click",l[9]),o=!0)},p(i,r){r&2&&(e.disabled=i[1])},d(i){i&&p(e),o=!1,s()}}}function zr(l){var w,g,v;let e,t,n,o,s,i,r,a,c,u;function f(y){l[8](y,l[12],l[13],l[14])}let d={id:`${l[14]}`,placeholder:l[4].t("Select a model"),items:l[3].map(Pr),showTemporaryChatControl:l[5].role==="user"?((v=(g=(w=l[5])==null?void 0:w.permissions)==null?void 0:g.chat)==null?void 0:v.temporary)??!0:!0};l[12]!==void 0&&(d.value=l[12]),o=new vu({props:d}),Ae.push(()=>Xe(o,"value",f));const h=[Zd,Xd],_=[];function b(y,E){return y[14]===0?0:1}return r=b(l),a=_[r]=h[r](l),{c(){e=T("div"),t=T("div"),n=T("div"),ee(o.$$.fragment),i=Q(),a.c(),c=Q(),this.h()},l(y){e=V(y,"DIV",{class:!0});var E=S(e);t=V(E,"DIV",{class:!0});var z=S(t);n=V(z,"DIV",{class:!0});var D=S(n);le(o.$$.fragment,D),D.forEach(p),z.forEach(p),i=x(E),a.l(E),c=x(E),E.forEach(p),this.h()},h(){m(n,"class","mr-1 max-w-full"),m(t,"class","overflow-hidden w-full"),m(e,"class","flex w-full max-w-fit")},m(y,E){B(y,e,E),k(e,t),k(t,n),te(o,n,null),k(e,i),_[r].m(e,null),k(e,c),u=!0},p(y,E){var D,M,A;l=y;const z={};E&16&&(z.placeholder=l[4].t("Select a model")),E&8&&(z.items=l[3].map(Pr)),E&32&&(z.showTemporaryChatControl=l[5].role==="user"?((A=(M=(D=l[5])==null?void 0:D.permissions)==null?void 0:M.chat)==null?void 0:A.temporary)??!0:!0),!s&&E&1&&(s=!0,z.value=l[12],Ge(()=>s=!1)),o.$set(z),a.p(l,E)},i(y){u||(C(o.$$.fragment,y),C(a),u=!0)},o(y){H(o.$$.fragment,y),H(a),u=!1},d(y){y&&p(e),ne(o),_[r].d()}}}function Nr(l){let e,t,n=l[4].t("Set as default")+"",o,s,i;return{c(){e=T("div"),t=T("button"),o=ke(n),this.h()},l(r){e=V(r,"DIV",{class:!0});var a=S(e);t=V(a,"BUTTON",{});var c=S(t);o=Ee(c,n),c.forEach(p),a.forEach(p),this.h()},h(){m(e,"class","absolute text-left mt-[1px] ml-1 text-[0.7rem] text-gray-500 font-primary")},m(r,a){B(r,e,a),k(e,t),k(t,o),s||(i=Se(t,"click",l[7]),s=!0)},p(r,a){a&16&&n!==(n=r[4].t("Set as default")+"")&&Ce(o,n)},d(r){r&&p(e),s=!1,i()}}}function Qd(l){let e,t,n,o,s=ht(l[0]),i=[];for(let c=0;c<s.length;c+=1)i[c]=zr(Vr(l,s,c));const r=c=>H(i[c],1,1,()=>{i[c]=null});let a=l[2]&&Nr(l);return{c(){e=T("div");for(let c=0;c<i.length;c+=1)i[c].c();t=Q(),a&&a.c(),n=Te(),this.h()},l(c){e=V(c,"DIV",{class:!0});var u=S(e);for(let f=0;f<i.length;f+=1)i[f].l(u);u.forEach(p),t=x(c),a&&a.l(c),n=Te(),this.h()},h(){m(e,"class","flex flex-col w-full items-start")},m(c,u){B(c,e,u);for(let f=0;f<i.length;f+=1)i[f]&&i[f].m(e,null);B(c,t,u),a&&a.m(c,u),B(c,n,u),o=!0},p(c,[u]){if(u&59){s=ht(c[0]);let f;for(f=0;f<s.length;f+=1){const d=Vr(c,s,f);i[f]?(i[f].p(d,u),C(i[f],1)):(i[f]=zr(d),i[f].c(),C(i[f],1),i[f].m(e,null))}for(Ve(),f=s.length;f<i.length;f+=1)r(f);ze()}c[2]?a?a.p(c,u):(a=Nr(c),a.c(),a.m(n.parentNode,n)):a&&(a.d(1),a=null)},i(c){if(!o){for(let u=0;u<s.length;u+=1)C(i[u]);o=!0}},o(c){i=i.filter(Boolean);for(let u=0;u<i.length;u+=1)H(i[u]);o=!1},d(c){c&&(p(e),p(t),p(n)),vn(i,c),a&&a.d(c)}}}const Pr=l=>({value:l.id,label:l.name,model:l});function xd(l,e,t){let n,o,s,i;re(l,hl,b=>t(3,n=b)),re(l,Fn,b=>t(11,s=b)),re(l,Kn,b=>t(5,i=b));const r=Ot("i18n");re(l,r,b=>t(4,o=b));let{selectedModels:a=[""]}=e,{disabled:c=!1}=e,{showSetDefault:u=!0}=e;const f=async()=>{if(a.filter(w=>w==="").length){ct.error(o.t("Choose a model before saving..."));return}Fn.set({...s,models:a}),await Uc(localStorage.token,{ui:s}),ct.success(o.t("Default model updated"))};function d(b,w,g,v){g[v]=b,t(0,a),t(3,n)}const h=()=>{t(0,a=[...a,""])},_=b=>{a.splice(b,1),t(0,a),t(3,n)};return l.$$set=b=>{"selectedModels"in b&&t(0,a=b.selectedModels),"disabled"in b&&t(1,c=b.disabled),"showSetDefault"in b&&t(2,u=b.showSetDefault)},l.$$.update=()=>{l.$$.dirty&9&&a.length>0&&n.length>0&&t(0,a=a.map(b=>n.map(w=>w.id).includes(b)?b:""))},[a,c,u,n,o,i,r,f,d,h,_]}class $d extends Oe{constructor(e){super(),He(this,e,xd,Qd,Le,{selectedModels:0,disabled:1,showSetDefault:2})}}function eh(l){let e,t;return{c(){e=_e("svg"),t=_e("path"),this.h()},l(n){e=be(n,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var o=S(e);t=be(o,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),S(t).forEach(p),o.forEach(p),this.h()},h(){m(t,"stroke-linecap","round"),m(t,"stroke-linejoin","round"),m(t,"d","M9 6.75V15m6-6v8.25m.503 3.498 4.875-2.437c.381-.19.622-.58.622-1.006V4.82c0-.836-.88-1.38-1.628-1.006l-3.869 1.934c-.317.159-.69.159-1.006 0L9.503 3.252a1.125 1.125 0 0 0-1.006 0L3.622 5.689C3.24 5.88 3 6.27 3 6.695V19.18c0 .836.88 1.38 1.628 1.006l3.869-1.934c.317-.159.69-.159 1.006 0l4.994 2.497c.317.158.69.158 1.006 0Z"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"fill","none"),m(e,"viewBox","0 0 24 24"),m(e,"stroke-width",l[1]),m(e,"stroke","currentColor"),m(e,"class",l[0])},m(n,o){B(n,e,o),k(e,t)},p(n,[o]){o&2&&m(e,"stroke-width",n[1]),o&1&&m(e,"class",n[0])},i:De,o:De,d(n){n&&p(e)}}}function th(l,e,t){let{className:n="size-4"}=e,{strokeWidth:o="2"}=e;return l.$$set=s=>{"className"in s&&t(0,n=s.className),"strokeWidth"in s&&t(1,o=s.strokeWidth)},[n,o]}let nh=class extends Oe{constructor(e){super(),He(this,e,th,eh,Le,{className:0,strokeWidth:1})}};function lh(l){let e,t;return{c(){e=_e("svg"),t=_e("path"),this.h()},l(n){e=be(n,"svg",{xmlns:!0,viewBox:!0,stroke:!0,fill:!0,class:!0,"stroke-width":!0});var o=S(e);t=be(o,"path",{d:!0}),S(t).forEach(p),o.forEach(p),this.h()},h(){m(t,"d","M18.75 12.75h1.5a.75.75 0 0 0 0-1.5h-1.5a.75.75 0 0 0 0 1.5ZM12 6a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 12 6ZM12 18a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 12 18ZM3.75 6.75h1.5a.75.75 0 1 0 0-1.5h-1.5a.75.75 0 0 0 0 1.5ZM5.25 18.75h-1.5a.75.75 0 0 1 0-1.5h1.5a.75.75 0 0 1 0 1.5ZM3 12a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 3 12ZM9 3.75a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5ZM12.75 12a2.25 2.25 0 1 1 4.5 0 2.25 2.25 0 0 1-4.5 0ZM9 15.75a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5Z"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"viewBox","0 0 24 24"),m(e,"stroke","currentColor"),m(e,"fill","currentColor"),m(e,"class",l[0]),m(e,"stroke-width",l[1])},m(n,o){B(n,e,o),k(e,t)},p(n,[o]){o&1&&m(e,"class",n[0]),o&2&&m(e,"stroke-width",n[1])},i:De,o:De,d(n){n&&p(e)}}}function oh(l,e,t){let{className:n="w-4 h-4"}=e,{strokeWidth:o="1.5"}=e;return l.$$set=s=>{"className"in s&&t(0,n=s.className),"strokeWidth"in s&&t(1,o=s.strokeWidth)},[n,o]}class sh extends Oe{constructor(e){super(),He(this,e,oh,lh,Le,{className:0,strokeWidth:1})}}function rh(l){let e,t;return{c(){e=_e("svg"),t=_e("path"),this.h()},l(n){e=be(n,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var o=S(e);t=be(o,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),S(t).forEach(p),o.forEach(p),this.h()},h(){m(t,"stroke-linecap","round"),m(t,"stroke-linejoin","round"),m(t,"d","m21 7.5-9-5.25L3 7.5m18 0-9 5.25m9-5.25v9l-9 5.25M3 7.5l9 5.25M3 7.5v9l9 5.25m0-9v9"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"fill","none"),m(e,"viewBox","0 0 24 24"),m(e,"stroke-width",l[1]),m(e,"stroke","currentColor"),m(e,"class",l[0])},m(n,o){B(n,e,o),k(e,t)},p(n,[o]){o&2&&m(e,"stroke-width",n[1]),o&1&&m(e,"class",n[0])},i:De,o:De,d(n){n&&p(e)}}}function ih(l,e,t){let{className:n="size-4"}=e,{strokeWidth:o="2"}=e;return l.$$set=s=>{"className"in s&&t(0,n=s.className),"strokeWidth"in s&&t(1,o=s.strokeWidth)},[n,o]}class ah extends Oe{constructor(e){super(),He(this,e,ih,rh,Le,{className:0,strokeWidth:1})}}function ch(l){let e;const t=l[13].default,n=Qt(t,l,l[23],null);return{c(){n&&n.c()},l(o){n&&n.l(o)},m(o,s){n&&n.m(o,s),e=!0},p(o,s){n&&n.p&&(!e||s&8388608)&&xt(n,t,o,o[23],e?en(t,o[23],s,null):$t(o[23]),null)},i(o){e||(C(n,o),e=!0)},o(o){H(n,o),e=!1},d(o){n&&n.d(o)}}}function Or(l){let e,t;return e=new dn({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",id:"chat-controls-button",$$slots:{default:[uh]},$$scope:{ctx:l}}}),e.$on("click",l[14]),{c(){ee(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,o){te(e,n,o),t=!0},p(n,o){const s={};o&8388640&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}function uh(l){let e,t,n,o=l[5].t("Controls")+"",s,i;return e=new sh({props:{className:" size-4",strokeWidth:"0.5"}}),{c(){ee(e.$$.fragment),t=Q(),n=T("div"),s=ke(o),this.h()},l(r){le(e.$$.fragment,r),t=x(r),n=V(r,"DIV",{class:!0});var a=S(n);s=Ee(a,o),a.forEach(p),this.h()},h(){m(n,"class","flex items-center")},m(r,a){te(e,r,a),B(r,t,a),B(r,n,a),k(n,s),i=!0},p(r,a){(!i||a&32)&&o!==(o=r[5].t("Controls")+"")&&Ce(s,o)},i(r){i||(C(e.$$.fragment,r),i=!0)},o(r){H(e.$$.fragment,r),i=!1},d(r){r&&(p(t),p(n)),ne(e,r)}}}function Hr(l){let e,t;return e=new dn({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",id:"chat-share-button",$$slots:{default:[fh]},$$scope:{ctx:l}}}),e.$on("click",l[15]),{c(){ee(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,o){te(e,n,o),t=!0},p(n,o){const s={};o&8388640&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}function fh(l){let e,t,n,o,s=l[5].t("Share")+"",i;return{c(){e=_e("svg"),t=_e("path"),n=Q(),o=T("div"),i=ke(s),this.h()},l(r){e=be(r,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var a=S(e);t=be(a,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),S(t).forEach(p),a.forEach(p),n=x(r),o=V(r,"DIV",{class:!0});var c=S(o);i=Ee(c,s),c.forEach(p),this.h()},h(){m(t,"fill-rule","evenodd"),m(t,"d","M15.75 4.5a3 3 0 1 1 .825 2.066l-8.421 4.679a3.002 3.002 0 0 1 0 1.51l8.421 4.679a3 3 0 1 1-.729 1.31l-8.421-4.678a3 3 0 1 1 0-4.132l8.421-4.679a3 3 0 0 1-.096-.755Z"),m(t,"clip-rule","evenodd"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"viewBox","0 0 24 24"),m(e,"fill","currentColor"),m(e,"class","size-4"),m(o,"class","flex items-center")},m(r,a){B(r,e,a),k(e,t),B(r,n,a),B(r,o,a),k(o,i)},p(r,a){a&32&&s!==(s=r[5].t("Share")+"")&&Ce(i,s)},d(r){r&&(p(e),p(n),p(o))}}}function dh(l){let e,t,n,o=l[5].t("Overview")+"",s,i;return e=new nh({props:{className:" size-4",strokeWidth:"1.5"}}),{c(){ee(e.$$.fragment),t=Q(),n=T("div"),s=ke(o),this.h()},l(r){le(e.$$.fragment,r),t=x(r),n=V(r,"DIV",{class:!0});var a=S(n);s=Ee(a,o),a.forEach(p),this.h()},h(){m(n,"class","flex items-center")},m(r,a){te(e,r,a),B(r,t,a),B(r,n,a),k(n,s),i=!0},p(r,a){(!i||a&32)&&o!==(o=r[5].t("Overview")+"")&&Ce(s,o)},i(r){i||(C(e.$$.fragment,r),i=!0)},o(r){H(e.$$.fragment,r),i=!1},d(r){r&&(p(t),p(n)),ne(e,r)}}}function hh(l){let e,t,n,o=l[5].t("Artifacts")+"",s,i;return e=new ah({props:{className:" size-4",strokeWidth:"1.5"}}),{c(){ee(e.$$.fragment),t=Q(),n=T("div"),s=ke(o),this.h()},l(r){le(e.$$.fragment,r),t=x(r),n=V(r,"DIV",{class:!0});var a=S(n);s=Ee(a,o),a.forEach(p),this.h()},h(){m(n,"class","flex items-center")},m(r,a){te(e,r,a),B(r,t,a),B(r,n,a),k(n,s),i=!0},p(r,a){(!i||a&32)&&o!==(o=r[5].t("Artifacts")+"")&&Ce(s,o)},i(r){i||(C(e.$$.fragment,r),i=!0)},o(r){H(e.$$.fragment,r),i=!1},d(r){r&&(p(t),p(n)),ne(e,r)}}}function mh(l){let e,t,n,o,s=l[5].t("Download")+"",i;return{c(){e=_e("svg"),t=_e("path"),n=Q(),o=T("div"),i=ke(s),this.h()},l(r){e=be(r,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var a=S(e);t=be(a,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),S(t).forEach(p),a.forEach(p),n=x(r),o=V(r,"DIV",{class:!0});var c=S(o);i=Ee(c,s),c.forEach(p),this.h()},h(){m(t,"stroke-linecap","round"),m(t,"stroke-linejoin","round"),m(t,"d","M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"fill","none"),m(e,"viewBox","0 0 24 24"),m(e,"stroke-width","1.5"),m(e,"stroke","currentColor"),m(e,"class","size-4"),m(o,"class","flex items-center")},m(r,a){B(r,e,a),k(e,t),B(r,n,a),B(r,o,a),k(o,i)},p(r,a){a&32&&s!==(s=r[5].t("Download")+"")&&Ce(i,s)},d(r){r&&(p(e),p(n),p(o))}}}function gh(l){let e,t=l[5].t("Export chat (.json)")+"",n;return{c(){e=T("div"),n=ke(t),this.h()},l(o){e=V(o,"DIV",{class:!0});var s=S(e);n=Ee(s,t),s.forEach(p),this.h()},h(){m(e,"class","flex items-center line-clamp-1")},m(o,s){B(o,e,s),k(e,n)},p(o,s){s&32&&t!==(t=o[5].t("Export chat (.json)")+"")&&Ce(n,t)},d(o){o&&p(e)}}}function ph(l){let e,t=l[5].t("Plain text (.txt)")+"",n;return{c(){e=T("div"),n=ke(t),this.h()},l(o){e=V(o,"DIV",{class:!0});var s=S(e);n=Ee(s,t),s.forEach(p),this.h()},h(){m(e,"class","flex items-center line-clamp-1")},m(o,s){B(o,e,s),k(e,n)},p(o,s){s&32&&t!==(t=o[5].t("Plain text (.txt)")+"")&&Ce(n,t)},d(o){o&&p(e)}}}function _h(l){let e,t=l[5].t("PDF document (.pdf)")+"",n;return{c(){e=T("div"),n=ke(t),this.h()},l(o){e=V(o,"DIV",{class:!0});var s=S(e);n=Ee(s,t),s.forEach(p),this.h()},h(){m(e,"class","flex items-center line-clamp-1")},m(o,s){B(o,e,s),k(e,n)},p(o,s){s&32&&t!==(t=o[5].t("PDF document (.pdf)")+"")&&Ce(n,t)},d(o){o&&p(e)}}}function bh(l){let e,t,n,o,s,i;return e=new dn({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",$$slots:{default:[gh]},$$scope:{ctx:l}}}),e.$on("click",l[18]),n=new dn({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",$$slots:{default:[ph]},$$scope:{ctx:l}}}),n.$on("click",l[19]),s=new dn({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",$$slots:{default:[_h]},$$scope:{ctx:l}}}),s.$on("click",l[20]),{c(){ee(e.$$.fragment),t=Q(),ee(n.$$.fragment),o=Q(),ee(s.$$.fragment)},l(r){le(e.$$.fragment,r),t=x(r),le(n.$$.fragment,r),o=x(r),le(s.$$.fragment,r)},m(r,a){te(e,r,a),B(r,t,a),te(n,r,a),B(r,o,a),te(s,r,a),i=!0},p(r,a){const c={};a&8388640&&(c.$$scope={dirty:a,ctx:r}),e.$set(c);const u={};a&8388640&&(u.$$scope={dirty:a,ctx:r}),n.$set(u);const f={};a&8388640&&(f.$$scope={dirty:a,ctx:r}),s.$set(f)},i(r){i||(C(e.$$.fragment,r),C(n.$$.fragment,r),C(s.$$.fragment,r),i=!0)},o(r){H(e.$$.fragment,r),H(n.$$.fragment,r),H(s.$$.fragment,r),i=!1},d(r){r&&(p(t),p(o)),ne(e,r),ne(n,r),ne(s,r)}}}function vh(l){let e,t,n,o;return e=new mu({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",$$slots:{default:[mh]},$$scope:{ctx:l}}}),n=new gu({props:{class:"w-full rounded-xl px-1 py-1.5 z-50 bg-white dark:bg-gray-850 dark:text-white shadow-lg",transition:ql,sideOffset:8,$$slots:{default:[bh]},$$scope:{ctx:l}}}),{c(){ee(e.$$.fragment),t=Q(),ee(n.$$.fragment)},l(s){le(e.$$.fragment,s),t=x(s),le(n.$$.fragment,s)},m(s,i){te(e,s,i),B(s,t,i),te(n,s,i),o=!0},p(s,i){const r={};i&8388640&&(r.$$scope={dirty:i,ctx:s}),e.$set(r);const a={};i&8388640&&(a.$$scope={dirty:i,ctx:s}),n.$set(a)},i(s){o||(C(e.$$.fragment,s),C(n.$$.fragment,s),o=!0)},o(s){H(e.$$.fragment,s),H(n.$$.fragment,s),o=!1},d(s){s&&p(t),ne(e,s),ne(n,s)}}}function wh(l){let e,t,n,o=l[5].t("Copy")+"",s,i;return e=new ru({props:{className:" size-4",strokeWidth:"1.5"}}),{c(){ee(e.$$.fragment),t=Q(),n=T("div"),s=ke(o),this.h()},l(r){le(e.$$.fragment,r),t=x(r),n=V(r,"DIV",{class:!0});var a=S(n);s=Ee(a,o),a.forEach(p),this.h()},h(){m(n,"class","flex items-center")},m(r,a){te(e,r,a),B(r,t,a),B(r,n,a),k(n,s),i=!0},p(r,a){(!i||a&32)&&o!==(o=r[5].t("Copy")+"")&&Ce(s,o)},i(r){i||(C(e.$$.fragment,r),i=!0)},o(r){H(e.$$.fragment,r),i=!1},d(r){r&&(p(t),p(n)),ne(e,r)}}}function Ar(l){let e,t,n,o,s;return o=new pu({props:{chatId:l[1].id}}),{c(){e=T("hr"),t=Q(),n=T("div"),ee(o.$$.fragment),this.h()},l(i){e=V(i,"HR",{class:!0}),t=x(i),n=V(i,"DIV",{class:!0});var r=S(n);le(o.$$.fragment,r),r.forEach(p),this.h()},h(){m(e,"class","border-gray-100 dark:border-gray-850 my-0.5"),m(n,"class","flex p-1")},m(i,r){B(i,e,r),B(i,t,r),B(i,n,r),te(o,n,null),s=!0},p(i,r){const a={};r&2&&(a.chatId=i[1].id),o.$set(a)},i(i){s||(C(o.$$.fragment,i),s=!0)},o(i){H(o.$$.fragment,i),s=!1},d(i){i&&(p(e),p(t),p(n)),ne(o)}}}function yh(l){let e,t,n,o,s,i,r,a,c,u,f,d,h=l[4]&&Or(l),_=!l[3]&&Hr(l);n=new dn({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",id:"chat-overview-button",$$slots:{default:[dh]},$$scope:{ctx:l}}}),n.$on("click",l[16]),s=new dn({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",id:"chat-overview-button",$$slots:{default:[hh]},$$scope:{ctx:l}}}),s.$on("click",l[17]),r=new hu({props:{$$slots:{default:[vh]},$$scope:{ctx:l}}}),c=new dn({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",id:"chat-copy-button",$$slots:{default:[wh]},$$scope:{ctx:l}}}),c.$on("click",l[21]);let b=!l[3]&&Ar(l);return{c(){h&&h.c(),e=Q(),_&&_.c(),t=Q(),ee(n.$$.fragment),o=Q(),ee(s.$$.fragment),i=Q(),ee(r.$$.fragment),a=Q(),ee(c.$$.fragment),u=Q(),b&&b.c(),f=Te()},l(w){h&&h.l(w),e=x(w),_&&_.l(w),t=x(w),le(n.$$.fragment,w),o=x(w),le(s.$$.fragment,w),i=x(w),le(r.$$.fragment,w),a=x(w),le(c.$$.fragment,w),u=x(w),b&&b.l(w),f=Te()},m(w,g){h&&h.m(w,g),B(w,e,g),_&&_.m(w,g),B(w,t,g),te(n,w,g),B(w,o,g),te(s,w,g),B(w,i,g),te(r,w,g),B(w,a,g),te(c,w,g),B(w,u,g),b&&b.m(w,g),B(w,f,g),d=!0},p(w,g){w[4]?h?(h.p(w,g),g&16&&C(h,1)):(h=Or(w),h.c(),C(h,1),h.m(e.parentNode,e)):h&&(Ve(),H(h,1,1,()=>{h=null}),ze()),w[3]?_&&(Ve(),H(_,1,1,()=>{_=null}),ze()):_?(_.p(w,g),g&8&&C(_,1)):(_=Hr(w),_.c(),C(_,1),_.m(t.parentNode,t));const v={};g&8388640&&(v.$$scope={dirty:g,ctx:w}),n.$set(v);const y={};g&8388640&&(y.$$scope={dirty:g,ctx:w}),s.$set(y);const E={};g&8388640&&(E.$$scope={dirty:g,ctx:w}),r.$set(E);const z={};g&8388640&&(z.$$scope={dirty:g,ctx:w}),c.$set(z),w[3]?b&&(Ve(),H(b,1,1,()=>{b=null}),ze()):b?(b.p(w,g),g&8&&C(b,1)):(b=Ar(w),b.c(),C(b,1),b.m(f.parentNode,f))},i(w){d||(C(h),C(_),C(n.$$.fragment,w),C(s.$$.fragment,w),C(r.$$.fragment,w),C(c.$$.fragment,w),C(b),d=!0)},o(w){H(h),H(_),H(n.$$.fragment,w),H(s.$$.fragment,w),H(r.$$.fragment,w),H(c.$$.fragment,w),H(b),d=!1},d(w){w&&(p(e),p(t),p(o),p(i),p(a),p(u),p(f)),h&&h.d(w),_&&_.d(w),ne(n,w),ne(s,w),ne(r,w),ne(c,w),b&&b.d(w)}}}function kh(l){let e,t,n;return t=new To({props:{class:"w-full max-w-[200px] rounded-xl px-1 py-1.5  z-50 bg-white dark:bg-gray-850 dark:text-white shadow-lg",sideOffset:8,side:"bottom",align:"end",transition:ql,$$slots:{default:[yh]},$$scope:{ctx:l}}}),{c(){e=T("div"),ee(t.$$.fragment),this.h()},l(o){e=V(o,"DIV",{slot:!0});var s=S(e);le(t.$$.fragment,s),s.forEach(p),this.h()},h(){m(e,"slot","content")},m(o,s){B(o,e,s),te(t,e,null),n=!0},p(o,s){const i={};s&8388667&&(i.$$scope={dirty:s,ctx:o}),t.$set(i)},i(o){n||(C(t.$$.fragment,o),n=!0)},o(o){H(t.$$.fragment,o),n=!1},d(o){o&&p(e),ne(t)}}}function Eh(l){let e,t;return e=new Mo({props:{$$slots:{content:[kh],default:[ch]},$$scope:{ctx:l}}}),e.$on("change",l[22]),{c(){ee(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,o){te(e,n,o),t=!0},p(n,[o]){const s={};o&8388667&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}function Ih(l,e,t){let n,o,s;re(l,Co,K=>t(3,n=K)),re(l,rs,K=>t(4,o=K));let{$$slots:i={},$$scope:r}=e;const{saveAs:a}=wu,c=Ot("i18n");re(l,c,K=>t(5,s=K));let{shareEnabled:u=!1}=e,{shareHandler:f}=e,{downloadHandler:d}=e,{chat:h}=e,{onClose:_=()=>{}}=e;const b=async()=>{const K=h.chat.history;return bn(K,K.currentId).reduce((P,N,Y,Z)=>`${P}### ${N.role.toUpperCase()}
${N.content}

`,"").trim()},w=async()=>{const K=await b();let R=new Blob([K],{type:"text/plain"});a(R,`chat-${h.chat.title}.txt`)},g=async()=>{const K=h.chat.history,R=bn(K,K.currentId),I=await yu(localStorage.token,h.chat.title,R),P=window.URL.createObjectURL(I),N=document.createElement("a");N.href=P,N.download=`chat-${h.chat.title}.pdf`,document.body.appendChild(N),N.click(),document.body.removeChild(N),window.URL.revokeObjectURL(P)},v=async()=>{if(h.id){let K=null;h.id==="local"||n?K=h:K=await $o(localStorage.token,h.id);let R=new Blob([JSON.stringify([K])],{type:"application/json"});a(R,`chat-export-${Date.now()}.json`)}},y=async()=>{await Zt.set(!0),await Qn.set(!1),await Ln.set(!1)},E=()=>{f()},z=async()=>{await Zt.set(!0),await Qn.set(!0),await Ln.set(!1)},D=async()=>{await Zt.set(!0),await Ln.set(!0),await Qn.set(!1)},M=()=>{v()},A=()=>{w()},O=()=>{g()},L=async()=>{await pa(await b()).catch(R=>{console.error(R)})&&ct.success(s.t("Copied to clipboard"))},W=K=>{K.detail===!1&&_()};return l.$$set=K=>{"shareEnabled"in K&&t(11,u=K.shareEnabled),"shareHandler"in K&&t(0,f=K.shareHandler),"downloadHandler"in K&&t(12,d=K.downloadHandler),"chat"in K&&t(1,h=K.chat),"onClose"in K&&t(2,_=K.onClose),"$$scope"in K&&t(23,r=K.$$scope)},[f,h,_,n,o,s,c,b,w,g,v,u,d,i,y,E,z,D,M,A,O,L,W,r]}class Sh extends Oe{constructor(e){super(),He(this,e,Ih,Eh,Le,{shareEnabled:11,shareHandler:0,downloadHandler:12,chat:1,onClose:2})}}function Lr(l){let e,t,n;function o(i){l[16](i)}let s={showSetDefault:!l[2]};return l[0]!==void 0&&(s.selectedModels=l[0]),e=new $d({props:s}),Ae.push(()=>Xe(e,"selectedModels",o)),{c(){ee(e.$$.fragment)},l(i){le(e.$$.fragment,i)},m(i,r){te(e,i,r),n=!0},p(i,r){const a={};r&4&&(a.showSetDefault=!i[2]),!t&&r&1&&(t=!0,a.selectedModels=i[0],Ge(()=>t=!1)),e.$set(a)},i(i){n||(C(e.$$.fragment,i),n=!0)},o(i){H(e.$$.fragment,i),n=!1},d(i){ne(e,i)}}}function Br(l){let e,t;return e=new Sh({props:{chat:l[3],shareEnabled:l[2],shareHandler:l[17],downloadHandler:l[18],$$slots:{default:[Dh]},$$scope:{ctx:l}}}),{c(){ee(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,o){te(e,n,o),t=!0},p(n,o){const s={};o&8&&(s.chat=n[3]),o&4&&(s.shareEnabled=n[2]),o&32&&(s.shareHandler=n[17]),o&64&&(s.downloadHandler=n[18]),o&4194304&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}function Dh(l){let e,t='<div class="m-auto self-center"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5"><path stroke-linecap="round" stroke-linejoin="round" d="M6.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM12.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM18.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z"></path></svg></div>';return{c(){e=T("button"),e.innerHTML=t,this.h()},l(n){e=V(n,"BUTTON",{class:!0,id:!0,"data-svelte-h":!0}),it(e)!=="svelte-xd5mtd"&&(e.innerHTML=t),this.h()},h(){m(e,"class","flex cursor-pointer px-2 py-2 rounded-xl hover:bg-gray-50 dark:hover:bg-gray-850 transition"),m(e,"id","chat-context-menu-button")},m(n,o){B(n,e,o)},p:De,d(n){n&&p(e)}}}function Ch(l){let e,t,n,o,s,i,r;return n=new bu({props:{className:" size-5",strokeWidth:"2"}}),{c(){e=T("button"),t=T("div"),ee(n.$$.fragment),this.h()},l(a){e=V(a,"BUTTON",{id:!0,class:!0,"aria-label":!0});var c=S(e);t=V(c,"DIV",{class:!0});var u=S(t);le(n.$$.fragment,u),u.forEach(p),c.forEach(p),this.h()},h(){m(t,"class","m-auto self-center"),m(e,"id","new-chat-button"),m(e,"class",o="flex "+(l[8]?"md:hidden":"")+" cursor-pointer px-2 py-2 rounded-xl text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-850 transition"),m(e,"aria-label","New Chat")},m(a,c){B(a,e,c),k(e,t),te(n,t,null),s=!0,i||(r=Se(e,"click",l[19]),i=!0)},p(a,c){(!s||c&256&&o!==(o="flex "+(a[8]?"md:hidden":"")+" cursor-pointer px-2 py-2 rounded-xl text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-850 transition"))&&m(e,"class",o)},i(a){s||(C(n.$$.fragment,a),s=!0)},o(a){H(n.$$.fragment,a),s=!1},d(a){a&&p(e),ne(n),i=!1,r()}}}function Rr(l){let e,t;return e=new ku({props:{className:"max-w-[200px]",role:l[11].role,$$slots:{default:[Mh]},$$scope:{ctx:l}}}),e.$on("show",l[20]),{c(){ee(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,o){te(e,n,o),t=!0},p(n,o){const s={};o&2048&&(s.role=n[11].role),o&4196352&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}function Mh(l){let e,t,n,o;return{c(){e=T("button"),t=T("div"),n=T("img"),this.h()},l(s){e=V(s,"BUTTON",{class:!0,"aria-label":!0});var i=S(e);t=V(i,"DIV",{class:!0});var r=S(t);n=V(r,"IMG",{src:!0,class:!0,alt:!0,draggable:!0}),r.forEach(p),i.forEach(p),this.h()},h(){Yn(n.src,o=l[11].profile_image_url)||m(n,"src",o),m(n,"class","size-6 object-cover rounded-full"),m(n,"alt","User profile"),m(n,"draggable","false"),m(t,"class","self-center"),m(e,"class","select-none flex rounded-xl p-1.5 w-full hover:bg-gray-50 dark:hover:bg-gray-850 transition"),m(e,"aria-label","User Menu")},m(s,i){B(s,e,i),k(e,t),k(t,n)},p(s,i){i&2048&&!Yn(n.src,o=s[11].profile_image_url)&&m(n,"src",o)},d(s){s&&p(e)}}}function Th(l){let e,t,n,o,s,i,r,a,c,u,f,d,h,_,b,w,g,v,y,E,z,D,M,A;function O(I){l[14](I)}let L={chatId:l[7]};l[5]!==void 0&&(L.show=l[5]),e=new _u({props:L}),Ae.push(()=>Xe(e,"show",O)),d=new Eu({});let W=l[4]&&Lr(l),K=l[2]&&l[3]&&(l[3].id||l[9])&&Br(l);E=new Ft({props:{content:l[10].t("New Chat"),$$slots:{default:[Ch]},$$scope:{ctx:l}}});let R=l[11]!==void 0&&Rr(l);return{c(){ee(e.$$.fragment),n=Q(),o=T("nav"),s=T("div"),i=Q(),r=T("div"),a=T("div"),c=T("div"),u=T("button"),f=T("div"),ee(d.$$.fragment),_=Q(),b=T("div"),W&&W.c(),g=Q(),v=T("div"),K&&K.c(),y=Q(),ee(E.$$.fragment),z=Q(),R&&R.c(),this.h()},l(I){le(e.$$.fragment,I),n=x(I),o=V(I,"NAV",{class:!0});var P=S(o);s=V(P,"DIV",{class:!0}),S(s).forEach(p),i=x(P),r=V(P,"DIV",{class:!0});var N=S(r);a=V(N,"DIV",{class:!0});var Y=S(a);c=V(Y,"DIV",{class:!0});var Z=S(c);u=V(Z,"BUTTON",{id:!0,class:!0,"aria-label":!0});var F=S(u);f=V(F,"DIV",{class:!0});var X=S(f);le(d.$$.fragment,X),X.forEach(p),F.forEach(p),Z.forEach(p),_=x(Y),b=V(Y,"DIV",{class:!0});var se=S(b);W&&W.l(se),se.forEach(p),g=x(Y),v=V(Y,"DIV",{class:!0});var q=S(v);K&&K.l(q),y=x(q),le(E.$$.fragment,q),z=x(q),R&&R.l(q),q.forEach(p),Y.forEach(p),N.forEach(p),P.forEach(p),this.h()},h(){m(s,"class","bg-linear-to-b via-50% from-white via-white to-transparent dark:from-gray-900 dark:via-gray-900 dark:to-transparent pointer-events-none absolute inset-0 -bottom-7 z-[-1]"),m(f,"class","m-auto self-center"),m(u,"id","sidebar-toggle-button"),m(u,"class","cursor-pointer px-2 py-2 flex rounded-xl hover:bg-gray-50 dark:hover:bg-gray-850 transition"),m(u,"aria-label","Toggle Sidebar"),m(c,"class",h=(l[8]?"md:hidden":"")+" mr-1 self-start flex flex-none items-center text-gray-600 dark:text-gray-400"),m(b,"class",w="flex-1 overflow-hidden max-w-full py-0.5 "+(l[8]?"ml-1":"")),m(v,"class","self-start flex flex-none items-center text-gray-600 dark:text-gray-400"),m(a,"class","flex items-center w-full max-w-full"),m(r,"class","flex max-w-full w-full mx-auto px-1 pt-0.5 bg-transparent"),m(o,"class","sticky top-0 z-30 w-full px-1.5 py-1.5 -mb-8 flex items-center drag-region")},m(I,P){te(e,I,P),B(I,n,P),B(I,o,P),k(o,s),k(o,i),k(o,r),k(r,a),k(a,c),k(c,u),k(u,f),te(d,f,null),k(a,_),k(a,b),W&&W.m(b,null),k(a,g),k(a,v),K&&K.m(v,null),k(v,y),te(E,v,null),k(v,z),R&&R.m(v,null),D=!0,M||(A=Se(u,"click",l[15]),M=!0)},p(I,[P]){const N={};P&128&&(N.chatId=I[7]),!t&&P&32&&(t=!0,N.show=I[5],Ge(()=>t=!1)),e.$set(N),(!D||P&256&&h!==(h=(I[8]?"md:hidden":"")+" mr-1 self-start flex flex-none items-center text-gray-600 dark:text-gray-400"))&&m(c,"class",h),I[4]?W?(W.p(I,P),P&16&&C(W,1)):(W=Lr(I),W.c(),C(W,1),W.m(b,null)):W&&(Ve(),H(W,1,1,()=>{W=null}),ze()),(!D||P&256&&w!==(w="flex-1 overflow-hidden max-w-full py-0.5 "+(I[8]?"ml-1":"")))&&m(b,"class",w),I[2]&&I[3]&&(I[3].id||I[9])?K?(K.p(I,P),P&524&&C(K,1)):(K=Br(I),K.c(),C(K,1),K.m(v,y)):K&&(Ve(),H(K,1,1,()=>{K=null}),ze());const Y={};P&1024&&(Y.content=I[10].t("New Chat")),P&4194562&&(Y.$$scope={dirty:P,ctx:I}),E.$set(Y),I[11]!==void 0?R?(R.p(I,P),P&2048&&C(R,1)):(R=Rr(I),R.c(),C(R,1),R.m(v,null)):R&&(Ve(),H(R,1,1,()=>{R=null}),ze())},i(I){D||(C(e.$$.fragment,I),C(d.$$.fragment,I),C(W),C(K),C(E.$$.fragment,I),C(R),D=!0)},o(I){H(e.$$.fragment,I),H(d.$$.fragment,I),H(W),H(K),H(E.$$.fragment,I),H(R),D=!1},d(I){I&&(p(n),p(o)),ne(e,I),ne(d),W&&W.d(),K&&K.d(),ne(E),R&&R.d(),M=!1,A()}}}function Vh(l,e,t){let n,o,s,i,r,a;re(l,ga,O=>t(21,n=O)),re(l,Jn,O=>t(7,o=O)),re(l,xo,O=>t(8,s=O)),re(l,Co,O=>t(9,i=O)),re(l,Kn,O=>t(11,a=O));const c=Ot("i18n");re(l,c,O=>t(10,r=O));let{initNewChat:u}=e,{title:f=n}=e,{shareEnabled:d=!1}=e,{chat:h}=e,{selectedModels:_}=e,{showModelSelector:b=!0}=e,w=!1,g=!1;function v(O){w=O,t(5,w)}const y=()=>{xo.set(!s)};function E(O){_=O,t(0,_)}const z=()=>{t(5,w=!w)},D=()=>{t(6,g=!g)},M=()=>{u()},A=O=>{O.detail==="archived-chat"&&_c.set(!0)};return l.$$set=O=>{"initNewChat"in O&&t(1,u=O.initNewChat),"title"in O&&t(13,f=O.title),"shareEnabled"in O&&t(2,d=O.shareEnabled),"chat"in O&&t(3,h=O.chat),"selectedModels"in O&&t(0,_=O.selectedModels),"showModelSelector"in O&&t(4,b=O.showModelSelector)},[_,u,d,h,b,w,g,o,s,i,r,a,c,f,v,y,E,z,D,M,A]}class zh extends Oe{constructor(e){super(),He(this,e,Vh,Th,Le,{initNewChat:1,title:13,shareEnabled:2,chat:3,selectedModels:0,showModelSelector:4})}}function Nt(l){if(typeof l=="string"||typeof l=="number")return""+l;let e="";if(Array.isArray(l))for(let t=0,n;t<l.length;t++)(n=Nt(l[t]))!==""&&(e+=(e&&" ")+n);else for(let t in l)l[t]&&(e+=(e&&" ")+t);return e}const Jl={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:l=>`Node type "${l}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:l=>`The old edge with id=${l} does not exist.`,error009:l=>`Marker type "${l}" doesn't exist.`,error008:(l,{id:e,sourceHandle:t,targetHandle:n})=>`Couldn't create edge for ${l} handle id: "${l==="source"?t:n}", edge id: ${e}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:l=>`Edge type "${l}" not found. Using fallback type "default".`,error012:l=>`Node with id "${l}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(l="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${l}/dist/style.css' or base.css to make sure everything is working properly.`},po=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]];var dl;(function(l){l.Strict="strict",l.Loose="loose"})(dl||(dl={}));var Bn;(function(l){l.Free="free",l.Vertical="vertical",l.Horizontal="horizontal"})(Bn||(Bn={}));var _o;(function(l){l.Partial="partial",l.Full="full"})(_o||(_o={}));const ns={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null};var wl;(function(l){l.Bezier="default",l.Straight="straight",l.Step="step",l.SmoothStep="smoothstep",l.SimpleBezier="simplebezier"})(wl||(wl={}));var bo;(function(l){l.Arrow="arrow",l.ArrowClosed="arrowclosed"})(bo||(bo={}));var ot;(function(l){l.Left="left",l.Top="top",l.Right="right",l.Bottom="bottom"})(ot||(ot={}));const Ur={[ot.Left]:ot.Right,[ot.Right]:ot.Left,[ot.Top]:ot.Bottom,[ot.Bottom]:ot.Top};function Nh(l,e){if(!l&&!e)return!0;if(!l||!e||l.size!==e.size)return!1;if(!l.size&&!e.size)return!0;for(const t of l.keys())if(!e.has(t))return!1;return!0}function Fr(l,e,t){if(!t)return;const n=[];l.forEach((o,s)=>{e!=null&&e.has(s)||n.push(o)}),n.length&&t(n)}function Wr(l){return l===null?null:l?"valid":"invalid"}const Ph=l=>"id"in l&&"source"in l&&"target"in l,Oh=l=>"id"in l&&"position"in l&&!("source"in l)&&!("target"in l),us=l=>"id"in l&&"internals"in l&&!("source"in l)&&!("target"in l),No=(l,e=[0,0])=>{const{width:t,height:n}=Cl(l),o=l.origin??e,s=t*o[0],i=n*o[1];return{x:l.position.x-s,y:l.position.y-i}},Hh=(l,e={nodeOrigin:[0,0],nodeLookup:void 0})=>{if(l.length===0)return{x:0,y:0,width:0,height:0};const t=l.reduce((n,o)=>{const s=typeof o=="string";let i=!e.nodeLookup&&!s?o:void 0;e.nodeLookup&&(i=s?e.nodeLookup.get(o):us(o)?o:e.nodeLookup.get(o.id));const r=i?vo(i,e.nodeOrigin):{x:0,y:0,x2:0,y2:0};return Oo(n,r)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return Ho(t)},Po=(l,e={})=>{if(l.size===0)return{x:0,y:0,width:0,height:0};let t={x:1/0,y:1/0,x2:-1/0,y2:-1/0};return l.forEach(n=>{if(e.filter===void 0||e.filter(n)){const o=vo(n);t=Oo(t,o)}}),Ho(t)},Ia=(l,e,[t,n,o]=[0,0,1],s=!1,i=!1)=>{const r={...Ql(e,[t,n,o]),width:e.width/o,height:e.height/o},a=[];for(const c of l.values()){const{measured:u,selectable:f=!0,hidden:d=!1}=c;if(i&&!f||d)continue;const h=u.width??c.width??c.initialWidth??null,_=u.height??c.height??c.initialHeight??null,b=Gl(r,Sl(c)),w=(h??0)*(_??0),g=s&&b>0;(!c.internals.handleBounds||g||b>=w||c.dragging)&&a.push(c)}return a},ls=(l,e)=>{const t=new Set;return l.forEach(n=>{t.add(n.id)}),e.filter(n=>t.has(n.source)||t.has(n.target))};function jr(l,e){const t=new Map,n=e!=null&&e.nodes?new Set(e.nodes.map(o=>o.id)):null;return l.forEach(o=>{o.measured.width&&o.measured.height&&((e==null?void 0:e.includeHiddenNodes)||!o.hidden)&&(!n||n.has(o.id))&&t.set(o.id,o)}),t}async function Yr({nodes:l,width:e,height:t,panZoom:n,minZoom:o,maxZoom:s},i){if(l.size===0)return Promise.resolve(!1);const r=Po(l),a=ds(r,e,t,(i==null?void 0:i.minZoom)??o,(i==null?void 0:i.maxZoom)??s,(i==null?void 0:i.padding)??.1);return await n.setViewport(a,{duration:i==null?void 0:i.duration}),Promise.resolve(!0)}function Ah({nodeId:l,nextPosition:e,nodeLookup:t,nodeOrigin:n=[0,0],nodeExtent:o,onError:s}){const i=t.get(l),r=i.parentId?t.get(i.parentId):void 0,{x:a,y:c}=r?r.internals.positionAbsolute:{x:0,y:0},u=i.origin??n;let f=o;if(i.extent==="parent"&&!i.expandParent)if(!r)s==null||s("005",Jl.error005());else{const h=r.measured.width,_=r.measured.height;h&&_&&(f=[[a,c],[a+h,c+_]])}else r&&Xl(i.extent)&&(f=[[i.extent[0][0]+a,i.extent[0][1]+c],[i.extent[1][0]+a,i.extent[1][1]+c]]);const d=Xl(f)?Il(e,f,i.measured):e;return{position:{x:d.x-a+i.measured.width*u[0],y:d.y-c+i.measured.height*u[1]},positionAbsolute:d}}async function Sa({nodesToRemove:l=[],edgesToRemove:e=[],nodes:t,edges:n,onBeforeDelete:o}){const s=new Set(l.map(d=>d.id)),i=[];for(const d of t){if(d.deletable===!1)continue;const h=s.has(d.id),_=!h&&d.parentId&&i.find(b=>b.id===d.parentId);(h||_)&&i.push(d)}const r=new Set(e.map(d=>d.id)),a=n.filter(d=>d.deletable!==!1),u=ls(i,a);for(const d of a)r.has(d.id)&&!u.find(_=>_.id===d.id)&&u.push(d);if(!o)return{edges:u,nodes:i};const f=await o({nodes:i,edges:u});return typeof f=="boolean"?f?{edges:u,nodes:i}:{edges:[],nodes:[]}:f}const El=(l,e=0,t=1)=>Math.min(Math.max(l,e),t),Il=(l={x:0,y:0},e,t)=>({x:El(l.x,e[0][0],e[1][0]-((t==null?void 0:t.width)??0)),y:El(l.y,e[0][1],e[1][1]-((t==null?void 0:t.height)??0))});function Da(l,e,t){const{width:n,height:o}=Cl(t),{x:s,y:i}=t.internals.positionAbsolute;return Il(l,[[s,i],[s+n,i+o]],e)}const Kr=(l,e,t)=>l<e?El(Math.abs(l-e),1,e)/e:l>t?-El(Math.abs(l-t),1,e)/e:0,Ca=(l,e,t=15,n=40)=>{const o=Kr(l.x,n,e.width-n)*t,s=Kr(l.y,n,e.height-n)*t;return[o,s]},Oo=(l,e)=>({x:Math.min(l.x,e.x),y:Math.min(l.y,e.y),x2:Math.max(l.x2,e.x2),y2:Math.max(l.y2,e.y2)}),os=({x:l,y:e,width:t,height:n})=>({x:l,y:e,x2:l+t,y2:e+n}),Ho=({x:l,y:e,x2:t,y2:n})=>({x:l,y:e,width:t-l,height:n-e}),Sl=(l,e=[0,0])=>{var o,s;const{x:t,y:n}=us(l)?l.internals.positionAbsolute:No(l,e);return{x:t,y:n,width:((o=l.measured)==null?void 0:o.width)??l.width??l.initialWidth??0,height:((s=l.measured)==null?void 0:s.height)??l.height??l.initialHeight??0}},vo=(l,e=[0,0])=>{var o,s;const{x:t,y:n}=us(l)?l.internals.positionAbsolute:No(l,e);return{x:t,y:n,x2:t+(((o=l.measured)==null?void 0:o.width)??l.width??l.initialWidth??0),y2:n+(((s=l.measured)==null?void 0:s.height)??l.height??l.initialHeight??0)}},Lh=(l,e)=>Ho(Oo(os(l),os(e))),Gl=(l,e)=>{const t=Math.max(0,Math.min(l.x+l.width,e.x+e.width)-Math.max(l.x,e.x)),n=Math.max(0,Math.min(l.y+l.height,e.y+e.height)-Math.max(l.y,e.y));return Math.ceil(t*n)},Gr=l=>Vn(l.width)&&Vn(l.height)&&Vn(l.x)&&Vn(l.y),Vn=l=>!isNaN(l)&&isFinite(l),Bh=(l,e)=>{},fs=(l,e=[1,1])=>({x:e[0]*Math.round(l.x/e[0]),y:e[1]*Math.round(l.y/e[1])}),Ql=({x:l,y:e},[t,n,o],s=!1,i=[1,1])=>{const r={x:(l-t)/o,y:(e-n)/o};return s?fs(r,i):r},Ma=({x:l,y:e},[t,n,o])=>({x:l*o+t,y:e*o+n}),ds=(l,e,t,n,o,s)=>{const i=e/(l.width*(1+s)),r=t/(l.height*(1+s)),a=Math.min(i,r),c=El(a,n,o),u=l.x+l.width/2,f=l.y+l.height/2,d=e/2-u*c,h=t/2-f*c;return{x:d,y:h,zoom:c}},wo=()=>{var l;return typeof navigator<"u"&&((l=navigator==null?void 0:navigator.userAgent)==null?void 0:l.indexOf("Mac"))>=0};function Xl(l){return l!==void 0&&l!=="parent"}function Cl(l){var e,t;return{width:((e=l.measured)==null?void 0:e.width)??l.width??l.initialWidth??0,height:((t=l.measured)==null?void 0:t.height)??l.height??l.initialHeight??0}}function Xr(l){var e,t;return(((e=l.measured)==null?void 0:e.width)??l.width??l.initialWidth)!==void 0&&(((t=l.measured)==null?void 0:t.height)??l.height??l.initialHeight)!==void 0}function Rh(l,e={width:0,height:0},t,n,o){let s=t;const i={...l};for(;s;){const r=n.get(s);if(s=r==null?void 0:r.parentId,r){const a=r.origin||o;i.x+=r.internals.positionAbsolute.x-(e.width??0)*a[0],i.y+=r.internals.positionAbsolute.y-(e.height??0)*a[1]}}return i}function Ko(l,{snapGrid:e=[0,0],snapToGrid:t=!1,transform:n}){const{x:o,y:s}=Wn(l),i=Ql({x:o,y:s},n),{x:r,y:a}=t?fs(i,e):i;return{xSnapped:r,ySnapped:a,...i}}const Ta=l=>({width:l.offsetWidth,height:l.offsetHeight}),Uh=l=>{var e;return((e=l.getRootNode)==null?void 0:e.call(l))||(window==null?void 0:window.document)},Fh=["INPUT","SELECT","TEXTAREA"];function Wh(l){var n,o;const e=((o=(n=l.composedPath)==null?void 0:n.call(l))==null?void 0:o[0])||l.target;return Fh.includes(e==null?void 0:e.nodeName)||(e==null?void 0:e.hasAttribute("contenteditable"))||!!(e!=null&&e.closest(".nokey"))}const Va=l=>"clientX"in l,Wn=(l,e)=>{var s,i;const t=Va(l),n=t?l.clientX:(s=l.touches)==null?void 0:s[0].clientX,o=t?l.clientY:(i=l.touches)==null?void 0:i[0].clientY;return{x:n-((e==null?void 0:e.left)??0),y:o-((e==null?void 0:e.top)??0)}},Zr=(l,e,t,n,o)=>{const s=e.querySelectorAll(`.${l}`);return!s||!s.length?null:Array.from(s).map(i=>{const r=i.getBoundingClientRect();return{id:i.getAttribute("data-handleid"),type:l,nodeId:o,position:i.getAttribute("data-handlepos"),x:(r.left-t.left)/n,y:(r.top-t.top)/n,...Ta(i)}})};function jh({sourceX:l,sourceY:e,targetX:t,targetY:n,sourceControlX:o,sourceControlY:s,targetControlX:i,targetControlY:r}){const a=l*.125+o*.375+i*.375+t*.125,c=e*.125+s*.375+r*.375+n*.125,u=Math.abs(a-l),f=Math.abs(c-e);return[a,c,u,f]}function co(l,e){return l>=0?.5*l:e*25*Math.sqrt(-l)}function qr({pos:l,x1:e,y1:t,x2:n,y2:o,c:s}){switch(l){case ot.Left:return[e-co(e-n,s),t];case ot.Right:return[e+co(n-e,s),t];case ot.Top:return[e,t-co(t-o,s)];case ot.Bottom:return[e,t+co(o-t,s)]}}function za({sourceX:l,sourceY:e,sourcePosition:t=ot.Bottom,targetX:n,targetY:o,targetPosition:s=ot.Top,curvature:i=.25}){const[r,a]=qr({pos:t,x1:l,y1:e,x2:n,y2:o,c:i}),[c,u]=qr({pos:s,x1:n,y1:o,x2:l,y2:e,c:i}),[f,d,h,_]=jh({sourceX:l,sourceY:e,targetX:n,targetY:o,sourceControlX:r,sourceControlY:a,targetControlX:c,targetControlY:u});return[`M${l},${e} C${r},${a} ${c},${u} ${n},${o}`,f,d,h,_]}function Na({sourceX:l,sourceY:e,targetX:t,targetY:n}){const o=Math.abs(t-l)/2,s=t<l?t+o:t-o,i=Math.abs(n-e)/2,r=n<e?n+i:n-i;return[s,r,o,i]}function Yh({sourceNode:l,targetNode:e,selected:t=!1,zIndex:n=0,elevateOnSelect:o=!1}){if(!o)return n;const s=t||e.selected||l.selected,i=Math.max(l.internals.z||0,e.internals.z||0,1e3);return n+(s?i:0)}function Kh({sourceNode:l,targetNode:e,width:t,height:n,transform:o}){const s=Oo(vo(l),vo(e));s.x===s.x2&&(s.x2+=1),s.y===s.y2&&(s.y2+=1);const i={x:-o[0]/o[2],y:-o[1]/o[2],width:t/o[2],height:n/o[2]};return Gl(i,Ho(s))>0}const Gh=({source:l,sourceHandle:e,target:t,targetHandle:n})=>`xy-edge__${l}${e||""}-${t}${n||""}`,Xh=(l,e)=>e.some(t=>t.source===l.source&&t.target===l.target&&(t.sourceHandle===l.sourceHandle||!t.sourceHandle&&!l.sourceHandle)&&(t.targetHandle===l.targetHandle||!t.targetHandle&&!l.targetHandle)),Zh=(l,e)=>{if(!l.source||!l.target)return e;let t;return Ph(l)?t={...l}:t={...l,id:Gh(l)},Xh(t,e)?e:(t.sourceHandle===null&&delete t.sourceHandle,t.targetHandle===null&&delete t.targetHandle,e.concat(t))};function Pa({sourceX:l,sourceY:e,targetX:t,targetY:n}){const[o,s,i,r]=Na({sourceX:l,sourceY:e,targetX:t,targetY:n});return[`M ${l},${e}L ${t},${n}`,o,s,i,r]}const Jr={[ot.Left]:{x:-1,y:0},[ot.Right]:{x:1,y:0},[ot.Top]:{x:0,y:-1},[ot.Bottom]:{x:0,y:1}},qh=({source:l,sourcePosition:e=ot.Bottom,target:t})=>e===ot.Left||e===ot.Right?l.x<t.x?{x:1,y:0}:{x:-1,y:0}:l.y<t.y?{x:0,y:1}:{x:0,y:-1},Qr=(l,e)=>Math.sqrt(Math.pow(e.x-l.x,2)+Math.pow(e.y-l.y,2));function Jh({source:l,sourcePosition:e=ot.Bottom,target:t,targetPosition:n=ot.Top,center:o,offset:s}){const i=Jr[e],r=Jr[n],a={x:l.x+i.x*s,y:l.y+i.y*s},c={x:t.x+r.x*s,y:t.y+r.y*s},u=qh({source:a,sourcePosition:e,target:c}),f=u.x!==0?"x":"y",d=u[f];let h=[],_,b;const w={x:0,y:0},g={x:0,y:0},[v,y,E,z]=Na({sourceX:l.x,sourceY:l.y,targetX:t.x,targetY:t.y});if(i[f]*r[f]===-1){_=o.x??v,b=o.y??y;const M=[{x:_,y:a.y},{x:_,y:c.y}],A=[{x:a.x,y:b},{x:c.x,y:b}];i[f]===d?h=f==="x"?M:A:h=f==="x"?A:M}else{const M=[{x:a.x,y:c.y}],A=[{x:c.x,y:a.y}];if(f==="x"?h=i.x===d?A:M:h=i.y===d?M:A,e===n){const R=Math.abs(l[f]-t[f]);if(R<=s){const I=Math.min(s-1,s-R);i[f]===d?w[f]=(a[f]>l[f]?-1:1)*I:g[f]=(c[f]>t[f]?-1:1)*I}}if(e!==n){const R=f==="x"?"y":"x",I=i[f]===r[R],P=a[R]>c[R],N=a[R]<c[R];(i[f]===1&&(!I&&P||I&&N)||i[f]!==1&&(!I&&N||I&&P))&&(h=f==="x"?M:A)}const O={x:a.x+w.x,y:a.y+w.y},L={x:c.x+g.x,y:c.y+g.y},W=Math.max(Math.abs(O.x-h[0].x),Math.abs(L.x-h[0].x)),K=Math.max(Math.abs(O.y-h[0].y),Math.abs(L.y-h[0].y));W>=K?(_=(O.x+L.x)/2,b=h[0].y):(_=h[0].x,b=(O.y+L.y)/2)}return[[l,{x:a.x+w.x,y:a.y+w.y},...h,{x:c.x+g.x,y:c.y+g.y},t],_,b,E,z]}function Qh(l,e,t,n){const o=Math.min(Qr(l,e)/2,Qr(e,t)/2,n),{x:s,y:i}=e;if(l.x===s&&s===t.x||l.y===i&&i===t.y)return`L${s} ${i}`;if(l.y===i){const c=l.x<t.x?-1:1,u=l.y<t.y?1:-1;return`L ${s+o*c},${i}Q ${s},${i} ${s},${i+o*u}`}const r=l.x<t.x?1:-1,a=l.y<t.y?-1:1;return`L ${s},${i+o*a}Q ${s},${i} ${s+o*r},${i}`}function yo({sourceX:l,sourceY:e,sourcePosition:t=ot.Bottom,targetX:n,targetY:o,targetPosition:s=ot.Top,borderRadius:i=5,centerX:r,centerY:a,offset:c=20}){const[u,f,d,h,_]=Jh({source:{x:l,y:e},sourcePosition:t,target:{x:n,y:o},targetPosition:s,center:{x:r,y:a},offset:c});return[u.reduce((w,g,v)=>{let y="";return v>0&&v<u.length-1?y=Qh(u[v-1],g,u[v+1],i):y=`${v===0?"M":"L"}${g.x} ${g.y}`,w+=y,w},""),f,d,h,_]}function xr(l){var e;return l&&!!(l.internals.handleBounds||(e=l.handles)!=null&&e.length)&&!!(l.measured.width||l.width||l.initialWidth)}function xh(l){var f;const{sourceNode:e,targetNode:t}=l;if(!xr(e)||!xr(t))return null;const n=e.internals.handleBounds||$r(e.handles),o=t.internals.handleBounds||$r(t.handles),s=ei((n==null?void 0:n.source)??[],l.sourceHandle),i=ei(l.connectionMode===dl.Strict?(o==null?void 0:o.target)??[]:((o==null?void 0:o.target)??[]).concat((o==null?void 0:o.source)??[]),l.targetHandle);if(!s||!i)return(f=l.onError)==null||f.call(l,"008",Jl.error008(s?"target":"source",{id:l.id,sourceHandle:l.sourceHandle,targetHandle:l.targetHandle})),null;const r=(s==null?void 0:s.position)||ot.Bottom,a=(i==null?void 0:i.position)||ot.Top,c=Zl(e,s,r),u=Zl(t,i,a);return{sourceX:c.x,sourceY:c.y,targetX:u.x,targetY:u.y,sourcePosition:r,targetPosition:a}}function $r(l){if(!l)return null;const e=[],t=[];for(const n of l)n.width=n.width??1,n.height=n.height??1,n.type==="source"?e.push(n):n.type==="target"&&t.push(n);return{source:e,target:t}}function Zl(l,e,t=ot.Left,n=!1){const o=((e==null?void 0:e.x)??0)+l.internals.positionAbsolute.x,s=((e==null?void 0:e.y)??0)+l.internals.positionAbsolute.y,{width:i,height:r}=e??Cl(l);if(n)return{x:o+i/2,y:s+r/2};switch((e==null?void 0:e.position)??t){case ot.Top:return{x:o+i/2,y:s};case ot.Right:return{x:o+i,y:s+r/2};case ot.Bottom:return{x:o+i/2,y:s+r};case ot.Left:return{x:o,y:s+r/2}}}function ei(l,e){return l&&(e?l.find(t=>t.id===e):l[0])||null}function ss(l,e){return l?typeof l=="string"?l:`${e?`${e}__`:""}${Object.keys(l).sort().map(n=>`${n}=${l[n]}`).join("&")}`:""}function $h(l,{id:e,defaultColor:t,defaultMarkerStart:n,defaultMarkerEnd:o}){const s=new Set;return l.reduce((i,r)=>([r.markerStart||n,r.markerEnd||o].forEach(a=>{if(a&&typeof a=="object"){const c=ss(a,e);s.has(c)||(i.push({id:c,color:a.color||t,...a}),s.add(c))}}),i),[]).sort((i,r)=>i.id.localeCompare(r.id))}const Oa={nodeOrigin:[0,0],nodeExtent:po,elevateNodesOnSelect:!0,defaults:{}},em={...Oa,checkEquality:!0};function Ha(l,e){const t={...l};for(const n in e)e[n]!==void 0&&(t[n]=e[n]);return t}function Aa(l,e,t,n){var r,a;const o=Ha(em,n),s=new Map(e),i=o!=null&&o.elevateNodesOnSelect?1e3:0;e.clear(),t.clear();for(const c of l){let u=s.get(c.id);if(o.checkEquality&&c===(u==null?void 0:u.internals.userNode))e.set(c.id,u);else{const f=No(c,o.nodeOrigin),d=Xl(c.extent)?c.extent:o.nodeExtent,h=Il(f,d,Cl(c));u={...o.defaults,...c,measured:{width:(r=c.measured)==null?void 0:r.width,height:(a=c.measured)==null?void 0:a.height},internals:{positionAbsolute:h,handleBounds:c.measured?u==null?void 0:u.internals.handleBounds:void 0,z:Ba(c,i),userNode:c}},e.set(c.id,u)}c.parentId&&La(u,e,t,n)}}function tm(l,e){if(!l.parentId)return;const t=e.get(l.parentId);t?t.set(l.id,l):e.set(l.parentId,new Map([[l.id,l]]))}function La(l,e,t,n){const{elevateNodesOnSelect:o,nodeOrigin:s,nodeExtent:i}=Ha(Oa,n),r=l.parentId,a=e.get(r);if(!a){console.warn(`Parent node ${r} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}tm(l,t);const c=o?1e3:0,{x:u,y:f,z:d}=nm(l,a,s,i,c),{positionAbsolute:h}=l.internals,_=u!==h.x||f!==h.y;(_||d!==l.internals.z)&&(l.internals={...l.internals,positionAbsolute:_?{x:u,y:f}:h,z:d})}function Ba(l,e){return(Vn(l.zIndex)?l.zIndex:0)+(l.selected?e:0)}function nm(l,e,t,n,o){const{x:s,y:i}=e.internals.positionAbsolute,r=Cl(l),a=No(l,t),c=Xl(l.extent)?Il(a,l.extent,r):a;let u=Il({x:s+c.x,y:i+c.y},n,r);l.extent==="parent"&&(u=Da(u,r,e));const f=Ba(l,o),d=e.internals.z??0;return{x:u.x,y:u.y,z:d>f?d:f}}function lm(l,e,t,n=[0,0]){var i;const o=[],s=new Map;for(const r of l){const a=e.get(r.parentId);if(!a)continue;const c=((i=s.get(r.parentId))==null?void 0:i.expandedRect)??Sl(a),u=Lh(c,r.rect);s.set(r.parentId,{expandedRect:u,parent:a})}return s.size>0&&s.forEach(({expandedRect:r,parent:a},c)=>{var y;const u=a.internals.positionAbsolute,f=Cl(a),d=a.origin??n,h=r.x<u.x?Math.round(Math.abs(u.x-r.x)):0,_=r.y<u.y?Math.round(Math.abs(u.y-r.y)):0,b=Math.max(f.width,Math.round(r.width)),w=Math.max(f.height,Math.round(r.height)),g=(b-f.width)*d[0],v=(w-f.height)*d[1];(h>0||_>0||g||v)&&(o.push({id:c,type:"position",position:{x:a.position.x-h+g,y:a.position.y-_+v}}),(y=t.get(c))==null||y.forEach(E=>{l.some(z=>z.id===E.id)||o.push({id:E.id,type:"position",position:{x:E.position.x+h,y:E.position.y+_}})})),(f.width<r.width||f.height<r.height||h||_)&&o.push({id:c,type:"dimensions",setAttributes:!0,dimensions:{width:b+(h?d[0]*h-g:0),height:w+(_?d[1]*_-v:0)}})}),o}function om(l,e,t,n,o,s){const i=n==null?void 0:n.querySelector(".xyflow__viewport");let r=!1;if(!i)return{changes:[],updatedInternals:r};const a=[],c=window.getComputedStyle(i),{m22:u}=new window.DOMMatrixReadOnly(c.transform),f=[];for(const d of l.values()){const h=e.get(d.id);if(h)if(h.hidden)h.internals={...h.internals,handleBounds:void 0},r=!0;else{const _=Ta(d.nodeElement),b=h.measured.width!==_.width||h.measured.height!==_.height;if(!!(_.width&&_.height&&(b||!h.internals.handleBounds||d.force))){const g=d.nodeElement.getBoundingClientRect(),v=Xl(h.extent)?h.extent:s;let{positionAbsolute:y}=h.internals;h.parentId&&h.extent==="parent"?y=Da(y,_,e.get(h.parentId)):v&&(y=Il(y,v,_)),h.measured=_,h.internals={...h.internals,positionAbsolute:y,handleBounds:{source:Zr("source",d.nodeElement,g,u,h.id),target:Zr("target",d.nodeElement,g,u,h.id)}},h.parentId&&La(h,e,t,{nodeOrigin:o}),r=!0,b&&(a.push({id:h.id,type:"dimensions",dimensions:_}),h.expandParent&&h.parentId&&f.push({id:h.id,parentId:h.parentId,rect:Sl(h,o)}))}}}if(f.length>0){const d=lm(f,e,t,o);a.push(...d)}return{changes:a,updatedInternals:r}}async function sm({delta:l,panZoom:e,transform:t,translateExtent:n,width:o,height:s}){if(!e||!l.x&&!l.y)return Promise.resolve(!1);const i=await e.setViewportConstrained({x:t[0]+l.x,y:t[1]+l.y,zoom:t[2]},[[0,0],[o,s]],n),r=!!i&&(i.x!==t[0]||i.y!==t[1]||i.k!==t[2]);return Promise.resolve(r)}function Ra(l,e,t){l.clear(),e.clear();for(const n of t){const{source:o,target:s,sourceHandle:i=null,targetHandle:r=null}=n,a=`${o}-source-${i}`,c=`${s}-target-${r}`,u=l.get(a)||new Map,f=l.get(c)||new Map,d={edgeId:n.id,source:o,target:s,sourceHandle:i,targetHandle:r};e.set(n.id,n),l.set(a,u.set(`${s}-${r}`,d)),l.set(c,f.set(`${o}-${i}`,d))}}function Ua(l,e){if(!l.parentId)return!1;const t=e.get(l.parentId);return t?t.selected?!0:Ua(t,e):!1}function ti(l,e,t){let n=l;do{if(n!=null&&n.matches(e))return!0;if(n===t)return!1;n=n.parentElement}while(n);return!1}function rm(l,e,t,n){const o=new Map;for(const[s,i]of l)if((i.selected||i.id===n)&&(!i.parentId||!Ua(i,l))&&(i.draggable||e&&typeof i.draggable>"u")){const r=l.get(s);r&&o.set(s,{id:s,position:r.position||{x:0,y:0},distance:{x:t.x-r.internals.positionAbsolute.x,y:t.y-r.internals.positionAbsolute.y},extent:r.extent,parentId:r.parentId,origin:r.origin,expandParent:r.expandParent,internals:{positionAbsolute:r.internals.positionAbsolute||{x:0,y:0}},measured:{width:r.measured.width??0,height:r.measured.height??0}})}return o}function Go({nodeId:l,dragItems:e,nodeLookup:t,dragging:n=!0}){var i,r;const o=[];for(const[a,c]of e){const u=(i=t.get(a))==null?void 0:i.internals.userNode;u&&o.push({...u,position:c.position,dragging:n})}if(!l)return[o[0],o];const s=t.get(l).internals.userNode;return[{...s,position:((r=e.get(l))==null?void 0:r.position)||s.position,dragging:n},o]}function im({onNodeMouseDown:l,getStoreItems:e,onDragStart:t,onDrag:n,onDragStop:o}){let s={x:null,y:null},i=0,r=new Map,a=!1,c={x:0,y:0},u=null,f=!1,d=null,h=!1;function _({noDragClassName:w,handleSelector:g,domNode:v,isSelectable:y,nodeId:E,nodeClickDistance:z=0}){d=Tn(v);function D({x:L,y:W},K){const{nodeLookup:R,nodeExtent:I,snapGrid:P,snapToGrid:N,nodeOrigin:Y,onNodeDrag:Z,onSelectionDrag:F,onError:X,updateNodePositions:se}=e();s={x:L,y:W};let q=!1,G={x:0,y:0,x2:0,y2:0};if(r.size>1&&I){const oe=Po(r);G=os(oe)}for(const[oe,ae]of r){let ve={x:L-ae.distance.x,y:W-ae.distance.y};N&&(ve=fs(ve,P));let $=[[I[0][0],I[0][1]],[I[1][0],I[1][1]]];if(r.size>1&&I&&!ae.extent){const{positionAbsolute:ce}=ae.internals,Ze=ce.x-G.x+I[0][0],Qe=ce.x+ae.measured.width-G.x2+I[1][0],ge=ce.y-G.y+I[0][1],ie=ce.y+ae.measured.height-G.y2+I[1][1];$=[[Ze,ge],[Qe,ie]]}const{position:Ie,positionAbsolute:Ne}=Ah({nodeId:oe,nextPosition:ve,nodeLookup:R,nodeExtent:$,nodeOrigin:Y,onError:X});q=q||ae.position.x!==Ie.x||ae.position.y!==Ie.y,ae.position=Ie,ae.internals.positionAbsolute=Ne}if(q&&(se(r,!0),K&&(n||Z||!E&&F))){const[oe,ae]=Go({nodeId:E,dragItems:r,nodeLookup:R});n==null||n(K,r,oe,ae),Z==null||Z(K,oe,ae),E||F==null||F(K,ae)}}async function M(){if(!u)return;const{transform:L,panBy:W,autoPanSpeed:K}=e(),[R,I]=Ca(c,u,K);(R!==0||I!==0)&&(s.x=(s.x??0)-R/L[2],s.y=(s.y??0)-I/L[2],await W({x:R,y:I})&&D(s,null)),i=requestAnimationFrame(M)}function A(L){var q;const{nodeLookup:W,multiSelectionActive:K,nodesDraggable:R,transform:I,snapGrid:P,snapToGrid:N,selectNodesOnDrag:Y,onNodeDragStart:Z,onSelectionDragStart:F,unselectNodesAndEdges:X}=e();f=!0,(!Y||!y)&&!K&&E&&((q=W.get(E))!=null&&q.selected||X()),y&&Y&&E&&(l==null||l(E));const se=Ko(L.sourceEvent,{transform:I,snapGrid:P,snapToGrid:N});if(s=se,r=rm(W,R,se,E),r.size>0&&(t||Z||!E&&F)){const[G,oe]=Go({nodeId:E,dragItems:r,nodeLookup:W});t==null||t(L.sourceEvent,r,G,oe),Z==null||Z(L.sourceEvent,G,oe),E||F==null||F(L.sourceEvent,oe)}}const O=ju().clickDistance(z).on("start",L=>{const{domNode:W,nodeDragThreshold:K,transform:R,snapGrid:I,snapToGrid:P}=e();h=!1,K===0&&A(L),s=Ko(L.sourceEvent,{transform:R,snapGrid:I,snapToGrid:P}),u=(W==null?void 0:W.getBoundingClientRect())||null,c=Wn(L.sourceEvent,u)}).on("drag",L=>{const{autoPanOnNodeDrag:W,transform:K,snapGrid:R,snapToGrid:I,nodeDragThreshold:P}=e(),N=Ko(L.sourceEvent,{transform:K,snapGrid:R,snapToGrid:I});if(L.sourceEvent.type==="touchmove"&&L.sourceEvent.touches.length>1&&(h=!0),!h){if(!a&&W&&f&&(a=!0,M()),!f){const Y=N.xSnapped-(s.x??0),Z=N.ySnapped-(s.y??0);Math.sqrt(Y*Y+Z*Z)>P&&A(L)}(s.x!==N.xSnapped||s.y!==N.ySnapped)&&r&&f&&(c=Wn(L.sourceEvent,u),D(N,L.sourceEvent))}}).on("end",L=>{if(!(!f||h)&&(a=!1,f=!1,cancelAnimationFrame(i),r.size>0)){const{nodeLookup:W,updateNodePositions:K,onNodeDragStop:R,onSelectionDragStop:I}=e();if(K(r,!1),o||R||!E&&I){const[P,N]=Go({nodeId:E,dragItems:r,nodeLookup:W,dragging:!1});o==null||o(L.sourceEvent,r,P,N),R==null||R(L.sourceEvent,P,N),E||I==null||I(L.sourceEvent,N)}}}).filter(L=>{const W=L.target;return!L.button&&(!w||!ti(W,`.${w}`,v))&&(!g||ti(W,g,v))});d.call(O)}function b(){d==null||d.on(".drag",null)}return{update:_,destroy:b}}function am(l,e,t){const n=[],o={x:l.x-t,y:l.y-t,width:t*2,height:t*2};for(const s of e.values())Gl(o,Sl(s))>0&&n.push(s);return n}const cm=250;function um(l,e,t,n){var r,a;let o=[],s=1/0;const i=am(l,t,e+cm);for(const c of i){const u=[...((r=c.internals.handleBounds)==null?void 0:r.source)??[],...((a=c.internals.handleBounds)==null?void 0:a.target)??[]];for(const f of u){if(n.nodeId===f.nodeId&&n.type===f.type&&n.id===f.id)continue;const{x:d,y:h}=Zl(c,f,f.position,!0),_=Math.sqrt(Math.pow(d-l.x,2)+Math.pow(h-l.y,2));_>e||(_<s?(o=[{...f,x:d,y:h}],s=_):_===s&&o.push({...f,x:d,y:h}))}}if(!o.length)return null;if(o.length>1){const c=n.type==="source"?"target":"source";return o.find(u=>u.type===c)??o[0]}return o[0]}function Fa(l,e,t,n,o,s=!1){var c,u,f;const i=n.get(l);if(!i)return null;const r=o==="strict"?(c=i.internals.handleBounds)==null?void 0:c[e]:[...((u=i.internals.handleBounds)==null?void 0:u.source)??[],...((f=i.internals.handleBounds)==null?void 0:f.target)??[]],a=(t?r==null?void 0:r.find(d=>d.id===t):r==null?void 0:r[0])??null;return a&&s?{...a,...Zl(i,a,a.position,!0)}:a}function Wa(l,e){return l||(e!=null&&e.classList.contains("target")?"target":e!=null&&e.classList.contains("source")?"source":null)}function fm(l,e){let t=null;return e?t=!0:l&&!e&&(t=!1),t}const ja=()=>!0;function dm(l,{connectionMode:e,connectionRadius:t,handleId:n,nodeId:o,edgeUpdaterType:s,isTarget:i,domNode:r,nodeLookup:a,lib:c,autoPanOnConnect:u,flowId:f,panBy:d,cancelConnection:h,onConnectStart:_,onConnect:b,onConnectEnd:w,isValidConnection:g=ja,onReconnectEnd:v,updateConnection:y,getTransform:E,getFromHandle:z,autoPanSpeed:D}){const M=Uh(l.target);let A=0,O;const{x:L,y:W}=Wn(l),K=M==null?void 0:M.elementFromPoint(L,W),R=Wa(s,K),I=r==null?void 0:r.getBoundingClientRect();if(!I||!R)return;const P=Fa(o,R,n,a,e);if(!P)return;let N=Wn(l,I),Y=!1,Z=null,F=!1,X=null;function se(){if(!u||!I)return;const[Ne,ce]=Ca(N,I,D);d({x:Ne,y:ce}),A=requestAnimationFrame(se)}const q={...P,nodeId:o,type:R,position:P.position},G=a.get(o),ae={inProgress:!0,isValid:null,from:Zl(G,q,ot.Left,!0),fromHandle:q,fromPosition:q.position,fromNode:G,to:N,toHandle:null,toPosition:Ur[q.position],toNode:null};y(ae);let ve=ae;_==null||_(l,{nodeId:o,handleId:n,handleType:R});function $(Ne){if(!z()||!q){Ie(Ne);return}const ce=E();N=Wn(Ne,I),O=um(Ql(N,ce,!1,[1,1]),t,a,q),Y||(se(),Y=!0);const Ze=Ya(Ne,{handle:O,connectionMode:e,fromNodeId:o,fromHandleId:n,fromType:i?"target":"source",isValidConnection:g,doc:M,lib:c,flowId:f,nodeLookup:a});X=Ze.handleDomNode,Z=Ze.connection,F=fm(!!O,Ze.isValid);const Qe={...ve,isValid:F,to:O&&F?Ma({x:O.x,y:O.y},ce):N,toHandle:Ze.toHandle,toPosition:F&&Ze.toHandle?Ze.toHandle.position:Ur[q.position],toNode:Ze.toHandle?a.get(Ze.toHandle.nodeId):null};F&&O&&ve.toHandle&&Qe.toHandle&&ve.toHandle.type===Qe.toHandle.type&&ve.toHandle.nodeId===Qe.toHandle.nodeId&&ve.toHandle.id===Qe.toHandle.id&&ve.to.x===Qe.to.x&&ve.to.y===Qe.to.y||(y(Qe),ve=Qe)}function Ie(Ne){(O||X)&&Z&&F&&(b==null||b(Z));const{inProgress:ce,...Ze}=ve,Qe={...Ze,toPosition:ve.toHandle?ve.toPosition:null};w==null||w(Ne,Qe),s&&(v==null||v(Ne,Qe)),h(),cancelAnimationFrame(A),Y=!1,F=!1,Z=null,X=null,M.removeEventListener("mousemove",$),M.removeEventListener("mouseup",Ie),M.removeEventListener("touchmove",$),M.removeEventListener("touchend",Ie)}M.addEventListener("mousemove",$),M.addEventListener("mouseup",Ie),M.addEventListener("touchmove",$),M.addEventListener("touchend",Ie)}function Ya(l,{handle:e,connectionMode:t,fromNodeId:n,fromHandleId:o,fromType:s,doc:i,lib:r,flowId:a,isValidConnection:c=ja,nodeLookup:u}){const f=s==="target",d=e?i.querySelector(`.${r}-flow__handle[data-id="${a}-${e==null?void 0:e.nodeId}-${e==null?void 0:e.id}-${e==null?void 0:e.type}"]`):null,{x:h,y:_}=Wn(l),b=i.elementFromPoint(h,_),w=b!=null&&b.classList.contains(`${r}-flow__handle`)?b:d,g={handleDomNode:w,isValid:!1,connection:null,toHandle:null};if(w){const v=Wa(void 0,w),y=w.getAttribute("data-nodeid"),E=w.getAttribute("data-handleid"),z=w.classList.contains("connectable"),D=w.classList.contains("connectableend");if(!y||!v)return g;const M={source:f?y:n,sourceHandle:f?E:o,target:f?n:y,targetHandle:f?o:E};g.connection=M;const O=z&&D&&(t===dl.Strict?f&&v==="source"||!f&&v==="target":y!==n||E!==o);g.isValid=O&&c(M),g.toHandle=Fa(y,v,E,u,t,!1)}return g}const hm={onPointerDown:dm,isValid:Ya},mm=(l,e)=>l.x!==e.x||l.y!==e.y||l.zoom!==e.k,Ao=l=>({x:l.x,y:l.y,zoom:l.k}),Xo=({x:l,y:e,zoom:t})=>cs.translate(l,e).scale(t),_l=(l,e)=>l.target.closest(`.${e}`),Ka=(l,e)=>e===2&&Array.isArray(l)&&l.includes(2),Zo=(l,e=0,t=()=>{})=>{const n=typeof e=="number"&&e>0;return n||t(),n?l.transition().duration(e).on("end",t):l},Ga=l=>{const e=l.ctrlKey&&wo()?10:1;return-l.deltaY*(l.deltaMode===1?.05:l.deltaMode?1:.002)*e};function gm({zoomPanValues:l,noWheelClassName:e,d3Selection:t,d3Zoom:n,panOnScrollMode:o,panOnScrollSpeed:s,zoomOnPinch:i,onPanZoomStart:r,onPanZoom:a,onPanZoomEnd:c}){return u=>{if(_l(u,e))return!1;u.preventDefault(),u.stopImmediatePropagation();const f=t.property("__zoom").k||1;if(u.ctrlKey&&i){const w=An(u),g=Ga(u),v=f*Math.pow(2,g);n.scaleTo(t,v,w,u);return}const d=u.deltaMode===1?20:1;let h=o===Bn.Vertical?0:u.deltaX*d,_=o===Bn.Horizontal?0:u.deltaY*d;!wo()&&u.shiftKey&&o!==Bn.Vertical&&(h=u.deltaY*d,_=0),n.translateBy(t,-(h/f)*s,-(_/f)*s,{internal:!0});const b=Ao(t.property("__zoom"));clearTimeout(l.panScrollTimeout),l.isPanScrolling||(l.isPanScrolling=!0,r==null||r(u,b)),l.isPanScrolling&&(a==null||a(u,b),l.panScrollTimeout=setTimeout(()=>{c==null||c(u,b),l.isPanScrolling=!1},150))}}function pm({noWheelClassName:l,preventScrolling:e,d3ZoomHandler:t}){return function(n,o){if(!e&&n.type==="wheel"&&!n.ctrlKey||_l(n,l))return null;n.preventDefault(),t.call(this,n,o)}}function _m({zoomPanValues:l,onDraggingChange:e,onPanZoomStart:t}){return n=>{var s,i,r;if((s=n.sourceEvent)!=null&&s.internal)return;const o=Ao(n.transform);l.mouseButton=((i=n.sourceEvent)==null?void 0:i.button)||0,l.isZoomingOrPanning=!0,l.prevViewport=o,((r=n.sourceEvent)==null?void 0:r.type)==="mousedown"&&e(!0),t&&(t==null||t(n.sourceEvent,o))}}function bm({zoomPanValues:l,panOnDrag:e,onPaneContextMenu:t,onTransformChange:n,onPanZoom:o}){return s=>{var i,r;l.usedRightMouseButton=!!(t&&Ka(e,l.mouseButton??0)),(i=s.sourceEvent)!=null&&i.sync||n([s.transform.x,s.transform.y,s.transform.k]),o&&!((r=s.sourceEvent)!=null&&r.internal)&&(o==null||o(s.sourceEvent,Ao(s.transform)))}}function vm({zoomPanValues:l,panOnDrag:e,panOnScroll:t,onDraggingChange:n,onPanZoomEnd:o,onPaneContextMenu:s}){return i=>{var r;if(!((r=i.sourceEvent)!=null&&r.internal)&&(l.isZoomingOrPanning=!1,s&&Ka(e,l.mouseButton??0)&&!l.usedRightMouseButton&&i.sourceEvent&&s(i.sourceEvent),l.usedRightMouseButton=!1,n(!1),o&&mm(l.prevViewport,i.transform))){const a=Ao(i.transform);l.prevViewport=a,clearTimeout(l.timerId),l.timerId=setTimeout(()=>{o==null||o(i.sourceEvent,a)},t?150:0)}}}function wm({zoomActivationKeyPressed:l,zoomOnScroll:e,zoomOnPinch:t,panOnDrag:n,panOnScroll:o,zoomOnDoubleClick:s,userSelectionActive:i,noWheelClassName:r,noPanClassName:a,lib:c}){return u=>{var _;const f=l||e,d=t&&u.ctrlKey;if(u.button===1&&u.type==="mousedown"&&(_l(u,`${c}-flow__node`)||_l(u,`${c}-flow__edge`)))return!0;if(!n&&!f&&!o&&!s&&!t||i||_l(u,r)&&u.type==="wheel"||_l(u,a)&&(u.type!=="wheel"||o&&u.type==="wheel"&&!l)||!t&&u.ctrlKey&&u.type==="wheel")return!1;if(!t&&u.type==="touchstart"&&((_=u.touches)==null?void 0:_.length)>1)return u.preventDefault(),!1;if(!f&&!o&&!d&&u.type==="wheel"||!n&&(u.type==="mousedown"||u.type==="touchstart")||Array.isArray(n)&&!n.includes(u.button)&&u.type==="mousedown")return!1;const h=Array.isArray(n)&&n.includes(u.button)||!u.button||u.button<=1;return(!u.ctrlKey||u.type==="wheel")&&h}}function ym({domNode:l,minZoom:e,maxZoom:t,paneClickDistance:n,translateExtent:o,viewport:s,onPanZoom:i,onPanZoomStart:r,onPanZoomEnd:a,onDraggingChange:c}){const u={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{x:0,y:0,zoom:0},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},f=l.getBoundingClientRect(),d=ef().clickDistance(!Vn(n)||n<0?0:n).scaleExtent([e,t]).translateExtent(o),h=Tn(l).call(d);y({x:s.x,y:s.y,zoom:El(s.zoom,e,t)},[[0,0],[f.width,f.height]],o);const _=h.on("wheel.zoom"),b=h.on("dblclick.zoom");d.wheelDelta(Ga);function w(K,R){return h?new Promise(I=>{d==null||d.transform(Zo(h,R==null?void 0:R.duration,()=>I(!0)),K)}):Promise.resolve(!1)}function g({noWheelClassName:K,noPanClassName:R,onPaneContextMenu:I,userSelectionActive:P,panOnScroll:N,panOnDrag:Y,panOnScrollMode:Z,panOnScrollSpeed:F,preventScrolling:X,zoomOnPinch:se,zoomOnScroll:q,zoomOnDoubleClick:G,zoomActivationKeyPressed:oe,lib:ae,onTransformChange:ve}){P&&!u.isZoomingOrPanning&&v();const Ie=N&&!oe&&!P?gm({zoomPanValues:u,noWheelClassName:K,d3Selection:h,d3Zoom:d,panOnScrollMode:Z,panOnScrollSpeed:F,zoomOnPinch:se,onPanZoomStart:r,onPanZoom:i,onPanZoomEnd:a}):pm({noWheelClassName:K,preventScrolling:X,d3ZoomHandler:_});if(h.on("wheel.zoom",Ie,{passive:!1}),!P){const ce=_m({zoomPanValues:u,onDraggingChange:c,onPanZoomStart:r});d.on("start",ce);const Ze=bm({zoomPanValues:u,panOnDrag:Y,onPaneContextMenu:!!I,onPanZoom:i,onTransformChange:ve});d.on("zoom",Ze);const Qe=vm({zoomPanValues:u,panOnDrag:Y,panOnScroll:N,onPaneContextMenu:I,onPanZoomEnd:a,onDraggingChange:c});d.on("end",Qe)}const Ne=wm({zoomActivationKeyPressed:oe,panOnDrag:Y,zoomOnScroll:q,panOnScroll:N,zoomOnDoubleClick:G,zoomOnPinch:se,userSelectionActive:P,noPanClassName:R,noWheelClassName:K,lib:ae});d.filter(Ne),G?h.on("dblclick.zoom",b):h.on("dblclick.zoom",null)}function v(){d.on("zoom",null)}async function y(K,R,I){const P=Xo(K),N=d==null?void 0:d.constrain()(P,R,I);return N&&await w(N),new Promise(Y=>Y(N))}async function E(K,R){const I=Xo(K);return await w(I,R),new Promise(P=>P(I))}function z(K){if(h){const R=Xo(K),I=h.property("__zoom");(I.k!==K.zoom||I.x!==K.x||I.y!==K.y)&&(d==null||d.transform(h,R,null,{sync:!0}))}}function D(){const K=h?iu(h.node()):{x:0,y:0,k:1};return{x:K.x,y:K.y,zoom:K.k}}function M(K,R){return h?new Promise(I=>{d==null||d.scaleTo(Zo(h,R==null?void 0:R.duration,()=>I(!0)),K)}):Promise.resolve(!1)}function A(K,R){return h?new Promise(I=>{d==null||d.scaleBy(Zo(h,R==null?void 0:R.duration,()=>I(!0)),K)}):Promise.resolve(!1)}function O(K){d==null||d.scaleExtent(K)}function L(K){d==null||d.translateExtent(K)}function W(K){const R=!Vn(K)||K<0?0:K;d==null||d.clickDistance(R)}return{update:g,destroy:v,setViewport:E,setViewportConstrained:y,getViewport:D,scaleTo:M,scaleBy:A,setScaleExtent:O,setTranslateExtent:L,syncViewport:z,setClickDistance:W}}var ni;(function(l){l.Line="line",l.Handle="handle"})(ni||(ni={}));function km(l){let e,t,n,o,s,i;const r=l[45].default,a=Qt(r,l,l[44],null);return{c(){e=T("div"),a&&a.c(),this.h()},l(c){e=V(c,"DIV",{"data-handleid":!0,"data-nodeid":!0,"data-handlepos":!0,"data-id":!0,class:!0,style:!0,role:!0,tabindex:!0});var u=S(e);a&&a.l(u),u.forEach(p),this.h()},h(){m(e,"data-handleid",l[6]),m(e,"data-nodeid",l[14]),m(e,"data-handlepos",l[2]),m(e,"data-id",t=l[13]+"-"+l[14]+"-"+(l[0]||null)+"-"+l[1]),m(e,"class",n=Nt(["svelte-flow__handle",`svelte-flow__handle-${l[2]}`,"nodrag","nopan",l[2],l[4]])),m(e,"style",l[3]),m(e,"role","button"),m(e,"tabindex","-1"),lt(e,"valid",l[7]),lt(e,"connectingto",l[5]),lt(e,"connectingfrom",l[9]),lt(e,"source",!l[11]),lt(e,"target",l[11]),lt(e,"connectablestart",l[12]),lt(e,"connectableend",l[12]),lt(e,"connectable",l[12]),lt(e,"connectionindicator",l[12]&&(!l[10]||l[8]))},m(c,u){B(c,e,u),a&&a.m(e,null),o=!0,s||(i=[Se(e,"mousedown",l[32]),Se(e,"touchstart",l[32])],s=!0)},p(c,u){a&&a.p&&(!o||u[1]&8192)&&xt(a,r,c,c[44],o?en(r,c[44],u,null):$t(c[44]),null),(!o||u[0]&64)&&m(e,"data-handleid",c[6]),(!o||u[0]&4)&&m(e,"data-handlepos",c[2]),(!o||u[0]&8195&&t!==(t=c[13]+"-"+c[14]+"-"+(c[0]||null)+"-"+c[1]))&&m(e,"data-id",t),(!o||u[0]&20&&n!==(n=Nt(["svelte-flow__handle",`svelte-flow__handle-${c[2]}`,"nodrag","nopan",c[2],c[4]])))&&m(e,"class",n),(!o||u[0]&8)&&m(e,"style",c[3]),(!o||u[0]&148)&&lt(e,"valid",c[7]),(!o||u[0]&52)&&lt(e,"connectingto",c[5]),(!o||u[0]&532)&&lt(e,"connectingfrom",c[9]),(!o||u[0]&2068)&&lt(e,"source",!c[11]),(!o||u[0]&2068)&&lt(e,"target",c[11]),(!o||u[0]&4116)&&lt(e,"connectablestart",c[12]),(!o||u[0]&4116)&&lt(e,"connectableend",c[12]),(!o||u[0]&4116)&&lt(e,"connectable",c[12]),(!o||u[0]&5396)&&lt(e,"connectionindicator",c[12]&&(!c[10]||c[8]))},i(c){o||(C(a,c),o=!0)},o(c){H(a,c),o=!1},d(c){c&&p(e),a&&a.d(c),s=!1,sn(i)}}}function Em(l,e,t){let n,o,s,i,r,a,c,u,f,d,h,_,b,w,g,v,y,E,z,D,M,A,O,L,W,{$$slots:K={},$$scope:R}=e,{id:I=void 0}=e,{type:P="source"}=e,{position:N=ot.Top}=e,{style:Y=void 0}=e,{isValidConnection:Z=void 0}=e,{onconnect:F=void 0}=e,{ondisconnect:X=void 0}=e,{isConnectable:se=void 0}=e,{class:q=void 0}=e;const G=Ot("svelteflow__node_id"),oe=Ot("svelteflow__node_connectable");re(l,oe,Pe=>t(43,W=Pe));const ae=Wt(),{connectionMode:ve,domNode:$,nodeLookup:Ie,connectionRadius:Ne,viewport:ce,isValidConnection:Ze,lib:Qe,addEdge:ge,onedgecreate:ie,panBy:Ue,cancelConnection:et,updateConnection:at,autoPanOnConnect:_t,edges:nt,connectionLookup:mt,onconnect:jt,onconnectstart:Ht,onconnectend:gt,flowId:At,connection:me}=ae;re(l,ve,Pe=>t(40,d=Pe)),re(l,$,Pe=>t(55,O=Pe)),re(l,Ie,Pe=>t(54,A=Pe)),re(l,Ne,Pe=>t(56,L=Pe)),re(l,ce,Pe=>t(46,b=Pe)),re(l,Ze,Pe=>t(51,E=Pe)),re(l,Qe,Pe=>t(53,M=Pe)),re(l,ie,Pe=>t(50,y=Pe)),re(l,_t,Pe=>t(52,D=Pe)),re(l,nt,Pe=>t(42,_=Pe)),re(l,mt,Pe=>t(41,h=Pe)),re(l,jt,Pe=>t(49,v=Pe)),re(l,Ht,Pe=>t(48,g=Pe)),re(l,gt,Pe=>t(47,w=Pe)),re(l,At,Pe=>t(13,z=Pe)),re(l,me,Pe=>t(39,f=Pe));function Lt(Pe){const qt=Va(Pe);(qt&&Pe.button===0||!qt)&&hm.onPointerDown(Pe,{handleId:s,nodeId:G,isTarget:n,connectionRadius:L,domNode:O,nodeLookup:A,connectionMode:d,lib:M,autoPanOnConnect:D,flowId:z,isValidConnection:Z??E,updateConnection:at,cancelConnection:et,panBy:Ue,onConnect:It=>{const fe=y?y(It):It;fe&&(ge(fe),v==null||v(It))},onConnectStart:(It,fe)=>{g==null||g(It,{nodeId:fe.nodeId,handleId:fe.handleId,handleType:fe.handleType})},onConnectEnd:(It,fe)=>{w==null||w(It,fe)},getTransform:()=>[b.x,b.y,b.zoom],getFromHandle:()=>f.fromHandle})}let Et=null,Ct;return l.$$set=Pe=>{"id"in Pe&&t(0,I=Pe.id),"type"in Pe&&t(1,P=Pe.type),"position"in Pe&&t(2,N=Pe.position),"style"in Pe&&t(3,Y=Pe.style),"isValidConnection"in Pe&&t(33,Z=Pe.isValidConnection),"onconnect"in Pe&&t(34,F=Pe.onconnect),"ondisconnect"in Pe&&t(35,X=Pe.ondisconnect),"isConnectable"in Pe&&t(36,se=Pe.isConnectable),"class"in Pe&&t(4,q=Pe.class),"$$scope"in Pe&&t(44,R=Pe.$$scope)},l.$$.update=()=>{var Pe,qt,It,fe,We,Be,Je,wt,bt;if(l.$$.dirty[0]&2&&t(11,n=P==="target"),l.$$.dirty[1]&4128&&t(12,o=se!==void 0?se:W),l.$$.dirty[0]&1&&t(6,s=I||null),l.$$.dirty[0]&3|l.$$.dirty[1]&3096&&(F||X)&&t(38,Ct=h.get(`${G}-${P}-${I||null}`)),l.$$.dirty[1]&216){if(Et&&!Nh(Ct,Et)){const Mt=Ct??new Map;Fr(Et,Mt,X),Fr(Mt,Et,F)}t(37,Et=Ct??new Map)}l.$$.dirty[1]&256&&t(10,i=!!f.fromHandle),l.$$.dirty[0]&66|l.$$.dirty[1]&256&&t(9,r=((Pe=f.fromHandle)==null?void 0:Pe.nodeId)===G&&((qt=f.fromHandle)==null?void 0:qt.type)===P&&((It=f.fromHandle)==null?void 0:It.id)===s),l.$$.dirty[0]&66|l.$$.dirty[1]&256&&t(5,a=((fe=f.toHandle)==null?void 0:fe.nodeId)===G&&((We=f.toHandle)==null?void 0:We.type)===P&&((Be=f.toHandle)==null?void 0:Be.id)===s),l.$$.dirty[0]&66|l.$$.dirty[1]&768&&t(8,c=d===dl.Strict?((Je=f.fromHandle)==null?void 0:Je.type)!==P:G!==((wt=f.fromHandle)==null?void 0:wt.nodeId)||s!==((bt=f.fromHandle)==null?void 0:bt.id)),l.$$.dirty[0]&32|l.$$.dirty[1]&256&&t(7,u=a&&f.isValid)},[I,P,N,Y,q,a,s,u,c,r,i,n,o,z,G,oe,ve,$,Ie,Ne,ce,Ze,Qe,ie,_t,nt,mt,jt,Ht,gt,At,me,Lt,Z,F,X,se,Et,Ct,f,d,h,_,W,R,K]}class Dl extends Oe{constructor(e){super(),He(this,e,Em,km,Le,{id:0,type:1,position:2,style:3,isValidConnection:33,onconnect:34,ondisconnect:35,isConnectable:36,class:4},null,[-1,-1])}}function Im(l){var a;let e,t,n=((a=l[0])==null?void 0:a.label)+"",o,s,i,r;return e=new Dl({props:{type:"target",position:l[1]??ot.Top}}),i=new Dl({props:{type:"source",position:l[2]??ot.Bottom}}),{c(){ee(e.$$.fragment),t=Q(),o=ke(n),s=Q(),ee(i.$$.fragment)},l(c){le(e.$$.fragment,c),t=x(c),o=Ee(c,n),s=x(c),le(i.$$.fragment,c)},m(c,u){te(e,c,u),B(c,t,u),B(c,o,u),B(c,s,u),te(i,c,u),r=!0},p(c,[u]){var h;const f={};u&2&&(f.position=c[1]??ot.Top),e.$set(f),(!r||u&1)&&n!==(n=((h=c[0])==null?void 0:h.label)+"")&&Ce(o,n);const d={};u&4&&(d.position=c[2]??ot.Bottom),i.$set(d)},i(c){r||(C(e.$$.fragment,c),C(i.$$.fragment,c),r=!0)},o(c){H(e.$$.fragment,c),H(i.$$.fragment,c),r=!1},d(c){c&&(p(t),p(o),p(s)),ne(e,c),ne(i,c)}}}function Sm(l,e,t){const n=["data","targetPosition","sourcePosition"];Ut(e,n);let{data:o={label:"Node"}}=e,{targetPosition:s=void 0}=e,{sourcePosition:i=void 0}=e;return l.$$set=r=>{e=vt(vt({},e),zn(r)),t(3,Ut(e,n)),"data"in r&&t(0,o=r.data),"targetPosition"in r&&t(1,s=r.targetPosition),"sourcePosition"in r&&t(2,i=r.sourcePosition)},[o,s,i]}class Xa extends Oe{constructor(e){super(),He(this,e,Sm,Im,Le,{data:0,targetPosition:1,sourcePosition:2})}}function Dm(l){var i;let e=((i=l[0])==null?void 0:i.label)+"",t,n,o,s;return o=new Dl({props:{type:"source",position:l[1]??ot.Bottom}}),{c(){t=ke(e),n=Q(),ee(o.$$.fragment)},l(r){t=Ee(r,e),n=x(r),le(o.$$.fragment,r)},m(r,a){B(r,t,a),B(r,n,a),te(o,r,a),s=!0},p(r,[a]){var u;(!s||a&1)&&e!==(e=((u=r[0])==null?void 0:u.label)+"")&&Ce(t,e);const c={};a&2&&(c.position=r[1]??ot.Bottom),o.$set(c)},i(r){s||(C(o.$$.fragment,r),s=!0)},o(r){H(o.$$.fragment,r),s=!1},d(r){r&&(p(t),p(n)),ne(o,r)}}}function Cm(l,e,t){const n=["data","sourcePosition"];Ut(e,n);let{data:o={label:"Node"}}=e,{sourcePosition:s=void 0}=e;return l.$$set=i=>{e=vt(vt({},e),zn(i)),t(2,Ut(e,n)),"data"in i&&t(0,o=i.data),"sourcePosition"in i&&t(1,s=i.sourcePosition)},[o,s]}class Mm extends Oe{constructor(e){super(),He(this,e,Cm,Dm,Le,{data:0,sourcePosition:1})}}function Tm(l){var i;let e=((i=l[0])==null?void 0:i.label)+"",t,n,o,s;return o=new Dl({props:{type:"target",position:l[1]??ot.Top}}),{c(){t=ke(e),n=Q(),ee(o.$$.fragment)},l(r){t=Ee(r,e),n=x(r),le(o.$$.fragment,r)},m(r,a){B(r,t,a),B(r,n,a),te(o,r,a),s=!0},p(r,[a]){var u;(!s||a&1)&&e!==(e=((u=r[0])==null?void 0:u.label)+"")&&Ce(t,e);const c={};a&2&&(c.position=r[1]??ot.Top),o.$set(c)},i(r){s||(C(o.$$.fragment,r),s=!0)},o(r){H(o.$$.fragment,r),s=!1},d(r){r&&(p(t),p(n)),ne(o,r)}}}function Vm(l,e,t){const n=["data","targetPosition"];Ut(e,n);let{data:o={label:"Node"}}=e,{targetPosition:s=void 0}=e;return l.$$set=i=>{e=vt(vt({},e),zn(i)),t(2,Ut(e,n)),"data"in i&&t(0,o=i.data),"targetPosition"in i&&t(1,s=i.targetPosition)},[o,s]}class zm extends Oe{constructor(e){super(),He(this,e,Vm,Tm,Le,{data:0,targetPosition:1})}}function Nm(l,e,t){const n=[];return Ut(e,n),l.$$set=o=>{e=vt(vt({},e),zn(o)),t(0,Ut(e,n))},[]}class Pm extends Oe{constructor(e){super(),He(this,e,Nm,null,Le,{})}}function li(l,e,t){if(!e)return;const n=t?e.querySelector(t):e;n&&n.appendChild(l)}function Om(l,{target:e,domNode:t}){return li(l,t,e),{async update({target:n,domNode:o}){li(l,o,n)},destroy(){l.parentNode&&l.parentNode.removeChild(l)}}}function Hm(l){let e,t,n,o,s;const i=l[3].default,r=Qt(i,l,l[2],null);return{c(){e=T("div"),r&&r.c()},l(a){e=V(a,"DIV",{});var c=S(e);r&&r.l(c),c.forEach(p)},m(a,c){B(a,e,c),r&&r.m(e,null),n=!0,o||(s=gn(t=Om.call(null,e,{target:".svelte-flow__edgelabel-renderer",domNode:l[0]})),o=!0)},p(a,[c]){r&&r.p&&(!n||c&4)&&xt(r,i,a,a[2],n?en(i,a[2],c,null):$t(a[2]),null),t&&ln(t.update)&&c&1&&t.update.call(null,{target:".svelte-flow__edgelabel-renderer",domNode:a[0]})},i(a){n||(C(r,a),n=!0)},o(a){H(r,a),n=!1},d(a){a&&p(e),r&&r.d(a),o=!1,s()}}}function Am(l,e,t){let n,{$$slots:o={},$$scope:s}=e;const{domNode:i}=Wt();return re(l,i,r=>t(0,n=r)),l.$$set=r=>{"$$scope"in r&&t(2,s=r.$$scope)},[n,i,s,o]}class Lm extends Oe{constructor(e){super(),He(this,e,Am,Hm,Le,{})}}function Za(){const{edgeLookup:l,selectionRect:e,selectionRectMode:t,multiselectionKeyPressed:n,addSelectedEdges:o,unselectNodesAndEdges:s,elementsSelectable:i}=Wt();return r=>{const a=de(l).get(r);if(!a){console.warn("012",Jl.error012(r));return}(a.selectable||de(i)&&typeof a.selectable>"u")&&(e.set(null),t.set(null),a.selected?a.selected&&de(n)&&s({nodes:[],edges:[a]}):o([r]))}}function Bm(l){let e,t,n=`translate(-50%, -50%) translate(${l[1]}px,${l[2]}px)`,o,s,i;const r=l[5].default,a=Qt(r,l,l[7],null);return{c(){e=T("div"),a&&a.c(),this.h()},l(c){e=V(c,"DIV",{class:!0,style:!0,role:!0,tabindex:!0});var u=S(e);a&&a.l(u),u.forEach(p),this.h()},h(){m(e,"class","svelte-flow__edge-label"),m(e,"style",t="pointer-events: all;"+l[0]),m(e,"role","button"),m(e,"tabindex","-1"),$e(e,"transform",n)},m(c,u){B(c,e,u),a&&a.m(e,null),o=!0,s||(i=[Se(e,"keyup",Um),Se(e,"click",l[6])],s=!0)},p(c,u){a&&a.p&&(!o||u&128)&&xt(a,r,c,c[7],o?en(r,c[7],u,null):$t(c[7]),null),(!o||u&1&&t!==(t="pointer-events: all;"+c[0]))&&m(e,"style",t);const f=u&1;(u&7&&n!==(n=`translate(-50%, -50%) translate(${c[1]}px,${c[2]}px)`)||f)&&$e(e,"transform",n)},i(c){o||(C(a,c),o=!0)},o(c){H(a,c),o=!1},d(c){c&&p(e),a&&a.d(c),s=!1,sn(i)}}}function Rm(l){let e,t;return e=new Lm({props:{$$slots:{default:[Bm]},$$scope:{ctx:l}}}),{c(){ee(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,o){te(e,n,o),t=!0},p(n,[o]){const s={};o&135&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}const Um=()=>{};function Fm(l,e,t){let{$$slots:n={},$$scope:o}=e,{style:s=void 0}=e,{x:i=void 0}=e,{y:r=void 0}=e;const a=Za(),c=Ot("svelteflow__edge_id"),u=()=>{c&&a(c)};return l.$$set=f=>{"style"in f&&t(0,s=f.style),"x"in f&&t(1,i=f.x),"y"in f&&t(2,r=f.y),"$$scope"in f&&t(7,o=f.$$scope)},[s,i,r,a,c,n,u,o]}class Wm extends Oe{constructor(e){super(),He(this,e,Fm,Rm,Le,{style:0,x:1,y:2})}}function jm(l){let e;return{c(){e=_e("path"),this.h()},l(t){e=be(t,"path",{d:!0,"stroke-opacity":!0,"stroke-width":!0,fill:!0,class:!0}),S(e).forEach(p),this.h()},h(){m(e,"d",l[1]),m(e,"stroke-opacity",0),m(e,"stroke-width",l[10]),m(e,"fill","none"),m(e,"class","svelte-flow__edge-interaction")},m(t,n){B(t,e,n)},p(t,n){n&2&&m(e,"d",t[1])},d(t){t&&p(e)}}}function oi(l){let e,t;return e=new Wm({props:{x:l[3],y:l[4],style:l[5],$$slots:{default:[Ym]},$$scope:{ctx:l}}}),{c(){ee(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,o){te(e,n,o),t=!0},p(n,o){const s={};o&8&&(s.x=n[3]),o&16&&(s.y=n[4]),o&32&&(s.style=n[5]),o&4100&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}function Ym(l){let e;return{c(){e=ke(l[2])},l(t){e=Ee(t,l[2])},m(t,n){B(t,e,n)},p(t,n){n&4&&Ce(e,t[2])},d(t){t&&p(e)}}}function Km(l){let e,t,n,o,s,i,r=l[10]&&jm(l),a=l[2]&&oi(l);return{c(){e=_e("path"),n=Q(),r&&r.c(),o=Q(),a&&a.c(),s=Te(),this.h()},l(c){e=be(c,"path",{id:!0,d:!0,class:!0,"marker-start":!0,"marker-end":!0,fill:!0,style:!0}),S(e).forEach(p),n=x(c),r&&r.l(c),o=x(c),a&&a.l(c),s=Te(),this.h()},h(){m(e,"id",l[0]),m(e,"d",l[1]),m(e,"class",t=Nt(["svelte-flow__edge-path",l[9]])),m(e,"marker-start",l[6]),m(e,"marker-end",l[7]),m(e,"fill","none"),m(e,"style",l[8])},m(c,u){B(c,e,u),B(c,n,u),r&&r.m(c,u),B(c,o,u),a&&a.m(c,u),B(c,s,u),i=!0},p(c,[u]){(!i||u&1)&&m(e,"id",c[0]),(!i||u&2)&&m(e,"d",c[1]),(!i||u&512&&t!==(t=Nt(["svelte-flow__edge-path",c[9]])))&&m(e,"class",t),(!i||u&64)&&m(e,"marker-start",c[6]),(!i||u&128)&&m(e,"marker-end",c[7]),(!i||u&256)&&m(e,"style",c[8]),c[10]&&r.p(c,u),c[2]?a?(a.p(c,u),u&4&&C(a,1)):(a=oi(c),a.c(),C(a,1),a.m(s.parentNode,s)):a&&(Ve(),H(a,1,1,()=>{a=null}),ze())},i(c){i||(C(a),i=!0)},o(c){H(a),i=!1},d(c){c&&(p(e),p(n),p(o),p(s)),r&&r.d(c),a&&a.d(c)}}}function Gm(l,e,t){let{id:n=void 0}=e,{path:o}=e,{label:s=void 0}=e,{labelX:i=void 0}=e,{labelY:r=void 0}=e,{labelStyle:a=void 0}=e,{markerStart:c=void 0}=e,{markerEnd:u=void 0}=e,{style:f=void 0}=e,{interactionWidth:d=20}=e,{class:h=void 0}=e,_=d===void 0?20:d;return l.$$set=b=>{"id"in b&&t(0,n=b.id),"path"in b&&t(1,o=b.path),"label"in b&&t(2,s=b.label),"labelX"in b&&t(3,i=b.labelX),"labelY"in b&&t(4,r=b.labelY),"labelStyle"in b&&t(5,a=b.labelStyle),"markerStart"in b&&t(6,c=b.markerStart),"markerEnd"in b&&t(7,u=b.markerEnd),"style"in b&&t(8,f=b.style),"interactionWidth"in b&&t(11,d=b.interactionWidth),"class"in b&&t(9,h=b.class)},[n,o,s,i,r,a,c,u,f,h,_,d]}class Lo extends Oe{constructor(e){super(),He(this,e,Gm,Km,Le,{id:0,path:1,label:2,labelX:3,labelY:4,labelStyle:5,markerStart:6,markerEnd:7,style:8,interactionWidth:11,class:9})}}function Xm(l){let e,t;return e=new Lo({props:{path:l[8],labelX:l[7],labelY:l[6],label:l[0],labelStyle:l[1],markerStart:l[3],markerEnd:l[4],interactionWidth:l[5],style:l[2]}}),{c(){ee(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,o){te(e,n,o),t=!0},p(n,[o]){const s={};o&256&&(s.path=n[8]),o&128&&(s.labelX=n[7]),o&64&&(s.labelY=n[6]),o&1&&(s.label=n[0]),o&2&&(s.labelStyle=n[1]),o&8&&(s.markerStart=n[3]),o&16&&(s.markerEnd=n[4]),o&32&&(s.interactionWidth=n[5]),o&4&&(s.style=n[2]),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}function Zm(l,e,t){let n,o,s;const i=["label","labelStyle","style","markerStart","markerEnd","interactionWidth","sourceX","sourceY","sourcePosition","targetX","targetY","targetPosition"];Ut(e,i);let{label:r=void 0}=e,{labelStyle:a=void 0}=e,{style:c=void 0}=e,{markerStart:u=void 0}=e,{markerEnd:f=void 0}=e,{interactionWidth:d=void 0}=e,{sourceX:h}=e,{sourceY:_}=e,{sourcePosition:b}=e,{targetX:w}=e,{targetY:g}=e,{targetPosition:v}=e;return l.$$set=y=>{e=vt(vt({},e),zn(y)),t(15,Ut(e,i)),"label"in y&&t(0,r=y.label),"labelStyle"in y&&t(1,a=y.labelStyle),"style"in y&&t(2,c=y.style),"markerStart"in y&&t(3,u=y.markerStart),"markerEnd"in y&&t(4,f=y.markerEnd),"interactionWidth"in y&&t(5,d=y.interactionWidth),"sourceX"in y&&t(9,h=y.sourceX),"sourceY"in y&&t(10,_=y.sourceY),"sourcePosition"in y&&t(11,b=y.sourcePosition),"targetX"in y&&t(12,w=y.targetX),"targetY"in y&&t(13,g=y.targetY),"targetPosition"in y&&t(14,v=y.targetPosition)},l.$$.update=()=>{l.$$.dirty&32256&&t(8,[n,o,s]=za({sourceX:h,sourceY:_,targetX:w,targetY:g,sourcePosition:b,targetPosition:v}),n,(t(7,o),t(9,h),t(10,_),t(12,w),t(13,g),t(11,b),t(14,v)),(t(6,s),t(9,h),t(10,_),t(12,w),t(13,g),t(11,b),t(14,v)))},[r,a,c,u,f,d,s,o,n,h,_,b,w,g,v]}class qa extends Oe{constructor(e){super(),He(this,e,Zm,Xm,Le,{label:0,labelStyle:1,style:2,markerStart:3,markerEnd:4,interactionWidth:5,sourceX:9,sourceY:10,sourcePosition:11,targetX:12,targetY:13,targetPosition:14})}}function qm(l){let e,t;return e=new Lo({props:{path:l[8],labelX:l[7],labelY:l[6],label:l[0],labelStyle:l[1],markerStart:l[3],markerEnd:l[4],interactionWidth:l[5],style:l[2]}}),{c(){ee(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,o){te(e,n,o),t=!0},p(n,[o]){const s={};o&256&&(s.path=n[8]),o&128&&(s.labelX=n[7]),o&64&&(s.labelY=n[6]),o&1&&(s.label=n[0]),o&2&&(s.labelStyle=n[1]),o&8&&(s.markerStart=n[3]),o&16&&(s.markerEnd=n[4]),o&32&&(s.interactionWidth=n[5]),o&4&&(s.style=n[2]),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}function Jm(l,e,t){let n,o,s;const i=["label","labelStyle","style","markerStart","markerEnd","interactionWidth","sourceX","sourceY","sourcePosition","targetX","targetY","targetPosition"];Ut(e,i);let{label:r=void 0}=e,{labelStyle:a=void 0}=e,{style:c=void 0}=e,{markerStart:u=void 0}=e,{markerEnd:f=void 0}=e,{interactionWidth:d=void 0}=e,{sourceX:h}=e,{sourceY:_}=e,{sourcePosition:b}=e,{targetX:w}=e,{targetY:g}=e,{targetPosition:v}=e;return l.$$set=y=>{e=vt(vt({},e),zn(y)),t(15,Ut(e,i)),"label"in y&&t(0,r=y.label),"labelStyle"in y&&t(1,a=y.labelStyle),"style"in y&&t(2,c=y.style),"markerStart"in y&&t(3,u=y.markerStart),"markerEnd"in y&&t(4,f=y.markerEnd),"interactionWidth"in y&&t(5,d=y.interactionWidth),"sourceX"in y&&t(9,h=y.sourceX),"sourceY"in y&&t(10,_=y.sourceY),"sourcePosition"in y&&t(11,b=y.sourcePosition),"targetX"in y&&t(12,w=y.targetX),"targetY"in y&&t(13,g=y.targetY),"targetPosition"in y&&t(14,v=y.targetPosition)},l.$$.update=()=>{l.$$.dirty&32256&&t(8,[n,o,s]=yo({sourceX:h,sourceY:_,targetX:w,targetY:g,sourcePosition:b,targetPosition:v}),n,(t(7,o),t(9,h),t(10,_),t(12,w),t(13,g),t(11,b),t(14,v)),(t(6,s),t(9,h),t(10,_),t(12,w),t(13,g),t(11,b),t(14,v)))},[r,a,c,u,f,d,s,o,n,h,_,b,w,g,v]}class Qm extends Oe{constructor(e){super(),He(this,e,Jm,qm,Le,{label:0,labelStyle:1,style:2,markerStart:3,markerEnd:4,interactionWidth:5,sourceX:9,sourceY:10,sourcePosition:11,targetX:12,targetY:13,targetPosition:14})}}function xm(l){let e,t;return e=new Lo({props:{path:l[8],labelX:l[7],labelY:l[6],label:l[0],labelStyle:l[1],markerStart:l[3],markerEnd:l[4],interactionWidth:l[5],style:l[2]}}),{c(){ee(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,o){te(e,n,o),t=!0},p(n,[o]){const s={};o&256&&(s.path=n[8]),o&128&&(s.labelX=n[7]),o&64&&(s.labelY=n[6]),o&1&&(s.label=n[0]),o&2&&(s.labelStyle=n[1]),o&8&&(s.markerStart=n[3]),o&16&&(s.markerEnd=n[4]),o&32&&(s.interactionWidth=n[5]),o&4&&(s.style=n[2]),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}function $m(l,e,t){let n,o,s;const i=["label","labelStyle","style","markerStart","markerEnd","interactionWidth","sourceX","sourceY","targetX","targetY"];Ut(e,i);let{label:r=void 0}=e,{labelStyle:a=void 0}=e,{style:c=void 0}=e,{markerStart:u=void 0}=e,{markerEnd:f=void 0}=e,{interactionWidth:d=void 0}=e,{sourceX:h}=e,{sourceY:_}=e,{targetX:b}=e,{targetY:w}=e;return l.$$set=g=>{e=vt(vt({},e),zn(g)),t(13,Ut(e,i)),"label"in g&&t(0,r=g.label),"labelStyle"in g&&t(1,a=g.labelStyle),"style"in g&&t(2,c=g.style),"markerStart"in g&&t(3,u=g.markerStart),"markerEnd"in g&&t(4,f=g.markerEnd),"interactionWidth"in g&&t(5,d=g.interactionWidth),"sourceX"in g&&t(9,h=g.sourceX),"sourceY"in g&&t(10,_=g.sourceY),"targetX"in g&&t(11,b=g.targetX),"targetY"in g&&t(12,w=g.targetY)},l.$$.update=()=>{l.$$.dirty&7680&&t(8,[n,o,s]=Pa({sourceX:h,sourceY:_,targetX:b,targetY:w}),n,(t(7,o),t(9,h),t(10,_),t(11,b),t(12,w)),(t(6,s),t(9,h),t(10,_),t(11,b),t(12,w)))},[r,a,c,u,f,d,s,o,n,h,_,b,w]}class e1 extends Oe{constructor(e){super(),He(this,e,$m,xm,Le,{label:0,labelStyle:1,style:2,markerStart:3,markerEnd:4,interactionWidth:5,sourceX:9,sourceY:10,targetX:11,targetY:12})}}function t1(l){let e,t;return e=new Lo({props:{path:l[8],labelX:l[7],labelY:l[6],label:l[0],labelStyle:l[1],markerStart:l[3],markerEnd:l[4],interactionWidth:l[5],style:l[2]}}),{c(){ee(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,o){te(e,n,o),t=!0},p(n,[o]){const s={};o&256&&(s.path=n[8]),o&128&&(s.labelX=n[7]),o&64&&(s.labelY=n[6]),o&1&&(s.label=n[0]),o&2&&(s.labelStyle=n[1]),o&8&&(s.markerStart=n[3]),o&16&&(s.markerEnd=n[4]),o&32&&(s.interactionWidth=n[5]),o&4&&(s.style=n[2]),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}function n1(l,e,t){let n,o,s;const i=["label","labelStyle","style","markerStart","markerEnd","interactionWidth","sourceX","sourceY","sourcePosition","targetX","targetY","targetPosition"];Ut(e,i);let{label:r=void 0}=e,{labelStyle:a=void 0}=e,{style:c=void 0}=e,{markerStart:u=void 0}=e,{markerEnd:f=void 0}=e,{interactionWidth:d=void 0}=e,{sourceX:h}=e,{sourceY:_}=e,{sourcePosition:b}=e,{targetX:w}=e,{targetY:g}=e,{targetPosition:v}=e;return l.$$set=y=>{e=vt(vt({},e),zn(y)),t(15,Ut(e,i)),"label"in y&&t(0,r=y.label),"labelStyle"in y&&t(1,a=y.labelStyle),"style"in y&&t(2,c=y.style),"markerStart"in y&&t(3,u=y.markerStart),"markerEnd"in y&&t(4,f=y.markerEnd),"interactionWidth"in y&&t(5,d=y.interactionWidth),"sourceX"in y&&t(9,h=y.sourceX),"sourceY"in y&&t(10,_=y.sourceY),"sourcePosition"in y&&t(11,b=y.sourcePosition),"targetX"in y&&t(12,w=y.targetX),"targetY"in y&&t(13,g=y.targetY),"targetPosition"in y&&t(14,v=y.targetPosition)},l.$$.update=()=>{l.$$.dirty&32256&&t(8,[n,o,s]=yo({sourceX:h,sourceY:_,targetX:w,targetY:g,sourcePosition:b,targetPosition:v,borderRadius:0}),n,(t(7,o),t(9,h),t(10,_),t(12,w),t(13,g),t(11,b),t(14,v)),(t(6,s),t(9,h),t(10,_),t(12,w),t(13,g),t(11,b),t(14,v)))},[r,a,c,u,f,d,s,o,n,h,_,b,w,g,v]}class l1 extends Oe{constructor(e){super(),He(this,e,n1,t1,Le,{label:0,labelStyle:1,style:2,markerStart:3,markerEnd:4,interactionWidth:5,sourceX:9,sourceY:10,sourcePosition:11,targetX:12,targetY:13,targetPosition:14})}}function o1(l,e){const t=l.set,n=e.set,o=de(l),s=de(e);let r=o.length===0&&s.length>0?s:o;l.set(r);const a=c=>{const u=t(c);return r=u,n(r),u};l.set=e.set=a,l.update=e.update=c=>a(c(r))}function s1(l,e){const t=l.set,n=e.set;let o=de(e);l.set(o);const s=i=>{t(i),n(i),o=i};l.set=e.set=s,l.update=e.update=i=>s(i(o))}const r1=(l,e,t)=>{if(!t)return;const n=de(l),o=e.set,s=t.set;let i=t?de(t):{x:0,y:0,zoom:1};e.set(i),e.set=r=>(o(r),s(r),i=r,r),t.set=r=>(n==null||n.syncViewport(r),o(r),s(r),i=r,r),e.update=r=>{e.set(r(i))},t.update=r=>{t.set(r(i))}},i1=(l,e,t,n=[0,0],o=po)=>{const{subscribe:s,set:i,update:r}=xe([]);let a=l,c={},u=!0;const f=b=>(Aa(b,e,t,{elevateNodesOnSelect:u,nodeOrigin:n,nodeExtent:o,defaults:c,checkEquality:!1}),a=b,i(a),a),d=b=>f(b(a)),h=b=>{c=b},_=b=>{u=b.elevateNodesOnSelect??u};return f(a),{subscribe:s,set:f,update:d,setDefaultOptions:h,setOptions:_}},a1=(l,e,t,n)=>{const{subscribe:o,set:s,update:i}=xe([]);let r=l,a={};const c=d=>{const h=a?d.map(_=>({...a,..._})):d;Ra(e,t,h),r=h,s(r)},u=d=>c(d(r)),f=d=>{a=d};return c(r),{subscribe:o,set:c,update:u,setDefaultOptions:f}},Ja={input:Mm,output:zm,default:Xa,group:Pm},Qa={straight:e1,smoothstep:Qm,default:qa,step:l1},c1=({nodes:l=[],edges:e=[],width:t,height:n,fitView:o,nodeOrigin:s,nodeExtent:i})=>{const r=new Map,a=new Map,c=new Map,u=new Map,f=s??[0,0],d=i??po;Aa(l,r,a,{nodeExtent:d,nodeOrigin:f,elevateNodesOnSelect:!1,checkEquality:!1}),Ra(c,u,e);let h={x:0,y:0,zoom:1};if(o&&t&&n){const _=Po(r,{filter:b=>!!((b.width||b.initialWidth)&&(b.height||b.initialHeight))});h=ds(_,t,n,.5,2,.1)}return{flowId:xe(null),nodes:i1(l,r,a,f,d),nodeLookup:Mn(r),parentLookup:Mn(a),edgeLookup:Mn(u),visibleNodes:Mn([]),edges:a1(e,c,u),visibleEdges:Mn([]),connectionLookup:Mn(c),height:xe(500),width:xe(500),minZoom:xe(.5),maxZoom:xe(2),nodeOrigin:xe(f),nodeDragThreshold:xe(1),nodeExtent:xe(d),translateExtent:xe(po),autoPanOnNodeDrag:xe(!0),autoPanOnConnect:xe(!0),fitViewOnInit:xe(!1),fitViewOnInitDone:xe(!1),fitViewOptions:xe(void 0),panZoom:xe(null),snapGrid:xe(null),dragging:xe(!1),selectionRect:xe(null),selectionKeyPressed:xe(!1),multiselectionKeyPressed:xe(!1),deleteKeyPressed:xe(!1),panActivationKeyPressed:xe(!1),zoomActivationKeyPressed:xe(!1),selectionRectMode:xe(null),selectionMode:xe(_o.Partial),nodeTypes:xe(Ja),edgeTypes:xe(Qa),viewport:xe(h),connectionMode:xe(dl.Strict),domNode:xe(null),connection:Mn(ns),connectionLineType:xe(wl.Bezier),connectionRadius:xe(20),isValidConnection:xe(()=>!0),nodesDraggable:xe(!0),nodesConnectable:xe(!0),elementsSelectable:xe(!0),selectNodesOnDrag:xe(!0),markers:Mn([]),defaultMarkerColor:xe("#b1b1b7"),lib:Mn("svelte"),onlyRenderVisibleElements:xe(!1),onerror:xe(Bh),ondelete:xe(void 0),onedgecreate:xe(void 0),onconnect:xe(void 0),onconnectstart:xe(void 0),onconnectend:xe(void 0),onbeforedelete:xe(void 0),nodesInitialized:xe(!1),edgesInitialized:xe(!1),viewportInitialized:xe(!1),initialized:Mn(!1)}};function u1(l){const e=bl([l.edges,l.nodes,l.nodeLookup,l.onlyRenderVisibleElements,l.viewport,l.width,l.height],([t,,n,o,s,i,r])=>o&&i&&r?t.filter(c=>{const u=n.get(c.source),f=n.get(c.target);return u&&f&&Kh({sourceNode:u,targetNode:f,width:i,height:r,transform:[s.x,s.y,s.zoom]})}):t);return bl([e,l.nodes,l.nodeLookup,l.connectionMode,l.onerror],([t,,n,o,s])=>t.reduce((r,a)=>{const c=n.get(a.source),u=n.get(a.target);if(!c||!u)return r;const f=xh({id:a.id,sourceNode:c,targetNode:u,sourceHandle:a.sourceHandle||null,targetHandle:a.targetHandle||null,connectionMode:o,onError:s});return f&&r.push({...a,zIndex:Yh({selected:a.selected,zIndex:a.zIndex,sourceNode:c,targetNode:u,elevateOnSelect:!1}),...f}),r},[]))}function f1(l){return bl([l.nodeLookup,l.onlyRenderVisibleElements,l.width,l.height,l.viewport,l.nodes],([e,t,n,o,s])=>{const i=[s.x,s.y,s.zoom];return t?Ia(e,{x:0,y:0,width:n,height:o},i,!0):Array.from(e.values())})}const Bo=Symbol();function xa({nodes:l,edges:e,width:t,height:n,fitView:o,nodeOrigin:s,nodeExtent:i}){const r=c1({nodes:l,edges:e,width:t,height:n,fitView:o,nodeOrigin:s,nodeExtent:i});function a(N){r.nodeTypes.set({...Ja,...N})}function c(N){r.edgeTypes.set({...Qa,...N})}function u(N){const Y=de(r.edges);r.edges.set(Zh(N,Y))}const f=(N,Y=!1)=>{var F;const Z=de(r.nodeLookup);for(const[X,se]of N){const q=(F=Z.get(X))==null?void 0:F.internals.userNode;q&&(q.position=se.position,q.dragging=Y)}r.nodes.update(X=>X)};function d(N){var X,se,q;const Y=de(r.nodeLookup),{changes:Z,updatedInternals:F}=om(N,Y,de(r.parentLookup),de(r.domNode),de(r.nodeOrigin));if(F){if(!de(r.fitViewOnInitDone)&&de(r.fitViewOnInit)){const G=de(r.fitViewOptions),oe=_({...G,nodes:G==null?void 0:G.nodes});r.fitViewOnInitDone.set(oe)}for(const G of Z){const oe=(X=Y.get(G.id))==null?void 0:X.internals.userNode;if(oe)switch(G.type){case"dimensions":{const ae={...oe.measured,...G.dimensions};G.setAttributes&&(oe.width=((se=G.dimensions)==null?void 0:se.width)??oe.width,oe.height=((q=G.dimensions)==null?void 0:q.height)??oe.height),oe.measured=ae;break}case"position":oe.position=G.position??oe.position;break}}r.nodes.update(G=>G),de(r.nodesInitialized)||r.nodesInitialized.set(!0)}}function h(N){const Y=de(r.panZoom);if(!Y)return Promise.resolve(!1);const Z=jr(de(r.nodeLookup),N);return Yr({nodes:Z,width:de(r.width),height:de(r.height),minZoom:de(r.minZoom),maxZoom:de(r.maxZoom),panZoom:Y},N)}function _(N){const Y=de(r.panZoom);if(!Y)return!1;const Z=jr(de(r.nodeLookup),N);return Yr({nodes:Z,width:de(r.width),height:de(r.height),minZoom:de(r.minZoom),maxZoom:de(r.maxZoom),panZoom:Y},N),Z.size>0}function b(N,Y){const Z=de(r.panZoom);return Z?Z.scaleBy(N,Y):Promise.resolve(!1)}function w(N){return b(1.2,N)}function g(N){return b(1/1.2,N)}function v(N){const Y=de(r.panZoom);Y&&(Y.setScaleExtent([N,de(r.maxZoom)]),r.minZoom.set(N))}function y(N){const Y=de(r.panZoom);Y&&(Y.setScaleExtent([de(r.minZoom),N]),r.maxZoom.set(N))}function E(N){const Y=de(r.panZoom);Y&&(Y.setTranslateExtent(N),r.translateExtent.set(N))}function z(N){let Y=!1;return N.forEach(Z=>{Z.selected&&(Z.selected=!1,Y=!0)}),Y}function D(N){var Y;(Y=de(r.panZoom))==null||Y.setClickDistance(N)}function M(N){z((N==null?void 0:N.nodes)||de(r.nodes))&&r.nodes.set(de(r.nodes)),z((N==null?void 0:N.edges)||de(r.edges))&&r.edges.set(de(r.edges))}r.deleteKeyPressed.subscribe(async N=>{var Y;if(N){const Z=de(r.nodes),F=de(r.edges),X=Z.filter(oe=>oe.selected),se=F.filter(oe=>oe.selected),{nodes:q,edges:G}=await Sa({nodesToRemove:X,edgesToRemove:se,nodes:Z,edges:F,onBeforeDelete:de(r.onbeforedelete)});(q.length||G.length)&&(r.nodes.update(oe=>oe.filter(ae=>!q.some(ve=>ve.id===ae.id))),r.edges.update(oe=>oe.filter(ae=>!G.some(ve=>ve.id===ae.id))),(Y=de(r.ondelete))==null||Y({nodes:q,edges:G}))}});function A(N){const Y=de(r.multiselectionKeyPressed);r.nodes.update(Z=>Z.map(F=>{const X=N.includes(F.id),se=Y&&F.selected||X;return F.selected=se,F})),Y||r.edges.update(Z=>Z.map(F=>(F.selected=!1,F)))}function O(N){const Y=de(r.multiselectionKeyPressed);r.edges.update(Z=>Z.map(F=>{const X=N.includes(F.id),se=Y&&F.selected||X;return F.selected=se,F})),Y||r.nodes.update(Z=>Z.map(F=>(F.selected=!1,F)))}function L(N){var Z;const Y=(Z=de(r.nodes))==null?void 0:Z.find(F=>F.id===N);if(!Y){console.warn("012",Jl.error012(N));return}r.selectionRect.set(null),r.selectionRectMode.set(null),Y.selected?Y.selected&&de(r.multiselectionKeyPressed)&&M({nodes:[Y],edges:[]}):A([N])}function W(N){const Y=de(r.viewport);return sm({delta:N,panZoom:de(r.panZoom),transform:[Y.x,Y.y,Y.zoom],translateExtent:de(r.translateExtent),width:de(r.width),height:de(r.height)})}const K=xe(ns),R=N=>{K.set({...N})};function I(){K.set(ns)}function P(){r.fitViewOnInitDone.set(!1),r.selectionRect.set(null),r.selectionRectMode.set(null),r.snapGrid.set(null),r.isValidConnection.set(()=>!0),M(),I()}return{...r,visibleEdges:u1(r),visibleNodes:f1(r),connection:bl([K,r.viewport],([N,Y])=>N.inProgress?{...N,to:Ql(N.to,[Y.x,Y.y,Y.zoom])}:{...N}),markers:bl([r.edges,r.defaultMarkerColor,r.flowId],([N,Y,Z])=>$h(N,{defaultColor:Y,id:Z})),initialized:(()=>{let N=!1;const Y=de(r.nodes).length,Z=de(r.edges).length;return bl([r.nodesInitialized,r.edgesInitialized,r.viewportInitialized],([F,X,se])=>N||(Y===0?N=se:Z===0?N=se&&F:N=se&&F&&X,N))})(),syncNodeStores:N=>o1(r.nodes,N),syncEdgeStores:N=>s1(r.edges,N),syncViewport:N=>r1(r.panZoom,r.viewport,N),setNodeTypes:a,setEdgeTypes:c,addEdge:u,updateNodePositions:f,updateNodeInternals:d,zoomIn:w,zoomOut:g,fitView:N=>h(N),setMinZoom:v,setMaxZoom:y,setTranslateExtent:E,setPaneClickDistance:D,unselectNodesAndEdges:M,addSelectedNodes:A,addSelectedEdges:O,handleNodeSelection:L,panBy:W,updateConnection:R,cancelConnection:I,reset:P}}function Wt(){const l=Ot(Bo);if(!l)throw new Error("In order to use useStore you need to wrap your component in a <SvelteFlowProvider />");return l.getStore()}function d1({nodes:l,edges:e,width:t,height:n,fitView:o,nodeOrigin:s,nodeExtent:i}){const r=xa({nodes:l,edges:e,width:t,height:n,fitView:o,nodeOrigin:s,nodeExtent:i});return Ul(Bo,{getStore:()=>r}),r}function h1(l,e){const{panZoom:t,minZoom:n,maxZoom:o,initialViewport:s,viewport:i,dragging:r,translateExtent:a,paneClickDistance:c}=e,u=ym({domNode:l,minZoom:n,maxZoom:o,translateExtent:a,viewport:s,paneClickDistance:c,onDraggingChange:r.set}),f=u.getViewport();return i.set(f),t.set(u),u.update(e),{update(d){u.update(d)}}}function m1(l){let e,t,n,o,s;const i=l[35].default,r=Qt(i,l,l[34],null);return{c(){e=T("div"),r&&r.c(),this.h()},l(a){e=V(a,"DIV",{class:!0});var c=S(e);r&&r.l(c),c.forEach(p),this.h()},h(){m(e,"class","svelte-flow__zoom svelte-4xkw84")},m(a,c){B(a,e,c),r&&r.m(e,null),n=!0,o||(s=gn(t=h1.call(null,e,{viewport:l[18],minZoom:l[12],maxZoom:l[13],initialViewport:l[11],dragging:l[23],panZoom:l[19],onPanZoomStart:l[0],onPanZoom:l[1],onPanZoomEnd:l[2],zoomOnScroll:l[5],zoomOnDoubleClick:l[6],zoomOnPinch:l[7],panOnScroll:l[9],panOnDrag:l[10],panOnScrollSpeed:.5,panOnScrollMode:l[3]||Bn.Free,zoomActivationKeyPressed:l[14],preventScrolling:typeof l[4]=="boolean"?l[4]:!0,noPanClassName:"nopan",noWheelClassName:"nowheel",userSelectionActive:!!l[15],translateExtent:l[16],lib:l[17],paneClickDistance:l[8],onTransformChange:l[29]})),o=!0)},p(a,c){r&&r.p&&(!n||c[1]&8)&&xt(r,i,a,a[34],n?en(i,a[34],c,null):$t(a[34]),null),t&&ln(t.update)&&c[0]&262143&&t.update.call(null,{viewport:a[18],minZoom:a[12],maxZoom:a[13],initialViewport:a[11],dragging:a[23],panZoom:a[19],onPanZoomStart:a[0],onPanZoom:a[1],onPanZoomEnd:a[2],zoomOnScroll:a[5],zoomOnDoubleClick:a[6],zoomOnPinch:a[7],panOnScroll:a[9],panOnDrag:a[10],panOnScrollSpeed:.5,panOnScrollMode:a[3]||Bn.Free,zoomActivationKeyPressed:a[14],preventScrolling:typeof a[4]=="boolean"?a[4]:!0,noPanClassName:"nopan",noWheelClassName:"nowheel",userSelectionActive:!!a[15],translateExtent:a[16],lib:a[17],paneClickDistance:a[8],onTransformChange:a[29]})},i(a){n||(C(r,a),n=!0)},o(a){H(r,a),n=!1},d(a){a&&p(e),r&&r.d(a),o=!1,s()}}}function g1(l,e,t){let n,o,s,i,r,a,c,u,f,d,h,{$$slots:_={},$$scope:b}=e,{initialViewport:w=void 0}=e,{onMoveStart:g=void 0}=e,{onMove:v=void 0}=e,{onMoveEnd:y=void 0}=e,{panOnScrollMode:E}=e,{preventScrolling:z}=e,{zoomOnScroll:D}=e,{zoomOnDoubleClick:M}=e,{zoomOnPinch:A}=e,{panOnDrag:O}=e,{panOnScroll:L}=e,{paneClickDistance:W}=e;const{viewport:K,panZoom:R,selectionRect:I,minZoom:P,maxZoom:N,dragging:Y,translateExtent:Z,lib:F,panActivationKeyPressed:X,zoomActivationKeyPressed:se,viewportInitialized:q}=Wt();re(l,I,oe=>t(15,f=oe)),re(l,P,oe=>t(12,a=oe)),re(l,N,oe=>t(13,c=oe)),re(l,Z,oe=>t(16,d=oe)),re(l,F,oe=>t(17,h=oe)),re(l,X,oe=>t(33,r=oe)),re(l,se,oe=>t(14,u=oe)),re(l,q,oe=>t(36,i=oe));const G=oe=>K.set({x:oe[0],y:oe[1],zoom:oe[2]});return hn(()=>{ho(q,i=!0,i)}),l.$$set=oe=>{"initialViewport"in oe&&t(30,w=oe.initialViewport),"onMoveStart"in oe&&t(0,g=oe.onMoveStart),"onMove"in oe&&t(1,v=oe.onMove),"onMoveEnd"in oe&&t(2,y=oe.onMoveEnd),"panOnScrollMode"in oe&&t(3,E=oe.panOnScrollMode),"preventScrolling"in oe&&t(4,z=oe.preventScrolling),"zoomOnScroll"in oe&&t(5,D=oe.zoomOnScroll),"zoomOnDoubleClick"in oe&&t(6,M=oe.zoomOnDoubleClick),"zoomOnPinch"in oe&&t(7,A=oe.zoomOnPinch),"panOnDrag"in oe&&t(31,O=oe.panOnDrag),"panOnScroll"in oe&&t(32,L=oe.panOnScroll),"paneClickDistance"in oe&&t(8,W=oe.paneClickDistance),"$$scope"in oe&&t(34,b=oe.$$scope)},l.$$.update=()=>{l.$$.dirty[0]&1073741824&&t(11,n=w||{x:0,y:0,zoom:1}),l.$$.dirty[1]&5&&t(10,o=r||O),l.$$.dirty[1]&6&&t(9,s=r||L)},[g,v,y,E,z,D,M,A,W,s,o,n,a,c,u,f,d,h,K,R,I,P,N,Y,Z,F,X,se,q,G,w,O,L,r,b,_]}class p1 extends Oe{constructor(e){super(),He(this,e,g1,m1,Le,{initialViewport:30,onMoveStart:0,onMove:1,onMoveEnd:2,panOnScrollMode:3,preventScrolling:4,zoomOnScroll:5,zoomOnDoubleClick:6,zoomOnPinch:7,panOnDrag:31,panOnScroll:32,paneClickDistance:8},null,[-1,-1])}}function _1(l){let e,t,n,o;const s=l[28].default,i=Qt(s,l,l[27],null);return{c(){e=T("div"),i&&i.c(),this.h()},l(r){e=V(r,"DIV",{class:!0});var a=S(e);i&&i.l(a),a.forEach(p),this.h()},h(){m(e,"class","svelte-flow__pane svelte-1esy7hx"),lt(e,"draggable",l[0]===!0||Array.isArray(l[0])&&l[0].includes(0)),lt(e,"dragging",l[4]),lt(e,"selection",l[1])},m(r,a){B(r,e,a),i&&i.m(e,null),l[29](e),t=!0,n||(o=[Se(e,"click",function(){ln(l[3]?void 0:uo(l[15],l[2]))&&(l[3]?void 0:uo(l[15],l[2])).apply(this,arguments)}),Se(e,"pointerdown",function(){ln(l[3]?l[16]:void 0)&&(l[3]?l[16]:void 0).apply(this,arguments)}),Se(e,"pointermove",function(){ln(l[3]?l[17]:void 0)&&(l[3]?l[17]:void 0).apply(this,arguments)}),Se(e,"pointerup",function(){ln(l[3]?l[18]:void 0)&&(l[3]?l[18]:void 0).apply(this,arguments)}),Se(e,"contextmenu",function(){ln(uo(l[19],l[2]))&&uo(l[19],l[2]).apply(this,arguments)})],n=!0)},p(r,a){l=r,i&&i.p&&(!t||a[0]&134217728)&&xt(i,s,l,l[27],t?en(s,l[27],a,null):$t(l[27]),null),(!t||a[0]&1)&&lt(e,"draggable",l[0]===!0||Array.isArray(l[0])&&l[0].includes(0)),(!t||a[0]&16)&&lt(e,"dragging",l[4]),(!t||a[0]&2)&&lt(e,"selection",l[1])},i(r){t||(C(i,r),t=!0)},o(r){H(i,r),t=!1},d(r){r&&p(e),i&&i.d(r),l[29](null),n=!1,sn(o)}}}function uo(l,e){return t=>{t.target===e&&(l==null||l(t))}}function si(l){return e=>{const t=l.includes(e.id);return e.selected!==t&&(e.selected=t),e}}function b1(l,e,t){let n,o,s,i,r,a,c,u,f,d,h,_,b,{$$slots:w={},$$scope:g}=e,{panOnDrag:v=void 0}=e,{selectionOnDrag:y=void 0}=e;const E=on(),{nodes:z,nodeLookup:D,edges:M,viewport:A,dragging:O,elementsSelectable:L,selectionRect:W,selectionRectMode:K,selectionKeyPressed:R,selectionMode:I,panActivationKeyPressed:P,unselectNodesAndEdges:N}=Wt();re(l,D,$=>t(36,f=$)),re(l,M,$=>t(33,a=$)),re(l,A,$=>t(35,u=$)),re(l,O,$=>t(4,b=$)),re(l,L,$=>t(25,h=$)),re(l,W,$=>t(24,d=$)),re(l,K,$=>t(23,r=$)),re(l,R,$=>t(22,i=$)),re(l,I,$=>t(34,c=$)),re(l,P,$=>t(26,_=$));let Y,Z=null,F=[],X=!1;function se($){if(X){X=!1;return}E("paneclick",{event:$}),N(),K.set(null)}function q($){var ce,Ze;if(Z=Y.getBoundingClientRect(),!L||!o||$.button!==0||$.target!==Y||!Z)return;(Ze=(ce=$.target)==null?void 0:ce.setPointerCapture)==null||Ze.call(ce,$.pointerId);const{x:Ie,y:Ne}=Wn($,Z);N(),W.set({width:0,height:0,startX:Ie,startY:Ne,x:Ie,y:Ne})}function G($){if(!o||!Z||!d)return;X=!0;const Ie=Wn($,Z),Ne=d.startX??0,ce=d.startY??0,Ze={...d,x:Ie.x<Ne?Ie.x:Ne,y:Ie.y<ce?Ie.y:ce,width:Math.abs(Ie.x-Ne),height:Math.abs(Ie.y-ce)},Qe=F.map(et=>et.id),ge=ls(F,a).map(et=>et.id);F=Ia(f,Ze,[u.x,u.y,u.zoom],c===_o.Partial,!0);const ie=ls(F,a).map(et=>et.id),Ue=F.map(et=>et.id);(Qe.length!==Ue.length||Ue.some(et=>!Qe.includes(et)))&&z.update(et=>et.map(si(Ue))),(ge.length!==ie.length||ie.some(et=>!ge.includes(et)))&&M.update(et=>et.map(si(ie))),K.set("user"),W.set(Ze)}function oe($){var Ie,Ne;$.button===0&&((Ne=(Ie=$.target)==null?void 0:Ie.releasePointerCapture)==null||Ne.call(Ie,$.pointerId),!o&&r==="user"&&$.target===Y&&(se==null||se($)),W.set(null),F.length>0&&ho(K,r="nodes",r),i&&(X=!1))}const ae=$=>{if(Array.isArray(n)&&(n!=null&&n.includes(2))){$.preventDefault();return}E("panecontextmenu",{event:$})};function ve($){Ae[$?"unshift":"push"](()=>{Y=$,t(2,Y)})}return l.$$set=$=>{"panOnDrag"in $&&t(0,v=$.panOnDrag),"selectionOnDrag"in $&&t(20,y=$.selectionOnDrag),"$$scope"in $&&t(27,g=$.$$scope)},l.$$.update=()=>{l.$$.dirty[0]&67108865&&t(21,n=_||v),l.$$.dirty[0]&24117248&&t(1,o=i||d||y&&n!==!0),l.$$.dirty[0]&41943042&&t(3,s=h&&(o||r==="user"))},[v,o,Y,s,b,D,M,A,O,L,W,K,R,I,P,se,q,G,oe,ae,y,n,i,r,d,h,_,g,w,ve]}class v1 extends Oe{constructor(e){super(),He(this,e,b1,_1,Le,{panOnDrag:0,selectionOnDrag:20},null,[-1,-1])}}function w1(l){let e,t;const n=l[3].default,o=Qt(n,l,l[2],null);return{c(){e=T("div"),o&&o.c(),this.h()},l(s){e=V(s,"DIV",{class:!0,style:!0});var i=S(e);o&&o.l(i),i.forEach(p),this.h()},h(){m(e,"class","svelte-flow__viewport xyflow__viewport svelte-1floaup"),$e(e,"transform","translate("+l[0].x+"px, "+l[0].y+"px) scale("+l[0].zoom+")")},m(s,i){B(s,e,i),o&&o.m(e,null),t=!0},p(s,[i]){o&&o.p&&(!t||i&4)&&xt(o,n,s,s[2],t?en(n,s[2],i,null):$t(s[2]),null),(!t||i&1)&&$e(e,"transform","translate("+s[0].x+"px, "+s[0].y+"px) scale("+s[0].zoom+")")},i(s){t||(C(o,s),t=!0)},o(s){H(o,s),t=!1},d(s){s&&p(e),o&&o.d(s)}}}function y1(l,e,t){let n,{$$slots:o={},$$scope:s}=e;const{viewport:i}=Wt();return re(l,i,r=>t(0,n=r)),l.$$set=r=>{"$$scope"in r&&t(2,s=r.$$scope)},[n,i,s,o]}class k1 extends Oe{constructor(e){super(),He(this,e,y1,w1,Le,{})}}function $a(l,e){const{store:t,onDrag:n,onDragStart:o,onDragStop:s,onNodeMouseDown:i}=e,r=im({onDrag:n,onDragStart:o,onDragStop:s,onNodeMouseDown:i,getStoreItems:()=>{const c=de(t.snapGrid),u=de(t.viewport);return{nodes:de(t.nodes),nodeLookup:de(t.nodeLookup),edges:de(t.edges),nodeExtent:de(t.nodeExtent),snapGrid:c||[0,0],snapToGrid:!!c,nodeOrigin:de(t.nodeOrigin),multiSelectionActive:de(t.multiselectionKeyPressed),domNode:de(t.domNode),transform:[u.x,u.y,u.zoom],autoPanOnNodeDrag:de(t.autoPanOnNodeDrag),nodesDraggable:de(t.nodesDraggable),selectNodesOnDrag:de(t.selectNodesOnDrag),nodeDragThreshold:de(t.nodeDragThreshold),unselectNodesAndEdges:t.unselectNodesAndEdges,updateNodePositions:t.updateNodePositions,panBy:t.panBy}}});function a(c,u){if(u.disabled){r.destroy();return}r.update({domNode:c,noDragClassName:u.noDragClass,handleSelector:u.handleSelector,nodeId:u.nodeId,isSelectable:u.isSelectable,nodeClickDistance:u.nodeClickDistance})}return a(l,e),{update(c){a(l,c)},destroy(){r.destroy()}}}function E1({width:l,height:e,initialWidth:t,initialHeight:n,measuredWidth:o,measuredHeight:s}){if(o===void 0&&s===void 0){const i=l??t,r=e??n;return{width:i?`width:${i}px;`:"",height:r?`height:${r}px;`:""}}return{width:l?`width:${l}px;`:"",height:e?`height:${e}px;`:""}}function ri(l){let e,t,n,o,s,i=`translate(${l[12]}px, ${l[13]}px)`,r,a,c;var u=l[27];function f(d,h){return{props:{data:d[2],id:d[1],selected:d[3],selectable:d[5],deletable:d[7],sourcePosition:d[14],targetPosition:d[15],zIndex:d[16],dragging:d[9],draggable:d[4],dragHandle:d[19],parentId:d[21],type:d[25],isConnectable:d[28],positionAbsoluteX:d[12],positionAbsoluteY:d[13],width:d[17],height:d[18]}}}return u&&(t=mo(u,f(l))),{c(){e=T("div"),t&&ee(t.$$.fragment),this.h()},l(d){e=V(d,"DIV",{"data-id":!0,class:!0,style:!0});var h=S(e);t&&le(t.$$.fragment,h),h.forEach(p),this.h()},h(){m(e,"data-id",l[1]),m(e,"class",n=Nt(["svelte-flow__node",`svelte-flow__node-${l[25]}`,l[23]])),m(e,"style",o=(l[10]??"")+";"+l[26].width+l[26].height),lt(e,"dragging",l[9]),lt(e,"selected",l[3]),lt(e,"draggable",l[4]),lt(e,"connectable",l[6]),lt(e,"selectable",l[5]),lt(e,"nopan",l[4]),lt(e,"parent",l[11]),$e(e,"z-index",l[16]),$e(e,"transform",i),$e(e,"visibility",l[20]?"visible":"hidden")},m(d,h){B(d,e,h),t&&te(t,e,null),l[50](e),r=!0,a||(c=[gn(s=$a.call(null,e,{nodeId:l[1],isSelectable:l[5],disabled:!1,handleSelector:l[19],noDragClass:"nodrag",nodeClickDistance:l[22],onNodeMouseDown:l[31],onDrag:l[47],onDragStart:l[48],onDragStop:l[49],store:l[29]})),Se(e,"click",l[34]),Se(e,"mouseenter",l[51]),Se(e,"mouseleave",l[52]),Se(e,"mousemove",l[53]),Se(e,"contextmenu",l[54])],a=!0)},p(d,h){if(h[0]&134217728&&u!==(u=d[27])){if(t){Ve();const b=t;H(b.$$.fragment,1,0,()=>{ne(b,1)}),ze()}u?(t=mo(u,f(d)),ee(t.$$.fragment),C(t.$$.fragment,1),te(t,e,null)):t=null}else if(u){const b={};h[0]&4&&(b.data=d[2]),h[0]&2&&(b.id=d[1]),h[0]&8&&(b.selected=d[3]),h[0]&32&&(b.selectable=d[5]),h[0]&128&&(b.deletable=d[7]),h[0]&16384&&(b.sourcePosition=d[14]),h[0]&32768&&(b.targetPosition=d[15]),h[0]&65536&&(b.zIndex=d[16]),h[0]&512&&(b.dragging=d[9]),h[0]&16&&(b.draggable=d[4]),h[0]&524288&&(b.dragHandle=d[19]),h[0]&2097152&&(b.parentId=d[21]),h[0]&33554432&&(b.type=d[25]),h[0]&268435456&&(b.isConnectable=d[28]),h[0]&4096&&(b.positionAbsoluteX=d[12]),h[0]&8192&&(b.positionAbsoluteY=d[13]),h[0]&131072&&(b.width=d[17]),h[0]&262144&&(b.height=d[18]),t.$set(b)}(!r||h[0]&2)&&m(e,"data-id",d[1]),(!r||h[0]&41943040&&n!==(n=Nt(["svelte-flow__node",`svelte-flow__node-${d[25]}`,d[23]])))&&m(e,"class",n),(!r||h[0]&67109888&&o!==(o=(d[10]??"")+";"+d[26].width+d[26].height))&&m(e,"style",o),s&&ln(s.update)&&h[0]&4718626&&s.update.call(null,{nodeId:d[1],isSelectable:d[5],disabled:!1,handleSelector:d[19],noDragClass:"nodrag",nodeClickDistance:d[22],onNodeMouseDown:d[31],onDrag:d[47],onDragStart:d[48],onDragStop:d[49],store:d[29]}),(!r||h[0]&41943552)&&lt(e,"dragging",d[9]),(!r||h[0]&41943048)&&lt(e,"selected",d[3]),(!r||h[0]&41943056)&&lt(e,"draggable",d[4]),(!r||h[0]&41943104)&&lt(e,"connectable",d[6]),(!r||h[0]&41943072)&&lt(e,"selectable",d[5]),(!r||h[0]&41943056)&&lt(e,"nopan",d[4]),(!r||h[0]&41945088)&&lt(e,"parent",d[11]);const _=h[0]&67109888;(h[0]&67175424||_)&&$e(e,"z-index",d[16]),(h[0]&67122176&&i!==(i=`translate(${d[12]}px, ${d[13]}px)`)||_)&&$e(e,"transform",i),(h[0]&68158464||_)&&$e(e,"visibility",d[20]?"visible":"hidden")},i(d){r||(t&&C(t.$$.fragment,d),r=!0)},o(d){t&&H(t.$$.fragment,d),r=!1},d(d){d&&p(e),t&&ne(t),l[50](null),a=!1,sn(c)}}}function I1(l){let e,t,n=!l[8]&&ri(l);return{c(){n&&n.c(),e=Te()},l(o){n&&n.l(o),e=Te()},m(o,s){n&&n.m(o,s),B(o,e,s),t=!0},p(o,s){o[8]?n&&(Ve(),H(n,1,1,()=>{n=null}),ze()):n?(n.p(o,s),s[0]&256&&C(n,1)):(n=ri(o),n.c(),C(n,1),n.m(e.parentNode,e))},i(o){t||(C(n),t=!0)},o(o){H(n),t=!1},d(o){o&&p(e),n&&n.d(o)}}}function S1(l,e,t){let n,o,s,i,r,a,{node:c}=e,{id:u}=e,{data:f={}}=e,{selected:d=!1}=e,{draggable:h=void 0}=e,{selectable:_=void 0}=e,{connectable:b=!0}=e,{deletable:w=!0}=e,{hidden:g=!1}=e,{dragging:v=!1}=e,{resizeObserver:y=null}=e,{style:E=void 0}=e,{type:z="default"}=e,{isParent:D=!1}=e,{positionX:M}=e,{positionY:A}=e,{sourcePosition:O=void 0}=e,{targetPosition:L=void 0}=e,{zIndex:W}=e,{measuredWidth:K=void 0}=e,{measuredHeight:R=void 0}=e,{initialWidth:I=void 0}=e,{initialHeight:P=void 0}=e,{width:N=void 0}=e,{height:Y=void 0}=e,{dragHandle:Z=void 0}=e,{initialized:F=!1}=e,{parentId:X=void 0}=e,{nodeClickDistance:se=void 0}=e,{class:q=""}=e;const G=Wt(),{nodeTypes:oe,nodeDragThreshold:ae,selectNodesOnDrag:ve,handleNodeSelection:$,updateNodeInternals:Ie}=G;re(l,oe,me=>t(46,r=me));let Ne,ce=null;const Ze=on(),Qe=xe(b);re(l,Qe,me=>t(28,a=me));let ge,ie,Ue;Ul("svelteflow__node_id",u),Ul("svelteflow__node_connectable",Qe),$n(()=>{ce&&(y==null||y.unobserve(ce))});function et(me){_&&(!de(ve)||!h||de(ae)>0)&&$(u),Ze("nodeclick",{node:c.internals.userNode,event:me})}const at=(me,Lt,Et,Ct)=>{Ze("nodedrag",{event:me,targetNode:Et,nodes:Ct})},_t=(me,Lt,Et,Ct)=>{Ze("nodedragstart",{event:me,targetNode:Et,nodes:Ct})},nt=(me,Lt,Et,Ct)=>{Ze("nodedragstop",{event:me,targetNode:Et,nodes:Ct})};function mt(me){Ae[me?"unshift":"push"](()=>{Ne=me,t(24,Ne)})}const jt=me=>Ze("nodemouseenter",{node:c,event:me}),Ht=me=>Ze("nodemouseleave",{node:c,event:me}),gt=me=>Ze("nodemousemove",{node:c,event:me}),At=me=>Ze("nodecontextmenu",{node:c,event:me});return l.$$set=me=>{"node"in me&&t(0,c=me.node),"id"in me&&t(1,u=me.id),"data"in me&&t(2,f=me.data),"selected"in me&&t(3,d=me.selected),"draggable"in me&&t(4,h=me.draggable),"selectable"in me&&t(5,_=me.selectable),"connectable"in me&&t(6,b=me.connectable),"deletable"in me&&t(7,w=me.deletable),"hidden"in me&&t(8,g=me.hidden),"dragging"in me&&t(9,v=me.dragging),"resizeObserver"in me&&t(35,y=me.resizeObserver),"style"in me&&t(10,E=me.style),"type"in me&&t(36,z=me.type),"isParent"in me&&t(11,D=me.isParent),"positionX"in me&&t(12,M=me.positionX),"positionY"in me&&t(13,A=me.positionY),"sourcePosition"in me&&t(14,O=me.sourcePosition),"targetPosition"in me&&t(15,L=me.targetPosition),"zIndex"in me&&t(16,W=me.zIndex),"measuredWidth"in me&&t(37,K=me.measuredWidth),"measuredHeight"in me&&t(38,R=me.measuredHeight),"initialWidth"in me&&t(39,I=me.initialWidth),"initialHeight"in me&&t(40,P=me.initialHeight),"width"in me&&t(17,N=me.width),"height"in me&&t(18,Y=me.height),"dragHandle"in me&&t(19,Z=me.dragHandle),"initialized"in me&&t(20,F=me.initialized),"parentId"in me&&t(21,X=me.parentId),"nodeClickDistance"in me&&t(22,se=me.nodeClickDistance),"class"in me&&t(23,q=me.class)},l.$$.update=()=>{l.$$.dirty[1]&32&&t(25,n=z||"default"),l.$$.dirty[0]&33554432|l.$$.dirty[1]&32768&&t(45,o=!!r[n]),l.$$.dirty[0]&33554432|l.$$.dirty[1]&32768&&t(27,s=r[n]||Xa),l.$$.dirty[1]&16416&&(o||console.warn("003",Jl.error003(z))),l.$$.dirty[0]&393216|l.$$.dirty[1]&960&&t(26,i=E1({width:N,height:Y,initialWidth:I,initialHeight:P,measuredWidth:K,measuredHeight:R})),l.$$.dirty[0]&64&&Qe.set(!!b),l.$$.dirty[0]&50380802|l.$$.dirty[1]&14336&&((ge&&n!==ge||ie&&O!==ie||Ue&&L!==Ue)&&requestAnimationFrame(()=>Ie(new Map([[u,{id:u,nodeElement:Ne,force:!0}]]))),t(42,ge=n),t(43,ie=O),t(44,Ue=L)),l.$$.dirty[0]&17825792|l.$$.dirty[1]&1040&&y&&(Ne!==ce||!F)&&(ce&&y.unobserve(ce),Ne&&y.observe(Ne),t(41,ce=Ne))},[c,u,f,d,h,_,b,w,g,v,E,D,M,A,O,L,W,N,Y,Z,F,X,se,q,Ne,n,i,s,a,G,oe,$,Ze,Qe,et,y,z,K,R,I,P,ce,ge,ie,Ue,o,r,at,_t,nt,mt,jt,Ht,gt,At]}class D1 extends Oe{constructor(e){super(),He(this,e,S1,I1,ca,{node:0,id:1,data:2,selected:3,draggable:4,selectable:5,connectable:6,deletable:7,hidden:8,dragging:9,resizeObserver:35,style:10,type:36,isParent:11,positionX:12,positionY:13,sourcePosition:14,targetPosition:15,zIndex:16,measuredWidth:37,measuredHeight:38,initialWidth:39,initialHeight:40,width:17,height:18,dragHandle:19,initialized:20,parentId:21,nodeClickDistance:22,class:23},null,[-1,-1])}}const{Map:C1}=ua;function ii(l,e,t){const n=l.slice();return n[21]=e[t],n}function ai(l,e){let t,n,o;return n=new D1({props:{node:e[21],id:e[21].id,data:e[21].data,selected:!!e[21].selected,hidden:!!e[21].hidden,draggable:!!(e[21].draggable||e[2]&&typeof e[21].draggable>"u"),selectable:!!(e[21].selectable||e[3]&&typeof e[21].selectable>"u"),connectable:!!(e[21].connectable||e[4]&&typeof e[21].connectable>"u"),deletable:e[21].deletable??!0,positionX:e[21].internals.positionAbsolute.x,positionY:e[21].internals.positionAbsolute.y,isParent:e[5].has(e[21].id),style:e[21].style,class:e[21].class,type:e[21].type??"default",sourcePosition:e[21].sourcePosition,targetPosition:e[21].targetPosition,dragging:e[21].dragging,zIndex:e[21].internals.z??0,dragHandle:e[21].dragHandle,initialized:Xr(e[21]),width:e[21].width,height:e[21].height,initialWidth:e[21].initialWidth,initialHeight:e[21].initialHeight,measuredWidth:e[21].measured.width,measuredHeight:e[21].measured.height,parentId:e[21].parentId,resizeObserver:e[11],nodeClickDistance:e[0]}}),n.$on("nodeclick",e[12]),n.$on("nodemouseenter",e[13]),n.$on("nodemousemove",e[14]),n.$on("nodemouseleave",e[15]),n.$on("nodedrag",e[16]),n.$on("nodedragstart",e[17]),n.$on("nodedragstop",e[18]),n.$on("nodecontextmenu",e[19]),{key:l,first:null,c(){t=Te(),ee(n.$$.fragment),this.h()},l(s){t=Te(),le(n.$$.fragment,s),this.h()},h(){this.first=t},m(s,i){B(s,t,i),te(n,s,i),o=!0},p(s,i){e=s;const r={};i&2&&(r.node=e[21]),i&2&&(r.id=e[21].id),i&2&&(r.data=e[21].data),i&2&&(r.selected=!!e[21].selected),i&2&&(r.hidden=!!e[21].hidden),i&6&&(r.draggable=!!(e[21].draggable||e[2]&&typeof e[21].draggable>"u")),i&10&&(r.selectable=!!(e[21].selectable||e[3]&&typeof e[21].selectable>"u")),i&18&&(r.connectable=!!(e[21].connectable||e[4]&&typeof e[21].connectable>"u")),i&2&&(r.deletable=e[21].deletable??!0),i&2&&(r.positionX=e[21].internals.positionAbsolute.x),i&2&&(r.positionY=e[21].internals.positionAbsolute.y),i&34&&(r.isParent=e[5].has(e[21].id)),i&2&&(r.style=e[21].style),i&2&&(r.class=e[21].class),i&2&&(r.type=e[21].type??"default"),i&2&&(r.sourcePosition=e[21].sourcePosition),i&2&&(r.targetPosition=e[21].targetPosition),i&2&&(r.dragging=e[21].dragging),i&2&&(r.zIndex=e[21].internals.z??0),i&2&&(r.dragHandle=e[21].dragHandle),i&2&&(r.initialized=Xr(e[21])),i&2&&(r.width=e[21].width),i&2&&(r.height=e[21].height),i&2&&(r.initialWidth=e[21].initialWidth),i&2&&(r.initialHeight=e[21].initialHeight),i&2&&(r.measuredWidth=e[21].measured.width),i&2&&(r.measuredHeight=e[21].measured.height),i&2&&(r.parentId=e[21].parentId),i&1&&(r.nodeClickDistance=e[0]),n.$set(r)},i(s){o||(C(n.$$.fragment,s),o=!0)},o(s){H(n.$$.fragment,s),o=!1},d(s){s&&p(t),ne(n,s)}}}function M1(l){let e,t=[],n=new C1,o,s=ht(l[1]);const i=r=>r[21].id;for(let r=0;r<s.length;r+=1){let a=ii(l,s,r),c=i(a);n.set(c,t[r]=ai(c,a))}return{c(){e=T("div");for(let r=0;r<t.length;r+=1)t[r].c();this.h()},l(r){e=V(r,"DIV",{class:!0});var a=S(e);for(let c=0;c<t.length;c+=1)t[c].l(a);a.forEach(p),this.h()},h(){m(e,"class","svelte-flow__nodes svelte-tf4uy4")},m(r,a){B(r,e,a);for(let c=0;c<t.length;c+=1)t[c]&&t[c].m(e,null);o=!0},p(r,[a]){a&2111&&(s=ht(r[1]),Ve(),t=Io(t,a,i,1,r,s,n,e,So,ai,null,ii),ze())},i(r){if(!o){for(let a=0;a<s.length;a+=1)C(t[a]);o=!0}},o(r){for(let a=0;a<t.length;a+=1)H(t[a]);o=!1},d(r){r&&p(e);for(let a=0;a<t.length;a+=1)t[a].d()}}}function T1(l,e,t){let n,o,s,i,r,{nodeClickDistance:a=0}=e;const{visibleNodes:c,nodesDraggable:u,nodesConnectable:f,elementsSelectable:d,updateNodeInternals:h,parentLookup:_}=Wt();re(l,c,A=>t(1,n=A)),re(l,u,A=>t(2,o=A)),re(l,f,A=>t(4,i=A)),re(l,d,A=>t(3,s=A)),re(l,_,A=>t(5,r=A));const b=typeof ResizeObserver>"u"?null:new ResizeObserver(A=>{const O=new Map;A.forEach(L=>{const W=L.target.getAttribute("data-id");O.set(W,{id:W,nodeElement:L.target,force:!0})}),h(O)});$n(()=>{b==null||b.disconnect()});function w(A){dt.call(this,l,A)}function g(A){dt.call(this,l,A)}function v(A){dt.call(this,l,A)}function y(A){dt.call(this,l,A)}function E(A){dt.call(this,l,A)}function z(A){dt.call(this,l,A)}function D(A){dt.call(this,l,A)}function M(A){dt.call(this,l,A)}return l.$$set=A=>{"nodeClickDistance"in A&&t(0,a=A.nodeClickDistance)},[a,n,o,s,i,r,c,u,f,d,_,b,w,g,v,y,E,z,D,M]}class V1 extends Oe{constructor(e){super(),He(this,e,T1,M1,Le,{nodeClickDistance:0})}}function ci(l){let e,t,n,o,s,i,r,a;var c=l[27];function u(f,d){return{props:{id:f[0],source:f[1],target:f[2],sourceX:f[14],sourceY:f[15],targetX:f[16],targetY:f[17],sourcePosition:f[18],targetPosition:f[19],animated:f[6],selected:f[7],label:f[10],labelStyle:f[11],data:f[3],style:f[4],interactionWidth:f[21],selectable:f[24],deletable:f[8]??!0,type:f[23],sourceHandleId:f[12],targetHandleId:f[13],markerStart:f[26],markerEnd:f[25]}}}return c&&(n=mo(c,u(l))),{c(){e=_e("svg"),t=_e("g"),n&&ee(n.$$.fragment),this.h()},l(f){e=be(f,"svg",{});var d=S(e);t=be(d,"g",{class:!0,"data-id":!0,"aria-label":!0,role:!0});var h=S(t);n&&le(n.$$.fragment,h),h.forEach(p),d.forEach(p),this.h()},h(){m(t,"class",o=Nt(["svelte-flow__edge",l[22]])),m(t,"data-id",l[0]),m(t,"aria-label",s=l[20]===null?void 0:l[20]?l[20]:`Edge from ${l[1]} to ${l[2]}`),m(t,"role","img"),lt(t,"animated",l[6]),lt(t,"selected",l[7]),lt(t,"selectable",l[24]),$e(e,"z-index",l[5])},m(f,d){B(f,e,d),k(e,t),n&&te(n,t,null),i=!0,r||(a=[Se(t,"click",l[32]),Se(t,"contextmenu",l[41]),Se(t,"mouseenter",l[42]),Se(t,"mouseleave",l[43])],r=!0)},p(f,d){if(d[0]&134217728&&c!==(c=f[27])){if(n){Ve();const h=n;H(h.$$.fragment,1,0,()=>{ne(h,1)}),ze()}c?(n=mo(c,u(f)),ee(n.$$.fragment),C(n.$$.fragment,1),te(n,t,null)):n=null}else if(c){const h={};d[0]&1&&(h.id=f[0]),d[0]&2&&(h.source=f[1]),d[0]&4&&(h.target=f[2]),d[0]&16384&&(h.sourceX=f[14]),d[0]&32768&&(h.sourceY=f[15]),d[0]&65536&&(h.targetX=f[16]),d[0]&131072&&(h.targetY=f[17]),d[0]&262144&&(h.sourcePosition=f[18]),d[0]&524288&&(h.targetPosition=f[19]),d[0]&64&&(h.animated=f[6]),d[0]&128&&(h.selected=f[7]),d[0]&1024&&(h.label=f[10]),d[0]&2048&&(h.labelStyle=f[11]),d[0]&8&&(h.data=f[3]),d[0]&16&&(h.style=f[4]),d[0]&2097152&&(h.interactionWidth=f[21]),d[0]&16777216&&(h.selectable=f[24]),d[0]&256&&(h.deletable=f[8]??!0),d[0]&8388608&&(h.type=f[23]),d[0]&4096&&(h.sourceHandleId=f[12]),d[0]&8192&&(h.targetHandleId=f[13]),d[0]&67108864&&(h.markerStart=f[26]),d[0]&33554432&&(h.markerEnd=f[25]),n.$set(h)}(!i||d[0]&4194304&&o!==(o=Nt(["svelte-flow__edge",f[22]])))&&m(t,"class",o),(!i||d[0]&1)&&m(t,"data-id",f[0]),(!i||d[0]&1048582&&s!==(s=f[20]===null?void 0:f[20]?f[20]:`Edge from ${f[1]} to ${f[2]}`))&&m(t,"aria-label",s),(!i||d[0]&4194368)&&lt(t,"animated",f[6]),(!i||d[0]&4194432)&&lt(t,"selected",f[7]),(!i||d[0]&20971520)&&lt(t,"selectable",f[24]),d[0]&32&&$e(e,"z-index",f[5])},i(f){i||(n&&C(n.$$.fragment,f),i=!0)},o(f){n&&H(n.$$.fragment,f),i=!1},d(f){f&&p(e),n&&ne(n),r=!1,sn(a)}}}function z1(l){let e,t,n=!l[9]&&ci(l);return{c(){n&&n.c(),e=Te()},l(o){n&&n.l(o),e=Te()},m(o,s){n&&n.m(o,s),B(o,e,s),t=!0},p(o,s){o[9]?n&&(Ve(),H(n,1,1,()=>{n=null}),ze()):n?(n.p(o,s),s[0]&512&&C(n,1)):(n=ci(o),n.c(),C(n,1),n.m(e.parentNode,e))},i(o){t||(C(n),t=!0)},o(o){H(n),t=!1},d(o){o&&p(e),n&&n.d(o)}}}function N1(l,e,t){let n,o,s,i,r,a,c,u,f,{id:d}=e,{type:h="default"}=e,{source:_=""}=e,{target:b=""}=e,{data:w={}}=e,{style:g=void 0}=e,{zIndex:v=void 0}=e,{animated:y=!1}=e,{selected:E=!1}=e,{selectable:z=void 0}=e,{deletable:D=void 0}=e,{hidden:M=!1}=e,{label:A=void 0}=e,{labelStyle:O=void 0}=e,{markerStart:L=void 0}=e,{markerEnd:W=void 0}=e,{sourceHandle:K=void 0}=e,{targetHandle:R=void 0}=e,{sourceX:I}=e,{sourceY:P}=e,{targetX:N}=e,{targetY:Y}=e,{sourcePosition:Z}=e,{targetPosition:F}=e,{ariaLabel:X=void 0}=e,{interactionWidth:se=void 0}=e,{class:q=""}=e;Ul("svelteflow__edge_id",d);const{edgeLookup:G,edgeTypes:oe,flowId:ae,elementsSelectable:ve}=Wt();re(l,G,ie=>t(44,a=ie)),re(l,oe,ie=>t(40,f=ie)),re(l,ae,ie=>t(39,u=ie)),re(l,ve,ie=>t(38,c=ie));const $=on(),Ie=Za();function Ne(ie){const Ue=a.get(d);Ue&&(Ie(d),$("edgeclick",{event:ie,edge:Ue}))}function ce(ie,Ue){const et=a.get(d);et&&$(Ue,{event:ie,edge:et})}const Ze=ie=>{ce(ie,"edgecontextmenu")},Qe=ie=>{ce(ie,"edgemouseenter")},ge=ie=>{ce(ie,"edgemouseleave")};return l.$$set=ie=>{"id"in ie&&t(0,d=ie.id),"type"in ie&&t(34,h=ie.type),"source"in ie&&t(1,_=ie.source),"target"in ie&&t(2,b=ie.target),"data"in ie&&t(3,w=ie.data),"style"in ie&&t(4,g=ie.style),"zIndex"in ie&&t(5,v=ie.zIndex),"animated"in ie&&t(6,y=ie.animated),"selected"in ie&&t(7,E=ie.selected),"selectable"in ie&&t(35,z=ie.selectable),"deletable"in ie&&t(8,D=ie.deletable),"hidden"in ie&&t(9,M=ie.hidden),"label"in ie&&t(10,A=ie.label),"labelStyle"in ie&&t(11,O=ie.labelStyle),"markerStart"in ie&&t(36,L=ie.markerStart),"markerEnd"in ie&&t(37,W=ie.markerEnd),"sourceHandle"in ie&&t(12,K=ie.sourceHandle),"targetHandle"in ie&&t(13,R=ie.targetHandle),"sourceX"in ie&&t(14,I=ie.sourceX),"sourceY"in ie&&t(15,P=ie.sourceY),"targetX"in ie&&t(16,N=ie.targetX),"targetY"in ie&&t(17,Y=ie.targetY),"sourcePosition"in ie&&t(18,Z=ie.sourcePosition),"targetPosition"in ie&&t(19,F=ie.targetPosition),"ariaLabel"in ie&&t(20,X=ie.ariaLabel),"interactionWidth"in ie&&t(21,se=ie.interactionWidth),"class"in ie&&t(22,q=ie.class)},l.$$.update=()=>{l.$$.dirty[1]&8&&t(23,n=h||"default"),l.$$.dirty[0]&8388608|l.$$.dirty[1]&512&&t(27,o=f[n]||qa),l.$$.dirty[1]&288&&t(26,s=L?`url('#${ss(L,u)}')`:void 0),l.$$.dirty[1]&320&&t(25,i=W?`url('#${ss(W,u)}')`:void 0),l.$$.dirty[1]&144&&t(24,r=z??c)},[d,_,b,w,g,v,y,E,D,M,A,O,K,R,I,P,N,Y,Z,F,X,se,q,n,r,i,s,o,G,oe,ae,ve,Ne,ce,h,z,L,W,c,u,f,Ze,Qe,ge]}class P1 extends Oe{constructor(e){super(),He(this,e,N1,z1,ca,{id:0,type:34,source:1,target:2,data:3,style:4,zIndex:5,animated:6,selected:7,selectable:35,deletable:8,hidden:9,label:10,labelStyle:11,markerStart:36,markerEnd:37,sourceHandle:12,targetHandle:13,sourceX:14,sourceY:15,targetX:16,targetY:17,sourcePosition:18,targetPosition:19,ariaLabel:20,interactionWidth:21,class:22},null,[-1,-1])}}function O1(l,e,t){let{onMount:n=void 0}=e,{onDestroy:o=void 0}=e;return hn(()=>(n==null||n(),o)),l.$$set=s=>{"onMount"in s&&t(0,n=s.onMount),"onDestroy"in s&&t(1,o=s.onDestroy)},[n,o]}class H1 extends Oe{constructor(e){super(),He(this,e,O1,null,Le,{onMount:0,onDestroy:1})}}function ui(l,e,t){const n=l.slice();return n[2]=e[t],n}function fi(l,e){let t,n,o;const s=[e[2]];let i={};for(let r=0;r<s.length;r+=1)i=vt(i,s[r]);return n=new j1({props:i}),{key:l,first:null,c(){t=Te(),ee(n.$$.fragment),this.h()},l(r){t=Te(),le(n.$$.fragment,r),this.h()},h(){this.first=t},m(r,a){B(r,t,a),te(n,r,a),o=!0},p(r,a){e=r;const c=a&1?xn(s,[Wl(e[2])]):{};n.$set(c)},i(r){o||(C(n.$$.fragment,r),o=!0)},o(r){H(n.$$.fragment,r),o=!1},d(r){r&&p(t),ne(n,r)}}}function A1(l){let e,t=[],n=new Map,o,s=ht(l[0]);const i=r=>r[2].id;for(let r=0;r<s.length;r+=1){let a=ui(l,s,r),c=i(a);n.set(c,t[r]=fi(c,a))}return{c(){e=_e("defs");for(let r=0;r<t.length;r+=1)t[r].c()},l(r){e=be(r,"defs",{});var a=S(e);for(let c=0;c<t.length;c+=1)t[c].l(a);a.forEach(p)},m(r,a){B(r,e,a);for(let c=0;c<t.length;c+=1)t[c]&&t[c].m(e,null);o=!0},p(r,[a]){a&1&&(s=ht(r[0]),Ve(),t=Io(t,a,i,1,r,s,n,e,So,fi,null,ui),ze())},i(r){if(!o){for(let a=0;a<s.length;a+=1)C(t[a]);o=!0}},o(r){for(let a=0;a<t.length;a+=1)H(t[a]);o=!1},d(r){r&&p(e);for(let a=0;a<t.length;a+=1)t[a].d()}}}function L1(l,e,t){let n;const{markers:o}=Wt();return re(l,o,s=>t(0,n=s)),[n,o]}class B1 extends Oe{constructor(e){super(),He(this,e,L1,A1,Le,{})}}function R1(l){let e;return{c(){e=_e("polyline"),this.h()},l(t){e=be(t,"polyline",{stroke:!0,"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,fill:!0,points:!0}),S(e).forEach(p),this.h()},h(){m(e,"stroke",l[6]),m(e,"stroke-linecap","round"),m(e,"stroke-linejoin","round"),m(e,"stroke-width",l[7]),m(e,"fill",l[6]),m(e,"points","-5,-4 0,0 -5,4 -5,-4")},m(t,n){B(t,e,n)},p(t,n){n&64&&m(e,"stroke",t[6]),n&128&&m(e,"stroke-width",t[7]),n&64&&m(e,"fill",t[6])},d(t){t&&p(e)}}}function U1(l){let e;return{c(){e=_e("polyline"),this.h()},l(t){e=be(t,"polyline",{stroke:!0,"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,fill:!0,points:!0}),S(e).forEach(p),this.h()},h(){m(e,"stroke",l[6]),m(e,"stroke-linecap","round"),m(e,"stroke-linejoin","round"),m(e,"stroke-width",l[7]),m(e,"fill","none"),m(e,"points","-5,-4 0,0 -5,4")},m(t,n){B(t,e,n)},p(t,n){n&64&&m(e,"stroke",t[6]),n&128&&m(e,"stroke-width",t[7])},d(t){t&&p(e)}}}function F1(l){let e,t,n;function o(r,a){if(r[1]===bo.Arrow)return U1;if(r[1]===bo.ArrowClosed)return R1}let s=o(l),i=s&&s(l);return{c(){e=_e("marker"),i&&i.c(),this.h()},l(r){e=be(r,"marker",{class:!0,id:!0,markerWidth:!0,markerHeight:!0,viewBox:!0,markerUnits:!0,orient:!0,refX:!0,refY:!0});var a=S(e);i&&i.l(a),a.forEach(p),this.h()},h(){m(e,"class","svelte-flow__arrowhead"),m(e,"id",l[0]),m(e,"markerWidth",t=`${l[2]}`),m(e,"markerHeight",n=`${l[3]}`),m(e,"viewBox","-10 -10 20 20"),m(e,"markerUnits",l[4]),m(e,"orient",l[5]),m(e,"refX","0"),m(e,"refY","0")},m(r,a){B(r,e,a),i&&i.m(e,null)},p(r,[a]){s===(s=o(r))&&i?i.p(r,a):(i&&i.d(1),i=s&&s(r),i&&(i.c(),i.m(e,null))),a&1&&m(e,"id",r[0]),a&4&&t!==(t=`${r[2]}`)&&m(e,"markerWidth",t),a&8&&n!==(n=`${r[3]}`)&&m(e,"markerHeight",n),a&16&&m(e,"markerUnits",r[4]),a&32&&m(e,"orient",r[5])},i:De,o:De,d(r){r&&p(e),i&&i.d()}}}function W1(l,e,t){let{id:n}=e,{type:o}=e,{width:s=12.5}=e,{height:i=12.5}=e,{markerUnits:r="strokeWidth"}=e,{orient:a="auto-start-reverse"}=e,{color:c=void 0}=e,{strokeWidth:u=void 0}=e;return l.$$set=f=>{"id"in f&&t(0,n=f.id),"type"in f&&t(1,o=f.type),"width"in f&&t(2,s=f.width),"height"in f&&t(3,i=f.height),"markerUnits"in f&&t(4,r=f.markerUnits),"orient"in f&&t(5,a=f.orient),"color"in f&&t(6,c=f.color),"strokeWidth"in f&&t(7,u=f.strokeWidth)},[n,o,s,i,r,a,c,u]}class j1 extends Oe{constructor(e){super(),He(this,e,W1,F1,Le,{id:0,type:1,width:2,height:3,markerUnits:4,orient:5,color:6,strokeWidth:7})}}function di(l,e,t){const n=l.slice();return n[14]=e[t],n}function hi(l,e){let t,n,o;return n=new P1({props:{id:e[14].id,source:e[14].source,target:e[14].target,data:e[14].data,style:e[14].style,animated:e[14].animated,selected:e[14].selected,selectable:e[14].selectable??e[1],deletable:e[14].deletable,hidden:e[14].hidden,label:e[14].label,labelStyle:e[14].labelStyle,markerStart:e[14].markerStart,markerEnd:e[14].markerEnd,sourceHandle:e[14].sourceHandle,targetHandle:e[14].targetHandle,sourceX:e[14].sourceX,sourceY:e[14].sourceY,targetX:e[14].targetX,targetY:e[14].targetY,sourcePosition:e[14].sourcePosition,targetPosition:e[14].targetPosition,ariaLabel:e[14].ariaLabel,interactionWidth:e[14].interactionWidth,class:e[14].class,type:e[14].type||"default",zIndex:e[14].zIndex}}),n.$on("edgeclick",e[7]),n.$on("edgecontextmenu",e[8]),n.$on("edgemouseenter",e[9]),n.$on("edgemouseleave",e[10]),{key:l,first:null,c(){t=Te(),ee(n.$$.fragment),this.h()},l(s){t=Te(),le(n.$$.fragment,s),this.h()},h(){this.first=t},m(s,i){B(s,t,i),te(n,s,i),o=!0},p(s,i){e=s;const r={};i&1&&(r.id=e[14].id),i&1&&(r.source=e[14].source),i&1&&(r.target=e[14].target),i&1&&(r.data=e[14].data),i&1&&(r.style=e[14].style),i&1&&(r.animated=e[14].animated),i&1&&(r.selected=e[14].selected),i&3&&(r.selectable=e[14].selectable??e[1]),i&1&&(r.deletable=e[14].deletable),i&1&&(r.hidden=e[14].hidden),i&1&&(r.label=e[14].label),i&1&&(r.labelStyle=e[14].labelStyle),i&1&&(r.markerStart=e[14].markerStart),i&1&&(r.markerEnd=e[14].markerEnd),i&1&&(r.sourceHandle=e[14].sourceHandle),i&1&&(r.targetHandle=e[14].targetHandle),i&1&&(r.sourceX=e[14].sourceX),i&1&&(r.sourceY=e[14].sourceY),i&1&&(r.targetX=e[14].targetX),i&1&&(r.targetY=e[14].targetY),i&1&&(r.sourcePosition=e[14].sourcePosition),i&1&&(r.targetPosition=e[14].targetPosition),i&1&&(r.ariaLabel=e[14].ariaLabel),i&1&&(r.interactionWidth=e[14].interactionWidth),i&1&&(r.class=e[14].class),i&1&&(r.type=e[14].type||"default"),i&1&&(r.zIndex=e[14].zIndex),n.$set(r)},i(s){o||(C(n.$$.fragment,s),o=!0)},o(s){H(n.$$.fragment,s),o=!1},d(s){s&&p(t),ne(n,s)}}}function mi(l){let e,t;return e=new H1({props:{onMount:l[11],onDestroy:l[12]}}),{c(){ee(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,o){te(e,n,o),t=!0},p(n,o){const s={};o&4&&(s.onMount=n[11]),o&4&&(s.onDestroy=n[12]),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}function Y1(l){let e,t,n,o,s=[],i=new Map,r,a;n=new B1({});let c=ht(l[0]);const u=d=>d[14].id;for(let d=0;d<c.length;d+=1){let h=di(l,c,d),_=u(h);i.set(_,s[d]=hi(_,h))}let f=l[0].length>0&&mi(l);return{c(){e=T("div"),t=_e("svg"),ee(n.$$.fragment),o=Q();for(let d=0;d<s.length;d+=1)s[d].c();r=Q(),f&&f.c(),this.h()},l(d){e=V(d,"DIV",{class:!0});var h=S(e);t=be(h,"svg",{class:!0});var _=S(t);le(n.$$.fragment,_),_.forEach(p),o=x(h);for(let b=0;b<s.length;b+=1)s[b].l(h);r=x(h),f&&f.l(h),h.forEach(p),this.h()},h(){m(t,"class","svelte-flow__marker"),m(e,"class","svelte-flow__edges")},m(d,h){B(d,e,h),k(e,t),te(n,t,null),k(e,o);for(let _=0;_<s.length;_+=1)s[_]&&s[_].m(e,null);k(e,r),f&&f.m(e,null),a=!0},p(d,[h]){h&3&&(c=ht(d[0]),Ve(),s=Io(s,h,u,1,d,c,i,e,So,hi,r,di),ze()),d[0].length>0?f?(f.p(d,h),h&1&&C(f,1)):(f=mi(d),f.c(),C(f,1),f.m(e,null)):f&&(Ve(),H(f,1,1,()=>{f=null}),ze())},i(d){if(!a){C(n.$$.fragment,d);for(let h=0;h<c.length;h+=1)C(s[h]);C(f),a=!0}},o(d){H(n.$$.fragment,d);for(let h=0;h<s.length;h+=1)H(s[h]);H(f),a=!1},d(d){d&&p(e),ne(n);for(let h=0;h<s.length;h+=1)s[h].d();f&&f.d()}}}function K1(l,e,t){let n,o,s,{defaultEdgeOptions:i}=e;const{visibleEdges:r,edgesInitialized:a,edges:{setDefaultOptions:c},elementsSelectable:u}=Wt();re(l,r,g=>t(0,n=g)),re(l,a,g=>t(2,s=g)),re(l,u,g=>t(1,o=g)),hn(()=>{i&&c(i)});function f(g){dt.call(this,l,g)}function d(g){dt.call(this,l,g)}function h(g){dt.call(this,l,g)}function _(g){dt.call(this,l,g)}const b=()=>{ho(a,s=!0,s)},w=()=>{ho(a,s=!1,s)};return l.$$set=g=>{"defaultEdgeOptions"in g&&t(6,i=g.defaultEdgeOptions)},[n,o,s,r,a,u,i,f,d,h,_,b,w]}class G1 extends Oe{constructor(e){super(),He(this,e,K1,Y1,Le,{defaultEdgeOptions:6})}}function gi(l){let e;return{c(){e=T("div"),this.h()},l(t){e=V(t,"DIV",{class:!0}),S(e).forEach(p),this.h()},h(){m(e,"class","svelte-flow__selection svelte-1iugwpu"),$e(e,"width",typeof l[2]=="string"?l[2]:`${l[2]}px`),$e(e,"height",typeof l[3]=="string"?l[3]:`${l[3]}px`),$e(e,"transform",`translate(${l[0]}px, ${l[1]}px)`)},m(t,n){B(t,e,n)},p(t,n){n&4&&$e(e,"width",typeof t[2]=="string"?t[2]:`${t[2]}px`),n&8&&$e(e,"height",typeof t[3]=="string"?t[3]:`${t[3]}px`),n&3&&$e(e,"transform",`translate(${t[0]}px, ${t[1]}px)`)},d(t){t&&p(e)}}}function X1(l){let e,t=l[4]&&gi(l);return{c(){t&&t.c(),e=Te()},l(n){t&&t.l(n),e=Te()},m(n,o){t&&t.m(n,o),B(n,e,o)},p(n,[o]){n[4]?t?t.p(n,o):(t=gi(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:De,o:De,d(n){n&&p(e),t&&t.d(n)}}}function Z1(l,e,t){let{x:n=0}=e,{y:o=0}=e,{width:s=0}=e,{height:i=0}=e,{isVisible:r=!0}=e;return l.$$set=a=>{"x"in a&&t(0,n=a.x),"y"in a&&t(1,o=a.y),"width"in a&&t(2,s=a.width),"height"in a&&t(3,i=a.height),"isVisible"in a&&t(4,r=a.isVisible)},[n,o,s,i,r]}class ec extends Oe{constructor(e){super(),He(this,e,Z1,X1,Le,{x:0,y:1,width:2,height:3,isVisible:4})}}function q1(l){var n,o,s,i;let e,t;return e=new ec({props:{isVisible:!!(l[0]&&l[1]==="user"),width:(n=l[0])==null?void 0:n.width,height:(o=l[0])==null?void 0:o.height,x:(s=l[0])==null?void 0:s.x,y:(i=l[0])==null?void 0:i.y}}),{c(){ee(e.$$.fragment)},l(r){le(e.$$.fragment,r)},m(r,a){te(e,r,a),t=!0},p(r,[a]){var u,f,d,h;const c={};a&3&&(c.isVisible=!!(r[0]&&r[1]==="user")),a&1&&(c.width=(u=r[0])==null?void 0:u.width),a&1&&(c.height=(f=r[0])==null?void 0:f.height),a&1&&(c.x=(d=r[0])==null?void 0:d.x),a&1&&(c.y=(h=r[0])==null?void 0:h.y),e.$set(c)},i(r){t||(C(e.$$.fragment,r),t=!0)},o(r){H(e.$$.fragment,r),t=!1},d(r){ne(e,r)}}}function J1(l,e,t){let n,o;const{selectionRect:s,selectionRectMode:i}=Wt();return re(l,s,r=>t(0,n=r)),re(l,i,r=>t(1,o=r)),[n,o,s,i]}class Q1 extends Oe{constructor(e){super(),He(this,e,J1,q1,Le,{})}}function pi(l){let e,t,n,o,s;return t=new ec({props:{width:"100%",height:"100%",x:0,y:0}}),{c(){e=T("div"),ee(t.$$.fragment),this.h()},l(i){e=V(i,"DIV",{class:!0,style:!0,role:!0,tabindex:!0});var r=S(e);le(t.$$.fragment,r),r.forEach(p),this.h()},h(){m(e,"class","selection-wrapper nopan svelte-5pxri"),$e(e,"width",l[1].width+"px"),$e(e,"height",l[1].height+"px"),$e(e,"transform","translate("+l[1].x+"px, "+l[1].y+"px)"),m(e,"role","button"),m(e,"tabindex","-1")},m(i,r){B(i,e,r),te(t,e,null),n=!0,o||(s=[gn($a.call(null,e,{disabled:!1,store:l[2],onDrag:l[11],onDragStart:l[12],onDragStop:l[13]})),Se(e,"contextmenu",l[7]),Se(e,"click",l[8]),Se(e,"keyup",$1)],o=!0)},p(i,r){(!n||r&2)&&$e(e,"width",i[1].width+"px"),(!n||r&2)&&$e(e,"height",i[1].height+"px"),(!n||r&2)&&$e(e,"transform","translate("+i[1].x+"px, "+i[1].y+"px)")},i(i){n||(C(t.$$.fragment,i),n=!0)},o(i){H(t.$$.fragment,i),n=!1},d(i){i&&p(e),ne(t),o=!1,sn(s)}}}function x1(l){let e=l[0]==="nodes"&&l[1]&&Vn(l[1].x)&&Vn(l[1].y),t,n,o=e&&pi(l);return{c(){o&&o.c(),t=Te()},l(s){o&&o.l(s),t=Te()},m(s,i){o&&o.m(s,i),B(s,t,i),n=!0},p(s,[i]){i&3&&(e=s[0]==="nodes"&&s[1]&&Vn(s[1].x)&&Vn(s[1].y)),e?o?(o.p(s,i),i&3&&C(o,1)):(o=pi(s),o.c(),C(o,1),o.m(t.parentNode,t)):o&&(Ve(),H(o,1,1,()=>{o=null}),ze())},i(s){n||(C(o),n=!0)},o(s){H(o),n=!1},d(s){s&&p(t),o&&o.d(s)}}}const $1=()=>{};function eg(l,e,t){let n,o,s;const i=Wt(),{selectionRectMode:r,nodes:a,nodeLookup:c}=i;re(l,r,g=>t(0,s=g)),re(l,a,g=>t(9,n=g)),re(l,c,g=>t(10,o=g));const u=on();let f=null;function d(g){const v=n.filter(y=>y.selected);u("selectioncontextmenu",{nodes:v,event:g})}function h(g){const v=n.filter(y=>y.selected);u("selectionclick",{nodes:v,event:g})}const _=(g,v,y,E)=>{u("nodedrag",{event:g,targetNode:null,nodes:E})},b=(g,v,y,E)=>{u("nodedragstart",{event:g,targetNode:null,nodes:E})},w=(g,v,y,E)=>{u("nodedragstop",{event:g,targetNode:null,nodes:E})};return l.$$.update=()=>{l.$$.dirty&1537&&s==="nodes"&&t(1,f=Po(o,{filter:g=>!!g.selected}))},[s,f,i,r,a,c,u,d,h,n,o,_,b,w]}class tg extends Oe{constructor(e){super(),He(this,e,eg,x1,Le,{})}}function On(l,e){let{enabled:t=!0,trigger:n,type:o="keydown"}=e;function s(i){const r=Array.isArray(n)?n:[n],a={alt:i.altKey,ctrl:i.ctrlKey,shift:i.shiftKey,meta:i.metaKey};for(const c of r){const u={modifier:[],preventDefault:!1,enabled:!0,...c},{modifier:f,key:d,callback:h,preventDefault:_,enabled:b}=u;if(b){if(f.length&&!(Array.isArray(f)?f:[f]).map(v=>typeof v=="string"?[v]:v).some(v=>v.every(y=>a[y])))continue;if(i.key===d){_&&i.preventDefault();const w={node:l,trigger:u,originalEvent:i};l.dispatchEvent(new CustomEvent("shortcut",{detail:w})),h==null||h(w)}}}}return t&&l.addEventListener(o,s),{update:i=>{const{enabled:r=!0,type:a="keydown"}=i;t&&(!r||o!==a)?l.removeEventListener(o,s):!t&&r&&l.addEventListener(a,s),t=r,o=a,n=i.trigger},destroy:()=>{l.removeEventListener(o,s)}}}function ng(l){let e,t,n,o,s,i,r,a,c,u,f,d;return{c:De,l:De,m(h,_){f||(d=[gn(e=On.call(null,window,{trigger:Xt(l[0],l[11]),type:"keydown"})),gn(t=On.call(null,window,{trigger:Xt(l[0],l[12]),type:"keyup"})),gn(n=On.call(null,window,{trigger:Xt(l[1],l[13]),type:"keydown"})),gn(o=On.call(null,window,{trigger:Xt(l[1],l[14]),type:"keyup"})),gn(s=On.call(null,window,{trigger:Xt(l[2],l[15]),type:"keydown"})),gn(i=On.call(null,window,{trigger:Xt(l[2],l[16]),type:"keyup"})),gn(r=On.call(null,window,{trigger:Xt(l[3],l[17]),type:"keydown"})),gn(a=On.call(null,window,{trigger:Xt(l[3],l[18]),type:"keyup"})),gn(c=On.call(null,window,{trigger:Xt(l[4],l[19]),type:"keydown"})),gn(u=On.call(null,window,{trigger:Xt(l[4],l[20]),type:"keyup"})),Se(window,"blur",l[10]),Se(window,"contextmenu",l[10])],f=!0)},p(h,[_]){e&&ln(e.update)&&_&1&&e.update.call(null,{trigger:Xt(h[0],h[11]),type:"keydown"}),t&&ln(t.update)&&_&1&&t.update.call(null,{trigger:Xt(h[0],h[12]),type:"keyup"}),n&&ln(n.update)&&_&2&&n.update.call(null,{trigger:Xt(h[1],h[13]),type:"keydown"}),o&&ln(o.update)&&_&2&&o.update.call(null,{trigger:Xt(h[1],h[14]),type:"keyup"}),s&&ln(s.update)&&_&4&&s.update.call(null,{trigger:Xt(h[2],h[15]),type:"keydown"}),i&&ln(i.update)&&_&4&&i.update.call(null,{trigger:Xt(h[2],h[16]),type:"keyup"}),r&&ln(r.update)&&_&8&&r.update.call(null,{trigger:Xt(h[3],h[17]),type:"keydown"}),a&&ln(a.update)&&_&8&&a.update.call(null,{trigger:Xt(h[3],h[18]),type:"keyup"}),c&&ln(c.update)&&_&16&&c.update.call(null,{trigger:Xt(h[4],h[19]),type:"keydown"}),u&&ln(u.update)&&_&16&&u.update.call(null,{trigger:Xt(h[4],h[20]),type:"keyup"})},i:De,o:De,d(h){f=!1,sn(d)}}}function tc(l){return l!==null&&typeof l=="object"}function lg(l){return tc(l)?l.modifier||[]:[]}function og(l){return l==null?"":tc(l)?l.key:l}function Xt(l,e){return(Array.isArray(l)?l:[l]).map(n=>{const o=og(n);return{key:o,modifier:lg(n),enabled:o!==null,callback:e}})}function sg(l,e,t){let{selectionKey:n="Shift"}=e,{multiSelectionKey:o=wo()?"Meta":"Control"}=e,{deleteKey:s="Backspace"}=e,{panActivationKey:i=" "}=e,{zoomActivationKey:r=wo()?"Meta":"Control"}=e;const{selectionKeyPressed:a,multiselectionKeyPressed:c,deleteKeyPressed:u,panActivationKeyPressed:f,zoomActivationKeyPressed:d,selectionRect:h}=Wt();function _(){h.set(null),a.set(!1),c.set(!1),u.set(!1),f.set(!1),d.set(!1)}const b=()=>a.set(!0),w=()=>a.set(!1),g=()=>c.set(!0),v=()=>c.set(!1),y=O=>{!(O.originalEvent.ctrlKey||O.originalEvent.metaKey||O.originalEvent.shiftKey)&&!Wh(O.originalEvent)&&u.set(!0)},E=()=>u.set(!1),z=()=>f.set(!0),D=()=>f.set(!1),M=()=>d.set(!0),A=()=>d.set(!1);return l.$$set=O=>{"selectionKey"in O&&t(0,n=O.selectionKey),"multiSelectionKey"in O&&t(1,o=O.multiSelectionKey),"deleteKey"in O&&t(2,s=O.deleteKey),"panActivationKey"in O&&t(3,i=O.panActivationKey),"zoomActivationKey"in O&&t(4,r=O.zoomActivationKey)},[n,o,s,i,r,a,c,u,f,d,_,b,w,g,v,y,E,z,D,M,A]}class rg extends Oe{constructor(e){super(),He(this,e,sg,ng,Le,{selectionKey:0,multiSelectionKey:1,deleteKey:2,panActivationKey:3,zoomActivationKey:4})}}const ig=l=>({}),_i=l=>({});function bi(l){let e,t,n,o;const s=l[13].connectionLine,i=Qt(s,l,l[12],_i);let r=!l[2]&&vi(l);return{c(){e=_e("svg"),t=_e("g"),i&&i.c(),r&&r.c(),this.h()},l(a){e=be(a,"svg",{width:!0,height:!0,class:!0,style:!0});var c=S(e);t=be(c,"g",{class:!0});var u=S(t);i&&i.l(u),r&&r.l(u),u.forEach(p),c.forEach(p),this.h()},h(){m(t,"class",n=Nt(["svelte-flow__connection",Wr(l[3].isValid)])),m(e,"width",l[5]),m(e,"height",l[6]),m(e,"class","svelte-flow__connectionline"),m(e,"style",l[0])},m(a,c){B(a,e,c),k(e,t),i&&i.m(t,null),r&&r.m(t,null),o=!0},p(a,c){i&&i.p&&(!o||c&4096)&&xt(i,s,a,a[12],o?en(s,a[12],c,ig):$t(a[12]),_i),a[2]?r&&(r.d(1),r=null):r?r.p(a,c):(r=vi(a),r.c(),r.m(t,null)),(!o||c&8&&n!==(n=Nt(["svelte-flow__connection",Wr(a[3].isValid)])))&&m(t,"class",n),(!o||c&32)&&m(e,"width",a[5]),(!o||c&64)&&m(e,"height",a[6]),(!o||c&1)&&m(e,"style",a[0])},i(a){o||(C(i,a),o=!0)},o(a){H(i,a),o=!1},d(a){a&&p(e),i&&i.d(a),r&&r.d()}}}function vi(l){let e;return{c(){e=_e("path"),this.h()},l(t){e=be(t,"path",{d:!0,style:!0,fill:!0,class:!0}),S(e).forEach(p),this.h()},h(){m(e,"d",l[4]),m(e,"style",l[1]),m(e,"fill","none"),m(e,"class","svelte-flow__connection-path")},m(t,n){B(t,e,n)},p(t,n){n&16&&m(e,"d",t[4]),n&2&&m(e,"style",t[1])},d(t){t&&p(e)}}}function ag(l){let e,t,n=l[3].inProgress&&bi(l);return{c(){n&&n.c(),e=Te()},l(o){n&&n.l(o),e=Te()},m(o,s){n&&n.m(o,s),B(o,e,s),t=!0},p(o,[s]){o[3].inProgress?n?(n.p(o,s),s&8&&C(n,1)):(n=bi(o),n.c(),C(n,1),n.m(e.parentNode,e)):n&&(Ve(),H(n,1,1,()=>{n=null}),ze())},i(o){t||(C(n),t=!0)},o(o){H(n),t=!1},d(o){o&&p(e),n&&n.d(o)}}}function cg(l,e,t){let n,o,s,i,{$$slots:r={},$$scope:a}=e,{containerStyle:c=""}=e,{style:u=""}=e,{isCustomComponent:f=!1}=e;const{width:d,height:h,connection:_,connectionLineType:b}=Wt();re(l,d,g=>t(5,s=g)),re(l,h,g=>t(6,i=g)),re(l,_,g=>t(3,o=g)),re(l,b,g=>t(11,n=g));let w=null;return l.$$set=g=>{"containerStyle"in g&&t(0,c=g.containerStyle),"style"in g&&t(1,u=g.style),"isCustomComponent"in g&&t(2,f=g.isCustomComponent),"$$scope"in g&&t(12,a=g.$$scope)},l.$$.update=()=>{if(l.$$.dirty&2060&&o.inProgress&&!f){const{from:g,to:v,fromPosition:y,toPosition:E}=o,z={sourceX:g.x,sourceY:g.y,sourcePosition:y,targetX:v.x,targetY:v.y,targetPosition:E};switch(n){case wl.Bezier:t(4,[w]=za(z),w);break;case wl.Step:t(4,[w]=yo({...z,borderRadius:0}),w);break;case wl.SmoothStep:t(4,[w]=yo(z),w);break;default:t(4,[w]=Pa(z),w)}}},[c,u,f,o,w,s,i,d,h,_,b,n,a,r]}class ug extends Oe{constructor(e){super(),He(this,e,cg,ag,Le,{containerStyle:0,style:1,isCustomComponent:2})}}function fg(l){let e,t,n;const o=l[8].default,s=Qt(o,l,l[7],null);let i=[{class:t=Nt(["svelte-flow__panel",l[1],...l[2]])},{style:l[0]},l[5]],r={};for(let a=0;a<i.length;a+=1)r=vt(r,i[a]);return{c(){e=T("div"),s&&s.c(),this.h()},l(a){e=V(a,"DIV",{class:!0,style:!0});var c=S(e);s&&s.l(c),c.forEach(p),this.h()},h(){yl(e,r),$e(e,"pointer-events",l[3]?"none":"")},m(a,c){B(a,e,c),s&&s.m(e,null),n=!0},p(a,[c]){s&&s.p&&(!n||c&128)&&xt(s,o,a,a[7],n?en(o,a[7],c,null):$t(a[7]),null),yl(e,r=xn(i,[(!n||c&6&&t!==(t=Nt(["svelte-flow__panel",a[1],...a[2]])))&&{class:t},(!n||c&1)&&{style:a[0]},c&32&&a[5]])),$e(e,"pointer-events",a[3]?"none":"")},i(a){n||(C(s,a),n=!0)},o(a){H(s,a),n=!1},d(a){a&&p(e),s&&s.d(a)}}}function dg(l,e,t){let n;const o=["position","style","class"];let s=Ut(e,o),i,{$$slots:r={},$$scope:a}=e,{position:c="top-right"}=e,{style:u=void 0}=e,{class:f=void 0}=e;const{selectionRectMode:d}=Wt();return re(l,d,h=>t(3,i=h)),l.$$set=h=>{e=vt(vt({},e),zn(h)),t(5,s=Ut(e,o)),"position"in h&&t(6,c=h.position),"style"in h&&t(0,u=h.style),"class"in h&&t(1,f=h.class),"$$scope"in h&&t(7,a=h.$$scope)},l.$$.update=()=>{l.$$.dirty&64&&t(2,n=`${c}`.split("-"))},[u,f,n,i,d,s,c,a,r]}class nc extends Oe{constructor(e){super(),He(this,e,dg,fg,Le,{position:6,style:0,class:1})}}function wi(l){let e,t;return e=new nc({props:{position:l[1],class:"svelte-flow__attribution","data-message":"Feel free to remove the attribution or check out how you could support us: https://svelteflow.dev/support-us",$$slots:{default:[hg]},$$scope:{ctx:l}}}),{c(){ee(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,o){te(e,n,o),t=!0},p(n,o){const s={};o&2&&(s.position=n[1]),o&4&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}function hg(l){let e,t="Svelte Flow";return{c(){e=T("a"),e.textContent=t,this.h()},l(n){e=V(n,"A",{href:!0,target:!0,rel:!0,"aria-label":!0,"data-svelte-h":!0}),it(e)!=="svelte-2vm8e4"&&(e.textContent=t),this.h()},h(){m(e,"href","https://svelteflow.dev"),m(e,"target","_blank"),m(e,"rel","noopener noreferrer"),m(e,"aria-label","Svelte Flow attribution")},m(n,o){B(n,e,o)},p:De,d(n){n&&p(e)}}}function mg(l){var o;let e,t,n=!((o=l[0])!=null&&o.hideAttribution)&&wi(l);return{c(){n&&n.c(),e=Te()},l(s){n&&n.l(s),e=Te()},m(s,i){n&&n.m(s,i),B(s,e,i),t=!0},p(s,[i]){var r;(r=s[0])!=null&&r.hideAttribution?n&&(Ve(),H(n,1,1,()=>{n=null}),ze()):n?(n.p(s,i),i&1&&C(n,1)):(n=wi(s),n.c(),C(n,1),n.m(e.parentNode,e))},i(s){t||(C(n),t=!0)},o(s){H(n),t=!1},d(s){s&&p(e),n&&n.d(s)}}}function gg(l,e,t){let{proOptions:n=void 0}=e,{position:o="bottom-right"}=e;return l.$$set=s=>{"proOptions"in s&&t(0,n=s.proOptions),"position"in s&&t(1,o=s.position)},[n,o]}class pg extends Oe{constructor(e){super(),He(this,e,gg,mg,Le,{proOptions:0,position:1})}}function yi(l,{nodeTypes:e,edgeTypes:t,minZoom:n,maxZoom:o,translateExtent:s,paneClickDistance:i}){e!==void 0&&l.setNodeTypes(e),t!==void 0&&l.setEdgeTypes(t),n!==void 0&&l.setMinZoom(n),o!==void 0&&l.setMaxZoom(o),s!==void 0&&l.setTranslateExtent(s),i!==void 0&&l.setPaneClickDistance(i)}const _g=l=>Object.keys(l);function bg(l,e){_g(e).forEach(t=>{const n=e[t];n!==void 0&&l[t].set(n)})}function vg(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function wg(l="light"){return Mn("light",t=>{if(l!=="system"){t(l);return}const n=vg(),o=()=>t(n!=null&&n.matches?"dark":"light");return t(n!=null&&n.matches?"dark":"light"),n==null||n.addEventListener("change",o),()=>{n==null||n.removeEventListener("change",o)}})}const yg=l=>({}),ki=l=>({slot:"connectionLine"});function kg(l){let e;const t=l[75].connectionLine,n=Qt(t,l,l[99],ki);return{c(){n&&n.c()},l(o){n&&n.l(o)},m(o,s){n&&n.m(o,s),e=!0},p(o,s){n&&n.p&&(!e||s[3]&64)&&xt(n,t,o,o[99],e?en(t,o[99],s,yg):$t(o[99]),ki)},i(o){e||(C(n,o),e=!0)},o(o){H(n,o),e=!1},d(o){n&&n.d(o)}}}function Eg(l){let e,t,n,o,s,i,r,a,c,u,f,d;return e=new G1({props:{defaultEdgeOptions:l[21]}}),e.$on("edgeclick",l[78]),e.$on("edgecontextmenu",l[79]),e.$on("edgemouseenter",l[80]),e.$on("edgemouseleave",l[81]),n=new ug({props:{containerStyle:l[7],style:l[6],isCustomComponent:l[34].connectionLine,$$slots:{connectionLine:[kg]},$$scope:{ctx:l}}}),c=new V1({props:{nodeClickDistance:l[23]}}),c.$on("nodeclick",l[82]),c.$on("nodemouseenter",l[83]),c.$on("nodemousemove",l[84]),c.$on("nodemouseleave",l[85]),c.$on("nodedragstart",l[86]),c.$on("nodedrag",l[87]),c.$on("nodedragstop",l[88]),c.$on("nodecontextmenu",l[89]),f=new tg({}),f.$on("selectionclick",l[90]),f.$on("selectioncontextmenu",l[91]),f.$on("nodedragstart",l[92]),f.$on("nodedrag",l[93]),f.$on("nodedragstop",l[94]),{c(){ee(e.$$.fragment),t=Q(),ee(n.$$.fragment),o=Q(),s=T("div"),i=Q(),r=T("div"),a=Q(),ee(c.$$.fragment),u=Q(),ee(f.$$.fragment),this.h()},l(h){le(e.$$.fragment,h),t=x(h),le(n.$$.fragment,h),o=x(h),s=V(h,"DIV",{class:!0}),S(s).forEach(p),i=x(h),r=V(h,"DIV",{class:!0}),S(r).forEach(p),a=x(h),le(c.$$.fragment,h),u=x(h),le(f.$$.fragment,h),this.h()},h(){m(s,"class","svelte-flow__edgelabel-renderer"),m(r,"class","svelte-flow__viewport-portal")},m(h,_){te(e,h,_),B(h,t,_),te(n,h,_),B(h,o,_),B(h,s,_),B(h,i,_),B(h,r,_),B(h,a,_),te(c,h,_),B(h,u,_),te(f,h,_),d=!0},p(h,_){const b={};_[0]&2097152&&(b.defaultEdgeOptions=h[21]),e.$set(b);const w={};_[0]&128&&(w.containerStyle=h[7]),_[0]&64&&(w.style=h[6]),_[1]&8&&(w.isCustomComponent=h[34].connectionLine),_[3]&64&&(w.$$scope={dirty:_,ctx:h}),n.$set(w);const g={};_[0]&8388608&&(g.nodeClickDistance=h[23]),c.$set(g)},i(h){d||(C(e.$$.fragment,h),C(n.$$.fragment,h),C(c.$$.fragment,h),C(f.$$.fragment,h),d=!0)},o(h){H(e.$$.fragment,h),H(n.$$.fragment,h),H(c.$$.fragment,h),H(f.$$.fragment,h),d=!1},d(h){h&&(p(t),p(o),p(s),p(i),p(r),p(a),p(u)),ne(e,h),ne(n,h),ne(c,h),ne(f,h)}}}function Ig(l){let e,t,n,o;return e=new k1({props:{$$slots:{default:[Eg]},$$scope:{ctx:l}}}),n=new Q1({}),{c(){ee(e.$$.fragment),t=Q(),ee(n.$$.fragment)},l(s){le(e.$$.fragment,s),t=x(s),le(n.$$.fragment,s)},m(s,i){te(e,s,i),B(s,t,i),te(n,s,i),o=!0},p(s,i){const r={};i[0]&10485952|i[1]&8|i[3]&64&&(r.$$scope={dirty:i,ctx:s}),e.$set(r)},i(s){o||(C(e.$$.fragment,s),C(n.$$.fragment,s),o=!0)},o(s){H(e.$$.fragment,s),H(n.$$.fragment,s),o=!1},d(s){s&&p(t),ne(e,s),ne(n,s)}}}function Sg(l){let e,t;return e=new v1({props:{panOnDrag:l[17]===void 0?!0:l[17],selectionOnDrag:l[18],$$slots:{default:[Ig]},$$scope:{ctx:l}}}),e.$on("paneclick",l[95]),e.$on("panecontextmenu",l[96]),{c(){ee(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,o){te(e,n,o),t=!0},p(n,o){const s={};o[0]&131072&&(s.panOnDrag=n[17]===void 0?!0:n[17]),o[0]&262144&&(s.selectionOnDrag=n[18]),o[0]&10485952|o[1]&8|o[3]&64&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}function Dg(l){let e,t,n,o,s,i,r,a,c,u,f,d;t=new rg({props:{selectionKey:l[1],deleteKey:l[5],panActivationKey:l[2],multiSelectionKey:l[3],zoomActivationKey:l[4]}}),o=new p1({props:{initialViewport:l[31],onMoveStart:l[8],onMove:l[9],onMoveEnd:l[10],panOnScrollMode:l[11]===void 0?Bn.Free:l[11],preventScrolling:l[12]===void 0?!0:l[12],zoomOnScroll:l[13]===void 0?!0:l[13],zoomOnDoubleClick:l[14]===void 0?!0:l[14],zoomOnPinch:l[15]===void 0?!0:l[15],panOnScroll:l[16]===void 0?!1:l[16],panOnDrag:l[17]===void 0?!0:l[17],paneClickDistance:l[22]===void 0?0:l[22],$$slots:{default:[Sg]},$$scope:{ctx:l}}}),i=new pg({props:{proOptions:l[20],position:l[19]}});const h=l[75].default,_=Qt(h,l,l[99],null);let b=[{style:l[24]},{class:a=Nt(["svelte-flow",l[25],l[30]])},{"data-testid":"svelte-flow__wrapper"},l[33],{role:"application"}],w={};for(let g=0;g<b.length;g+=1)w=vt(w,b[g]);return{c(){e=T("div"),ee(t.$$.fragment),n=Q(),ee(o.$$.fragment),s=Q(),ee(i.$$.fragment),r=Q(),_&&_.c(),this.h()},l(g){e=V(g,"DIV",{style:!0,class:!0,"data-testid":!0,role:!0});var v=S(e);le(t.$$.fragment,v),n=x(v),le(o.$$.fragment,v),s=x(v),le(i.$$.fragment,v),r=x(v),_&&_.l(v),v.forEach(p),this.h()},h(){yl(e,w),ul(()=>l[98].call(e)),lt(e,"svelte-12wlba6",!0)},m(g,v){B(g,e,v),te(t,e,null),k(e,n),te(o,e,null),k(e,s),te(i,e,null),k(e,r),_&&_.m(e,null),l[97](e),c=ic(e,l[98].bind(e)),u=!0,f||(d=[Se(e,"dragover",l[76]),Se(e,"drop",l[77])],f=!0)},p(g,v){const y={};v[0]&2&&(y.selectionKey=g[1]),v[0]&32&&(y.deleteKey=g[5]),v[0]&4&&(y.panActivationKey=g[2]),v[0]&8&&(y.multiSelectionKey=g[3]),v[0]&16&&(y.zoomActivationKey=g[4]),t.$set(y);const E={};v[0]&256&&(E.onMoveStart=g[8]),v[0]&512&&(E.onMove=g[9]),v[0]&1024&&(E.onMoveEnd=g[10]),v[0]&2048&&(E.panOnScrollMode=g[11]===void 0?Bn.Free:g[11]),v[0]&4096&&(E.preventScrolling=g[12]===void 0?!0:g[12]),v[0]&8192&&(E.zoomOnScroll=g[13]===void 0?!0:g[13]),v[0]&16384&&(E.zoomOnDoubleClick=g[14]===void 0?!0:g[14]),v[0]&32768&&(E.zoomOnPinch=g[15]===void 0?!0:g[15]),v[0]&65536&&(E.panOnScroll=g[16]===void 0?!1:g[16]),v[0]&131072&&(E.panOnDrag=g[17]===void 0?!0:g[17]),v[0]&4194304&&(E.paneClickDistance=g[22]===void 0?0:g[22]),v[0]&10879168|v[1]&8|v[3]&64&&(E.$$scope={dirty:v,ctx:g}),o.$set(E);const z={};v[0]&1048576&&(z.proOptions=g[20]),v[0]&524288&&(z.position=g[19]),i.$set(z),_&&_.p&&(!u||v[3]&64)&&xt(_,h,g,g[99],u?en(h,g[99],v,null):$t(g[99]),null),yl(e,w=xn(b,[(!u||v[0]&16777216)&&{style:g[24]},(!u||v[0]&1107296256&&a!==(a=Nt(["svelte-flow",g[25],g[30]])))&&{class:a},{"data-testid":"svelte-flow__wrapper"},v[1]&4&&g[33],{role:"application"}])),lt(e,"svelte-12wlba6",!0)},i(g){u||(C(t.$$.fragment,g),C(o.$$.fragment,g),C(i.$$.fragment,g),C(_,g),u=!0)},o(g){H(t.$$.fragment,g),H(o.$$.fragment,g),H(i.$$.fragment,g),H(_,g),u=!1},d(g){g&&p(e),ne(t),ne(o),ne(i),_&&_.d(g),l[97](null),c(),f=!1,sn(d)}}}function Cg(l,e,t){let n;const o=["id","nodes","edges","fitView","fitViewOptions","minZoom","maxZoom","initialViewport","viewport","nodeTypes","edgeTypes","selectionKey","selectionMode","panActivationKey","multiSelectionKey","zoomActivationKey","nodesDraggable","nodesConnectable","nodeDragThreshold","elementsSelectable","snapGrid","deleteKey","connectionRadius","connectionLineType","connectionMode","connectionLineStyle","connectionLineContainerStyle","onMoveStart","onMove","onMoveEnd","isValidConnection","translateExtent","nodeExtent","onlyRenderVisibleElements","panOnScrollMode","preventScrolling","zoomOnScroll","zoomOnDoubleClick","zoomOnPinch","panOnScroll","panOnDrag","selectionOnDrag","autoPanOnConnect","autoPanOnNodeDrag","onerror","ondelete","onedgecreate","attributionPosition","proOptions","defaultEdgeOptions","width","height","colorMode","onconnect","onconnectstart","onconnectend","onbeforedelete","oninit","nodeOrigin","paneClickDistance","nodeClickDistance","defaultMarkerColor","style","class"];let s=Ut(e,o),i,r,a=De,c=()=>(a(),a=Es(A,J=>t(100,r=J)),A),u,f=De,d=()=>(f(),f=Es(n,J=>t(30,u=J)),n);l.$$.on_destroy.push(()=>a()),l.$$.on_destroy.push(()=>f());let{$$slots:h={},$$scope:_}=e;const b=ac(h);let{id:w="1"}=e,{nodes:g}=e,{edges:v}=e,{fitView:y=void 0}=e,{fitViewOptions:E=void 0}=e,{minZoom:z=void 0}=e,{maxZoom:D=void 0}=e,{initialViewport:M=void 0}=e,{viewport:A=void 0}=e;c();let{nodeTypes:O=void 0}=e,{edgeTypes:L=void 0}=e,{selectionKey:W=void 0}=e,{selectionMode:K=void 0}=e,{panActivationKey:R=void 0}=e,{multiSelectionKey:I=void 0}=e,{zoomActivationKey:P=void 0}=e,{nodesDraggable:N=void 0}=e,{nodesConnectable:Y=void 0}=e,{nodeDragThreshold:Z=void 0}=e,{elementsSelectable:F=void 0}=e,{snapGrid:X=void 0}=e,{deleteKey:se=void 0}=e,{connectionRadius:q=void 0}=e,{connectionLineType:G=void 0}=e,{connectionMode:oe=dl.Strict}=e,{connectionLineStyle:ae=""}=e,{connectionLineContainerStyle:ve=""}=e,{onMoveStart:$=void 0}=e,{onMove:Ie=void 0}=e,{onMoveEnd:Ne=void 0}=e,{isValidConnection:ce=void 0}=e,{translateExtent:Ze=void 0}=e,{nodeExtent:Qe=void 0}=e,{onlyRenderVisibleElements:ge=void 0}=e,{panOnScrollMode:ie=Bn.Free}=e,{preventScrolling:Ue=!0}=e,{zoomOnScroll:et=!0}=e,{zoomOnDoubleClick:at=!0}=e,{zoomOnPinch:_t=!0}=e,{panOnScroll:nt=!1}=e,{panOnDrag:mt=!0}=e,{selectionOnDrag:jt=void 0}=e,{autoPanOnConnect:Ht=!0}=e,{autoPanOnNodeDrag:gt=!0}=e,{onerror:At=void 0}=e,{ondelete:me=void 0}=e,{onedgecreate:Lt=void 0}=e,{attributionPosition:Et=void 0}=e,{proOptions:Ct=void 0}=e,{defaultEdgeOptions:Pe=void 0}=e,{width:qt=void 0}=e,{height:It=void 0}=e,{colorMode:fe="light"}=e,{onconnect:We=void 0}=e,{onconnectstart:Be=void 0}=e,{onconnectend:Je=void 0}=e,{onbeforedelete:wt=void 0}=e,{oninit:bt=void 0}=e,{nodeOrigin:Mt=void 0}=e,{paneClickDistance:Tt=0}=e,{nodeClickDistance:rn=0}=e,{defaultMarkerColor:Bt="#b1b1b7"}=e,{style:Rt=void 0}=e,{class:Yt=void 0}=e,Kt,tn,an;const Pt=r||M,yt=cc(Bo)?Wt():d1({nodes:de(g),edges:de(v),width:qt,height:It,fitView:y,nodeOrigin:Mt,nodeExtent:Qe});hn(()=>(yt.width.set(tn),yt.height.set(an),yt.domNode.set(Kt),yt.syncNodeStores(g),yt.syncEdgeStores(v),yt.syncViewport(A),y!==void 0&&yt.fitViewOnInit.set(y),E&&yt.fitViewOptions.set(E),yi(yt,{nodeTypes:O,edgeTypes:L,minZoom:z,maxZoom:D,translateExtent:Ze,paneClickDistance:Tt}),()=>{yt.reset()}));const{initialized:wn}=yt;re(l,wn,J=>t(74,i=J));let mn=!1;function yn(J){dt.call(this,l,J)}function Sn(J){dt.call(this,l,J)}function Nn(J){dt.call(this,l,J)}function j(J){dt.call(this,l,J)}function we(J){dt.call(this,l,J)}function Fe(J){dt.call(this,l,J)}function qe(J){dt.call(this,l,J)}function Me(J){dt.call(this,l,J)}function Ye(J){dt.call(this,l,J)}function Dt(J){dt.call(this,l,J)}function rt(J){dt.call(this,l,J)}function cn(J){dt.call(this,l,J)}function Gt(J){dt.call(this,l,J)}function un(J){dt.call(this,l,J)}function nn(J){dt.call(this,l,J)}function Jt(J){dt.call(this,l,J)}function pn(J){dt.call(this,l,J)}function Rn(J){dt.call(this,l,J)}function Gn(J){dt.call(this,l,J)}function el(J){dt.call(this,l,J)}function Dn(J){dt.call(this,l,J)}function ml(J){Ae[J?"unshift":"push"](()=>{Kt=J,t(28,Kt)})}function tl(){tn=this.clientWidth,an=this.clientHeight,t(26,tn),t(27,an)}return l.$$set=J=>{e=vt(vt({},e),zn(J)),t(33,s=Ut(e,o)),"id"in J&&t(35,w=J.id),"nodes"in J&&t(36,g=J.nodes),"edges"in J&&t(37,v=J.edges),"fitView"in J&&t(38,y=J.fitView),"fitViewOptions"in J&&t(39,E=J.fitViewOptions),"minZoom"in J&&t(40,z=J.minZoom),"maxZoom"in J&&t(41,D=J.maxZoom),"initialViewport"in J&&t(42,M=J.initialViewport),"viewport"in J&&c(t(0,A=J.viewport)),"nodeTypes"in J&&t(43,O=J.nodeTypes),"edgeTypes"in J&&t(44,L=J.edgeTypes),"selectionKey"in J&&t(1,W=J.selectionKey),"selectionMode"in J&&t(45,K=J.selectionMode),"panActivationKey"in J&&t(2,R=J.panActivationKey),"multiSelectionKey"in J&&t(3,I=J.multiSelectionKey),"zoomActivationKey"in J&&t(4,P=J.zoomActivationKey),"nodesDraggable"in J&&t(46,N=J.nodesDraggable),"nodesConnectable"in J&&t(47,Y=J.nodesConnectable),"nodeDragThreshold"in J&&t(48,Z=J.nodeDragThreshold),"elementsSelectable"in J&&t(49,F=J.elementsSelectable),"snapGrid"in J&&t(50,X=J.snapGrid),"deleteKey"in J&&t(5,se=J.deleteKey),"connectionRadius"in J&&t(51,q=J.connectionRadius),"connectionLineType"in J&&t(52,G=J.connectionLineType),"connectionMode"in J&&t(53,oe=J.connectionMode),"connectionLineStyle"in J&&t(6,ae=J.connectionLineStyle),"connectionLineContainerStyle"in J&&t(7,ve=J.connectionLineContainerStyle),"onMoveStart"in J&&t(8,$=J.onMoveStart),"onMove"in J&&t(9,Ie=J.onMove),"onMoveEnd"in J&&t(10,Ne=J.onMoveEnd),"isValidConnection"in J&&t(54,ce=J.isValidConnection),"translateExtent"in J&&t(55,Ze=J.translateExtent),"nodeExtent"in J&&t(56,Qe=J.nodeExtent),"onlyRenderVisibleElements"in J&&t(57,ge=J.onlyRenderVisibleElements),"panOnScrollMode"in J&&t(11,ie=J.panOnScrollMode),"preventScrolling"in J&&t(12,Ue=J.preventScrolling),"zoomOnScroll"in J&&t(13,et=J.zoomOnScroll),"zoomOnDoubleClick"in J&&t(14,at=J.zoomOnDoubleClick),"zoomOnPinch"in J&&t(15,_t=J.zoomOnPinch),"panOnScroll"in J&&t(16,nt=J.panOnScroll),"panOnDrag"in J&&t(17,mt=J.panOnDrag),"selectionOnDrag"in J&&t(18,jt=J.selectionOnDrag),"autoPanOnConnect"in J&&t(58,Ht=J.autoPanOnConnect),"autoPanOnNodeDrag"in J&&t(59,gt=J.autoPanOnNodeDrag),"onerror"in J&&t(60,At=J.onerror),"ondelete"in J&&t(61,me=J.ondelete),"onedgecreate"in J&&t(62,Lt=J.onedgecreate),"attributionPosition"in J&&t(19,Et=J.attributionPosition),"proOptions"in J&&t(20,Ct=J.proOptions),"defaultEdgeOptions"in J&&t(21,Pe=J.defaultEdgeOptions),"width"in J&&t(63,qt=J.width),"height"in J&&t(64,It=J.height),"colorMode"in J&&t(65,fe=J.colorMode),"onconnect"in J&&t(66,We=J.onconnect),"onconnectstart"in J&&t(67,Be=J.onconnectstart),"onconnectend"in J&&t(68,Je=J.onconnectend),"onbeforedelete"in J&&t(69,wt=J.onbeforedelete),"oninit"in J&&t(70,bt=J.oninit),"nodeOrigin"in J&&t(71,Mt=J.nodeOrigin),"paneClickDistance"in J&&t(22,Tt=J.paneClickDistance),"nodeClickDistance"in J&&t(23,rn=J.nodeClickDistance),"defaultMarkerColor"in J&&t(72,Bt=J.defaultMarkerColor),"style"in J&&t(24,Rt=J.style),"class"in J&&t(25,Yt=J.class),"$$scope"in J&&t(99,_=J.$$scope)},l.$$.update=()=>{l.$$.dirty[0]&201326592&&tn!==void 0&&an!==void 0&&(yt.width.set(tn),yt.height.set(an)),l.$$.dirty[2]&6400&&!mn&&i&&(bt==null||bt(),t(73,mn=!0)),l.$$.dirty[1]&2097135632|l.$$.dirty[2]&1777&&bg(yt,{flowId:w,connectionLineType:G,connectionRadius:q,selectionMode:K,snapGrid:X,defaultMarkerColor:Bt,nodesDraggable:N,nodesConnectable:Y,elementsSelectable:F,onlyRenderVisibleElements:ge,isValidConnection:ce,autoPanOnConnect:Ht,autoPanOnNodeDrag:gt,onerror:At,ondelete:me,onedgecreate:Lt,connectionMode:oe,nodeDragThreshold:Z,onconnect:We,onconnectstart:Be,onconnectend:Je,onbeforedelete:wt,nodeOrigin:Mt}),l.$$.dirty[0]&4194304|l.$$.dirty[1]&16791040&&yi(yt,{nodeTypes:O,edgeTypes:L,minZoom:z,maxZoom:D,translateExtent:Ze,paneClickDistance:Tt}),l.$$.dirty[2]&8&&d(t(29,n=wg(fe)))},[A,W,R,I,P,se,ae,ve,$,Ie,Ne,ie,Ue,et,at,_t,nt,mt,jt,Et,Ct,Pe,Tt,rn,Rt,Yt,tn,an,Kt,n,u,Pt,wn,s,b,w,g,v,y,E,z,D,M,O,L,K,N,Y,Z,F,X,q,G,oe,ce,Ze,Qe,ge,Ht,gt,At,me,Lt,qt,It,fe,We,Be,Je,wt,bt,Mt,Bt,mn,i,h,yn,Sn,Nn,j,we,Fe,qe,Me,Ye,Dt,rt,cn,Gt,un,nn,Jt,pn,Rn,Gn,el,Dn,ml,tl,_]}class Mg extends Oe{constructor(e){super(),He(this,e,Cg,Dg,Le,{id:35,nodes:36,edges:37,fitView:38,fitViewOptions:39,minZoom:40,maxZoom:41,initialViewport:42,viewport:0,nodeTypes:43,edgeTypes:44,selectionKey:1,selectionMode:45,panActivationKey:2,multiSelectionKey:3,zoomActivationKey:4,nodesDraggable:46,nodesConnectable:47,nodeDragThreshold:48,elementsSelectable:49,snapGrid:50,deleteKey:5,connectionRadius:51,connectionLineType:52,connectionMode:53,connectionLineStyle:6,connectionLineContainerStyle:7,onMoveStart:8,onMove:9,onMoveEnd:10,isValidConnection:54,translateExtent:55,nodeExtent:56,onlyRenderVisibleElements:57,panOnScrollMode:11,preventScrolling:12,zoomOnScroll:13,zoomOnDoubleClick:14,zoomOnPinch:15,panOnScroll:16,panOnDrag:17,selectionOnDrag:18,autoPanOnConnect:58,autoPanOnNodeDrag:59,onerror:60,ondelete:61,onedgecreate:62,attributionPosition:19,proOptions:20,defaultEdgeOptions:21,width:63,height:64,colorMode:65,onconnect:66,onconnectstart:67,onconnectend:68,onbeforedelete:69,oninit:70,nodeOrigin:71,paneClickDistance:22,nodeClickDistance:23,defaultMarkerColor:72,style:24,class:25},null,[-1,-1,-1,-1])}}function Tg(l){let e;const t=l[7].default,n=Qt(t,l,l[6],null);return{c(){n&&n.c()},l(o){n&&n.l(o)},m(o,s){n&&n.m(o,s),e=!0},p(o,[s]){n&&n.p&&(!e||s&64)&&xt(n,t,o,o[6],e?en(t,o[6],s,null):$t(o[6]),null)},i(o){e||(C(n,o),e=!0)},o(o){H(n,o),e=!1},d(o){n&&n.d(o)}}}function Vg(l,e,t){let{$$slots:n={},$$scope:o}=e,{initialNodes:s=void 0}=e,{initialEdges:i=void 0}=e,{initialWidth:r=void 0}=e,{initialHeight:a=void 0}=e,{fitView:c=void 0}=e,{nodeOrigin:u=void 0}=e;const f=xa({nodes:s,edges:i,width:r,height:a,nodeOrigin:u,fitView:c});return Ul(Bo,{getStore:()=>f}),$n(()=>{f.reset()}),l.$$set=d=>{"initialNodes"in d&&t(0,s=d.initialNodes),"initialEdges"in d&&t(1,i=d.initialEdges),"initialWidth"in d&&t(2,r=d.initialWidth),"initialHeight"in d&&t(3,a=d.initialHeight),"fitView"in d&&t(4,c=d.fitView),"nodeOrigin"in d&&t(5,u=d.nodeOrigin),"$$scope"in d&&t(6,o=d.$$scope)},[s,i,r,a,c,u,o,n]}class zg extends Oe{constructor(e){super(),He(this,e,Vg,Tg,Le,{initialNodes:0,initialEdges:1,initialWidth:2,initialHeight:3,fitView:4,nodeOrigin:5})}}const Ng=l=>({}),Ei=l=>({class:"button-svg"});function Pg(l){let e,t,n,o,s;const i=l[8].default,r=Qt(i,l,l[7],Ei);let a=[{type:"button"},{class:t=Nt(["svelte-flow__controls-button",l[0]])},l[6]],c={};for(let u=0;u<a.length;u+=1)c=vt(c,a[u]);return{c(){e=T("button"),r&&r.c(),this.h()},l(u){e=V(u,"BUTTON",{type:!0,class:!0});var f=S(e);r&&r.l(f),f.forEach(p),this.h()},h(){yl(e,c),$e(e,"--xy-controls-button-background-color-props",l[1]),$e(e,"--xy-controls-button-background-color-hover-props",l[2]),$e(e,"--xy-controls-button-color-props",l[3]),$e(e,"--xy-controls-button-color-hover-props",l[4]),$e(e,"--xy-controls-button-border-color-props",l[5])},m(u,f){B(u,e,f),r&&r.m(e,null),e.autofocus&&e.focus(),n=!0,o||(s=Se(e,"click",l[9]),o=!0)},p(u,[f]){r&&r.p&&(!n||f&128)&&xt(r,i,u,u[7],n?en(i,u[7],f,Ng):$t(u[7]),Ei),yl(e,c=xn(a,[{type:"button"},(!n||f&1&&t!==(t=Nt(["svelte-flow__controls-button",u[0]])))&&{class:t},f&64&&u[6]])),$e(e,"--xy-controls-button-background-color-props",u[1]),$e(e,"--xy-controls-button-background-color-hover-props",u[2]),$e(e,"--xy-controls-button-color-props",u[3]),$e(e,"--xy-controls-button-color-hover-props",u[4]),$e(e,"--xy-controls-button-border-color-props",u[5])},i(u){n||(C(r,u),n=!0)},o(u){H(r,u),n=!1},d(u){u&&p(e),r&&r.d(u),o=!1,s()}}}function Og(l,e,t){const n=["class"];let o=Ut(e,n),{$$slots:s={},$$scope:i}=e,{class:r=void 0}=e,a,c,u,f,d;function h(_){dt.call(this,l,_)}return l.$$set=_=>{e=vt(vt({},e),zn(_)),t(6,o=Ut(e,n)),"class"in _&&t(0,r=_.class),"$$scope"in _&&t(7,i=_.$$scope)},[r,a,c,u,f,d,o,i,s,h]}class ko extends Oe{constructor(e){super(),He(this,e,Og,Pg,Le,{class:0})}}function Hg(l){let e,t;return{c(){e=_e("svg"),t=_e("path"),this.h()},l(n){e=be(n,"svg",{xmlns:!0,viewBox:!0});var o=S(e);t=be(o,"path",{d:!0}),S(t).forEach(p),o.forEach(p),this.h()},h(){m(t,"d","M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"viewBox","0 0 32 32")},m(n,o){B(n,e,o),k(e,t)},p:De,i:De,o:De,d(n){n&&p(e)}}}class Ag extends Oe{constructor(e){super(),He(this,e,null,Hg,Le,{})}}function Lg(l){let e,t;return{c(){e=_e("svg"),t=_e("path"),this.h()},l(n){e=be(n,"svg",{xmlns:!0,viewBox:!0});var o=S(e);t=be(o,"path",{d:!0}),S(t).forEach(p),o.forEach(p),this.h()},h(){m(t,"d","M0 0h32v4.2H0z"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"viewBox","0 0 32 5")},m(n,o){B(n,e,o),k(e,t)},p:De,i:De,o:De,d(n){n&&p(e)}}}class Bg extends Oe{constructor(e){super(),He(this,e,null,Lg,Le,{})}}function Rg(l){let e,t;return{c(){e=_e("svg"),t=_e("path"),this.h()},l(n){e=be(n,"svg",{xmlns:!0,viewBox:!0});var o=S(e);t=be(o,"path",{d:!0}),S(t).forEach(p),o.forEach(p),this.h()},h(){m(t,"d","M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"viewBox","0 0 32 30")},m(n,o){B(n,e,o),k(e,t)},p:De,i:De,o:De,d(n){n&&p(e)}}}class Ug extends Oe{constructor(e){super(),He(this,e,null,Rg,Le,{})}}function Fg(l){let e,t;return{c(){e=_e("svg"),t=_e("path"),this.h()},l(n){e=be(n,"svg",{xmlns:!0,viewBox:!0});var o=S(e);t=be(o,"path",{d:!0}),S(t).forEach(p),o.forEach(p),this.h()},h(){m(t,"d","M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"viewBox","0 0 25 32")},m(n,o){B(n,e,o),k(e,t)},p:De,i:De,o:De,d(n){n&&p(e)}}}class Wg extends Oe{constructor(e){super(),He(this,e,null,Fg,Le,{})}}function jg(l){let e,t;return{c(){e=_e("svg"),t=_e("path"),this.h()},l(n){e=be(n,"svg",{xmlns:!0,viewBox:!0});var o=S(e);t=be(o,"path",{d:!0}),S(t).forEach(p),o.forEach(p),this.h()},h(){m(t,"d","M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"viewBox","0 0 25 32")},m(n,o){B(n,e,o),k(e,t)},p:De,i:De,o:De,d(n){n&&p(e)}}}class Yg extends Oe{constructor(e){super(),He(this,e,null,jg,Le,{})}}const Kg=l=>({}),Ii=l=>({}),Gg=l=>({}),Si=l=>({});function Di(l){let e,t,n,o;const s=[{class:"svelte-flow__controls-zoomin"},{title:"zoom in"},{"aria-label":"zoom in"},{disabled:l[9]},l[17]];let i={$$slots:{default:[Xg]},$$scope:{ctx:l}};for(let c=0;c<s.length;c+=1)i=vt(i,s[c]);e=new ko({props:i}),e.$on("click",l[18]);const r=[{class:"svelte-flow__controls-zoomout"},{title:"zoom out"},{"aria-label":"zoom out"},{disabled:l[10]},l[17]];let a={$$slots:{default:[Zg]},$$scope:{ctx:l}};for(let c=0;c<r.length;c+=1)a=vt(a,r[c]);return n=new ko({props:a}),n.$on("click",l[19]),{c(){ee(e.$$.fragment),t=Q(),ee(n.$$.fragment)},l(c){le(e.$$.fragment,c),t=x(c),le(n.$$.fragment,c)},m(c,u){te(e,c,u),B(c,t,u),te(n,c,u),o=!0},p(c,u){const f=u[0]&131584?xn(s,[s[0],s[1],s[2],u[0]&512&&{disabled:c[9]},u[0]&131072&&Wl(c[17])]):{};u[1]&32&&(f.$$scope={dirty:u,ctx:c}),e.$set(f);const d=u[0]&132096?xn(r,[r[0],r[1],r[2],u[0]&1024&&{disabled:c[10]},u[0]&131072&&Wl(c[17])]):{};u[1]&32&&(d.$$scope={dirty:u,ctx:c}),n.$set(d)},i(c){o||(C(e.$$.fragment,c),C(n.$$.fragment,c),o=!0)},o(c){H(e.$$.fragment,c),H(n.$$.fragment,c),o=!1},d(c){c&&p(t),ne(e,c),ne(n,c)}}}function Xg(l){let e,t;return e=new Ag({}),{c(){ee(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,o){te(e,n,o),t=!0},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}function Zg(l){let e,t;return e=new Bg({}),{c(){ee(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,o){te(e,n,o),t=!0},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}function Ci(l){let e,t;const n=[{class:"svelte-flow__controls-fitview"},{title:"fit view"},{"aria-label":"fit view"},l[17]];let o={$$slots:{default:[qg]},$$scope:{ctx:l}};for(let s=0;s<n.length;s+=1)o=vt(o,n[s]);return e=new ko({props:o}),e.$on("click",l[20]),{c(){ee(e.$$.fragment)},l(s){le(e.$$.fragment,s)},m(s,i){te(e,s,i),t=!0},p(s,i){const r=i[0]&131072?xn(n,[n[0],n[1],n[2],Wl(s[17])]):{};i[1]&32&&(r.$$scope={dirty:i,ctx:s}),e.$set(r)},i(s){t||(C(e.$$.fragment,s),t=!0)},o(s){H(e.$$.fragment,s),t=!1},d(s){ne(e,s)}}}function qg(l){let e,t;return e=new Ug({}),{c(){ee(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,o){te(e,n,o),t=!0},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}function Mi(l){let e,t;const n=[{class:"svelte-flow__controls-interactive"},{title:"toggle interactivity"},{"aria-label":"toggle interactivity"},l[17]];let o={$$slots:{default:[xg]},$$scope:{ctx:l}};for(let s=0;s<n.length;s+=1)o=vt(o,n[s]);return e=new ko({props:o}),e.$on("click",l[21]),{c(){ee(e.$$.fragment)},l(s){le(e.$$.fragment,s)},m(s,i){te(e,s,i),t=!0},p(s,i){const r=i[0]&131072?xn(n,[n[0],n[1],n[2],Wl(s[17])]):{};i[0]&256|i[1]&32&&(r.$$scope={dirty:i,ctx:s}),e.$set(r)},i(s){t||(C(e.$$.fragment,s),t=!0)},o(s){H(e.$$.fragment,s),t=!1},d(s){ne(e,s)}}}function Jg(l){let e,t;return e=new Wg({}),{c(){ee(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,o){te(e,n,o),t=!0},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}function Qg(l){let e,t;return e=new Yg({}),{c(){ee(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,o){te(e,n,o),t=!0},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}function xg(l){let e,t,n,o;const s=[Qg,Jg],i=[];function r(a,c){return a[8]?0:1}return e=r(l),t=i[e]=s[e](l),{c(){t.c(),n=Te()},l(a){t.l(a),n=Te()},m(a,c){i[e].m(a,c),B(a,n,c),o=!0},p(a,c){let u=e;e=r(a),e!==u&&(Ve(),H(i[u],1,1,()=>{i[u]=null}),ze(),t=i[e],t||(t=i[e]=s[e](a),t.c()),C(t,1),t.m(n.parentNode,n))},i(a){o||(C(t),o=!0)},o(a){H(t),o=!1},d(a){a&&p(n),i[e].d(a)}}}function $g(l){let e,t,n,o,s,i;const r=l[35].before,a=Qt(r,l,l[36],Si);let c=l[1]&&Di(l),u=l[2]&&Ci(l),f=l[3]&&Mi(l);const d=l[35].default,h=Qt(d,l,l[36],null),_=l[35].after,b=Qt(_,l,l[36],Ii);return{c(){a&&a.c(),e=Q(),c&&c.c(),t=Q(),u&&u.c(),n=Q(),f&&f.c(),o=Q(),h&&h.c(),s=Q(),b&&b.c()},l(w){a&&a.l(w),e=x(w),c&&c.l(w),t=x(w),u&&u.l(w),n=x(w),f&&f.l(w),o=x(w),h&&h.l(w),s=x(w),b&&b.l(w)},m(w,g){a&&a.m(w,g),B(w,e,g),c&&c.m(w,g),B(w,t,g),u&&u.m(w,g),B(w,n,g),f&&f.m(w,g),B(w,o,g),h&&h.m(w,g),B(w,s,g),b&&b.m(w,g),i=!0},p(w,g){a&&a.p&&(!i||g[1]&32)&&xt(a,r,w,w[36],i?en(r,w[36],g,Gg):$t(w[36]),Si),w[1]?c?(c.p(w,g),g[0]&2&&C(c,1)):(c=Di(w),c.c(),C(c,1),c.m(t.parentNode,t)):c&&(Ve(),H(c,1,1,()=>{c=null}),ze()),w[2]?u?(u.p(w,g),g[0]&4&&C(u,1)):(u=Ci(w),u.c(),C(u,1),u.m(n.parentNode,n)):u&&(Ve(),H(u,1,1,()=>{u=null}),ze()),w[3]?f?(f.p(w,g),g[0]&8&&C(f,1)):(f=Mi(w),f.c(),C(f,1),f.m(o.parentNode,o)):f&&(Ve(),H(f,1,1,()=>{f=null}),ze()),h&&h.p&&(!i||g[1]&32)&&xt(h,d,w,w[36],i?en(d,w[36],g,null):$t(w[36]),null),b&&b.p&&(!i||g[1]&32)&&xt(b,_,w,w[36],i?en(_,w[36],g,Kg):$t(w[36]),Ii)},i(w){i||(C(a,w),C(c),C(u),C(f),C(h,w),C(b,w),i=!0)},o(w){H(a,w),H(c),H(u),H(f),H(h,w),H(b,w),i=!1},d(w){w&&(p(e),p(t),p(n),p(o),p(s)),a&&a.d(w),c&&c.d(w),u&&u.d(w),f&&f.d(w),h&&h.d(w),b&&b.d(w)}}}function e0(l){let e,t;return e=new nc({props:{class:Nt(["svelte-flow__controls",l[7],l[6]]),position:l[0],"data-testid":"svelte-flow__controls","aria-label":l[4]??"Svelte Flow controls",style:l[5],$$slots:{default:[$g]},$$scope:{ctx:l}}}),{c(){ee(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,o){te(e,n,o),t=!0},p(n,o){const s={};o[0]&192&&(s.class=Nt(["svelte-flow__controls",n[7],n[6]])),o[0]&1&&(s.position=n[0]),o[0]&16&&(s["aria-label"]=n[4]??"Svelte Flow controls"),o[0]&32&&(s.style=n[5]),o[0]&1806|o[1]&32&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}function t0(l,e,t){let n,o,s,i,r,a,c,u,f,d,{$$slots:h={},$$scope:_}=e,{position:b="bottom-left"}=e,{showZoom:w=!0}=e,{showFitView:g=!0}=e,{showLock:v=!0}=e,{buttonBgColor:y=void 0}=e,{buttonBgColorHover:E=void 0}=e,{buttonColor:z=void 0}=e,{buttonColorHover:D=void 0}=e,{buttonBorderColor:M=void 0}=e,{ariaLabel:A=void 0}=e,{style:O=void 0}=e,{orientation:L="vertical"}=e,{fitViewOptions:W=void 0}=e,{class:K=""}=e;const{zoomIn:R,zoomOut:I,fitView:P,viewport:N,minZoom:Y,maxZoom:Z,nodesDraggable:F,nodesConnectable:X,elementsSelectable:se}=Wt();re(l,N,$=>t(30,a=$)),re(l,Y,$=>t(31,c=$)),re(l,Z,$=>t(29,r=$)),re(l,F,$=>t(34,d=$)),re(l,X,$=>t(33,f=$)),re(l,se,$=>t(32,u=$));const q={bgColor:y,bgColorHover:E,color:z,colorHover:D,borderColor:M},G=()=>{R()},oe=()=>{I()},ae=()=>{P(W)},ve=()=>{t(8,n=!n),F.set(n),X.set(n),se.set(n)};return l.$$set=$=>{"position"in $&&t(0,b=$.position),"showZoom"in $&&t(1,w=$.showZoom),"showFitView"in $&&t(2,g=$.showFitView),"showLock"in $&&t(3,v=$.showLock),"buttonBgColor"in $&&t(22,y=$.buttonBgColor),"buttonBgColorHover"in $&&t(23,E=$.buttonBgColorHover),"buttonColor"in $&&t(24,z=$.buttonColor),"buttonColorHover"in $&&t(25,D=$.buttonColorHover),"buttonBorderColor"in $&&t(26,M=$.buttonBorderColor),"ariaLabel"in $&&t(4,A=$.ariaLabel),"style"in $&&t(5,O=$.style),"orientation"in $&&t(27,L=$.orientation),"fitViewOptions"in $&&t(28,W=$.fitViewOptions),"class"in $&&t(6,K=$.class),"$$scope"in $&&t(36,_=$.$$scope)},l.$$.update=()=>{l.$$.dirty[1]&14&&t(8,n=d||f||u),l.$$.dirty[0]&1073741824|l.$$.dirty[1]&1&&t(10,o=a.zoom<=c),l.$$.dirty[0]&1610612736&&t(9,s=a.zoom>=r),l.$$.dirty[0]&134217728&&t(7,i=L==="horizontal"?"horizontal":"vertical")},[b,w,g,v,A,O,K,i,n,s,o,N,Y,Z,F,X,se,q,G,oe,ae,ve,y,E,z,D,M,L,W,r,a,c,u,f,d,h,_]}let n0=class extends Oe{constructor(e){super(),He(this,e,t0,e0,Le,{position:0,showZoom:1,showFitView:2,showLock:3,buttonBgColor:22,buttonBgColorHover:23,buttonColor:24,buttonColorHover:25,buttonBorderColor:26,ariaLabel:4,style:5,orientation:27,fitViewOptions:28,class:6},null,[-1,-1])}};var jn;(function(l){l.Lines="lines",l.Dots="dots",l.Cross="cross"})(jn||(jn={}));function l0(l){let e,t;return{c(){e=_e("circle"),this.h()},l(n){e=be(n,"circle",{cx:!0,cy:!0,r:!0,class:!0}),S(e).forEach(p),this.h()},h(){m(e,"cx",l[0]),m(e,"cy",l[0]),m(e,"r",l[0]),m(e,"class",t=Nt(["svelte-flow__background-pattern","dots",l[1]]))},m(n,o){B(n,e,o)},p(n,[o]){o&1&&m(e,"cx",n[0]),o&1&&m(e,"cy",n[0]),o&1&&m(e,"r",n[0]),o&2&&t!==(t=Nt(["svelte-flow__background-pattern","dots",n[1]]))&&m(e,"class",t)},i:De,o:De,d(n){n&&p(e)}}}function o0(l,e,t){let{radius:n=5}=e,{class:o=""}=e;return l.$$set=s=>{"radius"in s&&t(0,n=s.radius),"class"in s&&t(1,o=s.class)},[n,o]}class s0 extends Oe{constructor(e){super(),He(this,e,o0,l0,Le,{radius:0,class:1})}}function r0(l){let e,t,n;return{c(){e=_e("path"),this.h()},l(o){e=be(o,"path",{"stroke-width":!0,d:!0,class:!0}),S(e).forEach(p),this.h()},h(){m(e,"stroke-width",l[0]),m(e,"d",t=`M${l[1][0]/2} 0 V${l[1][1]} M0 ${l[1][1]/2} H${l[1][0]}`),m(e,"class",n=Nt(["svelte-flow__background-pattern",l[2],l[3]]))},m(o,s){B(o,e,s)},p(o,[s]){s&1&&m(e,"stroke-width",o[0]),s&2&&t!==(t=`M${o[1][0]/2} 0 V${o[1][1]} M0 ${o[1][1]/2} H${o[1][0]}`)&&m(e,"d",t),s&12&&n!==(n=Nt(["svelte-flow__background-pattern",o[2],o[3]]))&&m(e,"class",n)},i:De,o:De,d(o){o&&p(e)}}}function i0(l,e,t){let{lineWidth:n=1}=e,{dimensions:o}=e,{variant:s=void 0}=e,{class:i=""}=e;return l.$$set=r=>{"lineWidth"in r&&t(0,n=r.lineWidth),"dimensions"in r&&t(1,o=r.dimensions),"variant"in r&&t(2,s=r.variant),"class"in r&&t(3,i=r.class)},[n,o,s,i]}class a0 extends Oe{constructor(e){super(),He(this,e,i0,r0,Le,{lineWidth:0,dimensions:1,variant:2,class:3})}}function c0(l){let e,t;return e=new a0({props:{dimensions:l[6],variant:l[0],lineWidth:l[1],class:l[4]}}),{c(){ee(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,o){te(e,n,o),t=!0},p(n,o){const s={};o&64&&(s.dimensions=n[6]),o&1&&(s.variant=n[0]),o&2&&(s.lineWidth=n[1]),o&16&&(s.class=n[4]),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}function u0(l){let e,t;return e=new s0({props:{radius:l[7]/2,class:l[4]}}),{c(){ee(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,o){te(e,n,o),t=!0},p(n,o){const s={};o&128&&(s.radius=n[7]/2),o&16&&(s.class=n[4]),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}function f0(l){let e,t,n,o,s,i,r,a,c,u,f,d,h;const _=[u0,c0],b=[];function w(g,v){return g[14]?0:1}return n=w(l),o=b[n]=_[n](l),{c(){e=_e("svg"),t=_e("pattern"),o.c(),u=_e("rect"),this.h()},l(g){e=be(g,"svg",{class:!0,"data-testid":!0});var v=S(e);t=be(v,"pattern",{id:!0,x:!0,y:!0,width:!0,height:!0,patternUnits:!0,patternTransform:!0});var y=S(t);o.l(y),y.forEach(p),u=be(v,"rect",{x:!0,y:!0,width:!0,height:!0,fill:!0}),S(u).forEach(p),v.forEach(p),this.h()},h(){m(t,"id",l[11]),m(t,"x",s=l[9].x%l[8][0]),m(t,"y",i=l[9].y%l[8][1]),m(t,"width",r=l[8][0]),m(t,"height",a=l[8][1]),m(t,"patternUnits","userSpaceOnUse"),m(t,"patternTransform",c=`translate(-${l[10][0]},-${l[10][1]})`),m(u,"x","0"),m(u,"y","0"),m(u,"width","100%"),m(u,"height","100%"),m(u,"fill",f=`url(#${l[11]})`),m(e,"class",d=Is(Nt(["svelte-flow__background",l[5]]))+" svelte-1r7pe8d"),m(e,"data-testid","svelte-flow__background"),$e(e,"--xy-background-color-props",l[2]),$e(e,"--xy-background-pattern-color-props",l[3])},m(g,v){B(g,e,v),k(e,t),b[n].m(t,null),k(e,u),h=!0},p(g,[v]){o.p(g,v),(!h||v&2048)&&m(t,"id",g[11]),(!h||v&768&&s!==(s=g[9].x%g[8][0]))&&m(t,"x",s),(!h||v&768&&i!==(i=g[9].y%g[8][1]))&&m(t,"y",i),(!h||v&256&&r!==(r=g[8][0]))&&m(t,"width",r),(!h||v&256&&a!==(a=g[8][1]))&&m(t,"height",a),(!h||v&1024&&c!==(c=`translate(-${g[10][0]},-${g[10][1]})`))&&m(t,"patternTransform",c),(!h||v&2048&&f!==(f=`url(#${g[11]})`))&&m(u,"fill",f),(!h||v&32&&d!==(d=Is(Nt(["svelte-flow__background",g[5]]))+" svelte-1r7pe8d"))&&m(e,"class",d),v&4&&$e(e,"--xy-background-color-props",g[2]),v&8&&$e(e,"--xy-background-pattern-color-props",g[3])},i(g){h||(C(o),h=!0)},o(g){H(o),h=!1},d(g){g&&p(e),b[n].d()}}}const d0={[jn.Dots]:1,[jn.Lines]:1,[jn.Cross]:6};function h0(l,e,t){let n,o,s,i,r,a,c,{id:u=void 0}=e,{variant:f=jn.Dots}=e,{gap:d=20}=e,{size:h=1}=e,{lineWidth:_=1}=e,{bgColor:b=void 0}=e,{patternColor:w=void 0}=e,{patternClass:g=void 0}=e,{class:v=""}=e;const{viewport:y,flowId:E}=Wt();re(l,y,O=>t(9,a=O)),re(l,E,O=>t(18,c=O));const z=h||d0[f],D=f===jn.Dots,M=f===jn.Cross,A=Array.isArray(d)?d:[d,d];return l.$$set=O=>{"id"in O&&t(15,u=O.id),"variant"in O&&t(0,f=O.variant),"gap"in O&&t(16,d=O.gap),"size"in O&&t(17,h=O.size),"lineWidth"in O&&t(1,_=O.lineWidth),"bgColor"in O&&t(2,b=O.bgColor),"patternColor"in O&&t(3,w=O.patternColor),"patternClass"in O&&t(4,g=O.patternClass),"class"in O&&t(5,v=O.class)},l.$$.update=()=>{l.$$.dirty&294912&&t(11,n=`background-pattern-${c}-${u||""}`),l.$$.dirty&512&&t(8,o=[A[0]*a.zoom||1,A[1]*a.zoom||1]),l.$$.dirty&512&&t(7,s=z*a.zoom),l.$$.dirty&384&&t(6,i=M?[s,s]:o),l.$$.dirty&192&&t(10,r=D?[s/2,s/2]:[i[0]/2,i[1]/2])},[f,_,b,w,g,v,i,s,o,a,r,n,y,E,D,u,d,h,c]}class m0 extends Oe{constructor(e){super(),He(this,e,h0,f0,Le,{id:15,variant:0,gap:16,size:17,lineWidth:1,bgColor:2,patternColor:3,patternClass:4,class:5})}}const Ti=l=>Oh(l);function g0(){const{zoomIn:l,zoomOut:e,fitView:t,onbeforedelete:n,snapGrid:o,viewport:s,width:i,height:r,minZoom:a,maxZoom:c,panZoom:u,nodes:f,edges:d,domNode:h,nodeLookup:_,nodeOrigin:b,edgeLookup:w,connectionLookup:g}=Wt(),v=z=>{var L,W;const D=de(_),M=Ti(z)?z:D.get(z.id),A=M.parentId?Rh(M.position,M.measured,M.parentId,D,de(b)):M.position,O={id:M.id,position:A,width:((L=M.measured)==null?void 0:L.width)??M.width,height:((W=M.measured)==null?void 0:W.height)??M.height,data:M.data};return Sl(O)},y=(z,D,M={replace:!1})=>{var L;const A=(L=de(_).get(z))==null?void 0:L.internals.userNode;if(!A)return;const O=typeof D=="function"?D(A):D;M.replace?f.update(W=>W.map(K=>K.id===z?Ti(O)?O:{...K,...O}:K)):(Object.assign(A,O),f.update(W=>W))},E=z=>de(_).get(z);return{zoomIn:l,zoomOut:e,getInternalNode:E,getNode:z=>{var D;return(D=E(z))==null?void 0:D.internals.userNode},getNodes:z=>z===void 0?de(f):Vi(de(_),z),getEdge:z=>de(w).get(z),getEdges:z=>z===void 0?de(d):Vi(de(w),z),setZoom:(z,D)=>{const M=de(u);return M?M.scaleTo(z,{duration:D==null?void 0:D.duration}):Promise.resolve(!1)},getZoom:()=>de(s).zoom,setViewport:async(z,D)=>{const M=de(s),A=de(u);return A?(await A.setViewport({x:z.x??M.x,y:z.y??M.y,zoom:z.zoom??M.zoom},{duration:D==null?void 0:D.duration}),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>de(s),setCenter:async(z,D,M)=>{const A=typeof(M==null?void 0:M.zoom)<"u"?M.zoom:de(c),O=de(u);return O?(await O.setViewport({x:de(i)/2-z*A,y:de(r)/2-D*A,zoom:A},{duration:M==null?void 0:M.duration}),Promise.resolve(!0)):Promise.resolve(!1)},fitView:t,fitBounds:async(z,D)=>{const M=de(u);if(!M)return Promise.resolve(!1);const A=ds(z,de(i),de(r),de(a),de(c),(D==null?void 0:D.padding)??.1);return await M.setViewport(A,{duration:D==null?void 0:D.duration}),Promise.resolve(!0)},getIntersectingNodes:(z,D=!0,M)=>{const A=Gr(z),O=A?z:v(z);return O?(M||de(f)).filter(L=>{const W=de(_).get(L.id);if(!W||!A&&L.id===z.id)return!1;const K=Sl(W),R=Gl(K,O);return D&&R>0||R>=O.width*O.height}):[]},isNodeIntersecting:(z,D,M=!0)=>{const O=Gr(z)?z:v(z);if(!O)return!1;const L=Gl(O,D);return M&&L>0||L>=O.width*O.height},deleteElements:async({nodes:z=[],edges:D=[]})=>{const{nodes:M,edges:A}=await Sa({nodesToRemove:z,edgesToRemove:D,nodes:de(f),edges:de(d),onBeforeDelete:de(n)});return M&&f.update(O=>O.filter(L=>!M.some(({id:W})=>W===L.id))),A&&d.update(O=>O.filter(L=>!A.some(({id:W})=>W===L.id))),{deletedNodes:M,deletedEdges:A}},screenToFlowPosition:(z,D={snapToGrid:!0})=>{const M=de(h);if(!M)return z;const A=D.snapToGrid?de(o):!1,{x:O,y:L,zoom:W}=de(s),{x:K,y:R}=M.getBoundingClientRect(),I={x:z.x-K,y:z.y-R};return Ql(I,[O,L,W],A!==null,A||[1,1])},flowToScreenPosition:z=>{const D=de(h);if(!D)return z;const{x:M,y:A,zoom:O}=de(s),{x:L,y:W}=D.getBoundingClientRect(),K=Ma(z,[M,A,O]);return{x:K.x+L,y:K.y+W}},toObject:()=>({nodes:de(f).map(z=>({...z,position:{...z.position},data:{...z.data}})),edges:de(d).map(z=>({...z})),viewport:{...de(s)}}),updateNode:y,updateNodeData:(z,D,M)=>{var L;const A=(L=de(_).get(z))==null?void 0:L.internals.userNode;if(!A)return;const O=typeof D=="function"?D(A):D;A.data=M!=null&&M.replace?O:{...A.data,...O},f.update(W=>W)},getNodesBounds:z=>{const D=de(_),M=de(b);return Hh(z,{nodeLookup:D,nodeOrigin:M})},getHandleConnections:({type:z,id:D,nodeId:M})=>{var A;return Array.from(((A=de(g).get(`${M}-${z}-${D??null}`))==null?void 0:A.values())??[])},viewport:s}}function Vi(l,e){var n;const t=[];for(const o of e){const s=l.get(o);if(s){const i="internals"in s?(n=s.internals)==null?void 0:n.userNode:s;t.push(i)}}return t}function p0(){const{nodesInitialized:l}=Wt();return{subscribe:l.subscribe}}function zi(l,e,t){const n=l.slice();return n[25]=e[t],n[27]=t,n}function Ni(l,e,t){const n=l.slice();return n[22]=e[t],n[24]=t,n}function _0(l){let e,t;return e=new Vo({props:{className:"size-4"}}),{c(){ee(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,o){te(e,n,o),t=!0},p:De,i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}function b0(l){let e,t,n,o,s,i,r,a=l[8].t("Tools")+"",c,u,f=l[8].t("Functions")+"",d,h,_,b,w,g,v,y;function E(A,O){if(A[1]==="tools")return w0;if(A[1]==="functions")return v0}let z=E(l),D=z&&z(l),M=l[2]&&Hi(l);return{c(){e=T("form"),t=T("div"),n=T("div"),o=T("div"),s=T("div"),i=T("select"),r=T("option"),c=ke(a),u=T("option"),d=ke(f),h=Q(),_=T("div"),b=T("select"),D&&D.c(),w=Q(),M&&M.c(),this.h()},l(A){e=V(A,"FORM",{class:!0});var O=S(e);t=V(O,"DIV",{class:!0});var L=S(t);n=V(L,"DIV",{class:!0});var W=S(n);o=V(W,"DIV",{class:!0});var K=S(o);s=V(K,"DIV",{class:!0});var R=S(s);i=V(R,"SELECT",{class:!0,placeholder:!0});var I=S(i);r=V(I,"OPTION",{class:!0});var P=S(r);c=Ee(P,a),P.forEach(p),u=V(I,"OPTION",{class:!0});var N=S(u);d=Ee(N,f),N.forEach(p),I.forEach(p),R.forEach(p),h=x(K),_=V(K,"DIV",{class:!0});var Y=S(_);b=V(Y,"SELECT",{class:!0});var Z=S(b);D&&D.l(Z),Z.forEach(p),Y.forEach(p),K.forEach(p),W.forEach(p),w=x(L),M&&M.l(L),L.forEach(p),O.forEach(p),this.h()},h(){r.__value="tools",In(r,r.__value),m(r,"class","bg-gray-100 dark:bg-gray-800"),u.__value="functions",In(u,u.__value),m(u,"class","bg-gray-100 dark:bg-gray-800"),m(i,"class","w-full rounded-sm text-xs py-2 px-1 bg-transparent outline-hidden"),m(i,"placeholder","Select"),l[1]===void 0&&ul(()=>l[13].call(i)),m(s,"class","flex-1"),m(b,"class","w-full rounded-sm py-2 px-1 text-xs bg-transparent outline-hidden"),l[2]===void 0&&ul(()=>l[14].call(b)),m(_,"class","flex-1"),m(o,"class","flex gap-2"),m(n,"class","space-y-1"),m(t,"class","flex flex-col"),m(e,"class","flex flex-col h-full justify-between space-y-3 text-sm")},m(A,O){B(A,e,O),k(e,t),k(t,n),k(n,o),k(o,s),k(s,i),k(i,r),k(r,c),k(i,u),k(u,d),oo(i,l[1],!0),k(o,h),k(o,_),k(_,b),D&&D.m(b,null),oo(b,l[2],!0),k(t,w),M&&M.m(t,null),g=!0,v||(y=[Se(i,"change",l[13]),Se(b,"change",l[14]),Se(b,"change",l[15]),Se(e,"submit",Eo(l[18]))],v=!0)},p(A,O){(!g||O&256)&&a!==(a=A[8].t("Tools")+"")&&Ce(c,a),(!g||O&256)&&f!==(f=A[8].t("Functions")+"")&&Ce(d,f),O&2&&oo(i,A[1]),z===(z=E(A))&&D?D.p(A,O):(D&&D.d(1),D=z&&z(A),D&&(D.c(),D.m(b,null))),O&196&&oo(b,A[2]),A[2]?M?(M.p(A,O),O&4&&C(M,1)):(M=Hi(A),M.c(),C(M,1),M.m(t,null)):M&&(Ve(),H(M,1,1,()=>{M=null}),ze())},i(A){g||(C(M),g=!0)},o(A){H(M),g=!1},d(A){A&&p(e),D&&D.d(),M&&M.d(),v=!1,sn(y)}}}function v0(l){let e,t=l[8].t("Select a function")+"",n,o,s=ht(l[7]),i=[];for(let r=0;r<s.length;r+=1)i[r]=Pi(zi(l,s,r));return{c(){e=T("option"),n=ke(t);for(let r=0;r<i.length;r+=1)i[r].c();o=Te(),this.h()},l(r){e=V(r,"OPTION",{class:!0});var a=S(e);n=Ee(a,t),a.forEach(p);for(let c=0;c<i.length;c+=1)i[c].l(r);o=Te(),this.h()},h(){e.__value="",In(e,e.__value),e.selected=!0,e.disabled=!0,m(e,"class","bg-gray-100 dark:bg-gray-800")},m(r,a){B(r,e,a),k(e,n);for(let c=0;c<i.length;c+=1)i[c]&&i[c].m(r,a);B(r,o,a)},p(r,a){if(a&256&&t!==(t=r[8].t("Select a function")+"")&&Ce(n,t),a&128){s=ht(r[7]);let c;for(c=0;c<s.length;c+=1){const u=zi(r,s,c);i[c]?i[c].p(u,a):(i[c]=Pi(u),i[c].c(),i[c].m(o.parentNode,o))}for(;c<i.length;c+=1)i[c].d(1);i.length=s.length}},d(r){r&&(p(e),p(o)),vn(i,r)}}}function w0(l){let e,t=l[8].t("Select a tool")+"",n,o,s=ht(l[6]),i=[];for(let r=0;r<s.length;r+=1)i[r]=Oi(Ni(l,s,r));return{c(){e=T("option"),n=ke(t);for(let r=0;r<i.length;r+=1)i[r].c();o=Te(),this.h()},l(r){e=V(r,"OPTION",{class:!0});var a=S(e);n=Ee(a,t),a.forEach(p);for(let c=0;c<i.length;c+=1)i[c].l(r);o=Te(),this.h()},h(){e.__value="",In(e,e.__value),e.selected=!0,e.disabled=!0,m(e,"class","bg-gray-100 dark:bg-gray-800")},m(r,a){B(r,e,a),k(e,n);for(let c=0;c<i.length;c+=1)i[c]&&i[c].m(r,a);B(r,o,a)},p(r,a){if(a&256&&t!==(t=r[8].t("Select a tool")+"")&&Ce(n,t),a&64){s=ht(r[6]);let c;for(c=0;c<s.length;c+=1){const u=Ni(r,s,c);i[c]?i[c].p(u,a):(i[c]=Oi(u),i[c].c(),i[c].m(o.parentNode,o))}for(;c<i.length;c+=1)i[c].d(1);i.length=s.length}},d(r){r&&(p(e),p(o)),vn(i,r)}}}function Pi(l){let e,t=l[25].name+"",n,o;return{c(){e=T("option"),n=ke(t),this.h()},l(s){e=V(s,"OPTION",{class:!0});var i=S(e);n=Ee(i,t),i.forEach(p),this.h()},h(){e.__value=o=l[25].id,In(e,e.__value),m(e,"class","bg-gray-100 dark:bg-gray-800")},m(s,i){B(s,e,i),k(e,n)},p(s,i){i&128&&t!==(t=s[25].name+"")&&Ce(n,t),i&128&&o!==(o=s[25].id)&&(e.__value=o,In(e,e.__value))},d(s){s&&p(e)}}}function Oi(l){let e,t=l[22].name+"",n,o;return{c(){e=T("option"),n=ke(t),this.h()},l(s){e=V(s,"OPTION",{class:!0});var i=S(e);n=Ee(i,t),i.forEach(p),this.h()},h(){e.__value=o=l[22].id,In(e,e.__value),m(e,"class","bg-gray-100 dark:bg-gray-800")},m(s,i){B(s,e,i),k(e,n)},p(s,i){i&64&&t!==(t=s[22].name+"")&&Ce(n,t),i&64&&o!==(o=s[22].id)&&(e.__value=o,In(e,e.__value))},d(s){s&&p(e)}}}function Hi(l){let e,t,n,o,s,i;const r=[k0,y0],a=[];function c(u,f){return u[3]?1:0}return o=c(l),s=a[o]=r[o](l),{c(){e=T("hr"),t=Q(),n=T("div"),s.c(),this.h()},l(u){e=V(u,"HR",{class:!0}),t=x(u),n=V(u,"DIV",{class:!0});var f=S(n);s.l(f),f.forEach(p),this.h()},h(){m(e,"class","dark:border-gray-800 my-1 w-full"),m(n,"class","my-2 text-xs")},m(u,f){B(u,e,f),B(u,t,f),B(u,n,f),a[o].m(n,null),i=!0},p(u,f){let d=o;o=c(u),o===d?a[o].p(u,f):(Ve(),H(a[d],1,1,()=>{a[d]=null}),ze(),s=a[o],s?s.p(u,f):(s=a[o]=r[o](u),s.c()),C(s,1),s.m(n,null))},i(u){i||(C(s),i=!0)},o(u){H(s),i=!1},d(u){u&&(p(e),p(t),p(n)),a[o].d()}}}function y0(l){let e,t;return e=new Vo({props:{className:"size-5"}}),{c(){ee(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,o){te(e,n,o),t=!0},p:De,i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}function k0(l){let e,t,n;function o(i){l[16](i)}let s={valvesSpec:l[4]};return l[5]!==void 0&&(s.valves=l[5]),e=new Vu({props:s}),Ae.push(()=>Xe(e,"valves",o)),e.$on("change",l[17]),{c(){ee(e.$$.fragment)},l(i){le(e.$$.fragment,i)},m(i,r){te(e,i,r),n=!0},p(i,r){const a={};r&16&&(a.valvesSpec=i[4]),!t&&r&32&&(t=!0,a.valves=i[5],Ge(()=>t=!1)),e.$set(a)},i(i){n||(C(e.$$.fragment,i),n=!0)},o(i){H(e.$$.fragment,i),n=!1},d(i){ne(e,i)}}}function E0(l){let e,t,n,o;const s=[b0,_0],i=[];function r(a,c){return a[0]&&!a[3]?0:1}return e=r(l),t=i[e]=s[e](l),{c(){t.c(),n=Te()},l(a){t.l(a),n=Te()},m(a,c){i[e].m(a,c),B(a,n,c),o=!0},p(a,[c]){let u=e;e=r(a),e===u?i[e].p(a,c):(Ve(),H(i[u],1,1,()=>{i[u]=null}),ze(),t=i[e],t?t.p(a,c):(t=i[e]=s[e](a),t.c()),C(t,1),t.m(n.parentNode,n))},i(a){o||(C(t),o=!0)},o(a){H(t),o=!1},d(a){a&&p(n),i[e].d(a)}}}function I0(l,e,t){let n,o,s;re(l,fl,O=>t(6,n=O)),re(l,Ts,O=>t(7,o=O));const i=on(),r=Ot("i18n");re(l,r,O=>t(8,s=O));let{show:a=!1}=e,c="tools",u="",f=!1,d=null,h={},_;const b=async()=>{_&&clearTimeout(_),_=setTimeout(()=>{g()},500)},w=async()=>{var O;if(t(3,f=!0),c==="tools"?(t(5,h=await Xc(localStorage.token,u)),t(4,d=await Zc(localStorage.token,u))):c==="functions"&&(t(5,h=await Cu(localStorage.token,u)),t(4,d=await Mu(localStorage.token,u))),d)for(const L in d.properties)((O=d.properties[L])==null?void 0:O.type)==="array"&&t(5,h[L]=(h[L]??[]).join(","),h);t(3,f=!1)},g=async()=>{var O;if(d){for(const L in d.properties)((O=d.properties[L])==null?void 0:O.type)==="array"&&t(5,h[L]=(h[L]??"").split(",").map(W=>W.trim()),h);if(c==="tools"){const L=await qc(localStorage.token,u,h).catch(W=>(ct.error(`${W}`),null));L&&(ct.success(s.t("Valves updated")),t(5,h=L))}else if(c==="functions"){const L=await Tu(localStorage.token,u,h).catch(W=>(ct.error(`${W}`),null));L&&(ct.success(s.t("Valves updated")),t(5,h=L))}}},v=async()=>{t(3,f=!0),o===null&&Ts.set(await Du(localStorage.token)),n===null&&fl.set(await is(localStorage.token)),t(3,f=!1)};function y(){c=Ss(this),t(1,c)}function E(){u=Ss(this),t(2,u),t(1,c)}const z=async()=>{await tt()};function D(O){h=O,t(5,h)}const M=()=>{b()},A=()=>{g(),i("save")};return l.$$set=O=>{"show"in O&&t(0,a=O.show)},l.$$.update=()=>{l.$$.dirty&2&&c&&t(2,u=""),l.$$.dirty&4&&u&&w(),l.$$.dirty&1&&a&&v()},[a,c,u,f,d,h,n,o,s,i,r,b,g,y,E,z,D,M,A]}class S0 extends Oe{constructor(e){super(),He(this,e,I0,E0,Le,{show:0})}}function Ai(l,e,t){const n=l.slice();return n[14]=e[t],n[16]=t,n}function D0(l){let e,t=l[3].t("You do not have permission to access this feature.")+"",n;return{c(){e=T("div"),n=ke(t),this.h()},l(o){e=V(o,"DIV",{class:!0});var s=S(e);n=Ee(s,t),s.forEach(p),this.h()},h(){m(e,"class","text-sm dark:text-gray-300 text-center py-2 px-10")},m(o,s){B(o,e,s),k(e,n)},p(o,s){s&8&&t!==(t=o[3].t("You do not have permission to access this feature.")+"")&&Ce(n,t)},i:De,o:De,d(o){o&&p(e)}}}function C0(l){let e,t,n,o,s,i,r,a,c,u,f,d,h,_=l[0].length>0&&Li(l);function b(g){l[11](g)}let w={title:l[3].t("Valves"),buttonClassName:"w-full",$$slots:{content:[T0]},$$scope:{ctx:l}};return l[2]!==void 0&&(w.open=l[2]),n=new fo({props:w}),Ae.push(()=>Xe(n,"open",b)),a=new fo({props:{title:l[3].t("System Prompt"),open:!0,buttonClassName:"w-full",$$slots:{content:[V0]},$$scope:{ctx:l}}}),d=new fo({props:{title:l[3].t("Advanced Params"),open:!0,buttonClassName:"w-full",$$slots:{content:[z0]},$$scope:{ctx:l}}}),{c(){e=T("div"),_&&_.c(),t=Q(),ee(n.$$.fragment),s=Q(),i=T("hr"),r=Q(),ee(a.$$.fragment),c=Q(),u=T("hr"),f=Q(),ee(d.$$.fragment),this.h()},l(g){e=V(g,"DIV",{class:!0});var v=S(e);_&&_.l(v),t=x(v),le(n.$$.fragment,v),s=x(v),i=V(v,"HR",{class:!0}),r=x(v),le(a.$$.fragment,v),c=x(v),u=V(v,"HR",{class:!0}),f=x(v),le(d.$$.fragment,v),v.forEach(p),this.h()},h(){m(i,"class","my-2 border-gray-50 dark:border-gray-700/10"),m(u,"class","my-2 border-gray-50 dark:border-gray-700/10"),m(e,"class","dark:text-gray-200 text-sm font-primary py-0.5 px-0.5")},m(g,v){B(g,e,v),_&&_.m(e,null),k(e,t),te(n,e,null),k(e,s),k(e,i),k(e,r),te(a,e,null),k(e,c),k(e,u),k(e,f),te(d,e,null),h=!0},p(g,v){g[0].length>0?_?(_.p(g,v),v&1&&C(_,1)):(_=Li(g),_.c(),C(_,1),_.m(e,t)):_&&(Ve(),H(_,1,1,()=>{_=null}),ze());const y={};v&8&&(y.title=g[3].t("Valves")),v&131076&&(y.$$scope={dirty:v,ctx:g}),!o&&v&4&&(o=!0,y.open=g[2],Ge(()=>o=!1)),n.$set(y);const E={};v&8&&(E.title=g[3].t("System Prompt")),v&131082&&(E.$$scope={dirty:v,ctx:g}),a.$set(E);const z={};v&8&&(z.title=g[3].t("Advanced Params")),v&131090&&(z.$$scope={dirty:v,ctx:g}),d.$set(z)},i(g){h||(C(_),C(n.$$.fragment,g),C(a.$$.fragment,g),C(d.$$.fragment,g),h=!0)},o(g){H(_),H(n.$$.fragment,g),H(a.$$.fragment,g),H(d.$$.fragment,g),h=!1},d(g){g&&p(e),_&&_.d(),ne(n),ne(a),ne(d)}}}function Li(l){let e,t,n,o;return e=new fo({props:{title:l[3].t("Files"),open:!0,buttonClassName:"w-full",$$slots:{content:[M0]},$$scope:{ctx:l}}}),{c(){ee(e.$$.fragment),t=Q(),n=T("hr"),this.h()},l(s){le(e.$$.fragment,s),t=x(s),n=V(s,"HR",{class:!0}),this.h()},h(){m(n,"class","my-2 border-gray-50 dark:border-gray-700/10")},m(s,i){te(e,s,i),B(s,t,i),B(s,n,i),o=!0},p(s,i){const r={};i&8&&(r.title=s[3].t("Files")),i&131073&&(r.$$scope={dirty:i,ctx:s}),e.$set(r)},i(s){o||(C(e.$$.fragment,s),o=!0)},o(s){H(e.$$.fragment,s),o=!1},d(s){s&&(p(t),p(n)),ne(e,s)}}}function Bi(l){var s,i;let e,t;function n(){return l[9](l[16])}function o(){return l[10](l[14])}return e=new as({props:{className:"w-full",item:l[14],edit:!0,url:(s=l[14])!=null&&s.url?l[14].url:null,name:l[14].name,type:l[14].type,size:(i=l[14])==null?void 0:i.size,dismissible:!0}}),e.$on("dismiss",n),e.$on("click",o),{c(){ee(e.$$.fragment)},l(r){le(e.$$.fragment,r)},m(r,a){te(e,r,a),t=!0},p(r,a){var u,f;l=r;const c={};a&1&&(c.item=l[14]),a&1&&(c.url=(u=l[14])!=null&&u.url?l[14].url:null),a&1&&(c.name=l[14].name),a&1&&(c.type=l[14].type),a&1&&(c.size=(f=l[14])==null?void 0:f.size),e.$set(c)},i(r){t||(C(e.$$.fragment,r),t=!0)},o(r){H(e.$$.fragment,r),t=!1},d(r){ne(e,r)}}}function M0(l){let e,t,n=ht(l[0]),o=[];for(let i=0;i<n.length;i+=1)o[i]=Bi(Ai(l,n,i));const s=i=>H(o[i],1,1,()=>{o[i]=null});return{c(){e=T("div");for(let i=0;i<o.length;i+=1)o[i].c();this.h()},l(i){e=V(i,"DIV",{class:!0,slot:!0});var r=S(e);for(let a=0;a<o.length;a+=1)o[a].l(r);r.forEach(p),this.h()},h(){m(e,"class","flex flex-col gap-1 mt-1.5"),m(e,"slot","content")},m(i,r){B(i,e,r);for(let a=0;a<o.length;a+=1)o[a]&&o[a].m(e,null);t=!0},p(i,r){if(r&1){n=ht(i[0]);let a;for(a=0;a<n.length;a+=1){const c=Ai(i,n,a);o[a]?(o[a].p(c,r),C(o[a],1)):(o[a]=Bi(c),o[a].c(),C(o[a],1),o[a].m(e,null))}for(Ve(),a=n.length;a<o.length;a+=1)s(a);ze()}},i(i){if(!t){for(let r=0;r<n.length;r+=1)C(o[r]);t=!0}},o(i){o=o.filter(Boolean);for(let r=0;r<o.length;r+=1)H(o[r]);t=!1},d(i){i&&p(e),vn(o,i)}}}function T0(l){let e,t,n;return t=new S0({props:{show:l[2]}}),{c(){e=T("div"),ee(t.$$.fragment),this.h()},l(o){e=V(o,"DIV",{class:!0,slot:!0});var s=S(e);le(t.$$.fragment,s),s.forEach(p),this.h()},h(){m(e,"class","text-sm"),m(e,"slot","content")},m(o,s){B(o,e,s),te(t,e,null),n=!0},p(o,s){const i={};s&4&&(i.show=o[2]),t.$set(i)},i(o){n||(C(t.$$.fragment,o),n=!0)},o(o){H(t.$$.fragment,o),n=!1},d(o){o&&p(e),ne(t)}}}function V0(l){let e,t,n,o,s;return{c(){e=T("div"),t=T("textarea"),this.h()},l(i){e=V(i,"DIV",{class:!0,slot:!0});var r=S(e);t=V(r,"TEXTAREA",{class:!0,rows:!0,placeholder:!0}),S(t).forEach(p),r.forEach(p),this.h()},h(){m(t,"class","w-full text-xs py-1.5 bg-transparent outline-hidden resize-none"),m(t,"rows","4"),m(t,"placeholder",n=l[3].t("Enter system prompt")),m(e,"class",""),m(e,"slot","content")},m(i,r){B(i,e,r),k(e,t),In(t,l[1].system),o||(s=Se(t,"input",l[12]),o=!0)},p(i,r){r&8&&n!==(n=i[3].t("Enter system prompt"))&&m(t,"placeholder",n),r&2&&In(t,i[1].system)},d(i){i&&p(e),o=!1,s()}}}function z0(l){var a;let e,t,n,o,s;function i(c){l[13](c)}let r={admin:((a=l[4])==null?void 0:a.role)==="admin"};return l[1]!==void 0&&(r.params=l[1]),n=new Su({props:r}),Ae.push(()=>Xe(n,"params",i)),{c(){e=T("div"),t=T("div"),ee(n.$$.fragment),this.h()},l(c){e=V(c,"DIV",{class:!0,slot:!0});var u=S(e);t=V(u,"DIV",{});var f=S(t);le(n.$$.fragment,f),f.forEach(p),u.forEach(p),this.h()},h(){m(e,"class","text-sm mt-1.5"),m(e,"slot","content")},m(c,u){B(c,e,u),k(e,t),te(n,t,null),s=!0},p(c,u){var d;const f={};u&16&&(f.admin=((d=c[4])==null?void 0:d.role)==="admin"),!o&&u&2&&(o=!0,f.params=c[1],Ge(()=>o=!1)),n.$set(f)},i(c){s||(C(n.$$.fragment,c),s=!0)},o(c){H(n.$$.fragment,c),s=!1},d(c){c&&p(e),ne(n)}}}function N0(l){let e,t,n,o=l[3].t("Chat Controls")+"",s,i,r,a,c,u,f,d,h,_;a=new zo({props:{className:"size-3.5"}});const b=[C0,D0],w=[];function g(v,y){var E,z;return v[4].role==="admin"||(z=(E=v[4])==null?void 0:E.permissions.chat)!=null&&z.controls?0:1}return u=g(l),f=w[u]=b[u](l),{c(){e=T("div"),t=T("div"),n=T("div"),s=ke(o),i=Q(),r=T("button"),ee(a.$$.fragment),c=Q(),f.c(),this.h()},l(v){e=V(v,"DIV",{class:!0});var y=S(e);t=V(y,"DIV",{class:!0});var E=S(t);n=V(E,"DIV",{class:!0});var z=S(n);s=Ee(z,o),z.forEach(p),i=x(E),r=V(E,"BUTTON",{class:!0});var D=S(r);le(a.$$.fragment,D),D.forEach(p),E.forEach(p),c=x(y),f.l(y),y.forEach(p),this.h()},h(){m(n,"class","text-lg font-medium self-center font-primary"),m(r,"class","self-center"),m(t,"class","flex items-center justify-between dark:text-gray-100 mb-2"),m(e,"class","dark:text-white")},m(v,y){B(v,e,y),k(e,t),k(t,n),k(n,s),k(t,i),k(t,r),te(a,r,null),k(e,c),w[u].m(e,null),d=!0,h||(_=Se(r,"click",l[8]),h=!0)},p(v,[y]){(!d||y&8)&&o!==(o=v[3].t("Chat Controls")+"")&&Ce(s,o);let E=u;u=g(v),u===E?w[u].p(v,y):(Ve(),H(w[E],1,1,()=>{w[E]=null}),ze(),f=w[u],f?f.p(v,y):(f=w[u]=b[u](v),f.c()),C(f,1),f.m(e,null))},i(v){d||(C(a.$$.fragment,v),C(f),d=!0)},o(v){H(a.$$.fragment,v),H(f),d=!1},d(v){v&&p(e),ne(a),w[u].d(),h=!1,_()}}}function P0(l,e,t){let n,o;re(l,Kn,g=>t(4,o=g));const s=on(),i=Ot("i18n");re(l,i,g=>t(3,n=g));let{models:r=[]}=e,{chatFiles:a=[]}=e,{params:c={}}=e,u=!1;const f=()=>{s("close")},d=g=>{a.splice(g,1),t(0,a)},h=g=>{console.log(g)};function _(g){u=g,t(2,u)}function b(){c.system=this.value,t(1,c)}function w(g){c=g,t(1,c)}return l.$$set=g=>{"models"in g&&t(7,r=g.models),"chatFiles"in g&&t(0,a=g.chatFiles),"params"in g&&t(1,c=g.params)},[a,c,u,n,o,s,i,r,f,d,h,_,b,w]}class lc extends Oe{constructor(e){super(),He(this,e,P0,N0,Le,{models:7,chatFiles:0,params:1})}}function Ri(l,e,t){const n=l.slice();return n[10]=e[t],n}function O0(l){let e;const t=l[4].default,n=Qt(t,l,l[8],null);return{c(){n&&n.c()},l(o){n&&n.l(o)},m(o,s){n&&n.m(o,s),e=!0},p(o,s){n&&n.p&&(!e||s&256)&&xt(n,t,o,o[8],e?en(t,o[8],s,null):$t(o[8]),null)},i(o){e||(C(n,o),e=!0)},o(o){H(n,o),e=!1},d(o){n&&n.d(o)}}}function H0(l){var i;let e,t,n=(((i=l[10])==null?void 0:i.label)??"Camera")+"",o,s;return{c(){e=T("div"),t=T("div"),o=ke(n),s=Q(),this.h()},l(r){e=V(r,"DIV",{class:!0});var a=S(e);t=V(a,"DIV",{class:!0});var c=S(t);o=Ee(c,n),c.forEach(p),a.forEach(p),s=x(r),this.h()},h(){m(t,"class","line-clamp-1"),m(e,"class","flex items-center")},m(r,a){B(r,e,a),k(e,t),k(t,o),B(r,s,a)},p(r,a){var c;a&2&&n!==(n=(((c=r[10])==null?void 0:c.label)??"Camera")+"")&&Ce(o,n)},d(r){r&&(p(e),p(s))}}}function Ui(l){let e,t;function n(){return l[5](l[10])}return e=new dn({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",$$slots:{default:[H0]},$$scope:{ctx:l}}}),e.$on("click",n),{c(){ee(e.$$.fragment)},l(o){le(e.$$.fragment,o)},m(o,s){te(e,o,s),t=!0},p(o,s){l=o;const i={};s&258&&(i.$$scope={dirty:s,ctx:l}),e.$set(i)},i(o){t||(C(e.$$.fragment,o),t=!0)},o(o){H(e.$$.fragment,o),t=!1},d(o){ne(e,o)}}}function A0(l){let e,t,n=ht(l[1]),o=[];for(let i=0;i<n.length;i+=1)o[i]=Ui(Ri(l,n,i));const s=i=>H(o[i],1,1,()=>{o[i]=null});return{c(){for(let i=0;i<o.length;i+=1)o[i].c();e=Te()},l(i){for(let r=0;r<o.length;r+=1)o[r].l(i);e=Te()},m(i,r){for(let a=0;a<o.length;a+=1)o[a]&&o[a].m(i,r);B(i,e,r),t=!0},p(i,r){if(r&10){n=ht(i[1]);let a;for(a=0;a<n.length;a+=1){const c=Ri(i,n,a);o[a]?(o[a].p(c,r),C(o[a],1)):(o[a]=Ui(c),o[a].c(),C(o[a],1),o[a].m(e.parentNode,e))}for(Ve(),a=n.length;a<o.length;a+=1)s(a);ze()}},i(i){if(!t){for(let r=0;r<n.length;r+=1)C(o[r]);t=!0}},o(i){o=o.filter(Boolean);for(let r=0;r<o.length;r+=1)H(o[r]);t=!1},d(i){i&&p(e),vn(o,i)}}}function L0(l){let e,t,n;return t=new To({props:{class:"w-full max-w-[180px] rounded-lg px-1 py-1.5 border border-gray-300/30 dark:border-gray-700/50 z-9999 bg-white dark:bg-gray-900 dark:text-white shadow-xs",sideOffset:6,side:"top",align:"start",transition:ql,$$slots:{default:[A0]},$$scope:{ctx:l}}}),{c(){e=T("div"),ee(t.$$.fragment),this.h()},l(o){e=V(o,"DIV",{slot:!0});var s=S(e);le(t.$$.fragment,s),s.forEach(p),this.h()},h(){m(e,"slot","content")},m(o,s){B(o,e,s),te(t,e,null),n=!0},p(o,s){const i={};s&258&&(i.$$scope={dirty:s,ctx:o}),t.$set(i)},i(o){n||(C(t.$$.fragment,o),n=!0)},o(o){H(t.$$.fragment,o),n=!1},d(o){o&&p(e),ne(t)}}}function B0(l){let e,t,n;function o(i){l[6](i)}let s={$$slots:{content:[L0],default:[O0]},$$scope:{ctx:l}};return l[2]!==void 0&&(s.show=l[2]),e=new Mo({props:s}),Ae.push(()=>Xe(e,"show",o)),e.$on("change",l[7]),{c(){ee(e.$$.fragment)},l(i){le(e.$$.fragment,i)},m(i,r){te(e,i,r),n=!0},p(i,[r]){const a={};r&258&&(a.$$scope={dirty:r,ctx:i}),!t&&r&4&&(t=!0,a.show=i[2],Ge(()=>t=!1)),e.$set(a)},i(i){n||(C(e.$$.fragment,i),n=!0)},o(i){H(e.$$.fragment,i),n=!1},d(i){ne(e,i)}}}function R0(l,e,t){let{$$slots:n={},$$scope:o}=e;Ot("i18n");const s=on();let{onClose:i=()=>{}}=e,{devices:r}=e,a=!1;const c=d=>{s("change",d.deviceId)};function u(d){a=d,t(2,a)}const f=d=>{d.detail===!1&&i()};return l.$$set=d=>{"onClose"in d&&t(0,i=d.onClose),"devices"in d&&t(1,r=d.devices),"$$scope"in d&&t(8,o=d.$$scope)},[i,r,a,s,n,c,u,f,o]}class U0 extends Oe{constructor(e){super(),He(this,e,R0,B0,Le,{onClose:0,devices:1})}}function Fi(l){let e,t,n,o,s,i,r,a,c,u,f,d,h,_,b,w='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-5"><path d="M6.28 5.22a.75.75 0 0 0-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 1 0 1.06 1.06L10 11.06l3.72 3.72a.75.75 0 1 0 1.06-1.06L11.06 10l3.72-3.72a.75.75 0 0 0-1.06-1.06L10 8.94 6.28 5.22Z"></path></svg>',g,v,y,E=l[4]&&Wi(l);function z(I,P){return I[4]?Y0:K0}let D=z(l),M=D(l);const A=[J0,q0],O=[];function L(I,P){return I[4]?0:1}r=L(l),a=O[r]=A[r](l);function W(I,P){return I[1]?tp:I[2]?ep:$0}let K=W(l),R=K(l);return{c(){e=T("div"),E&&E.c(),t=Q(),n=T("div"),M.c(),o=Q(),s=T("div"),i=T("div"),a.c(),c=Q(),u=T("div"),f=T("button"),d=T("div"),R.c(),h=Q(),_=T("div"),b=T("button"),b.innerHTML=w,this.h()},l(I){e=V(I,"DIV",{class:!0});var P=S(e);E&&E.l(P),t=x(P),n=V(P,"DIV",{class:!0});var N=S(n);M.l(N),N.forEach(p),o=x(P),s=V(P,"DIV",{class:!0});var Y=S(s);i=V(Y,"DIV",{});var Z=S(i);a.l(Z),Z.forEach(p),c=x(Y),u=V(Y,"DIV",{});var F=S(u);f=V(F,"BUTTON",{type:!0});var X=S(f);d=V(X,"DIV",{class:!0});var se=S(d);R.l(se),se.forEach(p),X.forEach(p),F.forEach(p),h=x(Y),_=V(Y,"DIV",{});var q=S(_);b=V(q,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),it(b)!=="svelte-1k5eavb"&&(b.innerHTML=w),q.forEach(p),Y.forEach(p),P.forEach(p),this.h()},h(){m(n,"class","flex justify-center items-center flex-1 h-full w-full max-h-full"),m(d,"class","line-clamp-1 text-sm font-medium"),m(f,"type","button"),m(b,"class","p-3 rounded-full bg-gray-50 dark:bg-gray-900"),m(b,"type","button"),m(s,"class","flex justify-between items-center pb-2 w-full"),m(e,"class","max-w-lg w-full h-full max-h-[100dvh] flex flex-col justify-between p-3 md:p-6")},m(I,P){B(I,e,P),E&&E.m(e,null),k(e,t),k(e,n),M.m(n,null),k(e,o),k(e,s),k(s,i),O[r].m(i,null),k(s,c),k(s,u),k(u,f),k(f,d),R.m(d,null),k(s,h),k(s,_),k(_,b),g=!0,v||(y=[Se(f,"click",l[31]),Se(b,"click",l[32])],v=!0)},p(I,P){I[4]?E?E.p(I,P):(E=Wi(I),E.c(),E.m(e,t)):E&&(E.d(1),E=null),D===(D=z(I))&&M?M.p(I,P):(M.d(1),M=D(I),M&&(M.c(),M.m(n,null)));let N=r;r=L(I),r===N?O[r].p(I,P):(Ve(),H(O[N],1,1,()=>{O[N]=null}),ze(),a=O[r],a?a.p(I,P):(a=O[r]=A[r](I),a.c()),C(a,1),a.m(i,null)),K===(K=W(I))&&R?R.p(I,P):(R.d(1),R=K(I),R&&(R.c(),R.m(d,null)))},i(I){g||(C(a),g=!0)},o(I){H(a),g=!1},d(I){I&&p(e),E&&E.d(),M.d(),O[r].d(),R.d(),v=!1,sn(y)}}}function Wi(l){let e,t,n;function o(r,a){return r[3]?j0:r[1]||r[2]?W0:F0}let s=o(l),i=s(l);return{c(){e=T("button"),i.c(),this.h()},l(r){e=V(r,"BUTTON",{type:!0,class:!0});var a=S(e);i.l(a),a.forEach(p),this.h()},h(){m(e,"type","button"),m(e,"class","flex justify-center items-center w-full h-20 min-h-20")},m(r,a){B(r,e,a),i.m(e,null),t||(n=Se(e,"click",l[26]),t=!0)},p(r,a){s===(s=o(r))&&i?i.p(r,a):(i.d(1),i=s(r),i&&(i.c(),i.m(e,null)))},d(r){r&&p(e),i.d(),t=!1,n()}}}function F0(l){let e,t,n;return{c(){e=T("div"),this.h()},l(o){e=V(o,"DIV",{class:!0,style:!0}),S(e).forEach(p),this.h()},h(){var o,s,i,r,a,c,u,f,d;m(e,"class",t=(l[6]*100>4?" size-[4.5rem]":l[6]*100>2?" size-16":l[6]*100>1?"size-14":"size-12")+" transition-all rounded-full "+((((i=(s=(o=l[0])==null?void 0:o.info)==null?void 0:s.meta)==null?void 0:i.profile_image_url)??"/static/favicon.png")!=="/static/favicon.png"?" bg-cover bg-center bg-no-repeat":"bg-black dark:bg-white")+" bg-black dark:bg-white"),m(e,"style",n=(((c=(a=(r=l[0])==null?void 0:r.info)==null?void 0:a.meta)==null?void 0:c.profile_image_url)??"/static/favicon.png")!=="/static/favicon.png"?`background-image: url('${(d=(f=(u=l[0])==null?void 0:u.info)==null?void 0:f.meta)==null?void 0:d.profile_image_url}');`:"")},m(o,s){B(o,e,s)},p(o,s){var i,r,a,c,u,f,d,h,_;s[0]&65&&t!==(t=(o[6]*100>4?" size-[4.5rem]":o[6]*100>2?" size-16":o[6]*100>1?"size-14":"size-12")+" transition-all rounded-full "+((((a=(r=(i=o[0])==null?void 0:i.info)==null?void 0:r.meta)==null?void 0:a.profile_image_url)??"/static/favicon.png")!=="/static/favicon.png"?" bg-cover bg-center bg-no-repeat":"bg-black dark:bg-white")+" bg-black dark:bg-white")&&m(e,"class",t),s[0]&1&&n!==(n=(((f=(u=(c=o[0])==null?void 0:c.info)==null?void 0:u.meta)==null?void 0:f.profile_image_url)??"/static/favicon.png")!=="/static/favicon.png"?`background-image: url('${(_=(h=(d=o[0])==null?void 0:d.info)==null?void 0:h.meta)==null?void 0:_.profile_image_url}');`:"")&&m(e,"style",n)},d(o){o&&p(e)}}}function W0(l){let e,t,n,o,s,i;return{c(){e=_e("svg"),t=_e("style"),n=ke(`.spinner_qM83 {
								animation: spinner_8HQG 1.05s infinite;
							}
							.spinner_oXPr {
								animation-delay: 0.1s;
							}
							.spinner_ZTLf {
								animation-delay: 0.2s;
							}
							@keyframes spinner_8HQG {
								0%,
								57.14% {
									animation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);
									transform: translate(0);
								}
								28.57% {
									animation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);
									transform: translateY(-6px);
								}
								100% {
									transform: translate(0);
								}
							}
						`),o=_e("circle"),s=_e("circle"),i=_e("circle"),this.h()},l(r){e=be(r,"svg",{class:!0,viewBox:!0,fill:!0,xmlns:!0});var a=S(e);t=be(a,"style",{});var c=S(t);n=Ee(c,`.spinner_qM83 {
								animation: spinner_8HQG 1.05s infinite;
							}
							.spinner_oXPr {
								animation-delay: 0.1s;
							}
							.spinner_ZTLf {
								animation-delay: 0.2s;
							}
							@keyframes spinner_8HQG {
								0%,
								57.14% {
									animation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);
									transform: translate(0);
								}
								28.57% {
									animation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);
									transform: translateY(-6px);
								}
								100% {
									transform: translate(0);
								}
							}
						`),c.forEach(p),o=be(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),S(o).forEach(p),s=be(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),S(s).forEach(p),i=be(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),S(i).forEach(p),a.forEach(p),this.h()},h(){m(o,"class","spinner_qM83"),m(o,"cx","4"),m(o,"cy","12"),m(o,"r","3"),m(s,"class","spinner_qM83 spinner_oXPr"),m(s,"cx","12"),m(s,"cy","12"),m(s,"r","3"),m(i,"class","spinner_qM83 spinner_ZTLf"),m(i,"cx","20"),m(i,"cy","12"),m(i,"r","3"),m(e,"class","size-12 text-gray-900 dark:text-gray-400"),m(e,"viewBox","0 0 24 24"),m(e,"fill","currentColor"),m(e,"xmlns","http://www.w3.org/2000/svg")},m(r,a){B(r,e,a),k(e,t),k(t,n),k(e,o),k(e,s),k(e,i)},p:De,d(r){r&&p(e)}}}function j0(l){let e,t;return{c(){e=T("div"),t=ke(l[3]),this.h()},l(n){e=V(n,"DIV",{class:!0,style:!0});var o=S(e);t=Ee(o,l[3]),o.forEach(p),this.h()},h(){m(e,"class","transition-all rounded-full"),$e(e,"font-size",(l[6]*100>4?"4.5":l[6]*100>2?"4.25":l[6]*100>1?"3.75":"3.5")+"rem"),$e(e,"width","100%"),$e(e,"text-align","center")},m(n,o){B(n,e,o),k(e,t)},p(n,o){o[0]&8&&Ce(t,n[3]),o[0]&64&&$e(e,"font-size",(n[6]*100>4?"4.5":n[6]*100>2?"4.25":n[6]*100>1?"3.75":"3.5")+"rem")},d(n){n&&p(e)}}}function Y0(l){let e,t,n,o,s,i,r,a='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-6"><path d="M5.28 4.22a.75.75 0 0 0-1.06 1.06L6.94 8l-2.72 2.72a.75.75 0 1 0 1.06 1.06L8 9.06l2.72 2.72a.75.75 0 1 0 1.06-1.06L9.06 8l2.72-2.72a.75.75 0 0 0-1.06-1.06L8 6.94 5.28 4.22Z"></path></svg>',c,u;return{c(){e=T("div"),t=T("video"),n=Q(),o=T("canvas"),s=Q(),i=T("div"),r=T("button"),r.innerHTML=a,this.h()},l(f){e=V(f,"DIV",{class:!0});var d=S(e);t=V(d,"VIDEO",{id:!0,class:!0}),S(t).forEach(p),n=x(d),o=V(d,"CANVAS",{id:!0,style:!0}),S(o).forEach(p),s=x(d),i=V(d,"DIV",{class:!0});var h=S(i);r=V(h,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),it(r)!=="svelte-16ul42n"&&(r.innerHTML=a),h.forEach(p),d.forEach(p),this.h()},h(){m(t,"id","camera-feed"),t.autoplay=!0,m(t,"class","rounded-2xl h-full min-w-full object-cover object-center"),t.playsInline=!0,m(o,"id","camera-canvas"),$e(o,"display","none"),m(r,"type","button"),m(r,"class","p-1.5 text-white cursor-pointer backdrop-blur-xl bg-black/10 rounded-full"),m(i,"class","absolute top-4 md:top-8 left-4"),m(e,"class","relative flex video-container w-full max-h-full pt-2 pb-4 md:py-6 px-2 h-full")},m(f,d){B(f,e,d),k(e,t),k(e,n),k(e,o),k(e,s),k(e,i),k(i,r),c||(u=Se(r,"click",l[28]),c=!0)},p:De,d(f){f&&p(e),c=!1,u()}}}function K0(l){let e,t,n;function o(r,a){return r[3]?Z0:r[1]||r[2]?X0:G0}let s=o(l),i=s(l);return{c(){e=T("button"),i.c(),this.h()},l(r){e=V(r,"BUTTON",{type:!0});var a=S(e);i.l(a),a.forEach(p),this.h()},h(){m(e,"type","button")},m(r,a){B(r,e,a),i.m(e,null),t||(n=Se(e,"click",l[27]),t=!0)},p(r,a){s===(s=o(r))&&i?i.p(r,a):(i.d(1),i=s(r),i&&(i.c(),i.m(e,null)))},d(r){r&&p(e),i.d(),t=!1,n()}}}function G0(l){let e,t,n;return{c(){e=T("div"),this.h()},l(o){e=V(o,"DIV",{class:!0,style:!0}),S(e).forEach(p),this.h()},h(){var o,s,i,r,a,c,u,f,d;m(e,"class",t=(l[6]*100>4?" size-52":l[6]*100>2?"size-48":l[6]*100>1?"size-44":"size-40")+" transition-all rounded-full "+((((i=(s=(o=l[0])==null?void 0:o.info)==null?void 0:s.meta)==null?void 0:i.profile_image_url)??"/static/favicon.png")!=="/static/favicon.png"?" bg-cover bg-center bg-no-repeat":"bg-black dark:bg-white")),m(e,"style",n=(((c=(a=(r=l[0])==null?void 0:r.info)==null?void 0:a.meta)==null?void 0:c.profile_image_url)??"/static/favicon.png")!=="/static/favicon.png"?`background-image: url('${(d=(f=(u=l[0])==null?void 0:u.info)==null?void 0:f.meta)==null?void 0:d.profile_image_url}');`:"")},m(o,s){B(o,e,s)},p(o,s){var i,r,a,c,u,f,d,h,_;s[0]&65&&t!==(t=(o[6]*100>4?" size-52":o[6]*100>2?"size-48":o[6]*100>1?"size-44":"size-40")+" transition-all rounded-full "+((((a=(r=(i=o[0])==null?void 0:i.info)==null?void 0:r.meta)==null?void 0:a.profile_image_url)??"/static/favicon.png")!=="/static/favicon.png"?" bg-cover bg-center bg-no-repeat":"bg-black dark:bg-white"))&&m(e,"class",t),s[0]&1&&n!==(n=(((f=(u=(c=o[0])==null?void 0:c.info)==null?void 0:u.meta)==null?void 0:f.profile_image_url)??"/static/favicon.png")!=="/static/favicon.png"?`background-image: url('${(_=(h=(d=o[0])==null?void 0:d.info)==null?void 0:h.meta)==null?void 0:_.profile_image_url}');`:"")&&m(e,"style",n)},d(o){o&&p(e)}}}function X0(l){let e,t,n,o,s,i;return{c(){e=_e("svg"),t=_e("style"),n=ke(`.spinner_qM83 {
									animation: spinner_8HQG 1.05s infinite;
								}
								.spinner_oXPr {
									animation-delay: 0.1s;
								}
								.spinner_ZTLf {
									animation-delay: 0.2s;
								}
								@keyframes spinner_8HQG {
									0%,
									57.14% {
										animation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);
										transform: translate(0);
									}
									28.57% {
										animation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);
										transform: translateY(-6px);
									}
									100% {
										transform: translate(0);
									}
								}
							`),o=_e("circle"),s=_e("circle"),i=_e("circle"),this.h()},l(r){e=be(r,"svg",{class:!0,viewBox:!0,fill:!0,xmlns:!0});var a=S(e);t=be(a,"style",{});var c=S(t);n=Ee(c,`.spinner_qM83 {
									animation: spinner_8HQG 1.05s infinite;
								}
								.spinner_oXPr {
									animation-delay: 0.1s;
								}
								.spinner_ZTLf {
									animation-delay: 0.2s;
								}
								@keyframes spinner_8HQG {
									0%,
									57.14% {
										animation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);
										transform: translate(0);
									}
									28.57% {
										animation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);
										transform: translateY(-6px);
									}
									100% {
										transform: translate(0);
									}
								}
							`),c.forEach(p),o=be(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),S(o).forEach(p),s=be(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),S(s).forEach(p),i=be(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),S(i).forEach(p),a.forEach(p),this.h()},h(){m(o,"class","spinner_qM83"),m(o,"cx","4"),m(o,"cy","12"),m(o,"r","3"),m(s,"class","spinner_qM83 spinner_oXPr"),m(s,"cx","12"),m(s,"cy","12"),m(s,"r","3"),m(i,"class","spinner_qM83 spinner_ZTLf"),m(i,"cx","20"),m(i,"cy","12"),m(i,"r","3"),m(e,"class","size-44 text-gray-900 dark:text-gray-400"),m(e,"viewBox","0 0 24 24"),m(e,"fill","currentColor"),m(e,"xmlns","http://www.w3.org/2000/svg")},m(r,a){B(r,e,a),k(e,t),k(t,n),k(e,o),k(e,s),k(e,i)},p:De,d(r){r&&p(e)}}}function Z0(l){let e,t;return{c(){e=T("div"),t=ke(l[3]),this.h()},l(n){e=V(n,"DIV",{class:!0,style:!0});var o=S(e);t=Ee(o,l[3]),o.forEach(p),this.h()},h(){m(e,"class","transition-all rounded-full"),$e(e,"font-size",(l[6]*100>4?"13":l[6]*100>2?"12":l[6]*100>1?"11.5":"11")+"rem"),$e(e,"width","100%"),$e(e,"text-align","center")},m(n,o){B(n,e,o),k(e,t)},p(n,o){o[0]&8&&Ce(t,n[3]),o[0]&64&&$e(e,"font-size",(n[6]*100>4?"13":n[6]*100>2?"12":n[6]*100>1?"11.5":"11")+"rem")},d(n){n&&p(e)}}}function q0(l){let e,t;return e=new Ft({props:{content:l[11].t("Camera"),$$slots:{default:[Q0]},$$scope:{ctx:l}}}),{c(){ee(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,o){te(e,n,o),t=!0},p(n,o){const s={};o[0]&2048&&(s.content=n[11].t("Camera")),o[2]&16&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}function J0(l){let e,t;return e=new U0({props:{devices:l[8],$$slots:{default:[x0]},$$scope:{ctx:l}}}),e.$on("change",l[29]),{c(){ee(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,o){te(e,n,o),t=!0},p(n,o){const s={};o[0]&256&&(s.devices=n[8]),o[2]&16&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}function Q0(l){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5"><path stroke-linecap="round" stroke-linejoin="round" d="M6.827 6.175A2.31 2.31 0 0 1 5.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 0 0-1.134-.175 2.31 2.31 0 0 1-1.64-1.055l-.822-1.316a2.192 2.192 0 0 0-1.736-1.039 48.774 48.774 0 0 0-5.232 0 2.192 2.192 0 0 0-1.736 1.039l-.821 1.316Z"></path><path stroke-linecap="round" stroke-linejoin="round" d="M16.5 12.75a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0ZM18.75 10.5h.008v.008h-.008V10.5Z"></path></svg>',n,o;return{c(){e=T("button"),e.innerHTML=t,this.h()},l(s){e=V(s,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),it(e)!=="svelte-1n1gs9g"&&(e.innerHTML=t),this.h()},h(){m(e,"class","p-3 rounded-full bg-gray-50 dark:bg-gray-900"),m(e,"type","button")},m(s,i){B(s,e,i),n||(o=Se(e,"click",l[30]),n=!0)},p:De,d(s){s&&p(e),n=!1,o()}}}function x0(l){let e,t='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-5"><path fill-rule="evenodd" d="M15.312 11.424a5.5 5.5 0 0 1-9.201 2.466l-.312-.311h2.433a.75.75 0 0 0 0-1.5H3.989a.75.75 0 0 0-.75.75v4.242a.75.75 0 0 0 1.5 0v-2.43l.31.31a7 7 0 0 0 11.712-3.138.75.75 0 0 0-1.449-.39Zm1.23-3.723a.75.75 0 0 0 .219-.53V2.929a.75.75 0 0 0-1.5 0V5.36l-.31-.31A7 7 0 0 0 3.239 8.188a.75.75 0 1 0 1.448.389A5.5 5.5 0 0 1 13.89 6.11l.311.31h-2.432a.75.75 0 0 0 0 1.5h4.243a.75.75 0 0 0 .53-.219Z" clip-rule="evenodd"></path></svg>';return{c(){e=T("button"),e.innerHTML=t,this.h()},l(n){e=V(n,"BUTTON",{class:!0,type:!0,"data-svelte-h":!0}),it(e)!=="svelte-5e0pue"&&(e.innerHTML=t),this.h()},h(){m(e,"class","p-3 rounded-full bg-gray-50 dark:bg-gray-900"),m(e,"type","button")},m(n,o){B(n,e,o)},p:De,d(n){n&&p(e)}}}function $0(l){let e=l[11].t("Listening...")+"",t;return{c(){t=ke(e)},l(n){t=Ee(n,e)},m(n,o){B(n,t,o)},p(n,o){o[0]&2048&&e!==(e=n[11].t("Listening...")+"")&&Ce(t,e)},d(n){n&&p(t)}}}function ep(l){let e=l[11].t("Tap to interrupt")+"",t;return{c(){t=ke(e)},l(n){t=Ee(n,e)},m(n,o){B(n,t,o)},p(n,o){o[0]&2048&&e!==(e=n[11].t("Tap to interrupt")+"")&&Ce(t,e)},d(n){n&&p(t)}}}function tp(l){let e=l[11].t("Thinking...")+"",t;return{c(){t=ke(e)},l(n){t=Ee(n,e)},m(n,o){B(n,t,o)},p(n,o){o[0]&2048&&e!==(e=n[11].t("Thinking...")+"")&&Ce(t,e)},d(n){n&&p(t)}}}function np(l){let e,t,n=l[10]&&Fi(l);return{c(){n&&n.c(),e=Te()},l(o){n&&n.l(o),e=Te()},m(o,s){n&&n.m(o,s),B(o,e,s),t=!0},p(o,s){o[10]?n?(n.p(o,s),s[0]&1024&&C(n,1)):(n=Fi(o),n.c(),C(n,1),n.m(e.parentNode,e)):n&&(Ve(),H(n,1,1,()=>{n=null}),ze())},i(o){t||(C(n),t=!0)},o(o){H(n),t=!1},d(o){o&&p(e),n&&n.d(o)}}}function lp(l,e,t){let n,o,s,i,r,a;re(l,hl,fe=>t(45,n=fe)),re(l,Do,fe=>t(46,o=fe)),re(l,Fn,fe=>t(47,s=fe)),re(l,Qo,fe=>t(48,i=fe)),re(l,En,fe=>t(10,r=fe));const c=on(),u=Ot("i18n");re(l,u,fe=>t(11,a=fe));let{eventTarget:f}=e,{submitPrompt:d}=e,{stopResponse:h}=e,{files:_}=e,{chatId:b}=e,{modelId:w}=e,g=null,v=null,y=!1,E=!1,z=!1,D=null,M=!1,A=null,O=!1,L=0,W=!1,K,R=null,I=[],P=[],N=null;const Y=async()=>{const fe=await navigator.mediaDevices.enumerateDevices();t(8,P=fe.filter(We=>We.kind==="videoinput")),navigator.mediaDevices.getDisplayMedia&&t(8,P=[...P,{deviceId:"screen",label:"Screen Share"}]),console.log(P),N===null&&P.length>0&&t(9,N=P[0].deviceId)},Z=async()=>{if(await Y(),A===null){t(4,M=!0),await tt();try{await F()}catch(fe){console.error("Error accessing webcam: ",fe)}}},F=async()=>{const fe=document.getElementById("camera-feed");fe&&(N==="screen"?t(5,A=await navigator.mediaDevices.getDisplayMedia({video:{cursor:"always"},audio:!1})):t(5,A=await navigator.mediaDevices.getUserMedia({video:{deviceId:N?{exact:N}:void 0}})),A&&(await Y(),fe.srcObject=A,await fe.play()))},X=async()=>{A&&A.getTracks().forEach(We=>We.stop()),t(5,A=null)},se=()=>{const fe=document.getElementById("camera-feed"),We=document.getElementById("camera-canvas");if(!We)return;const Be=We.getContext("2d");We.width=fe.videoWidth,We.height=fe.videoHeight,Be.drawImage(fe,0,0,fe.videoWidth,fe.videoHeight);const Je=We.toDataURL("image/png");return console.log(Je),Je},q=async()=>{await X(),t(4,M=!1)},G=-55,oe=async fe=>{await tt();const We=Vc(fe,"recording.wav"),Be=await Pu(localStorage.token,We).catch(Je=>(ct.error(`${Je}`),null));if(Be&&(console.log(Be.text),Be.text!=="")){const Je=await d(Be.text,{_raw:!0});console.log(Je)}},ae=async(fe=!0)=>{if(r){console.log("%c%s","color: red; font-size: 20px;","ðŸš¨ stopRecordingCallback ðŸš¨");const We=I.slice(0);if(I=[],K=!1,fe&&ve(),E){if(t(1,y=!0),t(3,D=null),A){const Je=se();t(20,_=[{type:"image",url:Je}])}const Be=new Blob(We,{type:"audio/wav"});await oe(Be),E=!1,t(1,y=!1)}}else I=[],K=!1,R&&R.getTracks().forEach(Be=>Be.stop()),t(7,R=null)},ve=async()=>{r&&(R||t(7,R=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}})),K=new MediaRecorder(R),K.onstart=()=>{console.log("Recording started"),I=[],Ne(R)},K.ondataavailable=fe=>{W&&I.push(fe.data)},K.onstop=fe=>{console.log("Recording stopped",R,fe),ae()},K.start())},$=async()=>{try{K&&K.stop()}catch(fe){console.log("Error stopping audio stream:",fe)}R&&(R.getAudioTracks().forEach(function(fe){fe.stop()}),t(7,R=null))},Ie=fe=>{let We=0;for(let Be=0;Be<fe.length;Be++){const Je=(fe[Be]-128)/128;We+=Je*Je}return Math.sqrt(We/fe.length)},Ne=fe=>{const We=new AudioContext,Be=We.createMediaStreamSource(fe),Je=We.createAnalyser();Je.minDecibels=G,Be.connect(Je);const wt=Je.frequencyBinCount,bt=new Uint8Array(wt),Mt=new Uint8Array(Je.fftSize);let Tt=Date.now();W=!1,console.log("ðŸ”Š Sound detection started",Tt,W),(()=>{const Bt=()=>{if(!K||!r)return;if(z&&!((s==null?void 0:s.voiceInterruption)??!1)?(Je.maxDecibels=0,Je.minDecibels=-1):(Je.minDecibels=G,Je.maxDecibels=-30),Je.getByteTimeDomainData(Mt),Je.getByteFrequencyData(bt),t(6,L=Ie(Mt)),bt.some(Yt=>Yt>0)&&(console.log("%c%s","color: red; font-size: 20px;","ðŸ”Š Sound detected"),W||(W=!0,Ue()),Tt=Date.now()),W&&Date.now()-Tt>2e3&&(E=!0,K)){console.log("%c%s","color: red; font-size: 20px;","ðŸ”‡ Silence detected"),K.stop();return}window.requestAnimationFrame(Bt)};window.requestAnimationFrame(Bt)})()};let ce={},Ze=null,Qe=null;const ge=fe=>r?new Promise(We=>{let Be=[];const Je=setInterval(async()=>{var wt,bt,Mt;if(Be=await speechSynthesis.getVoices(),Be.length>0){clearInterval(Je);const Tt=((wt=Be==null?void 0:Be.filter(rn=>{var Bt,Rt,Yt,Kt;return rn.voiceURI===(((Rt=(Bt=s==null?void 0:s.audio)==null?void 0:Bt.tts)==null?void 0:Rt.voice)??((Kt=(Yt=o==null?void 0:o.audio)==null?void 0:Yt.tts)==null?void 0:Kt.voice))}))==null?void 0:wt.at(0))??void 0;Qe=new SpeechSynthesisUtterance(fe),Qe.rate=((Mt=(bt=s.audio)==null?void 0:bt.tts)==null?void 0:Mt.playbackRate)??1,Tt&&(Qe.voice=Tt),speechSynthesis.speak(Qe),Qe.onend=async rn=>{await new Promise(Bt=>setTimeout(Bt,200)),We(rn)}}},100)}):Promise.resolve(),ie=fe=>r?new Promise(We=>{var Je,wt;const Be=document.getElementById("audioElement");Be&&(Be.src=fe.src,Be.muted=!0,Be.playbackRate=((wt=(Je=s.audio)==null?void 0:Je.tts)==null?void 0:wt.playbackRate)??1,Be.play().then(()=>{Be.muted=!1}).catch(bt=>{console.error(bt)}),Be.onended=async bt=>{await new Promise(Mt=>setTimeout(Mt,100)),We(bt)})}):Promise.resolve(),Ue=async()=>{t(2,z=!1),O&&h(),Qe&&(speechSynthesis.cancel(),Qe=null);const fe=document.getElementById("audioElement");fe&&(fe.muted=!0,fe.pause(),fe.currentTime=0)};let et=new AbortController;const at=new Map,_t=new Map,nt=async fe=>{var We,Be,Je,wt,bt,Mt,Tt,rn,Bt,Rt,Yt,Kt,tn,an;if(!at.has(fe))try{if((s==null?void 0:s.showEmojiInCall)??!1){const Pt=await jc(localStorage.token,w,fe,b);Pt&&_t.set(fe,Pt)}if(((Be=(We=s.audio)==null?void 0:We.tts)==null?void 0:Be.engine)==="browser-kokoro"){const Pt=await i.generate({text:fe,voice:((wt=(Je=s==null?void 0:s.audio)==null?void 0:Je.tts)==null?void 0:wt.voice)??((Mt=(bt=o==null?void 0:o.audio)==null?void 0:bt.tts)==null?void 0:Mt.voice)}).catch(yt=>{console.error(yt),ct.error(`${yt}`)});Pt&&at.set(fe,new Audio(Pt))}else if(o.audio.tts.engine!==""){const Pt=await Nu(localStorage.token,((rn=(Tt=s==null?void 0:s.audio)==null?void 0:Tt.tts)==null?void 0:rn.defaultVoice)===o.audio.tts.voice?((Rt=(Bt=s==null?void 0:s.audio)==null?void 0:Bt.tts)==null?void 0:Rt.voice)??((Kt=(Yt=o==null?void 0:o.audio)==null?void 0:Yt.tts)==null?void 0:Kt.voice):(an=(tn=o==null?void 0:o.audio)==null?void 0:tn.tts)==null?void 0:an.voice,fe).catch(yt=>(console.error(yt),null));if(Pt){const yt=await Pt.blob(),wn=URL.createObjectURL(yt);at.set(fe,new Audio(wn))}}else at.set(fe,!0)}catch(Pt){console.error("Error synthesizing speech:",Pt)}return at.get(fe)};let mt={};const jt=async(fe,We)=>{for(;!We.aborted;)if(mt[fe]&&mt[fe].length>0){const Be=mt[fe].shift();if(at.has(Be))if(((s==null?void 0:s.showEmojiInCall)??!1)&&_t.has(Be)?t(3,D=_t.get(Be)):t(3,D=null),o.audio.tts.engine!=="")try{console.log("%c%s","color: red; font-size: 20px;",`Playing audio for content: ${Be}`);const Je=at.get(Be);await ie(Je),console.log(`Played audio for content: ${Be}`),await new Promise(wt=>setTimeout(wt,200))}catch(Je){console.error("Error playing audio:",Je)}else await ge(Be);else mt[fe].unshift(Be),console.log(`Audio for "${Be}" not yet available in the cache, re-queued...`),await new Promise(Je=>setTimeout(Je,200))}else if(ce[fe]&&mt[fe]&&mt[fe].length===0){t(2,z=!1);break}else await new Promise(Be=>setTimeout(Be,200));console.log(`Audio monitoring and playing stopped for message ID ${fe}`)},Ht=async fe=>{const{id:We}=fe.detail;O=!0,Ze!==We&&(console.log(`Received chat start event for message ID ${We}`),Ze=We,et&&et.abort(),et=new AbortController,t(2,z=!0),jt(We,et.signal))},gt=async fe=>{const{id:We,content:Be}=fe.detail;if(Ze===We){console.log(`Received chat event for message ID ${We}: ${Be}`);try{mt[We]===void 0?mt[We]=[Be]:mt[We].push(Be),console.log(Be),nt(Be)}catch(Je){console.error("Failed to fetch or play audio:",Je)}}},At=async fe=>{const{id:We,content:Be}=fe.detail;ce[We]=!0,O=!1};hn(async()=>{const fe=async()=>{try{g=await navigator.wakeLock.request("screen")}catch(We){console.log(We)}g&&g.addEventListener("release",()=>{console.log("Wake Lock released")})};return"wakeLock"in navigator&&(await fe(),document.addEventListener("visibilitychange",async()=>{g!==null&&document.visibilityState==="visible"&&await fe()})),t(0,v=n.find(We=>We.id===w)),ve(),f.addEventListener("chat:start",Ht),f.addEventListener("chat",gt),f.addEventListener("chat:finish",At),async()=>{await Ue(),$(),f.removeEventListener("chat:start",Ht),f.removeEventListener("chat",gt),f.removeEventListener("chat:finish",At),et.abort(),await tt(),await Ue(),await ae(!1),await q()}}),$n(async()=>{await Ue(),await ae(!1),await q(),await $(),f.removeEventListener("chat:start",Ht),f.removeEventListener("chat",gt),f.removeEventListener("chat:finish",At),et.abort(),await tt(),await Ue()});const me=()=>{z&&Ue()},Lt=()=>{z&&Ue()},Et=()=>{q()},Ct=async fe=>{console.log(fe.detail),t(9,N=fe.detail),await X(),await F()},Pe=async()=>{await navigator.mediaDevices.getUserMedia({video:!0}),Z()},qt=()=>{z&&Ue()},It=async()=>{await $(),await X(),console.log(R),console.log(A),En.set(!1),c("close")};return l.$$set=fe=>{"eventTarget"in fe&&t(21,f=fe.eventTarget),"submitPrompt"in fe&&t(22,d=fe.submitPrompt),"stopResponse"in fe&&t(23,h=fe.stopResponse),"files"in fe&&t(20,_=fe.files),"chatId"in fe&&t(24,b=fe.chatId),"modelId"in fe&&t(25,w=fe.modelId)},[v,y,z,D,M,A,L,R,P,N,r,a,c,u,Z,F,X,q,$,Ue,_,f,d,h,b,w,me,Lt,Et,Ct,Pe,qt,It]}class oc extends Oe{constructor(e){super(),He(this,e,lp,np,Le,{eventTarget:21,submitPrompt:22,stopResponse:23,files:20,chatId:24,modelId:25},null,[-1,-1,-1])}}function op(l){var E,z,D,M,A,O,L,W,K,R;let e,t,n,o,s,i,r=(((z=(E=l[0])==null?void 0:E.model)==null?void 0:z.name)??((M=(D=l[0])==null?void 0:D.message)==null?void 0:M.model)??"Assistant")+"",a,c,u,f,d,h,_,b,w;t=new va({props:{src:((W=(L=(O=(A=l[0])==null?void 0:A.model)==null?void 0:O.info)==null?void 0:L.meta)==null?void 0:W.profile_image_url)??"",className:"size-5 -translate-y-[1px]"}}),f=new zu({props:{className:"size-3 "+((R=(K=l[0])==null?void 0:K.message)!=null&&R.favorite?"fill-red-500 stroke-red-500":"hover:fill-red-500 hover:stroke-red-500")+" ",strokeWidth:"2.5"}});function g(I,P){var N,Y;return(Y=(N=I[0])==null?void 0:N.message)!=null&&Y.error?ip:rp}let v=g(l),y=v(l);return{c(){e=T("div"),ee(t.$$.fragment),n=Q(),o=T("div"),s=T("div"),i=T("div"),a=ke(r),c=Q(),u=T("button"),ee(f.$$.fragment),h=Q(),y.c(),this.h()},l(I){e=V(I,"DIV",{class:!0});var P=S(e);le(t.$$.fragment,P),n=x(P),o=V(P,"DIV",{class:!0});var N=S(o);s=V(N,"DIV",{class:!0});var Y=S(s);i=V(Y,"DIV",{class:!0});var Z=S(i);a=Ee(Z,r),Z.forEach(p),c=x(Y),u=V(Y,"BUTTON",{class:!0});var F=S(u);le(f.$$.fragment,F),F.forEach(p),Y.forEach(p),h=x(N),y.l(N),N.forEach(p),P.forEach(p),this.h()},h(){var I,P;m(i,"class","text-xs text-black dark:text-white font-medium line-clamp-1"),m(u,"class",d=(P=(I=l[0])==null?void 0:I.message)!=null&&P.favorite?"":"invisible group-hover:visible"),m(s,"class","flex justify-between items-center"),m(o,"class","ml-2"),m(e,"class","flex w-full")},m(I,P){B(I,e,P),te(t,e,null),k(e,n),k(e,o),k(o,s),k(s,i),k(i,a),k(s,c),k(s,u),te(f,u,null),k(o,h),y.m(o,null),_=!0,b||(w=Se(u,"click",l[1]),b=!0)},p(I,P){var Z,F,X,se,q,G,oe,ae,ve,$,Ie,Ne;const N={};P&1&&(N.src=((se=(X=(F=(Z=I[0])==null?void 0:Z.model)==null?void 0:F.info)==null?void 0:X.meta)==null?void 0:se.profile_image_url)??""),t.$set(N),(!_||P&1)&&r!==(r=(((G=(q=I[0])==null?void 0:q.model)==null?void 0:G.name)??((ae=(oe=I[0])==null?void 0:oe.message)==null?void 0:ae.model)??"Assistant")+"")&&Ce(a,r);const Y={};P&1&&(Y.className="size-3 "+(($=(ve=I[0])==null?void 0:ve.message)!=null&&$.favorite?"fill-red-500 stroke-red-500":"hover:fill-red-500 hover:stroke-red-500")+" "),f.$set(Y),(!_||P&1&&d!==(d=(Ne=(Ie=I[0])==null?void 0:Ie.message)!=null&&Ne.favorite?"":"invisible group-hover:visible"))&&m(u,"class",d),v===(v=g(I))&&y?y.p(I,P):(y.d(1),y=v(I),y&&(y.c(),y.m(o,null)))},i(I){_||(C(t.$$.fragment,I),C(f.$$.fragment,I),_=!0)},o(I){H(t.$$.fragment,I),H(f.$$.fragment,I),_=!1},d(I){I&&p(e),ne(t),ne(f),y.d(),b=!1,w()}}}function sp(l){var _,b,w;let e,t,n,o,s,i,r=(((b=(_=l[0])==null?void 0:_.user)==null?void 0:b.name)??"User")+"",a,c,u;t=new va({props:{src:((w=l[0].user)==null?void 0:w.profile_image_url)??"/user.png",className:"size-5 -translate-y-[1px]"}});function f(g,v){var y,E;return(E=(y=g[0])==null?void 0:y.message)!=null&&E.error?cp:ap}let d=f(l),h=d(l);return{c(){e=T("div"),ee(t.$$.fragment),n=Q(),o=T("div"),s=T("div"),i=T("div"),a=ke(r),c=Q(),h.c(),this.h()},l(g){e=V(g,"DIV",{class:!0});var v=S(e);le(t.$$.fragment,v),n=x(v),o=V(v,"DIV",{class:!0});var y=S(o);s=V(y,"DIV",{class:!0});var E=S(s);i=V(E,"DIV",{class:!0});var z=S(i);a=Ee(z,r),z.forEach(p),E.forEach(p),c=x(y),h.l(y),y.forEach(p),v.forEach(p),this.h()},h(){m(i,"class","text-xs text-black dark:text-white font-medium line-clamp-1"),m(s,"class","flex justify-between items-center"),m(o,"class","ml-2"),m(e,"class","flex w-full")},m(g,v){B(g,e,v),te(t,e,null),k(e,n),k(e,o),k(o,s),k(s,i),k(i,a),k(o,c),h.m(o,null),u=!0},p(g,v){var E,z,D;const y={};v&1&&(y.src=((E=g[0].user)==null?void 0:E.profile_image_url)??"/user.png"),t.$set(y),(!u||v&1)&&r!==(r=(((D=(z=g[0])==null?void 0:z.user)==null?void 0:D.name)??"User")+"")&&Ce(a,r),d===(d=f(g))&&h?h.p(g,v):(h.d(1),h=d(g),h&&(h.c(),h.m(o,null)))},i(g){u||(C(t.$$.fragment,g),u=!0)},o(g){H(t.$$.fragment,g),u=!1},d(g){g&&p(e),ne(t),h.d()}}}function rp(l){let e,t=l[0].message.content+"",n;return{c(){e=T("div"),n=ke(t),this.h()},l(o){e=V(o,"DIV",{class:!0});var s=S(e);n=Ee(s,t),s.forEach(p),this.h()},h(){m(e,"class","text-gray-500 line-clamp-2 text-xs mt-0.5")},m(o,s){B(o,e,s),k(e,n)},p(o,s){s&1&&t!==(t=o[0].message.content+"")&&Ce(n,t)},d(o){o&&p(e)}}}function ip(l){let e,t=l[0].message.error.content+"",n;return{c(){e=T("div"),n=ke(t),this.h()},l(o){e=V(o,"DIV",{class:!0});var s=S(e);n=Ee(s,t),s.forEach(p),this.h()},h(){m(e,"class","text-red-500 line-clamp-2 text-xs mt-0.5")},m(o,s){B(o,e,s),k(e,n)},p(o,s){s&1&&t!==(t=o[0].message.error.content+"")&&Ce(n,t)},d(o){o&&p(e)}}}function ap(l){let e,t=l[0].message.content+"",n;return{c(){e=T("div"),n=ke(t),this.h()},l(o){e=V(o,"DIV",{class:!0});var s=S(e);n=Ee(s,t),s.forEach(p),this.h()},h(){m(e,"class","text-gray-500 line-clamp-2 text-xs mt-0.5")},m(o,s){B(o,e,s),k(e,n)},p(o,s){s&1&&t!==(t=o[0].message.content+"")&&Ce(n,t)},d(o){o&&p(e)}}}function cp(l){let e,t=l[0].message.error.content+"",n;return{c(){e=T("div"),n=ke(t),this.h()},l(o){e=V(o,"DIV",{class:!0});var s=S(e);n=Ee(s,t),s.forEach(p),this.h()},h(){m(e,"class","text-red-500 line-clamp-2 text-xs mt-0.5")},m(o,s){B(o,e,s),k(e,n)},p(o,s){s&1&&t!==(t=o[0].message.error.content+"")&&Ce(n,t)},d(o){o&&p(e)}}}function up(l){let e,t,n,o;const s=[sp,op],i=[];function r(a,c){return a[0].message.role==="user"?0:1}return e=r(l),t=i[e]=s[e](l),{c(){t.c(),n=Te()},l(a){t.l(a),n=Te()},m(a,c){i[e].m(a,c),B(a,n,c),o=!0},p(a,c){let u=e;e=r(a),e===u?i[e].p(a,c):(Ve(),H(i[u],1,1,()=>{i[u]=null}),ze(),t=i[e],t?t.p(a,c):(t=i[e]=s[e](a),t.c()),C(t,1),t.m(n.parentNode,n))},i(a){o||(C(t),o=!0)},o(a){H(t),o=!1},d(a){a&&p(n),i[e].d(a)}}}function fp(l){var a,c;let e,t,n,o,s,i,r;return t=new Ft({props:{content:(c=(a=l[0])==null?void 0:a.message)!=null&&c.error?l[0].message.error.content:l[0].message.content,class:"w-full",allowHTML:!1,$$slots:{default:[up]},$$scope:{ctx:l}}}),o=new Dl({props:{type:"target",position:ot.Top,class:"w-2 rounded-full dark:bg-gray-900"}}),i=new Dl({props:{type:"source",position:ot.Bottom,class:"w-2 rounded-full dark:bg-gray-900"}}),{c(){e=T("div"),ee(t.$$.fragment),n=Q(),ee(o.$$.fragment),s=Q(),ee(i.$$.fragment),this.h()},l(u){e=V(u,"DIV",{class:!0});var f=S(e);le(t.$$.fragment,f),n=x(f),le(o.$$.fragment,f),s=x(f),le(i.$$.fragment,f),f.forEach(p),this.h()},h(){m(e,"class","px-4 py-3 shadow-md rounded-xl dark:bg-black bg-white border dark:border-gray-900 w-60 h-20 group")},m(u,f){B(u,e,f),te(t,e,null),k(e,n),te(o,e,null),k(e,s),te(i,e,null),r=!0},p(u,[f]){var h,_;const d={};f&1&&(d.content=(_=(h=u[0])==null?void 0:h.message)!=null&&_.error?u[0].message.error.content:u[0].message.content),f&5&&(d.$$scope={dirty:f,ctx:u}),t.$set(d)},i(u){r||(C(t.$$.fragment,u),C(o.$$.fragment,u),C(i.$$.fragment,u),r=!0)},o(u){H(t.$$.fragment,u),H(o.$$.fragment,u),H(i.$$.fragment,u),r=!1},d(u){u&&p(e),ne(t),ne(o),ne(i)}}}function dp(l,e,t){let{data:n}=e;const o=()=>{var s;t(0,n.message.favorite=!(((s=n==null?void 0:n.message)==null?void 0:s.favorite)??!1),n)};return l.$$set=s=>{"data"in s&&t(0,n=s.data)},[n,o]}class hp extends Oe{constructor(e){super(),He(this,e,dp,fp,Le,{data:0})}}function mp(l){let e,t,n,o;return e=new n0({props:{showLock:!1}}),n=new m0({props:{variant:jn.Dots}}),{c(){ee(e.$$.fragment),t=Q(),ee(n.$$.fragment)},l(s){le(e.$$.fragment,s),t=x(s),le(n.$$.fragment,s)},m(s,i){te(e,s,i),B(s,t,i),te(n,s,i),o=!0},p:De,i(s){o||(C(e.$$.fragment,s),C(n.$$.fragment,s),o=!0)},o(s){H(e.$$.fragment,s),H(n.$$.fragment,s),o=!1},d(s){s&&p(t),ne(e,s),ne(n,s)}}}function gp(l){let e,t;return e=new Mg({props:{nodes:l[0],nodeTypes:l[1],edges:l[2],fitView:!0,minZoom:.001,colorMode:l[3].includes("dark")||l[3]==="system"&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",nodesConnectable:!1,nodesDraggable:!1,oninit:l[5],$$slots:{default:[mp]},$$scope:{ctx:l}}}),e.$on("nodeclick",l[6]),{c(){ee(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,o){te(e,n,o),t=!0},p(n,[o]){const s={};o&1&&(s.nodes=n[0]),o&2&&(s.nodeTypes=n[1]),o&4&&(s.edges=n[2]),o&8&&(s.colorMode=n[3].includes("dark")||n[3]==="system"&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),o&128&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}function pp(l,e,t){let n;re(l,bc,u=>t(3,n=u));const o=on();let{nodes:s}=e,{nodeTypes:i}=e,{edges:r}=e;const a=()=>{console.log("Flow initialized")},c=u=>o("nodeclick",u.detail);return l.$$set=u=>{"nodes"in u&&t(0,s=u.nodes),"nodeTypes"in u&&t(1,i=u.nodeTypes),"edges"in u&&t(2,r=u.edges)},[s,i,r,n,o,a,c]}class _p extends Oe{constructor(e){super(),He(this,e,pp,gp,Le,{nodes:0,nodeTypes:1,edges:2})}}function bp(l){let e,t;return{c(){e=_e("svg"),t=_e("path"),this.h()},l(n){e=be(n,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var o=S(e);t=be(o,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),S(t).forEach(p),o.forEach(p),this.h()},h(){m(t,"stroke-linecap","round"),m(t,"stroke-linejoin","round"),m(t,"d","M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"fill","none"),m(e,"viewBox","0 0 24 24"),m(e,"stroke-width",l[1]),m(e,"stroke","currentColor"),m(e,"class",l[0])},m(n,o){B(n,e,o),k(e,t)},p(n,[o]){o&2&&m(e,"stroke-width",n[1]),o&1&&m(e,"class",n[0])},i:De,o:De,d(n){n&&p(e)}}}function vp(l,e,t){let{className:n="size-4"}=e,{strokeWidth:o="1.5"}=e;return l.$$set=s=>{"className"in s&&t(0,n=s.className),"strokeWidth"in s&&t(1,o=s.strokeWidth)},[n,o]}class wp extends Oe{constructor(e){super(),He(this,e,vp,bp,Le,{className:0,strokeWidth:1})}}function ji(l){let e,t;return e=new _p({props:{nodes:l[6],nodeTypes:l[8],edges:l[7]}}),e.$on("nodeclick",l[11]),{c(){ee(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,o){te(e,n,o),t=!0},p:De,i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}function yp(l){let e,t,n,o,s=l[1].t("Chat Overview")+"",i,r,a,c,u,f,d,h;c=new zo({props:{className:"size-3.5"}});let _=l[2].length>0&&ji(l);return{c(){e=T("div"),t=T("div"),n=T("div"),o=T("div"),i=ke(s),r=Q(),a=T("button"),ee(c.$$.fragment),u=Q(),_&&_.c(),this.h()},l(b){e=V(b,"DIV",{class:!0});var w=S(e);t=V(w,"DIV",{class:!0});var g=S(t);n=V(g,"DIV",{class:!0});var v=S(n);o=V(v,"DIV",{class:!0});var y=S(o);i=Ee(y,s),y.forEach(p),v.forEach(p),r=x(g),a=V(g,"BUTTON",{class:!0});var E=S(a);le(c.$$.fragment,E),E.forEach(p),g.forEach(p),u=x(w),_&&_.l(w),w.forEach(p),this.h()},h(){m(o,"class","text-lg font-medium self-center font-primary"),m(n,"class","flex items-center gap-2.5"),m(a,"class","self-center p-0.5"),m(t,"class","absolute z-50 w-full flex justify-between dark:text-gray-100 px-4 py-3.5"),m(e,"class","w-full h-full relative")},m(b,w){B(b,e,w),k(e,t),k(t,n),k(n,o),k(o,i),k(t,r),k(t,a),te(c,a,null),k(e,u),_&&_.m(e,null),f=!0,d||(h=Se(a,"click",l[10]),d=!0)},p(b,[w]){(!f||w&2)&&s!==(s=b[1].t("Chat Overview")+"")&&Ce(i,s),b[2].length>0?_?(_.p(b,w),w&4&&C(_,1)):(_=ji(b),_.c(),C(_,1),_.m(e,null)):_&&(Ve(),H(_,1,1,()=>{_=null}),ze())},i(b){f||(C(c.$$.fragment,b),C(_),f=!0)},o(b){H(c.$$.fragment,b),H(_),f=!1},d(b){b&&p(e),ne(c),_&&_.d(),d=!1,h()}}}function kp(l,e,t){let n,o,s,i;re(l,hl,A=>t(12,n=A)),re(l,Kn,A=>t(13,o=A));const r=on(),a=Ot("i18n");re(l,a,A=>t(1,s=A));const{width:c,height:u}=Wt(),{fitView:f,getViewport:d}=g0(),h=p0();let{history:_}=e,b=null;const w=xe([]);re(l,w,A=>t(2,i=A));const g=xe([]),v={custom:hp},y=async()=>{b===null?await f({nodes:[{id:_.currentId}]}):await f({nodes:[{id:b}]}),t(0,b=null)},E=async()=>{const A=[],O=[];let K=new Map,R={};Object.keys(_.messages).forEach(I=>{var Y;const P=_.messages[I],N=P.parentId?(((Y=K.get(P.parentId))==null?void 0:Y.level)??-1)+1:0;R[N]||(R[N]=0),K.set(I,{id:P.id,level:N,position:R[N]++})}),Object.keys(_.messages).forEach(I=>{const P=K.get(I),N=P.position*250,Y=P.level*150,Z=N;A.push({id:P.id,type:"custom",data:{user:o,message:_.messages[I],model:n.find(X=>X.id===_.messages[I].model)},position:{x:Z,y:Y}});const F=_.messages[I].parentId;F&&O.push({id:F+"-"+P.id,source:F,target:P.id,selectable:!1,class:" dark:fill-gray-300 fill-gray-300",type:"smoothstep",animated:_.currentId===I||z(I,_.currentId)})}),await g.set([...O]),await w.set([...A])},z=(A,O)=>{const L=_.messages[A];return L.childrenIds&&L.childrenIds.some(W=>W===O||z(W,O))};hn(()=>{E(),h.subscribe(async A=>{A&&(await tt(),await f({nodes:[{id:_.currentId}]}))}),c.subscribe(A=>{A&&f({nodes:[{id:_.currentId}]})}),u.subscribe(A=>{A&&f({nodes:[{id:_.currentId}]})})}),$n(()=>{console.log("Overview destroyed"),w.set([]),g.set([])});const D=()=>{r("close"),Qn.set(!1)},M=A=>{console.log(A.detail.node.data),r("nodeclick",A.detail),t(0,b=A.detail.node.data.message.id),f({nodes:[{id:b}]})};return l.$$set=A=>{"history"in A&&t(9,_=A.history)},l.$$.update=()=>{l.$$.dirty&512&&_&&E(),l.$$.dirty&512&&_&&_.currentId&&y()},[b,s,i,r,a,f,w,g,v,_,D,M]}class sc extends Oe{constructor(e){super(),He(this,e,kp,yp,Le,{history:9})}}function Ep(l){let e,t;return{c(){e=_e("svg"),t=_e("path"),this.h()},l(n){e=be(n,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var o=S(e);t=be(o,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),S(t).forEach(p),o.forEach(p),this.h()},h(){m(t,"stroke-linecap","round"),m(t,"stroke-linejoin","round"),m(t,"d","M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9M3.75 20.25v-4.5m0 4.5h4.5m-4.5 0L9 15M20.25 3.75h-4.5m4.5 0v4.5m0-4.5L15 9m5.25 11.25h-4.5m4.5 0v-4.5m0 4.5L15 15"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"fill","none"),m(e,"viewBox","0 0 24 24"),m(e,"stroke-width",l[1]),m(e,"stroke","currentColor"),m(e,"class",l[0])},m(n,o){B(n,e,o),k(e,t)},p(n,[o]){o&2&&m(e,"stroke-width",n[1]),o&1&&m(e,"class",n[0])},i:De,o:De,d(n){n&&p(e)}}}function Ip(l,e,t){let{className:n="size-4"}=e,{strokeWidth:o="1.5"}=e;return l.$$set=s=>{"className"in s&&t(0,n=s.className),"strokeWidth"in s&&t(1,o=s.strokeWidth)},[n,o]}class Sp extends Oe{constructor(e){super(),He(this,e,Ip,Ep,Le,{className:0,strokeWidth:1})}}function Yi(l){let e;return{c(){e=T("div"),this.h()},l(t){e=V(t,"DIV",{class:!0}),S(e).forEach(p),this.h()},h(){m(e,"class","absolute top-0 left-0 right-0 bottom-0 z-10")},m(t,n){B(t,e,n)},d(t){t&&p(e)}}}function Dp(l){let e,t=l[5].t("No HTML, CSS, or JavaScript content found.")+"",n;return{c(){e=T("div"),n=ke(t),this.h()},l(o){e=V(o,"DIV",{class:!0});var s=S(e);n=Ee(s,t),s.forEach(p),this.h()},h(){m(e,"class","m-auto font-medium text-xs text-gray-900 dark:text-white")},m(o,s){B(o,e,s),k(e,n)},p(o,s){s&32&&t!==(t=o[5].t("No HTML, CSS, or JavaScript content found.")+"")&&Ce(n,t)},i:De,o:De,d(o){o&&p(e)}}}function Cp(l){let e,t,n,o;const s=[Tp,Mp],i=[];function r(a,c){return a[1][a[2]].type==="iframe"?0:a[1][a[2]].type==="svg"?1:-1}return~(t=r(l))&&(n=i[t]=s[t](l)),{c(){e=T("div"),n&&n.c(),this.h()},l(a){e=V(a,"DIV",{class:!0});var c=S(e);n&&n.l(c),c.forEach(p),this.h()},h(){m(e,"class","max-w-full w-full h-full")},m(a,c){B(a,e,c),~t&&i[t].m(e,null),o=!0},p(a,c){let u=t;t=r(a),t===u?~t&&i[t].p(a,c):(n&&(Ve(),H(i[u],1,1,()=>{i[u]=null}),ze()),~t?(n=i[t],n?n.p(a,c):(n=i[t]=s[t](a),n.c()),C(n,1),n.m(e,null)):n=null)},i(a){o||(C(n),o=!0)},o(a){H(n),o=!1},d(a){a&&p(e),~t&&i[t].d()}}}function Mp(l){let e,t;return e=new au({props:{className:" w-full h-full max-h-full overflow-hidden",svg:l[1][l[2]].content}}),{c(){ee(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,o){te(e,n,o),t=!0},p(n,o){const s={};o&6&&(s.svg=n[1][n[2]].content),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}function Tp(l){let e,t,n,o;return{c(){e=T("iframe"),this.h()},l(s){e=V(s,"IFRAME",{title:!0,srcdoc:!0,class:!0,sandbox:!0}),S(e).forEach(p),this.h()},h(){m(e,"title","Content"),m(e,"srcdoc",t=l[1][l[2]].content),m(e,"class","w-full border-0 h-full rounded-none"),m(e,"sandbox","allow-scripts allow-forms allow-same-origin")},m(s,i){B(s,e,i),l[14](e),n||(o=Se(e,"load",l[9]),n=!0)},p(s,i){i&6&&t!==(t=s[1][s[2]].content)&&m(e,"srcdoc",t)},i:De,o:De,d(s){s&&p(e),l[14](null),n=!1,o()}}}function Ki(l){let e,t,n,o,s,i,r,a,c,u=l[5].t("Version {{selectedVersion}} of {{totalVersions}}",{selectedVersion:l[2]+1,totalVersions:l[1].length})+"",f,d,h,_,b,w,g,v,y,E=(l[3]?l[5].t("Copied"):l[5].t("Copy"))+"",z,D,M,A,O,L=l[1][l[2]].type==="iframe"&&Gi(l);return{c(){e=T("div"),t=T("div"),n=T("div"),o=T("button"),s=_e("svg"),i=_e("path"),a=Q(),c=T("div"),f=ke(u),d=Q(),h=T("button"),_=_e("svg"),b=_e("path"),g=Q(),v=T("div"),y=T("button"),z=ke(E),D=Q(),L&&L.c(),this.h()},l(W){e=V(W,"DIV",{class:!0});var K=S(e);t=V(K,"DIV",{class:!0});var R=S(t);n=V(R,"DIV",{class:!0,dir:!0});var I=S(n);o=V(I,"BUTTON",{class:!0});var P=S(o);s=be(P,"svg",{xmlns:!0,fill:!0,viewBox:!0,stroke:!0,"stroke-width":!0,class:!0});var N=S(s);i=be(N,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),S(i).forEach(p),N.forEach(p),P.forEach(p),a=x(I),c=V(I,"DIV",{class:!0});var Y=S(c);f=Ee(Y,u),Y.forEach(p),d=x(I),h=V(I,"BUTTON",{class:!0});var Z=S(h);_=be(Z,"svg",{xmlns:!0,fill:!0,viewBox:!0,stroke:!0,"stroke-width":!0,class:!0});var F=S(_);b=be(F,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),S(b).forEach(p),F.forEach(p),Z.forEach(p),I.forEach(p),R.forEach(p),g=x(K),v=V(K,"DIV",{class:!0});var X=S(v);y=V(X,"BUTTON",{class:!0});var se=S(y);z=Ee(se,E),se.forEach(p),D=x(X),L&&L.l(X),X.forEach(p),K.forEach(p),this.h()},h(){m(i,"stroke-linecap","round"),m(i,"stroke-linejoin","round"),m(i,"d","M15.75 19.5 8.25 12l7.5-7.5"),m(s,"xmlns","http://www.w3.org/2000/svg"),m(s,"fill","none"),m(s,"viewBox","0 0 24 24"),m(s,"stroke","currentColor"),m(s,"stroke-width","2.5"),m(s,"class","size-3.5"),m(o,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition disabled:cursor-not-allowed"),o.disabled=r=l[1].length<=1,m(c,"class","text-xs self-center dark:text-gray-100 min-w-fit"),m(b,"stroke-linecap","round"),m(b,"stroke-linejoin","round"),m(b,"d","m8.25 4.5 7.5 7.5-7.5 7.5"),m(_,"xmlns","http://www.w3.org/2000/svg"),m(_,"fill","none"),m(_,"viewBox","0 0 24 24"),m(_,"stroke","currentColor"),m(_,"stroke-width","2.5"),m(_,"class","size-3.5"),m(h,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition disabled:cursor-not-allowed"),h.disabled=w=l[1].length<=1,m(n,"class","flex items-center gap-0.5 self-center min-w-fit"),m(n,"dir","ltr"),m(t,"class","flex items-center space-x-2"),m(y,"class","copy-code-button bg-none border-none text-xs bg-gray-50 hover:bg-gray-100 dark:bg-gray-850 dark:hover:bg-gray-800 transition rounded-md px-1.5 py-0.5"),m(v,"class","flex items-center gap-1"),m(e,"class","flex justify-between items-center p-2.5 font-primar text-gray-900 dark:text-white")},m(W,K){B(W,e,K),k(e,t),k(t,n),k(n,o),k(o,s),k(s,i),k(n,a),k(n,c),k(c,f),k(n,d),k(n,h),k(h,_),k(_,b),k(e,g),k(e,v),k(v,y),k(y,z),k(v,D),L&&L.m(v,null),M=!0,A||(O=[Se(o,"click",l[15]),Se(h,"click",l[16]),Se(y,"click",l[17])],A=!0)},p(W,K){(!M||K&2&&r!==(r=W[1].length<=1))&&(o.disabled=r),(!M||K&38)&&u!==(u=W[5].t("Version {{selectedVersion}} of {{totalVersions}}",{selectedVersion:W[2]+1,totalVersions:W[1].length})+"")&&Ce(f,u),(!M||K&2&&w!==(w=W[1].length<=1))&&(h.disabled=w),(!M||K&40)&&E!==(E=(W[3]?W[5].t("Copied"):W[5].t("Copy"))+"")&&Ce(z,E),W[1][W[2]].type==="iframe"?L?(L.p(W,K),K&6&&C(L,1)):(L=Gi(W),L.c(),C(L,1),L.m(v,null)):L&&(Ve(),H(L,1,1,()=>{L=null}),ze())},i(W){M||(C(L),M=!0)},o(W){H(L),M=!1},d(W){W&&p(e),L&&L.d(),A=!1,sn(O)}}}function Gi(l){let e,t;return e=new Ft({props:{content:l[5].t("Open in full screen"),$$slots:{default:[Vp]},$$scope:{ctx:l}}}),{c(){ee(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,o){te(e,n,o),t=!0},p(n,o){const s={};o&32&&(s.content=n[5].t("Open in full screen")),o&1048576&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}function Vp(l){let e,t,n,o,s;return t=new Sp({props:{className:"size-3.5"}}),{c(){e=T("button"),ee(t.$$.fragment),this.h()},l(i){e=V(i,"BUTTON",{class:!0});var r=S(e);le(t.$$.fragment,r),r.forEach(p),this.h()},h(){m(e,"class","bg-none border-none text-xs bg-gray-50 hover:bg-gray-100 dark:bg-gray-850 dark:hover:bg-gray-800 transition rounded-md p-0.5")},m(i,r){B(i,e,r),te(t,e,null),n=!0,o||(s=Se(e,"click",l[10]),o=!0)},p:De,i(i){n||(C(t.$$.fragment,i),n=!0)},o(i){H(t.$$.fragment,i),n=!1},d(i){i&&p(e),ne(t),o=!1,s()}}}function zp(l){let e,t,n,o,s,i,r,a,c,u,f,d,h,_,b,w,g,v,y,E=l[0]&&Yi();i=new wp({props:{className:"size-3.5  text-gray-900 dark:text-white"}}),u=new zo({props:{className:"size-3.5 text-gray-900 dark:text-white"}});const z=[Cp,Dp],D=[];function M(O,L){return O[1].length>0?0:1}_=M(l),b=D[_]=z[_](l);let A=l[1].length>0&&Ki(l);return{c(){e=T("div"),t=T("div"),E&&E.c(),n=Q(),o=T("div"),s=T("button"),ee(i.$$.fragment),r=Q(),a=T("div"),c=T("button"),ee(u.$$.fragment),f=Q(),d=T("div"),h=T("div"),b.c(),w=Q(),A&&A.c(),this.h()},l(O){e=V(O,"DIV",{class:!0});var L=S(e);t=V(L,"DIV",{class:!0});var W=S(t);E&&E.l(W),n=x(W),o=V(W,"DIV",{class:!0});var K=S(o);s=V(K,"BUTTON",{class:!0});var R=S(s);le(i.$$.fragment,R),R.forEach(p),K.forEach(p),r=x(W),a=V(W,"DIV",{class:!0});var I=S(a);c=V(I,"BUTTON",{class:!0});var P=S(c);le(u.$$.fragment,P),P.forEach(p),I.forEach(p),f=x(W),d=V(W,"DIV",{class:!0});var N=S(d);h=V(N,"DIV",{class:!0});var Y=S(h);b.l(Y),Y.forEach(p),N.forEach(p),W.forEach(p),w=x(L),A&&A.l(L),L.forEach(p),this.h()},h(){m(s,"class","self-center pointer-events-auto p-1 rounded-full bg-white dark:bg-gray-850"),m(o,"class","absolute pointer-events-none z-50 w-full flex items-center justify-start p-4"),m(c,"class","self-center pointer-events-auto p-1 rounded-full bg-white dark:bg-gray-850"),m(a,"class","absolute pointer-events-none z-50 w-full flex items-center justify-end p-4"),m(h,"class","h-full flex flex-col"),m(d,"class","flex-1 w-full h-full"),m(t,"class","w-full h-full flex-1 relative"),m(e,"class","w-full h-full relative flex flex-col bg-gray-50 dark:bg-gray-850")},m(O,L){B(O,e,L),k(e,t),E&&E.m(t,null),k(t,n),k(t,o),k(o,s),te(i,s,null),k(t,r),k(t,a),k(a,c),te(u,c,null),k(t,f),k(t,d),k(d,h),D[_].m(h,null),k(e,w),A&&A.m(e,null),g=!0,v||(y=[Se(s,"click",l[12]),Se(c,"click",l[13])],v=!0)},p(O,[L]){O[0]?E||(E=Yi(),E.c(),E.m(t,n)):E&&(E.d(1),E=null);let W=_;_=M(O),_===W?D[_].p(O,L):(Ve(),H(D[W],1,1,()=>{D[W]=null}),ze(),b=D[_],b?b.p(O,L):(b=D[_]=z[_](O),b.c()),C(b,1),b.m(h,null)),O[1].length>0?A?(A.p(O,L),L&2&&C(A,1)):(A=Ki(O),A.c(),C(A,1),A.m(e,null)):A&&(Ve(),H(A,1,1,()=>{A=null}),ze())},i(O){g||(C(i.$$.fragment,O),C(u.$$.fragment,O),C(b),C(A),g=!0)},o(O){H(i.$$.fragment,O),H(u.$$.fragment,O),H(b),H(A),g=!1},d(O){O&&p(e),E&&E.d(),ne(i),ne(u),D[_].d(),A&&A.d(),v=!1,sn(y)}}}function Np(l,e,t){let n;const o=Ot("i18n");re(l,o,M=>t(5,n=M));const s=on();let{overlay:i=!1}=e,{history:r}=e,a=[],c=[],u=0,f=!1,d;const h=()=>{t(1,c=[]),a.forEach(M=>{if((M==null?void 0:M.role)!=="user"&&(M!=null&&M.content)){const A=M.content.match(/```[\s\S]*?```/g);let O=[];A&&A.forEach(N=>{const Y=N.split(`
`)[0].replace("```","").trim().toLowerCase(),Z=N.replace(/```[\s\S]*?\n/,"").replace(/```$/,"");O.push({lang:Y,code:Z})});let L="",W="",K="";O.forEach(N=>{const{lang:Y,code:Z}=N;Y==="html"?L+=Z+`
`:Y==="css"?W+=Z+`
`:(Y==="javascript"||Y==="js")&&(K+=Z+`
`)});const R=M.content.match(/<html>[\s\S]*?<\/html>/gi),I=M.content.match(/<style>[\s\S]*?<\/style>/gi),P=M.content.match(/<script>[\s\S]*?<\/script>/gi);if(R&&R.forEach(N=>{const Y=N.replace(/<\/?html>/gi,"");L+=Y+`
`}),I&&I.forEach(N=>{const Y=N.replace(/<\/?style>/gi,"");W+=Y+`
`}),P&&P.forEach(N=>{const Y=N.replace(/<\/?script>/gi,"");K+=Y+`
`}),L||W||K){const N=`
                        <!DOCTYPE html>
                        <html lang="en">
                        <head>
                            <meta charset="UTF-8">
                            <meta name="viewport" content="width=device-width, initial-scale=1.0">
							<style>
								body {
									background-color: white; /* Ensure the iframe has a white background */
								}

								${W}
							</style>
                        </head>
                        <body>
                            ${L}

							<script>
                            	${K}
							<\/script>
                        </body>
                        </html>
                    `;t(1,c=[...c,{type:"iframe",content:N}])}else for(const N of O)(N.lang==="svg"||N.lang==="xml"&&N.code.includes("<svg"))&&t(1,c=[...c,{type:"svg",content:N.code}])}}),c.length===0&&(Zt.set(!1),Ln.set(!1)),t(2,u=c?c.length-1:0)};function _(M){console.log(u),t(2,u=M==="prev"?Math.max(u-1,0):Math.min(u+1,c.length-1)),console.log(u)}const b=()=>{d.contentWindow.addEventListener("click",function(M){const A=M.target.closest("a");if(A&&A.href){M.preventDefault();const O=new URL(A.href,d.baseURI);O.origin===window.location.origin?d.contentWindow.history.pushState(null,"",O.pathname+O.search+O.hash):console.log("External navigation blocked:",O.href)}},!0),d.contentWindow.addEventListener("mouseenter",function(M){M.preventDefault(),d.contentWindow.addEventListener("dragstart",A=>{A.preventDefault()})})},w=()=>{d.requestFullscreen?d.requestFullscreen():d.webkitRequestFullscreen?d.webkitRequestFullscreen():d.msRequestFullscreen&&d.msRequestFullscreen()};hn(()=>{});const g=()=>{Ln.set(!1)},v=()=>{s("close"),Zt.set(!1),Ln.set(!1)};function y(M){Ae[M?"unshift":"push"](()=>{d=M,t(4,d)})}const E=()=>_("prev"),z=()=>_("next"),D=()=>{pa(c[u].content),t(3,f=!0),setTimeout(()=>{t(3,f=!1)},2e3)};return l.$$set=M=>{"overlay"in M&&t(0,i=M.overlay),"history"in M&&t(11,r=M.history)},l.$$.update=()=>{l.$$.dirty&2048&&(r?(a=bn(r,r.currentId),h()):(a=[],h()))},[i,c,u,f,d,n,o,s,_,b,w,r,g,v,y,E,z,D]}class rc extends Oe{constructor(e){super(),He(this,e,Np,zp,Le,{overlay:0,history:11})}}function Pp(l){let e,t,n,o,s=l[16]&&Xi(l);function i(a){l[37](a)}let r={defaultSize:0,onResize:l[35],onCollapse:l[36],collapsible:!0,class:"pt-8",$$slots:{default:[Up]},$$scope:{ctx:l}};return l[4]!==void 0&&(r.pane=l[4]),t=new fa({props:r}),Ae.push(()=>Xe(t,"pane",i)),{c(){s&&s.c(),e=Q(),ee(t.$$.fragment)},l(a){s&&s.l(a),e=x(a),le(t.$$.fragment,a)},m(a,c){s&&s.m(a,c),B(a,e,c),te(t,a,c),o=!0},p(a,c){a[16]?s?c[0]&65536&&C(s,1):(s=Xi(a),s.c(),C(s,1),s.m(e.parentNode,e)):s&&(Ve(),H(s,1,1,()=>{s=null}),ze());const u={};c[0]&81936&&(u.onResize=a[35]),c[0]&503791|c[1]&4096&&(u.$$scope={dirty:c,ctx:a}),!n&&c[0]&16&&(n=!0,u.pane=a[4],Ge(()=>n=!1)),t.$set(u)},i(a){o||(C(s),C(t.$$.fragment,a),o=!0)},o(a){H(s),H(t.$$.fragment,a),o=!1},d(a){a&&p(e),s&&s.d(a),ne(t,a)}}}function Op(l){let e,t,n=l[16]&&qi(l);return{c(){n&&n.c(),e=Te()},l(o){n&&n.l(o),e=Te()},m(o,s){n&&n.m(o,s),B(o,e,s),t=!0},p(o,s){o[16]?n?(n.p(o,s),s[0]&65536&&C(n,1)):(n=qi(o),n.c(),C(n,1),n.m(e.parentNode,e)):n&&(Ve(),H(n,1,1,()=>{n=null}),ze())},i(o){t||(C(n),t=!0)},o(o){H(n),t=!1},d(o){o&&p(e),n&&n.d(o)}}}function Xi(l){let e,t;return e=new mc({props:{class:"relative flex w-2 items-center justify-center bg-background group",$$slots:{default:[Hp]},$$scope:{ctx:l}}}),{c(){ee(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,o){te(e,n,o),t=!0},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}function Hp(l){let e,t,n;return t=new Hu({props:{className:"size-4 invisible group-hover:visible"}}),{c(){e=T("div"),ee(t.$$.fragment),this.h()},l(o){e=V(o,"DIV",{class:!0});var s=S(e);le(t.$$.fragment,s),s.forEach(p),this.h()},h(){m(e,"class","z-10 flex h-7 w-5 items-center justify-center rounded-xs")},m(o,s){B(o,e,s),te(t,e,null),n=!0},p:De,i(o){n||(C(t.$$.fragment,o),n=!0)},o(o){H(t.$$.fragment,o),n=!1},d(o){o&&p(e),ne(t)}}}function Zi(l){let e,t,n,o,s,i;const r=[Rp,Bp,Lp,Ap],a=[];function c(u,f){return u[15]?0:u[18]?1:u[17]?2:3}return n=c(l),o=a[n]=r[n](l),{c(){e=T("div"),t=T("div"),o.c(),this.h()},l(u){e=V(u,"DIV",{class:!0});var f=S(e);t=V(f,"DIV",{class:!0});var d=S(t);o.l(d),d.forEach(p),f.forEach(p),this.h()},h(){m(t,"class",s="w-full "+((l[17]||l[18])&&!l[15]?" ":"px-4 py-4 bg-white dark:shadow-lg dark:bg-gray-850  border border-gray-100 dark:border-gray-850")+" rounded-xl z-40 pointer-events-auto overflow-y-auto scrollbar-hidden"),m(e,"class","pr-4 pb-8 flex max-h-full min-h-full")},m(u,f){B(u,e,f),k(e,t),a[n].m(t,null),i=!0},p(u,f){let d=n;n=c(u),n===d?a[n].p(u,f):(Ve(),H(a[d],1,1,()=>{a[d]=null}),ze(),o=a[n],o?o.p(u,f):(o=a[n]=r[n](u),o.c()),C(o,1),o.m(t,null)),(!i||f[0]&425984&&s!==(s="w-full "+((u[17]||u[18])&&!u[15]?" ":"px-4 py-4 bg-white dark:shadow-lg dark:bg-gray-850  border border-gray-100 dark:border-gray-850")+" rounded-xl z-40 pointer-events-auto overflow-y-auto scrollbar-hidden"))&&m(t,"class",s)},i(u){i||(C(o),i=!0)},o(u){H(o),i=!1},d(u){u&&p(e),a[n].d()}}}function Ap(l){let e,t,n,o;function s(a){l[32](a)}function i(a){l[33](a)}let r={models:l[5]};return l[1]!==void 0&&(r.chatFiles=l[1]),l[2]!==void 0&&(r.params=l[2]),e=new lc({props:r}),Ae.push(()=>Xe(e,"chatFiles",s)),Ae.push(()=>Xe(e,"params",i)),e.$on("close",l[34]),{c(){ee(e.$$.fragment)},l(a){le(e.$$.fragment,a)},m(a,c){te(e,a,c),o=!0},p(a,c){const u={};c[0]&32&&(u.models=a[5]),!t&&c[0]&2&&(t=!0,u.chatFiles=a[1],Ge(()=>t=!1)),!n&&c[0]&4&&(n=!0,u.params=a[2],Ge(()=>n=!1)),e.$set(u)},i(a){o||(C(e.$$.fragment,a),o=!0)},o(a){H(e.$$.fragment,a),o=!1},d(a){ne(e,a)}}}function Lp(l){let e,t;return e=new sc({props:{history:l[0]}}),e.$on("nodeclick",l[30]),e.$on("close",l[31]),{c(){ee(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,o){te(e,n,o),t=!0},p(n,o){const s={};o[0]&1&&(s.history=n[0]),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}function Bp(l){let e,t;return e=new rc({props:{history:l[0],overlay:l[13]}}),{c(){ee(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,o){te(e,n,o),t=!0},p(n,o){const s={};o[0]&1&&(s.history=n[0]),o[0]&8192&&(s.overlay=n[13]),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}function Rp(l){let e,t,n,o;function s(r){l[28](r)}let i={submitPrompt:l[8],stopResponse:l[9],modelId:l[11],chatId:l[6],eventTarget:l[7]};return l[3]!==void 0&&(i.files=l[3]),t=new oc({props:i}),Ae.push(()=>Xe(t,"files",s)),t.$on("close",l[29]),{c(){e=T("div"),ee(t.$$.fragment),this.h()},l(r){e=V(r,"DIV",{class:!0});var a=S(e);le(t.$$.fragment,a),a.forEach(p),this.h()},h(){m(e,"class","w-full h-full flex justify-center")},m(r,a){B(r,e,a),te(t,e,null),o=!0},p(r,a){const c={};a[0]&256&&(c.submitPrompt=r[8]),a[0]&512&&(c.stopResponse=r[9]),a[0]&2048&&(c.modelId=r[11]),a[0]&64&&(c.chatId=r[6]),a[0]&128&&(c.eventTarget=r[7]),!n&&a[0]&8&&(n=!0,c.files=r[3],Ge(()=>n=!1)),t.$set(c)},i(r){o||(C(t.$$.fragment,r),o=!0)},o(r){H(t.$$.fragment,r),o=!1},d(r){r&&p(e),ne(t)}}}function Up(l){let e,t,n=l[16]&&Zi(l);return{c(){n&&n.c(),e=Te()},l(o){n&&n.l(o),e=Te()},m(o,s){n&&n.m(o,s),B(o,e,s),t=!0},p(o,s){o[16]?n?(n.p(o,s),s[0]&65536&&C(n,1)):(n=Zi(o),n.c(),C(n,1),n.m(e.parentNode,e)):n&&(Ve(),H(n,1,1,()=>{n=null}),ze())},i(o){t||(C(n),t=!0)},o(o){H(n),t=!1},d(o){o&&p(e),n&&n.d(o)}}}function qi(l){let e,t;return e=new Ou({props:{show:l[16],$$slots:{default:[Kp]},$$scope:{ctx:l}}}),e.$on("close",l[27]),{c(){ee(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,o){te(e,n,o),t=!0},p(n,o){const s={};o[0]&65536&&(s.show=n[16]),o[0]&430063|o[1]&4096&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}function Fp(l){let e,t,n,o;function s(a){l[24](a)}function i(a){l[25](a)}let r={models:l[5]};return l[1]!==void 0&&(r.chatFiles=l[1]),l[2]!==void 0&&(r.params=l[2]),e=new lc({props:r}),Ae.push(()=>Xe(e,"chatFiles",s)),Ae.push(()=>Xe(e,"params",i)),e.$on("close",l[26]),{c(){ee(e.$$.fragment)},l(a){le(e.$$.fragment,a)},m(a,c){te(e,a,c),o=!0},p(a,c){const u={};c[0]&32&&(u.models=a[5]),!t&&c[0]&2&&(t=!0,u.chatFiles=a[1],Ge(()=>t=!1)),!n&&c[0]&4&&(n=!0,u.params=a[2],Ge(()=>n=!1)),e.$set(u)},i(a){o||(C(e.$$.fragment,a),o=!0)},o(a){H(e.$$.fragment,a),o=!1},d(a){ne(e,a)}}}function Wp(l){let e,t;return e=new sc({props:{history:l[0]}}),e.$on("nodeclick",l[22]),e.$on("close",l[23]),{c(){ee(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,o){te(e,n,o),t=!0},p(n,o){const s={};o[0]&1&&(s.history=n[0]),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}function jp(l){let e,t;return e=new rc({props:{history:l[0]}}),{c(){ee(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,o){te(e,n,o),t=!0},p(n,o){const s={};o[0]&1&&(s.history=n[0]),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}function Yp(l){let e,t,n,o;function s(r){l[20](r)}let i={submitPrompt:l[8],stopResponse:l[9],modelId:l[11],chatId:l[6],eventTarget:l[7]};return l[3]!==void 0&&(i.files=l[3]),t=new oc({props:i}),Ae.push(()=>Xe(t,"files",s)),t.$on("close",l[21]),{c(){e=T("div"),ee(t.$$.fragment),this.h()},l(r){e=V(r,"DIV",{class:!0});var a=S(e);le(t.$$.fragment,a),a.forEach(p),this.h()},h(){m(e,"class","h-full max-h-[100dvh] bg-white text-gray-700 dark:bg-black dark:text-gray-300 flex justify-center")},m(r,a){B(r,e,a),te(t,e,null),o=!0},p(r,a){const c={};a[0]&256&&(c.submitPrompt=r[8]),a[0]&512&&(c.stopResponse=r[9]),a[0]&2048&&(c.modelId=r[11]),a[0]&64&&(c.chatId=r[6]),a[0]&128&&(c.eventTarget=r[7]),!n&&a[0]&8&&(n=!0,c.files=r[3],Ge(()=>n=!1)),t.$set(c)},i(r){o||(C(t.$$.fragment,r),o=!0)},o(r){H(t.$$.fragment,r),o=!1},d(r){r&&p(e),ne(t)}}}function Kp(l){let e,t,n,o,s;const i=[Yp,jp,Wp,Fp],r=[];function a(c,u){return c[15]?0:c[18]?1:c[17]?2:3}return t=a(l),n=r[t]=i[t](l),{c(){e=T("div"),n.c(),this.h()},l(c){e=V(c,"DIV",{class:!0});var u=S(e);n.l(u),u.forEach(p),this.h()},h(){m(e,"class",o=(l[15]||l[17]||l[18]?" h-screen  w-full":"px-6 py-4")+" h-full")},m(c,u){B(c,e,u),r[t].m(e,null),s=!0},p(c,u){let f=t;t=a(c),t===f?r[t].p(c,u):(Ve(),H(r[f],1,1,()=>{r[f]=null}),ze(),n=r[t],n?n.p(c,u):(n=r[t]=i[t](c),n.c()),C(n,1),n.m(e,null)),(!s||u[0]&425984&&o!==(o=(c[15]||c[17]||c[18]?" h-screen  w-full":"px-6 py-4")+" h-full"))&&m(e,"class",o)},i(c){s||(C(n),s=!0)},o(c){H(n),s=!1},d(c){c&&p(e),r[t].d()}}}function Gp(l){let e,t,n,o;const s=[Op,Pp],i=[];function r(a,c){return a[12]?1:0}return e=r(l),t=i[e]=s[e](l),{c(){t.c(),n=Te()},l(a){t.l(a),n=Te()},m(a,c){i[e].m(a,c),B(a,n,c),o=!0},p(a,c){let u=e;e=r(a),e===u?i[e].p(a,c):(Ve(),H(i[u],1,1,()=>{i[u]=null}),ze(),t=i[e],t?t.p(a,c):(t=i[e]=s[e](a),t.c()),C(t,1),t.m(n.parentNode,n))},i(a){o||(C(t),o=!0)},o(a){H(t),o=!1},d(a){a&&p(n),i[e].d(a)}}}function Xp(l){let e,t;return e=new zg({props:{$$slots:{default:[Gp]},$$scope:{ctx:l}}}),{c(){ee(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,o){te(e,n,o),t=!0},p(n,o){const s={};o[0]&524287|o[1]&4096&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}function Zp(l,e,t){let n,o,s,i;re(l,En,ce=>t(15,n=ce)),re(l,Zt,ce=>t(16,o=ce)),re(l,Qn,ce=>t(17,s=ce)),re(l,Ln,ce=>t(18,i=ce));let{history:r}=e,{models:a=[]}=e,{chatId:c=null}=e,{chatFiles:u=[]}=e,{params:f={}}=e,{eventTarget:d}=e,{submitPrompt:h}=e,{stopResponse:_}=e,{showMessage:b}=e,{files:w}=e,{modelId:g}=e,{pane:v}=e,y,E=!1,z=!1,D=0;const M=()=>{parseInt(localStorage==null?void 0:localStorage.chatControlsSize)?v.resize(parseInt(localStorage==null?void 0:localStorage.chatControlsSize)):v.resize(D)},A=async ce=>{ce.matches?(t(12,E=!0),n&&(En.set(!1),await tt(),En.set(!0))):(t(12,E=!1),n&&(En.set(!1),await tt(),En.set(!0)),t(4,v=null))},O=ce=>{t(13,z=!0)},L=ce=>{t(13,z=!1)};hn(()=>{y=window.matchMedia("(min-width: 1024px)"),y.addEventListener("change",A),A(y);const ce=document.getElementById("chat-container");t(14,D=Math.floor(350/ce.clientWidth*100)),new ResizeObserver(Qe=>{for(let ge of Qe){const Ue=350/ge.contentRect.width*100;t(14,D=Math.floor(Ue)),o&&v&&v.isExpanded()&&v.getSize()<D&&v.resize(D)}}).observe(ce),document.addEventListener("mousedown",O),document.addEventListener("mouseup",L)}),$n(()=>{Zt.set(!1),y.removeEventListener("change",A),document.removeEventListener("mousedown",O),document.removeEventListener("mouseup",L)});const W=()=>{Zt.set(!1),Qn.set(!1),Ln.set(!1),n&&En.set(!1)};function K(ce){w=ce,t(3,w)}const R=()=>{Zt.set(!1)},I=ce=>{b(ce.detail.node.data.message)},P=()=>{Zt.set(!1)};function N(ce){u=ce,t(1,u)}function Y(ce){f=ce,t(2,f)}const Z=()=>{Zt.set(!1)},F=()=>{Zt.set(!1)};function X(ce){w=ce,t(3,w)}const se=()=>{Zt.set(!1)},q=ce=>{ce.detail.node.data.message.favorite?t(0,r.messages[ce.detail.node.data.message.id].favorite=!0,r):t(0,r.messages[ce.detail.node.data.message.id].favorite=null,r),b(ce.detail.node.data.message)},G=()=>{Zt.set(!1)};function oe(ce){u=ce,t(1,u)}function ae(ce){f=ce,t(2,f)}const ve=()=>{Zt.set(!1)},$=ce=>{console.log("size",ce,D),o&&v.isExpanded()&&(ce<D&&v.resize(D),ce<D?localStorage.chatControlsSize=0:localStorage.chatControlsSize=ce)},Ie=()=>{Zt.set(!1)};function Ne(ce){v=ce,t(4,v)}return l.$$set=ce=>{"history"in ce&&t(0,r=ce.history),"models"in ce&&t(5,a=ce.models),"chatId"in ce&&t(6,c=ce.chatId),"chatFiles"in ce&&t(1,u=ce.chatFiles),"params"in ce&&t(2,f=ce.params),"eventTarget"in ce&&t(7,d=ce.eventTarget),"submitPrompt"in ce&&t(8,h=ce.submitPrompt),"stopResponse"in ce&&t(9,_=ce.stopResponse),"showMessage"in ce&&t(10,b=ce.showMessage),"files"in ce&&t(3,w=ce.files),"modelId"in ce&&t(11,g=ce.modelId),"pane"in ce&&t(4,v=ce.pane)},l.$$.update=()=>{l.$$.dirty[0]&64&&(c||W())},[r,u,f,w,v,a,c,d,h,_,b,g,E,z,D,n,o,s,i,M,K,R,I,P,N,Y,Z,F,X,se,q,G,oe,ae,ve,$,Ie,Ne]}class qp extends Oe{constructor(e){super(),He(this,e,Zp,Xp,Le,{history:0,models:5,chatId:6,chatFiles:1,params:2,eventTarget:7,submitPrompt:8,stopResponse:9,showMessage:10,files:3,modelId:11,pane:4,openPane:19},null,[-1,-1])}get openPane(){return this.$$.ctx[19]}}function Ji(l,e,t){const n=l.slice();return n[33]=e[t],n[35]=t,n}function Qi(l){let e,t;return e=new Ft({props:{content:"This chat won't appear in history and your messages will not be saved.",className:"w-full flex justify-center mb-0.5",placement:"top",$$slots:{default:[Jp]},$$scope:{ctx:l}}}),{c(){ee(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,o){te(e,n,o),t=!0},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}function Jp(l){let e,t,n,o;return t=new fu({props:{strokeWidth:"2.5",className:"size-5"}}),{c(){e=T("div"),ee(t.$$.fragment),n=ke(" Temporary Chat"),this.h()},l(s){e=V(s,"DIV",{class:!0});var i=S(e);le(t.$$.fragment,i),n=Ee(i," Temporary Chat"),i.forEach(p),this.h()},h(){m(e,"class","flex items-center gap-2 text-gray-500 font-medium text-lg my-2 w-fit")},m(s,i){B(s,e,i),te(t,e,null),k(e,n),o=!0},p:De,i(s){o||(C(t.$$.fragment,s),o=!0)},o(s){H(t.$$.fragment,s),o=!1},d(s){s&&p(e),ne(t)}}}function Qp(l){let e,t,n,o,s,i;function r(){return l[21](l[35])}return{c(){e=T("button"),t=T("img"),o=Q(),this.h()},l(a){e=V(a,"BUTTON",{});var c=S(e);t=V(c,"IMG",{crossorigin:!0,src:!0,class:!0,alt:!0,draggable:!0}),c.forEach(p),o=x(a),this.h()},h(){var a,c,u;m(t,"crossorigin","anonymous"),Yn(t.src,n=((u=(c=(a=l[33])==null?void 0:a.info)==null?void 0:c.meta)==null?void 0:u.profile_image_url)??(l[15].language==="dg-DG"?"/doge.png":`${Fl}/static/favicon.png`))||m(t,"src",n),m(t,"class","size-9 @sm:size-10 rounded-full border-[1px] border-gray-200 dark:border-none"),m(t,"alt","logo"),m(t,"draggable","false")},m(a,c){B(a,e,c),k(e,t),B(a,o,c),s||(i=Se(e,"click",r),s=!0)},p(a,c){var u,f,d;l=a,c[0]&40960&&!Yn(t.src,n=((d=(f=(u=l[33])==null?void 0:u.info)==null?void 0:f.meta)==null?void 0:d.profile_image_url)??(l[15].language==="dg-DG"?"/doge.png":`${Fl}/static/favicon.png`))&&m(t,"src",n)},d(a){a&&(p(e),p(o)),s=!1,i()}}}function xi(l){var n,o,s;let e,t;return e=new Ft({props:{content:(((s=(o=(n=l[13][l[35]])==null?void 0:n.info)==null?void 0:o.meta)==null?void 0:s.tags)??[]).map(ta).join(", "),placement:"top",$$slots:{default:[Qp]},$$scope:{ctx:l}}}),{c(){ee(e.$$.fragment)},l(i){le(e.$$.fragment,i)},m(i,r){te(e,i,r),t=!0},p(i,r){var c,u,f;const a={};r[0]&8192&&(a.content=(((f=(u=(c=i[13][i[35]])==null?void 0:c.info)==null?void 0:u.meta)==null?void 0:f.tags)??[]).map(ta).join(", ")),r[0]&57344|r[1]&32&&(a.$$scope={dirty:r,ctx:i}),e.$set(a)},i(i){t||(C(e.$$.fragment,i),t=!0)},o(i){H(e.$$.fragment,i),t=!1},d(i){ne(e,i)}}}function xp(l){let e=l[15].t("Hello, {{name}}",{name:l[17].name})+"",t;return{c(){t=ke(e)},l(n){t=Ee(n,e)},m(n,o){B(n,t,o)},p(n,o){o[0]&163840&&e!==(e=n[15].t("Hello, {{name}}",{name:n[17].name})+"")&&Ce(t,e)},d(n){n&&p(t)}}}function $p(l){var n;let e=((n=l[13][l[14]])==null?void 0:n.name)+"",t;return{c(){t=ke(e)},l(o){t=Ee(o,e)},m(o,s){B(o,t,s)},p(o,s){var i;s[0]&24576&&e!==(e=((i=o[13][o[14]])==null?void 0:i.name)+"")&&Ce(t,e)},d(o){o&&p(t)}}}function $i(l){var i,r,a,c,u,f;let e,t,n,o;e=new Ft({props:{className:" w-fit",content:kl.parse(go(((a=(r=(i=l[13][l[14]])==null?void 0:i.info)==null?void 0:r.meta)==null?void 0:a.description)??"")),placement:"top",$$slots:{default:[e_]},$$scope:{ctx:l}}});let s=((f=(u=(c=l[13][l[14]])==null?void 0:c.info)==null?void 0:u.meta)==null?void 0:f.user)&&ea(l);return{c(){ee(e.$$.fragment),t=Q(),s&&s.c(),n=Te()},l(d){le(e.$$.fragment,d),t=x(d),s&&s.l(d),n=Te()},m(d,h){te(e,d,h),B(d,t,h),s&&s.m(d,h),B(d,n,h),o=!0},p(d,h){var b,w,g,v,y,E;const _={};h[0]&24576&&(_.content=kl.parse(go(((g=(w=(b=d[13][d[14]])==null?void 0:b.info)==null?void 0:w.meta)==null?void 0:g.description)??""))),h[0]&24576|h[1]&32&&(_.$$scope={dirty:h,ctx:d}),e.$set(_),(E=(y=(v=d[13][d[14]])==null?void 0:v.info)==null?void 0:y.meta)!=null&&E.user?s?s.p(d,h):(s=ea(d),s.c(),s.m(n.parentNode,n)):s&&(s.d(1),s=null)},i(d){o||(C(e.$$.fragment,d),o=!0)},o(d){H(e.$$.fragment,d),o=!1},d(d){d&&(p(t),p(n)),ne(e,d),s&&s.d(d)}}}function e_(l){var o,s,i;let e,t,n=kl.parse(go((i=(s=(o=l[13][l[14]])==null?void 0:o.info)==null?void 0:s.meta)==null?void 0:i.description))+"";return{c(){e=T("div"),t=new ia(!1),this.h()},l(r){e=V(r,"DIV",{class:!0});var a=S(e);t=aa(a,!1),a.forEach(p),this.h()},h(){t.a=null,m(e,"class","mt-0.5 px-2 text-sm font-normal text-gray-500 dark:text-gray-400 line-clamp-2 max-w-xl markdown")},m(r,a){B(r,e,a),t.m(n,e)},p(r,a){var c,u,f;a[0]&24576&&n!==(n=kl.parse(go((f=(u=(c=r[13][r[14]])==null?void 0:c.info)==null?void 0:u.meta)==null?void 0:f.description))+"")&&t.p(n)},d(r){r&&p(e)}}}function ea(l){let e,t;function n(i,r){var a,c,u;return(u=(c=(a=i[13][i[14]])==null?void 0:a.info)==null?void 0:c.meta)!=null&&u.user.community?n_:t_}let o=n(l),s=o(l);return{c(){e=T("div"),t=ke(`By
								`),s.c(),this.h()},l(i){e=V(i,"DIV",{class:!0});var r=S(e);t=Ee(r,`By
								`),s.l(r),r.forEach(p),this.h()},h(){m(e,"class","mt-0.5 text-sm font-normal text-gray-400 dark:text-gray-500")},m(i,r){B(i,e,r),k(e,t),s.m(e,null)},p(i,r){o===(o=n(i))&&s?s.p(i,r):(s.d(1),s=o(i),s&&(s.c(),s.m(e,null)))},d(i){i&&p(e),s.d()}}}function t_(l){var n,o,s;let e=((s=(o=(n=l[13][l[14]])==null?void 0:n.info)==null?void 0:o.meta)==null?void 0:s.user.name)+"",t;return{c(){t=ke(e)},l(i){t=Ee(i,e)},m(i,r){B(i,t,r)},p(i,r){var a,c,u;r[0]&24576&&e!==(e=((u=(c=(a=i[13][i[14]])==null?void 0:a.info)==null?void 0:c.meta)==null?void 0:u.user.name)+"")&&Ce(t,e)},d(i){i&&p(t)}}}function n_(l){var s,i,r,a,c,u,f,d,h;let e,t=((r=(i=(s=l[13][l[14]])==null?void 0:s.info)==null?void 0:i.meta)!=null&&r.user.name?(u=(c=(a=l[13][l[14]])==null?void 0:a.info)==null?void 0:c.meta)==null?void 0:u.user.name:`@${(h=(d=(f=l[13][l[14]])==null?void 0:f.info)==null?void 0:d.meta)==null?void 0:h.user.username}`)+"",n,o;return{c(){e=T("a"),n=ke(t),this.h()},l(_){e=V(_,"A",{href:!0});var b=S(e);n=Ee(b,t),b.forEach(p),this.h()},h(){var _,b,w;m(e,"href",o="https://openwebui.com/m/"+((w=(b=(_=l[13][l[14]])==null?void 0:_.info)==null?void 0:b.meta)==null?void 0:w.user.username))},m(_,b){B(_,e,b),k(e,n)},p(_,b){var w,g,v,y,E,z,D,M,A,O,L,W;b[0]&24576&&t!==(t=((v=(g=(w=_[13][_[14]])==null?void 0:w.info)==null?void 0:g.meta)!=null&&v.user.name?(z=(E=(y=_[13][_[14]])==null?void 0:y.info)==null?void 0:E.meta)==null?void 0:z.user.name:`@${(A=(M=(D=_[13][_[14]])==null?void 0:D.info)==null?void 0:M.meta)==null?void 0:A.user.username}`)+"")&&Ce(n,t),b[0]&24576&&o!==(o="https://openwebui.com/m/"+((W=(L=(O=_[13][_[14]])==null?void 0:O.info)==null?void 0:L.meta)==null?void 0:W.user.username))&&m(e,"href",o)},d(_){_&&p(e)}}}function l_(l){var ce,Ze,Qe;let e,t,n,o,s,i,r,a,c,u,f,d,h,_,b,w,g,v,y,E,z,D,M,A,O,L,W,K,R=l[16]&&Qi(l),I=ht(l[13]),P=[];for(let ge=0;ge<I.length;ge+=1)P[ge]=xi(Ji(l,I,ge));const N=ge=>H(P[ge],1,1,()=>{P[ge]=null});function Y(ge,ie){var Ue;return(Ue=ge[13][ge[14]])!=null&&Ue.name?$p:xp}let Z=Y(l),F=Z(l),X=(((Qe=(Ze=(ce=l[13][l[14]])==null?void 0:ce.info)==null?void 0:Ze.meta)==null?void 0:Qe.description)??null)&&$i(l);function se(ge){l[22](ge)}function q(ge){l[23](ge)}function G(ge){l[24](ge)}function oe(ge){l[25](ge)}function ae(ge){l[26](ge)}function ve(ge){l[27](ge)}function $(ge){l[28](ge)}function Ie(ge){l[29](ge)}let Ne={history:l[12],selectedModels:l[11],transparentBackground:l[8],stopResponse:l[10],createMessagePair:l[9],placeholder:l[15].t("How can I help you today?")};return l[3]!==void 0&&(Ne.files=l[3]),l[2]!==void 0&&(Ne.prompt=l[2]),l[0]!==void 0&&(Ne.autoScroll=l[0]),l[4]!==void 0&&(Ne.selectedToolIds=l[4]),l[5]!==void 0&&(Ne.imageGenerationEnabled=l[5]),l[6]!==void 0&&(Ne.codeInterpreterEnabled=l[6]),l[7]!==void 0&&(Ne.webSearchEnabled=l[7]),l[1]!==void 0&&(Ne.atSelectedModel=l[1]),v=new Ea({props:Ne}),Ae.push(()=>Xe(v,"files",se)),Ae.push(()=>Xe(v,"prompt",q)),Ae.push(()=>Xe(v,"autoScroll",G)),Ae.push(()=>Xe(v,"selectedToolIds",oe)),Ae.push(()=>Xe(v,"imageGenerationEnabled",ae)),Ae.push(()=>Xe(v,"codeInterpreterEnabled",ve)),Ae.push(()=>Xe(v,"webSearchEnabled",$)),Ae.push(()=>Xe(v,"atSelectedModel",Ie)),v.$on("upload",l[30]),v.$on("submit",l[31]),{c(){e=T("div"),R&&R.c(),t=Q(),n=T("div"),o=T("div"),s=T("div"),i=T("div"),r=T("div");for(let ge=0;ge<P.length;ge+=1)P[ge].c();c=Q(),u=T("div"),F.c(),d=Q(),h=T("div"),_=T("div"),X&&X.c(),w=Q(),g=T("div"),ee(v.$$.fragment),this.h()},l(ge){e=V(ge,"DIV",{class:!0});var ie=S(e);R&&R.l(ie),t=x(ie),n=V(ie,"DIV",{class:!0});var Ue=S(n);o=V(Ue,"DIV",{class:!0});var et=S(o);s=V(et,"DIV",{class:!0});var at=S(s);i=V(at,"DIV",{class:!0});var _t=S(i);r=V(_t,"DIV",{class:!0});var nt=S(r);for(let At=0;At<P.length;At+=1)P[At].l(nt);nt.forEach(p),_t.forEach(p),c=x(at),u=V(at,"DIV",{class:!0});var mt=S(u);F.l(mt),mt.forEach(p),at.forEach(p),d=x(et),h=V(et,"DIV",{class:!0});var jt=S(h);_=V(jt,"DIV",{});var Ht=S(_);X&&X.l(Ht),Ht.forEach(p),jt.forEach(p),w=x(et),g=V(et,"DIV",{class:!0});var gt=S(g);le(v.$$.fragment,gt),gt.forEach(p),et.forEach(p),Ue.forEach(p),ie.forEach(p),this.h()},h(){m(r,"class","flex -space-x-4 mb-0.5"),m(i,"class","flex shrink-0 justify-center"),m(u,"class","text-3xl @sm:text-4xl line-clamp-1"),m(s,"class","flex flex-row justify-center gap-3 @sm:gap-3.5 w-fit px-5"),m(h,"class","flex mt-1 mb-2"),m(g,"class",W="text-base font-normal @md:max-w-3xl w-full py-3 "+(l[1]?"mt-2":"")),m(o,"class","w-full flex flex-col justify-center items-center"),m(n,"class","w-full text-3xl text-gray-800 dark:text-gray-100 font-medium text-center flex items-center gap-4 font-primary"),m(e,"class","m-auto w-full max-w-6xl px-2 @2xl:px-20 translate-y-6 py-24 text-center")},m(ge,ie){B(ge,e,ie),R&&R.m(e,null),k(e,t),k(e,n),k(n,o),k(o,s),k(s,i),k(i,r);for(let Ue=0;Ue<P.length;Ue+=1)P[Ue]&&P[Ue].m(r,null);k(s,c),k(s,u),F.m(u,null),k(o,d),k(o,h),k(h,_),X&&X.m(_,null),k(o,w),k(o,g),te(v,g,null),K=!0},p(ge,ie){var et,at,_t;if(ge[16]?R?ie[0]&65536&&C(R,1):(R=Qi(ge),R.c(),C(R,1),R.m(e,t)):R&&(Ve(),H(R,1,1,()=>{R=null}),ze()),ie[0]&57344){I=ht(ge[13]);let nt;for(nt=0;nt<I.length;nt+=1){const mt=Ji(ge,I,nt);P[nt]?(P[nt].p(mt,ie),C(P[nt],1)):(P[nt]=xi(mt),P[nt].c(),C(P[nt],1),P[nt].m(r,null))}for(Ve(),nt=I.length;nt<P.length;nt+=1)N(nt);ze()}Z===(Z=Y(ge))&&F?F.p(ge,ie):(F.d(1),F=Z(ge),F&&(F.c(),F.m(u,null))),((_t=(at=(et=ge[13][ge[14]])==null?void 0:et.info)==null?void 0:at.meta)==null?void 0:_t.description)??null?X?(X.p(ge,ie),ie[0]&24576&&C(X,1)):(X=$i(ge),X.c(),C(X,1),X.m(_,null)):X&&(Ve(),H(X,1,1,()=>{X=null}),ze());const Ue={};ie[0]&4096&&(Ue.history=ge[12]),ie[0]&2048&&(Ue.selectedModels=ge[11]),ie[0]&256&&(Ue.transparentBackground=ge[8]),ie[0]&1024&&(Ue.stopResponse=ge[10]),ie[0]&512&&(Ue.createMessagePair=ge[9]),ie[0]&32768&&(Ue.placeholder=ge[15].t("How can I help you today?")),!y&&ie[0]&8&&(y=!0,Ue.files=ge[3],Ge(()=>y=!1)),!E&&ie[0]&4&&(E=!0,Ue.prompt=ge[2],Ge(()=>E=!1)),!z&&ie[0]&1&&(z=!0,Ue.autoScroll=ge[0],Ge(()=>z=!1)),!D&&ie[0]&16&&(D=!0,Ue.selectedToolIds=ge[4],Ge(()=>D=!1)),!M&&ie[0]&32&&(M=!0,Ue.imageGenerationEnabled=ge[5],Ge(()=>M=!1)),!A&&ie[0]&64&&(A=!0,Ue.codeInterpreterEnabled=ge[6],Ge(()=>A=!1)),!O&&ie[0]&128&&(O=!0,Ue.webSearchEnabled=ge[7],Ge(()=>O=!1)),!L&&ie[0]&2&&(L=!0,Ue.atSelectedModel=ge[1],Ge(()=>L=!1)),v.$set(Ue),(!K||ie[0]&2&&W!==(W="text-base font-normal @md:max-w-3xl w-full py-3 "+(ge[1]?"mt-2":"")))&&m(g,"class",W)},i(ge){if(!K){C(R);for(let ie=0;ie<I.length;ie+=1)C(P[ie]);ge&&(a||ul(()=>{a=Ro(r,Bl,{duration:100}),a.start()})),ge&&(f||ul(()=>{f=Ro(u,Bl,{duration:100}),f.start()})),C(X),ge&&(b||ul(()=>{b=Ro(_,Bl,{duration:100,delay:50}),b.start()})),C(v.$$.fragment,ge),K=!0}},o(ge){H(R),P=P.filter(Boolean);for(let ie=0;ie<P.length;ie+=1)H(P[ie]);H(X),H(v.$$.fragment,ge),K=!1},d(ge){ge&&p(e),R&&R.d(),vn(P,ge),F.d(),X&&X.d(),ne(v)}}}const ta=l=>l.name.toUpperCase();function o_(l,e,t){let n,o,s,i;re(l,hl,F=>t(20,n=F)),re(l,Co,F=>t(16,s=F)),re(l,Kn,F=>t(17,i=F));const r=on(),a=Ot("i18n");re(l,a,F=>t(15,o=F));let{transparentBackground:c=!1}=e,{createMessagePair:u}=e,{stopResponse:f}=e,{autoScroll:d=!1}=e,{atSelectedModel:h}=e,{selectedModels:_}=e,{history:b}=e,{prompt:w=""}=e,{files:g=[]}=e,{selectedToolIds:v=[]}=e,{imageGenerationEnabled:y=!1}=e,{codeInterpreterEnabled:E=!1}=e,{webSearchEnabled:z=!1}=e,D=[],M=0;hn(()=>{});const A=F=>{t(14,M=F)};function O(F){g=F,t(3,g)}function L(F){w=F,t(2,w)}function W(F){d=F,t(0,d)}function K(F){v=F,t(4,v)}function R(F){y=F,t(5,y)}function I(F){E=F,t(6,E)}function P(F){z=F,t(7,z)}function N(F){h=F,t(1,h)}const Y=F=>{r("upload",F.detail)},Z=F=>{r("submit",F.detail)};return l.$$set=F=>{"transparentBackground"in F&&t(8,c=F.transparentBackground),"createMessagePair"in F&&t(9,u=F.createMessagePair),"stopResponse"in F&&t(10,f=F.stopResponse),"autoScroll"in F&&t(0,d=F.autoScroll),"atSelectedModel"in F&&t(1,h=F.atSelectedModel),"selectedModels"in F&&t(11,_=F.selectedModels),"history"in F&&t(12,b=F.history),"prompt"in F&&t(2,w=F.prompt),"files"in F&&t(3,g=F.files),"selectedToolIds"in F&&t(4,v=F.selectedToolIds),"imageGenerationEnabled"in F&&t(5,y=F.imageGenerationEnabled),"codeInterpreterEnabled"in F&&t(6,E=F.codeInterpreterEnabled),"webSearchEnabled"in F&&t(7,z=F.webSearchEnabled)},l.$$.update=()=>{l.$$.dirty[0]&1050624&&t(13,D=_.map(F=>n.find(X=>X.id===F))),l.$$.dirty[0]&10240&&_.length>0&&t(14,M=D.length-1)},[d,h,w,g,v,y,E,z,c,u,f,_,b,D,M,o,s,i,r,a,n,A,O,L,W,K,R,I,P,N,Y,Z]}class s_ extends Oe{constructor(e){super(),He(this,e,o_,l_,Le,{transparentBackground:8,createMessagePair:9,stopResponse:10,autoScroll:0,atSelectedModel:1,selectedModels:11,history:12,prompt:2,files:3,selectedToolIds:4,imageGenerationEnabled:5,codeInterpreterEnabled:6,webSearchEnabled:7},null,[-1,-1])}}const{Boolean:r_,document:qo}=ua;function na(l,e,t){const n=l.slice();return n[113]=e[t],n}function i_(l){let e,t,n,o;return n=new Vo({}),{c(){e=T("div"),t=T("div"),ee(n.$$.fragment),this.h()},l(s){e=V(s,"DIV",{class:!0});var i=S(e);t=V(i,"DIV",{class:!0});var r=S(t);le(n.$$.fragment,r),r.forEach(p),i.forEach(p),this.h()},h(){m(t,"class","m-auto"),m(e,"class","flex items-center justify-center h-full w-full")},m(s,i){B(s,e,i),k(e,t),te(n,t,null),o=!0},p:De,i(s){o||(C(n.$$.fragment,s),o=!0)},o(s){H(n.$$.fragment,s),o=!1},d(s){s&&p(e),ne(n)}}}function a_(l){var u;let e,t,n,o,s,i,r=(((u=l[21])==null?void 0:u.backgroundImageUrl)??null)&&la(l);function a(f){l[48](f)}let c={chat:{id:l[20],chat:{title:l[23],models:l[1],system:l[21].system??void 0,params:l[19],history:l[15],timestamp:Date.now()}},title:l[23],shareEnabled:!!l[15].currentId,initNewChat:l[33]};return l[1]!==void 0&&(c.selectedModels=l[1]),t=new zh({props:c}),l[47](t),Ae.push(()=>Xe(t,"selectedModels",a)),s=new gc({props:{direction:"horizontal",class:"w-full h-full",$$slots:{default:[d_]},$$scope:{ctx:l}}}),{c(){r&&r.c(),e=Q(),ee(t.$$.fragment),o=Q(),ee(s.$$.fragment)},l(f){r&&r.l(f),e=x(f),le(t.$$.fragment,f),o=x(f),le(s.$$.fragment,f)},m(f,d){r&&r.m(f,d),B(f,e,d),te(t,f,d),B(f,o,d),te(s,f,d),i=!0},p(f,d){var b;((b=f[21])==null?void 0:b.backgroundImageUrl)??null?r?r.p(f,d):(r=la(f),r.c(),r.m(e.parentNode,e)):r&&(r.d(1),r=null);const h={};d[0]&12091394&&(h.chat={id:f[20],chat:{title:f[23],models:f[1],system:f[21].system??void 0,params:f[19],history:f[15],timestamp:Date.now()}}),d[0]&8388608&&(h.title=f[23]),d[0]&32768&&(h.shareEnabled=!!f[15].currentId),!n&&d[0]&2&&(n=!0,h.selectedModels=f[1],Ge(()=>n=!1)),t.$set(h);const _={};d[0]&75496694|d[3]&8388608&&(_.$$scope={dirty:d,ctx:f}),s.$set(_)},i(f){i||(C(t.$$.fragment,f),C(s.$$.fragment,f),i=!0)},o(f){H(t.$$.fragment,f),H(s.$$.fragment,f),i=!1},d(f){f&&(p(e),p(o)),r&&r.d(f),l[47](null),ne(t,f),ne(s,f)}}}function la(l){let e,t,n,o;return{c(){e=T("div"),n=Q(),o=T("div"),this.h()},l(s){e=V(s,"DIV",{class:!0,style:!0}),S(e).forEach(p),n=x(s),o=V(s,"DIV",{class:!0}),S(o).forEach(p),this.h()},h(){m(e,"class",t="absolute "+(l[25]?"md:max-w-[calc(100%-260px)] md:translate-x-[260px]":"")+" top-0 left-0 w-full h-full bg-cover bg-center bg-no-repeat"),$e(e,"background-image","url("+l[21].backgroundImageUrl+")"),m(o,"class","absolute top-0 left-0 w-full h-full bg-linear-to-t from-white to-white/85 dark:from-gray-900 dark:to-gray-900/90 z-0")},m(s,i){B(s,e,i),B(s,n,i),B(s,o,i)},p(s,i){i[0]&33554432&&t!==(t="absolute "+(s[25]?"md:max-w-[calc(100%-260px)] md:translate-x-[260px]":"")+" top-0 left-0 w-full h-full bg-cover bg-center bg-no-repeat")&&m(e,"class",t),i[0]&2097152&&$e(e,"background-image","url("+s[21].backgroundImageUrl+")")},d(s){s&&(p(e),p(n),p(o))}}}function oa(l){let e,t,n,o=ht(l[26].filter(l[49])),s=[];for(let r=0;r<o.length;r+=1)s[r]=sa(na(l,o,r));const i=r=>H(s[r],1,1,()=>{s[r]=null});return{c(){e=T("div"),t=T("div");for(let r=0;r<s.length;r+=1)s[r].c();this.h()},l(r){e=V(r,"DIV",{class:!0});var a=S(e);t=V(a,"DIV",{class:!0});var c=S(t);for(let u=0;u<s.length;u+=1)s[u].l(c);c.forEach(p),a.forEach(p),this.h()},h(){m(t,"class","flex flex-col gap-1 w-full"),m(e,"class","absolute top-12 left-0 right-0 w-full z-30")},m(r,a){B(r,e,a),k(e,t);for(let c=0;c<s.length;c+=1)s[c]&&s[c].m(t,null);n=!0},p(r,a){if(a[0]&67108864){o=ht(r[26].filter(r[49]));let c;for(c=0;c<o.length;c+=1){const u=na(r,o,c);s[c]?(s[c].p(u,a),C(s[c],1)):(s[c]=sa(u),s[c].c(),C(s[c],1),s[c].m(t,null))}for(Ve(),c=o.length;c<s.length;c+=1)i(c);ze()}},i(r){if(!n){for(let a=0;a<o.length;a+=1)C(s[a]);n=!0}},o(r){s=s.filter(r_);for(let a=0;a<s.length;a+=1)H(s[a]);n=!1},d(r){r&&p(e),vn(s,r)}}}function sa(l){let e,t;return e=new ff({props:{banner:l[113]}}),e.$on("dismiss",l[50]),{c(){ee(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,o){te(e,n,o),t=!0},p(n,o){const s={};o[0]&67108864&&(s.banner=n[113]),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}function c_(l){var z;let e,t,n,o,s,i,r,a,c,u,f;function d(D){l[67](D)}function h(D){l[68](D)}function _(D){l[69](D)}function b(D){l[70](D)}function w(D){l[71](D)}function g(D){l[72](D)}function v(D){l[73](D)}function y(D){l[74](D)}let E={history:l[15],selectedModels:l[1],transparentBackground:((z=l[21])==null?void 0:z.backgroundImageUrl)??!1,stopResponse:l[39],createMessagePair:l[35]};return l[18]!==void 0&&(E.files=l[18]),l[16]!==void 0&&(E.prompt=l[16]),l[6]!==void 0&&(E.autoScroll=l[6]),l[11]!==void 0&&(E.selectedToolIds=l[11]),l[12]!==void 0&&(E.imageGenerationEnabled=l[12]),l[14]!==void 0&&(E.codeInterpreterEnabled=l[14]),l[13]!==void 0&&(E.webSearchEnabled=l[13]),l[2]!==void 0&&(E.atSelectedModel=l[2]),t=new s_({props:E}),Ae.push(()=>Xe(t,"files",d)),Ae.push(()=>Xe(t,"prompt",h)),Ae.push(()=>Xe(t,"autoScroll",_)),Ae.push(()=>Xe(t,"selectedToolIds",b)),Ae.push(()=>Xe(t,"imageGenerationEnabled",w)),Ae.push(()=>Xe(t,"codeInterpreterEnabled",g)),Ae.push(()=>Xe(t,"webSearchEnabled",v)),Ae.push(()=>Xe(t,"atSelectedModel",y)),t.$on("upload",l[75]),t.$on("submit",l[76]),{c(){e=T("div"),ee(t.$$.fragment),this.h()},l(D){e=V(D,"DIV",{class:!0});var M=S(e);le(t.$$.fragment,M),M.forEach(p),this.h()},h(){m(e,"class","overflow-auto w-full h-full flex items-center")},m(D,M){B(D,e,M),te(t,e,null),f=!0},p(D,M){var O;const A={};M[0]&32768&&(A.history=D[15]),M[0]&2&&(A.selectedModels=D[1]),M[0]&2097152&&(A.transparentBackground=((O=D[21])==null?void 0:O.backgroundImageUrl)??!1),!n&&M[0]&262144&&(n=!0,A.files=D[18],Ge(()=>n=!1)),!o&&M[0]&65536&&(o=!0,A.prompt=D[16],Ge(()=>o=!1)),!s&&M[0]&64&&(s=!0,A.autoScroll=D[6],Ge(()=>s=!1)),!i&&M[0]&2048&&(i=!0,A.selectedToolIds=D[11],Ge(()=>i=!1)),!r&&M[0]&4096&&(r=!0,A.imageGenerationEnabled=D[12],Ge(()=>r=!1)),!a&&M[0]&16384&&(a=!0,A.codeInterpreterEnabled=D[14],Ge(()=>a=!1)),!c&&M[0]&8192&&(c=!0,A.webSearchEnabled=D[13],Ge(()=>c=!1)),!u&&M[0]&4&&(u=!0,A.atSelectedModel=D[2],Ge(()=>u=!1)),t.$set(A)},i(D){f||(C(t.$$.fragment,D),f=!0)},o(D){H(t.$$.fragment,D),f=!1},d(D){D&&p(e),ne(t)}}}function u_(l){var se;let e,t,n,o,s,i,r,a,c,u,f,d,h,_,b,w,g,v,y,E="",z,D,M;function A(q){l[51](q)}function O(q){l[52](q)}function L(q){l[53](q)}let W={chatId:l[20],selectedModels:l[1],atSelectedModel:l[2],sendPrompt:l[38],showMessage:l[29],submitMessage:l[40],continueResponse:l[42],regenerateResponse:l[41],mergeResponses:l[43],chatActionHandler:l[34],addMessages:l[36],bottomPadding:l[18].length>0};l[15]!==void 0&&(W.history=l[15]),l[6]!==void 0&&(W.autoScroll=l[6]),l[16]!==void 0&&(W.prompt=l[16]),n=new du({props:W}),Ae.push(()=>Xe(n,"history",A)),Ae.push(()=>Xe(n,"autoScroll",O)),Ae.push(()=>Xe(n,"prompt",L));function K(q){l[57](q)}function R(q){l[58](q)}function I(q){l[59](q)}function P(q){l[60](q)}function N(q){l[61](q)}function Y(q){l[62](q)}function Z(q){l[63](q)}function F(q){l[64](q)}let X={history:l[15],selectedModels:l[1],transparentBackground:((se=l[21])==null?void 0:se.backgroundImageUrl)??!1,stopResponse:l[39],createMessagePair:l[35],onChange:l[56]};return l[18]!==void 0&&(X.files=l[18]),l[16]!==void 0&&(X.prompt=l[16]),l[6]!==void 0&&(X.autoScroll=l[6]),l[11]!==void 0&&(X.selectedToolIds=l[11]),l[12]!==void 0&&(X.imageGenerationEnabled=l[12]),l[14]!==void 0&&(X.codeInterpreterEnabled=l[14]),l[13]!==void 0&&(X.webSearchEnabled=l[13]),l[2]!==void 0&&(X.atSelectedModel=l[2]),c=new Ea({props:X}),Ae.push(()=>Xe(c,"files",K)),Ae.push(()=>Xe(c,"prompt",R)),Ae.push(()=>Xe(c,"autoScroll",I)),Ae.push(()=>Xe(c,"selectedToolIds",P)),Ae.push(()=>Xe(c,"imageGenerationEnabled",N)),Ae.push(()=>Xe(c,"codeInterpreterEnabled",Y)),Ae.push(()=>Xe(c,"webSearchEnabled",Z)),Ae.push(()=>Xe(c,"atSelectedModel",F)),c.$on("upload",l[65]),c.$on("submit",l[66]),{c(){e=T("div"),t=T("div"),ee(n.$$.fragment),r=Q(),a=T("div"),ee(c.$$.fragment),v=Q(),y=T("div"),y.innerHTML=E,this.h()},l(q){e=V(q,"DIV",{class:!0,id:!0});var G=S(e);t=V(G,"DIV",{class:!0});var oe=S(t);le(n.$$.fragment,oe),oe.forEach(p),G.forEach(p),r=x(q),a=V(q,"DIV",{class:!0});var ae=S(a);le(c.$$.fragment,ae),v=x(ae),y=V(ae,"DIV",{class:!0,"data-svelte-h":!0}),it(y)!=="svelte-1t2gtm5"&&(y.innerHTML=E),ae.forEach(p),this.h()},h(){m(t,"class","h-full w-full flex flex-col"),m(e,"class","pb-2.5 flex flex-col justify-between w-full flex-auto overflow-auto h-0 max-w-full z-10 scrollbar-hidden"),m(e,"id","messages-container"),m(y,"class","absolute bottom-1 text-xs text-gray-500 text-center line-clamp-1 right-0 left-0"),m(a,"class","pb-[1rem]")},m(q,G){B(q,e,G),k(e,t),te(n,t,null),l[54](e),B(q,r,G),B(q,a,G),te(c,a,null),k(a,v),k(a,y),z=!0,D||(M=Se(e,"scroll",l[55]),D=!0)},p(q,G){var ve;const oe={};G[0]&1048576&&(oe.chatId=q[20]),G[0]&2&&(oe.selectedModels=q[1]),G[0]&4&&(oe.atSelectedModel=q[2]),G[0]&262144&&(oe.bottomPadding=q[18].length>0),!o&&G[0]&32768&&(o=!0,oe.history=q[15],Ge(()=>o=!1)),!s&&G[0]&64&&(s=!0,oe.autoScroll=q[6],Ge(()=>s=!1)),!i&&G[0]&65536&&(i=!0,oe.prompt=q[16],Ge(()=>i=!1)),n.$set(oe);const ae={};G[0]&32768&&(ae.history=q[15]),G[0]&2&&(ae.selectedModels=q[1]),G[0]&2097152&&(ae.transparentBackground=((ve=q[21])==null?void 0:ve.backgroundImageUrl)??!1),G[0]&1048576&&(ae.onChange=q[56]),!u&&G[0]&262144&&(u=!0,ae.files=q[18],Ge(()=>u=!1)),!f&&G[0]&65536&&(f=!0,ae.prompt=q[16],Ge(()=>f=!1)),!d&&G[0]&64&&(d=!0,ae.autoScroll=q[6],Ge(()=>d=!1)),!h&&G[0]&2048&&(h=!0,ae.selectedToolIds=q[11],Ge(()=>h=!1)),!_&&G[0]&4096&&(_=!0,ae.imageGenerationEnabled=q[12],Ge(()=>_=!1)),!b&&G[0]&16384&&(b=!0,ae.codeInterpreterEnabled=q[14],Ge(()=>b=!1)),!w&&G[0]&8192&&(w=!0,ae.webSearchEnabled=q[13],Ge(()=>w=!1)),!g&&G[0]&4&&(g=!0,ae.atSelectedModel=q[2],Ge(()=>g=!1)),c.$set(ae)},i(q){z||(C(n.$$.fragment,q),C(c.$$.fragment,q),z=!0)},o(q){H(n.$$.fragment,q),H(c.$$.fragment,q),z=!1},d(q){q&&(p(e),p(r),p(a)),ne(n),l[54](null),ne(c),D=!1,M()}}}function f_(l){let e,t,n,o,s,i,r=l[26].length>0&&!l[15].currentId&&!l[20]&&l[1].length<=1&&oa(l);const a=[u_,c_],c=[];function u(f,d){var h;return d[0]&2129920&&(n=null),n==null&&(n=((h=f[21])==null?void 0:h.landingPageMode)==="chat"||bn(f[15],f[15].currentId).length>0||!0),n?0:1}return o=u(l,[-1,-1,-1,-1]),s=c[o]=a[o](l),{c(){r&&r.c(),e=Q(),t=T("div"),s.c(),this.h()},l(f){r&&r.l(f),e=x(f),t=V(f,"DIV",{class:!0});var d=S(t);s.l(d),d.forEach(p),this.h()},h(){m(t,"class","flex flex-col flex-auto z-10 w-full @container")},m(f,d){r&&r.m(f,d),B(f,e,d),B(f,t,d),c[o].m(t,null),i=!0},p(f,d){f[26].length>0&&!f[15].currentId&&!f[20]&&f[1].length<=1?r?(r.p(f,d),d[0]&68190210&&C(r,1)):(r=oa(f),r.c(),C(r,1),r.m(e.parentNode,e)):r&&(Ve(),H(r,1,1,()=>{r=null}),ze());let h=o;o=u(f,d),o===h?c[o].p(f,d):(Ve(),H(c[h],1,1,()=>{c[h]=null}),ze(),s=c[o],s?s.p(f,d):(s=c[o]=a[o](f),s.c()),C(s,1),s.m(t,null))},i(f){i||(C(r),C(s),i=!0)},o(f){H(r),H(s),i=!1},d(f){f&&(p(e),p(t)),r&&r.d(f),c[o].d()}}}function d_(l){var w;let e,t,n,o,s,i,r,a,c;e=new fa({props:{defaultSize:50,class:"h-full flex w-full relative",$$slots:{default:[f_]},$$scope:{ctx:l}}});function u(g){l[79](g)}function f(g){l[80](g)}function d(g){l[81](g)}function h(g){l[82](g)}function _(g){l[83](g)}let b={chatId:l[20],modelId:((w=l[10])==null?void 0:w.at(0))??null,models:l[10].reduce(l[77],[]),submitPrompt:l[37],stopResponse:l[39],showMessage:l[29],eventTarget:l[28]};return l[15]!==void 0&&(b.history=l[15]),l[17]!==void 0&&(b.chatFiles=l[17]),l[19]!==void 0&&(b.params=l[19]),l[18]!==void 0&&(b.files=l[18]),l[4]!==void 0&&(b.pane=l[4]),n=new qp({props:b}),l[78](n),Ae.push(()=>Xe(n,"history",u)),Ae.push(()=>Xe(n,"chatFiles",f)),Ae.push(()=>Xe(n,"params",d)),Ae.push(()=>Xe(n,"files",h)),Ae.push(()=>Xe(n,"pane",_)),{c(){ee(e.$$.fragment),t=Q(),ee(n.$$.fragment)},l(g){le(e.$$.fragment,g),t=x(g),le(n.$$.fragment,g)},m(g,v){te(e,g,v),B(g,t,v),te(n,g,v),c=!0},p(g,v){var z;const y={};v[0]&70645958|v[3]&8388608&&(y.$$scope={dirty:v,ctx:g}),e.$set(y);const E={};v[0]&1048576&&(E.chatId=g[20]),v[0]&1024&&(E.modelId=((z=g[10])==null?void 0:z.at(0))??null),v[0]&4195328&&(E.models=g[10].reduce(g[77],[])),!o&&v[0]&32768&&(o=!0,E.history=g[15],Ge(()=>o=!1)),!s&&v[0]&131072&&(s=!0,E.chatFiles=g[17],Ge(()=>s=!1)),!i&&v[0]&524288&&(i=!0,E.params=g[19],Ge(()=>i=!1)),!r&&v[0]&262144&&(r=!0,E.files=g[18],Ge(()=>r=!1)),!a&&v[0]&16&&(a=!0,E.pane=g[4],Ge(()=>a=!1)),n.$set(E)},i(g){c||(C(e.$$.fragment,g),C(n.$$.fragment,g),c=!0)},o(g){H(e.$$.fragment,g),H(n.$$.fragment,g),c=!1},d(g){g&&p(t),ne(e,g),l[78](null),ne(n,g)}}}function h_(l){let e,t,n,o,s,i,r,a,c,u,f,d,h;qo.title=e=`
		`+(l[23]?`${l[23].length>30?`${l[23].slice(0,30)}...`:l[23]} | ${l[24]}`:`${l[24]}`)+`
	`;function _(y){l[44](y)}let b={title:m_,message:g_,input:p_,inputPlaceholder:__,inputValue:b_};l[9]!==void 0&&(b.show=l[9]),i=new Au({props:b}),Ae.push(()=>Xe(i,"show",_)),i.$on("confirm",l[45]),i.$on("cancel",l[46]);const w=[a_,i_],g=[];function v(y,E){return y[0]===""||!y[3]&&y[0]?0:y[3]?1:-1}return~(u=v(l))&&(f=g[u]=w[u](l)),{c(){t=Q(),n=T("audio"),s=Q(),ee(i.$$.fragment),a=Q(),c=T("div"),f&&f.c(),this.h()},l(y){uc("svelte-8uu834",qo.head).forEach(p),t=x(y),n=V(y,"AUDIO",{id:!0,src:!0,style:!0}),S(n).forEach(p),s=x(y),le(i.$$.fragment,y),a=x(y),c=V(y,"DIV",{class:!0,id:!0});var z=S(c);f&&f.l(z),z.forEach(p),this.h()},h(){m(n,"id","audioElement"),Yn(n.src,o="")||m(n,"src",o),$e(n,"display","none"),m(c,"class",d="h-screen max-h-[100dvh] transition-width duration-200 ease-in-out "+(l[25]?"  md:max-w-[calc(100%-260px)]":" ")+" w-full max-w-full flex flex-col"),m(c,"id","chat-container")},m(y,E){B(y,t,E),B(y,n,E),B(y,s,E),te(i,y,E),B(y,a,E),B(y,c,E),~u&&g[u].m(c,null),h=!0},p(y,E){(!h||E[0]&25165824)&&e!==(e=`
		`+(y[23]?`${y[23].length>30?`${y[23].slice(0,30)}...`:y[23]} | ${y[24]}`:`${y[24]}`)+`
	`)&&(qo.title=e);const z={};!r&&E[0]&512&&(r=!0,z.show=y[9],Ge(()=>r=!1)),i.$set(z);let D=u;u=v(y),u===D?~u&&g[u].p(y,E):(f&&(Ve(),H(g[D],1,1,()=>{g[D]=null}),ze()),~u?(f=g[u],f?f.p(y,E):(f=g[u]=w[u](y),f.c()),C(f,1),f.m(c,null)):f=null),(!h||E[0]&33554432&&d!==(d="h-screen max-h-[100dvh] transition-width duration-200 ease-in-out "+(y[25]?"  md:max-w-[calc(100%-260px)]":" ")+" w-full max-w-full flex flex-col"))&&m(c,"class",d)},i(y){h||(C(i.$$.fragment,y),C(f),h=!0)},o(y){H(i.$$.fragment,y),H(f),h=!1},d(y){y&&(p(t),p(n),p(s),p(a),p(c)),ne(i,y),~u&&g[u].d()}}}let m_="",g_="",p_=!1,__="",b_="",Jo=null;function v_(l,e,t){let n,o,s,i,r,a,c,u,f,d,h,_,b,w,g,v,y;re(l,gl,U=>t(88,n=U)),re(l,Co,U=>t(89,o=U)),re(l,Jn,U=>t(20,s=U)),re(l,Fn,U=>t(21,i=U)),re(l,hl,U=>t(22,a=U)),re(l,vc,U=>t(91,c=U)),re(l,da,U=>t(92,u=U)),re(l,Kn,U=>t(93,f=U)),re(l,Do,U=>t(94,d=U)),re(l,pc,U=>t(95,h=U)),re(l,rs,U=>t(96,_=U)),re(l,fl,U=>t(97,b=U)),re(l,so,U=>t(23,w=U)),re(l,ga,U=>t(24,g=U)),re(l,xo,U=>t(25,v=U)),re(l,wc,U=>t(26,y=U));const E=Ot("i18n");re(l,E,U=>t(90,r=U));let{chatIdProp:z=""}=e,D=!1;const M=new EventTarget;let A,O,L=!0,W,K,R=!1,I,P=[""],N,Y=[],Z=[],F=!1,X=!1,se=!1,q=null,G={messages:{},currentId:null},oe=null,ae="",ve=[],$=[],Ie={};const Ne=()=>{P.length===0||P.length===1&&P[0]===""||(sessionStorage.selectedModels=JSON.stringify(P),console.log("saveSessionSelectedModels",P,sessionStorage.selectedModels))},ce=async()=>{var ue,pe;if(b||fl.set(await is(localStorage.token)),P.length!==1&&!N)return;const U=N??a.find(Ke=>Ke.id===P[0]);U&&t(11,Z=(((pe=(ue=U==null?void 0:U.info)==null?void 0:ue.meta)==null?void 0:pe.toolIds)??[]).filter(Ke=>b.find(he=>he.id===Ke)))},Ze=async U=>{const ue=JSON.parse(JSON.stringify(s));let pe=JSON.parse(JSON.stringify(U.id)),Ke=G.messages[pe].childrenIds;for(;Ke.length!==0;)pe=Ke.at(-1),Ke=G.messages[pe].childrenIds;t(15,G.currentId=pe,G),await tt(),await tt(),await tt();const he=document.getElementById(`message-${U.id}`);he&&he.scrollIntoView({behavior:"smooth"}),await tt(),We(ue,G)},Qe=async(U,ue)=>{var pe,Ke;if(console.log("ðŸ“¥ Socket event received:",U&&JSON.stringify(U).substring(0,200)+"..."),U.chat_id===s){await tt();let he=G.messages[U.message_id];if(he){const je=((pe=U==null?void 0:U.data)==null?void 0:pe.type)??null,ye=((Ke=U==null?void 0:U.data)==null?void 0:Ke.data)??null;if(console.log("ðŸ“¥ Event type:",je,"Data ID:",ye==null?void 0:ye.id),console.log("ðŸ“¥ Content preview:",ye!=null&&ye.content?ye.content.substring(0,50)+"...":"No content"),je==="chat:completion")console.log("ðŸ¤– Processing agent API response from socket event"),ye.content&&(console.log("ðŸ“ Content length:",ye.content.length),he.isLoading&&(he.isLoading=!1),he.content=ye.content,ye.done!==!1&&(he.done=!0,console.log("âœ… Marking message as done")),t(15,G.messages[U.message_id]={...he},G),console.log("âœ… Updated message in history.messages"),await tt(),console.log("âœ… Forced UI update"),ye.done&&L&&nt());else if(je==="status")he!=null&&he.statusHistory?he.statusHistory.push(ye):he.statusHistory=[ye];else if(je==="source"||je==="citation")if((ye==null?void 0:ye.type)==="code_execution"){he.codeExecutions||(he.codeExecutions=[]);const Re=he.codeExecutions.findIndex(ut=>ut.id===ye.execution_id);Re!==-1?he.codeExecutions[Re]={...he.codeExecutions[Re],...ye,updated:Date.now()}:he.codeExecutions.push({...ye,created:Date.now(),updated:Date.now()})}else he.sources||(he.sources=[]),he.sources.push(ye);else if(je==="chat:title")so.set(ye),gl.set(1),await pl.set(await Hl(localStorage.token,n));else if(je==="chat:tags")q=await $o(localStorage.token,s),yc.set(await Hc(localStorage.token));else if(je==="message")console.log("ðŸ“ Appending message content:",ye.content),he.isLoading&&(he.isLoading=!1),he.content+=ye.content;else if(je==="replace")console.log("ðŸ“ Replacing message content:",ye.content),he.isLoading&&(he.isLoading=!1),he.content=ye.content;else if(je==="action"){if(ye.action==="continue"){const Re=document.getElementById("continue-response-button");Re&&Re.click()}}else console.log("â“ Unknown message type:",je,ye);t(15,G={...G}),ue&&typeof ue=="function"&&ue(U,he)}else console.warn("âš ï¸ No message found for ID:",U.message_id)}},ge=async U=>{if(U.origin===window.origin){if(U.data.type==="input:prompt"){console.debug(U.data.text);const ue=document.getElementById("chat-input");ue&&(t(16,ae=U.data.text),ue.focus())}U.data.type==="action:submit"&&(console.debug(U.data.text),ae!==""&&(await tt(),gt(ae))),U.data.type==="input:prompt:submit"&&(console.debug(U.data.text),ae!==""&&(await tt(),gt(U.data.text)))}};hn(async()=>{if(console.log("mounted"),console.log("Initial userAPIKey value:",u?"Present":"Empty/None"),window.addEventListener("message",ge),c==null||c.on("chat-events",Qe),s?o&&await Uo("/"):I=Jn.subscribe(async ue=>{ue||await at()}),localStorage.getItem(`chat-input-${z}`))try{const ue=JSON.parse(localStorage.getItem(`chat-input-${z}`));t(16,ae=ue.prompt),t(18,$=ue.files),t(11,Z=ue.selectedToolIds),t(13,X=ue.webSearchEnabled),t(12,F=ue.imageGenerationEnabled)}catch{t(16,ae=""),t(18,$=[]),t(11,Z=[]),t(13,X=!1),t(12,F=!1)}Zt.subscribe(async ue=>{if(A&&!_)try{ue?O.openPane():A.collapse()}catch{}ue||(En.set(!1),Qn.set(!1),Ln.set(!1))});const U=document.getElementById("chat-input");U==null||U.focus(),pl.subscribe(()=>{}),window.addEventListener("beforeunload",ue=>{localStorage.setItem(`chat-input-${s}`,JSON.stringify({prompt:ae,files:$,selectedToolIds:Z,webSearchEnabled:X,imageGenerationEnabled:F}))})}),$n(()=>{I==null||I(),window.removeEventListener("message",ge),c==null||c.off("chat-events",Qe)});const ie=async U=>{var Ke,he;if(console.log("Starting uploadGoogleDriveFile with:",{id:U.id,name:U.name,url:U.url,headers:{Authorization:`Bearer ${token}`}}),!(U!=null&&U.id)||!(U!=null&&U.name)||!(U!=null&&U.url)||!((Ke=U==null?void 0:U.headers)!=null&&Ke.Authorization))throw new Error("Invalid file data provided");const ue=Hn(),pe={type:"file",file:"",id:null,url:U.url,name:U.name,collection_name:"",status:"uploading",error:"",itemId:ue,size:0};try{t(18,$=[...$,pe]),console.log("Processing web file with URL:",U.url);const je={headers:{Authorization:U.headers.Authorization,Accept:"*/*"},method:"GET"};console.log("Fetching file content from Google Drive...");const ye=await fetch(U.url,je);if(!ye.ok){const Vt=await ye.text();throw new Error(`Failed to fetch file (${ye.status}): ${Vt}`)}const Re=ye.headers.get("content-type")||"application/octet-stream";console.log("Response received with content-type:",Re),console.log("Converting response to blob...");const ut=await ye.blob();if(ut.size===0)throw new Error("Retrieved file is empty");console.log("Blob created:",{size:ut.size,type:ut.type||Re});const pt=new File([ut],U.name,{type:ut.type||Re});if(console.log("File object created:",{name:pt.name,size:pt.size,type:pt.type}),pt.size===0)throw new Error("Created file is empty");console.log("Uploading file to server...");const ft=await uploadFile(localStorage.token,pt);if(!ft)throw new Error("Server returned null response for file upload");console.log("File uploaded successfully:",ft),pe.status="uploaded",pe.file=ft,pe.id=ft.id,pe.size=pt.size,pe.collection_name=(he=ft==null?void 0:ft.meta)==null?void 0:he.collection_name,pe.url=`${WEBUI_API_BASE_URL}/files/${ft.id}`,t(18,$),t(0,z),ct.success(r.t("File uploaded successfully"))}catch(je){console.error("Error uploading file:",je),t(18,$=$.filter(ye=>ye.itemId!==ue)),ct.error(r.t("Error uploading file: {{error}}",{error:je.message||"Unknown error"}))}},Ue=async U=>{console.log(U);const ue={type:"doc",name:U,collection_name:"",status:"uploading",url:U,error:""};try{t(18,$=[...$,ue]);const pe=await Bc(localStorage.token,"",U);pe&&(ue.status="uploaded",ue.collection_name=pe.collection_name,ue.file={...pe.file,...ue.file},t(18,$),t(0,z))}catch(pe){t(18,$=$.filter(Ke=>Ke.name!==U)),ct.error(JSON.stringify(pe))}},et=async U=>{console.log(U);const ue={type:"doc",name:U,collection_name:"",status:"uploading",context:"full",url:U,error:""};try{t(18,$=[...$,ue]);const pe=await Rc(localStorage.token,U);pe&&(ue.status="uploaded",ue.collection_name=pe.collection_name,ue.file={...pe.file,...ue.file},t(18,$),t(0,z))}catch(pe){t(18,$=$.filter(Ke=>Ke.name!==U)),ct.error(`${pe}`)}},at=async()=>{var pe,Ke,he,je;if(h.url.searchParams.get("models"))t(1,P=(pe=h.url.searchParams.get("models"))==null?void 0:pe.split(","));else if(h.url.searchParams.get("model")){const ye=(Ke=h.url.searchParams.get("model"))==null?void 0:Ke.split(",");if(ye.length===1)if(a.find(ut=>ut.id===ye[0]))t(1,P=ye);else{const ut=document.getElementById("model-selector-0-button");if(ut){ut.click(),await tt();const pt=document.getElementById("model-search-input");pt&&(pt.focus(),pt.value=ye[0],pt.dispatchEvent(new Event("input")))}}else t(1,P=ye)}else sessionStorage.selectedModels?(t(1,P=JSON.parse(sessionStorage.selectedModels)),sessionStorage.removeItem("selectedModels")):i!=null&&i.models?t(1,P=i==null?void 0:i.models):d!=null&&d.default_models&&(console.log((d==null?void 0:d.default_models.split(","))??""),t(1,P=d==null?void 0:d.default_models.split(",")));t(1,P=P.filter(ye=>a.map(Re=>Re.id).includes(ye))),(P.length===0||P.length===1&&P[0]==="")&&(a.length>0?t(1,P=[a[0].id]):t(1,P=[""])),await Zt.set(!1),await En.set(!1),await Qn.set(!1),await Ln.set(!1),h.url.pathname.includes("/c/")&&window.history.replaceState(G.state,"","/"),t(6,L=!0),await Jn.set(""),await so.set(""),t(15,G={messages:{},currentId:null}),Be(),t(17,ve=[]),t(19,Ie={}),h.url.searchParams.get("youtube")&&et(`https://www.youtube.com/watch?v=${h.url.searchParams.get("youtube")}`),h.url.searchParams.get("web-search")==="true"&&t(13,X=!0),h.url.searchParams.get("image-generation")==="true"&&t(12,F=!0),h.url.searchParams.get("tools")?t(11,Z=(he=h.url.searchParams.get("tools"))==null?void 0:he.split(",").map(ye=>ye.trim()).filter(ye=>ye)):h.url.searchParams.get("tool-ids")&&t(11,Z=(je=h.url.searchParams.get("tool-ids"))==null?void 0:je.split(",").map(ye=>ye.trim()).filter(ye=>ye)),h.url.searchParams.get("call")==="true"&&(En.set(!0),Zt.set(!0)),h.url.searchParams.get("q")&&(t(16,ae=h.url.searchParams.get("q")??""),ae&&(await tt(),gt(ae))),t(1,P=P.map(ye=>a.map(Re=>Re.id).includes(ye)?ye:""));const U=await Ps(localStorage.token);U?Fn.set(U.ui):Fn.set(JSON.parse(localStorage.getItem("settings")??"{}"));const ue=document.getElementById("chat-input");setTimeout(()=>ue==null?void 0:ue.focus(),0)},_t=async()=>{if(Jn.set(z),q=await $o(localStorage.token,s).catch(async U=>(await Uo("/"),null)),q){await Ac(localStorage.token,s).catch(async ue=>[]);const U=q.chat;if(U){console.log(U),t(1,P=((U==null?void 0:U.models)??void 0)!==void 0?U.models:[U.models??""]),t(15,G=((U==null?void 0:U.history)??void 0)!==void 0?U.history:zc(U.messages)),so.set(U.title);const ue=await Ps(localStorage.token);return ue?await Fn.set(ue.ui):await Fn.set(JSON.parse(localStorage.getItem("settings")??"{}")),t(19,Ie=(U==null?void 0:U.params)??{}),t(17,ve=(U==null?void 0:U.files)??[]),t(6,L=!0),await tt(),G.currentId&&t(15,G.messages[G.currentId].done=!0,G),await tt(),!0}else return null}},nt=async()=>{await tt(),W&&t(7,W.scrollTop=W.scrollHeight,W)},mt=async(U,ue,pe,Ke,he=null)=>{const je=bn(G,Ke),ye=await Yc(localStorage.token,ue,{model:pe,messages:je.map(Re=>({id:Re.id,role:Re.role,content:Re.content,info:Re.info?Re.info:void 0,timestamp:Re.timestamp,...Re.sources?{sources:Re.sources}:{}})),...he?{event:he}:{},model_item:a.find(Re=>Re.id===pe),chat_id:U,session_id:c==null?void 0:c.id,id:Ke}).catch(Re=>(ct.error(`${Re}`),je.at(-1).error={content:Re},null));if(ye!==null&&ye.messages)for(const Re of ye.messages)t(15,G.messages[Re.id]={...G.messages[Re.id],...G.messages[Re.id].content!==Re.content?{originalContent:G.messages[Re.id].content}:{},...Re},G);s==U&&(o||(q=await Ns(localStorage.token,U,{models:P,messages:je,history:G,params:Ie,files:ve}),gl.set(1),await pl.set(await Hl(localStorage.token,n))))},jt=async U=>{if(t(16,ae=""),P.length===0)ct.error(r.t("Model not selected"));else{const ue=P[0],pe=a.filter(pt=>pt.id===ue).at(0),Ke=bn(G,G.currentId),he=Ke.length!==0?Ke.at(-1):null,je=Hn(),ye=Hn(),Re={id:je,parentId:he?he.id:null,childrenIds:[ye],role:"user",content:U||`[PROMPT] ${je}`,timestamp:Math.floor(Date.now()/1e3)},ut={id:ye,parentId:je,childrenIds:[],role:"assistant",content:`[RESPONSE] ${ye}`,done:!0,model:ue,modelName:pe.name??pe.id,modelIdx:0,timestamp:Math.floor(Date.now()/1e3)};he&&(he.childrenIds.push(je),t(15,G.messages[he.id]=he,G)),t(15,G.messages[je]=Re,G),t(15,G.messages[ye]=ut,G),t(15,G.currentId=ye,G),await tt(),L&&nt(),Ke.length===0?await fe(G):await We(s,G)}},Ht=async({modelId:U,parentId:ue,messages:pe})=>{const Ke=a.filter(ye=>ye.id===U).at(0);let he=G.messages[ue],je=he?he.id:null;for(const ye of pe){let Re=Hn();if(ye.role==="user"){const ut={id:Re,parentId:je,childrenIds:[],timestamp:Math.floor(Date.now()/1e3),...ye};he&&(he.childrenIds.push(Re),t(15,G.messages[he.id]=he,G)),t(15,G.messages[Re]=ut,G),he=ut,je=Re}else{const ut={id:Re,parentId:je,childrenIds:[],done:!0,model:Ke.id,modelName:Ke.name??Ke.id,modelIdx:0,timestamp:Math.floor(Date.now()/1e3),...ye};he&&(he.childrenIds.push(Re),t(15,G.messages[he.id]=he,G)),t(15,G.messages[Re]=ut,G),he=ut,je=Re}}t(15,G.currentId=je,G),await tt(),L&&nt(),pe.length===0?await fe(G):await We(s,G)},gt=async(U,{_raw:ue=!1}={})=>{var pt,ft,Vt;console.log("ðŸš€ submitPrompt",U,s),console.log("ðŸ“‹ Current history IDs:",{currentId:G.currentId,messagesCount:Object.keys(G.messages).length});const pe=bn(G,G.currentId);pe&&console.log("ðŸ“‹ Last message:",pe.length>0?{role:pe[pe.length-1].role,content:pe[pe.length-1].content.slice(0,50)+"..."}:"No messages");const Ke=P.map(St=>a.map(kn=>kn.id).includes(St)?St:"");if(JSON.stringify(P)!==JSON.stringify(Ke)&&t(1,P=Ke),U===""&&$.length===0){ct.error(r.t("Please enter a prompt"));return}if(P.includes("")){ct.error(r.t("Model not selected"));return}if(pe.length!=0&&pe.at(-1).done!=!0)return;if(pe.length!=0&&pe.at(-1).error&&!pe.at(-1).content){ct.error(r.t("Oops! There was an error in the previous response."));return}if($.length>0&&$.filter(St=>St.type!=="image"&&St.status==="uploading").length>0){ct.error(r.t("Oops! There are files still uploading. Please wait for the upload to complete."));return}if((((pt=d==null?void 0:d.file)==null?void 0:pt.max_count)??null)!==null&&$.length+ve.length>((ft=d==null?void 0:d.file)==null?void 0:ft.max_count)){ct.error(r.t("You can only chat with a maximum of {{maxCount}} file(s) at a time.",{maxCount:(Vt=d==null?void 0:d.file)==null?void 0:Vt.max_count}));return}t(16,ae="");const he=document.getElementById("chat-input");he&&(await tt(),he.style.height="",he.style.height=Math.min(he.scrollHeight,320)+"px");const je=JSON.parse(JSON.stringify($));ve.push(...je.filter(St=>["doc","file","collection"].includes(St.type))),t(17,ve=ve.filter((St,kn,Pn)=>Pn.findIndex(fn=>JSON.stringify(fn)===JSON.stringify(St))===kn)),t(18,$=[]),t(16,ae="");let ye=Hn(),Re={id:ye,parentId:pe.length!==0?pe.at(-1).id:null,childrenIds:[],role:"user",content:U,files:je.length>0?je:void 0,timestamp:Math.floor(Date.now()/1e3),models:P};t(15,G.messages[ye]=Re,G),t(15,G.currentId=ye,G),pe.length!==0&&G.messages[pe.at(-1).id].childrenIds.push(ye);const ut=document.getElementById("chat-input");ut==null||ut.focus(),Ne(),await me(G,U,ye,{newChat:!0})},At=async(U,ue,pe,Ke)=>{var St,kn,Pn,fn,zt,kt,nl,Ml,Tl,ll,_n,ol,Vl,sl,zl,rl,Nl,il,Pl;console.log("ðŸ”Œ sendPromptSocket:",{modelId:ue.id,responseMessageId:pe,chatId:Ke});const he=U.messages[pe],je=U.messages[he.parentId];let ye=JSON.parse(JSON.stringify(ve));ye.push(...((je==null?void 0:je.files)??[]).filter(st=>["doc","file","collection"].includes(st.type)),...((he==null?void 0:he.files)??[]).filter(st=>["web_search_results"].includes(st.type))),ye=ye.filter((st,Xn,Cn)=>Cn.findIndex(Un=>JSON.stringify(Un)===JSON.stringify(st))===Xn),nt(),M.dispatchEvent(new CustomEvent("chat:start",{detail:{id:pe}})),await tt();const ut=await(async()=>{if(i!=null&&i.userLocation)try{return await Fc(localStorage.token)}catch(st){console.error(st);return}})();console.log("Sending userAPIKey to backend:",u?"Present":"Empty/None"),he.content="",((i==null?void 0:i.processingMessage)??!1)&&(he.content=i.processingMessage===!0?"...":i.processingMessage);const pt=((kn=(St=ue==null?void 0:ue.info)==null?void 0:St.params)==null?void 0:kn.stream_response)??((Pn=i==null?void 0:i.params)==null?void 0:Pn.stream_response)??(Ie==null?void 0:Ie.stream_response)??!0;let ft=[Ie!=null&&Ie.system||i.system||((he==null?void 0:he.userContext)??null)?{role:"system",content:`${Nc((Ie==null?void 0:Ie.system)??(i==null?void 0:i.system)??"",f.name,ut,u)}${(he==null?void 0:he.userContext)??null?`

User Context:
${(he==null?void 0:he.userContext)??""}`:""}`}:void 0,...bn(U,pe).map(st=>({...st,content:Pc(st.content,["reasoning","code_interpreter"])}))].filter(Boolean);ft=ft.map((st,Xn,Cn)=>{var Un,Ol,al;return{role:st.role,...((Un=st.files)==null?void 0:Un.filter(Zn=>Zn.type==="image").length)>0&&st.role==="user"?{content:[{type:"text",text:((Ol=st==null?void 0:st.merged)==null?void 0:Ol.content)??st.content},...st.files.filter(Zn=>Zn.type==="image").map(Zn=>({type:"image_url",image_url:{url:Zn.url}}))]}:{content:((al=st==null?void 0:st.merged)==null?void 0:al.content)??st.content}}}).filter(st=>{var Xn;return(st==null?void 0:st.role)==="user"||((Xn=st==null?void 0:st.content)==null?void 0:Xn.trim())});const Vt=await Lc(localStorage.token,{stream:pt,model:ue.id,messages:ft,params:{...i==null?void 0:i.params,...Ie,format:i.requestFormat??void 0,keep_alive:i.keepAlive??void 0,stop:(Ie==null?void 0:Ie.stop)??((fn=i==null?void 0:i.params)==null?void 0:fn.stop)??void 0?((Ie==null?void 0:Ie.stop.split(",").map(st=>st.trim()))??i.params.stop).map(st=>decodeURIComponent(JSON.parse('"'+st.replace(/\"/g,'\\"')+'"'))):void 0},files:((ye==null?void 0:ye.length)??0)>0?ye:void 0,tool_ids:Z.length>0?Z:void 0,features:{image_generation:(zt=d==null?void 0:d.features)!=null&&zt.enable_image_generation&&(f.role==="admin"||(nl=(kt=f==null?void 0:f.permissions)==null?void 0:kt.features)!=null&&nl.image_generation)?F:!1,code_interpreter:(Ml=d==null?void 0:d.features)!=null&&Ml.enable_code_interpreter&&(f.role==="admin"||(ll=(Tl=f==null?void 0:f.permissions)==null?void 0:Tl.features)!=null&&ll.code_interpreter)?se:!1,web_search:(_n=d==null?void 0:d.features)!=null&&_n.enable_web_search&&(f.role==="admin"||(Vl=(ol=f==null?void 0:f.permissions)==null?void 0:ol.features)!=null&&Vl.web_search)?X||((i==null?void 0:i.webSearch)??!1)==="always":!1},variables:(console.log("Sending userAPIKey to backend:",u?"Present":"Empty/None"),Oc(f.name,ut,u)),model_item:a.find(st=>st.id===ue.id),session_id:c==null?void 0:c.id,chat_id:Ke,id:pe,...!o&&(ft.length==1||ft.length==2&&((sl=ft.at(0))==null?void 0:sl.role)==="system"&&((zl=ft.at(1))==null?void 0:zl.role)==="user")&&(P[0]===ue.id||N!==void 0)?{background_tasks:{title_generation:((rl=i==null?void 0:i.title)==null?void 0:rl.auto)??!0,tags_generation:(i==null?void 0:i.autoTags)??!0}}:{},...pt&&(((Pl=(il=(Nl=ue.info)==null?void 0:Nl.meta)==null?void 0:il.capabilities)==null?void 0:Pl.usage)??!1)?{stream_options:{include_usage:!0}}:{}},`${Fl}/api`).catch(st=>(ct.error(`${st}`),he.error={content:st},he.done=!0,t(15,G.messages[pe]=he,G),t(15,G.currentId=pe,G),null));console.log(Vt),Vt&&(oe=Vt.task_id),await tt(),nt()},me=async(U,ue,pe,Ke={})=>{const{modelId:he,modelIdx:je=0,newChat:ye=!1}=Ke;let Re=s;if(ye&&!o&&!Re){console.log("ðŸ†• Creating new chat for prompt");try{q=await zs(localStorage.token,{id:Re,title:r.t("New Chat"),models:P,system:i.system??void 0,params:Ie,history:G,messages:bn(G,G.currentId),tags:[],timestamp:Date.now()}),Re=q.id,await Jn.set(Re),await pl.set(await Hl(localStorage.token,n)),gl.set(1);try{window.history.pushState({},"",`/c/${Re}`)}catch(fn){console.error("âŒ Error updating URL:",fn)}}catch(fn){console.error("âŒ Error creating chat:",fn),Re=null}}const pt=bn(U,pe).at(-1),ft=Hn();let Vt;if(he)Vt=a.find(fn=>fn.id===he);else{const fn=((pt==null?void 0:pt.models)??P)[0];Vt=a.find(zt=>zt.id===fn)}if(!Vt){ct.error(r.t("Model not selected"));return}const St=Vt.id==="accounting_en"||Vt.id.includes("accounting");console.log(`ðŸ·ï¸ Model ${Vt.id} is agent model: ${St}`);const kn=St?r.t("Agent is helping..."):"",Pn={id:ft,parentId:pe,childrenIds:[],role:"assistant",content:kn,model:Vt.id,modelName:(Vt==null?void 0:Vt.name)??Vt.id,modelIdx:je,timestamp:Math.floor(Date.now()/1e3),isAgentResponse:St,isLoading:St};return U.messages[ft]=Pn,U.currentId=ft,U.messages[pe].childrenIds.push(ft),await tt(),L&&nt(),St&&Lt(ft),await At(U,Vt,ft,Re),ft},Lt=async U=>{const ue=[r.t("Agent is helping..."),r.t("Agent is processing your request..."),r.t("Agent is working on it..."),r.t("Agent is analyzing...")];let pe=0,Ke=0;const he=()=>{const je=G.messages[U];if(!je||!je.isLoading||je.content&&je.content.length>30)return;const ye=ue[pe],Re=".".repeat(Ke%4);t(15,G.messages[U].content=ye+Re,G),t(15,G={...G}),Ke++,Ke%12===0&&(pe=(pe+1)%ue.length),setTimeout(he,400)};he()},Et=()=>{if(oe&&Kc(localStorage.token,oe).catch(ue=>null)){oe=null;const ue=G.messages[G.currentId];ue.done=!0,t(15,G.messages[G.currentId]=ue,G),L&&nt()}},Ct=async(U,ue)=>{let pe=ue,Ke=Hn(),he={id:Ke,parentId:U,childrenIds:[],role:"user",content:pe,models:P};U!==null&&t(15,G.messages[U].childrenIds=[...G.messages[U].childrenIds,Ke],G),t(15,G.messages[Ke]=he,G),t(15,G.currentId=Ke,G),await tt(),await me(G,pe,Ke)},Pe=async U=>{if(console.log("regenerateResponse"),G.currentId){let ue=G.messages[U.parentId],pe=ue.content;((ue==null?void 0:ue.models)??[...P]).length==1?await me(G,pe,ue.id):await me(G,pe,ue.id,{modelId:U.model,modelIdx:U.modelIdx})}},qt=async()=>{if(console.log("continueResponse"),JSON.parse(JSON.stringify(s)),G.currentId&&G.messages[G.currentId].done==!0){const U=G.messages[G.currentId];U.done=!1,await tt();const ue=a.filter(pe=>pe.id===((U==null?void 0:U.selectedModelId)??U.model)).at(0);ue&&await me(G,U.content,U.parentId,{modelId:ue.id,modelIdx:U.modelIdx})}},It=async(U,ue,pe)=>{console.log("mergeResponses",U,ue);const Ke=G.messages[U],he={status:!0,content:""};Ke.merged=he,t(15,G.messages[U]=Ke,G);try{const[je,ye]=await Gc(localStorage.token,Ke.model,G.messages[Ke.parentId].content,ue);if(je&&je.ok&&je.body){const Re=await of(je.body,i.splitLargeChunks);for await(const ut of Re){const{value:pt,done:ft,sources:Vt,error:St,usage:kn}=ut;if(St||ft)break;he.content==""&&pt==`
`||(he.content+=pt,t(15,G.messages[U]=Ke,G),L&&nt())}await We(pe,G)}else console.error(je)}catch(je){console.error(je)}},fe=async U=>{let ue=s;return o?(ue="local",await Jn.set("local")):(q=await zs(localStorage.token,{id:ue,title:r.t("New Chat"),models:P,system:i.system??void 0,params:Ie,history:U,messages:bn(U,U.currentId),tags:[],timestamp:Date.now()}),ue=q.id,await Jn.set(ue),await pl.set(await Hl(localStorage.token,n)),gl.set(1),window.history.replaceState(U.state,"",`/c/${ue}`)),await tt(),ue},We=async(U,ue)=>{s==U&&(o||(q=await Ns(localStorage.token,U,{models:P,history:ue,messages:bn(ue,ue.currentId),params:Ie,files:ve}),gl.set(1),await pl.set(await Hl(localStorage.token,n))))},Be=()=>{let U=Hn();const pe=localStorage.getItem("locale")==="zh-CN"?"æ‚¨å¥½ï¼æˆ‘æ˜¯æ‚¨çš„ä¼šè®¡åŠ©æ‰‹ã€‚è¯·å‘Šè¯‰æˆ‘æ‚¨éœ€è¦åˆ†æžçš„è´¢åŠ¡æ•°æ®æˆ–æœ‰ä»€ä¹ˆè´¢åŠ¡é—®é¢˜ã€‚":"Hello! I'm your accounting assistant. How can I help with your financial data analysis?";t(15,G.messages[U]={id:U,role:"assistant",content:pe,model:"Assistant",modelName:"Assistant",parentId:null,timestamp:Math.floor(Date.now()/1e3),childrenIds:[],done:!0},G),t(15,G.currentId=U,G)};function Je(U){R=U,t(9,R)}const wt=U=>{U.detail?Jo(U.detail):Jo(!0)},bt=()=>{Jo(!1)};function Mt(U){Ae[U?"unshift":"push"](()=>{K=U,t(8,K)})}function Tt(U){P=U,t(1,P)}const rn=U=>U.dismissible?!JSON.parse(localStorage.getItem("dismissedBannerIds")??"[]").includes(U.id):!0,Bt=U=>{const ue=U.detail;localStorage.setItem("dismissedBannerIds",JSON.stringify([ue,...JSON.parse(localStorage.getItem("dismissedBannerIds")??"[]")].filter(pe=>y.find(Ke=>Ke.id===pe))))};function Rt(U){G=U,t(15,G)}function Yt(U){L=U,t(6,L)}function Kt(U){ae=U,t(16,ae),t(0,z)}function tn(U){Ae[U?"unshift":"push"](()=>{W=U,t(7,W)})}const an=U=>{t(6,L=W.scrollHeight-W.scrollTop<=W.clientHeight+5)},Pt=U=>{U.prompt?localStorage.setItem(`chat-input-${s}`,JSON.stringify(U)):localStorage.removeItem(`chat-input-${s}`)};function yt(U){$=U,t(18,$),t(0,z)}function wn(U){ae=U,t(16,ae),t(0,z)}function mn(U){L=U,t(6,L)}function yn(U){Z=U,t(11,Z),t(0,z)}function Sn(U){F=U,t(12,F),t(0,z)}function Nn(U){se=U,t(14,se)}function j(U){X=U,t(13,X),t(0,z)}function we(U){N=U,t(2,N)}const Fe=async U=>{const{type:ue,data:pe}=U.detail;ue==="web"?await Ue(pe):ue==="youtube"?await et(pe):ue==="google-drive"&&await ie(pe)},qe=async U=>{(U.detail||$.length>0)&&(await tt(),gt((i==null?void 0:i.richTextInput)??!0?U.detail.replaceAll(`

`,`
`):U.detail))};function Me(U){$=U,t(18,$),t(0,z)}function Ye(U){ae=U,t(16,ae),t(0,z)}function Dt(U){L=U,t(6,L)}function rt(U){Z=U,t(11,Z),t(0,z)}function cn(U){F=U,t(12,F),t(0,z)}function Gt(U){se=U,t(14,se)}function un(U){X=U,t(13,X),t(0,z)}function nn(U){N=U,t(2,N)}const Jt=async U=>{const{type:ue,data:pe}=U.detail;ue==="web"?await Ue(pe):ue==="youtube"&&await et(pe)},pn=async U=>{(U.detail||$.length>0)&&(await tt(),gt((i==null?void 0:i.richTextInput)??!0?U.detail.replaceAll(`

`,`
`):U.detail))},Rn=(U,ue,pe,Ke)=>{const he=a.find(je=>je.id===ue);return he?[...U,he]:U};function Gn(U){Ae[U?"unshift":"push"](()=>{O=U,t(5,O)})}function el(U){G=U,t(15,G)}function Dn(U){ve=U,t(17,ve)}function ml(U){Ie=U,t(19,Ie)}function tl(U){$=U,t(18,$),t(0,z)}function J(U){A=U,t(4,A)}return l.$$set=U=>{"chatIdProp"in U&&t(0,z=U.chatIdProp)},l.$$.update=()=>{l.$$.dirty[0]&6&&t(10,Y=N!==void 0?[N.id]:P),l.$$.dirty[0]&1&&z&&(async()=>{if(t(3,D=!0),console.log(z),t(16,ae=""),t(18,$=[]),t(11,Z=[]),t(13,X=!1),t(12,F=!1),z&&await _t()){if(await tt(),t(3,D=!1),localStorage.getItem(`chat-input-${z}`))try{const ue=JSON.parse(localStorage.getItem(`chat-input-${z}`));t(16,ae=ue.prompt),t(18,$=ue.files),t(11,Z=ue.selectedToolIds),t(13,X=ue.webSearchEnabled),t(12,F=ue.imageGenerationEnabled)}catch{}window.setTimeout(()=>nt(),0);const U=document.getElementById("chat-input");U==null||U.focus()}else await Uo("/")})(),l.$$.dirty[0]&3&&P&&z!==""&&Ne(),l.$$.dirty[0]&2&&P&&ce(),l.$$.dirty[0]&6&&(N||P)&&ce()},[z,P,N,D,A,O,L,W,K,R,Y,Z,F,X,se,G,ae,ve,$,Ie,s,i,a,w,g,v,y,E,M,Ze,ie,Ue,et,at,mt,jt,Ht,gt,me,Et,Ct,Pe,qt,It,Je,wt,bt,Mt,Tt,rn,Bt,Rt,Yt,Kt,tn,an,Pt,yt,wn,mn,yn,Sn,Nn,j,we,Fe,qe,Me,Ye,Dt,rt,cn,Gt,un,nn,Jt,pn,Rn,Gn,el,Dn,ml,tl,J]}class Gb extends Oe{constructor(e){super(),He(this,e,v_,h_,Le,{chatIdProp:0},null,[-1,-1,-1,-1])}}function w_(l){let e,t,n,o=l[1].t("Keyboard shortcuts")+"",s,i,r,a='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"></path></svg>',c,u,f,d,h,_,b=l[1].t("Open new chat")+"",w,g,v,y='<div class="h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Ctrl/âŒ˜</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Shift</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">O</div>',E,z,D,M=l[1].t("Focus chat input")+"",A,O,L,W='<div class="h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Shift</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Esc</div>',K,R,I,P=l[1].t("Copy last code block")+"",N,Y,Z,F='<div class="h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Ctrl/âŒ˜</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Shift</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">;</div>',X,se,q,G=l[1].t("Copy last response")+"",oe,ae,ve,$='<div class="h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Ctrl/âŒ˜</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Shift</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">C</div>',Ie,Ne,ce,Ze=l[1].t("Generate prompt pair")+"",Qe,ge,ie,Ue='<div class="h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Ctrl/âŒ˜</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Shift</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Enter</div>',et,at,_t,nt,mt=l[1].t("Toggle settings")+"",jt,Ht,gt,At='<div class="h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Ctrl/âŒ˜</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">.</div>',me,Lt,Et,Ct=l[1].t("Toggle sidebar")+"",Pe,qt,It,fe='<div class="h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Ctrl/âŒ˜</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Shift</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">S</div>',We,Be,Je,wt=l[1].t("Delete chat")+"",bt,Mt,Tt,rn='<div class="h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Ctrl/âŒ˜</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Shift</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">âŒ«/Delete</div>',Bt,Rt,Yt,Kt=l[1].t("Show shortcuts")+"",tn,an,Pt,yt='<div class="h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">Ctrl/âŒ˜</div> <div class="h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">/</div>',wn,mn,yn,Sn=l[1].t("Input commands")+"",Nn,j,we,Fe,qe,Me,Ye,Dt=l[1].t("Attach file from knowledge")+"",rt,cn,Gt,un='<div class="h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">#</div>',nn,Jt,pn,Rn=l[1].t("Add custom prompt")+"",Gn,el,Dn,ml='<div class="h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">/</div>',tl,J,U,ue=l[1].t("Talk to model")+"",pe,Ke,he,je='<div class="h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">@</div>',ye,Re,ut,pt=l[1].t("Accept autocomplete generation / Jump to prompt variable")+"",ft,Vt,St,kn='<div class="h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300">TAB</div>',Pn,fn;return{c(){e=T("div"),t=T("div"),n=T("div"),s=ke(o),i=Q(),r=T("button"),r.innerHTML=a,c=Q(),u=T("div"),f=T("div"),d=T("div"),h=T("div"),_=T("div"),w=ke(b),g=Q(),v=T("div"),v.innerHTML=y,E=Q(),z=T("div"),D=T("div"),A=ke(M),O=Q(),L=T("div"),L.innerHTML=W,K=Q(),R=T("div"),I=T("div"),N=ke(P),Y=Q(),Z=T("div"),Z.innerHTML=F,X=Q(),se=T("div"),q=T("div"),oe=ke(G),ae=Q(),ve=T("div"),ve.innerHTML=$,Ie=Q(),Ne=T("div"),ce=T("div"),Qe=ke(Ze),ge=Q(),ie=T("div"),ie.innerHTML=Ue,et=Q(),at=T("div"),_t=T("div"),nt=T("div"),jt=ke(mt),Ht=Q(),gt=T("div"),gt.innerHTML=At,me=Q(),Lt=T("div"),Et=T("div"),Pe=ke(Ct),qt=Q(),It=T("div"),It.innerHTML=fe,We=Q(),Be=T("div"),Je=T("div"),bt=ke(wt),Mt=Q(),Tt=T("div"),Tt.innerHTML=rn,Bt=Q(),Rt=T("div"),Yt=T("div"),tn=ke(Kt),an=Q(),Pt=T("div"),Pt.innerHTML=yt,wn=Q(),mn=T("div"),yn=T("div"),Nn=ke(Sn),j=Q(),we=T("div"),Fe=T("div"),qe=T("div"),Me=T("div"),Ye=T("div"),rt=ke(Dt),cn=Q(),Gt=T("div"),Gt.innerHTML=un,nn=Q(),Jt=T("div"),pn=T("div"),Gn=ke(Rn),el=Q(),Dn=T("div"),Dn.innerHTML=ml,tl=Q(),J=T("div"),U=T("div"),pe=ke(ue),Ke=Q(),he=T("div"),he.innerHTML=je,ye=Q(),Re=T("div"),ut=T("div"),ft=ke(pt),Vt=Q(),St=T("div"),St.innerHTML=kn,this.h()},l(zt){e=V(zt,"DIV",{class:!0});var kt=S(e);t=V(kt,"DIV",{class:!0});var nl=S(t);n=V(nl,"DIV",{class:!0});var Ml=S(n);s=Ee(Ml,o),Ml.forEach(p),i=x(nl),r=V(nl,"BUTTON",{class:!0,"data-svelte-h":!0}),it(r)!=="svelte-745w2y"&&(r.innerHTML=a),nl.forEach(p),c=x(kt),u=V(kt,"DIV",{class:!0});var Tl=S(u);f=V(Tl,"DIV",{class:!0});var ll=S(f);d=V(ll,"DIV",{class:!0});var _n=S(d);h=V(_n,"DIV",{class:!0});var ol=S(h);_=V(ol,"DIV",{class:!0});var Vl=S(_);w=Ee(Vl,b),Vl.forEach(p),g=x(ol),v=V(ol,"DIV",{class:!0,"data-svelte-h":!0}),it(v)!=="svelte-1ykt4pq"&&(v.innerHTML=y),ol.forEach(p),E=x(_n),z=V(_n,"DIV",{class:!0});var sl=S(z);D=V(sl,"DIV",{class:!0});var zl=S(D);A=Ee(zl,M),zl.forEach(p),O=x(sl),L=V(sl,"DIV",{class:!0,"data-svelte-h":!0}),it(L)!=="svelte-9s7il5"&&(L.innerHTML=W),sl.forEach(p),K=x(_n),R=V(_n,"DIV",{class:!0});var rl=S(R);I=V(rl,"DIV",{class:!0});var Nl=S(I);N=Ee(Nl,P),Nl.forEach(p),Y=x(rl),Z=V(rl,"DIV",{class:!0,"data-svelte-h":!0}),it(Z)!=="svelte-1rhjj6y"&&(Z.innerHTML=F),rl.forEach(p),X=x(_n),se=V(_n,"DIV",{class:!0});var il=S(se);q=V(il,"DIV",{class:!0});var Pl=S(q);oe=Ee(Pl,G),Pl.forEach(p),ae=x(il),ve=V(il,"DIV",{class:!0,"data-svelte-h":!0}),it(ve)!=="svelte-88t2mq"&&(ve.innerHTML=$),il.forEach(p),Ie=x(_n),Ne=V(_n,"DIV",{class:!0});var st=S(Ne);ce=V(st,"DIV",{class:!0});var Xn=S(ce);Qe=Ee(Xn,Ze),Xn.forEach(p),ge=x(st),ie=V(st,"DIV",{class:!0,"data-svelte-h":!0}),it(ie)!=="svelte-71xcgz"&&(ie.innerHTML=Ue),st.forEach(p),_n.forEach(p),et=x(ll),at=V(ll,"DIV",{class:!0});var Cn=S(at);_t=V(Cn,"DIV",{class:!0});var Un=S(_t);nt=V(Un,"DIV",{class:!0});var Ol=S(nt);jt=Ee(Ol,mt),Ol.forEach(p),Ht=x(Un),gt=V(Un,"DIV",{class:!0,"data-svelte-h":!0}),it(gt)!=="svelte-sstb0e"&&(gt.innerHTML=At),Un.forEach(p),me=x(Cn),Lt=V(Cn,"DIV",{class:!0});var al=S(Lt);Et=V(al,"DIV",{class:!0});var Zn=S(Et);Pe=Ee(Zn,Ct),Zn.forEach(p),qt=x(al),It=V(al,"DIV",{class:!0,"data-svelte-h":!0}),it(It)!=="svelte-shqiv6"&&(It.innerHTML=fe),al.forEach(p),We=x(Cn),Be=V(Cn,"DIV",{class:!0});var xl=S(Be);Je=V(xl,"DIV",{class:!0});var hs=S(Je);bt=Ee(hs,wt),hs.forEach(p),Mt=x(xl),Tt=V(xl,"DIV",{class:!0,"data-svelte-h":!0}),it(Tt)!=="svelte-1czc2xm"&&(Tt.innerHTML=rn),xl.forEach(p),Bt=x(Cn),Rt=V(Cn,"DIV",{class:!0});var $l=S(Rt);Yt=V($l,"DIV",{class:!0});var ms=S(Yt);tn=Ee(ms,Kt),ms.forEach(p),an=x($l),Pt=V($l,"DIV",{class:!0,"data-svelte-h":!0}),it(Pt)!=="svelte-10s6aob"&&(Pt.innerHTML=yt),$l.forEach(p),Cn.forEach(p),ll.forEach(p),Tl.forEach(p),wn=x(kt),mn=V(kt,"DIV",{class:!0});var gs=S(mn);yn=V(gs,"DIV",{class:!0});var ps=S(yn);Nn=Ee(ps,Sn),ps.forEach(p),gs.forEach(p),j=x(kt),we=V(kt,"DIV",{class:!0});var _s=S(we);Fe=V(_s,"DIV",{class:!0});var bs=S(Fe);qe=V(bs,"DIV",{class:!0});var qn=S(qe);Me=V(qn,"DIV",{class:!0});var eo=S(Me);Ye=V(eo,"DIV",{class:!0});var vs=S(Ye);rt=Ee(vs,Dt),vs.forEach(p),cn=x(eo),Gt=V(eo,"DIV",{class:!0,"data-svelte-h":!0}),it(Gt)!=="svelte-npid8c"&&(Gt.innerHTML=un),eo.forEach(p),nn=x(qn),Jt=V(qn,"DIV",{class:!0});var to=S(Jt);pn=V(to,"DIV",{class:!0});var ws=S(pn);Gn=Ee(ws,Rn),ws.forEach(p),el=x(to),Dn=V(to,"DIV",{class:!0,"data-svelte-h":!0}),it(Dn)!=="svelte-1x4z9aw"&&(Dn.innerHTML=ml),to.forEach(p),tl=x(qn),J=V(qn,"DIV",{class:!0});var no=S(J);U=V(no,"DIV",{class:!0});var ys=S(U);pe=Ee(ys,ue),ys.forEach(p),Ke=x(no),he=V(no,"DIV",{class:!0,"data-svelte-h":!0}),it(he)!=="svelte-1ia95ih"&&(he.innerHTML=je),no.forEach(p),ye=x(qn),Re=V(qn,"DIV",{class:!0});var lo=S(Re);ut=V(lo,"DIV",{class:!0});var ks=S(ut);ft=Ee(ks,pt),ks.forEach(p),Vt=x(lo),St=V(lo,"DIV",{class:!0,"data-svelte-h":!0}),it(St)!=="svelte-1hbxzzi"&&(St.innerHTML=kn),lo.forEach(p),qn.forEach(p),bs.forEach(p),_s.forEach(p),kt.forEach(p),this.h()},h(){m(n,"class","text-lg font-medium self-center"),m(r,"class","self-center"),m(t,"class","flex justify-between dark:text-gray-300 px-5 pt-4"),m(_,"class","text-sm"),m(v,"class","flex space-x-1 text-xs"),m(h,"class","w-full flex justify-between items-center"),m(D,"class","text-sm"),m(L,"class","flex space-x-1 text-xs"),m(z,"class","w-full flex justify-between items-center"),m(I,"class","text-sm"),m(Z,"class","flex space-x-1 text-xs"),m(R,"class","w-full flex justify-between items-center"),m(q,"class","text-sm"),m(ve,"class","flex space-x-1 text-xs"),m(se,"class","w-full flex justify-between items-center"),m(ce,"class","text-sm"),m(ie,"class","flex space-x-1 text-xs"),m(Ne,"class","w-full flex justify-between items-center"),m(d,"class","flex flex-col space-y-3 w-full self-start"),m(nt,"class","text-sm"),m(gt,"class","flex space-x-1 text-xs"),m(_t,"class","w-full flex justify-between items-center"),m(Et,"class","text-sm"),m(It,"class","flex space-x-1 text-xs"),m(Lt,"class","w-full flex justify-between items-center"),m(Je,"class","text-sm"),m(Tt,"class","flex space-x-1 text-xs"),m(Be,"class","w-full flex justify-between items-center"),m(Yt,"class","text-sm"),m(Pt,"class","flex space-x-1 text-xs"),m(Rt,"class","w-full flex justify-between items-center"),m(at,"class","flex flex-col space-y-3 w-full self-start"),m(f,"class","flex flex-col w-full sm:flex-row sm:justify-center sm:space-x-6"),m(u,"class","flex flex-col md:flex-row w-full p-5 md:space-x-4 dark:text-gray-200"),m(yn,"class","text-lg font-medium self-center"),m(mn,"class","flex justify-between dark:text-gray-300 px-5"),m(Ye,"class","text-sm"),m(Gt,"class","flex space-x-1 text-xs"),m(Me,"class","w-full flex justify-between items-center"),m(pn,"class","text-sm"),m(Dn,"class","flex space-x-1 text-xs"),m(Jt,"class","w-full flex justify-between items-center"),m(U,"class","text-sm"),m(he,"class","flex space-x-1 text-xs"),m(J,"class","w-full flex justify-between items-center"),m(ut,"class","text-sm"),m(St,"class","flex space-x-1 text-xs"),m(Re,"class","w-full flex justify-between items-center"),m(qe,"class","flex flex-col space-y-3 w-full self-start"),m(Fe,"class","flex flex-col w-full sm:flex-row sm:justify-center sm:space-x-6"),m(we,"class","flex flex-col md:flex-row w-full p-5 md:space-x-4 dark:text-gray-200"),m(e,"class","text-gray-700 dark:text-gray-100")},m(zt,kt){B(zt,e,kt),k(e,t),k(t,n),k(n,s),k(t,i),k(t,r),k(e,c),k(e,u),k(u,f),k(f,d),k(d,h),k(h,_),k(_,w),k(h,g),k(h,v),k(d,E),k(d,z),k(z,D),k(D,A),k(z,O),k(z,L),k(d,K),k(d,R),k(R,I),k(I,N),k(R,Y),k(R,Z),k(d,X),k(d,se),k(se,q),k(q,oe),k(se,ae),k(se,ve),k(d,Ie),k(d,Ne),k(Ne,ce),k(ce,Qe),k(Ne,ge),k(Ne,ie),k(f,et),k(f,at),k(at,_t),k(_t,nt),k(nt,jt),k(_t,Ht),k(_t,gt),k(at,me),k(at,Lt),k(Lt,Et),k(Et,Pe),k(Lt,qt),k(Lt,It),k(at,We),k(at,Be),k(Be,Je),k(Je,bt),k(Be,Mt),k(Be,Tt),k(at,Bt),k(at,Rt),k(Rt,Yt),k(Yt,tn),k(Rt,an),k(Rt,Pt),k(e,wn),k(e,mn),k(mn,yn),k(yn,Nn),k(e,j),k(e,we),k(we,Fe),k(Fe,qe),k(qe,Me),k(Me,Ye),k(Ye,rt),k(Me,cn),k(Me,Gt),k(qe,nn),k(qe,Jt),k(Jt,pn),k(pn,Gn),k(Jt,el),k(Jt,Dn),k(qe,tl),k(qe,J),k(J,U),k(U,pe),k(J,Ke),k(J,he),k(qe,ye),k(qe,Re),k(Re,ut),k(ut,ft),k(Re,Vt),k(Re,St),Pn||(fn=Se(r,"click",l[3]),Pn=!0)},p(zt,kt){kt&2&&o!==(o=zt[1].t("Keyboard shortcuts")+"")&&Ce(s,o),kt&2&&b!==(b=zt[1].t("Open new chat")+"")&&Ce(w,b),kt&2&&M!==(M=zt[1].t("Focus chat input")+"")&&Ce(A,M),kt&2&&P!==(P=zt[1].t("Copy last code block")+"")&&Ce(N,P),kt&2&&G!==(G=zt[1].t("Copy last response")+"")&&Ce(oe,G),kt&2&&Ze!==(Ze=zt[1].t("Generate prompt pair")+"")&&Ce(Qe,Ze),kt&2&&mt!==(mt=zt[1].t("Toggle settings")+"")&&Ce(jt,mt),kt&2&&Ct!==(Ct=zt[1].t("Toggle sidebar")+"")&&Ce(Pe,Ct),kt&2&&wt!==(wt=zt[1].t("Delete chat")+"")&&Ce(bt,wt),kt&2&&Kt!==(Kt=zt[1].t("Show shortcuts")+"")&&Ce(tn,Kt),kt&2&&Sn!==(Sn=zt[1].t("Input commands")+"")&&Ce(Nn,Sn),kt&2&&Dt!==(Dt=zt[1].t("Attach file from knowledge")+"")&&Ce(rt,Dt),kt&2&&Rn!==(Rn=zt[1].t("Add custom prompt")+"")&&Ce(Gn,Rn),kt&2&&ue!==(ue=zt[1].t("Talk to model")+"")&&Ce(pe,ue),kt&2&&pt!==(pt=zt[1].t("Accept autocomplete generation / Jump to prompt variable")+"")&&Ce(ft,pt)},d(zt){zt&&p(e),Pn=!1,fn()}}}function y_(l){let e,t,n;function o(i){l[4](i)}let s={$$slots:{default:[w_]},$$scope:{ctx:l}};return l[0]!==void 0&&(s.show=l[0]),e=new Iu({props:s}),Ae.push(()=>Xe(e,"show",o)),{c(){ee(e.$$.fragment)},l(i){le(e.$$.fragment,i)},m(i,r){te(e,i,r),n=!0},p(i,[r]){const a={};r&35&&(a.$$scope={dirty:r,ctx:i}),!t&&r&1&&(t=!0,a.show=i[0],Ge(()=>t=!1)),e.$set(a)},i(i){n||(C(e.$$.fragment,i),n=!0)},o(i){H(e.$$.fragment,i),n=!1},d(i){ne(e,i)}}}function k_(l,e,t){let n;const o=Ot("i18n");re(l,o,a=>t(1,n=a));let{show:s=!1}=e;const i=()=>{t(0,s=!1)};function r(a){s=a,t(0,s)}return l.$$set=a=>{"show"in a&&t(0,s=a.show)},[s,n,o,i,r]}class E_ extends Oe{constructor(e){super(),He(this,e,k_,y_,Le,{show:0})}}function I_(l){let e,t;return{c(){e=_e("svg"),t=_e("path"),this.h()},l(n){e=be(n,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var o=S(e);t=be(o,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),S(t).forEach(p),o.forEach(p),this.h()},h(){m(t,"stroke-linecap","round"),m(t,"stroke-linejoin","round"),m(t,"d","M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 5.25h.008v.008H12v-.008Z"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"fill","none"),m(e,"viewBox","0 0 24 24"),m(e,"stroke-width",l[1]),m(e,"stroke","currentColor"),m(e,"class",l[0])},m(n,o){B(n,e,o),k(e,t)},p(n,[o]){o&2&&m(e,"stroke-width",n[1]),o&1&&m(e,"class",n[0])},i:De,o:De,d(n){n&&p(e)}}}function S_(l,e,t){let{className:n="w-4 h-4"}=e,{strokeWidth:o="2"}=e;return l.$$set=s=>{"className"in s&&t(0,n=s.className),"strokeWidth"in s&&t(1,o=s.strokeWidth)},[n,o]}class D_ extends Oe{constructor(e){super(),He(this,e,S_,I_,Le,{className:0,strokeWidth:1})}}function C_(l){let e,t;return{c(){e=_e("svg"),t=_e("path"),this.h()},l(n){e=be(n,"svg",{"aria-hidden":!0,xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,class:!0});var o=S(e);t=be(o,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),S(t).forEach(p),o.forEach(p),this.h()},h(){m(t,"fill-rule","evenodd"),m(t,"d","M2 7a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V7Zm5.01 1H5v2.01h2.01V8Zm3 0H8v2.01h2.01V8Zm3 0H11v2.01h2.01V8Zm3 0H14v2.01h2.01V8Zm3 0H17v2.01h2.01V8Zm-12 3H5v2.01h2.01V11Zm3 0H8v2.01h2.01V11Zm3 0H11v2.01h2.01V11Zm3 0H14v2.01h2.01V11Zm3 0H17v2.01h2.01V11Zm-12 3H5v2.01h2.01V14ZM8 14l-.001 2 8.011.01V14H8Zm11.01 0H17v2.01h2.01V14Z"),m(t,"clip-rule","evenodd"),m(e,"aria-hidden","true"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"fill","currentColor"),m(e,"viewBox","0 0 24 24"),m(e,"stroke-width",l[1]),m(e,"class",l[0])},m(n,o){B(n,e,o),k(e,t)},p(n,[o]){o&2&&m(e,"stroke-width",n[1]),o&1&&m(e,"class",n[0])},i:De,o:De,d(n){n&&p(e)}}}function M_(l,e,t){let{className:n="size-4"}=e,{strokeWidth:o="2"}=e;return l.$$set=s=>{"className"in s&&t(0,n=s.className),"strokeWidth"in s&&t(1,o=s.strokeWidth)},[n,o]}class T_ extends Oe{constructor(e){super(),He(this,e,M_,C_,Le,{className:0,strokeWidth:1})}}function V_(l){let e;const t=l[5].default,n=Qt(t,l,l[9],null);return{c(){n&&n.c()},l(o){n&&n.l(o)},m(o,s){n&&n.m(o,s),e=!0},p(o,s){n&&n.p&&(!e||s&512)&&xt(n,t,o,o[9],e?en(t,o[9],s,null):$t(o[9]),null)},i(o){e||(C(n,o),e=!0)},o(o){H(n,o),e=!1},d(o){n&&n.d(o)}}}function z_(l){let e,t,n,o=l[2].t("Documentation")+"",s,i;return e=new D_({props:{className:"size-5"}}),{c(){ee(e.$$.fragment),t=Q(),n=T("div"),s=ke(o),this.h()},l(r){le(e.$$.fragment,r),t=x(r),n=V(r,"DIV",{class:!0});var a=S(n);s=Ee(a,o),a.forEach(p),this.h()},h(){m(n,"class","flex items-center")},m(r,a){te(e,r,a),B(r,t,a),B(r,n,a),k(n,s),i=!0},p(r,a){(!i||a&4)&&o!==(o=r[2].t("Documentation")+"")&&Ce(s,o)},i(r){i||(C(e.$$.fragment,r),i=!0)},o(r){H(e.$$.fragment,r),i=!1},d(r){r&&(p(t),p(n)),ne(e,r)}}}function N_(l){let e,t,n,o=l[2].t("Keyboard shortcuts")+"",s,i;return e=new T_({props:{className:"size-5"}}),{c(){ee(e.$$.fragment),t=Q(),n=T("div"),s=ke(o),this.h()},l(r){le(e.$$.fragment,r),t=x(r),n=V(r,"DIV",{class:!0});var a=S(n);s=Ee(a,o),a.forEach(p),this.h()},h(){m(n,"class","flex items-center")},m(r,a){te(e,r,a),B(r,t,a),B(r,n,a),k(n,s),i=!0},p(r,a){(!i||a&4)&&o!==(o=r[2].t("Keyboard shortcuts")+"")&&Ce(s,o)},i(r){i||(C(e.$$.fragment,r),i=!0)},o(r){H(e.$$.fragment,r),i=!1},d(r){r&&(p(t),p(n)),ne(e,r)}}}function P_(l){let e,t,n,o;return e=new dn({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",id:"chat-share-button",$$slots:{default:[z_]},$$scope:{ctx:l}}}),e.$on("click",l[6]),n=new dn({props:{class:"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md",id:"chat-share-button",$$slots:{default:[N_]},$$scope:{ctx:l}}}),n.$on("click",l[7]),{c(){ee(e.$$.fragment),t=Q(),ee(n.$$.fragment)},l(s){le(e.$$.fragment,s),t=x(s),le(n.$$.fragment,s)},m(s,i){te(e,s,i),B(s,t,i),te(n,s,i),o=!0},p(s,i){const r={};i&516&&(r.$$scope={dirty:i,ctx:s}),e.$set(r);const a={};i&516&&(a.$$scope={dirty:i,ctx:s}),n.$set(a)},i(s){o||(C(e.$$.fragment,s),C(n.$$.fragment,s),o=!0)},o(s){H(e.$$.fragment,s),H(n.$$.fragment,s),o=!1},d(s){s&&p(t),ne(e,s),ne(n,s)}}}function O_(l){let e,t,n;return t=new To({props:{class:"w-full max-w-[200px] rounded-xl px-1 py-1.5 border border-gray-300/30 dark:border-gray-700/50 z-50 bg-white dark:bg-gray-850 dark:text-white shadow-lg",sideOffset:4,side:"top",align:"end",transition:ql,$$slots:{default:[P_]},$$scope:{ctx:l}}}),{c(){e=T("div"),ee(t.$$.fragment),this.h()},l(o){e=V(o,"DIV",{slot:!0});var s=S(e);le(t.$$.fragment,s),s.forEach(p),this.h()},h(){m(e,"slot","content")},m(o,s){B(o,e,s),te(t,e,null),n=!0},p(o,s){const i={};s&517&&(i.$$scope={dirty:s,ctx:o}),t.$set(i)},i(o){n||(C(t.$$.fragment,o),n=!0)},o(o){H(t.$$.fragment,o),n=!1},d(o){o&&p(e),ne(t)}}}function H_(l){let e,t;return e=new Mo({props:{$$slots:{content:[O_],default:[V_]},$$scope:{ctx:l}}}),e.$on("change",l[8]),{c(){ee(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,o){te(e,n,o),t=!0},p(n,[o]){const s={};o&517&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}function A_(l,e,t){let n,{$$slots:o={},$$scope:s}=e;const i=Ot("i18n");re(l,i,h=>t(2,n=h));let{showDocsHandler:r}=e,{showShortcutsHandler:a}=e,{onClose:c=()=>{}}=e;const u=()=>{window.open("https://docs.openwebui.com","_blank")},f=()=>{a()},d=h=>{h.detail===!1&&c()};return l.$$set=h=>{"showDocsHandler"in h&&t(4,r=h.showDocsHandler),"showShortcutsHandler"in h&&t(0,a=h.showShortcutsHandler),"onClose"in h&&t(1,c=h.onClose),"$$scope"in h&&t(9,s=h.$$scope)},[a,c,n,i,r,o,u,f,d,s]}class L_ extends Oe{constructor(e){super(),He(this,e,A_,H_,Le,{showDocsHandler:4,showShortcutsHandler:0,onClose:1})}}function B_(l){let e,t="?";return{c(){e=T("button"),e.textContent=t,this.h()},l(n){e=V(n,"BUTTON",{class:!0,"data-svelte-h":!0}),it(e)!=="svelte-141cz2e"&&(e.textContent=t),this.h()},h(){m(e,"class","text-gray-600 dark:text-gray-300 bg-gray-300/20 size-4 flex items-center justify-center text-[0.7rem] rounded-full")},m(n,o){B(n,e,o)},p:De,d(n){n&&p(e)}}}function R_(l){let e,t;return e=new Ft({props:{content:l[1].t("Help"),placement:"left",$$slots:{default:[B_]},$$scope:{ctx:l}}}),{c(){ee(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,o){te(e,n,o),t=!0},p(n,o){const s={};o&2&&(s.content=n[1].t("Help")),o&128&&(s.$$scope={dirty:o,ctx:n}),e.$set(s)},i(n){t||(C(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){ne(e,n)}}}function U_(l){let e,t,n,o,s,i,r,a,c,u;o=new L_({props:{showDocsHandler:l[4],showShortcutsHandler:l[5],$$slots:{default:[R_]},$$scope:{ctx:l}}});function f(h){l[6](h)}let d={};return l[0]!==void 0&&(d.show=l[0]),i=new E_({props:d}),Ae.push(()=>Xe(i,"show",f)),{c(){e=T("div"),t=T("button"),n=Q(),ee(o.$$.fragment),s=Q(),ee(i.$$.fragment),this.h()},l(h){e=V(h,"DIV",{class:!0});var _=S(e);t=V(_,"BUTTON",{id:!0,class:!0}),S(t).forEach(p),n=x(_),le(o.$$.fragment,_),_.forEach(p),s=x(h),le(i.$$.fragment,h),this.h()},h(){m(t,"id","show-shortcuts-button"),m(t,"class","hidden"),m(e,"class","hidden lg:flex fixed bottom-0 right-0 px-1 py-1 z-20")},m(h,_){B(h,e,_),k(e,t),k(e,n),te(o,e,null),B(h,s,_),te(i,h,_),a=!0,c||(u=Se(t,"click",l[3]),c=!0)},p(h,[_]){const b={};_&1&&(b.showDocsHandler=h[4]),_&1&&(b.showShortcutsHandler=h[5]),_&130&&(b.$$scope={dirty:_,ctx:h}),o.$set(b);const w={};!r&&_&1&&(r=!0,w.show=h[0],Ge(()=>r=!1)),i.$set(w)},i(h){a||(C(o.$$.fragment,h),C(i.$$.fragment,h),a=!0)},o(h){H(o.$$.fragment,h),H(i.$$.fragment,h),a=!1},d(h){h&&(p(e),p(s)),ne(o),ne(i,h),c=!1,u()}}}function F_(l,e,t){let n;const o=Ot("i18n");re(l,o,u=>t(1,n=u));let s=!1;const i=()=>{t(0,s=!s)},r=()=>{t(0,s=!s)},a=()=>{t(0,s=!s)};function c(u){s=u,t(0,s)}return[s,n,o,i,r,a,c]}class Xb extends Oe{constructor(e){super(),He(this,e,F_,U_,Le,{})}}export{Gb as C,Xb as H};
//# sourceMappingURL=CjuzbA3f.js.map
