import{s as Ce,e as I,k as P,c as M,a as y,d as m,o as j,f as c,i as C,g as _,n as ge,t as F,b as J,M as Te,B as nt,u as me,h as K,P as We,G as et,j as Ee,p as Qe,I as pt,q as bt,y as Pe,A as Ge,r as tn,v as ln,w as sn,x as rn,D as _e,E as ve,l as ae,T as br,C as Ne,J as nn,$ as ol,V as it,O as Ht,a4 as an,a5 as on}from"./Dc4_ziGv.js";import{S as Re,i as Le,b as Y,d as X,m as $,t as w,a as V,e as x,f as Ke,g as te,c as le,h as Pt}from"./CAZSMy3J.js";import{e as De,u as kr,o as wr}from"./C6kX8Nm-.js";import{m as Rt,d as yr,b as fn,C as un,D as cn,a as Lt,c as dn,T as fl,u as Ot,h as Ft,w as ul,x as hn}from"./DhUbH0v9.js";import{t as He}from"./gLvYLTeg.js";import{f as mn,u as gn,i as _n}from"./BHQ31hte.js";import{b as Wt,m as Ir,w as vn,h as vt,r as Tt,l as Mr,v as cl}from"./DWuYzDxc.js";import{d as at}from"./Bi9B0bt2.js";import{b as dl,c as pn}from"./CugrJ7AZ.js";import{o as bn}from"./CJ33GILj.js";import{s as kn}from"./BtKK8PL-.js";import{i as wn}from"./C8iPY5Mb.js";import{a as hl,b as Bt}from"./CisIfe-u.js";import{ai as yn,ag as yt,af as Er,ae as Jt,ah as Dr}from"./DU_ylw5L.js";import{T as Be}from"./Cj5D4_dy.js";import{T as In}from"./CUikFy1Q.js";import{S as At}from"./7Z-YgjJE.js";import{C as Nr}from"./6b-WEKee.js";import{C as Vr}from"./CcqxmtFL.js";import{M as Mn}from"./CxmHj7i4.js";import{C as Cr}from"./CDFoU-NH.js";import{C as Tr}from"./DJpY-x4S.js";import{I as En}from"./DfA6ghDG.js";import{M as Br}from"./MKheDeAE.js";import{B as Gt}from"./BRau52VX.js";import{C as Dn}from"./jrkDJ85X.js";import{X as Nn}from"./B9KCSGTn.js";import{E as Vn}from"./2RgIIKqB.js";import{m as St}from"./_0_gBwjO.js";import{c as ml}from"./CgEzuEYe.js";import{T as Kt}from"./DU9G2YJ_.js";import{F as Cn}from"./BFv3ac4I.js";import{L as Tn}from"./BoVIc4l_.js";import{f as jt}from"./CduAUGNl.js";function Bn(r){return new Worker(""+new URL("../workers/kokoro.worker-Cev3ZHQt.js",import.meta.url).href,{type:"module",name:r==null?void 0:r.name})}class Sn{constructor(e="fp32"){this.worker=null,this.initialized=!1,this.requestQueue=[],this.processing=!1,this.dtype=e}async init(){if(this.worker){console.warn("KokoroWorker is already initialized.");return}return this.worker=new Bn,this.worker.onmessage=e=>{const{status:t,error:l,audioUrl:s}=e.data;if(t==="init:complete")this.initialized=!0;else if(t==="init:error")console.error(l),this.initialized=!1;else if(t==="generate:complete"){const n=this.requestQueue.shift();n&&(n.resolve(s),this.processNextRequest())}else if(t==="generate:error"){const n=this.requestQueue.shift();n&&(n.reject(new Error(l)),this.processNextRequest())}},new Promise((e,t)=>{this.worker.postMessage({type:"init",payload:{dtype:this.dtype}});const l=s=>{s.data.status==="init:complete"?(this.worker.removeEventListener("message",l),this.initialized=!0,e()):s.data.status==="init:error"&&(this.worker.removeEventListener("message",l),t(new Error(s.data.error)))};this.worker.addEventListener("message",l)})}async generate({text:e,voice:t}){if(!this.initialized||!this.worker)throw new Error("KokoroTTS Worker is not initialized yet.");return new Promise((l,s)=>{this.requestQueue.push({text:e,voice:t,resolve:l,reject:s}),this.processing||this.processNextRequest()})}processNextRequest(){if(this.requestQueue.length===0){this.processing=!1;return}this.processing=!0;const{text:e,voice:t}=this.requestQueue[0];this.worker.postMessage({type:"generate",payload:{text:e,voice:t}})}terminate(){this.worker&&(this.worker.terminate(),this.worker=null,this.initialized=!1,this.requestQueue=[],this.processing=!1)}}function Rn(r){let e,t,l,s,n,i,o,a,f,u,d,g,h,p,D,v,E,b,R,A,N,k,B,S,T,H;return{c(){e=I("div"),t=I("div"),l=I("div"),s=I("div"),i=P(),o=I("div"),a=I("div"),u=P(),d=I("div"),h=P(),p=I("div"),D=I("div"),E=P(),b=I("div"),A=P(),N=I("div"),B=P(),S=I("div"),this.h()},l(L){e=M(L,"DIV",{class:!0});var q=y(e);t=M(q,"DIV",{class:!0});var z=y(t);l=M(z,"DIV",{class:!0});var ee=y(l);s=M(ee,"DIV",{class:!0}),y(s).forEach(m),i=j(ee),o=M(ee,"DIV",{class:!0});var G=y(o);a=M(G,"DIV",{class:!0}),y(a).forEach(m),u=j(G),d=M(G,"DIV",{class:!0}),y(d).forEach(m),G.forEach(m),h=j(ee),p=M(ee,"DIV",{class:!0});var Q=y(p);D=M(Q,"DIV",{class:!0}),y(D).forEach(m),E=j(Q),b=M(Q,"DIV",{class:!0}),y(b).forEach(m),A=j(Q),N=M(Q,"DIV",{class:!0}),y(N).forEach(m),Q.forEach(m),B=j(ee),S=M(ee,"DIV",{class:!0}),y(S).forEach(m),ee.forEach(m),z.forEach(m),q.forEach(m),this.h()},h(){c(s,"class",n=(r[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm mr-14"),c(a,"class",f=(r[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-2"),c(d,"class",g=(r[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1"),c(o,"class","grid grid-cols-3 gap-4"),c(D,"class",v=(r[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1"),c(b,"class",R=(r[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-2"),c(N,"class",k=(r[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1 mr-4"),c(p,"class","grid grid-cols-4 gap-4"),c(S,"class",T=(r[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm"),c(l,"class",H=(r[0]==="md"?"space-y-2":"space-y-1.5")+" w-full"),c(t,"class","animate-pulse flex w-full"),c(e,"class","w-full mt-2 mb-2")},m(L,q){C(L,e,q),_(e,t),_(t,l),_(l,s),_(l,i),_(l,o),_(o,a),_(o,u),_(o,d),_(l,h),_(l,p),_(p,D),_(p,E),_(p,b),_(p,A),_(p,N),_(l,B),_(l,S)},p(L,[q]){q&1&&n!==(n=(L[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm mr-14")&&c(s,"class",n),q&1&&f!==(f=(L[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-2")&&c(a,"class",f),q&1&&g!==(g=(L[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1")&&c(d,"class",g),q&1&&v!==(v=(L[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1")&&c(D,"class",v),q&1&&R!==(R=(L[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-2")&&c(b,"class",R),q&1&&k!==(k=(L[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1 mr-4")&&c(N,"class",k),q&1&&T!==(T=(L[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm")&&c(S,"class",T),q&1&&H!==(H=(L[0]==="md"?"space-y-2":"space-y-1.5")+" w-full")&&c(l,"class",H)},i:ge,o:ge,d(L){L&&m(e)}}}function Ln(r,e,t){let{size:l="md"}=e;return r.$$set=s=>{"size"in s&&t(0,l=s.size)},[l]}class Qt extends Re{constructor(e){super(),Le(this,e,Ln,Rn,Ce,{size:0})}}function gl(r,e,t){const l=r.slice();return l[23]=e[t],l}function _l(r,e,t){const l=r.slice();return l[26]=e[t],l}function vl(r){var s;let e,t=r[8].t('This response was generated by "{{model}}"',{model:r[7]?((s=r[7])==null?void 0:s.name)??r[7].id:r[1].selectedModelId})+"",l;return{c(){e=I("div"),l=F(t),this.h()},l(n){e=M(n,"DIV",{class:!0});var i=y(e);l=J(i,t),i.forEach(m),this.h()},h(){c(e,"class","text-xs font-medium pt-1.5 -mb-0.5")},m(n,i){C(n,e,i),_(e,l)},p(n,i){var o;i&386&&t!==(t=n[8].t('This response was generated by "{{model}}"',{model:n[7]?((o=n[7])==null?void 0:o.name)??n[7].id:n[1].selectedModelId})+"")&&K(l,t)},d(n){n&&m(e)}}}function pl(r){let e,t=r[26]+"",l,s,n,i,o,a;function f(){return r[12](r[26])}return{c(){e=I("button"),l=F(t),s=P(),this.h()},l(u){e=M(u,"BUTTON",{class:!0});var d=y(e);l=J(d,t),s=j(d),d.forEach(m),this.h()},h(){var u,d;c(e,"class",n="size-7 text-sm border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(r[6]===r[26]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-full disabled:cursor-not-allowed disabled:text-gray-500 disabled:bg-white dark:disabled:bg-gray-900"),e.disabled=i=((d=(u=r[1])==null?void 0:u.annotation)==null?void 0:d.rating)===-1?r[26]>5:r[26]<6},m(u,d){C(u,e,d),_(e,l),_(e,s),o||(a=me(e,"click",f),o=!0)},p(u,d){var g,h;r=u,d&64&&n!==(n="size-7 text-sm border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(r[6]===r[26]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-full disabled:cursor-not-allowed disabled:text-gray-500 disabled:bg-white dark:disabled:bg-gray-900")&&c(e,"class",n),d&2&&i!==(i=((h=(g=r[1])==null?void 0:g.annotation)==null?void 0:h.rating)===-1?r[26]>5:r[26]<6)&&(e.disabled=i)},d(u){u&&m(e),o=!1,a()}}}function bl(r){let e,t=r[8].t("Why?")+"",l,s,n,i=De(r[3]),o=[];for(let a=0;a<i.length;a+=1)o[a]=kl(gl(r,i,a));return{c(){e=I("div"),l=F(t),s=P(),n=I("div");for(let a=0;a<o.length;a+=1)o[a].c();this.h()},l(a){e=M(a,"DIV",{class:!0});var f=y(e);l=J(f,t),f.forEach(m),s=j(a),n=M(a,"DIV",{class:!0});var u=y(n);for(let d=0;d<o.length;d+=1)o[d].l(u);u.forEach(m),this.h()},h(){c(e,"class","text-sm mt-1.5 font-medium"),c(n,"class","flex flex-wrap gap-1.5 text-sm mt-1.5")},m(a,f){C(a,e,f),_(e,l),C(a,s,f),C(a,n,f);for(let u=0;u<o.length;u+=1)o[u]&&o[u].m(n,null)},p(a,f){if(f&256&&t!==(t=a[8].t("Why?")+"")&&K(l,t),f&280){i=De(a[3]);let u;for(u=0;u<i.length;u+=1){const d=gl(a,i,u);o[u]?o[u].p(d,f):(o[u]=kl(d),o[u].c(),o[u].m(n,null))}for(;u<o.length;u+=1)o[u].d(1);o.length=i.length}},d(a){a&&(m(e),m(s),m(n)),We(o,a)}}}function On(r){let e=r[23]+"",t;return{c(){t=F(e)},l(l){t=J(l,e)},m(l,s){C(l,t,s)},p(l,s){s&8&&e!==(e=l[23]+"")&&K(t,e)},d(l){l&&m(t)}}}function An(r){let e=r[8].t("Other")+"",t;return{c(){t=F(e)},l(l){t=J(l,e)},m(l,s){C(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Other")+"")&&K(t,e)},d(l){l&&m(t)}}}function Hn(r){let e=r[8].t("Being lazy")+"",t;return{c(){t=F(e)},l(l){t=J(l,e)},m(l,s){C(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Being lazy")+"")&&K(t,e)},d(l){l&&m(t)}}}function Pn(r){let e=r[8].t("Refused when it shouldn't have")+"",t;return{c(){t=F(e)},l(l){t=J(l,e)},m(l,s){C(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Refused when it shouldn't have")+"")&&K(t,e)},d(l){l&&m(t)}}}function jn(r){let e=r[8].t("Didn't fully follow instructions")+"",t;return{c(){t=F(e)},l(l){t=J(l,e)},m(l,s){C(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Didn't fully follow instructions")+"")&&K(t,e)},d(l){l&&m(t)}}}function qn(r){let e=r[8].t("Not factually correct")+"",t;return{c(){t=F(e)},l(l){t=J(l,e)},m(l,s){C(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Not factually correct")+"")&&K(t,e)},d(l){l&&m(t)}}}function zn(r){let e=r[8].t("Not helpful")+"",t;return{c(){t=F(e)},l(l){t=J(l,e)},m(l,s){C(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Not helpful")+"")&&K(t,e)},d(l){l&&m(t)}}}function Un(r){let e=r[8].t("Too verbose")+"",t;return{c(){t=F(e)},l(l){t=J(l,e)},m(l,s){C(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Too verbose")+"")&&K(t,e)},d(l){l&&m(t)}}}function Wn(r){let e=r[8].t("Don't like the style")+"",t;return{c(){t=F(e)},l(l){t=J(l,e)},m(l,s){C(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Don't like the style")+"")&&K(t,e)},d(l){l&&m(t)}}}function Fn(r){let e=r[8].t("Thorough explanation")+"",t;return{c(){t=F(e)},l(l){t=J(l,e)},m(l,s){C(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Thorough explanation")+"")&&K(t,e)},d(l){l&&m(t)}}}function Jn(r){let e=r[8].t("Attention to detail")+"",t;return{c(){t=F(e)},l(l){t=J(l,e)},m(l,s){C(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Attention to detail")+"")&&K(t,e)},d(l){l&&m(t)}}}function Gn(r){let e=r[8].t("Positive attitude")+"",t;return{c(){t=F(e)},l(l){t=J(l,e)},m(l,s){C(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Positive attitude")+"")&&K(t,e)},d(l){l&&m(t)}}}function Kn(r){let e=r[8].t("Showcased creativity")+"",t;return{c(){t=F(e)},l(l){t=J(l,e)},m(l,s){C(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Showcased creativity")+"")&&K(t,e)},d(l){l&&m(t)}}}function Qn(r){let e=r[8].t("Followed instructions perfectly")+"",t;return{c(){t=F(e)},l(l){t=J(l,e)},m(l,s){C(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Followed instructions perfectly")+"")&&K(t,e)},d(l){l&&m(t)}}}function Zn(r){let e=r[8].t("Accurate information")+"",t;return{c(){t=F(e)},l(l){t=J(l,e)},m(l,s){C(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Accurate information")+"")&&K(t,e)},d(l){l&&m(t)}}}function kl(r){let e,t,l,s,n;function i(u,d){return u[23]==="accurate_information"?Zn:u[23]==="followed_instructions_perfectly"?Qn:u[23]==="showcased_creativity"?Kn:u[23]==="positive_attitude"?Gn:u[23]==="attention_to_detail"?Jn:u[23]==="thorough_explanation"?Fn:u[23]==="dont_like_the_style"?Wn:u[23]==="too_verbose"?Un:u[23]==="not_helpful"?zn:u[23]==="not_factually_correct"?qn:u[23]==="didnt_fully_follow_instructions"?jn:u[23]==="refused_when_it_shouldnt_have"?Pn:u[23]==="being_lazy"?Hn:u[23]==="other"?An:On}let o=i(r),a=o(r);function f(){return r[13](r[23])}return{c(){e=I("button"),a.c(),t=P(),this.h()},l(u){e=M(u,"BUTTON",{class:!0});var d=y(e);a.l(d),t=j(d),d.forEach(m),this.h()},h(){c(e,"class",l="px-3 py-0.5 border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(r[4]===r[23]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-xl")},m(u,d){C(u,e,d),a.m(e,null),_(e,t),s||(n=me(e,"click",f),s=!0)},p(u,d){r=u,o===(o=i(r))&&a?a.p(r,d):(a.d(1),a=o(r),a&&(a.c(),a.m(e,t))),d&24&&l!==(l="px-3 py-0.5 border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(r[4]===r[23]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-xl")&&c(e,"class",l)},d(u){u&&m(e),a.d(),s=!1,n()}}}function Yn(r){var ne;let e,t,l,s,n=r[8].t("How would you rate this response?")+"",i,o,a,f='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"></path></svg>',u,d,g,h,p,D,v,E,b=r[8].t("Awful")+"",R,A,N,k,B=r[8].t("Amazing")+"",S,T,H,L,q,z,ee,G,Q,ue,fe,ke,de,Z=r[8].t("Save")+"",U,he,ce,be,Me,pe=((ne=r[1])==null?void 0:ne.arena)&&vl(r),O=De(Array.from({length:10}).map(wl)),re=[];for(let se=0;se<O.length;se+=1)re[se]=pl(_l(r,O,se));let ie=r[3].length>0&&bl(r);return fe=new In({props:{tags:r[2]}}),fe.$on("delete",r[15]),fe.$on("add",r[16]),{c(){pe&&pe.c(),e=P(),t=I("div"),l=I("div"),s=I("div"),i=F(n),o=P(),a=I("button"),a.innerHTML=f,u=P(),d=I("div"),g=I("div"),h=I("div");for(let se=0;se<re.length;se+=1)re[se].c();p=P(),D=I("div"),v=I("div"),E=F("1 - "),R=F(b),A=P(),N=I("div"),k=F("10 - "),S=F(B),T=P(),H=I("div"),ie&&ie.c(),L=P(),q=I("div"),z=I("textarea"),G=P(),Q=I("div"),ue=I("div"),Y(fe.$$.fragment),ke=P(),de=I("button"),U=F(Z),this.h()},l(se){pe&&pe.l(se),e=j(se),t=M(se,"DIV",{class:!0,id:!0});var oe=y(t);l=M(oe,"DIV",{class:!0});var ye=y(l);s=M(ye,"DIV",{class:!0});var je=y(s);i=J(je,n),je.forEach(m),o=j(ye),a=M(ye,"BUTTON",{"data-svelte-h":!0}),Te(a)!=="svelte-1ew22ui"&&(a.innerHTML=f),ye.forEach(m),u=j(oe),d=M(oe,"DIV",{class:!0});var Ve=y(d);g=M(Ve,"DIV",{class:!0});var Oe=y(g);h=M(Oe,"DIV",{class:!0});var ze=y(h);for(let st=0;st<re.length;st+=1)re[st].l(ze);ze.forEach(m),p=j(Oe),D=M(Oe,"DIV",{class:!0});var Fe=y(D);v=M(Fe,"DIV",{});var tt=y(v);E=J(tt,"1 - "),R=J(tt,b),tt.forEach(m),A=j(Fe),N=M(Fe,"DIV",{});var lt=y(N);k=J(lt,"10 - "),S=J(lt,B),lt.forEach(m),Fe.forEach(m),Oe.forEach(m),Ve.forEach(m),T=j(oe),H=M(oe,"DIV",{});var ot=y(H);ie&&ie.l(ot),ot.forEach(m),L=j(oe),q=M(oe,"DIV",{class:!0});var ft=y(q);z=M(ft,"TEXTAREA",{class:!0,placeholder:!0,rows:!0}),y(z).forEach(m),ft.forEach(m),G=j(oe),Q=M(oe,"DIV",{class:!0});var xe=y(Q);ue=M(xe,"DIV",{class:!0});var ut=y(ue);X(fe.$$.fragment,ut),ut.forEach(m),ke=j(xe),de=M(xe,"BUTTON",{class:!0});var ct=y(de);U=J(ct,Z),ct.forEach(m),xe.forEach(m),oe.forEach(m),this.h()},h(){c(s,"class","text-sm font-medium"),c(l,"class","flex justify-between items-center"),c(h,"class","mt-1.5 w-fit flex gap-1 pb-5"),c(D,"class","absolute bottom-0 left-0 right-0 flex justify-between text-xs"),c(g,"class","relative w-fit"),c(d,"class","w-full flex justify-center"),c(z,"class","w-full text-sm px-1 py-2 bg-transparent outline-hidden resize-none rounded-xl"),c(z,"placeholder",ee=r[8].t("Feel free to add specific details")),c(z,"rows","3"),c(q,"class","mt-2"),c(ue,"class","flex items-end group"),c(de,"class","px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full"),c(Q,"class","mt-2 gap-1.5 flex justify-between"),c(t,"class","my-2.5 rounded-xl px-4 py-3 border border-gray-100 dark:border-gray-850"),c(t,"id",he="message-feedback-"+r[1].id)},m(se,oe){pe&&pe.m(se,oe),C(se,e,oe),C(se,t,oe),_(t,l),_(l,s),_(s,i),_(l,o),_(l,a),_(t,u),_(t,d),_(d,g),_(g,h);for(let ye=0;ye<re.length;ye+=1)re[ye]&&re[ye].m(h,null);_(g,p),_(g,D),_(D,v),_(v,E),_(v,R),_(D,A),_(D,N),_(N,k),_(N,S),_(t,T),_(t,H),ie&&ie.m(H,null),_(t,L),_(t,q),_(q,z),nt(z,r[5]),_(t,G),_(t,Q),_(Q,ue),$(fe,ue,null),_(Q,ke),_(Q,de),_(de,U),ce=!0,be||(Me=[me(a,"click",r[11]),me(z,"input",r[14]),me(de,"click",r[17])],be=!0)},p(se,[oe]){var je;if((je=se[1])!=null&&je.arena?pe?pe.p(se,oe):(pe=vl(se),pe.c(),pe.m(e.parentNode,e)):pe&&(pe.d(1),pe=null),(!ce||oe&256)&&n!==(n=se[8].t("How would you rate this response?")+"")&&K(i,n),oe&66){O=De(Array.from({length:10}).map(wl));let Ve;for(Ve=0;Ve<O.length;Ve+=1){const Oe=_l(se,O,Ve);re[Ve]?re[Ve].p(Oe,oe):(re[Ve]=pl(Oe),re[Ve].c(),re[Ve].m(h,null))}for(;Ve<re.length;Ve+=1)re[Ve].d(1);re.length=O.length}(!ce||oe&256)&&b!==(b=se[8].t("Awful")+"")&&K(R,b),(!ce||oe&256)&&B!==(B=se[8].t("Amazing")+"")&&K(S,B),se[3].length>0?ie?ie.p(se,oe):(ie=bl(se),ie.c(),ie.m(H,null)):ie&&(ie.d(1),ie=null),(!ce||oe&256&&ee!==(ee=se[8].t("Feel free to add specific details")))&&c(z,"placeholder",ee),oe&32&&nt(z,se[5]);const ye={};oe&4&&(ye.tags=se[2]),fe.$set(ye),(!ce||oe&256)&&Z!==(Z=se[8].t("Save")+"")&&K(U,Z),(!ce||oe&2&&he!==(he="message-feedback-"+se[1].id))&&c(t,"id",he)},i(se){ce||(w(fe.$$.fragment,se),ce=!0)},o(se){V(fe.$$.fragment,se),ce=!1},d(se){se&&(m(e),m(t)),pe&&pe.d(se),We(re,se),ie&&ie.d(),x(fe),be=!1,et(Me)}}}const wl=(r,e)=>e+1;function Xn(r,e,t){let l,s;Ee(r,Rt,H=>t(18,s=H));const n=Qe("i18n");Ee(r,n,H=>t(8,l=H));const i=pt();let{message:o}=e,{show:a=!1}=e,f=["accurate_information","followed_instructions_perfectly","showcased_creativity","positive_attitude","attention_to_detail","thorough_explanation","other"],u=["dont_like_the_style","too_verbose","not_helpful","not_factually_correct","didnt_fully_follow_instructions","refused_when_it_shouldnt_have","being_lazy","other"],d=[],g=[],h=null,p="",D=null,v=null;const E=()=>{var H,L,q,z,ee;h||t(4,h=((H=o==null?void 0:o.annotation)==null?void 0:H.reason)??""),p||t(5,p=((L=o==null?void 0:o.annotation)==null?void 0:L.comment)??""),t(2,d=(((q=o==null?void 0:o.annotation)==null?void 0:q.tags)??[]).map(G=>({name:G}))),D||t(6,D=((ee=(z=o==null?void 0:o.annotation)==null?void 0:z.details)==null?void 0:ee.rating)??null)};bt(()=>{o!=null&&o.arena&&(t(7,v=s.find(H=>H.id===o.selectedModelId)),He.success(l.t('This response was generated by "{{model}}"',{model:v?(v==null?void 0:v.name)??v.id:o.selectedModelId})))});const b=()=>{console.log("saveHandler"),i("save",{reason:h,comment:p,tags:d.map(H=>H.name),details:{rating:D}}),He.success(l.t("Thanks for your feedback!")),t(0,a=!1)},R=()=>{t(0,a=!1)},A=H=>{t(6,D=H)},N=H=>{t(4,h=H)};function k(){p=this.value,t(5,p)}const B=H=>{t(2,d=d.filter(L=>L.name.replaceAll(" ","_").toLowerCase()!==H.detail.replaceAll(" ","_").toLowerCase()))},S=H=>{t(2,d=[...d,{name:H.detail}])},T=()=>{b()};return r.$$set=H=>{"message"in H&&t(1,o=H.message),"show"in H&&t(0,a=H.show)},r.$$.update=()=>{var H,L;r.$$.dirty&2&&(((H=o==null?void 0:o.annotation)==null?void 0:H.rating)===1?t(3,g=f):((L=o==null?void 0:o.annotation)==null?void 0:L.rating)===-1&&t(3,g=u)),r.$$.dirty&2&&o&&E()},[a,o,d,g,h,p,D,v,l,n,b,R,A,N,k,B,S,T]}class $n extends Re{constructor(e){super(),Le(this,e,Xn,Yn,Ce,{message:1,show:0})}}function yl(r,e,t){const l=r.slice();return l[5]=e[t],l[7]=t,l}function xn(r){let e,t;return e=new Nr({props:{strokeWidth:"3.5",className:"size-3.5 "}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(w(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function ei(r){let e,t;return e=new Vr({props:{strokeWidth:"3.5",className:"size-3.5 "}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(w(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function ti(r){let e,t,l,s,n;const i=r[2].default,o=tn(i,r,r[4],null),a=[ei,xn],f=[];function u(d,g){return d[1]?0:1}return l=u(r),s=f[l]=a[l](r),{c(){e=I("div"),o&&o.c(),t=P(),s.c(),this.h()},l(d){e=M(d,"DIV",{class:!0});var g=y(e);o&&o.l(g),t=j(g),s.l(g),g.forEach(m),this.h()},h(){c(e,"class","flex items-center gap-2 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 transition")},m(d,g){C(d,e,g),o&&o.m(e,null),_(e,t),f[l].m(e,null),n=!0},p(d,g){o&&o.p&&(!n||g&16)&&ln(o,i,d,d[4],n?rn(i,d[4],g,null):sn(d[4]),null);let h=l;l=u(d),l!==h&&(te(),V(f[h],1,1,()=>{f[h]=null}),le(),s=f[l],s||(s=f[l]=a[l](d),s.c()),w(s,1),s.m(e,null))},i(d){n||(w(o,d),w(s),n=!0)},o(d){V(o,d),V(s),n=!1},d(d){d&&m(e),o&&o.d(d),f[l].d()}}}function Il(r){let e,t,l,s,n,i=r[0].query+"",o,a,f,u='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg>',d,g;return l=new Mn({}),{c(){e=I("a"),t=I("div"),Y(l.$$.fragment),s=P(),n=I("div"),o=F(i),a=P(),f=I("div"),f.innerHTML=u,this.h()},l(h){e=M(h,"A",{href:!0,target:!0,class:!0});var p=y(e);t=M(p,"DIV",{class:!0});var D=y(t);X(l.$$.fragment,D),s=j(D),n=M(D,"DIV",{class:!0});var v=y(n);o=J(v,i),v.forEach(m),D.forEach(m),a=j(p),f=M(p,"DIV",{class:!0,"data-svelte-h":!0}),Te(f)!=="svelte-14xjows"&&(f.innerHTML=u),p.forEach(m),this.h()},h(){c(n,"class","line-clamp-1"),c(t,"class","flex gap-2 items-center"),c(f,"class","ml-1 text-white dark:text-gray-900 group-hover/item:text-gray-600 dark:group-hover/item:text-white transition"),c(e,"href",d="https://www.google.com/search?q="+r[0].query),c(e,"target","_blank"),c(e,"class","flex w-full items-center p-3 px-4 border-b border-gray-300/30 dark:border-gray-700/50 group/item justify-between font-normal text-gray-800 dark:text-gray-300 no-underline")},m(h,p){C(h,e,p),_(e,t),$(l,t,null),_(t,s),_(t,n),_(n,o),_(e,a),_(e,f),g=!0},p(h,p){(!g||p&1)&&i!==(i=h[0].query+"")&&K(o,i),(!g||p&1&&d!==(d="https://www.google.com/search?q="+h[0].query))&&c(e,"href",d)},i(h){g||(w(l.$$.fragment,h),g=!0)},o(h){V(l.$$.fragment,h),g=!1},d(h){h&&m(e),x(l)}}}function Ml(r){let e,t,l=r[5]+"",s,n,i,o='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg>',a,f,u;return{c(){e=I("a"),t=I("div"),s=F(l),n=P(),i=I("div"),i.innerHTML=o,a=P(),this.h()},l(d){e=M(d,"A",{href:!0,target:!0,class:!0});var g=y(e);t=M(g,"DIV",{class:!0});var h=y(t);s=J(h,l),h.forEach(m),n=j(g),i=M(g,"DIV",{class:!0,"data-svelte-h":!0}),Te(i)!=="svelte-14xjows"&&(i.innerHTML=o),a=j(g),g.forEach(m),this.h()},h(){c(t,"class","line-clamp-1"),c(i,"class","ml-1 text-white dark:text-gray-900 group-hover/item:text-gray-600 dark:group-hover/item:text-white transition"),c(e,"href",f=r[5]),c(e,"target","_blank"),c(e,"class",u="flex w-full items-center p-3 px-4 "+(r[7]===r[0].urls.length-1?"":"border-b border-gray-300/30 dark:border-gray-700/50")+" group/item justify-between font-normal text-gray-800 dark:text-gray-300")},m(d,g){C(d,e,g),_(e,t),_(t,s),_(e,n),_(e,i),_(e,a)},p(d,g){g&1&&l!==(l=d[5]+"")&&K(s,l),g&1&&f!==(f=d[5])&&c(e,"href",f),g&1&&u!==(u="flex w-full items-center p-3 px-4 "+(d[7]===d[0].urls.length-1?"":"border-b border-gray-300/30 dark:border-gray-700/50")+" group/item justify-between font-normal text-gray-800 dark:text-gray-300")&&c(e,"class",u)},d(d){d&&m(e)}}}function li(r){var o;let e,t,l,s=((o=r[0])==null?void 0:o.query)&&Il(r),n=De(r[0].urls),i=[];for(let a=0;a<n.length;a+=1)i[a]=Ml(yl(r,n,a));return{c(){e=I("div"),s&&s.c(),t=P();for(let a=0;a<i.length;a+=1)i[a].c();this.h()},l(a){e=M(a,"DIV",{class:!0,slot:!0});var f=y(e);s&&s.l(f),t=j(f);for(let u=0;u<i.length;u+=1)i[u].l(f);f.forEach(m),this.h()},h(){c(e,"class","text-sm border border-gray-300/30 dark:border-gray-700/50 rounded-xl mb-1.5"),c(e,"slot","content")},m(a,f){C(a,e,f),s&&s.m(e,null),_(e,t);for(let u=0;u<i.length;u+=1)i[u]&&i[u].m(e,null);l=!0},p(a,f){var u;if((u=a[0])!=null&&u.query?s?(s.p(a,f),f&1&&w(s,1)):(s=Il(a),s.c(),w(s,1),s.m(e,t)):s&&(te(),V(s,1,1,()=>{s=null}),le()),f&1){n=De(a[0].urls);let d;for(d=0;d<n.length;d+=1){const g=yl(a,n,d);i[d]?i[d].p(g,f):(i[d]=Ml(g),i[d].c(),i[d].m(e,null))}for(;d<i.length;d+=1)i[d].d(1);i.length=n.length}},i(a){l||(w(s),l=!0)},o(a){V(s),l=!1},d(a){a&&m(e),s&&s.d(),We(i,a)}}}function si(r){let e,t,l;function s(i){r[3](i)}let n={className:"w-full space-y-1",$$slots:{content:[li],default:[ti]},$$scope:{ctx:r}};return r[1]!==void 0&&(n.open=r[1]),e=new Cr({props:n}),Pe.push(()=>Ke(e,"open",s)),{c(){Y(e.$$.fragment)},l(i){X(e.$$.fragment,i)},m(i,o){$(e,i,o),l=!0},p(i,[o]){const a={};o&19&&(a.$$scope={dirty:o,ctx:i}),!t&&o&2&&(t=!0,a.open=i[1],Ge(()=>t=!1)),e.$set(a)},i(i){l||(w(e.$$.fragment,i),l=!0)},o(i){V(e.$$.fragment,i),l=!1},d(i){x(e,i)}}}function ri(r,e,t){let{$$slots:l={},$$scope:s}=e,{status:n={urls:[],query:""}}=e,i=!1;function o(a){i=a,t(1,i)}return r.$$set=a=>{"status"in a&&t(0,n=a.status),"$$scope"in a&&t(4,s=a.$$scope)},[n,i,l,o,s]}class ni extends Re{constructor(e){super(),Le(this,e,ri,si,Ce,{status:0})}}function ii(r){let e,t;return{c(){e=_e("svg"),t=_e("path"),this.h()},l(l){e=ve(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=y(e);t=ve(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),y(t).forEach(m),s.forEach(m),this.h()},h(){c(t,"stroke-linecap","round"),c(t,"stroke-linejoin","round"),c(t,"d","M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456ZM16.894 20.567 16.5 21.75l-.394-1.183a2.25 2.25 0 0 0-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 0 0 1.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 0 0 1.423 1.423l1.183.394-1.183.394a2.25 2.25 0 0 0-1.423 1.423Z"),c(e,"xmlns","http://www.w3.org/2000/svg"),c(e,"fill","none"),c(e,"viewBox","0 0 24 24"),c(e,"stroke-width",r[1]),c(e,"stroke","currentColor"),c(e,"class",r[0])},m(l,s){C(l,e,s),_(e,t)},p(l,[s]){s&2&&c(e,"stroke-width",l[1]),s&1&&c(e,"class",l[0])},i:ge,o:ge,d(l){l&&m(e)}}}function ai(r,e,t){let{className:l="w-4 h-4"}=e,{strokeWidth:s="1.5"}=e;return r.$$set=n=>{"className"in n&&t(0,l=n.className),"strokeWidth"in n&&t(1,s=n.strokeWidth)},[l,s]}class oi extends Re{constructor(e){super(),Le(this,e,ai,ii,Ce,{className:0,strokeWidth:1})}}function fi(r){let e,t,l,s,n,i=(typeof r[0]=="string"?r[0]:JSON.stringify(r[0]))+"",o,a;return l=new En({props:{className:"size-5 text-red-700 dark:text-red-400"}}),{c(){e=I("div"),t=I("div"),Y(l.$$.fragment),s=P(),n=I("div"),o=F(i),this.h()},l(f){e=M(f,"DIV",{class:!0});var u=y(e);t=M(u,"DIV",{class:!0});var d=y(t);X(l.$$.fragment,d),d.forEach(m),s=j(u),n=M(u,"DIV",{class:!0});var g=y(n);o=J(g,i),g.forEach(m),u.forEach(m),this.h()},h(){c(t,"class","self-start mt-0.5"),c(n,"class","self-center text-sm"),c(e,"class","flex my-2 gap-2.5 border px-4 py-3 border-red-600/10 bg-red-600/10 rounded-lg")},m(f,u){C(f,e,u),_(e,t),$(l,t,null),_(e,s),_(e,n),_(n,o),a=!0},p(f,[u]){(!a||u&1)&&i!==(i=(typeof f[0]=="string"?f[0]:JSON.stringify(f[0]))+"")&&K(o,i)},i(f){a||(w(l.$$.fragment,f),a=!0)},o(f){V(l.$$.fragment,f),a=!1},d(f){f&&m(e),x(l)}}}function ui(r,e,t){let{content:l=""}=e;return r.$$set=s=>{"content"in s&&t(0,l=s.content)},[l]}let ci=class extends Re{constructor(e){super(),Le(this,e,ui,fi,Ce,{content:0})}};function El(r,e,t){const l=r.slice();return l[9]=e[t],l[11]=t,l}function di(r){const e=r.slice(),t=Mi(e[9].distance);return e[12]=t,e}function hi(r){let e,t=r[4].t("No source available")+"",l;return{c(){e=I("div"),l=F(t),this.h()},l(s){e=M(s,"DIV",{class:!0});var n=y(e);l=J(n,t),n.forEach(m),this.h()},h(){c(e,"class","text-sm dark:text-gray-400")},m(s,n){C(s,e,n),_(e,l)},p(s,n){n&16&&t!==(t=s[4].t("No source available")+"")&&K(l,t)},i:ge,o:ge,d(s){s&&m(e)}}}function mi(r){let e,t,l,s;e=new Be({props:{className:"w-fit",content:r[4].t("Open file"),placement:"top-start",tippyOptions:{duration:[500,0]},$$slots:{default:[gi]},$$scope:{ctx:r}}});let n=r[2]&&Nl(r);return{c(){Y(e.$$.fragment),t=P(),n&&n.c(),l=ae()},l(i){X(e.$$.fragment,i),t=j(i),n&&n.l(i),l=ae()},m(i,o){$(e,i,o),C(i,t,o),n&&n.m(i,o),C(i,l,o),s=!0},p(i,o){const a={};o&16&&(a.content=i[4].t("Open file")),o&8216&&(a.$$scope={dirty:o,ctx:i}),e.$set(a),i[2]?n?(n.p(i,o),o&4&&w(n,1)):(n=Nl(i),n.c(),w(n,1),n.m(l.parentNode,l)):n&&(te(),V(n,1,1,()=>{n=null}),le())},i(i){s||(w(e.$$.fragment,i),w(n),s=!0)},o(i){V(e.$$.fragment,i),V(n),s=!1},d(i){i&&(m(t),m(l)),x(e,i),n&&n.d(i)}}}function Dl(r){let e,t,l=r[4].t("page")+"",s,n,i=r[9].metadata.page+1+"",o,a;return{c(){e=I("span"),t=F("("),s=F(l),n=P(),o=F(i),a=F(")"),this.h()},l(f){e=M(f,"SPAN",{class:!0});var u=y(e);t=J(u,"("),s=J(u,l),n=j(u),o=J(u,i),a=J(u,")"),u.forEach(m),this.h()},h(){c(e,"class","text-xs text-gray-500 dark:text-gray-400")},m(f,u){C(f,e,u),_(e,t),_(e,s),_(e,n),_(e,o),_(e,a)},p(f,u){u&16&&l!==(l=f[4].t("page")+"")&&K(s,l),u&8&&i!==(i=f[9].metadata.page+1+"")&&K(o,i)},d(f){f&&m(e)}}}function gi(r){var a,f,u,d;let e,t,l=(((f=(a=r[9])==null?void 0:a.metadata)==null?void 0:f.name)??r[9].source.name)+"",s,n,i,o=((d=(u=r[9])==null?void 0:u.metadata)==null?void 0:d.page)&&Dl(r);return{c(){e=I("div"),t=I("a"),s=F(l),i=P(),o&&o.c(),this.h()},l(g){e=M(g,"DIV",{class:!0});var h=y(e);t=M(h,"A",{class:!0,href:!0,target:!0});var p=y(t);s=J(p,l),p.forEach(m),i=j(h),o&&o.l(h),h.forEach(m),this.h()},h(){var g,h,p,D,v,E,b,R;c(t,"class","hover:text-gray-500 dark:hover:text-gray-100 underline grow"),c(t,"href",n=(h=(g=r[9])==null?void 0:g.metadata)!=null&&h.file_id?`${hl}/files/${(D=(p=r[9])==null?void 0:p.metadata)==null?void 0:D.file_id}/content${((E=(v=r[9])==null?void 0:v.metadata)==null?void 0:E.page)!==void 0?`#page=${r[9].metadata.page+1}`:""}`:(R=(b=r[9].source)==null?void 0:b.url)!=null&&R.includes("http")?r[9].source.url:"#"),c(t,"target","_blank"),c(e,"class","text-sm dark:text-gray-400 flex items-center gap-2 w-fit")},m(g,h){C(g,e,h),_(e,t),_(t,s),_(e,i),o&&o.m(e,null)},p(g,h){var p,D,v,E,b,R,A,N,k,B,S,T;h&8&&l!==(l=(((D=(p=g[9])==null?void 0:p.metadata)==null?void 0:D.name)??g[9].source.name)+"")&&K(s,l),h&8&&n!==(n=(E=(v=g[9])==null?void 0:v.metadata)!=null&&E.file_id?`${hl}/files/${(R=(b=g[9])==null?void 0:b.metadata)==null?void 0:R.file_id}/content${((N=(A=g[9])==null?void 0:A.metadata)==null?void 0:N.page)!==void 0?`#page=${g[9].metadata.page+1}`:""}`:(B=(k=g[9].source)==null?void 0:k.url)!=null&&B.includes("http")?g[9].source.url:"#")&&c(t,"href",n),(T=(S=g[9])==null?void 0:S.metadata)!=null&&T.page?o?o.p(g,h):(o=Dl(g),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},d(g){g&&m(e),o&&o.d()}}}function Nl(r){let e,t=r[4].t("Relevance")+"",l,s,n,i,o,a;const f=[vi,_i],u=[];function d(g,h){return g[9].distance!==void 0?0:1}return n=d(r),i=u[n]=f[n](r),{c(){e=I("div"),l=F(t),s=P(),i.c(),o=ae(),this.h()},l(g){e=M(g,"DIV",{class:!0});var h=y(e);l=J(h,t),h.forEach(m),s=j(g),i.l(g),o=ae(),this.h()},h(){c(e,"class","text-sm font-medium dark:text-gray-300 mt-2")},m(g,h){C(g,e,h),_(e,l),C(g,s,h),u[n].m(g,h),C(g,o,h),a=!0},p(g,h){(!a||h&16)&&t!==(t=g[4].t("Relevance")+"")&&K(l,t);let p=n;n=d(g),n===p?u[n].p(g,h):(te(),V(u[p],1,1,()=>{u[p]=null}),le(),i=u[n],i?i.p(g,h):(i=u[n]=f[n](g),i.c()),w(i,1),i.m(o.parentNode,o))},i(g){a||(w(i),a=!0)},o(g){V(i),a=!1},d(g){g&&(m(e),m(s),m(o)),u[n].d(g)}}}function _i(r){let e,t=r[4].t("No distance available")+"",l;return{c(){e=I("div"),l=F(t),this.h()},l(s){e=M(s,"DIV",{class:!0});var n=y(e);l=J(n,t),n.forEach(m),this.h()},h(){c(e,"class","text-sm dark:text-gray-400")},m(s,n){C(s,e,n),_(e,l)},p(s,n){n&16&&t!==(t=s[4].t("No distance available")+"")&&K(l,t)},i:ge,o:ge,d(s){s&&m(e)}}}function vi(r){let e,t;return e=new Be({props:{className:"w-fit",content:r[4].t("Semantic distance to query"),placement:"top-start",tippyOptions:{duration:[500,0]},$$slots:{default:[bi]},$$scope:{ctx:r}}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const n={};s&16&&(n.content=l[4].t("Semantic distance to query")),s&8202&&(n.$$scope={dirty:s,ctx:l}),e.$set(n)},i(l){t||(w(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function pi(r){let e,t=r[9].distance.toFixed(4)+"",l;return{c(){e=I("span"),l=F(t),this.h()},l(s){e=M(s,"SPAN",{class:!0});var n=y(e);l=J(n,t),n.forEach(m),this.h()},h(){c(e,"class","text-gray-500 dark:text-gray-500")},m(s,n){C(s,e,n),_(e,l)},p(s,n){n&8&&t!==(t=s[9].distance.toFixed(4)+"")&&K(l,t)},d(s){s&&m(e)}}}function Vl(r){let e,t=r[12].toFixed(2)+"",l,s,n,i,o,a,f=r[9].distance.toFixed(4)+"",u,d;return{c(){e=I("span"),l=F(t),s=F("%"),i=P(),o=I("span"),a=F("("),u=F(f),d=F(")"),this.h()},l(g){e=M(g,"SPAN",{class:!0});var h=y(e);l=J(h,t),s=J(h,"%"),h.forEach(m),i=j(g),o=M(g,"SPAN",{class:!0});var p=y(o);a=J(p,"("),u=J(p,f),d=J(p,")"),p.forEach(m),this.h()},h(){c(e,"class",n=`px-1 rounded-sm font-medium ${Bl(r[12])}`),c(o,"class","text-gray-500 dark:text-gray-500")},m(g,h){C(g,e,h),_(e,l),_(e,s),C(g,i,h),C(g,o,h),_(o,a),_(o,u),_(o,d)},p(g,h){h&8&&t!==(t=g[12].toFixed(2)+"")&&K(l,t),h&8&&n!==(n=`px-1 rounded-sm font-medium ${Bl(g[12])}`)&&c(e,"class",n),h&8&&f!==(f=g[9].distance.toFixed(4)+"")&&K(u,f)},d(g){g&&(m(e),m(i),m(o))}}}function bi(r){let e;function t(i,o){return i[1]?Vl:pi}function l(i,o){return o===Vl?di(i):i}let s=t(r),n=s(l(r,s));return{c(){e=I("div"),n.c(),this.h()},l(i){e=M(i,"DIV",{class:!0});var o=y(e);n.l(o),o.forEach(m),this.h()},h(){c(e,"class","text-sm my-1 dark:text-gray-400 flex items-center gap-2 w-fit")},m(i,o){C(i,e,o),n.m(e,null)},p(i,o){s===(s=t(i))&&n?n.p(l(i,s),o):(n.d(1),n=s(l(i,s)),n&&(n.c(),n.m(e,null)))},d(i){i&&m(e),n.d()}}}function ki(r){let e,t,l=r[9].document+"",s,n;return{c(){e=I("pre"),t=F("                "),s=F(l),n=F(`
              `),this.h()},l(i){e=M(i,"PRE",{class:!0});var o=y(e);t=J(o,"                "),s=J(o,l),n=J(o,`
              `),o.forEach(m),this.h()},h(){c(e,"class","text-sm dark:text-gray-400 whitespace-pre-line")},m(i,o){C(i,e,o),_(e,t),_(e,s),_(e,n)},p(i,o){o&8&&l!==(l=i[9].document+"")&&K(s,l)},d(i){i&&m(e)}}}function wi(r){let e,t,l;return{c(){e=I("iframe"),this.h()},l(s){e=M(s,"IFRAME",{class:!0,sandbox:!0,srcdoc:!0,title:!0}),y(e).forEach(m),this.h()},h(){c(e,"class","w-full border-0 h-auto rounded-none"),c(e,"sandbox","allow-scripts allow-forms allow-same-origin"),c(e,"srcdoc",t=r[9].document),c(e,"title",l=r[4].t("Content"))},m(s,n){C(s,e,n)},p(s,n){n&8&&t!==(t=s[9].document)&&c(e,"srcdoc",t),n&16&&l!==(l=s[4].t("Content"))&&c(e,"title",l)},d(s){s&&m(e)}}}function Cl(r){let e;return{c(){e=I("hr"),this.h()},l(t){e=M(t,"HR",{class:!0}),this.h()},h(){c(e,"class","border-gray-100 dark:border-gray-850 my-3")},m(t,l){C(t,e,l)},d(t){t&&m(e)}}}function Tl(r){let e,t,l=r[4].t("Source")+"",s,n,i,o,a,f,u,d=r[4].t("Content")+"",g,h,p,D,v;const E=[mi,hi],b=[];function R(S,T){var H;return(H=S[9].source)!=null&&H.name?0:1}i=R(r),o=b[i]=E[i](r);function A(S,T){var H;return(H=S[9].metadata)!=null&&H.html?wi:ki}let N=A(r),k=N(r),B=r[11]!==r[3].length-1&&Cl();return{c(){e=I("div"),t=I("div"),s=F(l),n=P(),o.c(),a=P(),f=I("div"),u=I("div"),g=F(d),h=P(),k.c(),p=P(),B&&B.c(),D=ae(),this.h()},l(S){e=M(S,"DIV",{class:!0});var T=y(e);t=M(T,"DIV",{class:!0});var H=y(t);s=J(H,l),H.forEach(m),n=j(T),o.l(T),T.forEach(m),a=j(S),f=M(S,"DIV",{class:!0});var L=y(f);u=M(L,"DIV",{class:!0});var q=y(u);g=J(q,d),q.forEach(m),h=j(L),k.l(L),L.forEach(m),p=j(S),B&&B.l(S),D=ae(),this.h()},h(){c(t,"class","text-sm font-medium dark:text-gray-300"),c(e,"class","flex flex-col w-full"),c(u,"class","text-sm font-medium dark:text-gray-300 mt-2"),c(f,"class","flex flex-col w-full")},m(S,T){C(S,e,T),_(e,t),_(t,s),_(e,n),b[i].m(e,null),C(S,a,T),C(S,f,T),_(f,u),_(u,g),_(f,h),k.m(f,null),C(S,p,T),B&&B.m(S,T),C(S,D,T),v=!0},p(S,T){(!v||T&16)&&l!==(l=S[4].t("Source")+"")&&K(s,l);let H=i;i=R(S),i===H?b[i].p(S,T):(te(),V(b[H],1,1,()=>{b[H]=null}),le(),o=b[i],o?o.p(S,T):(o=b[i]=E[i](S),o.c()),w(o,1),o.m(e,null)),(!v||T&16)&&d!==(d=S[4].t("Content")+"")&&K(g,d),N===(N=A(S))&&k?k.p(S,T):(k.d(1),k=N(S),k&&(k.c(),k.m(f,null))),S[11]!==S[3].length-1?B||(B=Cl(),B.c(),B.m(D.parentNode,D)):B&&(B.d(1),B=null)},i(S){v||(w(o),v=!0)},o(S){V(o),v=!1},d(S){S&&(m(e),m(a),m(f),m(p),m(D)),b[i].d(),k.d(),B&&B.d(S)}}}function yi(r){let e,t,l,s=r[4].t("Citation")+"",n,i,o,a='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"></path></svg>',f,u,d,g,h,p,D=De(r[3]),v=[];for(let b=0;b<D.length;b+=1)v[b]=Tl(El(r,D,b));const E=b=>V(v[b],1,1,()=>{v[b]=null});return{c(){e=I("div"),t=I("div"),l=I("div"),n=F(s),i=P(),o=I("button"),o.innerHTML=a,f=P(),u=I("div"),d=I("div");for(let b=0;b<v.length;b+=1)v[b].c();this.h()},l(b){e=M(b,"DIV",{});var R=y(e);t=M(R,"DIV",{class:!0});var A=y(t);l=M(A,"DIV",{class:!0});var N=y(l);n=J(N,s),N.forEach(m),i=j(A),o=M(A,"BUTTON",{class:!0,"data-svelte-h":!0}),Te(o)!=="svelte-745w2y"&&(o.innerHTML=a),A.forEach(m),f=j(R),u=M(R,"DIV",{class:!0});var k=y(u);d=M(k,"DIV",{class:!0});var B=y(d);for(let S=0;S<v.length;S+=1)v[S].l(B);B.forEach(m),k.forEach(m),R.forEach(m),this.h()},h(){c(l,"class","text-lg font-medium self-center capitalize"),c(o,"class","self-center"),c(t,"class","flex justify-between dark:text-gray-300 px-5 pt-4 pb-2"),c(d,"class","flex flex-col w-full dark:text-gray-200 overflow-y-scroll max-h-[22rem] scrollbar-hidden"),c(u,"class","flex flex-col md:flex-row w-full px-6 pb-5 md:space-x-4")},m(b,R){C(b,e,R),_(e,t),_(t,l),_(l,n),_(t,i),_(t,o),_(e,f),_(e,u),_(u,d);for(let A=0;A<v.length;A+=1)v[A]&&v[A].m(d,null);g=!0,h||(p=me(o,"click",r[7]),h=!0)},p(b,R){if((!g||R&16)&&s!==(s=b[4].t("Citation")+"")&&K(n,s),R&30){D=De(b[3]);let A;for(A=0;A<D.length;A+=1){const N=El(b,D,A);v[A]?(v[A].p(N,R),w(v[A],1)):(v[A]=Tl(N),v[A].c(),w(v[A],1),v[A].m(d,null))}for(te(),A=D.length;A<v.length;A+=1)E(A);le()}},i(b){if(!g){for(let R=0;R<D.length;R+=1)w(v[R]);g=!0}},o(b){v=v.filter(Boolean);for(let R=0;R<v.length;R+=1)V(v[R]);g=!1},d(b){b&&m(e),We(v,b),h=!1,p()}}}function Ii(r){let e,t,l;function s(i){r[8](i)}let n={size:"lg",$$slots:{default:[yi]},$$scope:{ctx:r}};return r[0]!==void 0&&(n.show=r[0]),e=new Br({props:n}),Pe.push(()=>Ke(e,"show",s)),{c(){Y(e.$$.fragment)},l(i){X(e.$$.fragment,i)},m(i,o){$(e,i,o),l=!0},p(i,[o]){const a={};o&8223&&(a.$$scope={dirty:o,ctx:i}),!t&&o&1&&(t=!0,a.show=i[0],Ge(()=>t=!1)),e.$set(a)},i(i){l||(w(e.$$.fragment,i),l=!0)},o(i){V(e.$$.fragment,i),l=!1},d(i){x(e,i)}}}function Mi(r){return r<0?0:r>1?100:Math.round(r*1e4)/100}function Bl(r){return r>=80?"bg-green-200 dark:bg-green-800 text-green-800 dark:text-green-200":r>=60?"bg-yellow-200 dark:bg-yellow-800 text-yellow-800 dark:text-yellow-200":r>=40?"bg-orange-200 dark:bg-orange-800 text-orange-800 dark:text-orange-200":"bg-red-200 dark:bg-red-800 text-red-800 dark:text-red-200"}function Ei(r,e,t){let l;const s=Qe("i18n");Ee(r,s,g=>t(4,l=g));let{show:n=!1}=e,{citation:i}=e,{showPercentage:o=!1}=e,{showRelevance:a=!0}=e,f=[];const u=()=>{t(0,n=!1)};function d(g){n=g,t(0,n)}return r.$$set=g=>{"show"in g&&t(0,n=g.show),"citation"in g&&t(6,i=g.citation),"showPercentage"in g&&t(1,o=g.showPercentage),"showRelevance"in g&&t(2,a=g.showRelevance)},r.$$.update=()=>{var g;r.$$.dirty&72&&i&&(t(3,f=(g=i.document)==null?void 0:g.map((h,p)=>{var D,v;return{source:i.source,document:h,metadata:(D=i.metadata)==null?void 0:D[p],distance:(v=i.distances)==null?void 0:v[p]}})),f.every(h=>h.distance!==void 0)&&t(3,f=f.sort((h,p)=>(p.distance??1/0)-(h.distance??1/0))))},[n,o,a,f,l,s,i,u,d]}class Di extends Re{constructor(e){super(),Le(this,e,Ei,Ii,Ce,{show:0,citation:6,showPercentage:1,showRelevance:2})}}function Sl(r,e,t){const l=r.slice();return l[18]=e[t],l[20]=t,l}function Rl(r,e,t){const l=r.slice();return l[18]=e[t],l[20]=t,l}function Ll(r,e,t){const l=r.slice();return l[18]=e[t],l[20]=t,l}function Ol(r){let e,t,l,s;const n=[Vi,Ni],i=[];function o(a,f){return a[1].length<=3?0:1}return t=o(r),l=i[t]=n[t](r),{c(){e=I("div"),l.c(),this.h()},l(a){e=M(a,"DIV",{class:!0});var f=y(e);l.l(f),f.forEach(m),this.h()},h(){c(e,"class","py-0.5 -mx-0.5 w-full flex gap-1 items-center flex-wrap")},m(a,f){C(a,e,f),i[t].m(e,null),s=!0},p(a,f){let u=t;t=o(a),t===u?i[t].p(a,f):(te(),V(i[u],1,1,()=>{i[u]=null}),le(),l=i[t],l?l.p(a,f):(l=i[t]=n[t](a),l.c()),w(l,1),l.m(e,null))},i(a){s||(w(l),s=!0)},o(a){V(l),s=!1},d(a){a&&m(e),i[t].d()}}}function Ni(r){let e,t,l;function s(i){r[17](i)}let n={id:"collapsible-sources",className:"w-full max-w-full ",buttonClassName:"w-fit max-w-full",$$slots:{content:[Si],default:[Bi]},$$scope:{ctx:r}};return r[6]!==void 0&&(n.open=r[6]),e=new Cr({props:n}),Pe.push(()=>Ke(e,"open",s)),{c(){Y(e.$$.fragment)},l(i){X(e.$$.fragment,i)},m(i,o){$(e,i,o),l=!0},p(i,o){const a={};o&8388851&&(a.$$scope={dirty:o,ctx:i}),!t&&o&64&&(t=!0,a.open=i[6],Ge(()=>t=!1)),e.$set(a)},i(i){l||(w(e.$$.fragment,i),l=!0)},o(i){V(e.$$.fragment,i),l=!1},d(i){x(e,i)}}}function Vi(r){let e,t=De(r[1]),l=[];for(let s=0;s<t.length;s+=1)l[s]=zl(Ll(r,t,s));return{c(){e=I("div");for(let s=0;s<l.length;s+=1)l[s].c();this.h()},l(s){e=M(s,"DIV",{class:!0});var n=y(e);for(let i=0;i<l.length;i+=1)l[i].l(n);n.forEach(m),this.h()},h(){c(e,"class","flex text-xs font-medium flex-wrap")},m(s,n){C(s,e,n);for(let i=0;i<l.length;i+=1)l[i]&&l[i].m(e,null)},p(s,n){if(n&51){t=De(s[1]);let i;for(i=0;i<t.length;i+=1){const o=Ll(s,t,i);l[i]?l[i].p(o,n):(l[i]=zl(o),l[i].c(),l[i].m(e,null))}for(;i<l.length;i+=1)l[i].d(1);l.length=t.length}},i:ge,o:ge,d(s){s&&m(e),We(l,s)}}}function Al(r){let e,t=r[20]+1+"",l;return{c(){e=I("div"),l=F(t),this.h()},l(s){e=M(s,"DIV",{class:!0});var n=y(e);l=J(n,t),n.forEach(m),this.h()},h(){c(e,"class","bg-gray-50 dark:bg-gray-800 rounded-full size-4")},m(s,n){C(s,e,n),_(e,l)},d(s){s&&m(e)}}}function Hl(r){let e,t=r[1].every(r[12]),l,s,n=r[18].source.name+"",i,o,a,f,u=t&&Al(r);function d(){return r[16](r[18])}return{c(){e=I("button"),u&&u.c(),l=P(),s=I("div"),i=F(n),o=P(),this.h()},l(g){e=M(g,"BUTTON",{class:!0});var h=y(e);u&&u.l(h),l=j(h),s=M(h,"DIV",{class:!0});var p=y(s);i=J(p,n),p.forEach(m),o=j(h),h.forEach(m),this.h()},h(){c(s,"class","flex-1 mx-1 truncate"),c(e,"class","no-toggle outline-hidden flex dark:text-gray-300 p-1 bg-gray-50 hover:bg-gray-100 dark:bg-gray-900 dark:hover:bg-gray-850 transition rounded-xl max-w-96")},m(g,h){C(g,e,h),u&&u.m(e,null),_(e,l),_(e,s),_(s,i),_(e,o),a||(f=[me(e,"click",d),me(e,"pointerup",Ai)],a=!0)},p(g,h){r=g,h&2&&(t=r[1].every(r[12])),t?u||(u=Al(r),u.c(),u.m(e,l)):u&&(u.d(1),u=null),h&2&&n!==(n=r[18].source.name+"")&&K(i,n)},d(g){g&&m(e),u&&u.d(),a=!1,et(f)}}}function Ci(r){let e,t;return e=new Nr({props:{strokeWidth:"3.5",className:"size-3.5"}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(w(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Ti(r){let e,t;return e=new Vr({props:{strokeWidth:"3.5",className:"size-3.5"}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(w(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Bi(r){let e,t,l,s=r[7].t("References from")+"",n,i,o,a,f,u,d,g=r[7].t("and")+"",h,p,D=r[1].length-2+"",v,E,b,R=r[7].t("more")+"",A,N,k,B,S,T,H=De(r[1].slice(0,2)),L=[];for(let G=0;G<H.length;G+=1)L[G]=Hl(Sl(r,H,G));const q=[Ti,Ci],z=[];function ee(G,Q){return G[6]?0:1}return B=ee(r),S=z[B]=q[B](r),{c(){e=I("div"),t=I("div"),l=I("span"),n=F(s),i=P(),o=I("div"),a=I("div");for(let G=0;G<L.length;G+=1)L[G].c();f=P(),u=I("div"),d=I("span"),h=F(g),p=P(),v=F(D),E=P(),b=I("span"),A=F(R),N=P(),k=I("div"),S.c(),this.h()},l(G){e=M(G,"DIV",{class:!0});var Q=y(e);t=M(Q,"DIV",{class:!0});var ue=y(t);l=M(ue,"SPAN",{class:!0});var fe=y(l);n=J(fe,s),fe.forEach(m),i=j(ue),o=M(ue,"DIV",{class:!0});var ke=y(o);a=M(ke,"DIV",{class:!0});var de=y(a);for(let be=0;be<L.length;be+=1)L[be].l(de);de.forEach(m),ke.forEach(m),f=j(ue),u=M(ue,"DIV",{class:!0});var Z=y(u);d=M(Z,"SPAN",{class:!0});var U=y(d);h=J(U,g),U.forEach(m),p=j(Z),v=J(Z,D),E=j(Z),b=M(Z,"SPAN",{});var he=y(b);A=J(he,R),he.forEach(m),Z.forEach(m),ue.forEach(m),N=j(Q),k=M(Q,"DIV",{class:!0});var ce=y(k);S.l(ce),ce.forEach(m),Q.forEach(m),this.h()},h(){c(l,"class","whitespace-nowrap hidden sm:inline shrink-0"),c(a,"class","flex text-xs font-medium items-center"),c(o,"class","flex items-center overflow-auto scrollbar-none w-full max-w-full flex-1"),c(d,"class","hidden sm:inline"),c(u,"class","flex items-center gap-1 whitespace-nowrap shrink-0"),c(t,"class","flex-1 flex items-center gap-1 overflow-auto scrollbar-none w-full max-w-full"),c(k,"class","shrink-0"),c(e,"class","flex w-full overflow-auto items-center gap-2 text-gray-500 hover:text-gray-600 dark:hover:text-gray-400 transition cursor-pointer")},m(G,Q){C(G,e,Q),_(e,t),_(t,l),_(l,n),_(t,i),_(t,o),_(o,a);for(let ue=0;ue<L.length;ue+=1)L[ue]&&L[ue].m(a,null);_(t,f),_(t,u),_(u,d),_(d,h),_(u,p),_(u,v),_(u,E),_(u,b),_(b,A),_(e,N),_(e,k),z[B].m(k,null),T=!0},p(G,Q){if((!T||Q&128)&&s!==(s=G[7].t("References from")+"")&&K(n,s),Q&50){H=De(G[1].slice(0,2));let fe;for(fe=0;fe<H.length;fe+=1){const ke=Sl(G,H,fe);L[fe]?L[fe].p(ke,Q):(L[fe]=Hl(ke),L[fe].c(),L[fe].m(a,null))}for(;fe<L.length;fe+=1)L[fe].d(1);L.length=H.length}(!T||Q&128)&&g!==(g=G[7].t("and")+"")&&K(h,g),(!T||Q&2)&&D!==(D=G[1].length-2+"")&&K(v,D),(!T||Q&128)&&R!==(R=G[7].t("more")+"")&&K(A,R);let ue=B;B=ee(G),B!==ue&&(te(),V(z[ue],1,1,()=>{z[ue]=null}),le(),S=z[B],S||(S=z[B]=q[B](G),S.c()),w(S,1),S.m(k,null))},i(G){T||(w(S),T=!0)},o(G){V(S),T=!1},d(G){G&&m(e),We(L,G),z[B].d()}}}function Pl(r){let e,t=r[20]+1+"",l;return{c(){e=I("div"),l=F(t),this.h()},l(s){e=M(s,"DIV",{class:!0});var n=y(e);l=J(n,t),n.forEach(m),this.h()},h(){c(e,"class","bg-gray-50 dark:bg-gray-800 rounded-full size-4")},m(s,n){C(s,e,n),_(e,l)},d(s){s&&m(e)}}}function jl(r){let e,t=r[1].every(r[11]),l,s,n=r[18].source.name+"",i,o,a,f,u,d=t&&Pl(r);function g(){return r[15](r[18])}return{c(){e=I("button"),d&&d.c(),l=P(),s=I("div"),i=F(n),o=P(),this.h()},l(h){e=M(h,"BUTTON",{id:!0,class:!0});var p=y(e);d&&d.l(p),l=j(p),s=M(p,"DIV",{class:!0});var D=y(s);i=J(D,n),D.forEach(m),o=j(p),p.forEach(m),this.h()},h(){c(s,"class","flex-1 mx-1 truncate"),c(e,"id",a=`source-${r[0]}-${r[20]}`),c(e,"class","no-toggle outline-hidden flex dark:text-gray-300 p-1 bg-gray-50 hover:bg-gray-100 dark:bg-gray-900 dark:hover:bg-gray-850 transition rounded-xl max-w-96")},m(h,p){C(h,e,p),d&&d.m(e,null),_(e,l),_(e,s),_(s,i),_(e,o),f||(u=me(e,"click",g),f=!0)},p(h,p){r=h,p&2&&(t=r[1].every(r[11])),t?d||(d=Pl(r),d.c(),d.m(e,l)):d&&(d.d(1),d=null),p&2&&n!==(n=r[18].source.name+"")&&K(i,n),p&1&&a!==(a=`source-${r[0]}-${r[20]}`)&&c(e,"id",a)},d(h){h&&m(e),d&&d.d(),f=!1,u()}}}function Si(r){let e,t,l=De(r[1]),s=[];for(let n=0;n<l.length;n+=1)s[n]=jl(Rl(r,l,n));return{c(){e=I("div"),t=I("div");for(let n=0;n<s.length;n+=1)s[n].c();this.h()},l(n){e=M(n,"DIV",{slot:!0});var i=y(e);t=M(i,"DIV",{class:!0});var o=y(t);for(let a=0;a<s.length;a+=1)s[a].l(o);o.forEach(m),i.forEach(m),this.h()},h(){c(t,"class","flex text-xs font-medium flex-wrap"),c(e,"slot","content")},m(n,i){C(n,e,i),_(e,t);for(let o=0;o<s.length;o+=1)s[o]&&s[o].m(t,null)},p(n,i){if(i&51){l=De(n[1]);let o;for(o=0;o<l.length;o+=1){const a=Rl(n,l,o);s[o]?s[o].p(a,i):(s[o]=jl(a),s[o].c(),s[o].m(t,null))}for(;o<s.length;o+=1)s[o].d(1);s.length=l.length}},d(n){n&&m(e),We(s,n)}}}function ql(r){let e,t=r[20]+1+"",l;return{c(){e=I("div"),l=F(t),this.h()},l(s){e=M(s,"DIV",{class:!0});var n=y(e);l=J(n,t),n.forEach(m),this.h()},h(){c(e,"class","bg-gray-50 dark:bg-gray-800 rounded-full size-4")},m(s,n){C(s,e,n),_(e,l)},d(s){s&&m(e)}}}function zl(r){let e,t=r[1].every(r[10]),l,s,n=r[18].source.name+"",i,o,a,f,u,d=t&&ql(r);function g(){return r[14](r[18])}return{c(){e=I("button"),d&&d.c(),l=P(),s=I("div"),i=F(n),o=P(),this.h()},l(h){e=M(h,"BUTTON",{id:!0,class:!0});var p=y(e);d&&d.l(p),l=j(p),s=M(p,"DIV",{class:!0});var D=y(s);i=J(D,n),D.forEach(m),o=j(p),p.forEach(m),this.h()},h(){c(s,"class","flex-1 mx-1 truncate text-black/60 hover:text-black dark:text-white/60 dark:hover:text-white transition"),c(e,"id",a=`source-${r[0]}-${r[20]}`),c(e,"class","no-toggle outline-hidden flex dark:text-gray-300 p-1 bg-white dark:bg-gray-900 rounded-xl max-w-96")},m(h,p){C(h,e,p),d&&d.m(e,null),_(e,l),_(e,s),_(s,i),_(e,o),f||(u=me(e,"click",g),f=!0)},p(h,p){r=h,p&2&&(t=r[1].every(r[10])),t?d||(d=ql(r),d.c(),d.m(e,l)):d&&(d.d(1),d=null),p&2&&n!==(n=r[18].source.name+"")&&K(i,n),p&1&&a!==(a=`source-${r[0]}-${r[20]}`)&&c(e,"id",a)},d(h){h&&m(e),d&&d.d(),f=!1,u()}}}function Ri(r){let e,t,l,s,n;function i(f){r[13](f)}let o={citation:r[5],showPercentage:r[2],showRelevance:r[3]};r[4]!==void 0&&(o.show=r[4]),e=new Di({props:o}),Pe.push(()=>Ke(e,"show",i));let a=r[1].length>0&&Ol(r);return{c(){Y(e.$$.fragment),l=P(),a&&a.c(),s=ae()},l(f){X(e.$$.fragment,f),l=j(f),a&&a.l(f),s=ae()},m(f,u){$(e,f,u),C(f,l,u),a&&a.m(f,u),C(f,s,u),n=!0},p(f,[u]){const d={};u&32&&(d.citation=f[5]),u&4&&(d.showPercentage=f[2]),u&8&&(d.showRelevance=f[3]),!t&&u&16&&(t=!0,d.show=f[4],Ge(()=>t=!1)),e.$set(d),f[1].length>0?a?(a.p(f,u),u&2&&w(a,1)):(a=Ol(f),a.c(),w(a,1),a.m(s.parentNode,s)):a&&(te(),V(a,1,1,()=>{a=null}),le())},i(f){n||(w(e.$$.fragment,f),w(a),n=!0)},o(f){V(e.$$.fragment,f),V(a),n=!1},d(f){f&&(m(l),m(s)),x(e,f),a&&a.d(f)}}}function Li(r){const e=r.flatMap(s=>s.distances??[]),t=e.filter(s=>s!==void 0&&s>=-1&&s<=1).length,l=e.filter(s=>s!==void 0&&(s<-1||s>1)).length;return!(e.length===0||t===e.length-1&&l===1||l===e.length-1&&t===1)}function Oi(r){return r.flatMap(t=>t.distances??[]).every(t=>t!==void 0&&t>=-1&&t<=1)}const Ai=r=>{r.stopPropagation()};function Hi(r,e,t){let l;const s=Qe("i18n");Ee(r,s,N=>t(7,l=N));let{id:n=""}=e,{sources:i=[]}=e,o=[],a=!1,f=!0,u=!1,d=null,g=!1;const h=N=>N.distances!==void 0,p=N=>N.distances!==void 0,D=N=>N.distances!==void 0;function v(N){u=N,t(4,u)}const E=N=>{t(4,u=!0),t(5,d=N)},b=N=>{t(4,u=!0),t(5,d=N)},R=N=>{t(4,u=!0),t(5,d=N)};function A(N){g=N,t(6,g)}return r.$$set=N=>{"id"in N&&t(0,n=N.id),"sources"in N&&t(9,i=N.sources)},r.$$.update=()=>{r.$$.dirty&514&&(console.log("sources",i),t(1,o=i.reduce((N,k)=>(Object.keys(k).length===0||k.document.forEach((B,S)=>{var ee,G,Q;const T=(ee=k.metadata)==null?void 0:ee[S],H=(G=k.distances)==null?void 0:G[S],L=(T==null?void 0:T.source)??((Q=k==null?void 0:k.source)==null?void 0:Q.id)??"N/A";let q=k==null?void 0:k.source;T!=null&&T.name&&(q={...q,name:T.name}),(L.startsWith("http://")||L.startsWith("https://"))&&(q={...q,name:L,url:L});const z=N.find(ue=>ue.id===L);z?(z.document.push(B),z.metadata.push(T),H!==void 0&&z.distances.push(H)):N.push({id:L,source:q,document:[B],metadata:T?[T]:[],distances:H!==void 0?[H]:void 0})}),N),[])),t(3,f=Li(o)),t(2,a=Oi(o)))},[n,o,a,f,u,d,g,l,s,i,h,p,D,v,E,b,R,A]}class Pi extends Re{constructor(e){super(),Le(this,e,Hi,Ri,Ce,{id:0,sources:9})}}function Ul(r,e,t){const l=r.slice();return l[6]=e[t],l}function Wl(r){let e,t,l,s;const n=[zi,qi,ji],i=[];function o(a,f){var u,d;return(u=a[1].result)!=null&&u.error?0:(d=a[1].result)!=null&&d.output?1:2}return t=o(r),l=i[t]=n[t](r),{c(){e=I("div"),l.c()},l(a){e=M(a,"DIV",{});var f=y(e);l.l(f),f.forEach(m)},m(a,f){C(a,e,f),i[t].m(e,null),s=!0},p(a,f){let u=t;t=o(a),t!==u&&(te(),V(i[u],1,1,()=>{i[u]=null}),le(),l=i[t],l||(l=i[t]=n[t](a),l.c()),w(l,1),l.m(e,null))},i(a){s||(w(l),s=!0)},o(a){V(l),s=!1},d(a){a&&m(e),i[t].d()}}}function ji(r){let e,t;return e=new Gt({props:{type:"warning",content:"incomplete"}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(w(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function qi(r){let e,t;return e=new Gt({props:{type:"success",content:"success"}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(w(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function zi(r){let e,t;return e=new Gt({props:{type:"error",content:"error"}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(w(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Fl(r){let e,t,l;return t=new At({props:{className:"size-4"}}),{c(){e=I("div"),Y(t.$$.fragment)},l(s){e=M(s,"DIV",{});var n=y(e);X(t.$$.fragment,n),n.forEach(m)},m(s,n){C(s,e,n),$(t,e,null),l=!0},i(s){l||(w(t.$$.fragment,s),l=!0)},o(s){V(t.$$.fragment,s),l=!1},d(s){s&&m(e),x(t)}}}function Ui(r){let e=r[2].t("Code execution")+"",t;return{c(){t=F(e)},l(l){t=J(l,e)},m(l,s){C(l,t,s)},p(l,s){s&4&&e!==(e=l[2].t("Code execution")+"")&&K(t,e)},d(l){l&&m(t)}}}function Wi(r){var i;let e=r[2].t("Code execution")+"",t,l,s=((i=r[1])==null?void 0:i.name)+"",n;return{c(){t=F(e),l=F(": "),n=F(s)},l(o){t=J(o,e),l=J(o,": "),n=J(o,s)},m(o,a){C(o,t,a),C(o,l,a),C(o,n,a)},p(o,a){var f;a&4&&e!==(e=o[2].t("Code execution")+"")&&K(t,e),a&2&&s!==(s=((f=o[1])==null?void 0:f.name)+"")&&K(n,s)},d(o){o&&(m(t),m(l),m(n))}}}function Jl(r){var n,i,o,a;let e,t,l=((i=(n=r[1])==null?void 0:n.result)==null?void 0:i.error)&&Gl(r),s=((a=(o=r[1])==null?void 0:o.result)==null?void 0:a.output)&&Kl(r);return{c(){e=I("div"),l&&l.c(),t=P(),s&&s.c(),this.h()},l(f){e=M(f,"DIV",{class:!0});var u=y(e);l&&l.l(u),t=j(u),s&&s.l(u),u.forEach(m),this.h()},h(){c(e,"class","dark:bg-[#202123] dark:text-white px-4 py-4 rounded-b-lg flex flex-col gap-3")},m(f,u){C(f,e,u),l&&l.m(e,null),_(e,t),s&&s.m(e,null)},p(f,u){var d,g,h,p;(g=(d=f[1])==null?void 0:d.result)!=null&&g.error?l?l.p(f,u):(l=Gl(f),l.c(),l.m(e,t)):l&&(l.d(1),l=null),(p=(h=f[1])==null?void 0:h.result)!=null&&p.output?s?s.p(f,u):(s=Kl(f),s.c(),s.m(e,null)):s&&(s.d(1),s=null)},d(f){f&&m(e),l&&l.d(),s&&s.d()}}}function Gl(r){var f,u;let e,t,l=r[2].t("ERROR")+"",s,n,i,o=((u=(f=r[1])==null?void 0:f.result)==null?void 0:u.error)+"",a;return{c(){e=I("div"),t=I("div"),s=F(l),n=P(),i=I("div"),a=F(o),this.h()},l(d){e=M(d,"DIV",{});var g=y(e);t=M(g,"DIV",{class:!0});var h=y(t);s=J(h,l),h.forEach(m),n=j(g),i=M(g,"DIV",{class:!0});var p=y(i);a=J(p,o),p.forEach(m),g.forEach(m),this.h()},h(){c(t,"class","text-gray-500 text-xs mb-1"),c(i,"class","text-sm")},m(d,g){C(d,e,g),_(e,t),_(t,s),_(e,n),_(e,i),_(i,a)},p(d,g){var h,p;g&4&&l!==(l=d[2].t("ERROR")+"")&&K(s,l),g&2&&o!==(o=((p=(h=d[1])==null?void 0:h.result)==null?void 0:p.error)+"")&&K(a,o)},d(d){d&&m(e)}}}function Kl(r){var f,u;let e,t,l=r[2].t("OUTPUT")+"",s,n,i,o=((u=(f=r[1])==null?void 0:f.result)==null?void 0:u.output)+"",a;return{c(){e=I("div"),t=I("div"),s=F(l),n=P(),i=I("div"),a=F(o),this.h()},l(d){e=M(d,"DIV",{});var g=y(e);t=M(g,"DIV",{class:!0});var h=y(t);s=J(h,l),h.forEach(m),n=j(g),i=M(g,"DIV",{class:!0});var p=y(i);a=J(p,o),p.forEach(m),g.forEach(m),this.h()},h(){c(t,"class","text-gray-500 text-xs mb-1"),c(i,"class","text-sm")},m(d,g){C(d,e,g),_(e,t),_(t,s),_(e,n),_(e,i),_(i,a)},p(d,g){var h,p;g&4&&l!==(l=d[2].t("OUTPUT")+"")&&K(s,l),g&2&&o!==(o=((p=(h=d[1])==null?void 0:h.result)==null?void 0:p.output)+"")&&K(a,o)},d(d){d&&m(e)}}}function Ql(r){var d,g;let e,t,l,s,n=r[2].t("Files")+"",i,o,a,f=De((g=(d=r[1])==null?void 0:d.result)==null?void 0:g.files),u=[];for(let h=0;h<f.length;h+=1)u[h]=Zl(Ul(r,f,h));return{c(){e=I("div"),t=I("hr"),l=P(),s=I("div"),i=F(n),o=P(),a=I("ul");for(let h=0;h<u.length;h+=1)u[h].c();this.h()},l(h){e=M(h,"DIV",{class:!0});var p=y(e);t=M(p,"HR",{class:!0}),l=j(p),s=M(p,"DIV",{class:!0});var D=y(s);i=J(D,n),D.forEach(m),o=j(p),a=M(p,"UL",{class:!0});var v=y(a);for(let E=0;E<u.length;E+=1)u[E].l(v);v.forEach(m),p.forEach(m),this.h()},h(){c(t,"class","border-gray-100 dark:border-gray-850 my-2"),c(s,"class","text-sm font-medium dark:text-gray-300"),c(a,"class","mt-1 list-disc pl-4 text-xs"),c(e,"class","flex flex-col w-full")},m(h,p){C(h,e,p),_(e,t),_(e,l),_(e,s),_(s,i),_(e,o),_(e,a);for(let D=0;D<u.length;D+=1)u[D]&&u[D].m(a,null)},p(h,p){var D,v;if(p&4&&n!==(n=h[2].t("Files")+"")&&K(i,n),p&2){f=De((v=(D=h[1])==null?void 0:D.result)==null?void 0:v.files);let E;for(E=0;E<f.length;E+=1){const b=Ul(h,f,E);u[E]?u[E].p(b,p):(u[E]=Zl(b),u[E].c(),u[E].m(a,null))}for(;E<u.length;E+=1)u[E].d(1);u.length=f.length}},d(h){h&&m(e),We(u,h)}}}function Zl(r){let e,t,l=r[6].name+"",s,n,i;return{c(){e=I("li"),t=I("a"),s=F(l),i=P(),this.h()},l(o){e=M(o,"LI",{});var a=y(e);t=M(a,"A",{href:!0,target:!0});var f=y(t);s=J(f,l),f.forEach(m),i=j(a),a.forEach(m),this.h()},h(){c(t,"href",n=r[6].url),c(t,"target","_blank")},m(o,a){C(o,e,a),_(e,t),_(t,s),_(e,i)},p(o,a){a&2&&l!==(l=o[6].name+"")&&K(s,l),a&2&&n!==(n=o[6].url)&&c(t,"href",n)},d(o){o&&m(e)}}}function Fi(r){var q,z,ee,G,Q,ue,fe,ke,de,Z,U,he,ce,be,Me,pe,O,re,ie;let e,t,l,s,n,i,o,a,f,u='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"></path></svg>',d,g,h,p,D,v,E,b,R,A,N=((q=r[1])==null?void 0:q.result)&&Wl(r),k=!((z=r[1])!=null&&z.result)&&Fl();function B(ne,se){var oe;return(oe=ne[1])!=null&&oe.name?Wi:Ui}let S=B(r),T=S(r);D=new yn({props:{id:"code-exec-"+((ee=r[1])==null?void 0:ee.id)+"-code",lang:((G=r[1])==null?void 0:G.language)??"",code:((Q=r[1])==null?void 0:Q.code)??"",className:"",editorClassName:(ue=r[1])!=null&&ue.result&&((ke=(fe=r[1])==null?void 0:fe.result)!=null&&ke.error||(Z=(de=r[1])==null?void 0:de.result)!=null&&Z.output)?"rounded-b-none":"",stickyButtonsClassName:"top-0",run:!1}});let H=((U=r[1])==null?void 0:U.result)&&(((ce=(he=r[1])==null?void 0:he.result)==null?void 0:ce.error)||((Me=(be=r[1])==null?void 0:be.result)==null?void 0:Me.output))&&Jl(r),L=((O=(pe=r[1])==null?void 0:pe.result)==null?void 0:O.files)&&((ie=(re=r[1])==null?void 0:re.result)==null?void 0:ie.files.length)>0&&Ql(r);return{c(){e=I("div"),t=I("div"),l=I("div"),N&&N.c(),s=P(),n=I("div"),k&&k.c(),i=P(),o=I("div"),T.c(),a=P(),f=I("button"),f.innerHTML=u,d=P(),g=I("div"),h=I("div"),p=I("div"),Y(D.$$.fragment),v=P(),H&&H.c(),E=P(),L&&L.c(),this.h()},l(ne){e=M(ne,"DIV",{});var se=y(e);t=M(se,"DIV",{class:!0});var oe=y(t);l=M(oe,"DIV",{class:!0});var ye=y(l);N&&N.l(ye),s=j(ye),n=M(ye,"DIV",{class:!0});var je=y(n);k&&k.l(je),i=j(je),o=M(je,"DIV",{});var Ve=y(o);T.l(Ve),Ve.forEach(m),je.forEach(m),ye.forEach(m),a=j(oe),f=M(oe,"BUTTON",{class:!0,"data-svelte-h":!0}),Te(f)!=="svelte-vnrwun"&&(f.innerHTML=u),oe.forEach(m),d=j(se),g=M(se,"DIV",{class:!0});var Oe=y(g);h=M(Oe,"DIV",{class:!0});var ze=y(h);p=M(ze,"DIV",{class:!0});var Fe=y(p);X(D.$$.fragment,Fe),Fe.forEach(m),v=j(ze),H&&H.l(ze),E=j(ze),L&&L.l(ze),ze.forEach(m),Oe.forEach(m),se.forEach(m),this.h()},h(){c(n,"class","flex gap-2 items-center"),c(l,"class","text-lg font-medium self-center flex flex-col gap-0.5 capitalize"),c(f,"class","self-center"),c(t,"class","flex justify-between dark:text-gray-300 px-5 pt-4 pb-2"),c(p,"class","flex flex-col w-full"),c(h,"class","flex flex-col w-full dark:text-gray-200 overflow-y-scroll max-h-[22rem] scrollbar-hidden"),c(g,"class","flex flex-col md:flex-row w-full px-4 pb-5")},m(ne,se){C(ne,e,se),_(e,t),_(t,l),N&&N.m(l,null),_(l,s),_(l,n),k&&k.m(n,null),_(n,i),_(n,o),T.m(o,null),_(t,a),_(t,f),_(e,d),_(e,g),_(g,h),_(h,p),$(D,p,null),_(h,v),H&&H.m(h,null),_(h,E),L&&L.m(h,null),b=!0,R||(A=me(f,"click",r[4]),R=!0)},p(ne,se){var ye,je,Ve,Oe,ze,Fe,tt,lt,ot,ft,xe,ut,ct,st,It,Mt,Et,Dt,Nt;(ye=ne[1])!=null&&ye.result?N?(N.p(ne,se),se&2&&w(N,1)):(N=Wl(ne),N.c(),w(N,1),N.m(l,s)):N&&(te(),V(N,1,1,()=>{N=null}),le()),(je=ne[1])!=null&&je.result?k&&(te(),V(k,1,1,()=>{k=null}),le()):k?se&2&&w(k,1):(k=Fl(),k.c(),w(k,1),k.m(n,i)),S===(S=B(ne))&&T?T.p(ne,se):(T.d(1),T=S(ne),T&&(T.c(),T.m(o,null)));const oe={};se&2&&(oe.id="code-exec-"+((Ve=ne[1])==null?void 0:Ve.id)+"-code"),se&2&&(oe.lang=((Oe=ne[1])==null?void 0:Oe.language)??""),se&2&&(oe.code=((ze=ne[1])==null?void 0:ze.code)??""),se&2&&(oe.editorClassName=(Fe=ne[1])!=null&&Fe.result&&((lt=(tt=ne[1])==null?void 0:tt.result)!=null&&lt.error||(ft=(ot=ne[1])==null?void 0:ot.result)!=null&&ft.output)?"rounded-b-none":""),D.$set(oe),(xe=ne[1])!=null&&xe.result&&((ct=(ut=ne[1])==null?void 0:ut.result)!=null&&ct.error||(It=(st=ne[1])==null?void 0:st.result)!=null&&It.output)?H?H.p(ne,se):(H=Jl(ne),H.c(),H.m(h,E)):H&&(H.d(1),H=null),(Et=(Mt=ne[1])==null?void 0:Mt.result)!=null&&Et.files&&((Nt=(Dt=ne[1])==null?void 0:Dt.result)==null?void 0:Nt.files.length)>0?L?L.p(ne,se):(L=Ql(ne),L.c(),L.m(h,null)):L&&(L.d(1),L=null)},i(ne){b||(w(N),w(k),w(D.$$.fragment,ne),b=!0)},o(ne){V(N),V(k),V(D.$$.fragment,ne),b=!1},d(ne){ne&&m(e),N&&N.d(),k&&k.d(),T.d(),x(D),H&&H.d(),L&&L.d(),R=!1,A()}}}function Ji(r){let e,t,l;function s(i){r[5](i)}let n={size:"lg",$$slots:{default:[Fi]},$$scope:{ctx:r}};return r[0]!==void 0&&(n.show=r[0]),e=new Br({props:n}),Pe.push(()=>Ke(e,"show",s)),{c(){Y(e.$$.fragment)},l(i){X(e.$$.fragment,i)},m(i,o){$(e,i,o),l=!0},p(i,[o]){const a={};o&519&&(a.$$scope={dirty:o,ctx:i}),!t&&o&1&&(t=!0,a.show=i[0],Ge(()=>t=!1)),e.$set(a)},i(i){l||(w(e.$$.fragment,i),l=!0)},o(i){V(e.$$.fragment,i),l=!1},d(i){x(e,i)}}}function Gi(r,e,t){let l;const s=Qe("i18n");Ee(r,s,f=>t(2,l=f));let{show:n=!1}=e,{codeExecution:i=null}=e;const o=()=>{t(0,n=!1),t(1,i=null)};function a(f){n=f,t(0,n)}return r.$$set=f=>{"show"in f&&t(0,n=f.show),"codeExecution"in f&&t(1,i=f.codeExecution)},[n,i,l,s,o,a]}class Ki extends Re{constructor(e){super(),Le(this,e,Gi,Ji,Ce,{show:0,codeExecution:1})}}function Yl(r,e,t){const l=r.slice();return l[6]=e[t],l}function Xl(r){let e,t=[],l=new Map,s,n=De(r[0]);const i=o=>o[6].id;for(let o=0;o<n.length;o+=1){let a=Yl(r,n,o),f=i(a);l.set(f,t[o]=$l(f,a))}return{c(){e=I("div");for(let o=0;o<t.length;o+=1)t[o].c();this.h()},l(o){e=M(o,"DIV",{class:!0});var a=y(e);for(let f=0;f<t.length;f+=1)t[f].l(a);a.forEach(m),this.h()},h(){c(e,"class","mt-1 mb-2 w-full flex gap-1 items-center flex-wrap")},m(o,a){C(o,e,a);for(let f=0;f<t.length;f+=1)t[f]&&t[f].m(e,null);s=!0},p(o,a){a&7&&(n=De(o[0]),te(),t=kr(t,a,i,1,o,n,l,e,wr,$l,null,Yl),le())},i(o){if(!s){for(let a=0;a<n.length;a+=1)w(t[a]);s=!0}},o(o){for(let a=0;a<t.length;a+=1)V(t[a]);s=!1},d(o){o&&m(e);for(let a=0;a<t.length;a+=1)t[a].d()}}}function Qi(r){let e,t;return e=new At({props:{className:"size-4"}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p:ge,i(l){t||(w(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Zi(r){let e,t,l,s;const n=[$i,Xi,Yi],i=[];function o(a,f){var u,d;return(u=a[6].result)!=null&&u.error?0:(d=a[6].result)!=null&&d.output?1:2}return e=o(r),t=i[e]=n[e](r),{c(){t.c(),l=ae()},l(a){t.l(a),l=ae()},m(a,f){i[e].m(a,f),C(a,l,f),s=!0},p(a,f){let u=e;e=o(a),e!==u&&(te(),V(i[u],1,1,()=>{i[u]=null}),le(),t=i[e],t||(t=i[e]=n[e](a),t.c()),w(t,1),t.m(l.parentNode,l))},i(a){s||(w(t),s=!0)},o(a){V(t),s=!1},d(a){a&&m(l),i[e].d(a)}}}function Yi(r){let e,t;return e=new Vn({}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(w(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Xi(r){let e,t;return e=new Dn({props:{strokeWidth:"3",className:"size-3"}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(w(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function $i(r){let e,t;return e=new Nn({}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(w(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function $l(r,e){let t,l,s,n,i,o,a,f=e[6].name+"",u,d,g,h,p,D;const v=[Zi,Qi],E=[];function b(A,N){var k;return(k=A[6])!=null&&k.result?0:1}n=b(e),i=E[n]=v[n](e);function R(){return e[4](e[6])}return{key:r,first:null,c(){t=I("div"),l=I("button"),s=I("div"),i.c(),o=P(),a=I("div"),u=F(f),g=P(),this.h()},l(A){t=M(A,"DIV",{class:!0});var N=y(t);l=M(N,"BUTTON",{class:!0});var k=y(l);s=M(k,"DIV",{class:!0});var B=y(s);i.l(B),B.forEach(m),o=j(k),a=M(k,"DIV",{class:!0});var S=y(a);u=J(S,f),S.forEach(m),k.forEach(m),g=j(N),N.forEach(m),this.h()},h(){var A;c(s,"class","bg-white dark:bg-gray-700 rounded-full size-4 flex items-center justify-center"),c(a,"class",d="flex-1 mx-2 line-clamp-1 code-execution-name "+((A=e[6])!=null&&A.result?"":"pulse")+" svelte-1gvtig2"),c(l,"class","flex dark:text-gray-300 py-1 px-1 bg-gray-50 hover:bg-gray-100 dark:bg-gray-850 dark:hover:bg-gray-800 transition rounded-xl max-w-96"),c(t,"class","flex gap-1 text-xs font-semibold"),this.first=t},m(A,N){C(A,t,N),_(t,l),_(l,s),E[n].m(s,null),_(l,o),_(l,a),_(a,u),_(t,g),h=!0,p||(D=me(l,"click",R),p=!0)},p(A,N){var B;e=A;let k=n;n=b(e),n===k?E[n].p(e,N):(te(),V(E[k],1,1,()=>{E[k]=null}),le(),i=E[n],i?i.p(e,N):(i=E[n]=v[n](e),i.c()),w(i,1),i.m(s,null)),(!h||N&1)&&f!==(f=e[6].name+"")&&K(u,f),(!h||N&1&&d!==(d="flex-1 mx-2 line-clamp-1 code-execution-name "+((B=e[6])!=null&&B.result?"":"pulse")+" svelte-1gvtig2"))&&c(a,"class",d)},i(A){h||(w(i),h=!0)},o(A){V(i),h=!1},d(A){A&&m(t),E[n].d(),p=!1,D()}}}function xi(r){let e,t,l,s,n;function i(f){r[3](f)}let o={codeExecution:r[1]};r[2]!==void 0&&(o.show=r[2]),e=new Ki({props:o}),Pe.push(()=>Ke(e,"show",i));let a=r[0].length>0&&Xl(r);return{c(){Y(e.$$.fragment),l=P(),a&&a.c(),s=ae()},l(f){X(e.$$.fragment,f),l=j(f),a&&a.l(f),s=ae()},m(f,u){$(e,f,u),C(f,l,u),a&&a.m(f,u),C(f,s,u),n=!0},p(f,[u]){const d={};u&2&&(d.codeExecution=f[1]),!t&&u&4&&(t=!0,d.show=f[2],Ge(()=>t=!1)),e.$set(d),f[0].length>0?a?(a.p(f,u),u&1&&w(a,1)):(a=Xl(f),a.c(),w(a,1),a.m(s.parentNode,s)):a&&(te(),V(a,1,1,()=>{a=null}),le())},i(f){n||(w(e.$$.fragment,f),w(a),n=!0)},o(f){V(e.$$.fragment,f),V(a),n=!1},d(f){f&&(m(l),m(s)),x(e,f),a&&a.d(f)}}}function ea(r,e,t){let{codeExecutions:l=[]}=e,s=null,n=!1;const i=()=>{s&&t(1,s=l.find(f=>f.id===s.id))};function o(f){n=f,t(2,n)}const a=f=>{t(1,s=f),t(2,n=!0)};return r.$$set=f=>{"codeExecutions"in f&&t(0,l=f.codeExecutions)},r.$$.update=()=>{r.$$.dirty&1&&l&&i()},[l,s,n,o,a]}class ta extends Re{constructor(e){super(),Le(this,e,ea,xi,Ce,{codeExecutions:0})}}function la(r){let e,t;return{c(){e=_e("svg"),t=_e("path"),this.h()},l(l){e=ve(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=y(e);t=ve(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),y(t).forEach(m),s.forEach(m),this.h()},h(){c(t,"stroke-linecap","round"),c(t,"stroke-linejoin","round"),c(t,"d","M8.625 12a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H8.25m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H12m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0h-.375M21 12c0 4.556-4.03 8.25-9 8.25a9.764 9.764 0 0 1-2.555-.337A5.972 5.972 0 0 1 5.41 20.97a5.969 5.969 0 0 1-.474-.065 4.48 4.48 0 0 0 .978-2.025c.09-.457-.133-.901-.467-1.226C3.93 16.178 3 14.189 3 12c0-4.556 4.03-8.25 9-8.25s9 3.694 9 8.25Z"),c(e,"xmlns","http://www.w3.org/2000/svg"),c(e,"fill","none"),c(e,"viewBox","0 0 24 24"),c(e,"stroke-width",r[1]),c(e,"stroke","currentColor"),c(e,"class",r[0])},m(l,s){C(l,e,s),_(e,t)},p(l,[s]){s&2&&c(e,"stroke-width",l[1]),s&1&&c(e,"class",l[0])},i:ge,o:ge,d(l){l&&m(e)}}}function sa(r,e,t){let{className:l="size-4"}=e,{strokeWidth:s="1.5"}=e;return r.$$set=n=>{"className"in n&&t(0,l=n.className),"strokeWidth"in n&&t(1,s=n.strokeWidth)},[l,s]}class ra extends Re{constructor(e){super(),Le(this,e,sa,la,Ce,{className:0,strokeWidth:1})}}function na(r){let e,t;return{c(){e=_e("svg"),t=_e("path"),this.h()},l(l){e=ve(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=y(e);t=ve(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),y(t).forEach(m),s.forEach(m),this.h()},h(){c(t,"stroke-linecap","round"),c(t,"stroke-linejoin","round"),c(t,"d","M12 18v-5.25m0 0a6.01 6.01 0 0 0 1.5-.189m-1.5.189a6.01 6.01 0 0 1-1.5-.189m3.75 7.478a12.06 12.06 0 0 1-4.5 0m3.75 2.383a14.406 14.406 0 0 1-3 0M14.25 18v-.192c0-.983.658-1.823 1.508-2.316a7.5 7.5 0 1 0-7.517 0c.85.493 1.509 1.333 1.509 2.316V18"),c(e,"xmlns","http://www.w3.org/2000/svg"),c(e,"fill","none"),c(e,"viewBox","0 0 24 24"),c(e,"stroke-width",r[1]),c(e,"stroke","currentColor"),c(e,"class",r[0])},m(l,s){C(l,e,s),_(e,t)},p(l,[s]){s&2&&c(e,"stroke-width",l[1]),s&1&&c(e,"class",l[0])},i:ge,o:ge,d(l){l&&m(e)}}}function ia(r,e,t){let{className:l="w-4 h-4"}=e,{strokeWidth:s="1.5"}=e;return r.$$set=n=>{"className"in n&&t(0,l=n.className),"strokeWidth"in n&&t(1,s=n.strokeWidth)},[l,s]}class aa extends Re{constructor(e){super(),Le(this,e,ia,na,Ce,{className:0,strokeWidth:1})}}function oa(r){let e,t,l,s,n,i,o,a,f,u,d,g;s=new yt({props:{id:`${r[0]}-float-prompt`,content:r[4]}});const h=[ca,ua],p=[];function D(E,b){return b&32&&(a=null),a==null&&(a=E[5].trim()===""),a?0:1}f=D(r,-1),u=p[f]=h[f](r);let v=r[6]&&xl(r);return{c(){e=I("div"),t=I("div"),l=I("div"),Y(s.$$.fragment),n=P(),i=I("div"),o=I("div"),u.c(),d=P(),v&&v.c(),this.h()},l(E){e=M(E,"DIV",{class:!0});var b=y(e);t=M(b,"DIV",{class:!0});var R=y(t);l=M(R,"DIV",{class:!0});var A=y(l);X(s.$$.fragment,A),A.forEach(m),R.forEach(m),n=j(b),i=M(b,"DIV",{class:!0});var N=y(i);o=M(N,"DIV",{class:!0,id:!0});var k=y(o);u.l(k),d=j(k),v&&v.l(k),k.forEach(m),N.forEach(m),b.forEach(m),this.h()},h(){c(l,"class","font-medium"),c(t,"class","bg-gray-50/50 dark:bg-gray-800 dark:text-gray-100 text-medium rounded-xl px-3.5 py-3 w-full"),c(o,"class","max-h-80 overflow-y-auto w-full markdown-prose-xs"),c(o,"id","response-container"),c(i,"class","bg-white dark:bg-gray-850 dark:text-gray-100 text-medium rounded-xl px-3.5 py-3 w-full"),c(e,"class","bg-white dark:bg-gray-850 dark:text-gray-100 rounded-xl shadow-xl w-80 max-w-full")},m(E,b){C(E,e,b),_(e,t),_(t,l),$(s,l,null),_(e,n),_(e,i),_(i,o),p[f].m(o,null),_(o,d),v&&v.m(o,null),g=!0},p(E,b){const R={};b&1&&(R.id=`${E[0]}-float-prompt`),b&16&&(R.content=E[4]),s.$set(R);let A=f;f=D(E,b),f===A?p[f].p(E,b):(te(),V(p[A],1,1,()=>{p[A]=null}),le(),u=p[f],u?u.p(E,b):(u=p[f]=h[f](E),u.c()),w(u,1),u.m(o,d)),E[6]?v?v.p(E,b):(v=xl(E),v.c(),v.m(o,null)):v&&(v.d(1),v=null)},i(E){g||(w(s.$$.fragment,E),w(u),g=!0)},o(E){V(s.$$.fragment,E),V(u),g=!1},d(E){E&&m(e),x(s),p[f].d(),v&&v.d()}}}function fa(r){let e,t,l,s;const n=[ha,da],i=[];function o(a,f){return a[1]?1:0}return e=o(r),t=i[e]=n[e](r),{c(){t.c(),l=ae()},l(a){t.l(a),l=ae()},m(a,f){i[e].m(a,f),C(a,l,f),s=!0},p(a,f){let u=e;e=o(a),e===u?i[e].p(a,f):(te(),V(i[u],1,1,()=>{i[u]=null}),le(),t=i[e],t?t.p(a,f):(t=i[e]=n[e](a),t.c()),w(t,1),t.m(l.parentNode,l))},i(a){s||(w(t),s=!0)},o(a){V(t),s=!1},d(a){a&&m(l),i[e].d(a)}}}function ua(r){let e,t;return e=new yt({props:{id:`${r[0]}-float-response`,content:r[5]}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const n={};s&1&&(n.id=`${l[0]}-float-response`),s&32&&(n.content=l[5]),e.$set(n)},i(l){t||(w(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function ca(r){let e,t;return e=new Qt({props:{size:"sm"}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p:ge,i(l){t||(w(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function xl(r){let e,t,l=r[7].t("Add")+"",s,n,i;return{c(){e=I("div"),t=I("button"),s=F(l),this.h()},l(o){e=M(o,"DIV",{class:!0});var a=y(e);t=M(a,"BUTTON",{class:!0});var f=y(t);s=J(f,l),f.forEach(m),a.forEach(m),this.h()},h(){c(t,"class","px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full"),c(e,"class","flex justify-end pt-3 text-sm font-medium")},m(o,a){C(o,e,a),_(e,t),_(t,s),n||(i=me(t,"click",r[11]),n=!0)},p(o,a){a&128&&l!==(l=o[7].t("Add")+"")&&K(s,l)},d(o){o&&m(e),n=!1,i()}}}function da(r){let e,t,l,s,n,i,o,a,f,u,d;return{c(){e=I("div"),t=I("input"),s=P(),n=I("div"),i=I("button"),o=_e("svg"),a=_e("path"),this.h()},l(g){e=M(g,"DIV",{class:!0});var h=y(e);t=M(h,"INPUT",{type:!0,id:!0,class:!0,placeholder:!0}),s=j(h),n=M(h,"DIV",{class:!0});var p=y(n);i=M(p,"BUTTON",{class:!0});var D=y(i);o=ve(D,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var v=y(o);a=ve(v,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),y(a).forEach(m),v.forEach(m),D.forEach(m),p.forEach(m),h.forEach(m),this.h()},h(){c(t,"type","text"),c(t,"id","floating-message-input"),c(t,"class","ml-5 bg-transparent outline-hidden w-full flex-1 text-sm"),c(t,"placeholder",l=r[7].t("Ask a question")),c(a,"fill-rule","evenodd"),c(a,"d","M8 14a.75.75 0 0 1-.75-.75V4.56L4.03 7.78a.75.75 0 0 1-1.06-1.06l4.5-4.5a.75.75 0 0 1 1.06 0l4.5 4.5a.75.75 0 0 1-1.06 1.06L8.75 4.56v8.69A.75.75 0 0 1 8 14Z"),c(a,"clip-rule","evenodd"),c(o,"xmlns","http://www.w3.org/2000/svg"),c(o,"viewBox","0 0 16 16"),c(o,"fill","currentColor"),c(o,"class","size-4"),c(i,"class",f=(r[3]!==""?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled")+" transition rounded-full p-1.5 m-0.5 self-center"),c(n,"class","ml-1 mr-2"),c(e,"class","py-1 flex dark:text-gray-100 bg-gray-50 dark:bg-gray-800 border dark:border-gray-850 w-72 rounded-full shadow-xl")},m(g,h){C(g,e,h),_(e,t),nt(t,r[3]),_(e,s),_(e,n),_(n,i),_(i,o),_(o,a),u||(d=[me(t,"input",r[18]),me(t,"keydown",r[19]),me(i,"click",r[20])],u=!0)},p(g,h){h&128&&l!==(l=g[7].t("Ask a question"))&&c(t,"placeholder",l),h&8&&t.value!==g[3]&&nt(t,g[3]),h&8&&f!==(f=(g[3]!==""?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled")+" transition rounded-full p-1.5 m-0.5 self-center")&&c(i,"class",f)},i:ge,o:ge,d(g){g&&m(e),u=!1,et(d)}}}function ha(r){let e,t,l,s,n,i="Ask",o,a,f,u,d,g="Explain",h,p,D;return l=new ra({props:{className:"size-3 shrink-0"}}),f=new aa({props:{className:"size-3 shrink-0"}}),{c(){e=I("div"),t=I("button"),Y(l.$$.fragment),s=P(),n=I("div"),n.textContent=i,o=P(),a=I("button"),Y(f.$$.fragment),u=P(),d=I("div"),d.textContent=g,this.h()},l(v){e=M(v,"DIV",{class:!0});var E=y(e);t=M(E,"BUTTON",{class:!0});var b=y(t);X(l.$$.fragment,b),s=j(b),n=M(b,"DIV",{class:!0,"data-svelte-h":!0}),Te(n)!=="svelte-1ugwo9q"&&(n.textContent=i),b.forEach(m),o=j(E),a=M(E,"BUTTON",{class:!0});var R=y(a);X(f.$$.fragment,R),u=j(R),d=M(R,"DIV",{class:!0,"data-svelte-h":!0}),Te(d)!=="svelte-1sxc82g"&&(d.textContent=g),R.forEach(m),E.forEach(m),this.h()},h(){c(n,"class","shrink-0"),c(t,"class","px-1 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-sm flex items-center gap-1 min-w-fit"),c(d,"class","shrink-0"),c(a,"class","px-1 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-sm flex items-center gap-1 min-w-fit"),c(e,"class","flex flex-row gap-0.5 shrink-0 p-1 bg-white dark:bg-gray-850 dark:text-gray-100 text-medium rounded-lg shadow-xl")},m(v,E){C(v,e,E),_(e,t),$(l,t,null),_(t,s),_(t,n),_(e,o),_(e,a),$(f,a,null),_(a,u),_(a,d),h=!0,p||(D=[me(t,"click",r[16]),me(a,"click",r[17])],p=!0)},p:ge,i(v){h||(w(l.$$.fragment,v),w(f.$$.fragment,v),h=!0)},o(v){V(l.$$.fragment,v),V(f.$$.fragment,v),h=!1},d(v){v&&m(e),x(l),x(f),p=!1,et(D)}}}function ma(r){let e,t,l,s,n;const i=[fa,oa],o=[];function a(f,u){return f[5]===null?0:1}return t=a(r),l=o[t]=i[t](r),{c(){e=I("div"),l.c(),this.h()},l(f){e=M(f,"DIV",{id:!0,class:!0,style:!0});var u=y(e);l.l(u),u.forEach(m),this.h()},h(){c(e,"id",s=`floating-buttons-${r[0]}`),c(e,"class","absolute rounded-lg mt-1 text-xs z-9999"),br(e,"display","none")},m(f,u){C(f,e,u),o[t].m(e,null),n=!0},p(f,[u]){let d=t;t=a(f),t===d?o[t].p(f,u):(te(),V(o[d],1,1,()=>{o[d]=null}),le(),l=o[t],l?l.p(f,u):(l=o[t]=i[t](f),l.c()),w(l,1),l.m(e,null)),(!n||u&1&&s!==(s=`floating-buttons-${f[0]}`))&&c(e,"id",s)},i(f){n||(w(l),n=!0)},o(f){V(l),n=!1},d(f){f&&m(e),o[t].d()}}}function ga(r,e,t){let l;const s=Qe("i18n");Ee(r,s,T=>t(7,l=T));let{id:n=""}=e,{model:i=null}=e,{messages:o=[]}=e,{onAdd:a=()=>{}}=e,f=!1,u="",d="",g="",h=null,p=!1;const D=async()=>{const T=document.getElementById("response-container");T.scrollHeight-T.clientHeight<=T.scrollTop+50&&(T.scrollTop=T.scrollHeight)},v=async()=>{if(!i){He.error("Model not selected");return}t(4,g=`${d}
\`\`\`
${u}
\`\`\``),t(3,d=""),t(5,h="");const[T,H]=await ml(localStorage.token,{model:i,messages:[...o,{role:"user",content:g}].map(L=>({role:L.role,content:L.content})),stream:!0});if(T&&T.ok){const L=T.body.getReader(),q=new TextDecoder;await(async()=>{var ee,G;for(;;){const{done:Q,value:ue}=await L.read();if(Q)break;const ke=q.decode(ue,{stream:!0}).split(`
`).filter(de=>de.trim()!=="");for(const de of ke)if(de.startsWith("data: "))if(de.startsWith("data: [DONE]")){t(6,p=!0),await Ne(),D();continue}else try{const Z=JSON.parse(de.slice(6));Z.choices&&((G=(ee=Z.choices[0])==null?void 0:ee.delta)!=null&&G.content)&&(t(5,h+=Z.choices[0].delta.content),D())}catch(Z){console.error(Z)}}})()}else He.error("An error occurred while fetching the explanation")},E=async()=>{if(!i){He.error("Model not selected");return}t(4,g=`Explain this section to me in more detail

\`\`\`
${u}
\`\`\``),t(5,h="");const[T,H]=await ml(localStorage.token,{model:i,messages:[...o,{role:"user",content:g}].map(L=>({role:L.role,content:L.content})),stream:!0});if(T&&T.ok){const L=T.body.getReader(),q=new TextDecoder;await(async()=>{var ee,G;for(;;){const{done:Q,value:ue}=await L.read();if(Q)break;const ke=q.decode(ue,{stream:!0}).split(`
`).filter(de=>de.trim()!=="");for(const de of ke)if(de.startsWith("data: "))if(de.startsWith("data: [DONE]")){t(6,p=!0),await Ne(),D();continue}else try{const Z=JSON.parse(de.slice(6));Z.choices&&((G=(ee=Z.choices[0])==null?void 0:ee.delta)!=null&&G.content)&&(t(5,h+=Z.choices[0].delta.content),D())}catch(Z){console.error(Z)}}})()}else He.error("An error occurred while fetching the explanation")},b=async()=>{a({modelId:i,parentId:n,messages:[{role:"user",content:g},{role:"assistant",content:h}]})},R=()=>{t(5,h=null),t(6,p=!1),t(1,f=!1),t(3,d="")},A=async()=>{t(2,u=window.getSelection().toString()),t(1,f=!0),await Ne(),setTimeout(()=>{const T=document.getElementById("floating-message-input");T&&T.focus()},0)},N=()=>{t(2,u=window.getSelection().toString()),E()};function k(){d=this.value,t(3,d)}const B=T=>{T.key==="Enter"&&v()},S=()=>{v()};return r.$$set=T=>{"id"in T&&t(0,n=T.id),"model"in T&&t(12,i=T.model),"messages"in T&&t(13,o=T.messages),"onAdd"in T&&t(14,a=T.onAdd)},[n,f,u,d,g,h,p,l,s,v,E,b,i,o,a,R,A,N,k,B,S]}class _a extends Re{constructor(e){super(),Le(this,e,ga,ma,Ce,{id:0,model:12,messages:13,onAdd:14,closeHandler:15})}get closeHandler(){return this.$$.ctx[15]}}function es(r){var s;let e,t,l={id:r[0],model:(s=r[3])==null?void 0:s.id,messages:Wt(r[2],r[0]),onAdd:r[20]};return e=new _a({props:l}),r[21](e),{c(){Y(e.$$.fragment)},l(n){X(e.$$.fragment,n)},m(n,i){$(e,n,i),t=!0},p(n,i){var a;const o={};i&1&&(o.id=n[0]),i&8&&(o.model=(a=n[3])==null?void 0:a.id),i&5&&(o.messages=Wt(n[2],n[0])),i&512&&(o.onAdd=n[20]),e.$set(o)},i(n){t||(w(e.$$.fragment,n),t=!0)},o(n){V(e.$$.fragment,n),t=!1},d(n){r[21](null),x(e,n)}}}function va(r){let e,t,l,s,n;t=new yt({props:{id:r[0],content:r[1],model:r[3],save:r[5],sourceIds:(r[4]??[]).reduce(r[16],[]),onSourceClick:r[7],onTaskClick:r[8]}}),t.$on("update",r[17]),t.$on("code",r[18]);let i=r[6]&&r[3]&&es(r);return{c(){e=I("div"),Y(t.$$.fragment),l=P(),i&&i.c(),s=ae()},l(o){e=M(o,"DIV",{});var a=y(e);X(t.$$.fragment,a),a.forEach(m),l=j(o),i&&i.l(o),s=ae()},m(o,a){C(o,e,a),$(t,e,null),r[19](e),C(o,l,a),i&&i.m(o,a),C(o,s,a),n=!0},p(o,[a]){const f={};a&1&&(f.id=o[0]),a&2&&(f.content=o[1]),a&8&&(f.model=o[3]),a&32&&(f.save=o[5]),a&24&&(f.sourceIds=(o[4]??[]).reduce(o[16],[])),a&128&&(f.onSourceClick=o[7]),a&256&&(f.onTaskClick=o[8]),t.$set(f),o[6]&&o[3]?i?(i.p(o,a),a&72&&w(i,1)):(i=es(o),i.c(),w(i,1),i.m(s.parentNode,s)):i&&(te(),V(i,1,1,()=>{i=null}),le())},i(o){n||(w(t.$$.fragment,o),w(i),n=!0)},o(o){V(t.$$.fragment,o),V(i),n=!1},d(o){o&&(m(e),m(l),m(s)),x(t),r[19](null),i&&i.d(o)}}}function pa(r,e,t){let l,s;Ee(r,yr,L=>t(12,l=L)),Ee(r,fn,L=>t(13,s=L)),Qe("i18n");const n=pt();let{id:i}=e,{content:o}=e,{history:a}=e,{model:f=null}=e,{sources:u=null}=e,{save:d=!1}=e,{floatingButtons:g=!0}=e,{onSourceClick:h=()=>{}}=e,{onTaskClick:p=()=>{}}=e,{onAddMessages:D=()=>{}}=e,v,E;const b=L=>{const q=document.getElementById(`floating-buttons-${i}`);if(!(v!=null&&v.contains(L.target))&&!(q!=null&&q.contains(L.target))){R();return}setTimeout(async()=>{if(await Ne(),!(v!=null&&v.contains(L.target)))return;let z=window.getSelection();if(z.toString().trim().length>0){const G=z.getRangeAt(0).getBoundingClientRect(),Q=v.getBoundingClientRect(),ue=G.bottom-Q.top,fe=G.left-Q.left;if(q){q.style.display="block";const ke=Q.width-fe;let de=l?window.innerWidth/2:window.innerWidth/3;if(ke<de){const Z=Q.right-G.right;q.style.right=`${Z}px`,q.style.left="auto"}else q.style.left=`${fe}px`,q.style.right="auto";q.style.top=`${ue+5}px`}}else R()},0)},R=()=>{const L=document.getElementById(`floating-buttons-${i}`);L&&(L.style.display="none"),E&&E.closeHandler()},A=L=>{L.key==="Escape"&&R()};bt(()=>{g&&(v==null||v.addEventListener("mouseup",b),document.addEventListener("mouseup",b),document.addEventListener("keydown",A))}),nn(()=>{g&&(v==null||v.removeEventListener("mouseup",b),document.removeEventListener("mouseup",b),document.removeEventListener("keydown",A))});const N=(L,q)=>{let z=[];return q.document.forEach((ee,G)=>{var fe,ke,de,Z,U;if(((de=(ke=(fe=f==null?void 0:f.info)==null?void 0:fe.meta)==null?void 0:ke.capabilities)==null?void 0:de.citations)==!1)return z.push("N/A"),z;const Q=(Z=q.metadata)==null?void 0:Z[G],ue=(Q==null?void 0:Q.source)??"N/A";return Q!=null&&Q.name?(z.push(Q.name),z):(ue.startsWith("http://")||ue.startsWith("https://")?z.push(ue):z.push(((U=q==null?void 0:q.source)==null?void 0:U.name)??ue),z)}),L=[...L,...z],L.filter((ee,G)=>L.indexOf(ee)===G)},k=L=>{n("update",L.detail)},B=L=>{const{lang:q,code:z}=L.detail;(["html","svg"].includes(q)||q==="xml"&&z.includes("svg"))&&!l&&s&&(un.set(!0),cn.set(!0))};function S(L){Pe[L?"unshift":"push"](()=>{v=L,t(10,v)})}const T=({modelId:L,parentId:q,messages:z})=>{console.log(L,q,z),D({modelId:L,parentId:q,messages:z}),R()};function H(L){Pe[L?"unshift":"push"](()=>{E=L,t(11,E)})}return r.$$set=L=>{"id"in L&&t(0,i=L.id),"content"in L&&t(1,o=L.content),"history"in L&&t(2,a=L.history),"model"in L&&t(3,f=L.model),"sources"in L&&t(4,u=L.sources),"save"in L&&t(5,d=L.save),"floatingButtons"in L&&t(6,g=L.floatingButtons),"onSourceClick"in L&&t(7,h=L.onSourceClick),"onTaskClick"in L&&t(8,p=L.onTaskClick),"onAddMessages"in L&&t(9,D=L.onAddMessages)},[i,o,a,f,u,d,g,h,p,D,v,E,l,s,n,R,N,k,B,S,T,H]}class Sr extends Re{constructor(e){super(),Le(this,e,pa,va,Ce,{id:0,content:1,history:2,model:3,sources:4,save:5,floatingButtons:6,onSourceClick:7,onTaskClick:8,onAddMessages:9})}}function ts(r,e,t){const l=r.slice();return l[87]=e[t],l}function qt(r){var l,s,n;const e=r.slice(),t=(((l=e[0])==null?void 0:l.statusHistory)??[...(s=e[0])!=null&&s.status?[(n=e[0])==null?void 0:n.status]:[]]).at(-1);return e[90]=t,e}function ls(r,e,t){const l=r.slice();return l[91]=e[t],l}function ba(r){var s;let e,t=(((s=r[14])==null?void 0:s.name)??r[0].model)+"",l;return{c(){e=I("span"),l=F(t),this.h()},l(n){e=M(n,"SPAN",{class:!0});var i=y(e);l=J(i,t),i.forEach(m),this.h()},h(){c(e,"class","line-clamp-1 svelte-wlev50")},m(n,i){C(n,e,i),_(e,l)},p(n,i){var o;i[0]&16385&&t!==(t=(((o=n[14])==null?void 0:o.name)??n[0].model)+"")&&K(l,t)},d(n){n&&m(e)}}}function ss(r){let e,t,l;return t=new Be({props:{content:at(r[0].timestamp*1e3).format("LLLL"),$$slots:{default:[ka]},$$scope:{ctx:r}}}),{c(){e=I("div"),Y(t.$$.fragment),this.h()},l(s){e=M(s,"DIV",{class:!0});var n=y(e);X(t.$$.fragment,n),n.forEach(m),this.h()},h(){c(e,"class","self-center text-xs invisible group-hover:visible text-gray-400 font-medium first-letter:capitalize ml-0.5 translate-y-[1px]")},m(s,n){C(s,e,n),$(t,e,null),l=!0},p(s,n){const i={};n[0]&1&&(i.content=at(s[0].timestamp*1e3).format("LLLL")),n[0]&1|n[3]&2&&(i.$$scope={dirty:n,ctx:s}),t.$set(i)},i(s){l||(w(t.$$.fragment,s),l=!0)},o(s){V(t.$$.fragment,s),l=!1},d(s){s&&m(e),x(t)}}}function ka(r){let e,t=Tt(r[0].timestamp*1e3)+"",l;return{c(){e=I("span"),l=F(t),this.h()},l(s){e=M(s,"SPAN",{class:!0});var n=y(e);l=J(n,t),n.forEach(m),this.h()},h(){c(e,"class","line-clamp-1 svelte-wlev50")},m(s,n){C(s,e,n),_(e,l)},p(s,n){n[0]&1&&t!==(t=Tt(s[0].timestamp*1e3)+"")&&K(l,t)},d(s){s&&m(e)}}}function wa(r){var i;let e,t,l,s;e=new Be({props:{content:((i=r[14])==null?void 0:i.name)??r[0].model,placement:"top-start",$$slots:{default:[ba]},$$scope:{ctx:r}}});let n=r[0].timestamp&&ss(r);return{c(){Y(e.$$.fragment),t=P(),n&&n.c(),l=ae()},l(o){X(e.$$.fragment,o),t=j(o),n&&n.l(o),l=ae()},m(o,a){$(e,o,a),C(o,t,a),n&&n.m(o,a),C(o,l,a),s=!0},p(o,a){var u;const f={};a[0]&16385&&(f.content=((u=o[14])==null?void 0:u.name)??o[0].model),a[0]&16385|a[3]&2&&(f.$$scope={dirty:a,ctx:o}),e.$set(f),o[0].timestamp?n?(n.p(o,a),a[0]&1&&w(n,1)):(n=ss(o),n.c(),w(n,1),n.m(l.parentNode,l)):n&&(te(),V(n,1,1,()=>{n=null}),le())},i(o){s||(w(e.$$.fragment,o),w(n),s=!0)},o(o){V(e.$$.fragment,o),V(n),s=!1},d(o){o&&(m(t),m(l)),x(e,o),n&&n.d(o)}}}function rs(r){let e,t,l=De(r[0].files),s=[];for(let i=0;i<l.length;i+=1)s[i]=is(ls(r,l,i));const n=i=>V(s[i],1,1,()=>{s[i]=null});return{c(){e=I("div");for(let i=0;i<s.length;i+=1)s[i].c();this.h()},l(i){e=M(i,"DIV",{class:!0});var o=y(e);for(let a=0;a<s.length;a+=1)s[a].l(o);o.forEach(m),this.h()},h(){c(e,"class","my-2.5 w-full flex overflow-x-auto gap-2 flex-wrap")},m(i,o){C(i,e,o);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);t=!0},p(i,o){if(o[0]&1){l=De(i[0].files);let a;for(a=0;a<l.length;a+=1){const f=ls(i,l,a);s[a]?(s[a].p(f,o),w(s[a],1)):(s[a]=is(f),s[a].c(),w(s[a],1),s[a].m(e,null))}for(te(),a=l.length;a<s.length;a+=1)n(a);le()}},i(i){if(!t){for(let o=0;o<l.length;o+=1)w(s[o]);t=!0}},o(i){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)V(s[o]);t=!1},d(i){i&&m(e),We(s,i)}}}function ns(r){let e,t;return e=new Dr({props:{src:r[91].url,alt:r[0].content}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const n={};s[0]&1&&(n.src=l[91].url),s[0]&1&&(n.alt=l[0].content),e.$set(n)},i(l){t||(w(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function is(r){let e,t,l,s=r[91].type==="image"&&ns(r);return{c(){e=I("div"),s&&s.c(),t=P()},l(n){e=M(n,"DIV",{});var i=y(e);s&&s.l(i),t=j(i),i.forEach(m)},m(n,i){C(n,e,i),s&&s.m(e,null),_(e,t),l=!0},p(n,i){n[91].type==="image"?s?(s.p(n,i),i[0]&1&&w(s,1)):(s=ns(n),s.c(),w(s,1),s.m(e,t)):s&&(te(),V(s,1,1,()=>{s=null}),le())},i(n){l||(w(s),l=!0)},o(n){V(s),l=!1},d(n){n&&m(e),s&&s.d()}}}function as(r){var s;let e,t,l=!((s=r[90])!=null&&s.hidden)&&os(r);return{c(){l&&l.c(),e=ae()},l(n){l&&l.l(n),e=ae()},m(n,i){l&&l.m(n,i),C(n,e,i),t=!0},p(n,i){var o;(o=n[90])!=null&&o.hidden?l&&(te(),V(l,1,1,()=>{l=null}),le()):l?(l.p(n,i),i[0]&1&&w(l,1)):(l=os(n),l.c(),w(l,1),l.m(e.parentNode,e))},i(n){t||(w(l),t=!0)},o(n){V(l),t=!1},d(n){n&&m(e),l&&l.d(n)}}}function os(r){var u;let e,t,l,s,n,i=((u=r[90])==null?void 0:u.done)===!1&&fs();const o=[Ma,Ia,ya],a=[];function f(d,g){var h,p,D;return((h=d[90])==null?void 0:h.action)==="web_search"&&((p=d[90])!=null&&p.urls)?0:((D=d[90])==null?void 0:D.action)==="knowledge_search"?1:2}return l=f(r),s=a[l]=o[l](r),{c(){e=I("div"),i&&i.c(),t=P(),s.c(),this.h()},l(d){e=M(d,"DIV",{class:!0});var g=y(e);i&&i.l(g),t=j(g),s.l(g),g.forEach(m),this.h()},h(){c(e,"class","status-description flex items-center gap-2 py-0.5")},m(d,g){C(d,e,g),i&&i.m(e,null),_(e,t),a[l].m(e,null),n=!0},p(d,g){var p;((p=d[90])==null?void 0:p.done)===!1?i?g[0]&1&&w(i,1):(i=fs(),i.c(),w(i,1),i.m(e,t)):i&&(te(),V(i,1,1,()=>{i=null}),le());let h=l;l=f(d),l===h?a[l].p(d,g):(te(),V(a[h],1,1,()=>{a[h]=null}),le(),s=a[l],s?s.p(d,g):(s=a[l]=o[l](d),s.c()),w(s,1),s.m(e,null))},i(d){n||(w(i),w(s),n=!0)},o(d){V(i),V(s),n=!1},d(d){d&&m(e),i&&i.d(),a[l].d()}}}function fs(r){let e,t,l;return t=new At({props:{className:"size-4"}}),{c(){e=I("div"),Y(t.$$.fragment),this.h()},l(s){e=M(s,"DIV",{class:!0});var n=y(e);X(t.$$.fragment,n),n.forEach(m),this.h()},h(){c(e,"class","")},m(s,n){C(s,e,n),$(t,e,null),l=!0},i(s){l||(w(t.$$.fragment,s),l=!0)},o(s){V(t.$$.fragment,s),l=!1},d(s){s&&m(e),x(t)}}}function ya(r){let e,t,l,s;function n(a,f){var u,d,g;return f[0]&1&&(l=null),l==null&&(l=!!((u=a[90])!=null&&u.description.includes("{{searchQuery}}"))),l?Va:((d=a[90])==null?void 0:d.description)==="No search query generated"?Na:((g=a[90])==null?void 0:g.description)==="Generating search query"?Da:Ea}let i=n(r,[-1,-1,-1,-1]),o=i(r);return{c(){e=I("div"),t=I("div"),o.c(),this.h()},l(a){e=M(a,"DIV",{class:!0});var f=y(e);t=M(f,"DIV",{class:!0});var u=y(t);o.l(u),u.forEach(m),f.forEach(m),this.h()},h(){var a;c(t,"class",s=(((a=r[90])==null?void 0:a.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap"),c(e,"class","flex flex-col justify-center -space-y-0.5")},m(a,f){C(a,e,f),_(e,t),o.m(t,null)},p(a,f){var u;i===(i=n(a,f))&&o?o.p(a,f):(o.d(1),o=i(a),o&&(o.c(),o.m(t,null))),f[0]&1&&s!==(s=(((u=a[90])==null?void 0:u.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap")&&c(t,"class",s)},i:ge,o:ge,d(a){a&&m(e),o.d()}}}function Ia(r){let e,t,l=r[25].t('Searching Knowledge for "{{searchQuery}}"',{searchQuery:r[90].query})+"",s,n;return{c(){e=I("div"),t=I("div"),s=F(l),this.h()},l(i){e=M(i,"DIV",{class:!0});var o=y(e);t=M(o,"DIV",{class:!0});var a=y(t);s=J(a,l),a.forEach(m),o.forEach(m),this.h()},h(){var i;c(t,"class",n=(((i=r[90])==null?void 0:i.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap"),c(e,"class","flex flex-col justify-center -space-y-0.5")},m(i,o){C(i,e,o),_(e,t),_(t,s)},p(i,o){var a;o[0]&33554433&&l!==(l=i[25].t('Searching Knowledge for "{{searchQuery}}"',{searchQuery:i[90].query})+"")&&K(s,l),o[0]&1&&n!==(n=(((a=i[90])==null?void 0:a.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap")&&c(t,"class",n)},i:ge,o:ge,d(i){i&&m(e)}}}function Ma(r){let e,t;return e=new ni({props:{status:r[90],$$slots:{default:[Ra]},$$scope:{ctx:r}}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const n={};s[0]&1&&(n.status=l[90]),s[0]&33554433|s[3]&2&&(n.$$scope={dirty:s,ctx:l}),e.$set(n)},i(l){t||(w(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Ea(r){var l;let e=((l=r[90])==null?void 0:l.description)+"",t;return{c(){t=F(e)},l(s){t=J(s,e)},m(s,n){C(s,t,n)},p(s,n){var i;n[0]&1&&e!==(e=((i=s[90])==null?void 0:i.description)+"")&&K(t,e)},d(s){s&&m(t)}}}function Da(r){let e=r[25].t("Generating search query")+"",t;return{c(){t=F(e)},l(l){t=J(l,e)},m(l,s){C(l,t,s)},p(l,s){s[0]&33554432&&e!==(e=l[25].t("Generating search query")+"")&&K(t,e)},d(l){l&&m(t)}}}function Na(r){let e=r[25].t("No search query generated")+"",t;return{c(){t=F(e)},l(l){t=J(l,e)},m(l,s){C(l,t,s)},p(l,s){s[0]&33554432&&e!==(e=l[25].t("No search query generated")+"")&&K(t,e)},d(l){l&&m(t)}}}function Va(r){var l,s;let e=r[25].t((l=r[90])==null?void 0:l.description,{searchQuery:(s=r[90])==null?void 0:s.query})+"",t;return{c(){t=F(e)},l(n){t=J(n,e)},m(n,i){C(n,t,i)},p(n,i){var o,a;i[0]&33554433&&e!==(e=n[25].t((o=n[90])==null?void 0:o.description,{searchQuery:(a=n[90])==null?void 0:a.query})+"")&&K(t,e)},d(n){n&&m(t)}}}function Ca(r){var l;let e=((l=r[90])==null?void 0:l.description)+"",t;return{c(){t=F(e)},l(s){t=J(s,e)},m(s,n){C(s,t,n)},p(s,n){var i;n[0]&1&&e!==(e=((i=s[90])==null?void 0:i.description)+"")&&K(t,e)},d(s){s&&m(t)}}}function Ta(r){let e=r[25].t("Generating search query")+"",t;return{c(){t=F(e)},l(l){t=J(l,e)},m(l,s){C(l,t,s)},p(l,s){s[0]&33554432&&e!==(e=l[25].t("Generating search query")+"")&&K(t,e)},d(l){l&&m(t)}}}function Ba(r){let e=r[25].t("No search query generated")+"",t;return{c(){t=F(e)},l(l){t=J(l,e)},m(l,s){C(l,t,s)},p(l,s){s[0]&33554432&&e!==(e=l[25].t("No search query generated")+"")&&K(t,e)},d(l){l&&m(t)}}}function Sa(r){var l,s;let e=r[25].t((l=r[90])==null?void 0:l.description,{count:(s=r[90])==null?void 0:s.urls.length})+"",t;return{c(){t=F(e)},l(n){t=J(n,e)},m(n,i){C(n,t,i)},p(n,i){var o,a;i[0]&33554433&&e!==(e=n[25].t((o=n[90])==null?void 0:o.description,{count:(a=n[90])==null?void 0:a.urls.length})+"")&&K(t,e)},d(n){n&&m(t)}}}function Ra(r){let e,t,l,s;function n(a,f){var u,d,g;return f[0]&1&&(l=null),l==null&&(l=!!((u=a[90])!=null&&u.description.includes("{{count}}"))),l?Sa:((d=a[90])==null?void 0:d.description)==="No search query generated"?Ba:((g=a[90])==null?void 0:g.description)==="Generating search query"?Ta:Ca}let i=n(r,[-1,-1,-1,-1]),o=i(r);return{c(){e=I("div"),t=I("div"),o.c(),this.h()},l(a){e=M(a,"DIV",{class:!0});var f=y(e);t=M(f,"DIV",{class:!0});var u=y(t);o.l(u),u.forEach(m),f.forEach(m),this.h()},h(){var a;c(t,"class",s=(((a=r[90])==null?void 0:a.done)===!1?"shimmer":"")+" text-base line-clamp-1 text-wrap"),c(e,"class","flex flex-col justify-center -space-y-0.5")},m(a,f){C(a,e,f),_(e,t),o.m(t,null)},p(a,f){var u;i===(i=n(a,f))&&o?o.p(a,f):(o.d(1),o=i(a),o&&(o.c(),o.m(t,null))),f[0]&1&&s!==(s=(((u=a[90])==null?void 0:u.done)===!1?"shimmer":"")+" text-base line-clamp-1 text-wrap")&&c(t,"class",s)},d(a){a&&m(e),o.d()}}}function La(r){let e,t,l,s;const n=[Ha,Aa],i=[];function o(a,f){return a[0].content===""&&!a[0].error?0:a[0].content&&a[0].error!==!0?1:-1}return~(t=o(r))&&(l=i[t]=n[t](r)),{c(){e=I("div"),l&&l.c(),this.h()},l(a){e=M(a,"DIV",{class:!0,id:!0});var f=y(e);l&&l.l(f),f.forEach(m),this.h()},h(){c(e,"class","w-full flex flex-col relative"),c(e,"id","response-content-container")},m(a,f){C(a,e,f),~t&&i[t].m(e,null),s=!0},p(a,f){let u=t;t=o(a),t===u?~t&&i[t].p(a,f):(l&&(te(),V(i[u],1,1,()=>{i[u]=null}),le()),~t?(l=i[t],l?l.p(a,f):(l=i[t]=n[t](a),l.c()),w(l,1),l.m(e,null)):l=null)},i(a){s||(w(l),s=!0)},o(a){V(l),s=!1},d(a){a&&m(e),~t&&i[t].d()}}}function Oa(r){let e,t,l,s,n,i,o,a=r[25].t("Save As Copy")+"",f,u,d,g,h=r[25].t("Cancel")+"",p,D,v,E=r[25].t("Save")+"",b,R,A;return{c(){e=I("div"),t=I("textarea"),s=P(),n=I("div"),i=I("div"),o=I("button"),f=F(a),u=P(),d=I("div"),g=I("button"),p=F(h),D=P(),v=I("button"),b=F(E),this.h()},l(N){e=M(N,"DIV",{class:!0});var k=y(e);t=M(k,"TEXTAREA",{id:!0,class:!0}),y(t).forEach(m),s=j(k),n=M(k,"DIV",{class:!0});var B=y(n);i=M(B,"DIV",{});var S=y(i);o=M(S,"BUTTON",{id:!0,class:!0});var T=y(o);f=J(T,a),T.forEach(m),S.forEach(m),u=j(B),d=M(B,"DIV",{class:!0});var H=y(d);g=M(H,"BUTTON",{id:!0,class:!0});var L=y(g);p=J(L,h),L.forEach(m),D=j(H),v=M(H,"BUTTON",{id:!0,class:!0});var q=y(v);b=J(q,E),q.forEach(m),H.forEach(m),B.forEach(m),k.forEach(m),this.h()},h(){c(t,"id",l="message-edit-"+r[0].id),c(t,"class","bg-transparent outline-hidden w-full resize-none"),c(o,"id","save-new-message-button"),c(o,"class","px-4 py-2 bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 border dark:border-gray-700 text-gray-700 dark:text-gray-200 transition rounded-3xl"),c(g,"id","close-edit-message-button"),c(g,"class","px-4 py-2 bg-white dark:bg-gray-900 hover:bg-gray-100 text-gray-800 dark:text-gray-100 transition rounded-3xl"),c(v,"id","confirm-edit-message-button"),c(v,"class","px-4 py-2 bg-gray-900 dark:bg-white hover:bg-gray-850 text-gray-100 dark:text-gray-800 transition rounded-3xl"),c(d,"class","flex space-x-1.5"),c(n,"class","mt-2 mb-1 flex justify-between text-sm font-medium"),c(e,"class","w-full bg-gray-50 dark:bg-gray-800 rounded-3xl px-5 py-3 my-2")},m(N,k){C(N,e,k),_(e,t),r[50](t),nt(t,r[15]),_(e,s),_(e,n),_(n,i),_(i,o),_(o,f),_(n,u),_(n,d),_(d,g),_(g,p),_(d,D),_(d,v),_(v,b),R||(A=[me(t,"input",r[51]),me(t,"input",go),me(t,"keydown",r[52]),me(o,"click",r[53]),me(g,"click",r[54]),me(v,"click",r[55])],R=!0)},p(N,k){k[0]&1&&l!==(l="message-edit-"+N[0].id)&&c(t,"id",l),k[0]&32768&&nt(t,N[15]),k[0]&33554432&&a!==(a=N[25].t("Save As Copy")+"")&&K(f,a),k[0]&33554432&&h!==(h=N[25].t("Cancel")+"")&&K(p,h),k[0]&33554432&&E!==(E=N[25].t("Save")+"")&&K(b,E)},i:ge,o:ge,d(N){N&&m(e),r[50](null),R=!1,et(A)}}}function Aa(r){var p,D,v,E,b,R,A;let e,t,l,s,n,i,o;const a=[qa,ja,Pa],f=[];function u(N,k){return N[0].isLoading?0:N[22].isAgent?1:2}e=u(r),t=f[e]=a[e](r);let d=((p=r[0])==null?void 0:p.error)&&r[0].error!==!0&&hs(r),g=(((D=r[0])==null?void 0:D.sources)||((v=r[0])==null?void 0:v.citations))&&(((A=(R=(b=(E=r[14])==null?void 0:E.info)==null?void 0:b.meta)==null?void 0:R.capabilities)==null?void 0:A.citations)??!0)&&ms(r),h=r[0].code_executions&&gs(r);return{c(){t.c(),l=P(),d&&d.c(),s=P(),g&&g.c(),n=P(),h&&h.c(),i=ae()},l(N){t.l(N),l=j(N),d&&d.l(N),s=j(N),g&&g.l(N),n=j(N),h&&h.l(N),i=ae()},m(N,k){f[e].m(N,k),C(N,l,k),d&&d.m(N,k),C(N,s,k),g&&g.m(N,k),C(N,n,k),h&&h.m(N,k),C(N,i,k),o=!0},p(N,k){var S,T,H,L,q,z,ee;let B=e;e=u(N),e===B?f[e].p(N,k):(te(),V(f[B],1,1,()=>{f[B]=null}),le(),t=f[e],t?t.p(N,k):(t=f[e]=a[e](N),t.c()),w(t,1),t.m(l.parentNode,l)),(S=N[0])!=null&&S.error&&N[0].error!==!0?d?(d.p(N,k),k[0]&1&&w(d,1)):(d=hs(N),d.c(),w(d,1),d.m(s.parentNode,s)):d&&(te(),V(d,1,1,()=>{d=null}),le()),((T=N[0])!=null&&T.sources||(H=N[0])!=null&&H.citations)&&(((ee=(z=(q=(L=N[14])==null?void 0:L.info)==null?void 0:q.meta)==null?void 0:z.capabilities)==null?void 0:ee.citations)??!0)?g?(g.p(N,k),k[0]&16385&&w(g,1)):(g=ms(N),g.c(),w(g,1),g.m(n.parentNode,n)):g&&(te(),V(g,1,1,()=>{g=null}),le()),N[0].code_executions?h?(h.p(N,k),k[0]&1&&w(h,1)):(h=gs(N),h.c(),w(h,1),h.m(i.parentNode,i)):h&&(te(),V(h,1,1,()=>{h=null}),le())},i(N){o||(w(t),w(d),w(g),w(h),o=!0)},o(N){V(t),V(d),V(g),V(h),o=!1},d(N){N&&(m(l),m(s),m(n),m(i)),f[e].d(N),d&&d.d(N),g&&g.d(N),h&&h.d(N)}}}function Ha(r){let e,t;return e=new Qt({}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p:ge,i(l){t||(w(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Pa(r){var l;let e,t;return e=new Sr({props:{id:r[0].id,history:r[1],content:r[0].content,sources:r[0].sources,floatingButtons:(l=r[0])==null?void 0:l.done,save:!r[10],model:r[14],onTaskClick:r[62],onSourceClick:r[63],onAddMessages:r[64]}}),e.$on("update",r[65]),{c(){Y(e.$$.fragment)},l(s){X(e.$$.fragment,s)},m(s,n){$(e,s,n),t=!0},p(s,n){var o;const i={};n[0]&1&&(i.id=s[0].id),n[0]&2&&(i.history=s[1]),n[0]&1&&(i.content=s[0].content),n[0]&1&&(i.sources=s[0].sources),n[0]&1&&(i.floatingButtons=(o=s[0])==null?void 0:o.done),n[0]&1024&&(i.save=!s[10]),n[0]&16384&&(i.model=s[14]),n[0]&1&&(i.onSourceClick=s[63]),n[0]&256&&(i.onAddMessages=s[64]),e.$set(i)},i(s){t||(w(e.$$.fragment,s),t=!0)},o(s){V(e.$$.fragment,s),t=!1},d(s){x(e,s)}}}function ja(r){let e,t,l,s;const n=[Fa,Wa,Ua,za],i=[];function o(a,f){var u,d;return(a[22].type==="query_result"||a[22].data.type==="query_result")&&(a[22].data.results||(u=a[22].data.response)!=null&&u.results)?0:(a[22].type==="query_chart"||a[22].data.type==="query_chart")&&((d=a[22].data.response)!=null&&d.chart_url)?1:a[22].type==="chart"&&a[22].data.response.chart_url?2:3}return e=o(r),t=i[e]=n[e](r),{c(){t.c(),l=ae()},l(a){t.l(a),l=ae()},m(a,f){i[e].m(a,f),C(a,l,f),s=!0},p(a,f){let u=e;e=o(a),e===u?i[e].p(a,f):(te(),V(i[u],1,1,()=>{i[u]=null}),le(),t=i[e],t?t.p(a,f):(t=i[e]=n[e](a),t.c()),w(t,1),t.m(l.parentNode,l))},i(a){s||(w(t),s=!0)},o(a){V(t),s=!1},d(a){a&&m(l),i[e].d(a)}}}function qa(r){let e,t,l,s='<span class="svelte-wlev50"></span> <span class="svelte-wlev50"></span> <span class="svelte-wlev50"></span>',n,i,o=r[0].content+"",a;return{c(){e=I("div"),t=I("div"),l=I("div"),l.innerHTML=s,n=P(),i=I("div"),a=F(o),this.h()},l(f){e=M(f,"DIV",{class:!0});var u=y(e);t=M(u,"DIV",{class:!0});var d=y(t);l=M(d,"DIV",{class:!0,"data-svelte-h":!0}),Te(l)!=="svelte-1b5cdcg"&&(l.innerHTML=s),n=j(d),i=M(d,"DIV",{class:!0});var g=y(i);a=J(g,o),g.forEach(m),d.forEach(m),u.forEach(m),this.h()},h(){c(l,"class","typing-animation mr-1 svelte-wlev50"),c(i,"class","agent-loading-text svelte-wlev50"),c(t,"class","flex items-center"),c(e,"class","agent-loading-animation svelte-wlev50")},m(f,u){C(f,e,u),_(e,t),_(t,l),_(t,n),_(t,i),_(i,a)},p(f,u){u[0]&1&&o!==(o=f[0].content+"")&&K(a,o)},i:ge,o:ge,d(f){f&&m(e)}}}function za(r){var l;let e,t;return e=new Sr({props:{id:r[0].id,history:r[1],content:r[22].isAgent?r[22].content:r[0].content,sources:r[0].sources,floatingButtons:(l=r[0])==null?void 0:l.done,save:!r[10],model:r[14],onTaskClick:r[58],onSourceClick:r[59],onAddMessages:r[60]}}),e.$on("update",r[61]),{c(){Y(e.$$.fragment)},l(s){X(e.$$.fragment,s)},m(s,n){$(e,s,n),t=!0},p(s,n){var o;const i={};n[0]&1&&(i.id=s[0].id),n[0]&2&&(i.history=s[1]),n[0]&4194305&&(i.content=s[22].isAgent?s[22].content:s[0].content),n[0]&1&&(i.sources=s[0].sources),n[0]&1&&(i.floatingButtons=(o=s[0])==null?void 0:o.done),n[0]&1024&&(i.save=!s[10]),n[0]&16384&&(i.model=s[14]),n[0]&1&&(i.onSourceClick=s[59]),n[0]&256&&(i.onAddMessages=s[60]),e.$set(i)},i(s){t||(w(e.$$.fragment,s),t=!0)},o(s){V(e.$$.fragment,s),t=!1},d(s){x(e,s)}}}function Ua(r){let e,t,l=r[22].content+"",s,n,i,o;return{c(){e=I("div"),t=I("div"),s=F(l),n=P(),i=I("img"),this.h()},l(a){e=M(a,"DIV",{class:!0});var f=y(e);t=M(f,"DIV",{class:!0});var u=y(t);s=J(u,l),u.forEach(m),n=j(f),i=M(f,"IMG",{src:!0,alt:!0,class:!0}),f.forEach(m),this.h()},h(){c(t,"class","mb-2"),it(i.src,o=r[22].data.response.chart_url)||c(i,"src",o),c(i,"alt","Chart"),c(i,"class","max-w-full h-auto border dark:border-gray-700 rounded"),c(e,"class","agent-chart py-2")},m(a,f){C(a,e,f),_(e,t),_(t,s),_(e,n),_(e,i)},p(a,f){f[0]&4194304&&l!==(l=a[22].content+"")&&K(s,l),f[0]&4194304&&!it(i.src,o=a[22].data.response.chart_url)&&c(i,"src",o)},i:ge,o:ge,d(a){a&&m(e)}}}function Wa(r){var T,H,L;let e,t,l=r[22].content+"",s,n,i,o,a,f,u,d,g,h,p,D,v,E,b,R,A,N,k,B=((T=r[22].data.results)==null?void 0:T.records)&&us(r),S=(((H=r[22].data.results)==null?void 0:H.sql_query)||((L=r[22].data.metadata)==null?void 0:L.sql_query))&&cs(r);return{c(){e=I("div"),t=I("div"),s=F(l),n=P(),i=I("div"),o=I("div"),a=I("a"),f=_e("svg"),u=_e("path"),g=P(),h=I("a"),p=_e("svg"),D=_e("path"),E=P(),b=I("img"),A=P(),B&&B.c(),N=P(),S&&S.c(),this.h()},l(q){e=M(q,"DIV",{class:!0});var z=y(e);t=M(z,"DIV",{class:!0});var ee=y(t);s=J(ee,l),ee.forEach(m),n=j(z),i=M(z,"DIV",{class:!0});var G=y(i);o=M(G,"DIV",{class:!0});var Q=y(o);a=M(Q,"A",{href:!0,download:!0,target:!0,class:!0,title:!0});var ue=y(a);f=ve(ue,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var fe=y(f);u=ve(fe,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),y(u).forEach(m),fe.forEach(m),ue.forEach(m),g=j(Q),h=M(Q,"A",{href:!0,target:!0,class:!0,title:!0});var ke=y(h);p=ve(ke,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var de=y(p);D=ve(de,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),y(D).forEach(m),de.forEach(m),ke.forEach(m),Q.forEach(m),E=j(G),b=M(G,"IMG",{src:!0,alt:!0,class:!0}),G.forEach(m),A=j(z),B&&B.l(z),N=j(z),S&&S.l(z),z.forEach(m),this.h()},h(){c(t,"class","mb-3 text-gray-700 dark:text-gray-300"),c(u,"stroke-linecap","round"),c(u,"stroke-linejoin","round"),c(u,"d","M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"),c(f,"xmlns","http://www.w3.org/2000/svg"),c(f,"fill","none"),c(f,"viewBox","0 0 24 24"),c(f,"stroke-width","1.5"),c(f,"stroke","currentColor"),c(f,"class","w-4 h-4"),c(a,"href",d=r[22].data.response.chart_url),c(a,"download","chart.png"),c(a,"target","_blank"),c(a,"class","p-1.5 bg-gray-100/80 dark:bg-gray-700/80 backdrop-blur-sm rounded shadow-sm hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors"),c(a,"title","Download chart"),c(D,"stroke-linecap","round"),c(D,"stroke-linejoin","round"),c(D,"d","M13.5 6H5.25A2.25 2.25 0 003 8.25v10.5A2.25 2.25 0 005.25 21h10.5A2.25 2.25 0 0018 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"),c(p,"xmlns","http://www.w3.org/2000/svg"),c(p,"fill","none"),c(p,"viewBox","0 0 24 24"),c(p,"stroke-width","1.5"),c(p,"stroke","currentColor"),c(p,"class","w-4 h-4"),c(h,"href",v=r[22].data.response.chart_url),c(h,"target","_blank"),c(h,"class","p-1.5 bg-gray-100/80 dark:bg-gray-700/80 backdrop-blur-sm rounded shadow-sm hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors"),c(h,"title","Open in new tab"),c(o,"class","absolute top-2 right-2 flex gap-2 z-10"),it(b.src,R=r[22].data.response.chart_url)||c(b,"src",R),c(b,"alt","Data visualization chart"),c(b,"class","max-w-full h-auto border border-gray-200 dark:border-gray-700 rounded-lg shadow-sm"),c(i,"class","mb-4 relative"),c(e,"class","agent-query-chart py-3")},m(q,z){C(q,e,z),_(e,t),_(t,s),_(e,n),_(e,i),_(i,o),_(o,a),_(a,f),_(f,u),_(o,g),_(o,h),_(h,p),_(p,D),_(i,E),_(i,b),_(e,A),B&&B.m(e,null),_(e,N),S&&S.m(e,null),k=!0},p(q,z){var ee,G,Q;(!k||z[0]&4194304)&&l!==(l=q[22].content+"")&&K(s,l),(!k||z[0]&4194304&&d!==(d=q[22].data.response.chart_url))&&c(a,"href",d),(!k||z[0]&4194304&&v!==(v=q[22].data.response.chart_url))&&c(h,"href",v),(!k||z[0]&4194304&&!it(b.src,R=q[22].data.response.chart_url))&&c(b,"src",R),(ee=q[22].data.results)!=null&&ee.records?B?(B.p(q,z),z[0]&4194304&&w(B,1)):(B=us(q),B.c(),w(B,1),B.m(e,N)):B&&(te(),V(B,1,1,()=>{B=null}),le()),(G=q[22].data.results)!=null&&G.sql_query||(Q=q[22].data.metadata)!=null&&Q.sql_query?S?S.p(q,z):(S=cs(q),S.c(),S.m(e,null)):S&&(S.d(1),S=null)},i(q){k||(w(B),k=!0)},o(q){V(B),k=!1},d(q){q&&m(e),B&&B.d(),S&&S.d()}}}function Fa(r){var R,A;let e,t,l=r[22].content+"",s,n,i,o,a=`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M3.375 19.5h17.25m-17.25 0a1.125 1.125 0 0 1-1.125-1.125M3.375 19.5h7.5c.621 0 1.125-.504 1.125-1.125m-9.75 0V5.625m0 12.75v-1.5c0-.621.504-1.125 1.125-1.125m18.375 2.625V5.625m0 12.75c0 .621-.504 1.125-1.125 1.125m1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125m0 3.75h-7.5A1.125 1.125 0 0 1 12 18.375m9.75-12.75c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125m19.5 0v1.5c0 .621-.504 1.125-1.125 1.125M2.25 5.625v1.5c0 .621.504 1.125 1.125 1.125m0 0h17.25m-17.25 0h7.5c.621 0 1.125.504 1.125 1.125M3.375 8.25c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125m1.125-3.75h7.5c.621 0 1.125.504 1.125 1.125m-9.75 0h9.75"></path></svg>
														Data Table`,f,u,d,g,h,p;const D=[Ga,Ja],v=[];function E(N,k){var B;return N[22].data.results?0:(B=N[22].data.response)!=null&&B.results?1:-1}~(d=E(r))&&(g=v[d]=D[d](r));let b=(((R=r[22].data.results)==null?void 0:R.sql_query)||((A=r[22].data.metadata)==null?void 0:A.sql_query))&&ds(r);return{c(){e=I("div"),t=I("div"),s=F(l),n=P(),i=I("div"),o=I("div"),o.innerHTML=a,f=P(),u=I("div"),g&&g.c(),h=P(),b&&b.c(),this.h()},l(N){e=M(N,"DIV",{class:!0});var k=y(e);t=M(k,"DIV",{class:!0});var B=y(t);s=J(B,l),B.forEach(m),n=j(k),i=M(k,"DIV",{class:!0});var S=y(i);o=M(S,"DIV",{class:!0,"data-svelte-h":!0}),Te(o)!=="svelte-10hd957"&&(o.innerHTML=a),f=j(S),u=M(S,"DIV",{class:!0});var T=y(u);g&&g.l(T),T.forEach(m),S.forEach(m),h=j(k),b&&b.l(k),k.forEach(m),this.h()},h(){c(t,"class","mb-4 text-gray-700 dark:text-gray-300"),c(o,"class","flex items-center gap-2 font-medium text-gray-700 dark:text-gray-300 mb-2"),c(u,"class","overflow-x-auto"),c(i,"class","mb-2"),c(e,"class","agent-query-results py-3")},m(N,k){C(N,e,k),_(e,t),_(t,s),_(e,n),_(e,i),_(i,o),_(i,f),_(i,u),~d&&v[d].m(u,null),_(e,h),b&&b.m(e,null),p=!0},p(N,k){var S,T;(!p||k[0]&4194304)&&l!==(l=N[22].content+"")&&K(s,l);let B=d;d=E(N),d===B?~d&&v[d].p(N,k):(g&&(te(),V(v[B],1,1,()=>{v[B]=null}),le()),~d?(g=v[d],g?g.p(N,k):(g=v[d]=D[d](N),g.c()),w(g,1),g.m(u,null)):g=null),(S=N[22].data.results)!=null&&S.sql_query||(T=N[22].data.metadata)!=null&&T.sql_query?b?b.p(N,k):(b=ds(N),b.c(),b.m(e,null)):b&&(b.d(1),b=null)},i(N){p||(w(g),p=!0)},o(N){V(g),p=!1},d(N){N&&m(e),~d&&v[d].d(),b&&b.d()}}}function us(r){let e,t,l=`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M3.375 19.5h17.25m-17.25 0a1.125 1.125 0 0 1-1.125-1.125M3.375 19.5h7.5c.621 0 1.125-.504 1.125-1.125m-9.75 0V5.625m0 12.75v-1.5c0-.621.504-1.125 1.125-1.125m18.375 2.625V5.625m0 12.75c0 .621-.504 1.125-1.125 1.125m1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125m0 3.75h-7.5A1.125 1.125 0 0 1 12 18.375m9.75-12.75c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125m19.5 0v1.5c0 .621-.504 1.125-1.125 1.125M2.25 5.625v1.5c0 .621.504 1.125 1.125 1.125m0 0h17.25m-17.25 0h7.5c.621 0 1.125.504 1.125 1.125M3.375 8.25c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125m1.125-3.75h7.5c.621 0 1.125.504 1.125 1.125m-9.75 0h9.75"></path></svg>
															Data Table`,s,n,i,o;return i=new Kt({props:{data:r[22].data.results.records,columns:r[22].data.results.columns,className:"border w-full table-improved",maxPreviewRows:12}}),{c(){e=I("div"),t=I("div"),t.innerHTML=l,s=P(),n=I("div"),Y(i.$$.fragment),this.h()},l(a){e=M(a,"DIV",{class:!0});var f=y(e);t=M(f,"DIV",{class:!0,"data-svelte-h":!0}),Te(t)!=="svelte-h22r7a"&&(t.innerHTML=l),s=j(f),n=M(f,"DIV",{class:!0});var u=y(n);X(i.$$.fragment,u),u.forEach(m),f.forEach(m),this.h()},h(){c(t,"class","flex items-center gap-2 font-medium text-gray-700 dark:text-gray-300 mb-2"),c(n,"class","overflow-x-auto"),c(e,"class","mt-4 mb-2")},m(a,f){C(a,e,f),_(e,t),_(e,s),_(e,n),$(i,n,null),o=!0},p(a,f){const u={};f[0]&4194304&&(u.data=a[22].data.results.records),f[0]&4194304&&(u.columns=a[22].data.results.columns),i.$set(u)},i(a){o||(w(i.$$.fragment,a),o=!0)},o(a){V(i.$$.fragment,a),o=!1},d(a){a&&m(e),x(i)}}}function cs(r){var R,A;let e,t,l,s=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" class="w-4 h-4" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"></path></svg>
																SQL Query`,n,i,o=`<div class="flex items-center gap-1"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-3.5 h-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg>
																	Copy</div>`,a,f,u,d,g,h=(((R=r[22].data.results)==null?void 0:R.sql_query)||((A=r[22].data.metadata)==null?void 0:A.sql_query))+"",p,D,v,E,b;return{c(){e=I("div"),t=I("div"),l=I("div"),l.innerHTML=s,n=P(),i=I("button"),i.innerHTML=o,a=P(),f=I("pre"),u=F("															"),d=I("code"),g=F(`
`),p=F(h),D=F(`
															`),v=F(`
														`),this.h()},l(N){e=M(N,"DIV",{class:!0});var k=y(e);t=M(k,"DIV",{class:!0});var B=y(t);l=M(B,"DIV",{class:!0,"data-svelte-h":!0}),Te(l)!=="svelte-5npp6j"&&(l.innerHTML=s),n=j(B),i=M(B,"BUTTON",{class:!0,"data-svelte-h":!0}),Te(i)!=="svelte-yiav4"&&(i.innerHTML=o),B.forEach(m),a=j(k),f=M(k,"PRE",{class:!0});var S=y(f);u=J(S,"															"),d=M(S,"CODE",{class:!0});var T=y(d);g=J(T,`
`),p=J(T,h),D=J(T,`
															`),T.forEach(m),v=J(S,`
														`),S.forEach(m),k.forEach(m),this.h()},h(){c(l,"class","font-medium text-gray-700 dark:text-gray-300 flex items-center gap-2"),c(i,"class","text-xs px-2 py-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-400 transition-colors"),c(t,"class","flex justify-between items-center mb-2"),c(d,"class","sql-syntax text-gray-800 dark:text-gray-200"),c(f,"class","bg-gray-50 dark:bg-gray-800/70 p-3 rounded-lg overflow-auto text-sm font-mono border border-gray-200 dark:border-gray-700 shadow-inner"),c(e,"class","mt-4 mb-2")},m(N,k){C(N,e,k),_(e,t),_(t,l),_(t,n),_(t,i),_(e,a),_(e,f),_(f,u),_(f,d),_(d,g),_(d,p),_(d,D),_(f,v),E||(b=me(i,"click",r[57]),E=!0)},p(N,k){var B,S;k[0]&4194304&&h!==(h=(((B=N[22].data.results)==null?void 0:B.sql_query)||((S=N[22].data.metadata)==null?void 0:S.sql_query))+"")&&K(p,h)},d(N){N&&m(e),E=!1,b()}}}function Ja(r){let e,t;return e=new Kt({props:{data:r[22].data.response.results.records,columns:r[22].data.response.results.columns,className:"border w-full table-improved"}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const n={};s[0]&4194304&&(n.data=l[22].data.response.results.records),s[0]&4194304&&(n.columns=l[22].data.response.results.columns),e.$set(n)},i(l){t||(w(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Ga(r){let e,t;return e=new Kt({props:{data:r[22].data.results.records,columns:r[22].data.results.columns,className:"border w-full table-improved"}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const n={};s[0]&4194304&&(n.data=l[22].data.results.records),s[0]&4194304&&(n.columns=l[22].data.results.columns),e.$set(n)},i(l){t||(w(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function ds(r){var R,A;let e,t,l,s=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" class="w-4 h-4" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"></path></svg>
																SQL Query`,n,i,o=`<div class="flex items-center gap-1"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-3.5 h-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg>
																	Copy</div>`,a,f,u,d,g,h=(((R=r[22].data.results)==null?void 0:R.sql_query)||((A=r[22].data.metadata)==null?void 0:A.sql_query))+"",p,D,v,E,b;return{c(){e=I("div"),t=I("div"),l=I("div"),l.innerHTML=s,n=P(),i=I("button"),i.innerHTML=o,a=P(),f=I("pre"),u=F("															"),d=I("code"),g=F(`
`),p=F(h),D=F(`
															`),v=F(`
														`),this.h()},l(N){e=M(N,"DIV",{class:!0});var k=y(e);t=M(k,"DIV",{class:!0});var B=y(t);l=M(B,"DIV",{class:!0,"data-svelte-h":!0}),Te(l)!=="svelte-5npp6j"&&(l.innerHTML=s),n=j(B),i=M(B,"BUTTON",{class:!0,"data-svelte-h":!0}),Te(i)!=="svelte-yiav4"&&(i.innerHTML=o),B.forEach(m),a=j(k),f=M(k,"PRE",{class:!0});var S=y(f);u=J(S,"															"),d=M(S,"CODE",{class:!0});var T=y(d);g=J(T,`
`),p=J(T,h),D=J(T,`
															`),T.forEach(m),v=J(S,`
														`),S.forEach(m),k.forEach(m),this.h()},h(){c(l,"class","font-medium text-gray-700 dark:text-gray-300 flex items-center gap-2"),c(i,"class","text-xs px-2 py-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-400 transition-colors"),c(t,"class","flex justify-between items-center mb-2"),c(d,"class","sql-syntax text-gray-800 dark:text-gray-200"),c(f,"class","bg-gray-50 dark:bg-gray-800/70 p-3 rounded-lg overflow-auto text-sm font-mono border border-gray-200 dark:border-gray-700 shadow-inner"),c(e,"class","mt-4 mb-2")},m(N,k){C(N,e,k),_(e,t),_(t,l),_(t,n),_(t,i),_(e,a),_(e,f),_(f,u),_(f,d),_(d,g),_(d,p),_(d,D),_(f,v),E||(b=me(i,"click",r[56]),E=!0)},p(N,k){var B,S;k[0]&4194304&&h!==(h=(((B=N[22].data.results)==null?void 0:B.sql_query)||((S=N[22].data.metadata)==null?void 0:S.sql_query))+"")&&K(p,h)},d(N){N&&m(e),E=!1,b()}}}function hs(r){let e,t;return e=new ci({props:{content:r[0].error.content}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const n={};s[0]&1&&(n.content=l[0].error.content),e.$set(n)},i(l){t||(w(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function ms(r){var l,s,n;let e,t;return e=new Pi({props:{id:(l=r[0])==null?void 0:l.id,sources:((s=r[0])==null?void 0:s.sources)??((n=r[0])==null?void 0:n.citations)}}),{c(){Y(e.$$.fragment)},l(i){X(e.$$.fragment,i)},m(i,o){$(e,i,o),t=!0},p(i,o){var f,u,d;const a={};o[0]&1&&(a.id=(f=i[0])==null?void 0:f.id),o[0]&1&&(a.sources=((u=i[0])==null?void 0:u.sources)??((d=i[0])==null?void 0:d.citations)),e.$set(a)},i(i){t||(w(e.$$.fragment,i),t=!0)},o(i){V(e.$$.fragment,i),t=!1},d(i){x(e,i)}}}function gs(r){var l;let e,t;return e=new ta({props:{id:(l=r[0])==null?void 0:l.id,code_executions:r[0].code_executions}}),{c(){Y(e.$$.fragment)},l(s){X(e.$$.fragment,s)},m(s,n){$(e,s,n),t=!0},p(s,n){var o;const i={};n[0]&1&&(i.id=(o=s[0])==null?void 0:o.id),n[0]&1&&(i.code_executions=s[0].code_executions),e.$set(i)},i(s){t||(w(e.$$.fragment,s),t=!0)},o(s){V(e.$$.fragment,s),t=!1},d(s){x(e,s)}}}function _s(r){let e,t,l,s,n=(r[0].done||r[2].length>1)&&vs(r),i=r[0].done&&r[20]&&Ts(r);return{c(){e=I("div"),n&&n.c(),t=P(),i&&i.c(),l=ae(),this.h()},l(o){e=M(o,"DIV",{class:!0});var a=y(e);n&&n.l(a),a.forEach(m),t=j(o),i&&i.l(o),l=ae(),this.h()},h(){c(e,"class","flex justify-start overflow-x-auto buttons text-gray-600 dark:text-gray-500 mt-0.5 svelte-wlev50")},m(o,a){C(o,e,a),n&&n.m(e,null),r[79](e),C(o,t,a),i&&i.m(o,a),C(o,l,a),s=!0},p(o,a){o[0].done||o[2].length>1?n?(n.p(o,a),a[0]&5&&w(n,1)):(n=vs(o),n.c(),w(n,1),n.m(e,null)):n&&(te(),V(n,1,1,()=>{n=null}),le()),o[0].done&&o[20]?i?(i.p(o,a),a[0]&1048577&&w(i,1)):(i=Ts(o),i.c(),w(i,1),i.m(l.parentNode,l)):i&&(te(),V(i,1,1,()=>{i=null}),le())},i(o){s||(w(n),w(i),s=!0)},o(o){V(n),V(i),s=!1},d(o){o&&(m(e),m(t),m(l)),n&&n.d(),r[79](null),i&&i.d(o)}}}function vs(r){let e,t,l,s=r[2].length>1&&ps(r),n=r[0].done&&bs(r);return{c(){s&&s.c(),e=P(),n&&n.c(),t=ae()},l(i){s&&s.l(i),e=j(i),n&&n.l(i),t=ae()},m(i,o){s&&s.m(i,o),C(i,e,o),n&&n.m(i,o),C(i,t,o),l=!0},p(i,o){i[2].length>1?s?s.p(i,o):(s=ps(i),s.c(),s.m(e.parentNode,e)):s&&(s.d(1),s=null),i[0].done?n?(n.p(i,o),o[0]&1&&w(n,1)):(n=bs(i),n.c(),w(n,1),n.m(t.parentNode,t)):n&&(te(),V(n,1,1,()=>{n=null}),le())},i(i){l||(w(n),l=!0)},o(i){V(n),l=!1},d(i){i&&(m(e),m(t)),s&&s.d(i),n&&n.d(i)}}}function ps(r){let e,t,l='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg>',s,n,i=r[2].indexOf(r[0].id)+1+"",o,a,f=r[2].length+"",u,d,g,h='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5"></path></svg>',p,D;return{c(){e=I("div"),t=I("button"),t.innerHTML=l,s=P(),n=I("div"),o=F(i),a=F("/"),u=F(f),d=P(),g=I("button"),g.innerHTML=h,this.h()},l(v){e=M(v,"DIV",{class:!0,dir:!0});var E=y(e);t=M(E,"BUTTON",{class:!0,"data-svelte-h":!0}),Te(t)!=="svelte-1e0chv1"&&(t.innerHTML=l),s=j(E),n=M(E,"DIV",{class:!0});var b=y(n);o=J(b,i),a=J(b,"/"),u=J(b,f),b.forEach(m),d=j(E),g=M(E,"BUTTON",{class:!0,"data-svelte-h":!0}),Te(g)!=="svelte-107ksnk"&&(g.innerHTML=h),E.forEach(m),this.h()},h(){c(t,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),c(n,"class","text-sm tracking-widest font-semibold self-center dark:text-gray-100 min-w-fit"),c(g,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),c(e,"class","flex self-center min-w-fit"),c(e,"dir","ltr")},m(v,E){C(v,e,E),_(e,t),_(e,s),_(e,n),_(n,o),_(n,a),_(n,u),_(e,d),_(e,g),p||(D=[me(t,"click",r[66]),me(g,"click",r[67])],p=!0)},p(v,E){E[0]&5&&i!==(i=v[2].indexOf(v[0].id)+1+"")&&K(o,i),E[0]&4&&f!==(f=v[2].length+"")&&K(u,f)},d(v){v&&m(e),p=!1,et(D)}}}function bs(r){var p,D,v,E;let e,t,l,s,n,i,o,a,f,u=!r[10]&&ks(r);t=new Be({props:{content:r[25].t("Copy"),placement:"bottom",$$slots:{default:[Qa]},$$scope:{ctx:r}}}),s=new Be({props:{content:r[25].t("Read Aloud"),placement:"bottom",$$slots:{default:[$a]},$$scope:{ctx:r}}});let d=((p=r[24])==null?void 0:p.features.enable_image_generation)&&(r[26].role==="admin"||((E=(v=(D=r[26])==null?void 0:D.permissions)==null?void 0:v.features)==null?void 0:E.image_generation))&&!r[10]&&ys(r),g=r[0].usage&&Is(r),h=!r[10]&&Ms(r);return{c(){u&&u.c(),e=P(),Y(t.$$.fragment),l=P(),Y(s.$$.fragment),n=P(),d&&d.c(),i=P(),g&&g.c(),o=P(),h&&h.c(),a=ae()},l(b){u&&u.l(b),e=j(b),X(t.$$.fragment,b),l=j(b),X(s.$$.fragment,b),n=j(b),d&&d.l(b),i=j(b),g&&g.l(b),o=j(b),h&&h.l(b),a=ae()},m(b,R){u&&u.m(b,R),C(b,e,R),$(t,b,R),C(b,l,R),$(s,b,R),C(b,n,R),d&&d.m(b,R),C(b,i,R),g&&g.m(b,R),C(b,o,R),h&&h.m(b,R),C(b,a,R),f=!0},p(b,R){var k,B,S,T;b[10]?u&&(te(),V(u,1,1,()=>{u=null}),le()):u?(u.p(b,R),R[0]&1024&&w(u,1)):(u=ks(b),u.c(),w(u,1),u.m(e.parentNode,e));const A={};R[0]&33554432&&(A.content=b[25].t("Copy")),R[0]&513|R[3]&2&&(A.$$scope={dirty:R,ctx:b}),t.$set(A);const N={};R[0]&33554432&&(N.content=b[25].t("Read Aloud")),R[0]&393729|R[3]&2&&(N.$$scope={dirty:R,ctx:b}),s.$set(N),(k=b[24])!=null&&k.features.enable_image_generation&&(b[26].role==="admin"||(T=(S=(B=b[26])==null?void 0:B.permissions)==null?void 0:S.features)!=null&&T.image_generation)&&!b[10]?d?(d.p(b,R),R[0]&83887104&&w(d,1)):(d=ys(b),d.c(),w(d,1),d.m(i.parentNode,i)):d&&(te(),V(d,1,1,()=>{d=null}),le()),b[0].usage?g?(g.p(b,R),R[0]&1&&w(g,1)):(g=Is(b),g.c(),w(g,1),g.m(o.parentNode,o)):g&&(te(),V(g,1,1,()=>{g=null}),le()),b[10]?h&&(te(),V(h,1,1,()=>{h=null}),le()):h?(h.p(b,R),R[0]&1024&&w(h,1)):(h=Ms(b),h.c(),w(h,1),h.m(a.parentNode,a))},i(b){f||(w(u),w(t.$$.fragment,b),w(s.$$.fragment,b),w(d),w(g),w(h),f=!0)},o(b){V(u),V(t.$$.fragment,b),V(s.$$.fragment,b),V(d),V(g),V(h),f=!1},d(b){b&&(m(e),m(l),m(n),m(i),m(o),m(a)),u&&u.d(b),x(t,b),x(s,b),d&&d.d(b),g&&g.d(b),h&&h.d(b)}}}function ks(r){var s,n,i;let e,t,l=(r[26].role==="user"?((i=(n=(s=r[26])==null?void 0:s.permissions)==null?void 0:n.chat)==null?void 0:i.edit)??!0:!0)&&ws(r);return{c(){l&&l.c(),e=ae()},l(o){l&&l.l(o),e=ae()},m(o,a){l&&l.m(o,a),C(o,e,a),t=!0},p(o,a){var f,u,d;o[26].role!=="user"||(((d=(u=(f=o[26])==null?void 0:f.permissions)==null?void 0:u.chat)==null?void 0:d.edit)??!0)?l?(l.p(o,a),a[0]&67108864&&w(l,1)):(l=ws(o),l.c(),w(l,1),l.m(e.parentNode,e)):l&&(te(),V(l,1,1,()=>{l=null}),le())},i(o){t||(w(l),t=!0)},o(o){V(l),t=!1},d(o){o&&m(e),l&&l.d(o)}}}function ws(r){let e,t;return e=new Be({props:{content:r[25].t("Edit"),placement:"bottom",$$slots:{default:[Ka]},$$scope:{ctx:r}}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const n={};s[0]&33554432&&(n.content=l[25].t("Edit")),s[0]&512|s[3]&2&&(n.$$scope={dirty:s,ctx:l}),e.$set(n)},i(l){t||(w(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Ka(r){let e,t,l,s,n,i;return{c(){e=I("button"),t=_e("svg"),l=_e("path"),this.h()},l(o){e=M(o,"BUTTON",{class:!0});var a=y(e);t=ve(a,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var f=y(t);l=ve(f,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),y(l).forEach(m),f.forEach(m),a.forEach(m),this.h()},h(){c(l,"stroke-linecap","round"),c(l,"stroke-linejoin","round"),c(l,"d","M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"),c(t,"xmlns","http://www.w3.org/2000/svg"),c(t,"fill","none"),c(t,"viewBox","0 0 24 24"),c(t,"stroke-width","2.3"),c(t,"stroke","currentColor"),c(t,"class","w-4 h-4"),c(e,"class",s=(r[9]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(o,a){C(o,e,a),_(e,t),_(t,l),n||(i=me(e,"click",r[68]),n=!0)},p(o,a){a[0]&512&&s!==(s=(o[9]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")&&c(e,"class",s)},d(o){o&&m(e),n=!1,i()}}}function Qa(r){let e,t,l,s,n,i;return{c(){e=I("button"),t=_e("svg"),l=_e("path"),this.h()},l(o){e=M(o,"BUTTON",{class:!0});var a=y(e);t=ve(a,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var f=y(t);l=ve(f,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),y(l).forEach(m),f.forEach(m),a.forEach(m),this.h()},h(){c(l,"stroke-linecap","round"),c(l,"stroke-linejoin","round"),c(l,"d","M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184"),c(t,"xmlns","http://www.w3.org/2000/svg"),c(t,"fill","none"),c(t,"viewBox","0 0 24 24"),c(t,"stroke-width","2.3"),c(t,"stroke","currentColor"),c(t,"class","w-4 h-4"),c(e,"class",s=(r[9]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition copy-response-button")},m(o,a){C(o,e,a),_(e,t),_(t,l),n||(i=me(e,"click",r[69]),n=!0)},p(o,a){a[0]&512&&s!==(s=(o[9]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition copy-response-button")&&c(e,"class",s)},d(o){o&&m(e),n=!1,i()}}}function Za(r){let e,t;return{c(){e=_e("svg"),t=_e("path"),this.h()},l(l){e=ve(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=y(e);t=ve(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),y(t).forEach(m),s.forEach(m),this.h()},h(){c(t,"stroke-linecap","round"),c(t,"stroke-linejoin","round"),c(t,"d","M19.114 5.636a9 9 0 010 12.728M16.463 8.288a5.25 5.25 0 010 7.424M6.75 8.25l4.72-4.72a.75.75 0 0 1 1.28.53v15.88a.75.75 0 0 1-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.01 9.01 0 0 1 2.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75z"),c(e,"xmlns","http://www.w3.org/2000/svg"),c(e,"fill","none"),c(e,"viewBox","0 0 24 24"),c(e,"stroke-width","2.3"),c(e,"stroke","currentColor"),c(e,"class","w-4 h-4")},m(l,s){C(l,e,s),_(e,t)},d(l){l&&m(e)}}}function Ya(r){let e,t;return{c(){e=_e("svg"),t=_e("path"),this.h()},l(l){e=ve(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=y(e);t=ve(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),y(t).forEach(m),s.forEach(m),this.h()},h(){c(t,"stroke-linecap","round"),c(t,"stroke-linejoin","round"),c(t,"d","M17.25 9.75 19.5 12m0 0 2.25 2.25M19.5 12l2.25-2.25M19.5 12l-2.25 2.25m-10.5-6 4.72-4.72a.75.75 0 0 1 1.28.53v15.88a.75.75 0 0 1-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.009 9.009 0 0 1 2.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75Z"),c(e,"xmlns","http://www.w3.org/2000/svg"),c(e,"fill","none"),c(e,"viewBox","0 0 24 24"),c(e,"stroke-width","2.3"),c(e,"stroke","currentColor"),c(e,"class","w-4 h-4")},m(l,s){C(l,e,s),_(e,t)},d(l){l&&m(e)}}}function Xa(r){let e,t,l,s,n,i;return{c(){e=_e("svg"),t=_e("style"),l=F(`.spinner_S1WN {
														animation: spinner_MGfb 0.8s linear infinite;
														animation-delay: -0.8s;
													}

													.spinner_Km9P {
														animation-delay: -0.65s;
													}

													.spinner_JApP {
														animation-delay: -0.5s;
													}

													@keyframes spinner_MGfb {
														93.75%,
														100% {
															opacity: 0.2;
														}
													}
												`),s=_e("circle"),n=_e("circle"),i=_e("circle"),this.h()},l(o){e=ve(o,"svg",{class:!0,fill:!0,viewBox:!0,xmlns:!0});var a=y(e);t=ve(a,"style",{});var f=y(t);l=J(f,`.spinner_S1WN {
														animation: spinner_MGfb 0.8s linear infinite;
														animation-delay: -0.8s;
													}

													.spinner_Km9P {
														animation-delay: -0.65s;
													}

													.spinner_JApP {
														animation-delay: -0.5s;
													}

													@keyframes spinner_MGfb {
														93.75%,
														100% {
															opacity: 0.2;
														}
													}
												`),f.forEach(m),s=ve(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),y(s).forEach(m),n=ve(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),y(n).forEach(m),i=ve(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),y(i).forEach(m),a.forEach(m),this.h()},h(){c(s,"class","spinner_S1WN"),c(s,"cx","4"),c(s,"cy","12"),c(s,"r","3"),c(n,"class","spinner_S1WN spinner_Km9P"),c(n,"cx","12"),c(n,"cy","12"),c(n,"r","3"),c(i,"class","spinner_S1WN spinner_JApP"),c(i,"cx","20"),c(i,"cy","12"),c(i,"r","3"),c(e,"class","w-4 h-4"),c(e,"fill","currentColor"),c(e,"viewBox","0 0 24 24"),c(e,"xmlns","http://www.w3.org/2000/svg")},m(o,a){C(o,e,a),_(e,t),_(t,l),_(e,s),_(e,n),_(e,i)},d(o){o&&m(e)}}}function $a(r){let e,t,l,s,n;function i(f,u){return f[18]?Xa:f[17]?Ya:Za}let o=i(r),a=o(r);return{c(){e=I("button"),a.c(),this.h()},l(f){e=M(f,"BUTTON",{id:!0,class:!0});var u=y(e);a.l(u),u.forEach(m),this.h()},h(){c(e,"id",t="speak-button-"+r[0].id),c(e,"class",l=(r[9]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(f,u){C(f,e,u),a.m(e,null),s||(n=me(e,"click",r[70]),s=!0)},p(f,u){o!==(o=i(f))&&(a.d(1),a=o(f),a&&(a.c(),a.m(e,null))),u[0]&1&&t!==(t="speak-button-"+f[0].id)&&c(e,"id",t),u[0]&512&&l!==(l=(f[9]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")&&c(e,"class",l)},d(f){f&&m(e),a.d(),s=!1,n()}}}function ys(r){let e,t;return e=new Be({props:{content:r[25].t("Generate Image"),placement:"bottom",$$slots:{default:[to]},$$scope:{ctx:r}}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const n={};s[0]&33554432&&(n.content=l[25].t("Generate Image")),s[0]&524801|s[3]&2&&(n.$$scope={dirty:s,ctx:l}),e.$set(n)},i(l){t||(w(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function xa(r){let e,t;return{c(){e=_e("svg"),t=_e("path"),this.h()},l(l){e=ve(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=y(e);t=ve(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),y(t).forEach(m),s.forEach(m),this.h()},h(){c(t,"stroke-linecap","round"),c(t,"stroke-linejoin","round"),c(t,"d","m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"),c(e,"xmlns","http://www.w3.org/2000/svg"),c(e,"fill","none"),c(e,"viewBox","0 0 24 24"),c(e,"stroke-width","2.3"),c(e,"stroke","currentColor"),c(e,"class","w-4 h-4")},m(l,s){C(l,e,s),_(e,t)},d(l){l&&m(e)}}}function eo(r){let e,t,l,s,n,i;return{c(){e=_e("svg"),t=_e("style"),l=F(`.spinner_S1WN {
															animation: spinner_MGfb 0.8s linear infinite;
															animation-delay: -0.8s;
														}

														.spinner_Km9P {
															animation-delay: -0.65s;
														}

														.spinner_JApP {
															animation-delay: -0.5s;
														}

														@keyframes spinner_MGfb {
															93.75%,
															100% {
																opacity: 0.2;
															}
														}
													`),s=_e("circle"),n=_e("circle"),i=_e("circle"),this.h()},l(o){e=ve(o,"svg",{class:!0,fill:!0,viewBox:!0,xmlns:!0});var a=y(e);t=ve(a,"style",{});var f=y(t);l=J(f,`.spinner_S1WN {
															animation: spinner_MGfb 0.8s linear infinite;
															animation-delay: -0.8s;
														}

														.spinner_Km9P {
															animation-delay: -0.65s;
														}

														.spinner_JApP {
															animation-delay: -0.5s;
														}

														@keyframes spinner_MGfb {
															93.75%,
															100% {
																opacity: 0.2;
															}
														}
													`),f.forEach(m),s=ve(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),y(s).forEach(m),n=ve(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),y(n).forEach(m),i=ve(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),y(i).forEach(m),a.forEach(m),this.h()},h(){c(s,"class","spinner_S1WN"),c(s,"cx","4"),c(s,"cy","12"),c(s,"r","3"),c(n,"class","spinner_S1WN spinner_Km9P"),c(n,"cx","12"),c(n,"cy","12"),c(n,"r","3"),c(i,"class","spinner_S1WN spinner_JApP"),c(i,"cx","20"),c(i,"cy","12"),c(i,"r","3"),c(e,"class","w-4 h-4"),c(e,"fill","currentColor"),c(e,"viewBox","0 0 24 24"),c(e,"xmlns","http://www.w3.org/2000/svg")},m(o,a){C(o,e,a),_(e,t),_(t,l),_(e,s),_(e,n),_(e,i)},d(o){o&&m(e)}}}function to(r){let e,t,l,s;function n(a,f){return a[19]?eo:xa}let i=n(r),o=i(r);return{c(){e=I("button"),o.c(),this.h()},l(a){e=M(a,"BUTTON",{class:!0});var f=y(e);o.l(f),f.forEach(m),this.h()},h(){c(e,"class",t=(r[9]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(a,f){C(a,e,f),o.m(e,null),l||(s=me(e,"click",r[71]),l=!0)},p(a,f){i!==(i=n(a))&&(o.d(1),o=i(a),o&&(o.c(),o.m(e,null))),f[0]&512&&t!==(t=(a[9]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")&&c(e,"class",t)},d(a){a&&m(e),o.d(),l=!1,s()}}}function Is(r){let e,t;return e=new Be({props:{content:r[0].usage?`<pre>${vt(JSON.stringify(r[0].usage,null,2).replace(/"([^(")"]+)":/g,"$1:").slice(1,-1).split(`
`).map(Rs).map(Ls).join(`
`))}</pre>`:"",placement:"bottom",$$slots:{default:[lo]},$$scope:{ctx:r}}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const n={};s[0]&1&&(n.content=l[0].usage?`<pre>${vt(JSON.stringify(l[0].usage,null,2).replace(/"([^(")"]+)":/g,"$1:").slice(1,-1).split(`
`).map(Rs).map(Ls).join(`
`))}</pre>`:""),s[0]&513|s[3]&2&&(n.$$scope={dirty:s,ctx:l}),e.$set(n)},i(l){t||(w(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function lo(r){let e,t,l,s,n,i,o;return{c(){e=I("button"),t=_e("svg"),l=_e("path"),this.h()},l(a){e=M(a,"BUTTON",{class:!0,id:!0});var f=y(e);t=ve(f,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var u=y(t);l=ve(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),y(l).forEach(m),u.forEach(m),f.forEach(m),this.h()},h(){c(l,"stroke-linecap","round"),c(l,"stroke-linejoin","round"),c(l,"d","M11.25 11.25l.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0zm-9-3.75h.008v.008H12V8.25z"),c(t,"xmlns","http://www.w3.org/2000/svg"),c(t,"fill","none"),c(t,"viewBox","0 0 24 24"),c(t,"stroke-width","2.3"),c(t,"stroke","currentColor"),c(t,"class","w-4 h-4"),c(e,"class",s=(r[9]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition whitespace-pre-wrap"),c(e,"id",n="info-"+r[0].id)},m(a,f){C(a,e,f),_(e,t),_(t,l),i||(o=me(e,"click",r[72]),i=!0)},p(a,f){f[0]&512&&s!==(s=(a[9]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition whitespace-pre-wrap")&&c(e,"class",s),f[0]&1&&n!==(n="info-"+a[0].id)&&c(e,"id",n)},d(a){a&&m(e),i=!1,o()}}}function Ms(r){var g;let e,t,l,s,n,i,o,a=!r[27]&&(((g=r[24])==null?void 0:g.features.enable_message_rating)??!0)&&Es(r),f=r[9]&&Ds(r);l=new Be({props:{content:r[25].t("Regenerate"),placement:"bottom",$$slots:{default:[io]},$$scope:{ctx:r}}});let u=r[2].length>1&&Ns(r),d=r[9]&&Vs(r);return{c(){a&&a.c(),e=P(),f&&f.c(),t=P(),Y(l.$$.fragment),s=P(),u&&u.c(),n=P(),d&&d.c(),i=ae()},l(h){a&&a.l(h),e=j(h),f&&f.l(h),t=j(h),X(l.$$.fragment,h),s=j(h),u&&u.l(h),n=j(h),d&&d.l(h),i=ae()},m(h,p){a&&a.m(h,p),C(h,e,p),f&&f.m(h,p),C(h,t,p),$(l,h,p),C(h,s,p),u&&u.m(h,p),C(h,n,p),d&&d.m(h,p),C(h,i,p),o=!0},p(h,p){var v;!h[27]&&(((v=h[24])==null?void 0:v.features.enable_message_rating)??!0)?a?(a.p(h,p),p[0]&150994944&&w(a,1)):(a=Es(h),a.c(),w(a,1),a.m(e.parentNode,e)):a&&(te(),V(a,1,1,()=>{a=null}),le()),h[9]?f?(f.p(h,p),p[0]&512&&w(f,1)):(f=Ds(h),f.c(),w(f,1),f.m(t.parentNode,t)):f&&(te(),V(f,1,1,()=>{f=null}),le());const D={};p[0]&33554432&&(D.content=h[25].t("Regenerate")),p[0]&1065601|p[3]&2&&(D.$$scope={dirty:p,ctx:h}),l.$set(D),h[2].length>1?u?(u.p(h,p),p[0]&4&&w(u,1)):(u=Ns(h),u.c(),w(u,1),u.m(n.parentNode,n)):u&&(te(),V(u,1,1,()=>{u=null}),le()),h[9]?d?(d.p(h,p),p[0]&512&&w(d,1)):(d=Vs(h),d.c(),w(d,1),d.m(i.parentNode,i)):d&&(te(),V(d,1,1,()=>{d=null}),le())},i(h){o||(w(a),w(f),w(l.$$.fragment,h),w(u),w(d),o=!0)},o(h){V(a),V(f),V(l.$$.fragment,h),V(u),V(d),o=!1},d(h){h&&(m(e),m(t),m(s),m(n),m(i)),a&&a.d(h),f&&f.d(h),x(l,h),u&&u.d(h),d&&d.d(h)}}}function Es(r){let e,t,l,s;return e=new Be({props:{content:r[25].t("Good Response"),placement:"bottom",$$slots:{default:[so]},$$scope:{ctx:r}}}),l=new Be({props:{content:r[25].t("Bad Response"),placement:"bottom",$$slots:{default:[ro]},$$scope:{ctx:r}}}),{c(){Y(e.$$.fragment),t=P(),Y(l.$$.fragment)},l(n){X(e.$$.fragment,n),t=j(n),X(l.$$.fragment,n)},m(n,i){$(e,n,i),C(n,t,i),$(l,n,i),s=!0},p(n,i){const o={};i[0]&33554432&&(o.content=n[25].t("Good Response")),i[0]&2097665|i[3]&2&&(o.$$scope={dirty:i,ctx:n}),e.$set(o);const a={};i[0]&33554432&&(a.content=n[25].t("Bad Response")),i[0]&2097665|i[3]&2&&(a.$$scope={dirty:i,ctx:n}),l.$set(a)},i(n){s||(w(e.$$.fragment,n),w(l.$$.fragment,n),s=!0)},o(n){V(e.$$.fragment,n),V(l.$$.fragment,n),s=!1},d(n){n&&m(t),x(e,n),x(l,n)}}}function so(r){let e,t,l,s,n,i;return{c(){e=I("button"),t=_e("svg"),l=_e("path"),this.h()},l(o){e=M(o,"BUTTON",{class:!0});var a=y(e);t=ve(a,"svg",{stroke:!0,fill:!0,"stroke-width":!0,viewBox:!0,"stroke-linecap":!0,"stroke-linejoin":!0,class:!0,xmlns:!0});var f=y(t);l=ve(f,"path",{d:!0}),y(l).forEach(m),f.forEach(m),a.forEach(m),this.h()},h(){var o,a;c(l,"d","M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"),c(t,"stroke","currentColor"),c(t,"fill","none"),c(t,"stroke-width","2.3"),c(t,"viewBox","0 0 24 24"),c(t,"stroke-linecap","round"),c(t,"stroke-linejoin","round"),c(t,"class","w-4 h-4"),c(t,"xmlns","http://www.w3.org/2000/svg"),c(e,"class",s=(r[9]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((a=(o=r[0])==null?void 0:o.annotation)==null?void 0:a.rating)??"").toString()==="1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent"),e.disabled=r[21]},m(o,a){C(o,e,a),_(e,t),_(t,l),n||(i=me(e,"click",r[73]),n=!0)},p(o,a){var f,u;a[0]&513&&s!==(s=(o[9]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((u=(f=o[0])==null?void 0:f.annotation)==null?void 0:u.rating)??"").toString()==="1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent")&&c(e,"class",s),a[0]&2097152&&(e.disabled=o[21])},d(o){o&&m(e),n=!1,i()}}}function ro(r){let e,t,l,s,n,i;return{c(){e=I("button"),t=_e("svg"),l=_e("path"),this.h()},l(o){e=M(o,"BUTTON",{class:!0});var a=y(e);t=ve(a,"svg",{stroke:!0,fill:!0,"stroke-width":!0,viewBox:!0,"stroke-linecap":!0,"stroke-linejoin":!0,class:!0,xmlns:!0});var f=y(t);l=ve(f,"path",{d:!0}),y(l).forEach(m),f.forEach(m),a.forEach(m),this.h()},h(){var o,a;c(l,"d","M10 15v4a3 3 0 0 0 3 3l4-9V2H5.72a2 2 0 0 0-2 1.7l-1.38 9a2 2 0 0 0 2 2.3zm7-13h2.67A2.31 2.31 0 0 1 22 4v7a2.31 2.31 0 0 1-2.33 2H17"),c(t,"stroke","currentColor"),c(t,"fill","none"),c(t,"stroke-width","2.3"),c(t,"viewBox","0 0 24 24"),c(t,"stroke-linecap","round"),c(t,"stroke-linejoin","round"),c(t,"class","w-4 h-4"),c(t,"xmlns","http://www.w3.org/2000/svg"),c(e,"class",s=(r[9]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((a=(o=r[0])==null?void 0:o.annotation)==null?void 0:a.rating)??"").toString()==="-1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent"),e.disabled=r[21]},m(o,a){C(o,e,a),_(e,t),_(t,l),n||(i=me(e,"click",r[74]),n=!0)},p(o,a){var f,u;a[0]&513&&s!==(s=(o[9]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((u=(f=o[0])==null?void 0:f.annotation)==null?void 0:u.rating)??"").toString()==="-1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent")&&c(e,"class",s),a[0]&2097152&&(e.disabled=o[21])},d(o){o&&m(e),n=!1,i()}}}function Ds(r){let e,t;return e=new Be({props:{content:r[25].t("Continue Response"),placement:"bottom",$$slots:{default:[no]},$$scope:{ctx:r}}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const n={};s[0]&33554432&&(n.content=l[25].t("Continue Response")),s[0]&576|s[3]&2&&(n.$$scope={dirty:s,ctx:l}),e.$set(n)},i(l){t||(w(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function no(r){let e,t,l,s,n,i,o;return{c(){e=I("button"),t=_e("svg"),l=_e("path"),s=_e("path"),this.h()},l(a){e=M(a,"BUTTON",{type:!0,id:!0,class:!0});var f=y(e);t=ve(f,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var u=y(t);l=ve(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),y(l).forEach(m),s=ve(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),y(s).forEach(m),u.forEach(m),f.forEach(m),this.h()},h(){c(l,"stroke-linecap","round"),c(l,"stroke-linejoin","round"),c(l,"d","M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"),c(s,"stroke-linecap","round"),c(s,"stroke-linejoin","round"),c(s,"d","M15.91 11.672a.375.375 0 0 1 0 .656l-5.603 3.113a.375.375 0 0 1-.557-.328V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"),c(t,"xmlns","http://www.w3.org/2000/svg"),c(t,"fill","none"),c(t,"viewBox","0 0 24 24"),c(t,"stroke-width","2.3"),c(t,"stroke","currentColor"),c(t,"class","w-4 h-4"),c(e,"type","button"),c(e,"id","continue-response-button"),c(e,"class",n=(r[9]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")},m(a,f){C(a,e,f),_(e,t),_(t,l),_(t,s),i||(o=me(e,"click",r[75]),i=!0)},p(a,f){f[0]&512&&n!==(n=(a[9]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")&&c(e,"class",n)},d(a){a&&m(e),i=!1,o()}}}function io(r){let e,t,l,s,n,i;return{c(){e=I("button"),t=_e("svg"),l=_e("path"),this.h()},l(o){e=M(o,"BUTTON",{type:!0,class:!0});var a=y(e);t=ve(a,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var f=y(t);l=ve(f,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),y(l).forEach(m),f.forEach(m),a.forEach(m),this.h()},h(){c(l,"stroke-linecap","round"),c(l,"stroke-linejoin","round"),c(l,"d","M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"),c(t,"xmlns","http://www.w3.org/2000/svg"),c(t,"fill","none"),c(t,"viewBox","0 0 24 24"),c(t,"stroke-width","2.3"),c(t,"stroke","currentColor"),c(t,"class","w-4 h-4"),c(e,"type","button"),c(e,"class",s=(r[9]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")},m(o,a){C(o,e,a),_(e,t),_(t,l),n||(i=me(e,"click",r[76]),n=!0)},p(o,a){a[0]&512&&s!==(s=(o[9]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")&&c(e,"class",s)},d(o){o&&m(e),n=!1,i()}}}function Ns(r){let e,t;return e=new Be({props:{content:r[25].t("Delete"),placement:"bottom",$$slots:{default:[ao]},$$scope:{ctx:r}}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const n={};s[0]&33554432&&(n.content=l[25].t("Delete")),s[0]&8704|s[3]&2&&(n.$$scope={dirty:s,ctx:l}),e.$set(n)},i(l){t||(w(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function ao(r){let e,t,l,s,n,i;return{c(){e=I("button"),t=_e("svg"),l=_e("path"),this.h()},l(o){e=M(o,"BUTTON",{type:!0,id:!0,class:!0});var a=y(e);t=ve(a,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var f=y(t);l=ve(f,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),y(l).forEach(m),f.forEach(m),a.forEach(m),this.h()},h(){c(l,"stroke-linecap","round"),c(l,"stroke-linejoin","round"),c(l,"d","m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2 2 0 0 1-2 2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"),c(t,"xmlns","http://www.w3.org/2000/svg"),c(t,"fill","none"),c(t,"viewBox","0 0 24 24"),c(t,"stroke-width","2"),c(t,"stroke","currentColor"),c(t,"class","w-4 h-4"),c(e,"type","button"),c(e,"id","continue-response-button"),c(e,"class",s=(r[9]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")},m(o,a){C(o,e,a),_(e,t),_(t,l),n||(i=me(e,"click",r[77]),n=!0)},p(o,a){a[0]&512&&s!==(s=(o[9]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")&&c(e,"class",s)},d(o){o&&m(e),n=!1,i()}}}function Vs(r){var i;let e,t,l=De(((i=r[14])==null?void 0:i.actions)??[]),s=[];for(let o=0;o<l.length;o+=1)s[o]=Cs(ts(r,l,o));const n=o=>V(s[o],1,1,()=>{s[o]=null});return{c(){for(let o=0;o<s.length;o+=1)s[o].c();e=ae()},l(o){for(let a=0;a<s.length;a+=1)s[a].l(o);e=ae()},m(o,a){for(let f=0;f<s.length;f+=1)s[f]&&s[f].m(o,a);C(o,e,a),t=!0},p(o,a){var f;if(a[0]&16929){l=De(((f=o[14])==null?void 0:f.actions)??[]);let u;for(u=0;u<l.length;u+=1){const d=ts(o,l,u);s[u]?(s[u].p(d,a),w(s[u],1)):(s[u]=Cs(d),s[u].c(),w(s[u],1),s[u].m(e.parentNode,e))}for(te(),u=l.length;u<s.length;u+=1)n(u);le()}},i(o){if(!t){for(let a=0;a<l.length;a+=1)w(s[a]);t=!0}},o(o){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)V(s[a]);t=!1},d(o){o&&m(e),We(s,o)}}}function oo(r){let e,t;return e=new oi({props:{strokeWidth:"2.1",className:"size-4"}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p:ge,i(l){t||(w(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function fo(r){let e,t,l,s,n;return{c(){e=I("div"),t=I("img"),this.h()},l(i){e=M(i,"DIV",{class:!0});var o=y(e);t=M(o,"IMG",{src:!0,class:!0,style:!0,alt:!0}),o.forEach(m),this.h()},h(){it(t.src,l=r[87].icon_url)||c(t,"src",l),c(t,"class",s="w-4 h-4 "+(r[87].icon_url.includes("svg")?"dark:invert-[80%]":"")),br(t,"fill","currentColor"),c(t,"alt",n=r[87].name),c(e,"class","size-4")},m(i,o){C(i,e,o),_(e,t)},p(i,o){o[0]&16384&&!it(t.src,l=i[87].icon_url)&&c(t,"src",l),o[0]&16384&&s!==(s="w-4 h-4 "+(i[87].icon_url.includes("svg")?"dark:invert-[80%]":""))&&c(t,"class",s),o[0]&16384&&n!==(n=i[87].name)&&c(t,"alt",n)},i:ge,o:ge,d(i){i&&m(e)}}}function uo(r){let e,t,l,s,n,i,o,a;const f=[fo,oo],u=[];function d(h,p){return h[87].icon_url?0:1}t=d(r),l=u[t]=f[t](r);function g(){return r[78](r[87])}return{c(){e=I("button"),l.c(),n=P(),this.h()},l(h){e=M(h,"BUTTON",{type:!0,class:!0});var p=y(e);l.l(p),p.forEach(m),n=j(h),this.h()},h(){c(e,"type","button"),c(e,"class",s=(r[9]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(h,p){C(h,e,p),u[t].m(e,null),C(h,n,p),i=!0,o||(a=me(e,"click",g),o=!0)},p(h,p){r=h;let D=t;t=d(r),t===D?u[t].p(r,p):(te(),V(u[D],1,1,()=>{u[D]=null}),le(),l=u[t],l?l.p(r,p):(l=u[t]=f[t](r),l.c()),w(l,1),l.m(e,null)),(!i||p[0]&512&&s!==(s=(r[9]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition"))&&c(e,"class",s)},i(h){i||(w(l),i=!0)},o(h){V(l),i=!1},d(h){h&&(m(e),m(n)),u[t].d(),o=!1,a()}}}function Cs(r){let e,t;return e=new Be({props:{content:r[87].name,placement:"bottom",$$slots:{default:[uo]},$$scope:{ctx:r}}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const n={};s[0]&16384&&(n.content=l[87].name),s[0]&16929|s[3]&2&&(n.$$scope={dirty:s,ctx:l}),e.$set(n)},i(l){t||(w(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Ts(r){let e,t,l,s;function n(a){r[80](a)}function i(a){r[81](a)}let o={};return r[0]!==void 0&&(o.message=r[0]),r[20]!==void 0&&(o.show=r[20]),e=new $n({props:o}),Pe.push(()=>Ke(e,"message",n)),Pe.push(()=>Ke(e,"show",i)),e.$on("save",r[82]),{c(){Y(e.$$.fragment)},l(a){X(e.$$.fragment,a)},m(a,f){$(e,a,f),s=!0},p(a,f){const u={};!t&&f[0]&1&&(t=!0,u.message=a[0],Ge(()=>t=!1)),!l&&f[0]&1048576&&(l=!0,u.show=a[20],Ge(()=>l=!1)),e.$set(u)},i(a){s||(w(e.$$.fragment,a),s=!0)},o(a){V(e.$$.fragment,a),s=!1},d(a){x(e,a)}}}function Bs(r){var z,ee,G,Q,ue,fe,ke,de;let e,t,l,s,n,i,o,a,f,u=((z=r[0])==null?void 0:z.files)&&((ee=r[0].files)==null?void 0:ee.filter(Ss).length)>0,d,g,h,p,D,v,E,b,R,A,N,k;l=new Er({props:{src:((ue=(Q=(G=r[14])==null?void 0:G.info)==null?void 0:Q.meta)==null?void 0:ue.profile_image_url)??(r[25].language==="dg-DG"?"/doge.png":`${Bt}/static/favicon.png`),className:"size-8"}}),o=new Jt({props:{$$slots:{default:[wa]},$$scope:{ctx:r}}});let B=u&&rs(r),S=(((fe=r[0])==null?void 0:fe.statusHistory)??[...(ke=r[0])!=null&&ke.status?[(de=r[0])==null?void 0:de.status]:[]]).length>0&&as(qt(r));const T=[Oa,La],H=[];function L(Z,U){return Z[11]===!0?0:1}D=L(r),v=H[D]=T[D](r);let q=!r[11]&&_s(r);return{c(){e=I("div"),t=I("div"),Y(l.$$.fragment),n=P(),i=I("div"),Y(o.$$.fragment),a=P(),f=I("div"),B&&B.c(),d=P(),g=I("div"),h=I("div"),S&&S.c(),p=P(),v.c(),b=P(),q&&q.c(),this.h()},l(Z){e=M(Z,"DIV",{class:!0,id:!0,dir:!0});var U=y(e);t=M(U,"DIV",{class:!0});var he=y(t);X(l.$$.fragment,he),he.forEach(m),n=j(U),i=M(U,"DIV",{class:!0});var ce=y(i);X(o.$$.fragment,ce),a=j(ce),f=M(ce,"DIV",{});var be=y(f);B&&B.l(be),d=j(be),g=M(be,"DIV",{class:!0});var Me=y(g);h=M(Me,"DIV",{});var pe=y(h);S&&S.l(pe),p=j(pe),v.l(pe),pe.forEach(m),Me.forEach(m),b=j(be),q&&q.l(be),be.forEach(m),ce.forEach(m),U.forEach(m),this.h()},h(){var Z;c(t,"class",s=ol(`shrink-0 ${(((Z=r[23])==null?void 0:Z.chatDirection)??"LTR")==="LTR"?"mr-3":"ml-3"}`)+" svelte-wlev50"),c(g,"class",E="chat-"+r[0].role+" w-full min-w-full markdown-prose svelte-wlev50"),c(i,"class","flex-auto w-0 pl-1"),c(e,"class",R="flex w-full message-"+r[0].id+" svelte-wlev50"),c(e,"id",A="message-"+r[0].id),c(e,"dir",N=r[23].chatDirection)},m(Z,U){C(Z,e,U),_(e,t),$(l,t,null),_(e,n),_(e,i),$(o,i,null),_(i,a),_(i,f),B&&B.m(f,null),_(f,d),_(f,g),_(g,h),S&&S.m(h,null),_(h,p),H[D].m(h,null),_(f,b),q&&q.m(f,null),k=!0},p(Z,U){var Me,pe,O,re,ie,ne,se,oe,ye;const he={};U[0]&33570816&&(he.src=((O=(pe=(Me=Z[14])==null?void 0:Me.info)==null?void 0:pe.meta)==null?void 0:O.profile_image_url)??(Z[25].language==="dg-DG"?"/doge.png":`${Bt}/static/favicon.png`)),l.$set(he),(!k||U[0]&8388608&&s!==(s=ol(`shrink-0 ${(((re=Z[23])==null?void 0:re.chatDirection)??"LTR")==="LTR"?"mr-3":"ml-3"}`)+" svelte-wlev50"))&&c(t,"class",s);const ce={};U[0]&16385|U[3]&2&&(ce.$$scope={dirty:U,ctx:Z}),o.$set(ce),U[0]&1&&(u=((ie=Z[0])==null?void 0:ie.files)&&((ne=Z[0].files)==null?void 0:ne.filter(Ss).length)>0),u?B?(B.p(Z,U),U[0]&1&&w(B,1)):(B=rs(Z),B.c(),w(B,1),B.m(f,d)):B&&(te(),V(B,1,1,()=>{B=null}),le()),(((se=Z[0])==null?void 0:se.statusHistory)??[...(oe=Z[0])!=null&&oe.status?[(ye=Z[0])==null?void 0:ye.status]:[]]).length>0?S?(S.p(qt(Z),U),U[0]&1&&w(S,1)):(S=as(qt(Z)),S.c(),w(S,1),S.m(h,p)):S&&(te(),V(S,1,1,()=>{S=null}),le());let be=D;D=L(Z),D===be?H[D].p(Z,U):(te(),V(H[be],1,1,()=>{H[be]=null}),le(),v=H[D],v?v.p(Z,U):(v=H[D]=T[D](Z),v.c()),w(v,1),v.m(h,null)),(!k||U[0]&1&&E!==(E="chat-"+Z[0].role+" w-full min-w-full markdown-prose svelte-wlev50"))&&c(g,"class",E),Z[11]?q&&(te(),V(q,1,1,()=>{q=null}),le()):q?(q.p(Z,U),U[0]&2048&&w(q,1)):(q=_s(Z),q.c(),w(q,1),q.m(f,null)),(!k||U[0]&1&&R!==(R="flex w-full message-"+Z[0].id+" svelte-wlev50"))&&c(e,"class",R),(!k||U[0]&1&&A!==(A="message-"+Z[0].id))&&c(e,"id",A),(!k||U[0]&8388608&&N!==(N=Z[23].chatDirection))&&c(e,"dir",N)},i(Z){k||(w(l.$$.fragment,Z),w(o.$$.fragment,Z),w(B),w(S),w(v),w(q),k=!0)},o(Z){V(l.$$.fragment,Z),V(o.$$.fragment,Z),V(B),V(S),V(v),V(q),k=!1},d(Z){Z&&m(e),x(l),x(o),B&&B.d(),S&&S.d(),H[D].d(),q&&q.d()}}}function co(r){let e,t,l,s=r[0].id,n,i;function o(u){r[48](u)}let a={title:r[25].t("Delete message?")};r[13]!==void 0&&(a.show=r[13]),e=new Tr({props:a}),Pe.push(()=>Ke(e,"show",o)),e.$on("confirm",r[49]);let f=Bs(r);return{c(){Y(e.$$.fragment),l=P(),f.c(),n=ae()},l(u){X(e.$$.fragment,u),l=j(u),f.l(u),n=ae()},m(u,d){$(e,u,d),C(u,l,d),f.m(u,d),C(u,n,d),i=!0},p(u,d){const g={};d[0]&33554432&&(g.title=u[25].t("Delete message?")),!t&&d[0]&8192&&(t=!0,g.show=u[13],Ge(()=>t=!1)),e.$set(g),d[0]&1&&Ce(s,s=u[0].id)?(te(),V(f,1,1,ge),le(),f=Bs(u),f.c(),w(f,1),f.m(n.parentNode,n)):f.p(u,d)},i(u){i||(w(e.$$.fragment,u),w(f),i=!0)},o(u){V(e.$$.fragment,u),V(f),i=!1},d(u){u&&(m(l),m(n)),x(e,u),f.d(u)}}}function ho(r){try{const e=JSON.parse(r);return typeof e=="object"&&e!==null}catch{return!1}}function mo(r){if(console.log("Processing agent response:",r),console.log("Type of content:",typeof r),!r||typeof r!="string")return{isAgent:!1,content:r};if(ho(r))try{const e=JSON.parse(r);if(e.success&&e.response)return console.log(" Detected agent response:",e.response.type),e.response.type==="query_chart"?{isAgent:!0,type:"query_chart",content:e.response.content,data:e}:e.response.type==="query_result"?{isAgent:!0,type:e.response.type,content:e.response.content,data:e}:{isAgent:!0,type:e.response.type,content:e.response.content,data:e};if(e.success&&(e.type==="query_result"||e.type==="query_chart"))return console.log(" Detected direct query type:",e.type),{isAgent:!0,type:e.type,content:e.response.content,data:e}}catch(e){console.error("Error parsing potential agent response:",e)}return{isAgent:!1,content:r}}const Ss=r=>r.type==="image",go=r=>{r.target.style.height="",r.target.style.height=`${r.target.scrollHeight}px`},Rs=r=>r.slice(2),Ls=r=>r.endsWith(",")?r.slice(0,-1):r;function _o(r,e,t){let l,s,n,i,o,a,f,u;Ee(r,Rt,W=>t(47,s=W)),Ee(r,Lt,W=>t(23,n=W)),Ee(r,dn,W=>t(24,i=W)),Ee(r,fl,W=>t(85,o=W)),Ee(r,Ot,W=>t(26,f=W)),Ee(r,Ft,W=>t(27,u=W));const d=Qe("i18n");Ee(r,d,W=>t(25,a=W));const g=pt();let{chatId:h=""}=e,{history:p}=e,{messageId:D}=e,{message:v=JSON.parse(JSON.stringify(p.messages[D]))}=e,{siblings:E}=e,{showPreviousMessage:b}=e,{showNextMessage:R}=e,{updateChat:A}=e,{editMessage:N}=e,{saveMessage:k}=e,{rateMessage:B}=e,{actionMessage:S}=e,{deleteMessage:T}=e,{submitMessage:H}=e,{continueResponse:L}=e,{regenerateResponse:q}=e,{addMessages:z}=e,{isLastMessage:ee=!0}=e,{readOnly:G=!1}=e,Q,ue=!1,fe=null,ke=!1,de="",Z,U={},he=!1,ce,be=!1,Me=!1,pe=!1;const O=async W=>{await Ir(W)&&He.success(a.t("Copying to clipboard was successful!"))},re=W=>new Promise(Ie=>{ce=W;const we=U[W];if(!we)return Ie();we.play(),we.onended=async()=>{await new Promise(Ae=>setTimeout(Ae,300)),Object.keys(U).length-1===W&&t(17,he=!1),Ie()}}),ie=async()=>{var W,Ie,we,Ae,qe,Xe,Vt,dt,kt,Se,Je,rt,wt,Ct,Zt,Yt,Xt,$t,xt,el,tl,ll,sl;if(he){try{speechSynthesis.cancel(),ce!==void 0&&U[ce]&&(U[ce].pause(),U[ce].currentTime=0)}catch{}t(17,he=!1),ce=void 0;return}if(!((v==null?void 0:v.content)??"").trim().length){He.info(a.t("No content to speak"));return}if(t(17,he=!0),i.audio.tts.engine===""){let Ze=[];const _t=setInterval(()=>{var Ye,ht,$e;if(Ze=speechSynthesis.getVoices(),Ze.length>0){clearInterval(_t);const Ue=((Ye=Ze==null?void 0:Ze.filter(gt=>{var rl,nl,il,al;return gt.voiceURI===(((nl=(rl=n==null?void 0:n.audio)==null?void 0:rl.tts)==null?void 0:nl.voice)??((al=(il=i==null?void 0:i.audio)==null?void 0:il.tts)==null?void 0:al.voice))}))==null?void 0:Ye.at(0))??void 0;console.log(Ue);const mt=new SpeechSynthesisUtterance(v.content);mt.rate=(($e=(ht=n.audio)==null?void 0:ht.tts)==null?void 0:$e.playbackRate)??1,console.log(mt),mt.onend=()=>{var gt;t(17,he=!1),n.conversationMode&&((gt=document.getElementById("voice-input-button"))==null||gt.click())},Ue&&(mt.voice=Ue),speechSynthesis.speak(mt)}},100)}else{t(18,be=!0);const Ze=vn(v.content,((Ie=(W=i==null?void 0:i.audio)==null?void 0:W.tts)==null?void 0:Ie.split_on)??"punctuation");if(!Ze.length){console.log("No content to speak"),He.info(a.t("No content to speak")),t(17,he=!1),t(18,be=!1);return}console.debug("Prepared message content for TTS",Ze),U=Ze.reduce((Ye,ht,$e)=>(Ye[$e]=null,Ye),{});let _t=Promise.resolve();if(((Ae=(we=n.audio)==null?void 0:we.tts)==null?void 0:Ae.engine)==="browser-kokoro"){o||(await fl.set(new Sn({dtype:((Vt=(Xe=(qe=n.audio)==null?void 0:qe.tts)==null?void 0:Xe.engineConfig)==null?void 0:Vt.dtype)??"fp32"})),await o.init());for(const[Ye,ht]of Ze.entries()){const $e=await o.generate({text:ht,voice:((kt=(dt=n==null?void 0:n.audio)==null?void 0:dt.tts)==null?void 0:kt.voice)??((Je=(Se=i==null?void 0:i.audio)==null?void 0:Se.tts)==null?void 0:Je.voice)}).catch(Ue=>{console.error(Ue),He.error(`${Ue}`),t(17,he=!1),t(18,be=!1)});if($e){const Ue=new Audio($e);Ue.playbackRate=((wt=(rt=n.audio)==null?void 0:rt.tts)==null?void 0:wt.playbackRate)??1,U[Ye]=Ue,t(18,be=!1),_t=_t.then(()=>re(Ye))}}}else for(const[Ye,ht]of Ze.entries()){const $e=await kn(localStorage.token,((Zt=(Ct=n==null?void 0:n.audio)==null?void 0:Ct.tts)==null?void 0:Zt.defaultVoice)===i.audio.tts.voice?((Xt=(Yt=n==null?void 0:n.audio)==null?void 0:Yt.tts)==null?void 0:Xt.voice)??((xt=($t=i==null?void 0:i.audio)==null?void 0:$t.tts)==null?void 0:xt.voice):(tl=(el=i==null?void 0:i.audio)==null?void 0:el.tts)==null?void 0:tl.voice,ht).catch(Ue=>{console.error(Ue),He.error(`${Ue}`),t(17,he=!1),t(18,be=!1)});if($e){const Ue=await $e.blob(),mt=URL.createObjectURL(Ue),gt=new Audio(mt);gt.playbackRate=((sl=(ll=n.audio)==null?void 0:ll.tts)==null?void 0:sl.playbackRate)??1,U[Ye]=gt,t(18,be=!1),_t=_t.then(()=>re(Ye))}}}},ne=async()=>{t(11,ke=!0),t(15,de=v.content),await Ne(),t(16,Z.style.height="",Z),t(16,Z.style.height=`${Z.scrollHeight}px`,Z)},se=async()=>{N(v.id,de||"",!1),t(11,ke=!1),t(15,de=""),await Ne()},oe=async()=>{N(v.id,de||""),t(11,ke=!1),t(15,de=""),await Ne()},ye=async()=>{t(11,ke=!1),t(15,de=""),await Ne()},je=async W=>{t(19,Me=!0);const Ie=await wn(localStorage.token,W.content).catch(we=>{He.error(`${we}`)});if(console.log(Ie),Ie){const we=Ie.map(Ae=>({type:"image",url:`${Ae.url}`}));k(W.id,{...W,files:we})}t(19,Me=!1)};let Ve=!1;const Oe=async(W=null,Ie=null)=>{var kt;t(21,Ve=!0),console.log("Feedback",W,Ie);const we={...v,annotation:{...(v==null?void 0:v.annotation)??{},...W!==null?{rating:W}:{},...Ie||{}}},Ae=await mn(localStorage.token,h).catch(Se=>{He.error(`${Se}`)});if(!Ae)return;const qe=Wt(p,v.id);let Xe={type:"rating",data:{...we!=null&&we.annotation?we.annotation:{},model_id:(v==null?void 0:v.selectedModelId)??v.model,...p.messages[v.parentId].childrenIds.length>1?{sibling_model_ids:p.messages[v.parentId].childrenIds.filter(Se=>Se!==v.id).map(Se=>{var Je;return((Je=p.messages[Se])==null?void 0:Je.selectedModelId)??p.messages[Se].model})}:{}},meta:{arena:v?v.arena:!1,model_id:v.model,message_id:v.id,message_index:qe.length,chat_id:h},snapshot:{chat:Ae}};const Vt=[Xe.data.model_id,...Xe.data.sibling_model_ids??[]].reduce((Se,Je)=>{var wt;const rt=s.find(Ct=>Ct.id===Je);return rt?Se[rt.id]=((wt=rt==null?void 0:rt.info)==null?void 0:wt.base_model_id)??null:console.warn(`Model with ID ${Je} not found`),Se},{});Xe.meta.base_models=Vt;let dt=null;if(v!=null&&v.feedbackId?dt=await dl(localStorage.token,v.feedbackId,Xe).catch(Se=>{He.error(`${Se}`)}):(dt=await pn(localStorage.token,Xe).catch(Se=>{He.error(`${Se}`)}),dt&&(we.feedbackId=dt.id)),console.log(we),k(v.id,we),await Ne(),!Ie&&(t(20,pe=!0),!((kt=we.annotation)!=null&&kt.tags))){const Se=await bn(localStorage.token,v.model,qe,h).catch(Je=>(console.error(Je),[]));console.log(Se),Se&&(we.annotation.tags=Se,Xe.data.tags=Se,k(v.id,we),await dl(localStorage.token,we.feedbackId,Xe).catch(Je=>{He.error(`${Je}`)}))}t(21,Ve=!1)},ze=async()=>{T(v.id)};bt(async()=>{await Ne(),Q&&(console.log(Q),Q.addEventListener("wheel",function(W){W.preventDefault(),W.deltaY!==0&&t(12,Q.scrollLeft+=W.deltaY,Q)}))});function Fe(W){ue=W,t(13,ue)}const tt=()=>{ze()};function lt(W){Pe[W?"unshift":"push"](()=>{Z=W,t(16,Z)})}function ot(){de=this.value,t(15,de)}const ft=W=>{var Ae,qe;W.key==="Escape"&&((Ae=document.getElementById("close-edit-message-button"))==null||Ae.click());const Ie=W.metaKey||W.ctrlKey,we=W.key==="Enter";Ie&&we&&((qe=document.getElementById("confirm-edit-message-button"))==null||qe.click())},xe=()=>{oe()},ut=()=>{ye()},ct=()=>{se()},st=()=>{var W,Ie;O(((W=l.data.results)==null?void 0:W.sql_query)||((Ie=l.data.metadata)==null?void 0:Ie.sql_query))},It=()=>{var W,Ie;O(((W=l.data.results)==null?void 0:W.sql_query)||((Ie=l.data.metadata)==null?void 0:Ie.sql_query))},Mt=async W=>{console.log(W)},Et=async(W,Ie)=>{console.log(W,Ie);let we=document.getElementById(`source-${v.id}-${Ie}`);const Ae=document.getElementById("collapsible-sources");we?we.scrollIntoView({behavior:"smooth"}):Ae&&(Ae.querySelector("div:first-child").dispatchEvent(new PointerEvent("pointerup",{})),await new Promise(qe=>requestAnimationFrame(qe)),await new Promise(qe=>requestAnimationFrame(qe)),we=document.getElementById(`source-${v.id}-${Ie}`),we&&we.scrollIntoView({behavior:"smooth"}))},Dt=({modelId:W,parentId:Ie,messages:we})=>{z({modelId:W,parentId:Ie,messages:we})},Nt=W=>{t(0,v.content=W.detail.content,v),g("update",v)},Lr=async W=>{console.log(W)},Or=async(W,Ie)=>{console.log(W,Ie);let we=document.getElementById(`source-${v.id}-${Ie}`);const Ae=document.getElementById("collapsible-sources");we?we.scrollIntoView({behavior:"smooth"}):Ae&&(Ae.querySelector("div:first-child").dispatchEvent(new PointerEvent("pointerup",{})),await new Promise(qe=>requestAnimationFrame(qe)),await new Promise(qe=>requestAnimationFrame(qe)),we=document.getElementById(`source-${v.id}-${Ie}`),we&&we.scrollIntoView({behavior:"smooth"}))},Ar=({modelId:W,parentId:Ie,messages:we})=>{z({modelId:W,parentId:Ie,messages:we})},Hr=W=>{t(0,v.content=W.detail.content,v),g("update",v)},Pr=()=>{b(v)},jr=()=>{R(v)},qr=()=>{ne()},zr=()=>{O(v.content)},Ur=()=>{be||ie()},Wr=()=>{Me||je(v)},Fr=()=>{console.log(v)},Jr=async()=>{await Oe(1),window.setTimeout(()=>{var W;(W=document.getElementById(`message-feedback-${v.id}`))==null||W.scrollIntoView()},0)},Gr=async()=>{await Oe(-1),window.setTimeout(()=>{var W;(W=document.getElementById(`message-feedback-${v.id}`))==null||W.scrollIntoView()},0)},Kr=()=>{L()},Qr=()=>{t(20,pe=!1),q(v),((fe==null?void 0:fe.actions)??[]).forEach(W=>{g("action",{id:W.id,event:{id:"regenerate-response",data:{messageId:v.id}}})})},Zr=()=>{t(13,ue=!0)},Yr=W=>{S(W.id,v)};function Xr(W){Pe[W?"unshift":"push"](()=>{Q=W,t(12,Q)})}function $r(W){v=W,t(0,v),t(1,p),t(40,D)}function xr(W){pe=W,t(20,pe)}const en=async W=>{await Oe(null,{...W.detail})};return r.$$set=W=>{"chatId"in W&&t(39,h=W.chatId),"history"in W&&t(1,p=W.history),"messageId"in W&&t(40,D=W.messageId),"message"in W&&t(0,v=W.message),"siblings"in W&&t(2,E=W.siblings),"showPreviousMessage"in W&&t(3,b=W.showPreviousMessage),"showNextMessage"in W&&t(4,R=W.showNextMessage),"updateChat"in W&&t(41,A=W.updateChat),"editMessage"in W&&t(42,N=W.editMessage),"saveMessage"in W&&t(43,k=W.saveMessage),"rateMessage"in W&&t(44,B=W.rateMessage),"actionMessage"in W&&t(5,S=W.actionMessage),"deleteMessage"in W&&t(45,T=W.deleteMessage),"submitMessage"in W&&t(46,H=W.submitMessage),"continueResponse"in W&&t(6,L=W.continueResponse),"regenerateResponse"in W&&t(7,q=W.regenerateResponse),"addMessages"in W&&t(8,z=W.addMessages),"isLastMessage"in W&&t(9,ee=W.isLastMessage),"readOnly"in W&&t(10,G=W.readOnly)},r.$$.update=()=>{r.$$.dirty[0]&3|r.$$.dirty[1]&512&&p.messages&&JSON.stringify(v)!==JSON.stringify(p.messages[D])&&(console.log(" ResponseMessage updated for message:",D),t(0,v=JSON.parse(JSON.stringify(p.messages[D])))),r.$$.dirty[0]&1|r.$$.dirty[1]&65536&&t(14,fe=s.find(W=>W.id===v.model)),r.$$.dirty[0]&2048&&(ke||(async()=>await Ne())()),r.$$.dirty[0]&1|r.$$.dirty[1]&512&&v!=null&&v.content&&console.log(` Rendering message ${D} content length: ${v.content.length}`),r.$$.dirty[0]&1&&t(22,l=mo(v==null?void 0:v.content))},[v,p,E,b,R,S,L,q,z,ee,G,ke,Q,ue,fe,de,Z,he,be,Me,pe,Ve,l,n,i,a,f,u,d,g,O,ie,ne,se,oe,ye,je,Oe,ze,h,D,A,N,k,B,T,H,s,Fe,tt,lt,ot,ft,xe,ut,ct,st,It,Mt,Et,Dt,Nt,Lr,Or,Ar,Hr,Pr,jr,qr,zr,Ur,Wr,Fr,Jr,Gr,Kr,Qr,Zr,Yr,Xr,$r,xr,en]}class Rr extends Re{constructor(e){super(),Le(this,e,_o,co,Ce,{chatId:39,history:1,messageId:40,message:0,siblings:2,showPreviousMessage:3,showNextMessage:4,updateChat:41,editMessage:42,saveMessage:43,rateMessage:44,actionMessage:5,deleteMessage:45,submitMessage:46,continueResponse:6,regenerateResponse:7,addMessages:8,isLastMessage:9,readOnly:10},null,[-1,-1,-1,-1])}}function vo(r){let e,t;return{c(){e=_e("svg"),t=_e("path"),this.h()},l(l){e=ve(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=y(e);t=ve(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),y(t).forEach(m),s.forEach(m),this.h()},h(){c(t,"stroke-linecap","round"),c(t,"stroke-linejoin","round"),c(t,"d","M8 8v8m0-8a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm0 8a2 2 0 1 0 0 4 2 2 0 0 0 0-4Zm6-2a2 2 0 1 1 4 0 2 2 0 0 1-4 0Zm0 0h-1a5 5 0 0 1-5-5v-.5"),c(e,"xmlns","http://www.w3.org/2000/svg"),c(e,"fill","none"),c(e,"viewBox","0 0 24 24"),c(e,"stroke-width",r[1]),c(e,"stroke","currentColor"),c(e,"class",r[0])},m(l,s){C(l,e,s),_(e,t)},p(l,[s]){s&2&&c(e,"stroke-width",l[1]),s&1&&c(e,"class",l[0])},i:ge,o:ge,d(l){l&&m(e)}}}function po(r,e,t){let{className:l="w-4 h-4"}=e,{strokeWidth:s="1.5"}=e;return r.$$set=n=>{"className"in n&&t(0,l=n.className),"strokeWidth"in n&&t(1,s=n.strokeWidth)},[l,s]}class bo extends Re{constructor(e){super(),Le(this,e,po,vo,Ce,{className:0,strokeWidth:1})}}function zt(r){var l;const e=r.slice(),t=(l=e[0].messages[e[2]])==null?void 0:l.merged;return e[16]=t,e}function Os(r,e,t){const l=r.slice();return l[36]=e[t],l}function Ut(r){const e=r.slice(),t=e[19][e[36]].messageIds[e[20][e[36]]];return e[39]=t,e}function As(r){let e,t,l,s,n,i=De(Object.keys(r[19])),o=[];for(let u=0;u<i.length;u+=1)o[u]=qs(Os(r,i,u));const a=u=>V(o[u],1,1,()=>{o[u]=null});let f=!r[4]&&zs(r);return{c(){e=I("div"),t=I("div");for(let u=0;u<o.length;u+=1)o[u].c();s=P(),f&&f.c(),this.h()},l(u){e=M(u,"DIV",{});var d=y(e);t=M(d,"DIV",{class:!0,id:!0});var g=y(t);for(let h=0;h<o.length;h+=1)o[h].l(g);g.forEach(m),s=j(d),f&&f.l(d),d.forEach(m),this.h()},h(){c(t,"class","flex snap-x snap-mandatory overflow-x-auto scrollbar-hidden"),c(t,"id",l="responses-container-"+r[1]+"-"+r[18].id)},m(u,d){C(u,e,d),_(e,t);for(let g=0;g<o.length;g+=1)o[g]&&o[g].m(t,null);_(e,s),f&&f.m(e,null),n=!0},p(u,d){if(d[0]&54132727){i=De(Object.keys(u[19]));let g;for(g=0;g<i.length;g+=1){const h=Os(u,i,g);o[g]?(o[g].p(h,d),w(o[g],1)):(o[g]=qs(h),o[g].c(),w(o[g],1),o[g].m(t,null))}for(te(),g=i.length;g<o.length;g+=1)a(g);le()}(!n||d[0]&262146&&l!==(l="responses-container-"+u[1]+"-"+u[18].id))&&c(t,"id",l),u[4]?f&&(te(),V(f,1,1,()=>{f=null}),le()):f?(f.p(u,d),d[0]&16&&w(f,1)):(f=zs(u),f.c(),w(f,1),f.m(e,null))},i(u){if(!n){for(let d=0;d<i.length;d+=1)w(o[d]);w(f),n=!0}},o(u){o=o.filter(Boolean);for(let d=0;d<o.length;d+=1)V(o[d]);V(f),n=!1},d(u){u&&m(e),We(o,u),f&&f.d()}}}function Hs(r){let e,t=r[0].currentId,l,s,n,i,o,a=js(r);function f(){return r[32](r[39])}return{c(){e=I("div"),a.c(),l=P(),this.h()},l(u){e=M(u,"DIV",{class:!0});var d=y(e);a.l(d),l=j(d),d.forEach(m),this.h()},h(){var u;c(e,"class",s="snap-center w-full max-w-full m-1 border "+(((u=r[0].messages[r[2]])==null?void 0:u.modelIdx)==r[36]?`border-gray-100 dark:border-gray-850 border-[1.5px] ${r[21]?"min-w-full":"min-w-80"}`:`border-gray-100 dark:border-gray-850 border-dashed ${r[21]?"min-w-full":"min-w-80"}`)+" transition-all p-5 rounded-2xl")},m(u,d){C(u,e,d),a.m(e,null),_(e,l),n=!0,i||(o=me(e,"click",f),i=!0)},p(u,d){var g;r=u,d[0]&1&&Ce(t,t=r[0].currentId)?(te(),V(a,1,1,ge),le(),a=js(r),a.c(),w(a,1),a.m(e,l)):a.p(r,d),(!n||d[0]&2621445&&s!==(s="snap-center w-full max-w-full m-1 border "+(((g=r[0].messages[r[2]])==null?void 0:g.modelIdx)==r[36]?`border-gray-100 dark:border-gray-850 border-[1.5px] ${r[21]?"min-w-full":"min-w-80"}`:`border-gray-100 dark:border-gray-850 border-dashed ${r[21]?"min-w-full":"min-w-80"}`)+" transition-all p-5 rounded-2xl"))&&c(e,"class",s)},i(u){n||(w(a),n=!0)},o(u){V(a),n=!1},d(u){u&&m(e),a.d(u),i=!1,o()}}}function Ps(r){let e,t;function l(){return r[29](r[36])}function s(){return r[30](r[36])}function n(...i){return r[31](r[36],...i)}return e=new Rr({props:{chatId:r[1],history:r[0],messageId:r[39],isLastMessage:!0,siblings:r[19][r[36]].messageIds,showPreviousMessage:l,showNextMessage:s,updateChat:r[5],editMessage:r[6],saveMessage:r[7],rateMessage:r[8],deleteMessage:r[11],actionMessage:r[9],submitMessage:r[10],continueResponse:r[12],regenerateResponse:n,addMessages:r[14],readOnly:r[4]}}),{c(){Y(e.$$.fragment)},l(i){X(e.$$.fragment,i)},m(i,o){$(e,i,o),t=!0},p(i,o){r=i;const a={};o[0]&2&&(a.chatId=r[1]),o[0]&1&&(a.history=r[0]),o[0]&1572864&&(a.messageId=r[39]),o[0]&524288&&(a.siblings=r[19][r[36]].messageIds),o[0]&524288&&(a.showPreviousMessage=l),o[0]&524288&&(a.showNextMessage=s),o[0]&32&&(a.updateChat=r[5]),o[0]&64&&(a.editMessage=r[6]),o[0]&128&&(a.saveMessage=r[7]),o[0]&256&&(a.rateMessage=r[8]),o[0]&2048&&(a.deleteMessage=r[11]),o[0]&512&&(a.actionMessage=r[9]),o[0]&1024&&(a.submitMessage=r[10]),o[0]&4096&&(a.continueResponse=r[12]),o[0]&1581056&&(a.regenerateResponse=n),o[0]&16384&&(a.addMessages=r[14]),o[0]&16&&(a.readOnly=r[4]),e.$set(a)},i(i){t||(w(e.$$.fragment,i),t=!0)},o(i){V(e.$$.fragment,i),t=!1},d(i){x(e,i)}}}function js(r){let e,t,l=r[16]&&Ps(r);return{c(){l&&l.c(),e=ae()},l(s){l&&l.l(s),e=ae()},m(s,n){l&&l.m(s,n),C(s,e,n),t=!0},p(s,n){s[16]?l?(l.p(s,n),n[0]&65536&&w(l,1)):(l=Ps(s),l.c(),w(l,1),l.m(e.parentNode,e)):l&&(te(),V(l,1,1,()=>{l=null}),le())},i(s){t||(w(l),t=!0)},o(s){V(l),t=!1},d(s){s&&m(e),l&&l.d(s)}}}function qs(r){let e,t,l=r[20][r[36]]!==void 0&&r[19][r[36]].messageIds.length>0&&Hs(Ut(r));return{c(){l&&l.c(),e=ae()},l(s){l&&l.l(s),e=ae()},m(s,n){l&&l.m(s,n),C(s,e,n),t=!0},p(s,n){s[20][s[36]]!==void 0&&s[19][s[36]].messageIds.length>0?l?(l.p(Ut(s),n),n[0]&1572864&&w(l,1)):(l=Hs(Ut(s)),l.c(),w(l,1),l.m(e.parentNode,e)):l&&(te(),V(l,1,1,()=>{l=null}),le())},i(s){t||(w(l),t=!0)},o(s){V(l),t=!1},d(s){s&&m(e),l&&l.d(s)}}}function zs(r){let e=!Object.keys(r[19]).find(r[28]),t,l,s=e&&Us(r);return{c(){s&&s.c(),t=ae()},l(n){s&&s.l(n),t=ae()},m(n,i){s&&s.m(n,i),C(n,t,i),l=!0},p(n,i){i[0]&1572865&&(e=!Object.keys(n[19]).find(n[28])),e?s?(s.p(n,i),i[0]&1572865&&w(s,1)):(s=Us(n),s.c(),w(s,1),s.m(t.parentNode,t)):s&&(te(),V(s,1,1,()=>{s=null}),le())},i(n){l||(w(s),l=!0)},o(n){V(s),l=!1},d(n){n&&m(t),s&&s.d(n)}}}function Us(r){var o,a;let e,t,l,s,n=((a=(o=r[0].messages[r[2]])==null?void 0:o.merged)==null?void 0:a.status)&&Ws(zt(r)),i=r[3]&&Js(r);return{c(){e=I("div"),t=I("div"),n&&n.c(),l=P(),i&&i.c(),this.h()},l(f){e=M(f,"DIV",{class:!0});var u=y(e);t=M(u,"DIV",{class:!0});var d=y(t);n&&n.l(d),d.forEach(m),l=j(u),i&&i.l(u),u.forEach(m),this.h()},h(){c(t,"class","w-full"),c(e,"class","flex justify-end")},m(f,u){C(f,e,u),_(e,t),n&&n.m(t,null),_(e,l),i&&i.m(e,null),s=!0},p(f,u){var d,g;(g=(d=f[0].messages[f[2]])==null?void 0:d.merged)!=null&&g.status?n?(n.p(zt(f),u),u[0]&5&&w(n,1)):(n=Ws(zt(f)),n.c(),w(n,1),n.m(t,null)):n&&(te(),V(n,1,1,()=>{n=null}),le()),f[3]?i?(i.p(f,u),u[0]&8&&w(i,1)):(i=Js(f),i.c(),w(i,1),i.m(e,null)):i&&(te(),V(i,1,1,()=>{i=null}),le())},i(f){s||(w(n),w(i),s=!0)},o(f){V(n),V(i),s=!1},d(f){f&&m(e),n&&n.d(),i&&i.d()}}}function Ws(r){let e,t,l,s,n,i,o;t=new Jt({props:{$$slots:{default:[ko]},$$scope:{ctx:r}}});const a=[yo,wo],f=[];function u(d,g){var h;return(((h=d[16])==null?void 0:h.content)??"")===""?0:1}return n=u(r),i=f[n]=a[n](r),{c(){e=I("div"),Y(t.$$.fragment),l=P(),s=I("div"),i.c(),this.h()},l(d){e=M(d,"DIV",{class:!0});var g=y(e);X(t.$$.fragment,g),l=j(g),s=M(g,"DIV",{class:!0});var h=y(s);i.l(h),h.forEach(m),g.forEach(m),this.h()},h(){c(s,"class","mt-1 markdown-prose w-full min-w-full"),c(e,"class","w-full rounded-xl pl-5 pr-2 py-2")},m(d,g){C(d,e,g),$(t,e,null),_(e,l),_(e,s),f[n].m(s,null),o=!0},p(d,g){const h={};g[0]&5|g[1]&512&&(h.$$scope={dirty:g,ctx:d}),t.$set(h);let p=n;n=u(d),n===p?f[n].p(d,g):(te(),V(f[p],1,1,()=>{f[p]=null}),le(),i=f[n],i?i.p(d,g):(i=f[n]=a[n](d),i.c()),w(i,1),i.m(s,null))},i(d){o||(w(t.$$.fragment,d),w(i),o=!0)},o(d){V(t.$$.fragment,d),V(i),o=!1},d(d){d&&m(e),x(t),f[n].d()}}}function Fs(r){let e,t=at(r[16].timestamp*1e3).format("LT")+"",l;return{c(){e=I("span"),l=F(t),this.h()},l(s){e=M(s,"SPAN",{class:!0});var n=y(e);l=J(n,t),n.forEach(m),this.h()},h(){c(e,"class","self-center invisible group-hover:visible text-gray-400 text-xs font-medium uppercase ml-0.5 -mt-0.5")},m(s,n){C(s,e,n),_(e,l)},p(s,n){n[0]&5&&t!==(t=at(s[16].timestamp*1e3).format("LT")+"")&&K(l,t)},d(s){s&&m(e)}}}function ko(r){let e,t,l=r[16].timestamp&&Fs(r);return{c(){e=F(`Merged Response

									`),l&&l.c(),t=ae()},l(s){e=J(s,`Merged Response

									`),l&&l.l(s),t=ae()},m(s,n){C(s,e,n),l&&l.m(s,n),C(s,t,n)},p(s,n){s[16].timestamp?l?l.p(s,n):(l=Fs(s),l.c(),l.m(t.parentNode,t)):l&&(l.d(1),l=null)},d(s){s&&(m(e),m(t)),l&&l.d(s)}}}function wo(r){let e,t;return e=new yt({props:{id:"merged",content:r[16].content??""}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const n={};s[0]&5&&(n.content=l[16].content??""),e.$set(n)},i(l){t||(w(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function yo(r){let e,t;return e=new Qt({}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p:ge,i(l){t||(w(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Js(r){let e,t,l;return t=new Be({props:{content:r[22].t("Merge Responses"),placement:"bottom",$$slots:{default:[Io]},$$scope:{ctx:r}}}),{c(){e=I("div"),Y(t.$$.fragment),this.h()},l(s){e=M(s,"DIV",{class:!0});var n=y(e);X(t.$$.fragment,n),n.forEach(m),this.h()},h(){c(e,"class","shrink-0 text-gray-600 dark:text-gray-500 mt-1")},m(s,n){C(s,e,n),$(t,e,null),l=!0},p(s,n){const i={};n[0]&4194304&&(i.content=s[22].t("Merge Responses")),n[1]&512&&(i.$$scope={dirty:n,ctx:s}),t.$set(i)},i(s){l||(w(t.$$.fragment,s),l=!0)},o(s){V(t.$$.fragment,s),l=!1},d(s){s&&m(e),x(t)}}}function Io(r){let e,t,l,s,n;return t=new bo({props:{className:" size-5 "}}),{c(){e=I("button"),Y(t.$$.fragment),this.h()},l(i){e=M(i,"BUTTON",{type:!0,id:!0,class:!0});var o=y(e);X(t.$$.fragment,o),o.forEach(m),this.h()},h(){c(e,"type","button"),c(e,"id","merge-response-button"),c(e,"class","visible p-1 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")},m(i,o){C(i,e,o),$(t,e,null),l=!0,s||(n=me(e,"click",r[33]),s=!0)},p:ge,i(i){l||(w(t.$$.fragment,i),l=!0)},o(i){V(t.$$.fragment,i),l=!1},d(i){i&&m(e),x(t),s=!1,n()}}}function Mo(r){let e,t,l=r[18]&&As(r);return{c(){l&&l.c(),e=ae()},l(s){l&&l.l(s),e=ae()},m(s,n){l&&l.m(s,n),C(s,e,n),t=!0},p(s,n){s[18]?l?(l.p(s,n),n[0]&262144&&w(l,1)):(l=As(s),l.c(),w(l,1),l.m(e.parentNode,e)):l&&(te(),V(l,1,1,()=>{l=null}),le())},i(s){t||(w(l),t=!0)},o(s){V(l),t=!1},d(s){s&&m(e),l&&l.d(s)}}}function Eo(r,e,t){let l,s;Ee(r,yr,U=>t(21,l=U));const n=Qe("i18n");Ee(r,n,U=>t(22,s=U)),at.extend(Mr);let{chatId:i}=e,{history:o}=e,{messageId:a}=e,{isLastMessage:f}=e,{readOnly:u=!1}=e,{updateChat:d}=e,{editMessage:g}=e,{saveMessage:h}=e,{rateMessage:p}=e,{actionMessage:D}=e,{submitMessage:v}=e,{deleteMessage:E}=e,{continueResponse:b}=e,{regenerateResponse:R}=e,{mergeResponses:A}=e,{addMessages:N}=e,{triggerScroll:k}=e;pt();let B,S,T={},H={},L=JSON.parse(JSON.stringify(o.messages[a]));const q=async U=>{t(20,H[U]=Math.max(0,H[U]-1),H);let he=T[U].messageIds[H[U]];console.log(he);let ce=o.messages[he].childrenIds;for(;ce.length!==0;)he=ce.at(-1),ce=o.messages[he].childrenIds;t(0,o.currentId=he,o),await Ne(),await d(),k()},z=async U=>{t(20,H[U]=Math.min(T[U].messageIds.length-1,H[U]+1),H);let he=T[U].messageIds[H[U]];console.log(he);let ce=o.messages[he].childrenIds;for(;ce.length!==0;)he=ce.at(-1),ce=o.messages[he].childrenIds;t(0,o.currentId=he,o),await Ne(),await d(),k()},ee=async()=>{console.log("multiresponse:initHandler"),await Ne(),t(17,B=a),t(18,S=o.messages[a].parentId?o.messages[o.messages[a].parentId]:null),t(19,T=S==null?void 0:S.models.reduce((U,he,ce)=>{let be=S==null?void 0:S.childrenIds.map(Me=>o.messages[Me]).filter(Me=>(Me==null?void 0:Me.modelIdx)===ce).map(Me=>Me.id);if(be.length===0){let Me=S==null?void 0:S.childrenIds.map(pe=>o.messages[pe]).filter(pe=>(pe==null?void 0:pe.model)===he);Me.forEach(pe=>{pe.modelIdx=ce}),be=Me.map(pe=>pe.id)}return{...U,[ce]:{messageIds:be}}},{})),t(20,H=S==null?void 0:S.models.reduce((U,he,ce)=>{const be=T[ce].messageIds.findIndex(Me=>Me===a);return be!==-1?{...U,[ce]:be}:{...U,[ce]:T[ce].messageIds.length-1}},{})),console.log(T,H),await Ne()},G=async()=>{const U=Object.keys(T).map(he=>{const{messageIds:ce}=T[he],be=ce[H[he]];return o.messages[be].content});A(a,U,i)};bt(async()=>{await ee(),await Ne();const U=document.getElementById(`message-${a}`);U&&U.scrollIntoView({block:"start"})});const Q=U=>{var be;const{messageIds:he}=T[U],ce=he[H[U]];return!((be=o.messages[ce])!=null&&be.done)},ue=U=>q(U),fe=U=>z(U),ke=async(U,he)=>{R(he),await Ne(),t(20,H[U]=T[U].messageIds.length-1,H)},de=async U=>{if(a!=U){let he=U,ce=o.messages[he].childrenIds;for(;ce.length!==0;)he=ce.at(-1),ce=o.messages[he].childrenIds;t(0,o.currentId=he,o),await Ne(),await d(),k()}},Z=()=>{G()};return r.$$set=U=>{"chatId"in U&&t(1,i=U.chatId),"history"in U&&t(0,o=U.history),"messageId"in U&&t(2,a=U.messageId),"isLastMessage"in U&&t(3,f=U.isLastMessage),"readOnly"in U&&t(4,u=U.readOnly),"updateChat"in U&&t(5,d=U.updateChat),"editMessage"in U&&t(6,g=U.editMessage),"saveMessage"in U&&t(7,h=U.saveMessage),"rateMessage"in U&&t(8,p=U.rateMessage),"actionMessage"in U&&t(9,D=U.actionMessage),"submitMessage"in U&&t(10,v=U.submitMessage),"deleteMessage"in U&&t(11,E=U.deleteMessage),"continueResponse"in U&&t(12,b=U.continueResponse),"regenerateResponse"in U&&t(13,R=U.regenerateResponse),"mergeResponses"in U&&t(27,A=U.mergeResponses),"addMessages"in U&&t(14,N=U.addMessages),"triggerScroll"in U&&t(15,k=U.triggerScroll)},r.$$.update=()=>{r.$$.dirty[0]&65541&&o.messages&&JSON.stringify(L)!==JSON.stringify(o.messages[a])&&t(16,L=JSON.parse(JSON.stringify(o.messages[a])))},[o,i,a,f,u,d,g,h,p,D,v,E,b,R,N,k,L,B,S,T,H,l,s,n,q,z,G,A,Q,ue,fe,ke,de,Z]}class Do extends Re{constructor(e){super(),Le(this,e,Eo,Mo,Ce,{chatId:1,history:0,messageId:2,isLastMessage:3,readOnly:4,updateChat:5,editMessage:6,saveMessage:7,rateMessage:8,actionMessage:9,submitMessage:10,deleteMessage:11,continueResponse:12,regenerateResponse:13,mergeResponses:27,addMessages:14,triggerScroll:15},null,[-1,-1])}}function Gs(r,e,t){const l=r.slice();return l[41]=e[t],l}function Ks(r){var n,i,o,a;let e,t,l,s;return t=new Er({props:{src:r[6].user?((o=(i=(n=r[13].find(r[27]))==null?void 0:n.info)==null?void 0:i.meta)==null?void 0:o.profile_image_url)??"/user.png":((a=r[0])==null?void 0:a.profile_image_url)??"/user.png",className:"size-8"}}),{c(){e=I("div"),Y(t.$$.fragment),this.h()},l(f){e=M(f,"DIV",{class:!0});var u=y(e);X(t.$$.fragment,u),u.forEach(m),this.h()},h(){var f;c(e,"class",l=`shrink-0 ${(((f=r[12])==null?void 0:f.chatDirection)??"LTR")==="LTR"?"mr-3":"ml-3"}`)},m(f,u){C(f,e,u),$(t,e,null),s=!0},p(f,u){var g,h,p,D,v;const d={};u[0]&8257&&(d.src=f[6].user?((p=(h=(g=f[13].find(f[27]))==null?void 0:g.info)==null?void 0:h.meta)==null?void 0:p.profile_image_url)??"/user.png":((D=f[0])==null?void 0:D.profile_image_url)??"/user.png"),t.$set(d),(!s||u[0]&4096&&l!==(l=`shrink-0 ${(((v=f[12])==null?void 0:v.chatDirection)??"LTR")==="LTR"?"mr-3":"ml-3"}`))&&c(e,"class",l)},i(f){s||(w(t.$$.fragment,f),s=!0)},o(f){V(t.$$.fragment,f),s=!1},d(f){f&&m(e),x(t)}}}function Qs(r){let e,t,l;return t=new Jt({props:{$$slots:{default:[Bo]},$$scope:{ctx:r}}}),{c(){e=I("div"),Y(t.$$.fragment)},l(s){e=M(s,"DIV",{});var n=y(e);X(t.$$.fragment,n),n.forEach(m)},m(s,n){C(s,e,n),$(t,e,null),l=!0},p(s,n){const i={};n[0]&22593|n[1]&8192&&(i.$$scope={dirty:n,ctx:s}),t.$set(i)},i(s){l||(w(t.$$.fragment,s),l=!0)},o(s){V(t.$$.fragment,s),l=!1},d(s){s&&m(e),x(t)}}}function No(r){let e=r[11].t("You")+"",t;return{c(){t=F(e)},l(l){t=J(l,e)},m(l,s){C(l,t,s)},p(l,s){s[0]&2048&&e!==(e=l[11].t("You")+"")&&K(t,e)},d(l){l&&m(t)}}}function Vo(r){let e=r[0].name+"",t;return{c(){t=F(e)},l(l){t=J(l,e)},m(l,s){C(l,t,s)},p(l,s){s[0]&1&&e!==(e=l[0].name+"")&&K(t,e)},d(l){l&&m(t)}}}function Co(r){var o;let e=r[11].t("You")+"",t,l,s,n=(((o=r[6])==null?void 0:o.user)??"")+"",i;return{c(){t=F(e),l=P(),s=I("span"),i=F(n),this.h()},l(a){t=J(a,e),l=j(a),s=M(a,"SPAN",{class:!0});var f=y(s);i=J(f,n),f.forEach(m),this.h()},h(){c(s,"class","text-gray-500 text-sm font-medium")},m(a,f){C(a,t,f),C(a,l,f),C(a,s,f),_(s,i)},p(a,f){var u;f[0]&2048&&e!==(e=a[11].t("You")+"")&&K(t,e),f[0]&64&&n!==(n=(((u=a[6])==null?void 0:u.user)??"")+"")&&K(i,n)},d(a){a&&(m(t),m(l),m(s))}}}function Zs(r){let e,t,l;return t=new Be({props:{content:at(r[6].timestamp*1e3).format("LLLL"),$$slots:{default:[To]},$$scope:{ctx:r}}}),{c(){e=I("div"),Y(t.$$.fragment),this.h()},l(s){e=M(s,"DIV",{class:!0});var n=y(e);X(t.$$.fragment,n),n.forEach(m),this.h()},h(){c(e,"class","self-center text-xs invisible group-hover:visible text-gray-400 font-medium first-letter:capitalize ml-0.5 translate-y-[1px]")},m(s,n){C(s,e,n),$(t,e,null),l=!0},p(s,n){const i={};n[0]&64&&(i.content=at(s[6].timestamp*1e3).format("LLLL")),n[0]&64|n[1]&8192&&(i.$$scope={dirty:n,ctx:s}),t.$set(i)},i(s){l||(w(t.$$.fragment,s),l=!0)},o(s){V(t.$$.fragment,s),l=!1},d(s){s&&m(e),x(t)}}}function To(r){let e,t=Tt(r[6].timestamp*1e3)+"",l;return{c(){e=I("span"),l=F(t),this.h()},l(s){e=M(s,"SPAN",{class:!0});var n=y(e);l=J(n,t),n.forEach(m),this.h()},h(){c(e,"class","line-clamp-1")},m(s,n){C(s,e,n),_(e,l)},p(s,n){n[0]&64&&t!==(t=Tt(s[6].timestamp*1e3)+"")&&K(l,t)},d(s){s&&m(e)}}}function Bo(r){let e,t,l;function s(a,f){return a[6].user?Co:a[12].showUsername||a[14].name!==a[0].name?Vo:No}let n=s(r),i=n(r),o=r[6].timestamp&&Zs(r);return{c(){i.c(),e=P(),o&&o.c(),t=ae()},l(a){i.l(a),e=j(a),o&&o.l(a),t=ae()},m(a,f){i.m(a,f),C(a,e,f),o&&o.m(a,f),C(a,t,f),l=!0},p(a,f){n===(n=s(a))&&i?i.p(a,f):(i.d(1),i=n(a),i&&(i.c(),i.m(e.parentNode,e))),a[6].timestamp?o?(o.p(a,f),f[0]&64&&w(o,1)):(o=Zs(a),o.c(),w(o,1),o.m(t.parentNode,t)):o&&(te(),V(o,1,1,()=>{o=null}),le())},i(a){l||(w(o),l=!0)},o(a){V(o),l=!1},d(a){a&&(m(e),m(t)),i.d(a),o&&o.d(a)}}}function Ys(r){let e,t,l=De(r[6].files),s=[];for(let i=0;i<l.length;i+=1)s[i]=Xs(Gs(r,l,i));const n=i=>V(s[i],1,1,()=>{s[i]=null});return{c(){e=I("div");for(let i=0;i<s.length;i+=1)s[i].c();this.h()},l(i){e=M(i,"DIV",{class:!0});var o=y(e);for(let a=0;a<s.length;a+=1)s[a].l(o);o.forEach(m),this.h()},h(){c(e,"class","mt-2.5 mb-1 w-full flex flex-col justify-end overflow-x-auto gap-1 flex-wrap")},m(i,o){C(i,e,o);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);t=!0},p(i,o){if(o[0]&4160){l=De(i[6].files);let a;for(a=0;a<l.length;a+=1){const f=Gs(i,l,a);s[a]?(s[a].p(f,o),w(s[a],1)):(s[a]=Xs(f),s[a].c(),w(s[a],1),s[a].m(e,null))}for(te(),a=l.length;a<s.length;a+=1)n(a);le()}},i(i){if(!t){for(let o=0;o<l.length;o+=1)w(s[o]);t=!0}},o(i){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)V(s[o]);t=!1},d(i){i&&m(e),We(s,i)}}}function So(r){var l;let e,t;return e=new Cn({props:{item:r[41],url:r[41].url,name:r[41].name,type:r[41].type,size:(l=r[41])==null?void 0:l.size,colorClassName:"bg-white dark:bg-gray-850 "}}),{c(){Y(e.$$.fragment)},l(s){X(e.$$.fragment,s)},m(s,n){$(e,s,n),t=!0},p(s,n){var o;const i={};n[0]&64&&(i.item=s[41]),n[0]&64&&(i.url=s[41].url),n[0]&64&&(i.name=s[41].name),n[0]&64&&(i.type=s[41].type),n[0]&64&&(i.size=(o=s[41])==null?void 0:o.size),e.$set(i)},i(s){t||(w(e.$$.fragment,s),t=!0)},o(s){V(e.$$.fragment,s),t=!1},d(s){x(e,s)}}}function Ro(r){let e,t;return e=new Dr({props:{src:r[41].url,imageClassName:" max-h-96 rounded-lg"}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const n={};s[0]&64&&(n.src=l[41].url),e.$set(n)},i(l){t||(w(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Xs(r){let e,t,l,s,n,i;const o=[Ro,So],a=[];function f(u,d){return u[41].type==="image"?0:1}return t=f(r),l=a[t]=o[t](r),{c(){e=I("div"),l.c(),s=P(),this.h()},l(u){e=M(u,"DIV",{class:!0});var d=y(e);l.l(d),s=j(d),d.forEach(m),this.h()},h(){var u;c(e,"class",n=((u=r[12])==null?void 0:u.chatBubble)??!0?"self-end":"")},m(u,d){C(u,e,d),a[t].m(e,null),_(e,s),i=!0},p(u,d){var h;let g=t;t=f(u),t===g?a[t].p(u,d):(te(),V(a[g],1,1,()=>{a[g]=null}),le(),l=a[t],l?l.p(u,d):(l=a[t]=o[t](u),l.c()),w(l,1),l.m(e,s)),(!i||d[0]&4096&&n!==(n=((h=u[12])==null?void 0:h.chatBubble)??!0?"self-end":""))&&c(e,"class",n)},i(u){i||(w(l),i=!0)},o(u){V(l),i=!1},d(u){u&&m(e),a[t].d()}}}function $s(r){let e,t,l,s;const n=[Oo,Lo],i=[];function o(a,f){return a[8]===!0?0:1}return e=o(r),t=i[e]=n[e](r),{c(){t.c(),l=ae()},l(a){t.l(a),l=ae()},m(a,f){i[e].m(a,f),C(a,l,f),s=!0},p(a,f){let u=e;e=o(a),e===u?i[e].p(a,f):(te(),V(i[u],1,1,()=>{i[u]=null}),le(),t=i[e],t?t.p(a,f):(t=i[e]=n[e](a),t.c()),w(t,1),t.m(l.parentNode,l))},i(a){s||(w(t),s=!0)},o(a){V(t),s=!1},d(a){a&&m(l),i[e].d(a)}}}function Lo(r){var A,N;let e,t,l,s,n,i,o,a,f,u,d,g,h,p,D=r[6].content&&xs(r),v=!(((A=r[12])==null?void 0:A.chatBubble)??!0)&&er(r),E=!r[5]&&lr(r);u=new Be({props:{content:r[11].t("Copy"),placement:"bottom",$$slots:{default:[Ho]},$$scope:{ctx:r}}});let b=!r[4]&&!r[5]&&sr(r),R=(((N=r[12])==null?void 0:N.chatBubble)??!0)&&rr(r);return{c(){e=I("div"),t=I("div"),l=I("div"),D&&D.c(),i=P(),o=I("div"),v&&v.c(),a=P(),E&&E.c(),f=P(),Y(u.$$.fragment),d=P(),b&&b.c(),g=P(),R&&R.c(),this.h()},l(k){e=M(k,"DIV",{class:!0});var B=y(e);t=M(B,"DIV",{class:!0});var S=y(t);l=M(S,"DIV",{class:!0});var T=y(l);D&&D.l(T),T.forEach(m),S.forEach(m),i=j(B),o=M(B,"DIV",{class:!0});var H=y(o);v&&v.l(H),a=j(H),E&&E.l(H),f=j(H),X(u.$$.fragment,H),d=j(H),b&&b.l(H),g=j(H),R&&R.l(H),H.forEach(m),B.forEach(m),this.h()},h(){var k,B,S;c(l,"class",s="rounded-3xl "+(((k=r[12])==null?void 0:k.chatBubble)??!0?`max-w-[90%] px-5 py-2  bg-gray-50 dark:bg-gray-850 ${r[6].files?"rounded-tr-lg":""}`:" w-full")),c(t,"class",n="flex "+(((B=r[12])==null?void 0:B.chatBubble)??!0?"justify-end pb-1":"w-full")),c(o,"class",h="flex "+(((S=r[12])==null?void 0:S.chatBubble)??!0?"justify-end":"")+" text-gray-600 dark:text-gray-500"),c(e,"class","w-full")},m(k,B){C(k,e,B),_(e,t),_(t,l),D&&D.m(l,null),_(e,i),_(e,o),v&&v.m(o,null),_(o,a),E&&E.m(o,null),_(o,f),$(u,o,null),_(o,d),b&&b.m(o,null),_(o,g),R&&R.m(o,null),p=!0},p(k,B){var T,H,L,q,z;k[6].content?D?(D.p(k,B),B[0]&64&&w(D,1)):(D=xs(k),D.c(),w(D,1),D.m(l,null)):D&&(te(),V(D,1,1,()=>{D=null}),le()),(!p||B[0]&4160&&s!==(s="rounded-3xl "+(((T=k[12])==null?void 0:T.chatBubble)??!0?`max-w-[90%] px-5 py-2  bg-gray-50 dark:bg-gray-850 ${k[6].files?"rounded-tr-lg":""}`:" w-full")))&&c(l,"class",s),(!p||B[0]&4096&&n!==(n="flex "+(((H=k[12])==null?void 0:H.chatBubble)??!0?"justify-end pb-1":"w-full")))&&c(t,"class",n),((L=k[12])==null?void 0:L.chatBubble)??!0?v&&(v.d(1),v=null):v?v.p(k,B):(v=er(k),v.c(),v.m(o,a)),k[5]?E&&(te(),V(E,1,1,()=>{E=null}),le()):E?(E.p(k,B),B[0]&32&&w(E,1)):(E=lr(k),E.c(),w(E,1),E.m(o,f));const S={};B[0]&2048&&(S.content=k[11].t("Copy")),B[0]&64|B[1]&8192&&(S.$$scope={dirty:B,ctx:k}),u.$set(S),!k[4]&&!k[5]?b?(b.p(k,B),B[0]&48&&w(b,1)):(b=sr(k),b.c(),w(b,1),b.m(o,g)):b&&(te(),V(b,1,1,()=>{b=null}),le()),((q=k[12])==null?void 0:q.chatBubble)??!0?R?R.p(k,B):(R=rr(k),R.c(),R.m(o,null)):R&&(R.d(1),R=null),(!p||B[0]&4096&&h!==(h="flex "+(((z=k[12])==null?void 0:z.chatBubble)??!0?"justify-end":"")+" text-gray-600 dark:text-gray-500"))&&c(o,"class",h)},i(k){p||(w(D),w(E),w(u.$$.fragment,k),w(b),p=!0)},o(k){V(D),V(E),V(u.$$.fragment,k),V(b),p=!1},d(k){k&&m(e),D&&D.d(),v&&v.d(),E&&E.d(),x(u),b&&b.d(),R&&R.d()}}}function Oo(r){let e,t,l,s,n,i,o,a,f=r[11].t("Save")+"",u,d,g,h,p=r[11].t("Cancel")+"",D,v,E,b=r[11].t("Send")+"",R,A,N;return{c(){e=I("div"),t=I("div"),l=I("textarea"),n=P(),i=I("div"),o=I("div"),a=I("button"),u=F(f),d=P(),g=I("div"),h=I("button"),D=F(p),v=P(),E=I("button"),R=F(b),this.h()},l(k){e=M(k,"DIV",{class:!0});var B=y(e);t=M(B,"DIV",{class:!0});var S=y(t);l=M(S,"TEXTAREA",{id:!0,class:!0}),y(l).forEach(m),S.forEach(m),n=j(B),i=M(B,"DIV",{class:!0});var T=y(i);o=M(T,"DIV",{});var H=y(o);a=M(H,"BUTTON",{id:!0,class:!0});var L=y(a);u=J(L,f),L.forEach(m),H.forEach(m),d=j(T),g=M(T,"DIV",{class:!0});var q=y(g);h=M(q,"BUTTON",{id:!0,class:!0});var z=y(h);D=J(z,p),z.forEach(m),v=j(q),E=M(q,"BUTTON",{id:!0,class:!0});var ee=y(E);R=J(ee,b),ee.forEach(m),q.forEach(m),T.forEach(m),B.forEach(m),this.h()},h(){c(l,"id",s="message-edit-"+r[6].id),c(l,"class","bg-transparent outline-hidden w-full resize-none"),c(t,"class","max-h-96 overflow-auto"),c(a,"id","save-edit-message-button"),c(a,"class","px-4 py-2 bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 border dark:border-gray-700 text-gray-700 dark:text-gray-200 transition rounded-3xl"),c(h,"id","close-edit-message-button"),c(h,"class","px-4 py-2 bg-white dark:bg-gray-900 hover:bg-gray-100 text-gray-800 dark:text-gray-100 transition rounded-3xl"),c(E,"id","confirm-edit-message-button"),c(E,"class","px-4 py-2 bg-gray-900 dark:bg-white hover:bg-gray-850 text-gray-100 dark:text-gray-800 transition rounded-3xl"),c(g,"class","flex space-x-1.5"),c(i,"class","mt-2 mb-1 flex justify-between text-sm font-medium"),c(e,"class","w-full bg-gray-50 dark:bg-gray-800 rounded-3xl px-5 py-3 mb-2")},m(k,B){C(k,e,B),_(e,t),_(t,l),r[28](l),nt(l,r[9]),_(e,n),_(e,i),_(i,o),_(o,a),_(a,u),_(i,d),_(i,g),_(g,h),_(h,D),_(g,v),_(g,E),_(E,R),A||(N=[me(l,"input",r[29]),me(l,"input",qo),me(l,"keydown",r[30]),me(a,"click",r[31]),me(h,"click",r[32]),me(E,"click",r[33])],A=!0)},p(k,B){B[0]&64&&s!==(s="message-edit-"+k[6].id)&&c(l,"id",s),B[0]&512&&nt(l,k[9]),B[0]&2048&&f!==(f=k[11].t("Save")+"")&&K(u,f),B[0]&2048&&p!==(p=k[11].t("Cancel")+"")&&K(D,p),B[0]&2048&&b!==(b=k[11].t("Send")+"")&&K(R,b)},i:ge,o:ge,d(k){k&&m(e),r[28](null),A=!1,et(N)}}}function xs(r){let e,t;return e=new yt({props:{id:r[6].id,content:r[6].content}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const n={};s[0]&64&&(n.id=l[6].id),s[0]&64&&(n.content=l[6].content),e.$set(n)},i(l){t||(w(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function er(r){let e,t=r[1].length>1&&tr(r);return{c(){t&&t.c(),e=ae()},l(l){t&&t.l(l),e=ae()},m(l,s){t&&t.m(l,s),C(l,e,s)},p(l,s){l[1].length>1?t?t.p(l,s):(t=tr(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(l){l&&m(e),t&&t.d(l)}}}function tr(r){let e,t,l='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg>',s,n,i=r[1].indexOf(r[6].id)+1+"",o,a,f=r[1].length+"",u,d,g,h='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5"></path></svg>',p,D;return{c(){e=I("div"),t=I("button"),t.innerHTML=l,s=P(),n=I("div"),o=F(i),a=F("/"),u=F(f),d=P(),g=I("button"),g.innerHTML=h,this.h()},l(v){e=M(v,"DIV",{class:!0,dir:!0});var E=y(e);t=M(E,"BUTTON",{class:!0,"data-svelte-h":!0}),Te(t)!=="svelte-buado9"&&(t.innerHTML=l),s=j(E),n=M(E,"DIV",{class:!0});var b=y(n);o=J(b,i),a=J(b,"/"),u=J(b,f),b.forEach(m),d=j(E),g=M(E,"BUTTON",{class:!0,"data-svelte-h":!0}),Te(g)!=="svelte-4phel2"&&(g.innerHTML=h),E.forEach(m),this.h()},h(){c(t,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),c(n,"class","text-sm tracking-widest font-semibold self-center dark:text-gray-100"),c(g,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),c(e,"class","flex self-center"),c(e,"dir","ltr")},m(v,E){C(v,e,E),_(e,t),_(e,s),_(e,n),_(n,o),_(n,a),_(n,u),_(e,d),_(e,g),p||(D=[me(t,"click",r[34]),me(g,"click",r[35])],p=!0)},p(v,E){E[0]&66&&i!==(i=v[1].indexOf(v[6].id)+1+"")&&K(o,i),E[0]&2&&f!==(f=v[1].length+"")&&K(u,f)},d(v){v&&m(e),p=!1,et(D)}}}function lr(r){let e,t;return e=new Be({props:{content:r[11].t("Edit"),placement:"bottom",$$slots:{default:[Ao]},$$scope:{ctx:r}}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const n={};s[0]&2048&&(n.content=l[11].t("Edit")),s[1]&8192&&(n.$$scope={dirty:s,ctx:l}),e.$set(n)},i(l){t||(w(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Ao(r){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.3" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"></path></svg>',l,s;return{c(){e=I("button"),e.innerHTML=t,this.h()},l(n){e=M(n,"BUTTON",{class:!0,"data-svelte-h":!0}),Te(e)!=="svelte-tlrz1q"&&(e.innerHTML=t),this.h()},h(){c(e,"class","invisible group-hover:visible p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition edit-user-message-button")},m(n,i){C(n,e,i),l||(s=me(e,"click",r[36]),l=!0)},p:ge,d(n){n&&m(e),l=!1,s()}}}function Ho(r){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.3" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184"></path></svg>',l,s;return{c(){e=I("button"),e.innerHTML=t,this.h()},l(n){e=M(n,"BUTTON",{class:!0,"data-svelte-h":!0}),Te(e)!=="svelte-1ivgdx2"&&(e.innerHTML=t),this.h()},h(){c(e,"class","invisible group-hover:visible p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(n,i){C(n,e,i),l||(s=me(e,"click",r[37]),l=!0)},p:ge,d(n){n&&m(e),l=!1,s()}}}function sr(r){let e,t;return e=new Be({props:{content:r[11].t("Delete"),placement:"bottom",$$slots:{default:[Po]},$$scope:{ctx:r}}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const n={};s[0]&2048&&(n.content=l[11].t("Delete")),s[0]&128|s[1]&8192&&(n.$$scope={dirty:s,ctx:l}),e.$set(n)},i(l){t||(w(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function Po(r){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"></path></svg>',l,s;return{c(){e=I("button"),e.innerHTML=t,this.h()},l(n){e=M(n,"BUTTON",{class:!0,"data-svelte-h":!0}),Te(e)!=="svelte-146x2zz"&&(e.innerHTML=t),this.h()},h(){c(e,"class","invisible group-hover:visible p-1 rounded-sm dark:hover:text-white hover:text-black transition")},m(n,i){C(n,e,i),l||(s=me(e,"click",r[38]),l=!0)},p:ge,d(n){n&&m(e),l=!1,s()}}}function rr(r){let e,t=r[1].length>1&&nr(r);return{c(){t&&t.c(),e=ae()},l(l){t&&t.l(l),e=ae()},m(l,s){t&&t.m(l,s),C(l,e,s)},p(l,s){l[1].length>1?t?t.p(l,s):(t=nr(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(l){l&&m(e),t&&t.d(l)}}}function nr(r){let e,t,l='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg>',s,n,i=r[1].indexOf(r[6].id)+1+"",o,a,f=r[1].length+"",u,d,g,h='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5"></path></svg>',p,D;return{c(){e=I("div"),t=I("button"),t.innerHTML=l,s=P(),n=I("div"),o=F(i),a=F("/"),u=F(f),d=P(),g=I("button"),g.innerHTML=h,this.h()},l(v){e=M(v,"DIV",{class:!0,dir:!0});var E=y(e);t=M(E,"BUTTON",{class:!0,"data-svelte-h":!0}),Te(t)!=="svelte-buado9"&&(t.innerHTML=l),s=j(E),n=M(E,"DIV",{class:!0});var b=y(n);o=J(b,i),a=J(b,"/"),u=J(b,f),b.forEach(m),d=j(E),g=M(E,"BUTTON",{class:!0,"data-svelte-h":!0}),Te(g)!=="svelte-4phel2"&&(g.innerHTML=h),E.forEach(m),this.h()},h(){c(t,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),c(n,"class","text-sm tracking-widest font-semibold self-center dark:text-gray-100"),c(g,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),c(e,"class","flex self-center"),c(e,"dir","ltr")},m(v,E){C(v,e,E),_(e,t),_(e,s),_(e,n),_(n,o),_(n,a),_(n,u),_(e,d),_(e,g),p||(D=[me(t,"click",r[39]),me(g,"click",r[40])],p=!0)},p(v,E){E[0]&66&&i!==(i=v[1].indexOf(v[6].id)+1+"")&&K(o,i),E[0]&2&&f!==(f=v[1].length+"")&&K(u,f)},d(v){v&&m(e),p=!1,et(D)}}}function jo(r){var A,N;let e,t,l,s,n,i,o,a,f,u,d,g,h;function p(k){r[25](k)}let D={title:r[11].t("Delete message?")};r[7]!==void 0&&(D.show=r[7]),e=new Tr({props:D}),Pe.push(()=>Ke(e,"show",p)),e.$on("confirm",r[26]);let v=!(((A=r[12])==null?void 0:A.chatBubble)??!0)&&Ks(r),E=!(((N=r[12])==null?void 0:N.chatBubble)??!0)&&Qs(r),b=r[6].files&&Ys(r),R=r[6].content!==""&&$s(r);return{c(){Y(e.$$.fragment),l=P(),s=I("div"),v&&v.c(),n=P(),i=I("div"),E&&E.c(),o=P(),a=I("div"),b&&b.c(),f=P(),R&&R.c(),this.h()},l(k){X(e.$$.fragment,k),l=j(k),s=M(k,"DIV",{class:!0,dir:!0,id:!0});var B=y(s);v&&v.l(B),n=j(B),i=M(B,"DIV",{class:!0});var S=y(i);E&&E.l(S),o=j(S),a=M(S,"DIV",{class:!0});var T=y(a);b&&b.l(T),f=j(T),R&&R.l(T),T.forEach(m),S.forEach(m),B.forEach(m),this.h()},h(){c(a,"class",u="chat-"+r[6].role+" w-full min-w-full markdown-prose"),c(i,"class","flex-auto w-0 max-w-full pl-1"),c(s,"class","flex w-full user-message"),c(s,"dir",d=r[12].chatDirection),c(s,"id",g="message-"+r[6].id)},m(k,B){$(e,k,B),C(k,l,B),C(k,s,B),v&&v.m(s,null),_(s,n),_(s,i),E&&E.m(i,null),_(i,o),_(i,a),b&&b.m(a,null),_(a,f),R&&R.m(a,null),h=!0},p(k,B){var T,H;const S={};B[0]&2048&&(S.title=k[11].t("Delete message?")),!t&&B[0]&128&&(t=!0,S.show=k[7],Ge(()=>t=!1)),e.$set(S),((T=k[12])==null?void 0:T.chatBubble)??!0?v&&(te(),V(v,1,1,()=>{v=null}),le()):v?(v.p(k,B),B[0]&4096&&w(v,1)):(v=Ks(k),v.c(),w(v,1),v.m(s,n)),((H=k[12])==null?void 0:H.chatBubble)??!0?E&&(te(),V(E,1,1,()=>{E=null}),le()):E?(E.p(k,B),B[0]&4096&&w(E,1)):(E=Qs(k),E.c(),w(E,1),E.m(i,o)),k[6].files?b?(b.p(k,B),B[0]&64&&w(b,1)):(b=Ys(k),b.c(),w(b,1),b.m(a,f)):b&&(te(),V(b,1,1,()=>{b=null}),le()),k[6].content!==""?R?(R.p(k,B),B[0]&64&&w(R,1)):(R=$s(k),R.c(),w(R,1),R.m(a,null)):R&&(te(),V(R,1,1,()=>{R=null}),le()),(!h||B[0]&64&&u!==(u="chat-"+k[6].role+" w-full min-w-full markdown-prose"))&&c(a,"class",u),(!h||B[0]&4096&&d!==(d=k[12].chatDirection))&&c(s,"dir",d),(!h||B[0]&64&&g!==(g="message-"+k[6].id))&&c(s,"id",g)},i(k){h||(w(e.$$.fragment,k),w(v),w(E),w(b),w(R),h=!0)},o(k){V(e.$$.fragment,k),V(v),V(E),V(b),V(R),h=!1},d(k){k&&(m(l),m(s)),x(e,k),v&&v.d(),E&&E.d(),b&&b.d(),R&&R.d()}}}const qo=r=>{r.target.style.height="",r.target.style.height=`${r.target.scrollHeight}px`};function zo(r,e,t){let l,s,n,i;Ee(r,Lt,O=>t(12,s=O)),Ee(r,Rt,O=>t(13,n=O)),Ee(r,Ot,O=>t(14,i=O));const o=Qe("i18n");Ee(r,o,O=>t(11,l=O)),at.extend(Mr);let{user:a}=e,{history:f}=e,{messageId:u}=e,{siblings:d}=e,{showPreviousMessage:g}=e,{showNextMessage:h}=e,{editMessage:p}=e,{deleteMessage:D}=e,{isFirstMessage:v}=e,{readOnly:E}=e,b=!1,R=!1,A="",N,k=JSON.parse(JSON.stringify(f.messages[u]));const B=async O=>{await Ir(O)&&He.success(l.t("Copying to clipboard was successful!"))},S=async()=>{t(8,R=!0),t(9,A=k.content),await Ne(),t(10,N.style.height="",N),t(10,N.style.height=`${N.scrollHeight}px`,N),N==null||N.focus()},T=async(O=!0)=>{p(k.id,A,O),t(8,R=!1),t(9,A="")},H=()=>{t(8,R=!1),t(9,A="")},L=async()=>{D(k.id)};bt(()=>{});function q(O){b=O,t(7,b)}const z=()=>{L()},ee=O=>O.id===k.user;function G(O){Pe[O?"unshift":"push"](()=>{N=O,t(10,N)})}function Q(){A=this.value,t(9,A)}const ue=O=>{var ne,se;O.key==="Escape"&&((ne=document.getElementById("close-edit-message-button"))==null||ne.click());const re=O.metaKey||O.ctrlKey,ie=O.key==="Enter";re&&ie&&((se=document.getElementById("confirm-edit-message-button"))==null||se.click())},fe=()=>{T(!1)},ke=()=>{H()},de=()=>{T()},Z=()=>{g(k)},U=()=>{h(k)},he=()=>{S()},ce=()=>{B(k.content)},be=()=>{t(7,b=!0)},Me=()=>{g(k)},pe=()=>{h(k)};return r.$$set=O=>{"user"in O&&t(0,a=O.user),"history"in O&&t(21,f=O.history),"messageId"in O&&t(22,u=O.messageId),"siblings"in O&&t(1,d=O.siblings),"showPreviousMessage"in O&&t(2,g=O.showPreviousMessage),"showNextMessage"in O&&t(3,h=O.showNextMessage),"editMessage"in O&&t(23,p=O.editMessage),"deleteMessage"in O&&t(24,D=O.deleteMessage),"isFirstMessage"in O&&t(4,v=O.isFirstMessage),"readOnly"in O&&t(5,E=O.readOnly)},r.$$.update=()=>{r.$$.dirty[0]&6291520&&f.messages&&JSON.stringify(k)!==JSON.stringify(f.messages[u])&&t(6,k=JSON.parse(JSON.stringify(f.messages[u])))},[a,d,g,h,v,E,k,b,R,A,N,l,s,n,i,o,B,S,T,H,L,f,u,p,D,q,z,ee,G,Q,ue,fe,ke,de,Z,U,he,ce,be,Me,pe]}class Uo extends Re{constructor(e){super(),Le(this,e,zo,jo,Ce,{user:0,history:21,messageId:22,siblings:1,showPreviousMessage:2,showNextMessage:3,editMessage:23,deleteMessage:24,isFirstMessage:4,readOnly:5},null,[-1,-1])}}function ir(r){let e,t,l,s;const n=[Jo,Fo,Wo],i=[];function o(a,f){var u,d;return a[0].messages[a[3]].role==="user"?0:(((d=(u=a[0].messages[a[0].messages[a[3]].parentId])==null?void 0:u.models)==null?void 0:d.length)??1)===1?1:2}return e=o(r),t=i[e]=n[e](r),{c(){t.c(),l=ae()},l(a){t.l(a),l=ae()},m(a,f){i[e].m(a,f),C(a,l,f),s=!0},p(a,f){let u=e;e=o(a),e===u?i[e].p(a,f):(te(),V(i[u],1,1,()=>{i[u]=null}),le(),t=i[e],t?t.p(a,f):(t=i[e]=n[e](a),t.c()),w(t,1),t.m(l.parentNode,l))},i(a){s||(w(t),s=!0)},o(a){V(t),s=!1},d(a){a&&m(l),i[e].d(a)}}}function Wo(r){var i;let e,t,l;function s(o){r[21](o)}let n={chatId:r[1],messageId:r[3],isLastMessage:r[3]===((i=r[0])==null?void 0:i.currentId),updateChat:r[7],editMessage:r[8],saveMessage:r[9],rateMessage:r[11],actionMessage:r[12],submitMessage:r[13],deleteMessage:r[10],continueResponse:r[15],regenerateResponse:r[14],mergeResponses:r[16],triggerScroll:r[18],addMessages:r[17],readOnly:r[19]};return r[0]!==void 0&&(n.history=r[0]),e=new Do({props:n}),Pe.push(()=>Ke(e,"history",s)),{c(){Y(e.$$.fragment)},l(o){X(e.$$.fragment,o)},m(o,a){$(e,o,a),l=!0},p(o,a){var u;const f={};a&2&&(f.chatId=o[1]),a&8&&(f.messageId=o[3]),a&9&&(f.isLastMessage=o[3]===((u=o[0])==null?void 0:u.currentId)),a&128&&(f.updateChat=o[7]),a&256&&(f.editMessage=o[8]),a&512&&(f.saveMessage=o[9]),a&2048&&(f.rateMessage=o[11]),a&4096&&(f.actionMessage=o[12]),a&8192&&(f.submitMessage=o[13]),a&1024&&(f.deleteMessage=o[10]),a&32768&&(f.continueResponse=o[15]),a&16384&&(f.regenerateResponse=o[14]),a&65536&&(f.mergeResponses=o[16]),a&262144&&(f.triggerScroll=o[18]),a&131072&&(f.addMessages=o[17]),a&524288&&(f.readOnly=o[19]),!t&&a&1&&(t=!0,f.history=o[0],Ge(()=>t=!1)),e.$set(f)},i(o){l||(w(e.$$.fragment,o),l=!0)},o(o){V(e.$$.fragment,o),l=!1},d(o){x(e,o)}}}function Fo(r){var l;let e,t;return e=new Rr({props:{chatId:r[1],history:r[0],messageId:r[3],isLastMessage:r[3]===r[0].currentId,siblings:((l=r[0].messages[r[0].messages[r[3]].parentId])==null?void 0:l.childrenIds)??[],showPreviousMessage:r[5],showNextMessage:r[6],updateChat:r[7],editMessage:r[8],saveMessage:r[9],rateMessage:r[11],actionMessage:r[12],submitMessage:r[13],deleteMessage:r[10],continueResponse:r[15],regenerateResponse:r[14],addMessages:r[17],readOnly:r[19]}}),{c(){Y(e.$$.fragment)},l(s){X(e.$$.fragment,s)},m(s,n){$(e,s,n),t=!0},p(s,n){var o;const i={};n&2&&(i.chatId=s[1]),n&1&&(i.history=s[0]),n&8&&(i.messageId=s[3]),n&9&&(i.isLastMessage=s[3]===s[0].currentId),n&9&&(i.siblings=((o=s[0].messages[s[0].messages[s[3]].parentId])==null?void 0:o.childrenIds)??[]),n&32&&(i.showPreviousMessage=s[5]),n&64&&(i.showNextMessage=s[6]),n&128&&(i.updateChat=s[7]),n&256&&(i.editMessage=s[8]),n&512&&(i.saveMessage=s[9]),n&2048&&(i.rateMessage=s[11]),n&4096&&(i.actionMessage=s[12]),n&8192&&(i.submitMessage=s[13]),n&1024&&(i.deleteMessage=s[10]),n&32768&&(i.continueResponse=s[15]),n&16384&&(i.regenerateResponse=s[14]),n&131072&&(i.addMessages=s[17]),n&524288&&(i.readOnly=s[19]),e.$set(i)},i(s){t||(w(e.$$.fragment,s),t=!0)},o(s){V(e.$$.fragment,s),t=!1},d(s){x(e,s)}}}function Jo(r){var l;let e,t;return e=new Uo({props:{user:r[4],history:r[0],messageId:r[3],isFirstMessage:r[2]===0,siblings:r[0].messages[r[3]].parentId!==null?((l=r[0].messages[r[0].messages[r[3]].parentId])==null?void 0:l.childrenIds)??[]:Object.values(r[0].messages).filter(ar).map(or)??[],showPreviousMessage:r[5],showNextMessage:r[6],editMessage:r[8],deleteMessage:r[10],readOnly:r[19]}}),{c(){Y(e.$$.fragment)},l(s){X(e.$$.fragment,s)},m(s,n){$(e,s,n),t=!0},p(s,n){var o;const i={};n&16&&(i.user=s[4]),n&1&&(i.history=s[0]),n&8&&(i.messageId=s[3]),n&4&&(i.isFirstMessage=s[2]===0),n&9&&(i.siblings=s[0].messages[s[3]].parentId!==null?((o=s[0].messages[s[0].messages[s[3]].parentId])==null?void 0:o.childrenIds)??[]:Object.values(s[0].messages).filter(ar).map(or)??[]),n&32&&(i.showPreviousMessage=s[5]),n&64&&(i.showNextMessage=s[6]),n&256&&(i.editMessage=s[8]),n&1024&&(i.deleteMessage=s[10]),n&524288&&(i.readOnly=s[19]),e.$set(i)},i(s){t||(w(e.$$.fragment,s),t=!0)},o(s){V(e.$$.fragment,s),t=!1},d(s){x(e,s)}}}function Go(r){let e,t,l,s=r[0].messages[r[3]]&&ir(r);return{c(){e=I("div"),s&&s.c(),this.h()},l(n){e=M(n,"DIV",{class:!0});var i=y(e);s&&s.l(i),i.forEach(m),this.h()},h(){var n;c(e,"class",t="flex flex-col justify-between px-5 mb-3 w-full "+(((n=r[20])==null?void 0:n.widescreenMode)??null?"max-w-full":"max-w-5xl")+" mx-auto rounded-lg group")},m(n,i){C(n,e,i),s&&s.m(e,null),l=!0},p(n,[i]){var o;n[0].messages[n[3]]?s?(s.p(n,i),i&9&&w(s,1)):(s=ir(n),s.c(),w(s,1),s.m(e,null)):s&&(te(),V(s,1,1,()=>{s=null}),le()),(!l||i&1048576&&t!==(t="flex flex-col justify-between px-5 mb-3 w-full "+(((o=n[20])==null?void 0:o.widescreenMode)??null?"max-w-full":"max-w-5xl")+" mx-auto rounded-lg group"))&&c(e,"class",t)},i(n){l||(w(s),l=!0)},o(n){V(s),l=!1},d(n){n&&m(e),s&&s.d()}}}const ar=r=>r.parentId===null,or=r=>r.id;function Ko(r,e,t){let l;Ee(r,Lt,T=>t(20,l=T)),pt(),Qe("i18n");let{chatId:s}=e,{idx:n=0}=e,{history:i}=e,{messageId:o}=e,{user:a}=e,{showPreviousMessage:f}=e,{showNextMessage:u}=e,{updateChat:d}=e,{editMessage:g}=e,{saveMessage:h}=e,{deleteMessage:p}=e,{rateMessage:D}=e,{actionMessage:v}=e,{submitMessage:E}=e,{regenerateResponse:b}=e,{continueResponse:R}=e,{mergeResponses:A}=e,{addMessages:N}=e,{triggerScroll:k}=e,{readOnly:B=!1}=e;function S(T){i=T,t(0,i)}return r.$$set=T=>{"chatId"in T&&t(1,s=T.chatId),"idx"in T&&t(2,n=T.idx),"history"in T&&t(0,i=T.history),"messageId"in T&&t(3,o=T.messageId),"user"in T&&t(4,a=T.user),"showPreviousMessage"in T&&t(5,f=T.showPreviousMessage),"showNextMessage"in T&&t(6,u=T.showNextMessage),"updateChat"in T&&t(7,d=T.updateChat),"editMessage"in T&&t(8,g=T.editMessage),"saveMessage"in T&&t(9,h=T.saveMessage),"deleteMessage"in T&&t(10,p=T.deleteMessage),"rateMessage"in T&&t(11,D=T.rateMessage),"actionMessage"in T&&t(12,v=T.actionMessage),"submitMessage"in T&&t(13,E=T.submitMessage),"regenerateResponse"in T&&t(14,b=T.regenerateResponse),"continueResponse"in T&&t(15,R=T.continueResponse),"mergeResponses"in T&&t(16,A=T.mergeResponses),"addMessages"in T&&t(17,N=T.addMessages),"triggerScroll"in T&&t(18,k=T.triggerScroll),"readOnly"in T&&t(19,B=T.readOnly)},[i,s,n,o,a,f,u,d,g,h,p,D,v,E,b,R,A,N,k,B,l,S]}class Qo extends Re{constructor(e){super(),Le(this,e,Ko,Go,Ce,{chatId:1,idx:2,history:0,messageId:3,user:4,showPreviousMessage:5,showNextMessage:6,updateChat:7,editMessage:8,saveMessage:9,deleteMessage:10,rateMessage:11,actionMessage:12,submitMessage:13,regenerateResponse:14,continueResponse:15,mergeResponses:16,addMessages:17,triggerScroll:18,readOnly:19})}}function Zo(r){let e,t;return{c(){e=_e("svg"),t=_e("path"),this.h()},l(l){e=ve(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=y(e);t=ve(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),y(t).forEach(m),s.forEach(m),this.h()},h(){c(t,"stroke-linecap","round"),c(t,"stroke-linejoin","round"),c(t,"d","M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88"),c(e,"xmlns","http://www.w3.org/2000/svg"),c(e,"fill","none"),c(e,"viewBox","0 0 24 24"),c(e,"stroke-width",r[1]),c(e,"stroke","currentColor"),c(e,"class",r[0])},m(l,s){C(l,e,s),_(e,t)},p(l,[s]){s&2&&c(e,"stroke-width",l[1]),s&1&&c(e,"class",l[0])},i:ge,o:ge,d(l){l&&m(e)}}}function Yo(r,e,t){let{className:l="w-4 h-4"}=e,{strokeWidth:s="1.5"}=e;return r.$$set=n=>{"className"in n&&t(0,l=n.className),"strokeWidth"in n&&t(1,s=n.strokeWidth)},[l,s]}class Xo extends Re{constructor(e){super(),Le(this,e,Yo,Zo,Ce,{className:0,strokeWidth:1})}}function fr(r,e,t){const l=r.slice();return l[12]=e[t],l[14]=t,l}function $o(r){let e,t;return{c(){e=I("img"),this.h()},l(l){e=M(l,"IMG",{crossorigin:!0,src:!0,class:!0,alt:!0,draggable:!0}),this.h()},h(){var l,s,n;c(e,"crossorigin","anonymous"),it(e.src,t=((n=(s=(l=r[12])==null?void 0:l.info)==null?void 0:s.meta)==null?void 0:n.profile_image_url)??(r[3].language==="dg-DG"?"/doge.png":`${Bt}/static/favicon.png`))||c(e,"src",t),c(e,"class","size-[2.7rem] rounded-full border-[1px] border-gray-200 dark:border-none"),c(e,"alt","logo"),c(e,"draggable","false")},m(l,s){C(l,e,s)},p(l,s){var n,i,o;s&9&&!it(e.src,t=((o=(i=(n=l[12])==null?void 0:n.info)==null?void 0:i.meta)==null?void 0:o.profile_image_url)??(l[3].language==="dg-DG"?"/doge.png":`${Bt}/static/favicon.png`))&&c(e,"src",t)},d(l){l&&m(e)}}}function ur(r){var a,f,u;let e,t,l,s,n,i;t=new Be({props:{content:St.parse(vt(((u=(f=(a=r[0][r[2]])==null?void 0:a.info)==null?void 0:f.meta)==null?void 0:u.description)??"")),placement:"right",$$slots:{default:[$o]},$$scope:{ctx:r}}});function o(){return r[11](r[14])}return{c(){e=I("button"),Y(t.$$.fragment),l=P()},l(d){e=M(d,"BUTTON",{});var g=y(e);X(t.$$.fragment,g),l=j(g),g.forEach(m)},m(d,g){C(d,e,g),$(t,e,null),_(e,l),s=!0,n||(i=me(e,"click",o),n=!0)},p(d,g){var p,D,v;r=d;const h={};g&5&&(h.content=St.parse(vt(((v=(D=(p=r[0][r[2]])==null?void 0:p.info)==null?void 0:D.meta)==null?void 0:v.description)??""))),g&32777&&(h.$$scope={dirty:g,ctx:r}),t.$set(h)},i(d){s||(w(t.$$.fragment,d),s=!0)},o(d){V(t.$$.fragment,d),s=!1},d(d){d&&m(e),x(t),n=!1,i()}}}function cr(r){let e,t;return e=new Be({props:{content:"This chat won't appear in history and your messages will not be saved.",className:"w-fit",placement:"top-start",$$slots:{default:[xo]},$$scope:{ctx:r}}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},i(l){t||(w(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function xo(r){let e,t,l,s;return t=new Xo({props:{strokeWidth:"2.5",className:"size-5"}}),{c(){e=I("div"),Y(t.$$.fragment),l=F(" Temporary Chat"),this.h()},l(n){e=M(n,"DIV",{class:!0});var i=y(e);X(t.$$.fragment,i),l=J(i," Temporary Chat"),i.forEach(m),this.h()},h(){c(e,"class","flex items-center gap-2 text-gray-500 font-medium text-lg my-2 w-fit")},m(n,i){C(n,e,i),$(t,e,null),_(e,l),s=!0},p:ge,i(n){s||(w(t.$$.fragment,n),s=!0)},o(n){V(t.$$.fragment,n),s=!1},d(n){n&&m(e),x(t)}}}function ef(r){let e=r[3].t("Hello, {{name}}",{name:r[5].name})+"",t;return{c(){t=F(e)},l(l){t=J(l,e)},m(l,s){C(l,t,s)},p(l,s){s&40&&e!==(e=l[3].t("Hello, {{name}}",{name:l[5].name})+"")&&K(t,e)},d(l){l&&m(t)}}}function tf(r){var l;let e=((l=r[0][r[2]])==null?void 0:l.name)+"",t;return{c(){t=F(e)},l(s){t=J(s,e)},m(s,n){C(s,t,n)},p(s,n){var i;n&5&&e!==(e=((i=s[0][s[2]])==null?void 0:i.name)+"")&&K(t,e)},d(s){s&&m(t)}}}function lf(r){let e,t=r[3].t("How can I help you today?")+"",l;return{c(){e=I("div"),l=F(t),this.h()},l(s){e=M(s,"DIV",{class:!0});var n=y(e);l=J(n,t),n.forEach(m),this.h()},h(){c(e,"class","font-medium text-gray-400 dark:text-gray-500 line-clamp-1 font-p")},m(s,n){C(s,e,n),_(e,l)},p(s,n){n&8&&t!==(t=s[3].t("How can I help you today?")+"")&&K(l,t)},d(s){s&&m(e)}}}function sf(r){var o,a,f,u,d,g;let e,t,l=St.parse(vt((f=(a=(o=r[0][r[2]])==null?void 0:o.info)==null?void 0:a.meta)==null?void 0:f.description))+"",s,n,i=((g=(d=(u=r[0][r[2]])==null?void 0:u.info)==null?void 0:d.meta)==null?void 0:g.user)&&dr(r);return{c(){e=I("div"),t=new an(!1),s=P(),i&&i.c(),n=ae(),this.h()},l(h){e=M(h,"DIV",{class:!0});var p=y(e);t=on(p,!1),p.forEach(m),s=j(h),i&&i.l(h),n=ae(),this.h()},h(){t.a=null,c(e,"class","mt-0.5 text-base font-normal text-gray-500 dark:text-gray-400 line-clamp-3 markdown")},m(h,p){C(h,e,p),t.m(l,e),C(h,s,p),i&&i.m(h,p),C(h,n,p)},p(h,p){var D,v,E,b,R,A;p&5&&l!==(l=St.parse(vt((E=(v=(D=h[0][h[2]])==null?void 0:D.info)==null?void 0:v.meta)==null?void 0:E.description))+"")&&t.p(l),(A=(R=(b=h[0][h[2]])==null?void 0:b.info)==null?void 0:R.meta)!=null&&A.user?i?i.p(h,p):(i=dr(h),i.c(),i.m(n.parentNode,n)):i&&(i.d(1),i=null)},d(h){h&&(m(e),m(s),m(n)),i&&i.d(h)}}}function dr(r){let e,t;function l(i,o){var a,f,u;return(u=(f=(a=i[0][i[2]])==null?void 0:a.info)==null?void 0:f.meta)!=null&&u.user.community?nf:rf}let s=l(r),n=s(r);return{c(){e=I("div"),t=F(`By
								`),n.c(),this.h()},l(i){e=M(i,"DIV",{class:!0});var o=y(e);t=J(o,`By
								`),n.l(o),o.forEach(m),this.h()},h(){c(e,"class","mt-0.5 text-sm font-normal text-gray-400 dark:text-gray-500")},m(i,o){C(i,e,o),_(e,t),n.m(e,null)},p(i,o){s===(s=l(i))&&n?n.p(i,o):(n.d(1),n=s(i),n&&(n.c(),n.m(e,null)))},d(i){i&&m(e),n.d()}}}function rf(r){var l,s,n;let e=((n=(s=(l=r[0][r[2]])==null?void 0:l.info)==null?void 0:s.meta)==null?void 0:n.user.name)+"",t;return{c(){t=F(e)},l(i){t=J(i,e)},m(i,o){C(i,t,o)},p(i,o){var a,f,u;o&5&&e!==(e=((u=(f=(a=i[0][i[2]])==null?void 0:a.info)==null?void 0:f.meta)==null?void 0:u.user.name)+"")&&K(t,e)},d(i){i&&m(t)}}}function nf(r){var n,i,o,a,f,u,d,g,h;let e,t=((o=(i=(n=r[0][r[2]])==null?void 0:n.info)==null?void 0:i.meta)!=null&&o.user.name?(u=(f=(a=r[0][r[2]])==null?void 0:a.info)==null?void 0:f.meta)==null?void 0:u.user.name:`@${(h=(g=(d=r[0][r[2]])==null?void 0:d.info)==null?void 0:g.meta)==null?void 0:h.user.username}`)+"",l,s;return{c(){e=I("a"),l=F(t),this.h()},l(p){e=M(p,"A",{href:!0});var D=y(e);l=J(D,t),D.forEach(m),this.h()},h(){var p,D,v;c(e,"href",s="https://openwebui.com/m/"+((v=(D=(p=r[0][r[2]])==null?void 0:p.info)==null?void 0:D.meta)==null?void 0:v.user.username))},m(p,D){C(p,e,D),_(e,l)},p(p,D){var v,E,b,R,A,N,k,B,S,T,H,L;D&5&&t!==(t=((b=(E=(v=p[0][p[2]])==null?void 0:v.info)==null?void 0:E.meta)!=null&&b.user.name?(N=(A=(R=p[0][p[2]])==null?void 0:R.info)==null?void 0:A.meta)==null?void 0:N.user.name:`@${(S=(B=(k=p[0][p[2]])==null?void 0:k.info)==null?void 0:B.meta)==null?void 0:S.user.username}`)+"")&&K(l,t),D&5&&s!==(s="https://openwebui.com/m/"+((L=(H=(T=p[0][p[2]])==null?void 0:T.info)==null?void 0:H.meta)==null?void 0:L.user.username))&&c(e,"href",s)},d(p){p&&m(e)}}}function hr(r){let e,t,l,s,n,i,o,a,f,u,d,g,h,p,D,v=r[3].t("Hi! I'm Kneron Analytics Agent, your financial analysis assistant. I can analyze statements, identify trends, calculate metrics and generate reports. What financial data would you like to examine - balance sheets, income statements, cash flows, or other information?")+"",E,b,R=De(r[0]),A=[];for(let z=0;z<R.length;z+=1)A[z]=ur(fr(r,R,z));const N=z=>V(A[z],1,1,()=>{A[z]=null});let k=r[4]&&cr(r);function B(z,ee){var G;return(G=z[0][z[2]])!=null&&G.name?tf:ef}let S=B(r),T=S(r);function H(z,ee){var G,Q,ue;return((ue=(Q=(G=z[0][z[2]])==null?void 0:G.info)==null?void 0:Q.meta)==null?void 0:ue.description)??null?sf:lf}let L=H(r),q=L(r);return{c(){e=I("div"),t=I("div"),l=I("div");for(let z=0;z<A.length;z+=1)A[z].c();n=P(),k&&k.c(),i=P(),o=I("div"),a=I("div"),f=I("div"),T.c(),d=P(),g=I("div"),q.c(),p=P(),D=I("span"),E=F(v),this.h()},l(z){e=M(z,"DIV",{class:!0});var ee=y(e);t=M(ee,"DIV",{class:!0});var G=y(t);l=M(G,"DIV",{class:!0});var Q=y(l);for(let U=0;U<A.length;U+=1)A[U].l(Q);Q.forEach(m),G.forEach(m),n=j(ee),k&&k.l(ee),i=j(ee),o=M(ee,"DIV",{class:!0});var ue=y(o);a=M(ue,"DIV",{});var fe=y(a);f=M(fe,"DIV",{class:!0});var ke=y(f);T.l(ke),ke.forEach(m),d=j(fe),g=M(fe,"DIV",{});var de=y(g);q.l(de),de.forEach(m),p=j(fe),D=M(fe,"SPAN",{class:!0});var Z=y(D);E=J(Z,v),Z.forEach(m),fe.forEach(m),ue.forEach(m),ee.forEach(m),this.h()},h(){c(l,"class","flex -space-x-4 mb-0.5"),c(t,"class","flex justify-start"),c(f,"class","capitalize line-clamp-1"),c(D,"class","text-lg"),c(o,"class","mt-2 mb-4 text-3xl text-gray-800 dark:text-gray-100 font-medium text-left flex items-center gap-4 font-primary"),c(e,"class","m-auto w-full max-w-6xl px-8 lg:px-20")},m(z,ee){C(z,e,ee),_(e,t),_(t,l);for(let G=0;G<A.length;G+=1)A[G]&&A[G].m(l,null);_(e,n),k&&k.m(e,null),_(e,i),_(e,o),_(o,a),_(a,f),T.m(f,null),_(a,d),_(a,g),q.m(g,null),_(a,p),_(a,D),_(D,E),b=!0},p(z,ee){if(ee&13){R=De(z[0]);let G;for(G=0;G<R.length;G+=1){const Q=fr(z,R,G);A[G]?(A[G].p(Q,ee),w(A[G],1)):(A[G]=ur(Q),A[G].c(),w(A[G],1),A[G].m(l,null))}for(te(),G=R.length;G<A.length;G+=1)N(G);le()}z[4]?k?ee&16&&w(k,1):(k=cr(z),k.c(),w(k,1),k.m(e,i)):k&&(te(),V(k,1,1,()=>{k=null}),le()),S===(S=B(z))&&T?T.p(z,ee):(T.d(1),T=S(z),T&&(T.c(),T.m(f,null))),L===(L=H(z))&&q?q.p(z,ee):(q.d(1),q=L(z),q&&(q.c(),q.m(g,null))),(!b||ee&8)&&v!==(v=z[3].t("Hi! I'm Kneron Analytics Agent, your financial analysis assistant. I can analyze statements, identify trends, calculate metrics and generate reports. What financial data would you like to examine - balance sheets, income statements, cash flows, or other information?")+"")&&K(E,v)},i(z){if(!b){for(let ee=0;ee<R.length;ee+=1)w(A[ee]);z&&(s||Ht(()=>{s=Pt(l,jt,{duration:200}),s.start()})),w(k),z&&(u||Ht(()=>{u=Pt(f,jt,{duration:200}),u.start()})),z&&(h||Ht(()=>{h=Pt(g,jt,{duration:200,delay:200}),h.start()})),b=!0}},o(z){A=A.filter(Boolean);for(let ee=0;ee<A.length;ee+=1)V(A[ee]);V(k),b=!1},d(z){z&&m(e),We(A,z),k&&k.d(),T.d(),q.d()}}}function af(r){let e=r[1],t,l,s=hr(r);return{c(){s.c(),t=ae()},l(n){s.l(n),t=ae()},m(n,i){s.m(n,i),C(n,t,i),l=!0},p(n,[i]){i&2&&Ce(e,e=n[1])?(te(),V(s,1,1,ge),le(),s=hr(n),s.c(),w(s,1),s.m(t.parentNode,t)):s.p(n,i)},i(n){l||(w(s),l=!0)},o(n){V(s),l=!1},d(n){n&&m(t),s.d(n)}}}function of(r,e,t){let l,s,n,i;Ee(r,Rt,D=>t(10,l=D)),Ee(r,Ft,D=>t(4,n=D)),Ee(r,Ot,D=>t(5,i=D));const o=Qe("i18n");Ee(r,o,D=>t(3,s=D));let{modelIds:a=[]}=e,{models:f=[]}=e,{atSelectedModel:u}=e,{submitPrompt:d}=e,g=!1,h=0;bt(()=>{t(1,g=!0)});const p=D=>{t(2,h=D)};return r.$$set=D=>{"modelIds"in D&&t(7,a=D.modelIds),"models"in D&&t(0,f=D.models),"atSelectedModel"in D&&t(8,u=D.atSelectedModel),"submitPrompt"in D&&t(9,d=D.submitPrompt)},r.$$.update=()=>{r.$$.dirty&1152&&t(0,f=a.map(D=>l.find(v=>v.id===D))),r.$$.dirty&129&&a.length>0&&t(2,h=f.length-1)},[f,g,h,s,n,i,o,a,u,d,l,p]}class ff extends Re{constructor(e){super(),Le(this,e,of,af,Ce,{modelIds:7,models:0,atSelectedModel:8,submitPrompt:9})}}function mr(r,e,t){const l=r.slice();return l[42]=e[t],l[44]=t,l}function uf(r){let e,t=r[3],l,s=pr(r);return{c(){e=I("div"),s.c(),this.h()},l(n){e=M(n,"DIV",{class:!0});var i=y(e);s.l(i),i.forEach(m),this.h()},h(){c(e,"class","w-full pt-2")},m(n,i){C(n,e,i),s.m(e,null),l=!0},p(n,i){i[0]&8&&Ce(t,t=n[3])?(te(),V(s,1,1,ge),le(),s=pr(n),s.c(),w(s,1),s.m(e,null)):s.p(n,i)},i(n){l||(w(s),l=!0)},o(n){V(s),l=!1},d(n){n&&m(e),s.d(n)}}}function cf(r){let e,t;return e=new ff({props:{modelIds:r[5],atSelectedModel:r[6],submitPrompt:r[33]}}),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const n={};s[0]&32&&(n.modelIds=l[5]),s[0]&64&&(n.atSelectedModel=l[6]),s[0]&65538&&(n.submitPrompt=l[33]),e.$set(n)},i(l){t||(w(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function gr(r){let e,t;return e=new Tn({props:{$$slots:{default:[df]},$$scope:{ctx:r}}}),e.$on("visible",r[34]),{c(){Y(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,s){$(e,l,s),t=!0},p(l,s){const n={};s[1]&16384&&(n.$$scope={dirty:s,ctx:l}),e.$set(n)},i(l){t||(w(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){x(e,l)}}}function df(r){let e,t,l,s,n="Loading...",i;return t=new At({props:{className:" size-4"}}),{c(){e=I("div"),Y(t.$$.fragment),l=P(),s=I("div"),s.textContent=n,this.h()},l(o){e=M(o,"DIV",{class:!0});var a=y(e);X(t.$$.fragment,a),l=j(a),s=M(a,"DIV",{class:!0,"data-svelte-h":!0}),Te(s)!=="svelte-17uns3n"&&(s.textContent=n),a.forEach(m),this.h()},h(){c(s,"class",""),c(e,"class","w-full flex justify-center py-1 text-xs animate-pulse items-center gap-2")},m(o,a){C(o,e,a),$(t,e,null),_(e,l),_(e,s),i=!0},p:ge,i(o){i||(w(t.$$.fragment,o),i=!0)},o(o){V(t.$$.fragment,o),i=!1},d(o){o&&m(e),x(t)}}}function _r(r,e){let t,l,s,n;function i(a){e[35](a)}let o={chatId:e[3],messageId:e[42].id,idx:e[44],user:e[4],showPreviousMessage:e[20],showNextMessage:e[21],updateChat:e[19],editMessage:e[23],deleteMessage:e[26],rateMessage:e[22],actionMessage:e[24],saveMessage:e[25],submitMessage:e[10],regenerateResponse:e[8],continueResponse:e[7],mergeResponses:e[9],addMessages:e[11],triggerScroll:e[27],readOnly:e[12]};return e[0]!==void 0&&(o.history=e[0]),l=new Qo({props:o}),Pe.push(()=>Ke(l,"history",i)),{key:r,first:null,c(){t=ae(),Y(l.$$.fragment),this.h()},l(a){t=ae(),X(l.$$.fragment,a),this.h()},h(){this.first=t},m(a,f){C(a,t,f),$(l,a,f),n=!0},p(a,f){e=a;const u={};f[0]&8&&(u.chatId=e[3]),f[0]&16384&&(u.messageId=e[42].id),f[0]&16384&&(u.idx=e[44]),f[0]&16&&(u.user=e[4]),f[0]&1024&&(u.submitMessage=e[10]),f[0]&256&&(u.regenerateResponse=e[8]),f[0]&128&&(u.continueResponse=e[7]),f[0]&512&&(u.mergeResponses=e[9]),f[0]&2048&&(u.addMessages=e[11]),f[0]&4096&&(u.readOnly=e[12]),!s&&f[0]&1&&(s=!0,u.history=e[0],Ge(()=>s=!1)),l.$set(u)},i(a){n||(w(l.$$.fragment,a),n=!0)},o(a){V(l.$$.fragment,a),n=!1},d(a){a&&m(t),x(l,a)}}}function vr(r){let e;return{c(){e=I("div"),this.h()},l(t){e=M(t,"DIV",{class:!0}),y(e).forEach(m),this.h()},h(){c(e,"class","pb-6")},m(t,l){C(t,e,l)},d(t){t&&m(e)}}}function pr(r){var D;let e,t=((D=r[14].at(0))==null?void 0:D.parentId)!==null,l,s=[],n=new Map,i,o,a,f,u,d=t&&gr(r),g=De(r[14]);const h=v=>v[42].id;for(let v=0;v<g.length;v+=1){let E=mr(r,g,v),b=h(E);n.set(b,s[v]=_r(b,E))}let p=r[13]&&vr();return{c(){e=I("div"),d&&d.c(),l=P();for(let v=0;v<s.length;v+=1)s[v].c();i=P(),o=I("div"),a=P(),p&&p.c(),f=ae(),this.h()},l(v){e=M(v,"DIV",{class:!0});var E=y(e);d&&d.l(E),l=j(E);for(let b=0;b<s.length;b+=1)s[b].l(E);E.forEach(m),i=j(v),o=M(v,"DIV",{class:!0}),y(o).forEach(m),a=j(v),p&&p.l(v),f=ae(),this.h()},h(){c(e,"class","w-full"),c(o,"class","pb-12")},m(v,E){C(v,e,E),d&&d.m(e,null),_(e,l);for(let b=0;b<s.length;b+=1)s[b]&&s[b].m(e,null);C(v,i,E),C(v,o,E),C(v,a,E),p&&p.m(v,E),C(v,f,E),u=!0},p(v,E){var b;E[0]&16384&&(t=((b=v[14].at(0))==null?void 0:b.parentId)!==null),t?d?(d.p(v,E),E[0]&16384&&w(d,1)):(d=gr(v),d.c(),w(d,1),d.m(e,l)):d&&(te(),V(d,1,1,()=>{d=null}),le()),E[0]&267935641&&(g=De(v[14]),te(),s=kr(s,E,h,1,v,g,n,e,wr,_r,null,mr),le()),v[13]?p||(p=vr(),p.c(),p.m(f.parentNode,f)):p&&(p.d(1),p=null)},i(v){if(!u){w(d);for(let E=0;E<g.length;E+=1)w(s[E]);u=!0}},o(v){V(d);for(let E=0;E<s.length;E+=1)V(s[E]);u=!1},d(v){v&&(m(e),m(i),m(o),m(a),m(f)),d&&d.d();for(let E=0;E<s.length;E+=1)s[E].d();p&&p.d(v)}}}function hf(r){let e,t,l,s,n;const i=[cf,uf],o=[];function a(f,u){var d;return u[0]&1&&(t=null),t==null&&(t=Object.keys(((d=f[0])==null?void 0:d.messages)??{}).length==0),t?0:1}return l=a(r,[-1,-1]),s=o[l]=i[l](r),{c(){e=I("div"),s.c(),this.h()},l(f){e=M(f,"DIV",{class:!0});var u=y(e);s.l(u),u.forEach(m),this.h()},h(){c(e,"class",r[2])},m(f,u){C(f,e,u),o[l].m(e,null),n=!0},p(f,u){let d=l;l=a(f,u),l===d?o[l].p(f,u):(te(),V(o[d],1,1,()=>{o[d]=null}),le(),s=o[l],s?s.p(f,u):(s=o[l]=i[l](f),s.c()),w(s,1),s.m(e,null)),(!n||u[0]&4)&&c(e,"class",f[2])},i(f){n||(w(s),n=!0)},o(f){V(s),n=!1},d(f){f&&m(e),o[l].d()}}}function mf(r,e,t){let l,s,n,i,o;Ee(r,Lt,O=>t(36,l=O)),Ee(r,ul,O=>t(37,s=O)),Ee(r,Ft,O=>t(38,n=O)),Ee(r,Ot,O=>t(39,i=O)),pt();const a=Qe("i18n");Ee(r,a,O=>t(16,o=O));let{className:f="h-full flex pt-8"}=e,{chatId:u=""}=e,{user:d=i}=e,{prompt:g}=e,{history:h={}}=e,{selectedModels:p}=e,{atSelectedModel:D}=e,v=[],{sendPrompt:E}=e,{continueResponse:b}=e,{regenerateResponse:R}=e,{mergeResponses:A}=e,{chatActionHandler:N}=e,{showMessage:k=()=>{}}=e,{submitMessage:B=()=>{}}=e,{addMessages:S=()=>{}}=e,{readOnly:T=!1}=e,{bottomPadding:H=!1}=e,{autoScroll:L}=e,q=20,z=!1;const ee=async()=>{const O=document.getElementById("messages-container");O.scrollTop=O.scrollTop+100,t(15,z=!0),t(32,q+=20),await Ne(),t(15,z=!1)},G=()=>{const O=document.getElementById("messages-container");O.scrollTop=O.scrollHeight},Q=async()=>{n||(t(0,h),await Ne(),await gn(localStorage.token,u,{history:h,messages:v}),ul.set(1),await hn.set(await _n(localStorage.token,s)))},ue=async O=>{if(O.parentId!==null){let re=h.messages[O.parentId].childrenIds[Math.max(h.messages[O.parentId].childrenIds.indexOf(O.id)-1,0)];if(O.id!==re){let ie=h.messages[re].childrenIds;for(;ie.length!==0;)re=ie.at(-1),ie=h.messages[re].childrenIds;t(0,h.currentId=re,h)}}else{let re=Object.values(h.messages).filter(ne=>ne.parentId===null).map(ne=>ne.id),ie=re[Math.max(re.indexOf(O.id)-1,0)];if(O.id!==ie){let ne=h.messages[ie].childrenIds;for(;ne.length!==0;)ie=ne.at(-1),ne=h.messages[ie].childrenIds;t(0,h.currentId=ie,h)}}if(await Ne(),(l==null?void 0:l.scrollOnBranchChange)??!0){const re=document.getElementById("messages-container");t(28,L=re.scrollHeight-re.scrollTop<=re.clientHeight+50),setTimeout(()=>{G()},100)}},fe=async O=>{if(O.parentId!==null){let re=h.messages[O.parentId].childrenIds[Math.min(h.messages[O.parentId].childrenIds.indexOf(O.id)+1,h.messages[O.parentId].childrenIds.length-1)];if(O.id!==re){let ie=h.messages[re].childrenIds;for(;ie.length!==0;)re=ie.at(-1),ie=h.messages[re].childrenIds;t(0,h.currentId=re,h)}}else{let re=Object.values(h.messages).filter(ne=>ne.parentId===null).map(ne=>ne.id),ie=re[Math.min(re.indexOf(O.id)+1,re.length-1)];if(O.id!==ie){let ne=h.messages[ie].childrenIds;for(;ne.length!==0;)ie=ne.at(-1),ne=h.messages[ie].childrenIds;t(0,h.currentId=ie,h)}}if(await Ne(),(l==null?void 0:l.scrollOnBranchChange)??!0){const re=document.getElementById("messages-container");t(28,L=re.scrollHeight-re.scrollTop<=re.clientHeight+50),setTimeout(()=>{G()},100)}},ke=async(O,re)=>{t(0,h.messages[O].annotation={...h.messages[O].annotation,rating:re},h),await Q()},de=async(O,re,ie=!0)=>{if(h.messages[O].role==="user")if(ie){let ne=re,se=cl(),oe={id:se,parentId:h.messages[O].parentId,childrenIds:[],role:"user",content:ne,...h.messages[O].files&&{files:h.messages[O].files},models:p},ye=h.messages[O].parentId;ye!==null&&t(0,h.messages[ye].childrenIds=[...h.messages[ye].childrenIds,se],h),t(0,h.messages[se]=oe,h),t(0,h.currentId=se,h),await Ne(),await E(h,ne,se)}else t(0,h.messages[O].content=re,h),await Q();else if(ie){const ne=cl(),se=h.messages[O],oe=se.parentId,ye={...se,id:ne,parentId:oe,childrenIds:[],files:void 0,content:re,timestamp:Math.floor(Date.now()/1e3)};t(0,h.messages[ne]=ye,h),t(0,h.currentId=ne,h),oe!==null&&t(0,h.messages[oe].childrenIds=[...h.messages[oe].childrenIds,ne],h),await Q()}else t(0,h.messages[O].originalContent=h.messages[O].content,h),t(0,h.messages[O].content=re,h),await Q()},Z=async(O,re,ie=null)=>{await N(u,O,re.model,re.id,ie)},U=async(O,re)=>{t(0,h.messages[O]=re,h),await Q()},he=async O=>{const re=h.messages[O],ie=re.parentId,ne=re.childrenIds??[],se=ne.flatMap(oe=>{var ye;return((ye=h.messages[oe])==null?void 0:ye.childrenIds)??[]});ie&&h.messages[ie]&&t(0,h.messages[ie].childrenIds=[...h.messages[ie].childrenIds.filter(oe=>oe!==O),...se],h),se.forEach(oe=>{h.messages[oe]&&t(0,h.messages[oe].parentId=ie,h)}),[O,...ne].forEach(oe=>{delete h.messages[oe]}),await Ne(),k({id:ie}),await Q()},ce=()=>{if(L){const O=document.getElementById("messages-container");t(28,L=O.scrollHeight-O.scrollTop<=O.clientHeight+50),setTimeout(()=>{G()},100)}},be=async O=>{let re=O;if(O.includes("{{CLIPBOARD}}")){const ne=await navigator.clipboard.readText().catch(se=>(He.error(o.t("Failed to read clipboard contents")),"{{CLIPBOARD}}"));re=O.replaceAll("{{CLIPBOARD}}",ne)}t(1,g=re),await Ne();const ie=document.getElementById("chat-input-container");ie&&(t(1,g=O),ie.style.height="",ie.style.height=Math.min(ie.scrollHeight,200)+"px",ie.focus()),await Ne()},Me=O=>{console.log("visible"),z||ee()};function pe(O){h=O,t(0,h)}return r.$$set=O=>{"className"in O&&t(2,f=O.className),"chatId"in O&&t(3,u=O.chatId),"user"in O&&t(4,d=O.user),"prompt"in O&&t(1,g=O.prompt),"history"in O&&t(0,h=O.history),"selectedModels"in O&&t(5,p=O.selectedModels),"atSelectedModel"in O&&t(6,D=O.atSelectedModel),"sendPrompt"in O&&t(29,E=O.sendPrompt),"continueResponse"in O&&t(7,b=O.continueResponse),"regenerateResponse"in O&&t(8,R=O.regenerateResponse),"mergeResponses"in O&&t(9,A=O.mergeResponses),"chatActionHandler"in O&&t(30,N=O.chatActionHandler),"showMessage"in O&&t(31,k=O.showMessage),"submitMessage"in O&&t(10,B=O.submitMessage),"addMessages"in O&&t(11,S=O.addMessages),"readOnly"in O&&t(12,T=O.readOnly),"bottomPadding"in O&&t(13,H=O.bottomPadding),"autoScroll"in O&&t(28,L=O.autoScroll)},r.$$.update=()=>{if(r.$$.dirty[0]&1|r.$$.dirty[1]&2)if(h.currentId){let O=[];h.messages&&(O=Object.values(h.messages).sort((re,ie)=>re.timestamp&&ie.timestamp?re.timestamp-ie.timestamp:re.parentId===null&&ie.parentId!==null?-1:re.parentId!==null&&ie.parentId===null?1:0),O.length>q&&(O=O.slice(-q))),t(14,v=O)}else t(14,v=[]);r.$$.dirty[0]&268443648&&L&&H&&(async()=>(await Ne(),G()))()},[h,g,f,u,d,p,D,b,R,A,B,S,T,H,v,z,o,a,ee,Q,ue,fe,ke,de,Z,U,he,ce,L,E,N,k,q,be,Me,pe]}class Yf extends Re{constructor(e){super(),Le(this,e,mf,hf,Ce,{className:2,chatId:3,user:4,prompt:1,history:0,selectedModels:5,atSelectedModel:6,sendPrompt:29,continueResponse:7,regenerateResponse:8,mergeResponses:9,chatActionHandler:30,showMessage:31,submitMessage:10,addMessages:11,readOnly:12,bottomPadding:13,autoScroll:28},null,[-1,-1])}}export{Xo as E,Sn as K,Yf as M};
//# sourceMappingURL=DfmjpK2E.js.map
