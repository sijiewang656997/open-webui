import{s as N,d as h,i as O,m as d,j as w,p as F,q as U,n as v}from"../chunks/CgRTDwF2.js";import{S as W,i as y,t as _,a as f,c as R,g as V,d as B,m as C,b as M,e as P}from"../chunks/Bnxgdxyh.js";import{t as E}from"../chunks/Fny8-CkQ.js";import{g as D}from"../chunks/JmxR0F9R.js";import{f as J,m as Q,a as j,c as H}from"../chunks/D-bUEbUi.js";import{c as L,g as z}from"../chunks/CFk3bLww.js";import{F as A}from"../chunks/CCMK6mem.js";import{g as G}from"../chunks/DJyIR_-r.js";import{e as K,c as T}from"../chunks/B9ns8vb-.js";import{W as b}from"../chunks/CisIfe-u.js";function k(c){var a;let r=(a=c[2])==null?void 0:a.content,n,o,e=I(c);return{c(){e.c(),n=d()},l(i){e.l(i),n=d()},m(i,t){e.m(i,t),O(i,n,t),o=!0},p(i,t){var l;t&4&&N(r,r=(l=i[2])==null?void 0:l.content)?(V(),_(e,1,1,v),R(),e=I(i),e.c(),f(e,1),e.m(n.parentNode,n)):e.p(i,t)},i(i){o||(f(e),o=!0)},o(i){_(e),o=!1},d(i){i&&h(n),e.d(i)}}}function I(c){var o,e,a,i;let r,n;return r=new A({props:{id:((o=c[2])==null?void 0:o.id)??"",name:((e=c[2])==null?void 0:e.name)??"",meta:((a=c[2])==null?void 0:a.meta)??{description:""},content:((i=c[2])==null?void 0:i.content)??"",clone:c[1],onSave:c[5]}}),{c(){P(r.$$.fragment)},l(t){M(r.$$.fragment,t)},m(t,l){C(r,t,l),n=!0},p(t,l){var p,g,s,m;const u={};l&4&&(u.id=((p=t[2])==null?void 0:p.id)??""),l&4&&(u.name=((g=t[2])==null?void 0:g.name)??""),l&4&&(u.meta=((s=t[2])==null?void 0:s.meta)??{description:""}),l&4&&(u.content=((m=t[2])==null?void 0:m.content)??""),l&2&&(u.clone=t[1]),r.$set(u)},i(t){n||(f(r.$$.fragment,t),n=!0)},o(t){_(r.$$.fragment,t),n=!1},d(t){B(r,t)}}}function X(c){let r,n,o=c[0]&&k(c);return{c(){o&&o.c(),r=d()},l(e){o&&o.l(e),r=d()},m(e,a){o&&o.m(e,a),O(e,r,a),n=!0},p(e,[a]){e[0]?o?(o.p(e,a),a&1&&f(o,1)):(o=k(e),o.c(),f(o,1),o.m(r.parentNode,r)):o&&(V(),_(o,1,1,()=>{o=null}),R())},i(e){n||(f(o),n=!0)},o(e){_(o),n=!1},d(e){e&&h(r),o&&o.d(e)}}}function Y(c,r,n){let o,e,a;w(c,j,s=>n(6,o=s)),w(c,H,s=>n(7,e=s));const i=F("i18n");w(c,i,s=>n(8,a=s));let t=!1,l=!1,u=null;const p=async s=>{var S;console.log(s);const m=K(s.content);if(T((m==null?void 0:m.required_open_webui_version)??"0.0.0",b)){console.log("Version is lower than required"),E.error(a.t("Open WebUI version (v{{OPEN_WEBUI_VERSION}}) is lower than required version (v{{REQUIRED_VERSION}})",{OPEN_WEBUI_VERSION:b,REQUIRED_VERSION:(m==null?void 0:m.required_open_webui_version)??"0.0.0"}));return}await L(localStorage.token,{id:s.id,name:s.name,meta:s.meta,content:s.content}).catch(q=>(E.error(`${q}`),null))&&(E.success(a.t("Function created successfully")),J.set(await z(localStorage.token)),Q.set(await G(localStorage.token,((S=e==null?void 0:e.features)==null?void 0:S.enable_direct_connections)&&((o==null?void 0:o.directConnections)??null))),await D("/admin/functions"))};return U(()=>{window.addEventListener("message",async s=>{["https://openwebui.com","https://www.openwebui.com","http://localhost:9999"].includes(s.origin)&&(n(2,u=JSON.parse(s.data)),console.log(u))}),(window.opener??!1)&&window.opener.postMessage("loaded","*"),sessionStorage.function&&(n(2,u=JSON.parse(sessionStorage.function)),sessionStorage.removeItem("function"),console.log(u),n(1,l=!0)),n(0,t=!0)}),[t,l,u,i,p,s=>{p(s)}]}class ae extends W{constructor(r){super(),y(this,r,Y,X,N,{})}}export{ae as component};
//# sourceMappingURL=11.DNyBGImt.js.map
