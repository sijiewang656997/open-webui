import{s as la,k as Ae,e as pe,o as Se,m as ca,d as ie,c as me,a as de,f as te,i as Pe,j as sn,p as ua,q as fa,t as De,b as Oe,M as Vt,g as Y,u as rt,a0 as ha,h as Be,G as lr,R as ss,Q as da,D as kt,E as Ct,n as dt,P as fi,B as Lt,a4 as qr,a5 as Xr,l as Ni,O as pa,N as Di}from"../chunks/Dc4_ziGv.js";import{S as ma,i as ga,t as Qe,a as st,c as Gt,g as $t,b as cr,d as ur,m as fr,e as hr}from"../chunks/CAZSMy3J.js";import{g as wa}from"../chunks/D0QH3NT1.js";import{e as rr}from"../chunks/C6kX8Nm-.js";import{t as Je}from"../chunks/gLvYLTeg.js";import{w as ya}from"../chunks/03rUxzUZ.js";import{S as dr}from"../chunks/7Z-YgjJE.js";import{l as va}from"../chunks/DhUbH0v9.js";import"../chunks/DRDB-3cE.js";import{P as ba,D as _a,c as Ea,d as xa}from"../chunks/BgXee8Yk.js";import{F as Ta}from"../chunks/0n0hRmjK.js";var Aa=Object.defineProperty,Sa=Object.defineProperties,ka=Object.getOwnPropertyDescriptors,Oi=Object.getOwnPropertySymbols,Ca=Object.prototype.hasOwnProperty,Ia=Object.prototype.propertyIsEnumerable,ti=(r,e,t)=>e in r?Aa(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,ze=(r,e)=>{for(var t in e||(e={}))Ca.call(e,t)&&ti(r,t,e[t]);if(Oi)for(var t of Oi(e))Ia.call(e,t)&&ti(r,t,e[t]);return r},Tr=(r,e)=>Sa(r,ka(e)),ge=(r,e,t)=>(ti(r,typeof e!="symbol"?e+"":e,t),t),Nr=(r,e,t)=>new Promise((s,l)=>{var i=u=>{try{n(t.next(u))}catch(m){l(m)}},c=u=>{try{n(t.throw(u))}catch(m){l(m)}},n=u=>u.done?s(u.value):Promise.resolve(u.value).then(i,c);n((t=t.apply(r,e)).next())});class Gr{constructor(e){ge(this,"rootKey"),this.rootKey=e}}const Ra=Object.seal({});class ve extends Gr{constructor(e){super(e),ge(this,"root"),this.root=new Array}prepForXml(e){var t;e.stack.push(this);const s=this.root.map(l=>l instanceof Gr?l.prepForXml(e):l).filter(l=>l!==void 0);return e.stack.pop(),{[this.rootKey]:s.length?s.length===1&&((t=s[0])!=null&&t._attr)?s[0]:s:Ra}}addChildElement(e){return this.root.push(e),this}}class Zr extends ve{prepForXml(e){const t=super.prepForXml(e);if(t&&(typeof t[this.rootKey]!="object"||Object.keys(t[this.rootKey]).length))return t}}class Fe extends Gr{constructor(e){super("_attr"),ge(this,"xmlKeys"),this.root=e}prepForXml(e){const t={};return Object.keys(this.root).forEach(s=>{const l=this.root[s];if(l!==void 0){const i=this.xmlKeys&&this.xmlKeys[s]||s;t[i]=l}}),{_attr:t}}}class Sr extends Gr{constructor(e){super("_attr"),this.root=e}prepForXml(e){return{_attr:Object.values(this.root).filter(({value:s})=>s!==void 0).reduce((s,{key:l,value:i})=>Tr(ze({},s),{[l]:i}),{})}}}class nt extends Fe{constructor(){super(...arguments),ge(this,"xmlKeys",{val:"w:val",color:"w:color",fill:"w:fill",space:"w:space",sz:"w:sz",type:"w:type",rsidR:"w:rsidR",rsidRPr:"w:rsidRPr",rsidSect:"w:rsidSect",w:"w:w",h:"w:h",top:"w:top",right:"w:right",bottom:"w:bottom",left:"w:left",header:"w:header",footer:"w:footer",gutter:"w:gutter",linePitch:"w:linePitch",pos:"w:pos"})}}var Rt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function as(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var ls={},hi={exports:{}},Yt=typeof Reflect=="object"?Reflect:null,Bi=Yt&&typeof Yt.apply=="function"?Yt.apply:function(e,t,s){return Function.prototype.apply.call(e,t,s)},Hr;Yt&&typeof Yt.ownKeys=="function"?Hr=Yt.ownKeys:Object.getOwnPropertySymbols?Hr=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Hr=function(e){return Object.getOwnPropertyNames(e)};function Na(r){console&&console.warn&&console.warn(r)}var cs=Number.isNaN||function(e){return e!==e};function qe(){qe.init.call(this)}hi.exports=qe;hi.exports.once=Fa;qe.EventEmitter=qe;qe.prototype._events=void 0;qe.prototype._eventsCount=0;qe.prototype._maxListeners=void 0;var Fi=10;function Yr(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(qe,"defaultMaxListeners",{enumerable:!0,get:function(){return Fi},set:function(r){if(typeof r!="number"||r<0||cs(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");Fi=r}});qe.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};qe.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||cs(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function us(r){return r._maxListeners===void 0?qe.defaultMaxListeners:r._maxListeners}qe.prototype.getMaxListeners=function(){return us(this)};qe.prototype.emit=function(e){for(var t=[],s=1;s<arguments.length;s++)t.push(arguments[s]);var l=e==="error",i=this._events;if(i!==void 0)l=l&&i.error===void 0;else if(!l)return!1;if(l){var c;if(t.length>0&&(c=t[0]),c instanceof Error)throw c;var n=new Error("Unhandled error."+(c?" ("+c.message+")":""));throw n.context=c,n}var u=i[e];if(u===void 0)return!1;if(typeof u=="function")Bi(u,this,t);else for(var m=u.length,w=ms(u,m),s=0;s<m;++s)Bi(w[s],this,t);return!0};function fs(r,e,t,s){var l,i,c;if(Yr(t),i=r._events,i===void 0?(i=r._events=Object.create(null),r._eventsCount=0):(i.newListener!==void 0&&(r.emit("newListener",e,t.listener?t.listener:t),i=r._events),c=i[e]),c===void 0)c=i[e]=t,++r._eventsCount;else if(typeof c=="function"?c=i[e]=s?[t,c]:[c,t]:s?c.unshift(t):c.push(t),l=us(r),l>0&&c.length>l&&!c.warned){c.warned=!0;var n=new Error("Possible EventEmitter memory leak detected. "+c.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");n.name="MaxListenersExceededWarning",n.emitter=r,n.type=e,n.count=c.length,Na(n)}return r}qe.prototype.addListener=function(e,t){return fs(this,e,t,!1)};qe.prototype.on=qe.prototype.addListener;qe.prototype.prependListener=function(e,t){return fs(this,e,t,!0)};function Da(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function hs(r,e,t){var s={fired:!1,wrapFn:void 0,target:r,type:e,listener:t},l=Da.bind(s);return l.listener=t,s.wrapFn=l,l}qe.prototype.once=function(e,t){return Yr(t),this.on(e,hs(this,e,t)),this};qe.prototype.prependOnceListener=function(e,t){return Yr(t),this.prependListener(e,hs(this,e,t)),this};qe.prototype.removeListener=function(e,t){var s,l,i,c,n;if(Yr(t),l=this._events,l===void 0)return this;if(s=l[e],s===void 0)return this;if(s===t||s.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete l[e],l.removeListener&&this.emit("removeListener",e,s.listener||t));else if(typeof s!="function"){for(i=-1,c=s.length-1;c>=0;c--)if(s[c]===t||s[c].listener===t){n=s[c].listener,i=c;break}if(i<0)return this;i===0?s.shift():Oa(s,i),s.length===1&&(l[e]=s[0]),l.removeListener!==void 0&&this.emit("removeListener",e,n||t)}return this};qe.prototype.off=qe.prototype.removeListener;qe.prototype.removeAllListeners=function(e){var t,s,l;if(s=this._events,s===void 0)return this;if(s.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):s[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete s[e]),this;if(arguments.length===0){var i=Object.keys(s),c;for(l=0;l<i.length;++l)c=i[l],c!=="removeListener"&&this.removeAllListeners(c);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=s[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(l=t.length-1;l>=0;l--)this.removeListener(e,t[l]);return this};function ds(r,e,t){var s=r._events;if(s===void 0)return[];var l=s[e];return l===void 0?[]:typeof l=="function"?t?[l.listener||l]:[l]:t?Ba(l):ms(l,l.length)}qe.prototype.listeners=function(e){return ds(this,e,!0)};qe.prototype.rawListeners=function(e){return ds(this,e,!1)};qe.listenerCount=function(r,e){return typeof r.listenerCount=="function"?r.listenerCount(e):ps.call(r,e)};qe.prototype.listenerCount=ps;function ps(r){var e=this._events;if(e!==void 0){var t=e[r];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}qe.prototype.eventNames=function(){return this._eventsCount>0?Hr(this._events):[]};function ms(r,e){for(var t=new Array(e),s=0;s<e;++s)t[s]=r[s];return t}function Oa(r,e){for(;e+1<r.length;e++)r[e]=r[e+1];r.pop()}function Ba(r){for(var e=new Array(r.length),t=0;t<e.length;++t)e[t]=r[t].listener||r[t];return e}function Fa(r,e){return new Promise(function(t,s){function l(c){r.removeListener(e,i),s(c)}function i(){typeof r.removeListener=="function"&&r.removeListener("error",l),t([].slice.call(arguments))}gs(r,e,i,{once:!0}),e!=="error"&&La(r,l,{once:!0})})}function La(r,e,t){typeof r.on=="function"&&gs(r,"error",e,t)}function gs(r,e,t,s){if(typeof r.on=="function")s.once?r.once(e,t):r.on(e,t);else if(typeof r.addEventListener=="function")r.addEventListener(e,function l(i){s.once&&r.removeEventListener(e,l),t(i)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}var di=hi.exports,ri={exports:{}};typeof Object.create=="function"?ri.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:ri.exports=function(e,t){if(t){e.super_=t;var s=function(){};s.prototype=t.prototype,e.prototype=new s,e.prototype.constructor=e}};var Kt=ri.exports;function Pa(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var ws={exports:{}},it=ws.exports={},At,St;function ni(){throw new Error("setTimeout has not been defined")}function ii(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?At=setTimeout:At=ni}catch{At=ni}try{typeof clearTimeout=="function"?St=clearTimeout:St=ii}catch{St=ii}})();function ys(r){if(At===setTimeout)return setTimeout(r,0);if((At===ni||!At)&&setTimeout)return At=setTimeout,setTimeout(r,0);try{return At(r,0)}catch{try{return At.call(null,r,0)}catch{return At.call(this,r,0)}}}function Ua(r){if(St===clearTimeout)return clearTimeout(r);if((St===ii||!St)&&clearTimeout)return St=clearTimeout,clearTimeout(r);try{return St(r)}catch{try{return St.call(null,r)}catch{return St.call(this,r)}}}var Ot=[],Jt=!1,Ht,Wr=-1;function Ma(){!Jt||!Ht||(Jt=!1,Ht.length?Ot=Ht.concat(Ot):Wr=-1,Ot.length&&vs())}function vs(){if(!Jt){var r=ys(Ma);Jt=!0;for(var e=Ot.length;e;){for(Ht=Ot,Ot=[];++Wr<e;)Ht&&Ht[Wr].run();Wr=-1,e=Ot.length}Ht=null,Jt=!1,Ua(r)}}it.nextTick=function(r){var e=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)e[t-1]=arguments[t];Ot.push(new bs(r,e)),Ot.length===1&&!Jt&&ys(vs)};function bs(r,e){this.fun=r,this.array=e}bs.prototype.run=function(){this.fun.apply(null,this.array)};it.title="browser";it.browser=!0;it.env={};it.argv=[];it.version="";it.versions={};function Bt(){}it.on=Bt;it.addListener=Bt;it.once=Bt;it.off=Bt;it.removeListener=Bt;it.removeAllListeners=Bt;it.emit=Bt;it.prependListener=Bt;it.prependOnceListener=Bt;it.listeners=function(r){return[]};it.binding=function(r){throw new Error("process.binding is not supported")};it.cwd=function(){return"/"};it.chdir=function(r){throw new Error("process.chdir is not supported")};it.umask=function(){return 0};var ja=ws.exports;const Me=Pa(ja);var an,Li;function _s(){return Li||(Li=1,an=di.EventEmitter),an}var ln={},br={},Pi;function za(){if(Pi)return br;Pi=1,br.byteLength=n,br.toByteArray=m,br.fromByteArray=T;for(var r=[],e=[],t=typeof Uint8Array<"u"?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l=0,i=s.length;l<i;++l)r[l]=s[l],e[s.charCodeAt(l)]=l;e[45]=62,e[95]=63;function c(p){var S=p.length;if(S%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var y=p.indexOf("=");y===-1&&(y=S);var _=y===S?0:4-y%4;return[y,_]}function n(p){var S=c(p),y=S[0],_=S[1];return(y+_)*3/4-_}function u(p,S,y){return(S+y)*3/4-y}function m(p){var S,y=c(p),_=y[0],f=y[1],x=new t(u(p,_,f)),k=0,C=f>0?_-4:_,D;for(D=0;D<C;D+=4)S=e[p.charCodeAt(D)]<<18|e[p.charCodeAt(D+1)]<<12|e[p.charCodeAt(D+2)]<<6|e[p.charCodeAt(D+3)],x[k++]=S>>16&255,x[k++]=S>>8&255,x[k++]=S&255;return f===2&&(S=e[p.charCodeAt(D)]<<2|e[p.charCodeAt(D+1)]>>4,x[k++]=S&255),f===1&&(S=e[p.charCodeAt(D)]<<10|e[p.charCodeAt(D+1)]<<4|e[p.charCodeAt(D+2)]>>2,x[k++]=S>>8&255,x[k++]=S&255),x}function w(p){return r[p>>18&63]+r[p>>12&63]+r[p>>6&63]+r[p&63]}function b(p,S,y){for(var _,f=[],x=S;x<y;x+=3)_=(p[x]<<16&16711680)+(p[x+1]<<8&65280)+(p[x+2]&255),f.push(w(_));return f.join("")}function T(p){for(var S,y=p.length,_=y%3,f=[],x=16383,k=0,C=y-_;k<C;k+=x)f.push(b(p,k,k+x>C?C:k+x));return _===1?(S=p[y-1],f.push(r[S>>2]+r[S<<4&63]+"==")):_===2&&(S=(p[y-2]<<8)+p[y-1],f.push(r[S>>10]+r[S>>4&63]+r[S<<2&63]+"=")),f.join("")}return br}var Dr={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var Ui;function Ha(){return Ui||(Ui=1,Dr.read=function(r,e,t,s,l){var i,c,n=l*8-s-1,u=(1<<n)-1,m=u>>1,w=-7,b=t?l-1:0,T=t?-1:1,p=r[e+b];for(b+=T,i=p&(1<<-w)-1,p>>=-w,w+=n;w>0;i=i*256+r[e+b],b+=T,w-=8);for(c=i&(1<<-w)-1,i>>=-w,w+=s;w>0;c=c*256+r[e+b],b+=T,w-=8);if(i===0)i=1-m;else{if(i===u)return c?NaN:(p?-1:1)*(1/0);c=c+Math.pow(2,s),i=i-m}return(p?-1:1)*c*Math.pow(2,i-s)},Dr.write=function(r,e,t,s,l,i){var c,n,u,m=i*8-l-1,w=(1<<m)-1,b=w>>1,T=l===23?Math.pow(2,-24)-Math.pow(2,-77):0,p=s?0:i-1,S=s?1:-1,y=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(n=isNaN(e)?1:0,c=w):(c=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-c))<1&&(c--,u*=2),c+b>=1?e+=T/u:e+=T*Math.pow(2,1-b),e*u>=2&&(c++,u/=2),c+b>=w?(n=0,c=w):c+b>=1?(n=(e*u-1)*Math.pow(2,l),c=c+b):(n=e*Math.pow(2,b-1)*Math.pow(2,l),c=0));l>=8;r[t+p]=n&255,p+=S,n/=256,l-=8);for(c=c<<l|n,m+=l;m>0;r[t+p]=c&255,p+=S,c/=256,m-=8);r[t+p-S]|=y*128}),Dr}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var Mi;function Jr(){return Mi||(Mi=1,function(r){var e=za(),t=Ha(),s=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;r.Buffer=n,r.SlowBuffer=x,r.INSPECT_MAX_BYTES=50;var l=2147483647;r.kMaxLength=l,n.TYPED_ARRAY_SUPPORT=i(),!n.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function i(){try{var E=new Uint8Array(1),o={foo:function(){return 42}};return Object.setPrototypeOf(o,Uint8Array.prototype),Object.setPrototypeOf(E,o),E.foo()===42}catch{return!1}}Object.defineProperty(n.prototype,"parent",{enumerable:!0,get:function(){if(n.isBuffer(this))return this.buffer}}),Object.defineProperty(n.prototype,"offset",{enumerable:!0,get:function(){if(n.isBuffer(this))return this.byteOffset}});function c(E){if(E>l)throw new RangeError('The value "'+E+'" is invalid for option "size"');var o=new Uint8Array(E);return Object.setPrototypeOf(o,n.prototype),o}function n(E,o,a){if(typeof E=="number"){if(typeof o=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return b(E)}return u(E,o,a)}n.poolSize=8192;function u(E,o,a){if(typeof E=="string")return T(E,o);if(ArrayBuffer.isView(E))return S(E);if(E==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof E);if(ae(E,ArrayBuffer)||E&&ae(E.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(ae(E,SharedArrayBuffer)||E&&ae(E.buffer,SharedArrayBuffer)))return y(E,o,a);if(typeof E=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var d=E.valueOf&&E.valueOf();if(d!=null&&d!==E)return n.from(d,o,a);var F=_(E);if(F)return F;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof E[Symbol.toPrimitive]=="function")return n.from(E[Symbol.toPrimitive]("string"),o,a);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof E)}n.from=function(E,o,a){return u(E,o,a)},Object.setPrototypeOf(n.prototype,Uint8Array.prototype),Object.setPrototypeOf(n,Uint8Array);function m(E){if(typeof E!="number")throw new TypeError('"size" argument must be of type number');if(E<0)throw new RangeError('The value "'+E+'" is invalid for option "size"')}function w(E,o,a){return m(E),E<=0?c(E):o!==void 0?typeof a=="string"?c(E).fill(o,a):c(E).fill(o):c(E)}n.alloc=function(E,o,a){return w(E,o,a)};function b(E){return m(E),c(E<0?0:f(E)|0)}n.allocUnsafe=function(E){return b(E)},n.allocUnsafeSlow=function(E){return b(E)};function T(E,o){if((typeof o!="string"||o==="")&&(o="utf8"),!n.isEncoding(o))throw new TypeError("Unknown encoding: "+o);var a=k(E,o)|0,d=c(a),F=d.write(E,o);return F!==a&&(d=d.slice(0,F)),d}function p(E){for(var o=E.length<0?0:f(E.length)|0,a=c(o),d=0;d<o;d+=1)a[d]=E[d]&255;return a}function S(E){if(ae(E,Uint8Array)){var o=new Uint8Array(E);return y(o.buffer,o.byteOffset,o.byteLength)}return p(E)}function y(E,o,a){if(o<0||E.byteLength<o)throw new RangeError('"offset" is outside of buffer bounds');if(E.byteLength<o+(a||0))throw new RangeError('"length" is outside of buffer bounds');var d;return o===void 0&&a===void 0?d=new Uint8Array(E):a===void 0?d=new Uint8Array(E,o):d=new Uint8Array(E,o,a),Object.setPrototypeOf(d,n.prototype),d}function _(E){if(n.isBuffer(E)){var o=f(E.length)|0,a=c(o);return a.length===0||E.copy(a,0,0,o),a}if(E.length!==void 0)return typeof E.length!="number"||h(E.length)?c(0):p(E);if(E.type==="Buffer"&&Array.isArray(E.data))return p(E.data)}function f(E){if(E>=l)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+l.toString(16)+" bytes");return E|0}function x(E){return+E!=E&&(E=0),n.alloc(+E)}n.isBuffer=function(o){return o!=null&&o._isBuffer===!0&&o!==n.prototype},n.compare=function(o,a){if(ae(o,Uint8Array)&&(o=n.from(o,o.offset,o.byteLength)),ae(a,Uint8Array)&&(a=n.from(a,a.offset,a.byteLength)),!n.isBuffer(o)||!n.isBuffer(a))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(o===a)return 0;for(var d=o.length,F=a.length,$=0,P=Math.min(d,F);$<P;++$)if(o[$]!==a[$]){d=o[$],F=a[$];break}return d<F?-1:F<d?1:0},n.isEncoding=function(o){switch(String(o).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},n.concat=function(o,a){if(!Array.isArray(o))throw new TypeError('"list" argument must be an Array of Buffers');if(o.length===0)return n.alloc(0);var d;if(a===void 0)for(a=0,d=0;d<o.length;++d)a+=o[d].length;var F=n.allocUnsafe(a),$=0;for(d=0;d<o.length;++d){var P=o[d];if(ae(P,Uint8Array))$+P.length>F.length?n.from(P).copy(F,$):Uint8Array.prototype.set.call(F,P,$);else if(n.isBuffer(P))P.copy(F,$);else throw new TypeError('"list" argument must be an Array of Buffers');$+=P.length}return F};function k(E,o){if(n.isBuffer(E))return E.length;if(ArrayBuffer.isView(E)||ae(E,ArrayBuffer))return E.byteLength;if(typeof E!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof E);var a=E.length,d=arguments.length>2&&arguments[2]===!0;if(!d&&a===0)return 0;for(var F=!1;;)switch(o){case"ascii":case"latin1":case"binary":return a;case"utf8":case"utf-8":return g(E).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return a*2;case"hex":return a>>>1;case"base64":return N(E).length;default:if(F)return d?-1:g(E).length;o=(""+o).toLowerCase(),F=!0}}n.byteLength=k;function C(E,o,a){var d=!1;if((o===void 0||o<0)&&(o=0),o>this.length||((a===void 0||a>this.length)&&(a=this.length),a<=0)||(a>>>=0,o>>>=0,a<=o))return"";for(E||(E="utf8");;)switch(E){case"hex":return Z(this,o,a);case"utf8":case"utf-8":return A(this,o,a);case"ascii":return V(this,o,a);case"latin1":case"binary":return ye(this,o,a);case"base64":return W(this,o,a);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return re(this,o,a);default:if(d)throw new TypeError("Unknown encoding: "+E);E=(E+"").toLowerCase(),d=!0}}n.prototype._isBuffer=!0;function D(E,o,a){var d=E[o];E[o]=E[a],E[a]=d}n.prototype.swap16=function(){var o=this.length;if(o%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var a=0;a<o;a+=2)D(this,a,a+1);return this},n.prototype.swap32=function(){var o=this.length;if(o%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var a=0;a<o;a+=4)D(this,a,a+3),D(this,a+1,a+2);return this},n.prototype.swap64=function(){var o=this.length;if(o%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var a=0;a<o;a+=8)D(this,a,a+7),D(this,a+1,a+6),D(this,a+2,a+5),D(this,a+3,a+4);return this},n.prototype.toString=function(){var o=this.length;return o===0?"":arguments.length===0?A(this,0,o):C.apply(this,arguments)},n.prototype.toLocaleString=n.prototype.toString,n.prototype.equals=function(o){if(!n.isBuffer(o))throw new TypeError("Argument must be a Buffer");return this===o?!0:n.compare(this,o)===0},n.prototype.inspect=function(){var o="",a=r.INSPECT_MAX_BYTES;return o=this.toString("hex",0,a).replace(/(.{2})/g,"$1 ").trim(),this.length>a&&(o+=" ... "),"<Buffer "+o+">"},s&&(n.prototype[s]=n.prototype.inspect),n.prototype.compare=function(o,a,d,F,$){if(ae(o,Uint8Array)&&(o=n.from(o,o.offset,o.byteLength)),!n.isBuffer(o))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof o);if(a===void 0&&(a=0),d===void 0&&(d=o?o.length:0),F===void 0&&(F=0),$===void 0&&($=this.length),a<0||d>o.length||F<0||$>this.length)throw new RangeError("out of range index");if(F>=$&&a>=d)return 0;if(F>=$)return-1;if(a>=d)return 1;if(a>>>=0,d>>>=0,F>>>=0,$>>>=0,this===o)return 0;for(var P=$-F,fe=d-a,we=Math.min(P,fe),he=this.slice(F,$),xe=o.slice(a,d),ke=0;ke<we;++ke)if(he[ke]!==xe[ke]){P=he[ke],fe=xe[ke];break}return P<fe?-1:fe<P?1:0};function q(E,o,a,d,F){if(E.length===0)return-1;if(typeof a=="string"?(d=a,a=0):a>2147483647?a=2147483647:a<-2147483648&&(a=-2147483648),a=+a,h(a)&&(a=F?0:E.length-1),a<0&&(a=E.length+a),a>=E.length){if(F)return-1;a=E.length-1}else if(a<0)if(F)a=0;else return-1;if(typeof o=="string"&&(o=n.from(o,d)),n.isBuffer(o))return o.length===0?-1:M(E,o,a,d,F);if(typeof o=="number")return o=o&255,typeof Uint8Array.prototype.indexOf=="function"?F?Uint8Array.prototype.indexOf.call(E,o,a):Uint8Array.prototype.lastIndexOf.call(E,o,a):M(E,[o],a,d,F);throw new TypeError("val must be string, number or Buffer")}function M(E,o,a,d,F){var $=1,P=E.length,fe=o.length;if(d!==void 0&&(d=String(d).toLowerCase(),d==="ucs2"||d==="ucs-2"||d==="utf16le"||d==="utf-16le")){if(E.length<2||o.length<2)return-1;$=2,P/=2,fe/=2,a/=2}function we(ot,mt){return $===1?ot[mt]:ot.readUInt16BE(mt*$)}var he;if(F){var xe=-1;for(he=a;he<P;he++)if(we(E,he)===we(o,xe===-1?0:he-xe)){if(xe===-1&&(xe=he),he-xe+1===fe)return xe*$}else xe!==-1&&(he-=he-xe),xe=-1}else for(a+fe>P&&(a=P-fe),he=a;he>=0;he--){for(var ke=!0,Ne=0;Ne<fe;Ne++)if(we(E,he+Ne)!==we(o,Ne)){ke=!1;break}if(ke)return he}return-1}n.prototype.includes=function(o,a,d){return this.indexOf(o,a,d)!==-1},n.prototype.indexOf=function(o,a,d){return q(this,o,a,d,!0)},n.prototype.lastIndexOf=function(o,a,d){return q(this,o,a,d,!1)};function J(E,o,a,d){a=Number(a)||0;var F=E.length-a;d?(d=Number(d),d>F&&(d=F)):d=F;var $=o.length;d>$/2&&(d=$/2);for(var P=0;P<d;++P){var fe=parseInt(o.substr(P*2,2),16);if(h(fe))return P;E[a+P]=fe}return P}function I(E,o,a,d){return O(g(o,E.length-a),E,a,d)}function ue(E,o,a,d){return O(U(o),E,a,d)}function ee(E,o,a,d){return O(N(o),E,a,d)}function B(E,o,a,d){return O(L(o,E.length-a),E,a,d)}n.prototype.write=function(o,a,d,F){if(a===void 0)F="utf8",d=this.length,a=0;else if(d===void 0&&typeof a=="string")F=a,d=this.length,a=0;else if(isFinite(a))a=a>>>0,isFinite(d)?(d=d>>>0,F===void 0&&(F="utf8")):(F=d,d=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var $=this.length-a;if((d===void 0||d>$)&&(d=$),o.length>0&&(d<0||a<0)||a>this.length)throw new RangeError("Attempt to write outside buffer bounds");F||(F="utf8");for(var P=!1;;)switch(F){case"hex":return J(this,o,a,d);case"utf8":case"utf-8":return I(this,o,a,d);case"ascii":case"latin1":case"binary":return ue(this,o,a,d);case"base64":return ee(this,o,a,d);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B(this,o,a,d);default:if(P)throw new TypeError("Unknown encoding: "+F);F=(""+F).toLowerCase(),P=!0}},n.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function W(E,o,a){return o===0&&a===E.length?e.fromByteArray(E):e.fromByteArray(E.slice(o,a))}function A(E,o,a){a=Math.min(E.length,a);for(var d=[],F=o;F<a;){var $=E[F],P=null,fe=$>239?4:$>223?3:$>191?2:1;if(F+fe<=a){var we,he,xe,ke;switch(fe){case 1:$<128&&(P=$);break;case 2:we=E[F+1],(we&192)===128&&(ke=($&31)<<6|we&63,ke>127&&(P=ke));break;case 3:we=E[F+1],he=E[F+2],(we&192)===128&&(he&192)===128&&(ke=($&15)<<12|(we&63)<<6|he&63,ke>2047&&(ke<55296||ke>57343)&&(P=ke));break;case 4:we=E[F+1],he=E[F+2],xe=E[F+3],(we&192)===128&&(he&192)===128&&(xe&192)===128&&(ke=($&15)<<18|(we&63)<<12|(he&63)<<6|xe&63,ke>65535&&ke<1114112&&(P=ke))}}P===null?(P=65533,fe=1):P>65535&&(P-=65536,d.push(P>>>10&1023|55296),P=56320|P&1023),d.push(P),F+=fe}return se(d)}var z=4096;function se(E){var o=E.length;if(o<=z)return String.fromCharCode.apply(String,E);for(var a="",d=0;d<o;)a+=String.fromCharCode.apply(String,E.slice(d,d+=z));return a}function V(E,o,a){var d="";a=Math.min(E.length,a);for(var F=o;F<a;++F)d+=String.fromCharCode(E[F]&127);return d}function ye(E,o,a){var d="";a=Math.min(E.length,a);for(var F=o;F<a;++F)d+=String.fromCharCode(E[F]);return d}function Z(E,o,a){var d=E.length;(!o||o<0)&&(o=0),(!a||a<0||a>d)&&(a=d);for(var F="",$=o;$<a;++$)F+=Q[E[$]];return F}function re(E,o,a){for(var d=E.slice(o,a),F="",$=0;$<d.length-1;$+=2)F+=String.fromCharCode(d[$]+d[$+1]*256);return F}n.prototype.slice=function(o,a){var d=this.length;o=~~o,a=a===void 0?d:~~a,o<0?(o+=d,o<0&&(o=0)):o>d&&(o=d),a<0?(a+=d,a<0&&(a=0)):a>d&&(a=d),a<o&&(a=o);var F=this.subarray(o,a);return Object.setPrototypeOf(F,n.prototype),F};function j(E,o,a){if(E%1!==0||E<0)throw new RangeError("offset is not uint");if(E+o>a)throw new RangeError("Trying to access beyond buffer length")}n.prototype.readUintLE=n.prototype.readUIntLE=function(o,a,d){o=o>>>0,a=a>>>0,d||j(o,a,this.length);for(var F=this[o],$=1,P=0;++P<a&&($*=256);)F+=this[o+P]*$;return F},n.prototype.readUintBE=n.prototype.readUIntBE=function(o,a,d){o=o>>>0,a=a>>>0,d||j(o,a,this.length);for(var F=this[o+--a],$=1;a>0&&($*=256);)F+=this[o+--a]*$;return F},n.prototype.readUint8=n.prototype.readUInt8=function(o,a){return o=o>>>0,a||j(o,1,this.length),this[o]},n.prototype.readUint16LE=n.prototype.readUInt16LE=function(o,a){return o=o>>>0,a||j(o,2,this.length),this[o]|this[o+1]<<8},n.prototype.readUint16BE=n.prototype.readUInt16BE=function(o,a){return o=o>>>0,a||j(o,2,this.length),this[o]<<8|this[o+1]},n.prototype.readUint32LE=n.prototype.readUInt32LE=function(o,a){return o=o>>>0,a||j(o,4,this.length),(this[o]|this[o+1]<<8|this[o+2]<<16)+this[o+3]*16777216},n.prototype.readUint32BE=n.prototype.readUInt32BE=function(o,a){return o=o>>>0,a||j(o,4,this.length),this[o]*16777216+(this[o+1]<<16|this[o+2]<<8|this[o+3])},n.prototype.readIntLE=function(o,a,d){o=o>>>0,a=a>>>0,d||j(o,a,this.length);for(var F=this[o],$=1,P=0;++P<a&&($*=256);)F+=this[o+P]*$;return $*=128,F>=$&&(F-=Math.pow(2,8*a)),F},n.prototype.readIntBE=function(o,a,d){o=o>>>0,a=a>>>0,d||j(o,a,this.length);for(var F=a,$=1,P=this[o+--F];F>0&&($*=256);)P+=this[o+--F]*$;return $*=128,P>=$&&(P-=Math.pow(2,8*a)),P},n.prototype.readInt8=function(o,a){return o=o>>>0,a||j(o,1,this.length),this[o]&128?(255-this[o]+1)*-1:this[o]},n.prototype.readInt16LE=function(o,a){o=o>>>0,a||j(o,2,this.length);var d=this[o]|this[o+1]<<8;return d&32768?d|4294901760:d},n.prototype.readInt16BE=function(o,a){o=o>>>0,a||j(o,2,this.length);var d=this[o+1]|this[o]<<8;return d&32768?d|4294901760:d},n.prototype.readInt32LE=function(o,a){return o=o>>>0,a||j(o,4,this.length),this[o]|this[o+1]<<8|this[o+2]<<16|this[o+3]<<24},n.prototype.readInt32BE=function(o,a){return o=o>>>0,a||j(o,4,this.length),this[o]<<24|this[o+1]<<16|this[o+2]<<8|this[o+3]},n.prototype.readFloatLE=function(o,a){return o=o>>>0,a||j(o,4,this.length),t.read(this,o,!0,23,4)},n.prototype.readFloatBE=function(o,a){return o=o>>>0,a||j(o,4,this.length),t.read(this,o,!1,23,4)},n.prototype.readDoubleLE=function(o,a){return o=o>>>0,a||j(o,8,this.length),t.read(this,o,!0,52,8)},n.prototype.readDoubleBE=function(o,a){return o=o>>>0,a||j(o,8,this.length),t.read(this,o,!1,52,8)};function R(E,o,a,d,F,$){if(!n.isBuffer(E))throw new TypeError('"buffer" argument must be a Buffer instance');if(o>F||o<$)throw new RangeError('"value" argument is out of bounds');if(a+d>E.length)throw new RangeError("Index out of range")}n.prototype.writeUintLE=n.prototype.writeUIntLE=function(o,a,d,F){if(o=+o,a=a>>>0,d=d>>>0,!F){var $=Math.pow(2,8*d)-1;R(this,o,a,d,$,0)}var P=1,fe=0;for(this[a]=o&255;++fe<d&&(P*=256);)this[a+fe]=o/P&255;return a+d},n.prototype.writeUintBE=n.prototype.writeUIntBE=function(o,a,d,F){if(o=+o,a=a>>>0,d=d>>>0,!F){var $=Math.pow(2,8*d)-1;R(this,o,a,d,$,0)}var P=d-1,fe=1;for(this[a+P]=o&255;--P>=0&&(fe*=256);)this[a+P]=o/fe&255;return a+d},n.prototype.writeUint8=n.prototype.writeUInt8=function(o,a,d){return o=+o,a=a>>>0,d||R(this,o,a,1,255,0),this[a]=o&255,a+1},n.prototype.writeUint16LE=n.prototype.writeUInt16LE=function(o,a,d){return o=+o,a=a>>>0,d||R(this,o,a,2,65535,0),this[a]=o&255,this[a+1]=o>>>8,a+2},n.prototype.writeUint16BE=n.prototype.writeUInt16BE=function(o,a,d){return o=+o,a=a>>>0,d||R(this,o,a,2,65535,0),this[a]=o>>>8,this[a+1]=o&255,a+2},n.prototype.writeUint32LE=n.prototype.writeUInt32LE=function(o,a,d){return o=+o,a=a>>>0,d||R(this,o,a,4,4294967295,0),this[a+3]=o>>>24,this[a+2]=o>>>16,this[a+1]=o>>>8,this[a]=o&255,a+4},n.prototype.writeUint32BE=n.prototype.writeUInt32BE=function(o,a,d){return o=+o,a=a>>>0,d||R(this,o,a,4,4294967295,0),this[a]=o>>>24,this[a+1]=o>>>16,this[a+2]=o>>>8,this[a+3]=o&255,a+4},n.prototype.writeIntLE=function(o,a,d,F){if(o=+o,a=a>>>0,!F){var $=Math.pow(2,8*d-1);R(this,o,a,d,$-1,-$)}var P=0,fe=1,we=0;for(this[a]=o&255;++P<d&&(fe*=256);)o<0&&we===0&&this[a+P-1]!==0&&(we=1),this[a+P]=(o/fe>>0)-we&255;return a+d},n.prototype.writeIntBE=function(o,a,d,F){if(o=+o,a=a>>>0,!F){var $=Math.pow(2,8*d-1);R(this,o,a,d,$-1,-$)}var P=d-1,fe=1,we=0;for(this[a+P]=o&255;--P>=0&&(fe*=256);)o<0&&we===0&&this[a+P+1]!==0&&(we=1),this[a+P]=(o/fe>>0)-we&255;return a+d},n.prototype.writeInt8=function(o,a,d){return o=+o,a=a>>>0,d||R(this,o,a,1,127,-128),o<0&&(o=255+o+1),this[a]=o&255,a+1},n.prototype.writeInt16LE=function(o,a,d){return o=+o,a=a>>>0,d||R(this,o,a,2,32767,-32768),this[a]=o&255,this[a+1]=o>>>8,a+2},n.prototype.writeInt16BE=function(o,a,d){return o=+o,a=a>>>0,d||R(this,o,a,2,32767,-32768),this[a]=o>>>8,this[a+1]=o&255,a+2},n.prototype.writeInt32LE=function(o,a,d){return o=+o,a=a>>>0,d||R(this,o,a,4,2147483647,-2147483648),this[a]=o&255,this[a+1]=o>>>8,this[a+2]=o>>>16,this[a+3]=o>>>24,a+4},n.prototype.writeInt32BE=function(o,a,d){return o=+o,a=a>>>0,d||R(this,o,a,4,2147483647,-2147483648),o<0&&(o=4294967295+o+1),this[a]=o>>>24,this[a+1]=o>>>16,this[a+2]=o>>>8,this[a+3]=o&255,a+4};function K(E,o,a,d,F,$){if(a+d>E.length)throw new RangeError("Index out of range");if(a<0)throw new RangeError("Index out of range")}function X(E,o,a,d,F){return o=+o,a=a>>>0,F||K(E,o,a,4),t.write(E,o,a,d,23,4),a+4}n.prototype.writeFloatLE=function(o,a,d){return X(this,o,a,!0,d)},n.prototype.writeFloatBE=function(o,a,d){return X(this,o,a,!1,d)};function oe(E,o,a,d,F){return o=+o,a=a>>>0,F||K(E,o,a,8),t.write(E,o,a,d,52,8),a+8}n.prototype.writeDoubleLE=function(o,a,d){return oe(this,o,a,!0,d)},n.prototype.writeDoubleBE=function(o,a,d){return oe(this,o,a,!1,d)},n.prototype.copy=function(o,a,d,F){if(!n.isBuffer(o))throw new TypeError("argument should be a Buffer");if(d||(d=0),!F&&F!==0&&(F=this.length),a>=o.length&&(a=o.length),a||(a=0),F>0&&F<d&&(F=d),F===d||o.length===0||this.length===0)return 0;if(a<0)throw new RangeError("targetStart out of bounds");if(d<0||d>=this.length)throw new RangeError("Index out of range");if(F<0)throw new RangeError("sourceEnd out of bounds");F>this.length&&(F=this.length),o.length-a<F-d&&(F=o.length-a+d);var $=F-d;return this===o&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(a,d,F):Uint8Array.prototype.set.call(o,this.subarray(d,F),a),$},n.prototype.fill=function(o,a,d,F){if(typeof o=="string"){if(typeof a=="string"?(F=a,a=0,d=this.length):typeof d=="string"&&(F=d,d=this.length),F!==void 0&&typeof F!="string")throw new TypeError("encoding must be a string");if(typeof F=="string"&&!n.isEncoding(F))throw new TypeError("Unknown encoding: "+F);if(o.length===1){var $=o.charCodeAt(0);(F==="utf8"&&$<128||F==="latin1")&&(o=$)}}else typeof o=="number"?o=o&255:typeof o=="boolean"&&(o=Number(o));if(a<0||this.length<a||this.length<d)throw new RangeError("Out of range index");if(d<=a)return this;a=a>>>0,d=d===void 0?this.length:d>>>0,o||(o=0);var P;if(typeof o=="number")for(P=a;P<d;++P)this[P]=o;else{var fe=n.isBuffer(o)?o:n.from(o,F),we=fe.length;if(we===0)throw new TypeError('The value "'+o+'" is invalid for argument "value"');for(P=0;P<d-a;++P)this[P+a]=fe[P%we]}return this};var H=/[^+/0-9A-Za-z-_]/g;function v(E){if(E=E.split("=")[0],E=E.trim().replace(H,""),E.length<2)return"";for(;E.length%4!==0;)E=E+"=";return E}function g(E,o){o=o||1/0;for(var a,d=E.length,F=null,$=[],P=0;P<d;++P){if(a=E.charCodeAt(P),a>55295&&a<57344){if(!F){if(a>56319){(o-=3)>-1&&$.push(239,191,189);continue}else if(P+1===d){(o-=3)>-1&&$.push(239,191,189);continue}F=a;continue}if(a<56320){(o-=3)>-1&&$.push(239,191,189),F=a;continue}a=(F-55296<<10|a-56320)+65536}else F&&(o-=3)>-1&&$.push(239,191,189);if(F=null,a<128){if((o-=1)<0)break;$.push(a)}else if(a<2048){if((o-=2)<0)break;$.push(a>>6|192,a&63|128)}else if(a<65536){if((o-=3)<0)break;$.push(a>>12|224,a>>6&63|128,a&63|128)}else if(a<1114112){if((o-=4)<0)break;$.push(a>>18|240,a>>12&63|128,a>>6&63|128,a&63|128)}else throw new Error("Invalid code point")}return $}function U(E){for(var o=[],a=0;a<E.length;++a)o.push(E.charCodeAt(a)&255);return o}function L(E,o){for(var a,d,F,$=[],P=0;P<E.length&&!((o-=2)<0);++P)a=E.charCodeAt(P),d=a>>8,F=a%256,$.push(F),$.push(d);return $}function N(E){return e.toByteArray(v(E))}function O(E,o,a,d){for(var F=0;F<d&&!(F+a>=o.length||F>=E.length);++F)o[F+a]=E[F];return F}function ae(E,o){return E instanceof o||E!=null&&E.constructor!=null&&E.constructor.name!=null&&E.constructor.name===o.name}function h(E){return E!==E}var Q=function(){for(var E="0123456789abcdef",o=new Array(256),a=0;a<16;++a)for(var d=a*16,F=0;F<16;++F)o[d+F]=E[a]+E[F];return o}()}(ln)),ln}var cn={},un={},fn,ji;function Es(){return ji||(ji=1,fn=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},t=Symbol("test"),s=Object(t);if(typeof t=="string"||Object.prototype.toString.call(t)!=="[object Symbol]"||Object.prototype.toString.call(s)!=="[object Symbol]")return!1;var l=42;e[t]=l;for(t in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var i=Object.getOwnPropertySymbols(e);if(i.length!==1||i[0]!==t||!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var c=Object.getOwnPropertyDescriptor(e,t);if(c.value!==l||c.enumerable!==!0)return!1}return!0}),fn}var hn,zi;function pi(){if(zi)return hn;zi=1;var r=Es();return hn=function(){return r()&&!!Symbol.toStringTag},hn}var dn,Hi;function Wa(){if(Hi)return dn;Hi=1;var r=typeof Symbol<"u"&&Symbol,e=Es();return dn=function(){return typeof r!="function"||typeof Symbol!="function"||typeof r("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:e()},dn}var pn,Wi;function Ga(){if(Wi)return pn;Wi=1;var r={foo:{}},e=Object;return pn=function(){return{__proto__:r}.foo===r.foo&&!({__proto__:null}instanceof e)},pn}var mn,Gi;function $a(){if(Gi)return mn;Gi=1;var r="Function.prototype.bind called on incompatible ",e=Object.prototype.toString,t=Math.max,s="[object Function]",l=function(u,m){for(var w=[],b=0;b<u.length;b+=1)w[b]=u[b];for(var T=0;T<m.length;T+=1)w[T+u.length]=m[T];return w},i=function(u,m){for(var w=[],b=m,T=0;b<u.length;b+=1,T+=1)w[T]=u[b];return w},c=function(n,u){for(var m="",w=0;w<n.length;w+=1)m+=n[w],w+1<n.length&&(m+=u);return m};return mn=function(u){var m=this;if(typeof m!="function"||e.apply(m)!==s)throw new TypeError(r+m);for(var w=i(arguments,1),b,T=function(){if(this instanceof b){var f=m.apply(this,l(w,arguments));return Object(f)===f?f:this}return m.apply(u,l(w,arguments))},p=t(0,m.length-w.length),S=[],y=0;y<p;y++)S[y]="$"+y;if(b=Function("binder","return function ("+c(S,",")+"){ return binder.apply(this,arguments); }")(T),m.prototype){var _=function(){};_.prototype=m.prototype,b.prototype=new _,_.prototype=null}return b},mn}var gn,$i;function mi(){if($i)return gn;$i=1;var r=$a();return gn=Function.prototype.bind||r,gn}var wn,Vi;function Va(){if(Vi)return wn;Vi=1;var r=Function.prototype.call,e=Object.prototype.hasOwnProperty,t=mi();return wn=t.call(r,e),wn}var yn,Ki;function pr(){if(Ki)return yn;Ki=1;var r,e=SyntaxError,t=Function,s=TypeError,l=function(B){try{return t('"use strict"; return ('+B+").constructor;")()}catch{}},i=Object.getOwnPropertyDescriptor;if(i)try{i({},"")}catch{i=null}var c=function(){throw new s},n=i?function(){try{return arguments.callee,c}catch{try{return i(arguments,"callee").get}catch{return c}}}():c,u=Wa()(),m=Ga()(),w=Object.getPrototypeOf||(m?function(B){return B.__proto__}:null),b={},T=typeof Uint8Array>"u"||!w?r:w(Uint8Array),p={"%AggregateError%":typeof AggregateError>"u"?r:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?r:ArrayBuffer,"%ArrayIteratorPrototype%":u&&w?w([][Symbol.iterator]()):r,"%AsyncFromSyncIteratorPrototype%":r,"%AsyncFunction%":b,"%AsyncGenerator%":b,"%AsyncGeneratorFunction%":b,"%AsyncIteratorPrototype%":b,"%Atomics%":typeof Atomics>"u"?r:Atomics,"%BigInt%":typeof BigInt>"u"?r:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?r:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?r:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?r:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?r:Float32Array,"%Float64Array%":typeof Float64Array>"u"?r:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?r:FinalizationRegistry,"%Function%":t,"%GeneratorFunction%":b,"%Int8Array%":typeof Int8Array>"u"?r:Int8Array,"%Int16Array%":typeof Int16Array>"u"?r:Int16Array,"%Int32Array%":typeof Int32Array>"u"?r:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":u&&w?w(w([][Symbol.iterator]())):r,"%JSON%":typeof JSON=="object"?JSON:r,"%Map%":typeof Map>"u"?r:Map,"%MapIteratorPrototype%":typeof Map>"u"||!u||!w?r:w(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?r:Promise,"%Proxy%":typeof Proxy>"u"?r:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?r:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?r:Set,"%SetIteratorPrototype%":typeof Set>"u"||!u||!w?r:w(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?r:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":u&&w?w(""[Symbol.iterator]()):r,"%Symbol%":u?Symbol:r,"%SyntaxError%":e,"%ThrowTypeError%":n,"%TypedArray%":T,"%TypeError%":s,"%Uint8Array%":typeof Uint8Array>"u"?r:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?r:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?r:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?r:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?r:WeakMap,"%WeakRef%":typeof WeakRef>"u"?r:WeakRef,"%WeakSet%":typeof WeakSet>"u"?r:WeakSet};if(w)try{null.error}catch(B){var S=w(w(B));p["%Error.prototype%"]=S}var y=function B(W){var A;if(W==="%AsyncFunction%")A=l("async function () {}");else if(W==="%GeneratorFunction%")A=l("function* () {}");else if(W==="%AsyncGeneratorFunction%")A=l("async function* () {}");else if(W==="%AsyncGenerator%"){var z=B("%AsyncGeneratorFunction%");z&&(A=z.prototype)}else if(W==="%AsyncIteratorPrototype%"){var se=B("%AsyncGenerator%");se&&w&&(A=w(se.prototype))}return p[W]=A,A},_={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},f=mi(),x=Va(),k=f.call(Function.call,Array.prototype.concat),C=f.call(Function.apply,Array.prototype.splice),D=f.call(Function.call,String.prototype.replace),q=f.call(Function.call,String.prototype.slice),M=f.call(Function.call,RegExp.prototype.exec),J=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,I=/\\(\\)?/g,ue=function(W){var A=q(W,0,1),z=q(W,-1);if(A==="%"&&z!=="%")throw new e("invalid intrinsic syntax, expected closing `%`");if(z==="%"&&A!=="%")throw new e("invalid intrinsic syntax, expected opening `%`");var se=[];return D(W,J,function(V,ye,Z,re){se[se.length]=Z?D(re,I,"$1"):ye||V}),se},ee=function(W,A){var z=W,se;if(x(_,z)&&(se=_[z],z="%"+se[0]+"%"),x(p,z)){var V=p[z];if(V===b&&(V=y(z)),typeof V>"u"&&!A)throw new s("intrinsic "+W+" exists, but is not available. Please file an issue!");return{alias:se,name:z,value:V}}throw new e("intrinsic "+W+" does not exist!")};return yn=function(W,A){if(typeof W!="string"||W.length===0)throw new s("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof A!="boolean")throw new s('"allowMissing" argument must be a boolean');if(M(/^%?[^%]*%?$/,W)===null)throw new e("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var z=ue(W),se=z.length>0?z[0]:"",V=ee("%"+se+"%",A),ye=V.name,Z=V.value,re=!1,j=V.alias;j&&(se=j[0],C(z,k([0,1],j)));for(var R=1,K=!0;R<z.length;R+=1){var X=z[R],oe=q(X,0,1),H=q(X,-1);if((oe==='"'||oe==="'"||oe==="`"||H==='"'||H==="'"||H==="`")&&oe!==H)throw new e("property names with quotes must have matching quotes");if((X==="constructor"||!K)&&(re=!0),se+="."+X,ye="%"+se+"%",x(p,ye))Z=p[ye];else if(Z!=null){if(!(X in Z)){if(!A)throw new s("base intrinsic for "+W+" exists, but the property is not available.");return}if(i&&R+1>=z.length){var v=i(Z,X);K=!!v,K&&"get"in v&&!("originalValue"in v.get)?Z=v.get:Z=Z[X]}else K=x(Z,X),Z=Z[X];K&&!re&&(p[ye]=Z)}}return Z},yn}var vn={exports:{}},bn,qi;function xs(){if(qi)return bn;qi=1;var r=pr(),e=r("%Object.defineProperty%",!0),t=function(){if(e)try{return e({},"a",{value:1}),!0}catch{return!1}return!1};return t.hasArrayLengthDefineBug=function(){if(!t())return null;try{return e([],"length",{value:1}).length!==1}catch{return!0}},bn=t,bn}var _n,Xi;function gi(){if(Xi)return _n;Xi=1;var r=pr(),e=r("%Object.getOwnPropertyDescriptor%",!0);if(e)try{e([],"length")}catch{e=null}return _n=e,_n}var En,Zi;function Ka(){if(Zi)return En;Zi=1;var r=xs()(),e=pr(),t=r&&e("%Object.defineProperty%",!0);if(t)try{t({},"a",{value:1})}catch{t=!1}var s=e("%SyntaxError%"),l=e("%TypeError%"),i=gi();return En=function(n,u,m){if(!n||typeof n!="object"&&typeof n!="function")throw new l("`obj` must be an object or a function`");if(typeof u!="string"&&typeof u!="symbol")throw new l("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new l("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new l("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new l("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new l("`loose`, if provided, must be a boolean");var w=arguments.length>3?arguments[3]:null,b=arguments.length>4?arguments[4]:null,T=arguments.length>5?arguments[5]:null,p=arguments.length>6?arguments[6]:!1,S=!!i&&i(n,u);if(t)t(n,u,{configurable:T===null&&S?S.configurable:!T,enumerable:w===null&&S?S.enumerable:!w,value:m,writable:b===null&&S?S.writable:!b});else if(p||!w&&!b&&!T)n[u]=m;else throw new s("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},En}var xn,Yi;function qa(){if(Yi)return xn;Yi=1;var r=pr(),e=Ka(),t=xs()(),s=gi(),l=r("%TypeError%"),i=r("%Math.floor%");return xn=function(n,u){if(typeof n!="function")throw new l("`fn` is not a function");if(typeof u!="number"||u<0||u>4294967295||i(u)!==u)throw new l("`length` must be a positive 32-bit integer");var m=arguments.length>2&&!!arguments[2],w=!0,b=!0;if("length"in n&&s){var T=s(n,"length");T&&!T.configurable&&(w=!1),T&&!T.writable&&(b=!1)}return(w||b||!m)&&(t?e(n,"length",u,!0,!0):e(n,"length",u)),n},xn}var Ji;function Ts(){return Ji||(Ji=1,function(r){var e=mi(),t=pr(),s=qa(),l=t("%TypeError%"),i=t("%Function.prototype.apply%"),c=t("%Function.prototype.call%"),n=t("%Reflect.apply%",!0)||e.call(c,i),u=t("%Object.defineProperty%",!0),m=t("%Math.max%");if(u)try{u({},"a",{value:1})}catch{u=null}r.exports=function(T){if(typeof T!="function")throw new l("a function is required");var p=n(e,c,arguments);return s(p,1+m(0,T.length-(arguments.length-1)),!0)};var w=function(){return n(e,i,arguments)};u?u(r.exports,"apply",{value:w}):r.exports.apply=w}(vn)),vn.exports}var Tn,Qi;function As(){if(Qi)return Tn;Qi=1;var r=pr(),e=Ts(),t=e(r("String.prototype.indexOf"));return Tn=function(l,i){var c=r(l,!!i);return typeof c=="function"&&t(l,".prototype.")>-1?e(c):c},Tn}var An,eo;function Xa(){if(eo)return An;eo=1;var r=pi()(),e=As(),t=e("Object.prototype.toString"),s=function(n){return r&&n&&typeof n=="object"&&Symbol.toStringTag in n?!1:t(n)==="[object Arguments]"},l=function(n){return s(n)?!0:n!==null&&typeof n=="object"&&typeof n.length=="number"&&n.length>=0&&t(n)!=="[object Array]"&&t(n.callee)==="[object Function]"},i=function(){return s(arguments)}();return s.isLegacyArguments=l,An=i?s:l,An}var Sn,to;function Za(){if(to)return Sn;to=1;var r=Object.prototype.toString,e=Function.prototype.toString,t=/^\s*(?:function)?\*/,s=pi()(),l=Object.getPrototypeOf,i=function(){if(!s)return!1;try{return Function("return function*() {}")()}catch{}},c;return Sn=function(u){if(typeof u!="function")return!1;if(t.test(e.call(u)))return!0;if(!s){var m=r.call(u);return m==="[object GeneratorFunction]"}if(!l)return!1;if(typeof c>"u"){var w=i();c=w?l(w):!1}return l(u)===c},Sn}var kn,ro;function Ya(){if(ro)return kn;ro=1;var r=Function.prototype.toString,e=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,t,s;if(typeof e=="function"&&typeof Object.defineProperty=="function")try{t=Object.defineProperty({},"length",{get:function(){throw s}}),s={},e(function(){throw 42},null,t)}catch(x){x!==s&&(e=null)}else e=null;var l=/^\s*class\b/,i=function(k){try{var C=r.call(k);return l.test(C)}catch{return!1}},c=function(k){try{return i(k)?!1:(r.call(k),!0)}catch{return!1}},n=Object.prototype.toString,u="[object Object]",m="[object Function]",w="[object GeneratorFunction]",b="[object HTMLAllCollection]",T="[object HTML document.all class]",p="[object HTMLCollection]",S=typeof Symbol=="function"&&!!Symbol.toStringTag,y=!(0 in[,]),_=function(){return!1};if(typeof document=="object"){var f=document.all;n.call(f)===n.call(document.all)&&(_=function(k){if((y||!k)&&(typeof k>"u"||typeof k=="object"))try{var C=n.call(k);return(C===b||C===T||C===p||C===u)&&k("")==null}catch{}return!1})}return kn=e?function(k){if(_(k))return!0;if(!k||typeof k!="function"&&typeof k!="object")return!1;try{e(k,null,t)}catch(C){if(C!==s)return!1}return!i(k)&&c(k)}:function(k){if(_(k))return!0;if(!k||typeof k!="function"&&typeof k!="object")return!1;if(S)return c(k);if(i(k))return!1;var C=n.call(k);return C!==m&&C!==w&&!/^\[object HTML/.test(C)?!1:c(k)},kn}var Cn,no;function Ja(){if(no)return Cn;no=1;var r=Ya(),e=Object.prototype.toString,t=Object.prototype.hasOwnProperty,s=function(u,m,w){for(var b=0,T=u.length;b<T;b++)t.call(u,b)&&(w==null?m(u[b],b,u):m.call(w,u[b],b,u))},l=function(u,m,w){for(var b=0,T=u.length;b<T;b++)w==null?m(u.charAt(b),b,u):m.call(w,u.charAt(b),b,u)},i=function(u,m,w){for(var b in u)t.call(u,b)&&(w==null?m(u[b],b,u):m.call(w,u[b],b,u))},c=function(u,m,w){if(!r(m))throw new TypeError("iterator must be a function");var b;arguments.length>=3&&(b=w),e.call(u)==="[object Array]"?s(u,m,b):typeof u=="string"?l(u,m,b):i(u,m,b)};return Cn=c,Cn}var In,io;function Qa(){if(io)return In;io=1;var r=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"],e=typeof globalThis>"u"?Rt:globalThis;return In=function(){for(var s=[],l=0;l<r.length;l++)typeof e[r[l]]=="function"&&(s[s.length]=r[l]);return s},In}var Rn,oo;function Ss(){if(oo)return Rn;oo=1;var r=Ja(),e=Qa(),t=Ts(),s=As(),l=gi(),i=s("Object.prototype.toString"),c=pi()(),n=typeof globalThis>"u"?Rt:globalThis,u=e(),m=s("String.prototype.slice"),w=Object.getPrototypeOf,b=s("Array.prototype.indexOf",!0)||function(_,f){for(var x=0;x<_.length;x+=1)if(_[x]===f)return x;return-1},T={__proto__:null};c&&l&&w?r(u,function(y){var _=new n[y];if(Symbol.toStringTag in _){var f=w(_),x=l(f,Symbol.toStringTag);if(!x){var k=w(f);x=l(k,Symbol.toStringTag)}T["$"+y]=t(x.get)}}):r(u,function(y){var _=new n[y],f=_.slice||_.set;f&&(T["$"+y]=t(f))});var p=function(_){var f=!1;return r(T,function(x,k){if(!f)try{"$"+x(_)===k&&(f=m(k,1))}catch{}}),f},S=function(_){var f=!1;return r(T,function(x,k){if(!f)try{x(_),f=m(k,1)}catch{}}),f};return Rn=function(_){if(!_||typeof _!="object")return!1;if(!c){var f=m(i(_),8,-1);return b(u,f)>-1?f:f!=="Object"?!1:S(_)}return l?p(_):null},Rn}var Nn,so;function el(){if(so)return Nn;so=1;var r=Ss();return Nn=function(t){return!!r(t)},Nn}var ao;function tl(){return ao||(ao=1,function(r){var e=Xa(),t=Za(),s=Ss(),l=el();function i(d){return d.call.bind(d)}var c=typeof BigInt<"u",n=typeof Symbol<"u",u=i(Object.prototype.toString),m=i(Number.prototype.valueOf),w=i(String.prototype.valueOf),b=i(Boolean.prototype.valueOf);if(c)var T=i(BigInt.prototype.valueOf);if(n)var p=i(Symbol.prototype.valueOf);function S(d,F){if(typeof d!="object")return!1;try{return F(d),!0}catch{return!1}}r.isArgumentsObject=e,r.isGeneratorFunction=t,r.isTypedArray=l;function y(d){return typeof Promise<"u"&&d instanceof Promise||d!==null&&typeof d=="object"&&typeof d.then=="function"&&typeof d.catch=="function"}r.isPromise=y;function _(d){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(d):l(d)||K(d)}r.isArrayBufferView=_;function f(d){return s(d)==="Uint8Array"}r.isUint8Array=f;function x(d){return s(d)==="Uint8ClampedArray"}r.isUint8ClampedArray=x;function k(d){return s(d)==="Uint16Array"}r.isUint16Array=k;function C(d){return s(d)==="Uint32Array"}r.isUint32Array=C;function D(d){return s(d)==="Int8Array"}r.isInt8Array=D;function q(d){return s(d)==="Int16Array"}r.isInt16Array=q;function M(d){return s(d)==="Int32Array"}r.isInt32Array=M;function J(d){return s(d)==="Float32Array"}r.isFloat32Array=J;function I(d){return s(d)==="Float64Array"}r.isFloat64Array=I;function ue(d){return s(d)==="BigInt64Array"}r.isBigInt64Array=ue;function ee(d){return s(d)==="BigUint64Array"}r.isBigUint64Array=ee;function B(d){return u(d)==="[object Map]"}B.working=typeof Map<"u"&&B(new Map);function W(d){return typeof Map>"u"?!1:B.working?B(d):d instanceof Map}r.isMap=W;function A(d){return u(d)==="[object Set]"}A.working=typeof Set<"u"&&A(new Set);function z(d){return typeof Set>"u"?!1:A.working?A(d):d instanceof Set}r.isSet=z;function se(d){return u(d)==="[object WeakMap]"}se.working=typeof WeakMap<"u"&&se(new WeakMap);function V(d){return typeof WeakMap>"u"?!1:se.working?se(d):d instanceof WeakMap}r.isWeakMap=V;function ye(d){return u(d)==="[object WeakSet]"}ye.working=typeof WeakSet<"u"&&ye(new WeakSet);function Z(d){return ye(d)}r.isWeakSet=Z;function re(d){return u(d)==="[object ArrayBuffer]"}re.working=typeof ArrayBuffer<"u"&&re(new ArrayBuffer);function j(d){return typeof ArrayBuffer>"u"?!1:re.working?re(d):d instanceof ArrayBuffer}r.isArrayBuffer=j;function R(d){return u(d)==="[object DataView]"}R.working=typeof ArrayBuffer<"u"&&typeof DataView<"u"&&R(new DataView(new ArrayBuffer(1),0,1));function K(d){return typeof DataView>"u"?!1:R.working?R(d):d instanceof DataView}r.isDataView=K;var X=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:void 0;function oe(d){return u(d)==="[object SharedArrayBuffer]"}function H(d){return typeof X>"u"?!1:(typeof oe.working>"u"&&(oe.working=oe(new X)),oe.working?oe(d):d instanceof X)}r.isSharedArrayBuffer=H;function v(d){return u(d)==="[object AsyncFunction]"}r.isAsyncFunction=v;function g(d){return u(d)==="[object Map Iterator]"}r.isMapIterator=g;function U(d){return u(d)==="[object Set Iterator]"}r.isSetIterator=U;function L(d){return u(d)==="[object Generator]"}r.isGeneratorObject=L;function N(d){return u(d)==="[object WebAssembly.Module]"}r.isWebAssemblyCompiledModule=N;function O(d){return S(d,m)}r.isNumberObject=O;function ae(d){return S(d,w)}r.isStringObject=ae;function h(d){return S(d,b)}r.isBooleanObject=h;function Q(d){return c&&S(d,T)}r.isBigIntObject=Q;function E(d){return n&&S(d,p)}r.isSymbolObject=E;function o(d){return O(d)||ae(d)||h(d)||Q(d)||E(d)}r.isBoxedPrimitive=o;function a(d){return typeof Uint8Array<"u"&&(j(d)||H(d))}r.isAnyArrayBuffer=a,["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(d){Object.defineProperty(r,d,{enumerable:!1,value:function(){throw new Error(d+" is not supported in userland")}})})}(un)),un}var Dn,lo;function rl(){return lo||(lo=1,Dn=function(e){return e&&typeof e=="object"&&typeof e.copy=="function"&&typeof e.fill=="function"&&typeof e.readUInt8=="function"}),Dn}var co;function ks(){return co||(co=1,function(r){var e=Object.getOwnPropertyDescriptors||function(K){for(var X=Object.keys(K),oe={},H=0;H<X.length;H++)oe[X[H]]=Object.getOwnPropertyDescriptor(K,X[H]);return oe},t=/%[sdj%]/g;r.format=function(R){if(!D(R)){for(var K=[],X=0;X<arguments.length;X++)K.push(c(arguments[X]));return K.join(" ")}for(var X=1,oe=arguments,H=oe.length,v=String(R).replace(t,function(U){if(U==="%%")return"%";if(X>=H)return U;switch(U){case"%s":return String(oe[X++]);case"%d":return Number(oe[X++]);case"%j":try{return JSON.stringify(oe[X++])}catch{return"[Circular]"}default:return U}}),g=oe[X];X<H;g=oe[++X])x(g)||!I(g)?v+=" "+g:v+=" "+c(g);return v},r.deprecate=function(R,K){if(typeof Me<"u"&&Me.noDeprecation===!0)return R;if(typeof Me>"u")return function(){return r.deprecate(R,K).apply(this,arguments)};var X=!1;function oe(){if(!X){if(Me.throwDeprecation)throw new Error(K);Me.traceDeprecation?console.trace(K):console.error(K),X=!0}return R.apply(this,arguments)}return oe};var s={},l=/^$/;if(Me.env.NODE_DEBUG){var i=Me.env.NODE_DEBUG;i=i.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),l=new RegExp("^"+i+"$","i")}r.debuglog=function(R){if(R=R.toUpperCase(),!s[R])if(l.test(R)){var K=Me.pid;s[R]=function(){var X=r.format.apply(r,arguments);console.error("%s %d: %s",R,K,X)}}else s[R]=function(){};return s[R]};function c(R,K){var X={seen:[],stylize:u};return arguments.length>=3&&(X.depth=arguments[2]),arguments.length>=4&&(X.colors=arguments[3]),f(K)?X.showHidden=K:K&&r._extend(X,K),M(X.showHidden)&&(X.showHidden=!1),M(X.depth)&&(X.depth=2),M(X.colors)&&(X.colors=!1),M(X.customInspect)&&(X.customInspect=!0),X.colors&&(X.stylize=n),w(X,R,X.depth)}r.inspect=c,c.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},c.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function n(R,K){var X=c.styles[K];return X?"\x1B["+c.colors[X][0]+"m"+R+"\x1B["+c.colors[X][1]+"m":R}function u(R,K){return R}function m(R){var K={};return R.forEach(function(X,oe){K[X]=!0}),K}function w(R,K,X){if(R.customInspect&&K&&B(K.inspect)&&K.inspect!==r.inspect&&!(K.constructor&&K.constructor.prototype===K)){var oe=K.inspect(X,R);return D(oe)||(oe=w(R,oe,X)),oe}var H=b(R,K);if(H)return H;var v=Object.keys(K),g=m(v);if(R.showHidden&&(v=Object.getOwnPropertyNames(K)),ee(K)&&(v.indexOf("message")>=0||v.indexOf("description")>=0))return T(K);if(v.length===0){if(B(K)){var U=K.name?": "+K.name:"";return R.stylize("[Function"+U+"]","special")}if(J(K))return R.stylize(RegExp.prototype.toString.call(K),"regexp");if(ue(K))return R.stylize(Date.prototype.toString.call(K),"date");if(ee(K))return T(K)}var L="",N=!1,O=["{","}"];if(_(K)&&(N=!0,O=["[","]"]),B(K)){var ae=K.name?": "+K.name:"";L=" [Function"+ae+"]"}if(J(K)&&(L=" "+RegExp.prototype.toString.call(K)),ue(K)&&(L=" "+Date.prototype.toUTCString.call(K)),ee(K)&&(L=" "+T(K)),v.length===0&&(!N||K.length==0))return O[0]+L+O[1];if(X<0)return J(K)?R.stylize(RegExp.prototype.toString.call(K),"regexp"):R.stylize("[Object]","special");R.seen.push(K);var h;return N?h=p(R,K,X,g,v):h=v.map(function(Q){return S(R,K,X,g,Q,N)}),R.seen.pop(),y(h,L,O)}function b(R,K){if(M(K))return R.stylize("undefined","undefined");if(D(K)){var X="'"+JSON.stringify(K).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return R.stylize(X,"string")}if(C(K))return R.stylize(""+K,"number");if(f(K))return R.stylize(""+K,"boolean");if(x(K))return R.stylize("null","null")}function T(R){return"["+Error.prototype.toString.call(R)+"]"}function p(R,K,X,oe,H){for(var v=[],g=0,U=K.length;g<U;++g)ye(K,String(g))?v.push(S(R,K,X,oe,String(g),!0)):v.push("");return H.forEach(function(L){L.match(/^\d+$/)||v.push(S(R,K,X,oe,L,!0))}),v}function S(R,K,X,oe,H,v){var g,U,L;if(L=Object.getOwnPropertyDescriptor(K,H)||{value:K[H]},L.get?L.set?U=R.stylize("[Getter/Setter]","special"):U=R.stylize("[Getter]","special"):L.set&&(U=R.stylize("[Setter]","special")),ye(oe,H)||(g="["+H+"]"),U||(R.seen.indexOf(L.value)<0?(x(X)?U=w(R,L.value,null):U=w(R,L.value,X-1),U.indexOf(`
`)>-1&&(v?U=U.split(`
`).map(function(N){return"  "+N}).join(`
`).slice(2):U=`
`+U.split(`
`).map(function(N){return"   "+N}).join(`
`))):U=R.stylize("[Circular]","special")),M(g)){if(v&&H.match(/^\d+$/))return U;g=JSON.stringify(""+H),g.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(g=g.slice(1,-1),g=R.stylize(g,"name")):(g=g.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),g=R.stylize(g,"string"))}return g+": "+U}function y(R,K,X){var oe=R.reduce(function(H,v){return v.indexOf(`
`)>=0,H+v.replace(/\u001b\[\d\d?m/g,"").length+1},0);return oe>60?X[0]+(K===""?"":K+`
 `)+" "+R.join(`,
  `)+" "+X[1]:X[0]+K+" "+R.join(", ")+" "+X[1]}r.types=tl();function _(R){return Array.isArray(R)}r.isArray=_;function f(R){return typeof R=="boolean"}r.isBoolean=f;function x(R){return R===null}r.isNull=x;function k(R){return R==null}r.isNullOrUndefined=k;function C(R){return typeof R=="number"}r.isNumber=C;function D(R){return typeof R=="string"}r.isString=D;function q(R){return typeof R=="symbol"}r.isSymbol=q;function M(R){return R===void 0}r.isUndefined=M;function J(R){return I(R)&&A(R)==="[object RegExp]"}r.isRegExp=J,r.types.isRegExp=J;function I(R){return typeof R=="object"&&R!==null}r.isObject=I;function ue(R){return I(R)&&A(R)==="[object Date]"}r.isDate=ue,r.types.isDate=ue;function ee(R){return I(R)&&(A(R)==="[object Error]"||R instanceof Error)}r.isError=ee,r.types.isNativeError=ee;function B(R){return typeof R=="function"}r.isFunction=B;function W(R){return R===null||typeof R=="boolean"||typeof R=="number"||typeof R=="string"||typeof R=="symbol"||typeof R>"u"}r.isPrimitive=W,r.isBuffer=rl();function A(R){return Object.prototype.toString.call(R)}function z(R){return R<10?"0"+R.toString(10):R.toString(10)}var se=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function V(){var R=new Date,K=[z(R.getHours()),z(R.getMinutes()),z(R.getSeconds())].join(":");return[R.getDate(),se[R.getMonth()],K].join(" ")}r.log=function(){console.log("%s - %s",V(),r.format.apply(r,arguments))},r.inherits=Kt,r._extend=function(R,K){if(!K||!I(K))return R;for(var X=Object.keys(K),oe=X.length;oe--;)R[X[oe]]=K[X[oe]];return R};function ye(R,K){return Object.prototype.hasOwnProperty.call(R,K)}var Z=typeof Symbol<"u"?Symbol("util.promisify.custom"):void 0;r.promisify=function(K){if(typeof K!="function")throw new TypeError('The "original" argument must be of type Function');if(Z&&K[Z]){var X=K[Z];if(typeof X!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(X,Z,{value:X,enumerable:!1,writable:!1,configurable:!0}),X}function X(){for(var oe,H,v=new Promise(function(L,N){oe=L,H=N}),g=[],U=0;U<arguments.length;U++)g.push(arguments[U]);g.push(function(L,N){L?H(L):oe(N)});try{K.apply(this,g)}catch(L){H(L)}return v}return Object.setPrototypeOf(X,Object.getPrototypeOf(K)),Z&&Object.defineProperty(X,Z,{value:X,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(X,e(K))},r.promisify.custom=Z;function re(R,K){if(!R){var X=new Error("Promise was rejected with a falsy value");X.reason=R,R=X}return K(R)}function j(R){if(typeof R!="function")throw new TypeError('The "original" argument must be of type Function');function K(){for(var X=[],oe=0;oe<arguments.length;oe++)X.push(arguments[oe]);var H=X.pop();if(typeof H!="function")throw new TypeError("The last argument must be of type Function");var v=this,g=function(){return H.apply(v,arguments)};R.apply(this,X).then(function(U){Me.nextTick(g.bind(null,null,U))},function(U){Me.nextTick(re.bind(null,U,g))})}return Object.setPrototypeOf(K,Object.getPrototypeOf(R)),Object.defineProperties(K,e(R)),K}r.callbackify=j}(cn)),cn}var On,uo;function nl(){if(uo)return On;uo=1;function r(T,p){var S=Object.keys(T);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(T);p&&(y=y.filter(function(_){return Object.getOwnPropertyDescriptor(T,_).enumerable})),S.push.apply(S,y)}return S}function e(T){for(var p=1;p<arguments.length;p++){var S=arguments[p]!=null?arguments[p]:{};p%2?r(Object(S),!0).forEach(function(y){t(T,y,S[y])}):Object.getOwnPropertyDescriptors?Object.defineProperties(T,Object.getOwnPropertyDescriptors(S)):r(Object(S)).forEach(function(y){Object.defineProperty(T,y,Object.getOwnPropertyDescriptor(S,y))})}return T}function t(T,p,S){return p in T?Object.defineProperty(T,p,{value:S,enumerable:!0,configurable:!0,writable:!0}):T[p]=S,T}function s(T,p){if(!(T instanceof p))throw new TypeError("Cannot call a class as a function")}function l(T,p){for(var S=0;S<p.length;S++){var y=p[S];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(T,y.key,y)}}function i(T,p,S){return p&&l(T.prototype,p),T}var c=Jr(),n=c.Buffer,u=ks(),m=u.inspect,w=m&&m.custom||"inspect";function b(T,p,S){n.prototype.copy.call(T,p,S)}return On=function(){function T(){s(this,T),this.head=null,this.tail=null,this.length=0}return i(T,[{key:"push",value:function(S){var y={data:S,next:null};this.length>0?this.tail.next=y:this.head=y,this.tail=y,++this.length}},{key:"unshift",value:function(S){var y={data:S,next:this.head};this.length===0&&(this.tail=y),this.head=y,++this.length}},{key:"shift",value:function(){if(this.length!==0){var S=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,S}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(S){if(this.length===0)return"";for(var y=this.head,_=""+y.data;y=y.next;)_+=S+y.data;return _}},{key:"concat",value:function(S){if(this.length===0)return n.alloc(0);for(var y=n.allocUnsafe(S>>>0),_=this.head,f=0;_;)b(_.data,y,f),f+=_.data.length,_=_.next;return y}},{key:"consume",value:function(S,y){var _;return S<this.head.data.length?(_=this.head.data.slice(0,S),this.head.data=this.head.data.slice(S)):S===this.head.data.length?_=this.shift():_=y?this._getString(S):this._getBuffer(S),_}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(S){var y=this.head,_=1,f=y.data;for(S-=f.length;y=y.next;){var x=y.data,k=S>x.length?x.length:S;if(k===x.length?f+=x:f+=x.slice(0,S),S-=k,S===0){k===x.length?(++_,y.next?this.head=y.next:this.head=this.tail=null):(this.head=y,y.data=x.slice(k));break}++_}return this.length-=_,f}},{key:"_getBuffer",value:function(S){var y=n.allocUnsafe(S),_=this.head,f=1;for(_.data.copy(y),S-=_.data.length;_=_.next;){var x=_.data,k=S>x.length?x.length:S;if(x.copy(y,y.length-S,0,k),S-=k,S===0){k===x.length?(++f,_.next?this.head=_.next:this.head=this.tail=null):(this.head=_,_.data=x.slice(k));break}++f}return this.length-=f,y}},{key:w,value:function(S,y){return m(this,e({},y,{depth:0,customInspect:!1}))}}]),T}(),On}var Bn,fo;function Cs(){if(fo)return Bn;fo=1;function r(c,n){var u=this,m=this._readableState&&this._readableState.destroyed,w=this._writableState&&this._writableState.destroyed;return m||w?(n?n(c):c&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,Me.nextTick(l,this,c)):Me.nextTick(l,this,c)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(c||null,function(b){!n&&b?u._writableState?u._writableState.errorEmitted?Me.nextTick(t,u):(u._writableState.errorEmitted=!0,Me.nextTick(e,u,b)):Me.nextTick(e,u,b):n?(Me.nextTick(t,u),n(b)):Me.nextTick(t,u)}),this)}function e(c,n){l(c,n),t(c)}function t(c){c._writableState&&!c._writableState.emitClose||c._readableState&&!c._readableState.emitClose||c.emit("close")}function s(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function l(c,n){c.emit("error",n)}function i(c,n){var u=c._readableState,m=c._writableState;u&&u.autoDestroy||m&&m.autoDestroy?c.destroy(n):c.emit("error",n)}return Bn={destroy:r,undestroy:s,errorOrDestroy:i},Bn}var Fn={},ho;function mr(){if(ho)return Fn;ho=1;function r(n,u){n.prototype=Object.create(u.prototype),n.prototype.constructor=n,n.__proto__=u}var e={};function t(n,u,m){m||(m=Error);function w(T,p,S){return typeof u=="string"?u:u(T,p,S)}var b=function(T){r(p,T);function p(S,y,_){return T.call(this,w(S,y,_))||this}return p}(m);b.prototype.name=m.name,b.prototype.code=n,e[n]=b}function s(n,u){if(Array.isArray(n)){var m=n.length;return n=n.map(function(w){return String(w)}),m>2?"one of ".concat(u," ").concat(n.slice(0,m-1).join(", "),", or ")+n[m-1]:m===2?"one of ".concat(u," ").concat(n[0]," or ").concat(n[1]):"of ".concat(u," ").concat(n[0])}else return"of ".concat(u," ").concat(String(n))}function l(n,u,m){return n.substr(0,u.length)===u}function i(n,u,m){return(m===void 0||m>n.length)&&(m=n.length),n.substring(m-u.length,m)===u}function c(n,u,m){return typeof m!="number"&&(m=0),m+u.length>n.length?!1:n.indexOf(u,m)!==-1}return t("ERR_INVALID_OPT_VALUE",function(n,u){return'The value "'+u+'" is invalid for option "'+n+'"'},TypeError),t("ERR_INVALID_ARG_TYPE",function(n,u,m){var w;typeof u=="string"&&l(u,"not ")?(w="must not be",u=u.replace(/^not /,"")):w="must be";var b;if(i(n," argument"))b="The ".concat(n," ").concat(w," ").concat(s(u,"type"));else{var T=c(n,".")?"property":"argument";b='The "'.concat(n,'" ').concat(T," ").concat(w," ").concat(s(u,"type"))}return b+=". Received type ".concat(typeof m),b},TypeError),t("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),t("ERR_METHOD_NOT_IMPLEMENTED",function(n){return"The "+n+" method is not implemented"}),t("ERR_STREAM_PREMATURE_CLOSE","Premature close"),t("ERR_STREAM_DESTROYED",function(n){return"Cannot call "+n+" after a stream was destroyed"}),t("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),t("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),t("ERR_STREAM_WRITE_AFTER_END","write after end"),t("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),t("ERR_UNKNOWN_ENCODING",function(n){return"Unknown encoding: "+n},TypeError),t("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),Fn.codes=e,Fn}var Ln,po;function Is(){if(po)return Ln;po=1;var r=mr().codes.ERR_INVALID_OPT_VALUE;function e(s,l,i){return s.highWaterMark!=null?s.highWaterMark:l?s[i]:null}function t(s,l,i,c){var n=e(l,c,i);if(n!=null){if(!(isFinite(n)&&Math.floor(n)===n)||n<0){var u=c?i:"highWaterMark";throw new r(u,n)}return Math.floor(n)}return s.objectMode?16:16*1024}return Ln={getHighWaterMark:t},Ln}var Pn,mo;function il(){if(mo)return Pn;mo=1,Pn=r;function r(t,s){if(e("noDeprecation"))return t;var l=!1;function i(){if(!l){if(e("throwDeprecation"))throw new Error(s);e("traceDeprecation")?console.trace(s):console.warn(s),l=!0}return t.apply(this,arguments)}return i}function e(t){try{if(!Rt.localStorage)return!1}catch{return!1}var s=Rt.localStorage[t];return s==null?!1:String(s).toLowerCase()==="true"}return Pn}var Un,go;function Rs(){if(go)return Un;go=1,Un=J;function r(H){var v=this;this.next=null,this.entry=null,this.finish=function(){oe(v,H)}}var e;J.WritableState=q;var t={deprecate:il()},s=_s(),l=Jr().Buffer,i=Rt.Uint8Array||function(){};function c(H){return l.from(H)}function n(H){return l.isBuffer(H)||H instanceof i}var u=Cs(),m=Is(),w=m.getHighWaterMark,b=mr().codes,T=b.ERR_INVALID_ARG_TYPE,p=b.ERR_METHOD_NOT_IMPLEMENTED,S=b.ERR_MULTIPLE_CALLBACK,y=b.ERR_STREAM_CANNOT_PIPE,_=b.ERR_STREAM_DESTROYED,f=b.ERR_STREAM_NULL_VALUES,x=b.ERR_STREAM_WRITE_AFTER_END,k=b.ERR_UNKNOWN_ENCODING,C=u.errorOrDestroy;Kt(J,s);function D(){}function q(H,v,g){e=e||nr(),H=H||{},typeof g!="boolean"&&(g=v instanceof e),this.objectMode=!!H.objectMode,g&&(this.objectMode=this.objectMode||!!H.writableObjectMode),this.highWaterMark=w(this,H,"writableHighWaterMark",g),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var U=H.decodeStrings===!1;this.decodeStrings=!U,this.defaultEncoding=H.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(L){se(v,L)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=H.emitClose!==!1,this.autoDestroy=!!H.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new r(this)}q.prototype.getBuffer=function(){for(var v=this.bufferedRequest,g=[];v;)g.push(v),v=v.next;return g},function(){try{Object.defineProperty(q.prototype,"buffer",{get:t.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var M;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(M=Function.prototype[Symbol.hasInstance],Object.defineProperty(J,Symbol.hasInstance,{value:function(v){return M.call(this,v)?!0:this!==J?!1:v&&v._writableState instanceof q}})):M=function(v){return v instanceof this};function J(H){e=e||nr();var v=this instanceof e;if(!v&&!M.call(J,this))return new J(H);this._writableState=new q(H,this,v),this.writable=!0,H&&(typeof H.write=="function"&&(this._write=H.write),typeof H.writev=="function"&&(this._writev=H.writev),typeof H.destroy=="function"&&(this._destroy=H.destroy),typeof H.final=="function"&&(this._final=H.final)),s.call(this)}J.prototype.pipe=function(){C(this,new y)};function I(H,v){var g=new x;C(H,g),Me.nextTick(v,g)}function ue(H,v,g,U){var L;return g===null?L=new f:typeof g!="string"&&!v.objectMode&&(L=new T("chunk",["string","Buffer"],g)),L?(C(H,L),Me.nextTick(U,L),!1):!0}J.prototype.write=function(H,v,g){var U=this._writableState,L=!1,N=!U.objectMode&&n(H);return N&&!l.isBuffer(H)&&(H=c(H)),typeof v=="function"&&(g=v,v=null),N?v="buffer":v||(v=U.defaultEncoding),typeof g!="function"&&(g=D),U.ending?I(this,g):(N||ue(this,U,H,g))&&(U.pendingcb++,L=B(this,U,N,H,v,g)),L},J.prototype.cork=function(){this._writableState.corked++},J.prototype.uncork=function(){var H=this._writableState;H.corked&&(H.corked--,!H.writing&&!H.corked&&!H.bufferProcessing&&H.bufferedRequest&&Z(this,H))},J.prototype.setDefaultEncoding=function(v){if(typeof v=="string"&&(v=v.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((v+"").toLowerCase())>-1))throw new k(v);return this._writableState.defaultEncoding=v,this},Object.defineProperty(J.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function ee(H,v,g){return!H.objectMode&&H.decodeStrings!==!1&&typeof v=="string"&&(v=l.from(v,g)),v}Object.defineProperty(J.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function B(H,v,g,U,L,N){if(!g){var O=ee(v,U,L);U!==O&&(g=!0,L="buffer",U=O)}var ae=v.objectMode?1:U.length;v.length+=ae;var h=v.length<v.highWaterMark;if(h||(v.needDrain=!0),v.writing||v.corked){var Q=v.lastBufferedRequest;v.lastBufferedRequest={chunk:U,encoding:L,isBuf:g,callback:N,next:null},Q?Q.next=v.lastBufferedRequest:v.bufferedRequest=v.lastBufferedRequest,v.bufferedRequestCount+=1}else W(H,v,!1,ae,U,L,N);return h}function W(H,v,g,U,L,N,O){v.writelen=U,v.writecb=O,v.writing=!0,v.sync=!0,v.destroyed?v.onwrite(new _("write")):g?H._writev(L,v.onwrite):H._write(L,N,v.onwrite),v.sync=!1}function A(H,v,g,U,L){--v.pendingcb,g?(Me.nextTick(L,U),Me.nextTick(K,H,v),H._writableState.errorEmitted=!0,C(H,U)):(L(U),H._writableState.errorEmitted=!0,C(H,U),K(H,v))}function z(H){H.writing=!1,H.writecb=null,H.length-=H.writelen,H.writelen=0}function se(H,v){var g=H._writableState,U=g.sync,L=g.writecb;if(typeof L!="function")throw new S;if(z(g),v)A(H,g,U,v,L);else{var N=re(g)||H.destroyed;!N&&!g.corked&&!g.bufferProcessing&&g.bufferedRequest&&Z(H,g),U?Me.nextTick(V,H,g,N,L):V(H,g,N,L)}}function V(H,v,g,U){g||ye(H,v),v.pendingcb--,U(),K(H,v)}function ye(H,v){v.length===0&&v.needDrain&&(v.needDrain=!1,H.emit("drain"))}function Z(H,v){v.bufferProcessing=!0;var g=v.bufferedRequest;if(H._writev&&g&&g.next){var U=v.bufferedRequestCount,L=new Array(U),N=v.corkedRequestsFree;N.entry=g;for(var O=0,ae=!0;g;)L[O]=g,g.isBuf||(ae=!1),g=g.next,O+=1;L.allBuffers=ae,W(H,v,!0,v.length,L,"",N.finish),v.pendingcb++,v.lastBufferedRequest=null,N.next?(v.corkedRequestsFree=N.next,N.next=null):v.corkedRequestsFree=new r(v),v.bufferedRequestCount=0}else{for(;g;){var h=g.chunk,Q=g.encoding,E=g.callback,o=v.objectMode?1:h.length;if(W(H,v,!1,o,h,Q,E),g=g.next,v.bufferedRequestCount--,v.writing)break}g===null&&(v.lastBufferedRequest=null)}v.bufferedRequest=g,v.bufferProcessing=!1}J.prototype._write=function(H,v,g){g(new p("_write()"))},J.prototype._writev=null,J.prototype.end=function(H,v,g){var U=this._writableState;return typeof H=="function"?(g=H,H=null,v=null):typeof v=="function"&&(g=v,v=null),H!=null&&this.write(H,v),U.corked&&(U.corked=1,this.uncork()),U.ending||X(this,U,g),this},Object.defineProperty(J.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function re(H){return H.ending&&H.length===0&&H.bufferedRequest===null&&!H.finished&&!H.writing}function j(H,v){H._final(function(g){v.pendingcb--,g&&C(H,g),v.prefinished=!0,H.emit("prefinish"),K(H,v)})}function R(H,v){!v.prefinished&&!v.finalCalled&&(typeof H._final=="function"&&!v.destroyed?(v.pendingcb++,v.finalCalled=!0,Me.nextTick(j,H,v)):(v.prefinished=!0,H.emit("prefinish")))}function K(H,v){var g=re(v);if(g&&(R(H,v),v.pendingcb===0&&(v.finished=!0,H.emit("finish"),v.autoDestroy))){var U=H._readableState;(!U||U.autoDestroy&&U.endEmitted)&&H.destroy()}return g}function X(H,v,g){v.ending=!0,K(H,v),g&&(v.finished?Me.nextTick(g):H.once("finish",g)),v.ended=!0,H.writable=!1}function oe(H,v,g){var U=H.entry;for(H.entry=null;U;){var L=U.callback;v.pendingcb--,L(g),U=U.next}v.corkedRequestsFree.next=H}return Object.defineProperty(J.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(v){this._writableState&&(this._writableState.destroyed=v)}}),J.prototype.destroy=u.destroy,J.prototype._undestroy=u.undestroy,J.prototype._destroy=function(H,v){v(H)},Un}var Mn,wo;function nr(){if(wo)return Mn;wo=1;var r=Object.keys||function(m){var w=[];for(var b in m)w.push(b);return w};Mn=c;var e=Ns(),t=Rs();Kt(c,e);for(var s=r(t.prototype),l=0;l<s.length;l++){var i=s[l];c.prototype[i]||(c.prototype[i]=t.prototype[i])}function c(m){if(!(this instanceof c))return new c(m);e.call(this,m),t.call(this,m),this.allowHalfOpen=!0,m&&(m.readable===!1&&(this.readable=!1),m.writable===!1&&(this.writable=!1),m.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",n)))}Object.defineProperty(c.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(c.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(c.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function n(){this._writableState.ended||Me.nextTick(u,this)}function u(m){m.end()}return Object.defineProperty(c.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(w){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=w,this._writableState.destroyed=w)}}),Mn}var jn={},Or={exports:{}},yo;function ol(){return yo||(yo=1,function(r,e){var t=Jr(),s=t.Buffer;function l(c,n){for(var u in c)n[u]=c[u]}s.from&&s.alloc&&s.allocUnsafe&&s.allocUnsafeSlow?r.exports=t:(l(t,e),e.Buffer=i);function i(c,n,u){return s(c,n,u)}l(s,i),i.from=function(c,n,u){if(typeof c=="number")throw new TypeError("Argument must not be a number");return s(c,n,u)},i.alloc=function(c,n,u){if(typeof c!="number")throw new TypeError("Argument must be a number");var m=s(c);return n!==void 0?typeof u=="string"?m.fill(n,u):m.fill(n):m.fill(0),m},i.allocUnsafe=function(c){if(typeof c!="number")throw new TypeError("Argument must be a number");return s(c)},i.allocUnsafeSlow=function(c){if(typeof c!="number")throw new TypeError("Argument must be a number");return t.SlowBuffer(c)}}(Or,Or.exports)),Or.exports}var vo;function oi(){if(vo)return jn;vo=1;var r=ol().Buffer,e=r.isEncoding||function(f){switch(f=""+f,f&&f.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function t(f){if(!f)return"utf8";for(var x;;)switch(f){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return f;default:if(x)return;f=(""+f).toLowerCase(),x=!0}}function s(f){var x=t(f);if(typeof x!="string"&&(r.isEncoding===e||!e(f)))throw new Error("Unknown encoding: "+f);return x||f}jn.StringDecoder=l;function l(f){this.encoding=s(f);var x;switch(this.encoding){case"utf16le":this.text=b,this.end=T,x=4;break;case"utf8":this.fillLast=u,x=4;break;case"base64":this.text=p,this.end=S,x=3;break;default:this.write=y,this.end=_;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(x)}l.prototype.write=function(f){if(f.length===0)return"";var x,k;if(this.lastNeed){if(x=this.fillLast(f),x===void 0)return"";k=this.lastNeed,this.lastNeed=0}else k=0;return k<f.length?x?x+this.text(f,k):this.text(f,k):x||""},l.prototype.end=w,l.prototype.text=m,l.prototype.fillLast=function(f){if(this.lastNeed<=f.length)return f.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);f.copy(this.lastChar,this.lastTotal-this.lastNeed,0,f.length),this.lastNeed-=f.length};function i(f){return f<=127?0:f>>5===6?2:f>>4===14?3:f>>3===30?4:f>>6===2?-1:-2}function c(f,x,k){var C=x.length-1;if(C<k)return 0;var D=i(x[C]);return D>=0?(D>0&&(f.lastNeed=D-1),D):--C<k||D===-2?0:(D=i(x[C]),D>=0?(D>0&&(f.lastNeed=D-2),D):--C<k||D===-2?0:(D=i(x[C]),D>=0?(D>0&&(D===2?D=0:f.lastNeed=D-3),D):0))}function n(f,x,k){if((x[0]&192)!==128)return f.lastNeed=0,"�";if(f.lastNeed>1&&x.length>1){if((x[1]&192)!==128)return f.lastNeed=1,"�";if(f.lastNeed>2&&x.length>2&&(x[2]&192)!==128)return f.lastNeed=2,"�"}}function u(f){var x=this.lastTotal-this.lastNeed,k=n(this,f);if(k!==void 0)return k;if(this.lastNeed<=f.length)return f.copy(this.lastChar,x,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);f.copy(this.lastChar,x,0,f.length),this.lastNeed-=f.length}function m(f,x){var k=c(this,f,x);if(!this.lastNeed)return f.toString("utf8",x);this.lastTotal=k;var C=f.length-(k-this.lastNeed);return f.copy(this.lastChar,0,C),f.toString("utf8",x,C)}function w(f){var x=f&&f.length?this.write(f):"";return this.lastNeed?x+"�":x}function b(f,x){if((f.length-x)%2===0){var k=f.toString("utf16le",x);if(k){var C=k.charCodeAt(k.length-1);if(C>=55296&&C<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=f[f.length-2],this.lastChar[1]=f[f.length-1],k.slice(0,-1)}return k}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=f[f.length-1],f.toString("utf16le",x,f.length-1)}function T(f){var x=f&&f.length?this.write(f):"";if(this.lastNeed){var k=this.lastTotal-this.lastNeed;return x+this.lastChar.toString("utf16le",0,k)}return x}function p(f,x){var k=(f.length-x)%3;return k===0?f.toString("base64",x):(this.lastNeed=3-k,this.lastTotal=3,k===1?this.lastChar[0]=f[f.length-1]:(this.lastChar[0]=f[f.length-2],this.lastChar[1]=f[f.length-1]),f.toString("base64",x,f.length-k))}function S(f){var x=f&&f.length?this.write(f):"";return this.lastNeed?x+this.lastChar.toString("base64",0,3-this.lastNeed):x}function y(f){return f.toString(this.encoding)}function _(f){return f&&f.length?this.write(f):""}return jn}var zn,bo;function wi(){if(bo)return zn;bo=1;var r=mr().codes.ERR_STREAM_PREMATURE_CLOSE;function e(i){var c=!1;return function(){if(!c){c=!0;for(var n=arguments.length,u=new Array(n),m=0;m<n;m++)u[m]=arguments[m];i.apply(this,u)}}}function t(){}function s(i){return i.setHeader&&typeof i.abort=="function"}function l(i,c,n){if(typeof c=="function")return l(i,null,c);c||(c={}),n=e(n||t);var u=c.readable||c.readable!==!1&&i.readable,m=c.writable||c.writable!==!1&&i.writable,w=function(){i.writable||T()},b=i._writableState&&i._writableState.finished,T=function(){m=!1,b=!0,u||n.call(i)},p=i._readableState&&i._readableState.endEmitted,S=function(){u=!1,p=!0,m||n.call(i)},y=function(k){n.call(i,k)},_=function(){var k;if(u&&!p)return(!i._readableState||!i._readableState.ended)&&(k=new r),n.call(i,k);if(m&&!b)return(!i._writableState||!i._writableState.ended)&&(k=new r),n.call(i,k)},f=function(){i.req.on("finish",T)};return s(i)?(i.on("complete",T),i.on("abort",_),i.req?f():i.on("request",f)):m&&!i._writableState&&(i.on("end",w),i.on("close",w)),i.on("end",S),i.on("finish",T),c.error!==!1&&i.on("error",y),i.on("close",_),function(){i.removeListener("complete",T),i.removeListener("abort",_),i.removeListener("request",f),i.req&&i.req.removeListener("finish",T),i.removeListener("end",w),i.removeListener("close",w),i.removeListener("finish",T),i.removeListener("end",S),i.removeListener("error",y),i.removeListener("close",_)}}return zn=l,zn}var Hn,_o;function sl(){if(_o)return Hn;_o=1;var r;function e(f,x,k){return x in f?Object.defineProperty(f,x,{value:k,enumerable:!0,configurable:!0,writable:!0}):f[x]=k,f}var t=wi(),s=Symbol("lastResolve"),l=Symbol("lastReject"),i=Symbol("error"),c=Symbol("ended"),n=Symbol("lastPromise"),u=Symbol("handlePromise"),m=Symbol("stream");function w(f,x){return{value:f,done:x}}function b(f){var x=f[s];if(x!==null){var k=f[m].read();k!==null&&(f[n]=null,f[s]=null,f[l]=null,x(w(k,!1)))}}function T(f){Me.nextTick(b,f)}function p(f,x){return function(k,C){f.then(function(){if(x[c]){k(w(void 0,!0));return}x[u](k,C)},C)}}var S=Object.getPrototypeOf(function(){}),y=Object.setPrototypeOf((r={get stream(){return this[m]},next:function(){var x=this,k=this[i];if(k!==null)return Promise.reject(k);if(this[c])return Promise.resolve(w(void 0,!0));if(this[m].destroyed)return new Promise(function(M,J){Me.nextTick(function(){x[i]?J(x[i]):M(w(void 0,!0))})});var C=this[n],D;if(C)D=new Promise(p(C,this));else{var q=this[m].read();if(q!==null)return Promise.resolve(w(q,!1));D=new Promise(this[u])}return this[n]=D,D}},e(r,Symbol.asyncIterator,function(){return this}),e(r,"return",function(){var x=this;return new Promise(function(k,C){x[m].destroy(null,function(D){if(D){C(D);return}k(w(void 0,!0))})})}),r),S),_=function(x){var k,C=Object.create(y,(k={},e(k,m,{value:x,writable:!0}),e(k,s,{value:null,writable:!0}),e(k,l,{value:null,writable:!0}),e(k,i,{value:null,writable:!0}),e(k,c,{value:x._readableState.endEmitted,writable:!0}),e(k,u,{value:function(q,M){var J=C[m].read();J?(C[n]=null,C[s]=null,C[l]=null,q(w(J,!1))):(C[s]=q,C[l]=M)},writable:!0}),k));return C[n]=null,t(x,function(D){if(D&&D.code!=="ERR_STREAM_PREMATURE_CLOSE"){var q=C[l];q!==null&&(C[n]=null,C[s]=null,C[l]=null,q(D)),C[i]=D;return}var M=C[s];M!==null&&(C[n]=null,C[s]=null,C[l]=null,M(w(void 0,!0))),C[c]=!0}),x.on("readable",T.bind(null,C)),C};return Hn=_,Hn}var Wn,Eo;function al(){return Eo||(Eo=1,Wn=function(){throw new Error("Readable.from is not available in the browser")}),Wn}var Gn,xo;function Ns(){if(xo)return Gn;xo=1,Gn=I;var r;I.ReadableState=J,di.EventEmitter;var e=function(O,ae){return O.listeners(ae).length},t=_s(),s=Jr().Buffer,l=Rt.Uint8Array||function(){};function i(N){return s.from(N)}function c(N){return s.isBuffer(N)||N instanceof l}var n=ks(),u;n&&n.debuglog?u=n.debuglog("stream"):u=function(){};var m=nl(),w=Cs(),b=Is(),T=b.getHighWaterMark,p=mr().codes,S=p.ERR_INVALID_ARG_TYPE,y=p.ERR_STREAM_PUSH_AFTER_EOF,_=p.ERR_METHOD_NOT_IMPLEMENTED,f=p.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,x,k,C;Kt(I,t);var D=w.errorOrDestroy,q=["error","close","destroy","pause","resume"];function M(N,O,ae){if(typeof N.prependListener=="function")return N.prependListener(O,ae);!N._events||!N._events[O]?N.on(O,ae):Array.isArray(N._events[O])?N._events[O].unshift(ae):N._events[O]=[ae,N._events[O]]}function J(N,O,ae){r=r||nr(),N=N||{},typeof ae!="boolean"&&(ae=O instanceof r),this.objectMode=!!N.objectMode,ae&&(this.objectMode=this.objectMode||!!N.readableObjectMode),this.highWaterMark=T(this,N,"readableHighWaterMark",ae),this.buffer=new m,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=N.emitClose!==!1,this.autoDestroy=!!N.autoDestroy,this.destroyed=!1,this.defaultEncoding=N.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,N.encoding&&(x||(x=oi().StringDecoder),this.decoder=new x(N.encoding),this.encoding=N.encoding)}function I(N){if(r=r||nr(),!(this instanceof I))return new I(N);var O=this instanceof r;this._readableState=new J(N,this,O),this.readable=!0,N&&(typeof N.read=="function"&&(this._read=N.read),typeof N.destroy=="function"&&(this._destroy=N.destroy)),t.call(this)}Object.defineProperty(I.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(O){this._readableState&&(this._readableState.destroyed=O)}}),I.prototype.destroy=w.destroy,I.prototype._undestroy=w.undestroy,I.prototype._destroy=function(N,O){O(N)},I.prototype.push=function(N,O){var ae=this._readableState,h;return ae.objectMode?h=!0:typeof N=="string"&&(O=O||ae.defaultEncoding,O!==ae.encoding&&(N=s.from(N,O),O=""),h=!0),ue(this,N,O,!1,h)},I.prototype.unshift=function(N){return ue(this,N,null,!0,!1)};function ue(N,O,ae,h,Q){u("readableAddChunk",O);var E=N._readableState;if(O===null)E.reading=!1,se(N,E);else{var o;if(Q||(o=B(E,O)),o)D(N,o);else if(E.objectMode||O&&O.length>0)if(typeof O!="string"&&!E.objectMode&&Object.getPrototypeOf(O)!==s.prototype&&(O=i(O)),h)E.endEmitted?D(N,new f):ee(N,E,O,!0);else if(E.ended)D(N,new y);else{if(E.destroyed)return!1;E.reading=!1,E.decoder&&!ae?(O=E.decoder.write(O),E.objectMode||O.length!==0?ee(N,E,O,!1):Z(N,E)):ee(N,E,O,!1)}else h||(E.reading=!1,Z(N,E))}return!E.ended&&(E.length<E.highWaterMark||E.length===0)}function ee(N,O,ae,h){O.flowing&&O.length===0&&!O.sync?(O.awaitDrain=0,N.emit("data",ae)):(O.length+=O.objectMode?1:ae.length,h?O.buffer.unshift(ae):O.buffer.push(ae),O.needReadable&&V(N)),Z(N,O)}function B(N,O){var ae;return!c(O)&&typeof O!="string"&&O!==void 0&&!N.objectMode&&(ae=new S("chunk",["string","Buffer","Uint8Array"],O)),ae}I.prototype.isPaused=function(){return this._readableState.flowing===!1},I.prototype.setEncoding=function(N){x||(x=oi().StringDecoder);var O=new x(N);this._readableState.decoder=O,this._readableState.encoding=this._readableState.decoder.encoding;for(var ae=this._readableState.buffer.head,h="";ae!==null;)h+=O.write(ae.data),ae=ae.next;return this._readableState.buffer.clear(),h!==""&&this._readableState.buffer.push(h),this._readableState.length=h.length,this};var W=1073741824;function A(N){return N>=W?N=W:(N--,N|=N>>>1,N|=N>>>2,N|=N>>>4,N|=N>>>8,N|=N>>>16,N++),N}function z(N,O){return N<=0||O.length===0&&O.ended?0:O.objectMode?1:N!==N?O.flowing&&O.length?O.buffer.head.data.length:O.length:(N>O.highWaterMark&&(O.highWaterMark=A(N)),N<=O.length?N:O.ended?O.length:(O.needReadable=!0,0))}I.prototype.read=function(N){u("read",N),N=parseInt(N,10);var O=this._readableState,ae=N;if(N!==0&&(O.emittedReadable=!1),N===0&&O.needReadable&&((O.highWaterMark!==0?O.length>=O.highWaterMark:O.length>0)||O.ended))return u("read: emitReadable",O.length,O.ended),O.length===0&&O.ended?g(this):V(this),null;if(N=z(N,O),N===0&&O.ended)return O.length===0&&g(this),null;var h=O.needReadable;u("need readable",h),(O.length===0||O.length-N<O.highWaterMark)&&(h=!0,u("length less than watermark",h)),O.ended||O.reading?(h=!1,u("reading or ended",h)):h&&(u("do read"),O.reading=!0,O.sync=!0,O.length===0&&(O.needReadable=!0),this._read(O.highWaterMark),O.sync=!1,O.reading||(N=z(ae,O)));var Q;return N>0?Q=v(N,O):Q=null,Q===null?(O.needReadable=O.length<=O.highWaterMark,N=0):(O.length-=N,O.awaitDrain=0),O.length===0&&(O.ended||(O.needReadable=!0),ae!==N&&O.ended&&g(this)),Q!==null&&this.emit("data",Q),Q};function se(N,O){if(u("onEofChunk"),!O.ended){if(O.decoder){var ae=O.decoder.end();ae&&ae.length&&(O.buffer.push(ae),O.length+=O.objectMode?1:ae.length)}O.ended=!0,O.sync?V(N):(O.needReadable=!1,O.emittedReadable||(O.emittedReadable=!0,ye(N)))}}function V(N){var O=N._readableState;u("emitReadable",O.needReadable,O.emittedReadable),O.needReadable=!1,O.emittedReadable||(u("emitReadable",O.flowing),O.emittedReadable=!0,Me.nextTick(ye,N))}function ye(N){var O=N._readableState;u("emitReadable_",O.destroyed,O.length,O.ended),!O.destroyed&&(O.length||O.ended)&&(N.emit("readable"),O.emittedReadable=!1),O.needReadable=!O.flowing&&!O.ended&&O.length<=O.highWaterMark,H(N)}function Z(N,O){O.readingMore||(O.readingMore=!0,Me.nextTick(re,N,O))}function re(N,O){for(;!O.reading&&!O.ended&&(O.length<O.highWaterMark||O.flowing&&O.length===0);){var ae=O.length;if(u("maybeReadMore read 0"),N.read(0),ae===O.length)break}O.readingMore=!1}I.prototype._read=function(N){D(this,new _("_read()"))},I.prototype.pipe=function(N,O){var ae=this,h=this._readableState;switch(h.pipesCount){case 0:h.pipes=N;break;case 1:h.pipes=[h.pipes,N];break;default:h.pipes.push(N);break}h.pipesCount+=1,u("pipe count=%d opts=%j",h.pipesCount,O);var Q=(!O||O.end!==!1)&&N!==Me.stdout&&N!==Me.stderr,E=Q?a:xe;h.endEmitted?Me.nextTick(E):ae.once("end",E),N.on("unpipe",o);function o(ke,Ne){u("onunpipe"),ke===ae&&Ne&&Ne.hasUnpiped===!1&&(Ne.hasUnpiped=!0,$())}function a(){u("onend"),N.end()}var d=j(ae);N.on("drain",d);var F=!1;function $(){u("cleanup"),N.removeListener("close",we),N.removeListener("finish",he),N.removeListener("drain",d),N.removeListener("error",fe),N.removeListener("unpipe",o),ae.removeListener("end",a),ae.removeListener("end",xe),ae.removeListener("data",P),F=!0,h.awaitDrain&&(!N._writableState||N._writableState.needDrain)&&d()}ae.on("data",P);function P(ke){u("ondata");var Ne=N.write(ke);u("dest.write",Ne),Ne===!1&&((h.pipesCount===1&&h.pipes===N||h.pipesCount>1&&L(h.pipes,N)!==-1)&&!F&&(u("false write response, pause",h.awaitDrain),h.awaitDrain++),ae.pause())}function fe(ke){u("onerror",ke),xe(),N.removeListener("error",fe),e(N,"error")===0&&D(N,ke)}M(N,"error",fe);function we(){N.removeListener("finish",he),xe()}N.once("close",we);function he(){u("onfinish"),N.removeListener("close",we),xe()}N.once("finish",he);function xe(){u("unpipe"),ae.unpipe(N)}return N.emit("pipe",ae),h.flowing||(u("pipe resume"),ae.resume()),N};function j(N){return function(){var ae=N._readableState;u("pipeOnDrain",ae.awaitDrain),ae.awaitDrain&&ae.awaitDrain--,ae.awaitDrain===0&&e(N,"data")&&(ae.flowing=!0,H(N))}}I.prototype.unpipe=function(N){var O=this._readableState,ae={hasUnpiped:!1};if(O.pipesCount===0)return this;if(O.pipesCount===1)return N&&N!==O.pipes?this:(N||(N=O.pipes),O.pipes=null,O.pipesCount=0,O.flowing=!1,N&&N.emit("unpipe",this,ae),this);if(!N){var h=O.pipes,Q=O.pipesCount;O.pipes=null,O.pipesCount=0,O.flowing=!1;for(var E=0;E<Q;E++)h[E].emit("unpipe",this,{hasUnpiped:!1});return this}var o=L(O.pipes,N);return o===-1?this:(O.pipes.splice(o,1),O.pipesCount-=1,O.pipesCount===1&&(O.pipes=O.pipes[0]),N.emit("unpipe",this,ae),this)},I.prototype.on=function(N,O){var ae=t.prototype.on.call(this,N,O),h=this._readableState;return N==="data"?(h.readableListening=this.listenerCount("readable")>0,h.flowing!==!1&&this.resume()):N==="readable"&&!h.endEmitted&&!h.readableListening&&(h.readableListening=h.needReadable=!0,h.flowing=!1,h.emittedReadable=!1,u("on readable",h.length,h.reading),h.length?V(this):h.reading||Me.nextTick(K,this)),ae},I.prototype.addListener=I.prototype.on,I.prototype.removeListener=function(N,O){var ae=t.prototype.removeListener.call(this,N,O);return N==="readable"&&Me.nextTick(R,this),ae},I.prototype.removeAllListeners=function(N){var O=t.prototype.removeAllListeners.apply(this,arguments);return(N==="readable"||N===void 0)&&Me.nextTick(R,this),O};function R(N){var O=N._readableState;O.readableListening=N.listenerCount("readable")>0,O.resumeScheduled&&!O.paused?O.flowing=!0:N.listenerCount("data")>0&&N.resume()}function K(N){u("readable nexttick read 0"),N.read(0)}I.prototype.resume=function(){var N=this._readableState;return N.flowing||(u("resume"),N.flowing=!N.readableListening,X(this,N)),N.paused=!1,this};function X(N,O){O.resumeScheduled||(O.resumeScheduled=!0,Me.nextTick(oe,N,O))}function oe(N,O){u("resume",O.reading),O.reading||N.read(0),O.resumeScheduled=!1,N.emit("resume"),H(N),O.flowing&&!O.reading&&N.read(0)}I.prototype.pause=function(){return u("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(u("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function H(N){var O=N._readableState;for(u("flow",O.flowing);O.flowing&&N.read()!==null;);}I.prototype.wrap=function(N){var O=this,ae=this._readableState,h=!1;N.on("end",function(){if(u("wrapped end"),ae.decoder&&!ae.ended){var o=ae.decoder.end();o&&o.length&&O.push(o)}O.push(null)}),N.on("data",function(o){if(u("wrapped data"),ae.decoder&&(o=ae.decoder.write(o)),!(ae.objectMode&&o==null)&&!(!ae.objectMode&&(!o||!o.length))){var a=O.push(o);a||(h=!0,N.pause())}});for(var Q in N)this[Q]===void 0&&typeof N[Q]=="function"&&(this[Q]=function(a){return function(){return N[a].apply(N,arguments)}}(Q));for(var E=0;E<q.length;E++)N.on(q[E],this.emit.bind(this,q[E]));return this._read=function(o){u("wrapped _read",o),h&&(h=!1,N.resume())},this},typeof Symbol=="function"&&(I.prototype[Symbol.asyncIterator]=function(){return k===void 0&&(k=sl()),k(this)}),Object.defineProperty(I.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(I.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(I.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(O){this._readableState&&(this._readableState.flowing=O)}}),I._fromList=v,Object.defineProperty(I.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function v(N,O){if(O.length===0)return null;var ae;return O.objectMode?ae=O.buffer.shift():!N||N>=O.length?(O.decoder?ae=O.buffer.join(""):O.buffer.length===1?ae=O.buffer.first():ae=O.buffer.concat(O.length),O.buffer.clear()):ae=O.buffer.consume(N,O.decoder),ae}function g(N){var O=N._readableState;u("endReadable",O.endEmitted),O.endEmitted||(O.ended=!0,Me.nextTick(U,O,N))}function U(N,O){if(u("endReadableNT",N.endEmitted,N.length),!N.endEmitted&&N.length===0&&(N.endEmitted=!0,O.readable=!1,O.emit("end"),N.autoDestroy)){var ae=O._writableState;(!ae||ae.autoDestroy&&ae.finished)&&O.destroy()}}typeof Symbol=="function"&&(I.from=function(N,O){return C===void 0&&(C=al()),C(I,N,O)});function L(N,O){for(var ae=0,h=N.length;ae<h;ae++)if(N[ae]===O)return ae;return-1}return Gn}var $n,To;function Ds(){if(To)return $n;To=1,$n=n;var r=mr().codes,e=r.ERR_METHOD_NOT_IMPLEMENTED,t=r.ERR_MULTIPLE_CALLBACK,s=r.ERR_TRANSFORM_ALREADY_TRANSFORMING,l=r.ERR_TRANSFORM_WITH_LENGTH_0,i=nr();Kt(n,i);function c(w,b){var T=this._transformState;T.transforming=!1;var p=T.writecb;if(p===null)return this.emit("error",new t);T.writechunk=null,T.writecb=null,b!=null&&this.push(b),p(w);var S=this._readableState;S.reading=!1,(S.needReadable||S.length<S.highWaterMark)&&this._read(S.highWaterMark)}function n(w){if(!(this instanceof n))return new n(w);i.call(this,w),this._transformState={afterTransform:c.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,w&&(typeof w.transform=="function"&&(this._transform=w.transform),typeof w.flush=="function"&&(this._flush=w.flush)),this.on("prefinish",u)}function u(){var w=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(b,T){m(w,b,T)}):m(this,null,null)}n.prototype.push=function(w,b){return this._transformState.needTransform=!1,i.prototype.push.call(this,w,b)},n.prototype._transform=function(w,b,T){T(new e("_transform()"))},n.prototype._write=function(w,b,T){var p=this._transformState;if(p.writecb=T,p.writechunk=w,p.writeencoding=b,!p.transforming){var S=this._readableState;(p.needTransform||S.needReadable||S.length<S.highWaterMark)&&this._read(S.highWaterMark)}},n.prototype._read=function(w){var b=this._transformState;b.writechunk!==null&&!b.transforming?(b.transforming=!0,this._transform(b.writechunk,b.writeencoding,b.afterTransform)):b.needTransform=!0},n.prototype._destroy=function(w,b){i.prototype._destroy.call(this,w,function(T){b(T)})};function m(w,b,T){if(b)return w.emit("error",b);if(T!=null&&w.push(T),w._writableState.length)throw new l;if(w._transformState.transforming)throw new s;return w.push(null)}return $n}var Vn,Ao;function ll(){if(Ao)return Vn;Ao=1,Vn=e;var r=Ds();Kt(e,r);function e(t){if(!(this instanceof e))return new e(t);r.call(this,t)}return e.prototype._transform=function(t,s,l){l(null,t)},Vn}var Kn,So;function cl(){if(So)return Kn;So=1;var r;function e(T){var p=!1;return function(){p||(p=!0,T.apply(void 0,arguments))}}var t=mr().codes,s=t.ERR_MISSING_ARGS,l=t.ERR_STREAM_DESTROYED;function i(T){if(T)throw T}function c(T){return T.setHeader&&typeof T.abort=="function"}function n(T,p,S,y){y=e(y);var _=!1;T.on("close",function(){_=!0}),r===void 0&&(r=wi()),r(T,{readable:p,writable:S},function(x){if(x)return y(x);_=!0,y()});var f=!1;return function(x){if(!_&&!f){if(f=!0,c(T))return T.abort();if(typeof T.destroy=="function")return T.destroy();y(x||new l("pipe"))}}}function u(T){T()}function m(T,p){return T.pipe(p)}function w(T){return!T.length||typeof T[T.length-1]!="function"?i:T.pop()}function b(){for(var T=arguments.length,p=new Array(T),S=0;S<T;S++)p[S]=arguments[S];var y=w(p);if(Array.isArray(p[0])&&(p=p[0]),p.length<2)throw new s("streams");var _,f=p.map(function(x,k){var C=k<p.length-1,D=k>0;return n(x,C,D,function(q){_||(_=q),q&&f.forEach(u),!C&&(f.forEach(u),y(_))})});return p.reduce(m)}return Kn=b,Kn}var yi=vt,vi=di.EventEmitter,ul=Kt;ul(vt,vi);vt.Readable=Ns();vt.Writable=Rs();vt.Duplex=nr();vt.Transform=Ds();vt.PassThrough=ll();vt.finished=wi();vt.pipeline=cl();vt.Stream=vt;function vt(){vi.call(this)}vt.prototype.pipe=function(r,e){var t=this;function s(w){r.writable&&r.write(w)===!1&&t.pause&&t.pause()}t.on("data",s);function l(){t.readable&&t.resume&&t.resume()}r.on("drain",l),!r._isStdio&&(!e||e.end!==!1)&&(t.on("end",c),t.on("close",n));var i=!1;function c(){i||(i=!0,r.end())}function n(){i||(i=!0,typeof r.destroy=="function"&&r.destroy())}function u(w){if(m(),vi.listenerCount(this,"error")===0)throw w}t.on("error",u),r.on("error",u);function m(){t.removeListener("data",s),r.removeListener("drain",l),t.removeListener("end",c),t.removeListener("close",n),t.removeListener("error",u),r.removeListener("error",u),t.removeListener("end",m),t.removeListener("close",m),r.removeListener("close",m)}return t.on("end",m),t.on("close",m),r.on("close",m),r.emit("pipe",t),r};(function(r){(function(e){e.parser=function(v,g){return new s(v,g)},e.SAXParser=s,e.SAXStream=w,e.createStream=m,e.MAX_BUFFER_LENGTH=64*1024;var t=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];e.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function s(v,g){if(!(this instanceof s))return new s(v,g);var U=this;i(U),U.q=U.c="",U.bufferCheckPosition=e.MAX_BUFFER_LENGTH,U.opt=g||{},U.opt.lowercase=U.opt.lowercase||U.opt.lowercasetags,U.looseCase=U.opt.lowercase?"toLowerCase":"toUpperCase",U.tags=[],U.closed=U.closedRoot=U.sawRoot=!1,U.tag=U.error=null,U.strict=!!v,U.noscript=!!(v||U.opt.noscript),U.state=I.BEGIN,U.strictEntities=U.opt.strictEntities,U.ENTITIES=U.strictEntities?Object.create(e.XML_ENTITIES):Object.create(e.ENTITIES),U.attribList=[],U.opt.xmlns&&(U.ns=Object.create(y)),U.trackPosition=U.opt.position!==!1,U.trackPosition&&(U.position=U.line=U.column=0),ee(U,"onready")}Object.create||(Object.create=function(v){function g(){}g.prototype=v;var U=new g;return U}),Object.keys||(Object.keys=function(v){var g=[];for(var U in v)v.hasOwnProperty(U)&&g.push(U);return g});function l(v){for(var g=Math.max(e.MAX_BUFFER_LENGTH,10),U=0,L=0,N=t.length;L<N;L++){var O=v[t[L]].length;if(O>g)switch(t[L]){case"textNode":W(v);break;case"cdata":B(v,"oncdata",v.cdata),v.cdata="";break;case"script":B(v,"onscript",v.script),v.script="";break;default:z(v,"Max buffer length exceeded: "+t[L])}U=Math.max(U,O)}var ae=e.MAX_BUFFER_LENGTH-U;v.bufferCheckPosition=ae+v.position}function i(v){for(var g=0,U=t.length;g<U;g++)v[t[g]]=""}function c(v){W(v),v.cdata!==""&&(B(v,"oncdata",v.cdata),v.cdata=""),v.script!==""&&(B(v,"onscript",v.script),v.script="")}s.prototype={end:function(){se(this)},write:H,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){c(this)}};var n;try{n=yi.Stream}catch{n=function(){}}var u=e.EVENTS.filter(function(v){return v!=="error"&&v!=="end"});function m(v,g){return new w(v,g)}function w(v,g){if(!(this instanceof w))return new w(v,g);n.apply(this),this._parser=new s(v,g),this.writable=!0,this.readable=!0;var U=this;this._parser.onend=function(){U.emit("end")},this._parser.onerror=function(L){U.emit("error",L),U._parser.error=null},this._decoder=null,u.forEach(function(L){Object.defineProperty(U,"on"+L,{get:function(){return U._parser["on"+L]},set:function(N){if(!N)return U.removeAllListeners(L),U._parser["on"+L]=N,N;U.on(L,N)},enumerable:!0,configurable:!1})})}w.prototype=Object.create(n.prototype,{constructor:{value:w}}),w.prototype.write=function(v){if(typeof Buffer=="function"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(v)){if(!this._decoder){var g=oi().StringDecoder;this._decoder=new g("utf8")}v=this._decoder.write(v)}return this._parser.write(v.toString()),this.emit("data",v),!0},w.prototype.end=function(v){return v&&v.length&&this.write(v),this._parser.end(),!0},w.prototype.on=function(v,g){var U=this;return!U._parser["on"+v]&&u.indexOf(v)!==-1&&(U._parser["on"+v]=function(){var L=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);L.splice(0,0,v),U.emit.apply(U,L)}),n.prototype.on.call(U,v,g)};var b="[CDATA[",T="DOCTYPE",p="http://www.w3.org/XML/1998/namespace",S="http://www.w3.org/2000/xmlns/",y={xml:p,xmlns:S},_=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,f=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,x=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,k=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function C(v){return v===" "||v===`
`||v==="\r"||v==="	"}function D(v){return v==='"'||v==="'"}function q(v){return v===">"||C(v)}function M(v,g){return v.test(g)}function J(v,g){return!M(v,g)}var I=0;e.STATE={BEGIN:I++,BEGIN_WHITESPACE:I++,TEXT:I++,TEXT_ENTITY:I++,OPEN_WAKA:I++,SGML_DECL:I++,SGML_DECL_QUOTED:I++,DOCTYPE:I++,DOCTYPE_QUOTED:I++,DOCTYPE_DTD:I++,DOCTYPE_DTD_QUOTED:I++,COMMENT_STARTING:I++,COMMENT:I++,COMMENT_ENDING:I++,COMMENT_ENDED:I++,CDATA:I++,CDATA_ENDING:I++,CDATA_ENDING_2:I++,PROC_INST:I++,PROC_INST_BODY:I++,PROC_INST_ENDING:I++,OPEN_TAG:I++,OPEN_TAG_SLASH:I++,ATTRIB:I++,ATTRIB_NAME:I++,ATTRIB_NAME_SAW_WHITE:I++,ATTRIB_VALUE:I++,ATTRIB_VALUE_QUOTED:I++,ATTRIB_VALUE_CLOSED:I++,ATTRIB_VALUE_UNQUOTED:I++,ATTRIB_VALUE_ENTITY_Q:I++,ATTRIB_VALUE_ENTITY_U:I++,CLOSE_TAG:I++,CLOSE_TAG_SAW_WHITE:I++,SCRIPT:I++,SCRIPT_ENDING:I++},e.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},e.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(e.ENTITIES).forEach(function(v){var g=e.ENTITIES[v],U=typeof g=="number"?String.fromCharCode(g):g;e.ENTITIES[v]=U});for(var ue in e.STATE)e.STATE[e.STATE[ue]]=ue;I=e.STATE;function ee(v,g,U){v[g]&&v[g](U)}function B(v,g,U){v.textNode&&W(v),ee(v,g,U)}function W(v){v.textNode=A(v.opt,v.textNode),v.textNode&&ee(v,"ontext",v.textNode),v.textNode=""}function A(v,g){return v.trim&&(g=g.trim()),v.normalize&&(g=g.replace(/\s+/g," ")),g}function z(v,g){return W(v),v.trackPosition&&(g+=`
Line: `+v.line+`
Column: `+v.column+`
Char: `+v.c),g=new Error(g),v.error=g,ee(v,"onerror",g),v}function se(v){return v.sawRoot&&!v.closedRoot&&V(v,"Unclosed root tag"),v.state!==I.BEGIN&&v.state!==I.BEGIN_WHITESPACE&&v.state!==I.TEXT&&z(v,"Unexpected end"),W(v),v.c="",v.closed=!0,ee(v,"onend"),s.call(v,v.strict,v.opt),v}function V(v,g){if(typeof v!="object"||!(v instanceof s))throw new Error("bad call to strictFail");v.strict&&z(v,g)}function ye(v){v.strict||(v.tagName=v.tagName[v.looseCase]());var g=v.tags[v.tags.length-1]||v,U=v.tag={name:v.tagName,attributes:{}};v.opt.xmlns&&(U.ns=g.ns),v.attribList.length=0,B(v,"onopentagstart",U)}function Z(v,g){var U=v.indexOf(":"),L=U<0?["",v]:v.split(":"),N=L[0],O=L[1];return g&&v==="xmlns"&&(N="xmlns",O=""),{prefix:N,local:O}}function re(v){if(v.strict||(v.attribName=v.attribName[v.looseCase]()),v.attribList.indexOf(v.attribName)!==-1||v.tag.attributes.hasOwnProperty(v.attribName)){v.attribName=v.attribValue="";return}if(v.opt.xmlns){var g=Z(v.attribName,!0),U=g.prefix,L=g.local;if(U==="xmlns")if(L==="xml"&&v.attribValue!==p)V(v,"xml: prefix must be bound to "+p+`
Actual: `+v.attribValue);else if(L==="xmlns"&&v.attribValue!==S)V(v,"xmlns: prefix must be bound to "+S+`
Actual: `+v.attribValue);else{var N=v.tag,O=v.tags[v.tags.length-1]||v;N.ns===O.ns&&(N.ns=Object.create(O.ns)),N.ns[L]=v.attribValue}v.attribList.push([v.attribName,v.attribValue])}else v.tag.attributes[v.attribName]=v.attribValue,B(v,"onattribute",{name:v.attribName,value:v.attribValue});v.attribName=v.attribValue=""}function j(v,g){if(v.opt.xmlns){var U=v.tag,L=Z(v.tagName);U.prefix=L.prefix,U.local=L.local,U.uri=U.ns[L.prefix]||"",U.prefix&&!U.uri&&(V(v,"Unbound namespace prefix: "+JSON.stringify(v.tagName)),U.uri=L.prefix);var N=v.tags[v.tags.length-1]||v;U.ns&&N.ns!==U.ns&&Object.keys(U.ns).forEach(function(P){B(v,"onopennamespace",{prefix:P,uri:U.ns[P]})});for(var O=0,ae=v.attribList.length;O<ae;O++){var h=v.attribList[O],Q=h[0],E=h[1],o=Z(Q,!0),a=o.prefix,d=o.local,F=a===""?"":U.ns[a]||"",$={name:Q,value:E,prefix:a,local:d,uri:F};a&&a!=="xmlns"&&!F&&(V(v,"Unbound namespace prefix: "+JSON.stringify(a)),$.uri=a),v.tag.attributes[Q]=$,B(v,"onattribute",$)}v.attribList.length=0}v.tag.isSelfClosing=!!g,v.sawRoot=!0,v.tags.push(v.tag),B(v,"onopentag",v.tag),g||(!v.noscript&&v.tagName.toLowerCase()==="script"?v.state=I.SCRIPT:v.state=I.TEXT,v.tag=null,v.tagName=""),v.attribName=v.attribValue="",v.attribList.length=0}function R(v){if(!v.tagName){V(v,"Weird empty close tag."),v.textNode+="</>",v.state=I.TEXT;return}if(v.script){if(v.tagName!=="script"){v.script+="</"+v.tagName+">",v.tagName="",v.state=I.SCRIPT;return}B(v,"onscript",v.script),v.script=""}var g=v.tags.length,U=v.tagName;v.strict||(U=U[v.looseCase]());for(var L=U;g--;){var N=v.tags[g];if(N.name!==L)V(v,"Unexpected close tag");else break}if(g<0){V(v,"Unmatched closing tag: "+v.tagName),v.textNode+="</"+v.tagName+">",v.state=I.TEXT;return}v.tagName=U;for(var O=v.tags.length;O-- >g;){var ae=v.tag=v.tags.pop();v.tagName=v.tag.name,B(v,"onclosetag",v.tagName);var h={};for(var Q in ae.ns)h[Q]=ae.ns[Q];var E=v.tags[v.tags.length-1]||v;v.opt.xmlns&&ae.ns!==E.ns&&Object.keys(ae.ns).forEach(function(o){var a=ae.ns[o];B(v,"onclosenamespace",{prefix:o,uri:a})})}g===0&&(v.closedRoot=!0),v.tagName=v.attribValue=v.attribName="",v.attribList.length=0,v.state=I.TEXT}function K(v){var g=v.entity,U=g.toLowerCase(),L,N="";return v.ENTITIES[g]?v.ENTITIES[g]:v.ENTITIES[U]?v.ENTITIES[U]:(g=U,g.charAt(0)==="#"&&(g.charAt(1)==="x"?(g=g.slice(2),L=parseInt(g,16),N=L.toString(16)):(g=g.slice(1),L=parseInt(g,10),N=L.toString(10))),g=g.replace(/^0+/,""),isNaN(L)||N.toLowerCase()!==g?(V(v,"Invalid character entity"),"&"+v.entity+";"):String.fromCodePoint(L))}function X(v,g){g==="<"?(v.state=I.OPEN_WAKA,v.startTagPosition=v.position):C(g)||(V(v,"Non-whitespace before first tag."),v.textNode=g,v.state=I.TEXT)}function oe(v,g){var U="";return g<v.length&&(U=v.charAt(g)),U}function H(v){var g=this;if(this.error)throw this.error;if(g.closed)return z(g,"Cannot write after close. Assign an onready handler.");if(v===null)return se(g);typeof v=="object"&&(v=v.toString());for(var U=0,L="";L=oe(v,U++),g.c=L,!!L;)switch(g.trackPosition&&(g.position++,L===`
`?(g.line++,g.column=0):g.column++),g.state){case I.BEGIN:if(g.state=I.BEGIN_WHITESPACE,L==="\uFEFF")continue;X(g,L);continue;case I.BEGIN_WHITESPACE:X(g,L);continue;case I.TEXT:if(g.sawRoot&&!g.closedRoot){for(var N=U-1;L&&L!=="<"&&L!=="&";)L=oe(v,U++),L&&g.trackPosition&&(g.position++,L===`
`?(g.line++,g.column=0):g.column++);g.textNode+=v.substring(N,U-1)}L==="<"&&!(g.sawRoot&&g.closedRoot&&!g.strict)?(g.state=I.OPEN_WAKA,g.startTagPosition=g.position):(!C(L)&&(!g.sawRoot||g.closedRoot)&&V(g,"Text data outside of root node."),L==="&"?g.state=I.TEXT_ENTITY:g.textNode+=L);continue;case I.SCRIPT:L==="<"?g.state=I.SCRIPT_ENDING:g.script+=L;continue;case I.SCRIPT_ENDING:L==="/"?g.state=I.CLOSE_TAG:(g.script+="<"+L,g.state=I.SCRIPT);continue;case I.OPEN_WAKA:if(L==="!")g.state=I.SGML_DECL,g.sgmlDecl="";else if(!C(L))if(M(_,L))g.state=I.OPEN_TAG,g.tagName=L;else if(L==="/")g.state=I.CLOSE_TAG,g.tagName="";else if(L==="?")g.state=I.PROC_INST,g.procInstName=g.procInstBody="";else{if(V(g,"Unencoded <"),g.startTagPosition+1<g.position){var O=g.position-g.startTagPosition;L=new Array(O).join(" ")+L}g.textNode+="<"+L,g.state=I.TEXT}continue;case I.SGML_DECL:(g.sgmlDecl+L).toUpperCase()===b?(B(g,"onopencdata"),g.state=I.CDATA,g.sgmlDecl="",g.cdata=""):g.sgmlDecl+L==="--"?(g.state=I.COMMENT,g.comment="",g.sgmlDecl=""):(g.sgmlDecl+L).toUpperCase()===T?(g.state=I.DOCTYPE,(g.doctype||g.sawRoot)&&V(g,"Inappropriately located doctype declaration"),g.doctype="",g.sgmlDecl=""):L===">"?(B(g,"onsgmldeclaration",g.sgmlDecl),g.sgmlDecl="",g.state=I.TEXT):(D(L)&&(g.state=I.SGML_DECL_QUOTED),g.sgmlDecl+=L);continue;case I.SGML_DECL_QUOTED:L===g.q&&(g.state=I.SGML_DECL,g.q=""),g.sgmlDecl+=L;continue;case I.DOCTYPE:L===">"?(g.state=I.TEXT,B(g,"ondoctype",g.doctype),g.doctype=!0):(g.doctype+=L,L==="["?g.state=I.DOCTYPE_DTD:D(L)&&(g.state=I.DOCTYPE_QUOTED,g.q=L));continue;case I.DOCTYPE_QUOTED:g.doctype+=L,L===g.q&&(g.q="",g.state=I.DOCTYPE);continue;case I.DOCTYPE_DTD:g.doctype+=L,L==="]"?g.state=I.DOCTYPE:D(L)&&(g.state=I.DOCTYPE_DTD_QUOTED,g.q=L);continue;case I.DOCTYPE_DTD_QUOTED:g.doctype+=L,L===g.q&&(g.state=I.DOCTYPE_DTD,g.q="");continue;case I.COMMENT:L==="-"?g.state=I.COMMENT_ENDING:g.comment+=L;continue;case I.COMMENT_ENDING:L==="-"?(g.state=I.COMMENT_ENDED,g.comment=A(g.opt,g.comment),g.comment&&B(g,"oncomment",g.comment),g.comment=""):(g.comment+="-"+L,g.state=I.COMMENT);continue;case I.COMMENT_ENDED:L!==">"?(V(g,"Malformed comment"),g.comment+="--"+L,g.state=I.COMMENT):g.state=I.TEXT;continue;case I.CDATA:L==="]"?g.state=I.CDATA_ENDING:g.cdata+=L;continue;case I.CDATA_ENDING:L==="]"?g.state=I.CDATA_ENDING_2:(g.cdata+="]"+L,g.state=I.CDATA);continue;case I.CDATA_ENDING_2:L===">"?(g.cdata&&B(g,"oncdata",g.cdata),B(g,"onclosecdata"),g.cdata="",g.state=I.TEXT):L==="]"?g.cdata+="]":(g.cdata+="]]"+L,g.state=I.CDATA);continue;case I.PROC_INST:L==="?"?g.state=I.PROC_INST_ENDING:C(L)?g.state=I.PROC_INST_BODY:g.procInstName+=L;continue;case I.PROC_INST_BODY:if(!g.procInstBody&&C(L))continue;L==="?"?g.state=I.PROC_INST_ENDING:g.procInstBody+=L;continue;case I.PROC_INST_ENDING:L===">"?(B(g,"onprocessinginstruction",{name:g.procInstName,body:g.procInstBody}),g.procInstName=g.procInstBody="",g.state=I.TEXT):(g.procInstBody+="?"+L,g.state=I.PROC_INST_BODY);continue;case I.OPEN_TAG:M(f,L)?g.tagName+=L:(ye(g),L===">"?j(g):L==="/"?g.state=I.OPEN_TAG_SLASH:(C(L)||V(g,"Invalid character in tag name"),g.state=I.ATTRIB));continue;case I.OPEN_TAG_SLASH:L===">"?(j(g,!0),R(g)):(V(g,"Forward-slash in opening tag not followed by >"),g.state=I.ATTRIB);continue;case I.ATTRIB:if(C(L))continue;L===">"?j(g):L==="/"?g.state=I.OPEN_TAG_SLASH:M(_,L)?(g.attribName=L,g.attribValue="",g.state=I.ATTRIB_NAME):V(g,"Invalid attribute name");continue;case I.ATTRIB_NAME:L==="="?g.state=I.ATTRIB_VALUE:L===">"?(V(g,"Attribute without value"),g.attribValue=g.attribName,re(g),j(g)):C(L)?g.state=I.ATTRIB_NAME_SAW_WHITE:M(f,L)?g.attribName+=L:V(g,"Invalid attribute name");continue;case I.ATTRIB_NAME_SAW_WHITE:if(L==="=")g.state=I.ATTRIB_VALUE;else{if(C(L))continue;V(g,"Attribute without value"),g.tag.attributes[g.attribName]="",g.attribValue="",B(g,"onattribute",{name:g.attribName,value:""}),g.attribName="",L===">"?j(g):M(_,L)?(g.attribName=L,g.state=I.ATTRIB_NAME):(V(g,"Invalid attribute name"),g.state=I.ATTRIB)}continue;case I.ATTRIB_VALUE:if(C(L))continue;D(L)?(g.q=L,g.state=I.ATTRIB_VALUE_QUOTED):(V(g,"Unquoted attribute value"),g.state=I.ATTRIB_VALUE_UNQUOTED,g.attribValue=L);continue;case I.ATTRIB_VALUE_QUOTED:if(L!==g.q){L==="&"?g.state=I.ATTRIB_VALUE_ENTITY_Q:g.attribValue+=L;continue}re(g),g.q="",g.state=I.ATTRIB_VALUE_CLOSED;continue;case I.ATTRIB_VALUE_CLOSED:C(L)?g.state=I.ATTRIB:L===">"?j(g):L==="/"?g.state=I.OPEN_TAG_SLASH:M(_,L)?(V(g,"No whitespace between attributes"),g.attribName=L,g.attribValue="",g.state=I.ATTRIB_NAME):V(g,"Invalid attribute name");continue;case I.ATTRIB_VALUE_UNQUOTED:if(!q(L)){L==="&"?g.state=I.ATTRIB_VALUE_ENTITY_U:g.attribValue+=L;continue}re(g),L===">"?j(g):g.state=I.ATTRIB;continue;case I.CLOSE_TAG:if(g.tagName)L===">"?R(g):M(f,L)?g.tagName+=L:g.script?(g.script+="</"+g.tagName,g.tagName="",g.state=I.SCRIPT):(C(L)||V(g,"Invalid tagname in closing tag"),g.state=I.CLOSE_TAG_SAW_WHITE);else{if(C(L))continue;J(_,L)?g.script?(g.script+="</"+L,g.state=I.SCRIPT):V(g,"Invalid tagname in closing tag."):g.tagName=L}continue;case I.CLOSE_TAG_SAW_WHITE:if(C(L))continue;L===">"?R(g):V(g,"Invalid characters in closing tag");continue;case I.TEXT_ENTITY:case I.ATTRIB_VALUE_ENTITY_Q:case I.ATTRIB_VALUE_ENTITY_U:var ae,h;switch(g.state){case I.TEXT_ENTITY:ae=I.TEXT,h="textNode";break;case I.ATTRIB_VALUE_ENTITY_Q:ae=I.ATTRIB_VALUE_QUOTED,h="attribValue";break;case I.ATTRIB_VALUE_ENTITY_U:ae=I.ATTRIB_VALUE_UNQUOTED,h="attribValue";break}L===";"?(g[h]+=K(g),g.entity="",g.state=ae):M(g.entity.length?k:x,L)?g.entity+=L:(V(g,"Invalid character in entity name"),g[h]+="&"+g.entity+L,g.entity="",g.state=ae);continue;default:throw new Error(g,"Unknown state: "+g.state)}return g.position>=g.bufferCheckPosition&&l(g),g}/*! http://mths.be/fromcodepoint v0.1.0 by @mathias */String.fromCodePoint||function(){var v=String.fromCharCode,g=Math.floor,U=function(){var L=16384,N=[],O,ae,h=-1,Q=arguments.length;if(!Q)return"";for(var E="";++h<Q;){var o=Number(arguments[h]);if(!isFinite(o)||o<0||o>1114111||g(o)!==o)throw RangeError("Invalid code point: "+o);o<=65535?N.push(o):(o-=65536,O=(o>>10)+55296,ae=o%1024+56320,N.push(O,ae)),(h+1===Q||N.length>L)&&(E+=v.apply(null,N),N.length=0)}return E};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:U,configurable:!0,writable:!0}):String.fromCodePoint=U}()})(r)})(ls);var bi={isArray:function(r){return Array.isArray?Array.isArray(r):Object.prototype.toString.call(r)==="[object Array]"}},fl=bi.isArray,_i={copyOptions:function(r){var e,t={};for(e in r)r.hasOwnProperty(e)&&(t[e]=r[e]);return t},ensureFlagExists:function(r,e){(!(r in e)||typeof e[r]!="boolean")&&(e[r]=!1)},ensureSpacesExists:function(r){(!("spaces"in r)||typeof r.spaces!="number"&&typeof r.spaces!="string")&&(r.spaces=0)},ensureAlwaysArrayExists:function(r){(!("alwaysArray"in r)||typeof r.alwaysArray!="boolean"&&!fl(r.alwaysArray))&&(r.alwaysArray=!1)},ensureKeyExists:function(r,e){(!(r+"Key"in e)||typeof e[r+"Key"]!="string")&&(e[r+"Key"]=e.compact?"_"+r:r)},checkFnExists:function(r,e){return r+"Fn"in e}},hl=ls,We=_i,Qt=bi.isArray,ce,Le;function dl(r){return ce=We.copyOptions(r),We.ensureFlagExists("ignoreDeclaration",ce),We.ensureFlagExists("ignoreInstruction",ce),We.ensureFlagExists("ignoreAttributes",ce),We.ensureFlagExists("ignoreText",ce),We.ensureFlagExists("ignoreComment",ce),We.ensureFlagExists("ignoreCdata",ce),We.ensureFlagExists("ignoreDoctype",ce),We.ensureFlagExists("compact",ce),We.ensureFlagExists("alwaysChildren",ce),We.ensureFlagExists("addParent",ce),We.ensureFlagExists("trim",ce),We.ensureFlagExists("nativeType",ce),We.ensureFlagExists("nativeTypeAttributes",ce),We.ensureFlagExists("sanitize",ce),We.ensureFlagExists("instructionHasAttributes",ce),We.ensureFlagExists("captureSpacesBetweenElements",ce),We.ensureAlwaysArrayExists(ce),We.ensureKeyExists("declaration",ce),We.ensureKeyExists("instruction",ce),We.ensureKeyExists("attributes",ce),We.ensureKeyExists("text",ce),We.ensureKeyExists("comment",ce),We.ensureKeyExists("cdata",ce),We.ensureKeyExists("doctype",ce),We.ensureKeyExists("type",ce),We.ensureKeyExists("name",ce),We.ensureKeyExists("elements",ce),We.ensureKeyExists("parent",ce),ce}function Os(r){var e=Number(r);if(!isNaN(e))return e;var t=r.toLowerCase();return t==="true"?!0:t==="false"?!1:r}function kr(r,e){var t;if(ce.compact){if(!Le[ce[r+"Key"]]&&(Qt(ce.alwaysArray)?ce.alwaysArray.indexOf(ce[r+"Key"])!==-1:ce.alwaysArray)&&(Le[ce[r+"Key"]]=[]),Le[ce[r+"Key"]]&&!Qt(Le[ce[r+"Key"]])&&(Le[ce[r+"Key"]]=[Le[ce[r+"Key"]]]),r+"Fn"in ce&&typeof e=="string"&&(e=ce[r+"Fn"](e,Le)),r==="instruction"&&("instructionFn"in ce||"instructionNameFn"in ce)){for(t in e)if(e.hasOwnProperty(t))if("instructionFn"in ce)e[t]=ce.instructionFn(e[t],t,Le);else{var s=e[t];delete e[t],e[ce.instructionNameFn(t,s,Le)]=s}}Qt(Le[ce[r+"Key"]])?Le[ce[r+"Key"]].push(e):Le[ce[r+"Key"]]=e}else{Le[ce.elementsKey]||(Le[ce.elementsKey]=[]);var l={};if(l[ce.typeKey]=r,r==="instruction"){for(t in e)if(e.hasOwnProperty(t))break;l[ce.nameKey]="instructionNameFn"in ce?ce.instructionNameFn(t,e,Le):t,ce.instructionHasAttributes?(l[ce.attributesKey]=e[t][ce.attributesKey],"instructionFn"in ce&&(l[ce.attributesKey]=ce.instructionFn(l[ce.attributesKey],t,Le))):("instructionFn"in ce&&(e[t]=ce.instructionFn(e[t],t,Le)),l[ce.instructionKey]=e[t])}else r+"Fn"in ce&&(e=ce[r+"Fn"](e,Le)),l[ce[r+"Key"]]=e;ce.addParent&&(l[ce.parentKey]=Le),Le[ce.elementsKey].push(l)}}function Bs(r){if("attributesFn"in ce&&r&&(r=ce.attributesFn(r,Le)),(ce.trim||"attributeValueFn"in ce||"attributeNameFn"in ce||ce.nativeTypeAttributes)&&r){var e;for(e in r)if(r.hasOwnProperty(e)&&(ce.trim&&(r[e]=r[e].trim()),ce.nativeTypeAttributes&&(r[e]=Os(r[e])),"attributeValueFn"in ce&&(r[e]=ce.attributeValueFn(r[e],e,Le)),"attributeNameFn"in ce)){var t=r[e];delete r[e],r[ce.attributeNameFn(e,r[e],Le)]=t}}return r}function pl(r){var e={};if(r.body&&(r.name.toLowerCase()==="xml"||ce.instructionHasAttributes)){for(var t=/([\w:-]+)\s*=\s*(?:"([^"]*)"|'([^']*)'|(\w+))\s*/g,s;(s=t.exec(r.body))!==null;)e[s[1]]=s[2]||s[3]||s[4];e=Bs(e)}if(r.name.toLowerCase()==="xml"){if(ce.ignoreDeclaration)return;Le[ce.declarationKey]={},Object.keys(e).length&&(Le[ce.declarationKey][ce.attributesKey]=e),ce.addParent&&(Le[ce.declarationKey][ce.parentKey]=Le)}else{if(ce.ignoreInstruction)return;ce.trim&&(r.body=r.body.trim());var l={};ce.instructionHasAttributes&&Object.keys(e).length?(l[r.name]={},l[r.name][ce.attributesKey]=e):l[r.name]=r.body,kr("instruction",l)}}function ml(r,e){var t;if(typeof r=="object"&&(e=r.attributes,r=r.name),e=Bs(e),"elementNameFn"in ce&&(r=ce.elementNameFn(r,Le)),ce.compact){if(t={},!ce.ignoreAttributes&&e&&Object.keys(e).length){t[ce.attributesKey]={};var s;for(s in e)e.hasOwnProperty(s)&&(t[ce.attributesKey][s]=e[s])}!(r in Le)&&(Qt(ce.alwaysArray)?ce.alwaysArray.indexOf(r)!==-1:ce.alwaysArray)&&(Le[r]=[]),Le[r]&&!Qt(Le[r])&&(Le[r]=[Le[r]]),Qt(Le[r])?Le[r].push(t):Le[r]=t}else Le[ce.elementsKey]||(Le[ce.elementsKey]=[]),t={},t[ce.typeKey]="element",t[ce.nameKey]=r,!ce.ignoreAttributes&&e&&Object.keys(e).length&&(t[ce.attributesKey]=e),ce.alwaysChildren&&(t[ce.elementsKey]=[]),Le[ce.elementsKey].push(t);t[ce.parentKey]=Le,Le=t}function gl(r){ce.ignoreText||!r.trim()&&!ce.captureSpacesBetweenElements||(ce.trim&&(r=r.trim()),ce.nativeType&&(r=Os(r)),ce.sanitize&&(r=r.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),kr("text",r))}function wl(r){ce.ignoreComment||(ce.trim&&(r=r.trim()),kr("comment",r))}function yl(r){var e=Le[ce.parentKey];ce.addParent||delete Le[ce.parentKey],Le=e}function vl(r){ce.ignoreCdata||(ce.trim&&(r=r.trim()),kr("cdata",r))}function bl(r){ce.ignoreDoctype||(r=r.replace(/^ /,""),ce.trim&&(r=r.trim()),kr("doctype",r))}function _l(r){r.note=r}var Fs=function(r,e){var t=hl.parser(!0,{}),s={};if(Le=s,ce=dl(e),t.opt={strictEntities:!0},t.onopentag=ml,t.ontext=gl,t.oncomment=wl,t.onclosetag=yl,t.onerror=_l,t.oncdata=vl,t.ondoctype=bl,t.onprocessinginstruction=pl,t.write(r).close(),s[ce.elementsKey]){var l=s[ce.elementsKey];delete s[ce.elementsKey],s[ce.elementsKey]=l,delete s.text}return s},ko=_i,El=Fs;function xl(r){var e=ko.copyOptions(r);return ko.ensureSpacesExists(e),e}var Tl=function(r,e){var t,s,l,i;return t=xl(e),s=El(r,t),i="compact"in t&&t.compact?"_parent":"parent","addParent"in t&&t.addParent?l=JSON.stringify(s,function(c,n){return c===i?"_":n},t.spaces):l=JSON.stringify(s,null,t.spaces),l.replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")},Ye=_i,Al=bi.isArray,ct,ut;function Sl(r){var e=Ye.copyOptions(r);return Ye.ensureFlagExists("ignoreDeclaration",e),Ye.ensureFlagExists("ignoreInstruction",e),Ye.ensureFlagExists("ignoreAttributes",e),Ye.ensureFlagExists("ignoreText",e),Ye.ensureFlagExists("ignoreComment",e),Ye.ensureFlagExists("ignoreCdata",e),Ye.ensureFlagExists("ignoreDoctype",e),Ye.ensureFlagExists("compact",e),Ye.ensureFlagExists("indentText",e),Ye.ensureFlagExists("indentCdata",e),Ye.ensureFlagExists("indentAttributes",e),Ye.ensureFlagExists("indentInstruction",e),Ye.ensureFlagExists("fullTagEmptyElement",e),Ye.ensureFlagExists("noQuotesForNativeAttributes",e),Ye.ensureSpacesExists(e),typeof e.spaces=="number"&&(e.spaces=Array(e.spaces+1).join(" ")),Ye.ensureKeyExists("declaration",e),Ye.ensureKeyExists("instruction",e),Ye.ensureKeyExists("attributes",e),Ye.ensureKeyExists("text",e),Ye.ensureKeyExists("comment",e),Ye.ensureKeyExists("cdata",e),Ye.ensureKeyExists("doctype",e),Ye.ensureKeyExists("type",e),Ye.ensureKeyExists("name",e),Ye.ensureKeyExists("elements",e),e}function It(r,e,t){return(!t&&r.spaces?`
`:"")+Array(e+1).join(r.spaces)}function Qr(r,e,t){if(e.ignoreAttributes)return"";"attributesFn"in e&&(r=e.attributesFn(r,ut,ct));var s,l,i,c,n=[];for(s in r)r.hasOwnProperty(s)&&r[s]!==null&&r[s]!==void 0&&(c=e.noQuotesForNativeAttributes&&typeof r[s]!="string"?"":'"',l=""+r[s],l=l.replace(/"/g,"&quot;"),i="attributeNameFn"in e?e.attributeNameFn(s,l,ut,ct):s,n.push(e.spaces&&e.indentAttributes?It(e,t+1,!1):" "),n.push(i+"="+c+("attributeValueFn"in e?e.attributeValueFn(l,s,ut,ct):l)+c));return r&&Object.keys(r).length&&e.spaces&&e.indentAttributes&&n.push(It(e,t,!1)),n.join("")}function Ls(r,e,t){return ct=r,ut="xml",e.ignoreDeclaration?"":"<?xml"+Qr(r[e.attributesKey],e,t)+"?>"}function Ps(r,e,t){if(e.ignoreInstruction)return"";var s;for(s in r)if(r.hasOwnProperty(s))break;var l="instructionNameFn"in e?e.instructionNameFn(s,r[s],ut,ct):s;if(typeof r[s]=="object")return ct=r,ut=l,"<?"+l+Qr(r[s][e.attributesKey],e,t)+"?>";var i=r[s]?r[s]:"";return"instructionFn"in e&&(i=e.instructionFn(i,s,ut,ct)),"<?"+l+(i?" "+i:"")+"?>"}function Us(r,e){return e.ignoreComment?"":"<!--"+("commentFn"in e?e.commentFn(r,ut,ct):r)+"-->"}function Ms(r,e){return e.ignoreCdata?"":"<![CDATA["+("cdataFn"in e?e.cdataFn(r,ut,ct):r.replace("]]>","]]]]><![CDATA[>"))+"]]>"}function js(r,e){return e.ignoreDoctype?"":"<!DOCTYPE "+("doctypeFn"in e?e.doctypeFn(r,ut,ct):r)+">"}function Ei(r,e){return e.ignoreText?"":(r=""+r,r=r.replace(/&amp;/g,"&"),r=r.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"textFn"in e?e.textFn(r,ut,ct):r)}function kl(r,e){var t;if(r.elements&&r.elements.length)for(t=0;t<r.elements.length;++t)switch(r.elements[t][e.typeKey]){case"text":if(e.indentText)return!0;break;case"cdata":if(e.indentCdata)return!0;break;case"instruction":if(e.indentInstruction)return!0;break;case"doctype":case"comment":case"element":return!0;default:return!0}return!1}function Cl(r,e,t){ct=r,ut=r.name;var s=[],l="elementNameFn"in e?e.elementNameFn(r.name,r):r.name;s.push("<"+l),r[e.attributesKey]&&s.push(Qr(r[e.attributesKey],e,t));var i=r[e.elementsKey]&&r[e.elementsKey].length||r[e.attributesKey]&&r[e.attributesKey]["xml:space"]==="preserve";return i||("fullTagEmptyElementFn"in e?i=e.fullTagEmptyElementFn(r.name,r):i=e.fullTagEmptyElement),i?(s.push(">"),r[e.elementsKey]&&r[e.elementsKey].length&&(s.push(zs(r[e.elementsKey],e,t+1)),ct=r,ut=r.name),s.push(e.spaces&&kl(r,e)?`
`+Array(t+1).join(e.spaces):""),s.push("</"+l+">")):s.push("/>"),s.join("")}function zs(r,e,t,s){return r.reduce(function(l,i){var c=It(e,t,s&&!l);switch(i.type){case"element":return l+c+Cl(i,e,t);case"comment":return l+c+Us(i[e.commentKey],e);case"doctype":return l+c+js(i[e.doctypeKey],e);case"cdata":return l+(e.indentCdata?c:"")+Ms(i[e.cdataKey],e);case"text":return l+(e.indentText?c:"")+Ei(i[e.textKey],e);case"instruction":var n={};return n[i[e.nameKey]]=i[e.attributesKey]?i:i[e.instructionKey],l+(e.indentInstruction?c:"")+Ps(n,e,t)}},"")}function Hs(r,e,t){var s;for(s in r)if(r.hasOwnProperty(s))switch(s){case e.parentKey:case e.attributesKey:break;case e.textKey:if(e.indentText||t)return!0;break;case e.cdataKey:if(e.indentCdata||t)return!0;break;case e.instructionKey:if(e.indentInstruction||t)return!0;break;case e.doctypeKey:case e.commentKey:return!0;default:return!0}return!1}function Il(r,e,t,s,l){ct=r,ut=e;var i="elementNameFn"in t?t.elementNameFn(e,r):e;if(typeof r>"u"||r===null||r==="")return"fullTagEmptyElementFn"in t&&t.fullTagEmptyElementFn(e,r)||t.fullTagEmptyElement?"<"+i+"></"+i+">":"<"+i+"/>";var c=[];if(e){if(c.push("<"+i),typeof r!="object")return c.push(">"+Ei(r,t)+"</"+i+">"),c.join("");r[t.attributesKey]&&c.push(Qr(r[t.attributesKey],t,s));var n=Hs(r,t,!0)||r[t.attributesKey]&&r[t.attributesKey]["xml:space"]==="preserve";if(n||("fullTagEmptyElementFn"in t?n=t.fullTagEmptyElementFn(e,r):n=t.fullTagEmptyElement),n)c.push(">");else return c.push("/>"),c.join("")}return c.push(Ws(r,t,s+1,!1)),ct=r,ut=e,e&&c.push((l?It(t,s,!1):"")+"</"+i+">"),c.join("")}function Ws(r,e,t,s){var l,i,c,n=[];for(i in r)if(r.hasOwnProperty(i))for(c=Al(r[i])?r[i]:[r[i]],l=0;l<c.length;++l){switch(i){case e.declarationKey:n.push(Ls(c[l],e,t));break;case e.instructionKey:n.push((e.indentInstruction?It(e,t,s):"")+Ps(c[l],e,t));break;case e.attributesKey:case e.parentKey:break;case e.textKey:n.push((e.indentText?It(e,t,s):"")+Ei(c[l],e));break;case e.cdataKey:n.push((e.indentCdata?It(e,t,s):"")+Ms(c[l],e));break;case e.doctypeKey:n.push(It(e,t,s)+js(c[l],e));break;case e.commentKey:n.push(It(e,t,s)+Us(c[l],e));break;default:n.push(It(e,t,s)+Il(c[l],i,e,t,Hs(c[l],e)))}s=s&&!n.length}return n.join("")}var Gs=function(r,e){e=Sl(e);var t=[];return ct=r,ut="_root_",e.compact?t.push(Ws(r,e,0,!0)):(r[e.declarationKey]&&t.push(Ls(r[e.declarationKey],e,0)),r[e.elementsKey]&&r[e.elementsKey].length&&t.push(zs(r[e.elementsKey],e,0,!t.length))),t.join("")},Rl=Gs,Nl=function(r,e){r instanceof Buffer&&(r=r.toString());var t=null;if(typeof r=="string")try{t=JSON.parse(r)}catch{throw new Error("The JSON structure is invalid")}else t=r;return Rl(t,e)},Dl=Fs,Ol=Tl,Bl=Gs,Fl=Nl,$s={xml2js:Dl,xml2json:Ol,js2xml:Bl,json2xml:Fl};const xi=r=>{switch(r.type){case void 0:case"element":const e=new Pl(r.name,r.attributes),t=r.elements||[];for(const s of t){const l=xi(s);l!==void 0&&e.push(l)}return e;case"text":return r.text;default:return}};class Ll extends Fe{}class Pl extends ve{static fromXmlString(e){const t=$s.xml2js(e,{compact:!1});return xi(t)}constructor(e,t){super(e),t&&this.root.push(new Ll(t))}push(e){this.root.push(e)}}class Ul extends ve{constructor(e){super(""),this._attr=e}prepForXml(e){return{_attr:this._attr}}}class Vs extends ve{constructor(e,t){super(e),t&&(this.root=t.root)}}const pt=r=>{if(isNaN(r))throw new Error(`Invalid value '${r}' specified. Must be an integer.`);return Math.floor(r)},en=r=>{const e=pt(r);if(e<0)throw new Error(`Invalid value '${r}' specified. Must be a positive integer.`);return e},Ks=(r,e)=>{const t=e*2;if(r.length!==t||isNaN(+`0x${r}`))throw new Error(`Invalid hex value '${r}'. Expected ${t} digit hex value`);return r},Co=r=>Ks(r,1),qs=r=>{const e=r.slice(-2),t=r.substring(0,r.length-2);return`${Number(t)}${e}`},Xs=r=>{const e=qs(r);if(parseFloat(e)<0)throw new Error(`Invalid value '${e}' specified. Expected a positive number.`);return e},ir=r=>{if(r==="auto")return r;const e=r.charAt(0)==="#"?r.substring(1):r;return Ks(e,3)},Wt=r=>typeof r=="string"?qs(r):pt(r),Ml=r=>typeof r=="string"?Xs(r):en(r),_t=r=>typeof r=="string"?Xs(r):en(r),jl=en,zl=en,Hl=r=>r.toISOString();class _e extends ve{constructor(e,t=!0){super(e),t!==!0&&this.root.push(new nt({val:t}))}}class qn extends ve{constructor(e,t){super(e),this.root.push(new nt({val:Ml(t)}))}}class er extends ve{constructor(e,t){super(e),this.root.push(new nt({val:t}))}}const _r=(r,e)=>new Pt({name:r,attributes:{value:{key:"w:val",value:e}}});class Ti extends ve{constructor(e,t){super(e),this.root.push(new nt({val:t}))}}class jt extends ve{constructor(e,t){super(e),this.root.push(t)}}class Pt extends ve{constructor({name:e,attributes:t,children:s}){super(e),t&&this.root.push(new Sr(t)),s&&this.root.push(...s)}}const Tt={START:"start",CENTER:"center",END:"end",BOTH:"both",MEDIUM_KASHIDA:"mediumKashida",DISTRIBUTE:"distribute",NUM_TAB:"numTab",HIGH_KASHIDA:"highKashida",LOW_KASHIDA:"lowKashida",THAI_DISTRIBUTE:"thaiDistribute",LEFT:"left",RIGHT:"right",JUSTIFIED:"both"};class Wl extends Fe{constructor(){super(...arguments),ge(this,"xmlKeys",{val:"w:val"})}}class Gl extends ve{constructor(e){super("w:jc"),this.root.push(new Wl({val:e}))}}class et extends ve{constructor(e,{color:t,size:s,space:l,style:i}){super(e),this.root.push(new $l({style:i,color:t===void 0?void 0:ir(t),size:s===void 0?void 0:jl(s),space:l===void 0?void 0:zl(l)}))}}class $l extends Fe{constructor(){super(...arguments),ge(this,"xmlKeys",{style:"w:val",color:"w:color",size:"w:sz",space:"w:space"})}}const Ai={SINGLE:"single",DASH_DOT_STROKED:"dashDotStroked",DASHED:"dashed",DASH_SMALL_GAP:"dashSmallGap",DOT_DASH:"dotDash",DOT_DOT_DASH:"dotDotDash",DOTTED:"dotted",DOUBLE:"double",DOUBLE_WAVE:"doubleWave",INSET:"inset",NIL:"nil",NONE:"none",OUTSET:"outset",THICK:"thick",THICK_THIN_LARGE_GAP:"thickThinLargeGap",THICK_THIN_MEDIUM_GAP:"thickThinMediumGap",THICK_THIN_SMALL_GAP:"thickThinSmallGap",THIN_THICK_LARGE_GAP:"thinThickLargeGap",THIN_THICK_MEDIUM_GAP:"thinThickMediumGap",THIN_THICK_SMALL_GAP:"thinThickSmallGap",THIN_THICK_THIN_LARGE_GAP:"thinThickThinLargeGap",THIN_THICK_THIN_MEDIUM_GAP:"thinThickThinMediumGap",THIN_THICK_THIN_SMALL_GAP:"thinThickThinSmallGap",THREE_D_EMBOSS:"threeDEmboss",THREE_D_ENGRAVE:"threeDEngrave",TRIPLE:"triple",WAVE:"wave"};class Vl extends Zr{constructor(e){super("w:pBdr"),e.top&&this.root.push(new et("w:top",e.top)),e.bottom&&this.root.push(new et("w:bottom",e.bottom)),e.left&&this.root.push(new et("w:left",e.left)),e.right&&this.root.push(new et("w:right",e.right))}}class Kl extends ve{constructor(){super("w:pBdr");const e=new et("w:bottom",{color:"auto",space:1,style:Ai.SINGLE,size:6});this.root.push(e)}}class ql extends ve{constructor({start:e,end:t,left:s,right:l,hanging:i,firstLine:c}){super("w:ind"),this.root.push(new Sr({start:{key:"w:start",value:e===void 0?void 0:Wt(e)},end:{key:"w:end",value:t===void 0?void 0:Wt(t)},left:{key:"w:left",value:s===void 0?void 0:Wt(s)},right:{key:"w:right",value:l===void 0?void 0:Wt(l)},hanging:{key:"w:hanging",value:i===void 0?void 0:_t(i)},firstLine:{key:"w:firstLine",value:c===void 0?void 0:_t(c)}}))}}let Xl=class extends ve{constructor(){super("w:br")}};const Si={BEGIN:"begin",END:"end",SEPARATE:"separate"};class ki extends Fe{constructor(){super(...arguments),ge(this,"xmlKeys",{type:"w:fldCharType",dirty:"w:dirty"})}}class Br extends ve{constructor(e){super("w:fldChar"),this.root.push(new ki({type:Si.BEGIN,dirty:e}))}}class Fr extends ve{constructor(e){super("w:fldChar"),this.root.push(new ki({type:Si.SEPARATE,dirty:e}))}}class Lr extends ve{constructor(e){super("w:fldChar"),this.root.push(new ki({type:Si.END,dirty:e}))}}const or={DEFAULT:"default",PRESERVE:"preserve"};class sr extends Fe{constructor(){super(...arguments),ge(this,"xmlKeys",{space:"xml:space"})}}let Zl=class extends ve{constructor(){super("w:instrText"),this.root.push(new sr({space:or.PRESERVE})),this.root.push("PAGE")}};class Yl extends ve{constructor(){super("w:instrText"),this.root.push(new sr({space:or.PRESERVE})),this.root.push("NUMPAGES")}}class Jl extends ve{constructor(){super("w:instrText"),this.root.push(new sr({space:or.PRESERVE})),this.root.push("SECTIONPAGES")}}class Ql extends ve{constructor(){super("w:instrText"),this.root.push(new sr({space:or.PRESERVE})),this.root.push("SECTION")}}class ec extends Fe{constructor(){super(...arguments),ge(this,"xmlKeys",{fill:"w:fill",color:"w:color",type:"w:val"})}}class Zs extends ve{constructor({fill:e,color:t,type:s}){super("w:shd"),this.root.push(new ec({fill:e===void 0?void 0:ir(e),color:t===void 0?void 0:ir(t),type:s}))}}class tc extends Fe{constructor(){super(...arguments),ge(this,"xmlKeys",{id:"w:id",author:"w:author",date:"w:date"})}}const rc={DOT:"dot"};class nc extends ve{constructor(e){super("w:em"),this.root.push(new nt({val:e}))}}class ic extends nc{constructor(e=rc.DOT){super(e)}}class oc extends ve{constructor(e){super("w:spacing"),this.root.push(new nt({val:Wt(e)}))}}class sc extends ve{constructor(e){super("w:color"),this.root.push(new nt({val:ir(e)}))}}class ac extends ve{constructor(e){super("w:highlight"),this.root.push(new nt({val:e}))}}class lc extends ve{constructor(e){super("w:highlightCs"),this.root.push(new nt({val:e}))}}const cc=r=>new Pt({name:"w:lang",attributes:{value:{key:"w:val",value:r.value},eastAsia:{key:"w:eastAsia",value:r.eastAsia},bidirectional:{key:"w:bidi",value:r.bidirectional}}});class Io extends Fe{constructor(){super(...arguments),ge(this,"xmlKeys",{ascii:"w:ascii",cs:"w:cs",eastAsia:"w:eastAsia",hAnsi:"w:hAnsi",hint:"w:hint"})}}class Xn extends ve{constructor(e,t){if(super("w:rFonts"),typeof e=="string"){const s=e;this.root.push(new Io({ascii:s,cs:s,eastAsia:s,hAnsi:s,hint:t}))}else{const s=e;this.root.push(new Io(s))}}}let Ys=class extends ve{constructor(e){super("w:vertAlign"),this.root.push(new nt({val:e}))}};class uc extends Ys{constructor(){super("superscript")}}class fc extends Ys{constructor(){super("subscript")}}const Js={SINGLE:"single",WORDS:"words",DOUBLE:"double",THICK:"thick",DOTTED:"dotted",DOTTEDHEAVY:"dottedHeavy",DASH:"dash",DASHEDHEAVY:"dashedHeavy",DASHLONG:"dashLong",DASHLONGHEAVY:"dashLongHeavy",DOTDASH:"dotDash",DASHDOTHEAVY:"dashDotHeavy",DOTDOTDASH:"dotDotDash",DASHDOTDOTHEAVY:"dashDotDotHeavy",WAVE:"wave",WAVYHEAVY:"wavyHeavy",WAVYDOUBLE:"wavyDouble",NONE:"none"};class hc extends ve{constructor(e=Js.SINGLE,t){super("w:u"),this.root.push(new nt({val:e,color:t===void 0?void 0:ir(t)}))}}class qt extends Zr{constructor(e){var t,s;if(super("w:rPr"),!e)return;e.noProof!==void 0&&this.push(new _e("w:noProof",e.noProof)),e.bold!==void 0&&this.push(new _e("w:b",e.bold)),(e.boldComplexScript===void 0&&e.bold!==void 0||e.boldComplexScript)&&this.push(new _e("w:bCs",(t=e.boldComplexScript)!=null?t:e.bold)),e.italics!==void 0&&this.push(new _e("w:i",e.italics)),(e.italicsComplexScript===void 0&&e.italics!==void 0||e.italicsComplexScript)&&this.push(new _e("w:iCs",(s=e.italicsComplexScript)!=null?s:e.italics)),e.underline&&this.push(new hc(e.underline.type,e.underline.color)),e.effect&&this.push(new er("w:effect",e.effect)),e.emphasisMark&&this.push(new ic(e.emphasisMark.type)),e.color&&this.push(new sc(e.color)),e.kern&&this.push(new qn("w:kern",e.kern)),e.position&&this.push(new er("w:position",e.position)),e.size!==void 0&&this.push(new qn("w:sz",e.size));const l=e.sizeComplexScript===void 0||e.sizeComplexScript===!0?e.size:e.sizeComplexScript;l&&this.push(new qn("w:szCs",l)),e.rightToLeft!==void 0&&this.push(new _e("w:rtl",e.rightToLeft)),e.smallCaps!==void 0?this.push(new _e("w:smallCaps",e.smallCaps)):e.allCaps!==void 0&&this.push(new _e("w:caps",e.allCaps)),e.strike!==void 0&&this.push(new _e("w:strike",e.strike)),e.doubleStrike!==void 0&&this.push(new _e("w:dstrike",e.doubleStrike)),e.subScript&&this.push(new fc),e.superScript&&this.push(new uc),e.style&&this.push(new er("w:rStyle",e.style)),e.font&&(typeof e.font=="string"?this.push(new Xn(e.font)):"name"in e.font?this.push(new Xn(e.font.name,e.font.hint)):this.push(new Xn(e.font))),e.highlight&&this.push(new ac(e.highlight));const i=e.highlightComplexScript===void 0||e.highlightComplexScript===!0?e.highlight:e.highlightComplexScript;i&&this.push(new lc(i)),e.characterSpacing&&this.push(new oc(e.characterSpacing)),e.emboss!==void 0&&this.push(new _e("w:emboss",e.emboss)),e.imprint!==void 0&&this.push(new _e("w:imprint",e.imprint)),e.shading&&this.push(new Zs(e.shading)),e.revision&&this.push(new dc(e.revision)),e.border&&this.push(new et("w:bdr",e.border)),e.snapToGrid!==void 0&&this.push(new _e("w:snapToGrid",e.snapToGrid)),e.vanish&&this.push(new _e("w:vanish",e.vanish)),e.specVanish&&this.push(new _e("w:specVanish",e.vanish)),e.scale!==void 0&&this.push(new Ti("w:w",e.scale)),e.language&&this.push(cc(e.language)),e.math&&this.push(new _e("w:oMath",e.math))}push(e){this.root.push(e)}}class dc extends ve{constructor(e){super("w:rPrChange"),this.root.push(new tc({id:e.id,author:e.author,date:e.date})),this.addChildElement(new qt(e))}}class si extends ve{constructor(e){var t;return super("w:t"),typeof e=="string"?(this.root.push(new sr({space:or.PRESERVE})),this.root.push(e),this):(this.root.push(new sr({space:(t=e.space)!=null?t:or.DEFAULT})),this.root.push(e.text),this)}}const Pr={CURRENT:"CURRENT",TOTAL_PAGES:"TOTAL_PAGES",TOTAL_PAGES_IN_SECTION:"TOTAL_PAGES_IN_SECTION",CURRENT_SECTION:"SECTION"};class tn extends ve{constructor(e){if(super("w:r"),ge(this,"properties"),this.properties=new qt(e),this.root.push(this.properties),e.break)for(let t=0;t<e.break;t++)this.root.push(new Xl);if(e.children)for(const t of e.children){if(typeof t=="string"){switch(t){case Pr.CURRENT:this.root.push(new Br),this.root.push(new Zl),this.root.push(new Fr),this.root.push(new Lr);break;case Pr.TOTAL_PAGES:this.root.push(new Br),this.root.push(new Yl),this.root.push(new Fr),this.root.push(new Lr);break;case Pr.TOTAL_PAGES_IN_SECTION:this.root.push(new Br),this.root.push(new Jl),this.root.push(new Fr),this.root.push(new Lr);break;case Pr.CURRENT_SECTION:this.root.push(new Br),this.root.push(new Ql),this.root.push(new Fr),this.root.push(new Lr);break;default:this.root.push(new si(t));break}continue}this.root.push(t)}else e.text&&this.root.push(new si(e.text))}}class $r extends tn{constructor(e){if(typeof e=="string")return super({}),this.root.push(new si(e)),this;super(e)}}let pc="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",mc=(r,e=21)=>(t=e)=>{let s="",l=t;for(;l--;)s+=r[Math.random()*r.length|0];return s},gc=(r=21)=>{let e="",t=r;for(;t--;)e+=pc[Math.random()*64|0];return e};const bt=r=>Math.floor(r*72*20),Ci=(r=0)=>{let e=r;return()=>++e},wc=()=>Ci(),yc=()=>Ci(1),vc=()=>Ci(),bc=()=>gc().toLowerCase(),Er=r=>mc("1234567890abcdef",r)(),_c=()=>`${Er(8)}-${Er(4)}-${Er(4)}-${Er(4)}-${Er(12)}`;class Ec extends Fe{constructor(){super(...arguments),ge(this,"xmlKeys",{id:"w:id",initials:"w:initials",author:"w:author",date:"w:date"})}}class xc extends Fe{constructor(){super(...arguments),ge(this,"xmlKeys",{"xmlns:cx":"xmlns:cx","xmlns:cx1":"xmlns:cx1","xmlns:cx2":"xmlns:cx2","xmlns:cx3":"xmlns:cx3","xmlns:cx4":"xmlns:cx4","xmlns:cx5":"xmlns:cx5","xmlns:cx6":"xmlns:cx6","xmlns:cx7":"xmlns:cx7","xmlns:cx8":"xmlns:cx8","xmlns:mc":"xmlns:mc","xmlns:aink":"xmlns:aink","xmlns:am3d":"xmlns:am3d","xmlns:o":"xmlns:o","xmlns:r":"xmlns:r","xmlns:m":"xmlns:m","xmlns:v":"xmlns:v","xmlns:wp14":"xmlns:wp14","xmlns:wp":"xmlns:wp","xmlns:w10":"xmlns:w10","xmlns:w":"xmlns:w","xmlns:w14":"xmlns:w14","xmlns:w15":"xmlns:w15","xmlns:w16cex":"xmlns:w16cex","xmlns:w16cid":"xmlns:w16cid","xmlns:w16":"xmlns:w16","xmlns:w16sdtdh":"xmlns:w16sdtdh","xmlns:w16se":"xmlns:w16se","xmlns:wpg":"xmlns:wpg","xmlns:wpi":"xmlns:wpi","xmlns:wne":"xmlns:wne","xmlns:wps":"xmlns:wps"})}}class Tc extends ve{constructor({id:e,initials:t,author:s,date:l=new Date,children:i}){super("w:comment"),this.root.push(new Ec({id:e,initials:t,author:s,date:l.toISOString()}));for(const c of i)this.root.push(c)}}class Ac extends ve{constructor({children:e}){super("w:comments"),this.root.push(new xc({"xmlns:cx":"http://schemas.microsoft.com/office/drawing/2014/chartex","xmlns:cx1":"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex","xmlns:cx2":"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex","xmlns:cx3":"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex","xmlns:cx4":"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex","xmlns:cx5":"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex","xmlns:cx6":"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex","xmlns:cx7":"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex","xmlns:cx8":"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","xmlns:aink":"http://schemas.microsoft.com/office/drawing/2016/ink","xmlns:am3d":"http://schemas.microsoft.com/office/drawing/2017/model3d","xmlns:o":"urn:schemas-microsoft-com:office:office","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:m":"http://schemas.openxmlformats.org/officeDocument/2006/math","xmlns:v":"urn:schemas-microsoft-com:vml","xmlns:wp14":"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing","xmlns:wp":"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing","xmlns:w10":"urn:schemas-microsoft-com:office:word","xmlns:w":"http://schemas.openxmlformats.org/wordprocessingml/2006/main","xmlns:w14":"http://schemas.microsoft.com/office/word/2010/wordml","xmlns:w15":"http://schemas.microsoft.com/office/word/2012/wordml","xmlns:w16cex":"http://schemas.microsoft.com/office/word/2018/wordml/cex","xmlns:w16cid":"http://schemas.microsoft.com/office/word/2016/wordml/cid","xmlns:w16":"http://schemas.microsoft.com/office/word/2018/wordml","xmlns:w16sdtdh":"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash","xmlns:w16se":"http://schemas.microsoft.com/office/word/2015/wordml/symex","xmlns:wpg":"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup","xmlns:wpi":"http://schemas.microsoft.com/office/word/2010/wordprocessingInk","xmlns:wne":"http://schemas.microsoft.com/office/word/2006/wordml","xmlns:wps":"http://schemas.microsoft.com/office/word/2010/wordprocessingShape"}));for(const t of e)this.root.push(new Tc(t))}}class Sc extends ve{constructor(){super("w:pageBreakBefore")}}const ai={AT_LEAST:"atLeast",EXACTLY:"exactly",EXACT:"exact",AUTO:"auto"};class kc extends Fe{constructor(){super(...arguments),ge(this,"xmlKeys",{after:"w:after",before:"w:before",line:"w:line",lineRule:"w:lineRule"})}}class Cc extends ve{constructor(e){super("w:spacing"),this.root.push(new kc(e))}}let Ur=class extends ve{constructor(e){super("w:pStyle"),this.root.push(new nt({val:e}))}};class Ic extends ve{constructor(e){super("w:tabs");for(const t of e)this.root.push(new Nc(t))}}const Ro={LEFT:"left",RIGHT:"right",CENTER:"center",BAR:"bar",CLEAR:"clear",DECIMAL:"decimal",END:"end",NUM:"num",START:"start"};class Rc extends Fe{constructor(){super(...arguments),ge(this,"xmlKeys",{val:"w:val",pos:"w:pos",leader:"w:leader"})}}class Nc extends ve{constructor({type:e,position:t,leader:s}){super("w:tab"),this.root.push(new Rc({val:e,pos:t,leader:s}))}}class No extends ve{constructor(e,t){super("w:numPr"),this.root.push(new Dc(t)),this.root.push(new Oc(e))}}class Dc extends ve{constructor(e){if(super("w:ilvl"),e>9)throw new Error("Level cannot be greater than 9. Read more here: https://answers.microsoft.com/en-us/msoffice/forum/all/does-word-support-more-than-9-list-levels/d130fdcd-1781-446d-8c84-c6c79124e4d7");this.root.push(new nt({val:e}))}}class Oc extends ve{constructor(e){super("w:numId"),this.root.push(new nt({val:typeof e=="string"?`{${e}}`:e}))}}class Bc extends ve{constructor(){super(...arguments),ge(this,"fileChild",Symbol())}}class Fc extends Fe{constructor(){super(...arguments),ge(this,"xmlKeys",{id:"Id",type:"Type",target:"Target",targetMode:"TargetMode"})}}const Lc={EXTERNAL:"External"};class Pc extends ve{constructor(e,t,s,l){super("Relationship"),this.root.push(new Fc({id:e,type:t,target:s,targetMode:l}))}}class Uc extends Fe{constructor(){super(...arguments),ge(this,"xmlKeys",{id:"r:id",history:"w:history",anchor:"w:anchor"})}}class Mc extends ve{constructor(e,t,s){super("w:hyperlink"),ge(this,"linkId"),this.linkId=t;const l={history:1,anchor:s||void 0,id:s?void 0:`rId${this.linkId}`},i=new Uc(l);this.root.push(i),e.forEach(c=>{this.root.push(c)})}}class jc extends ve{constructor(e){super("w:externalHyperlink"),this.options=e}}class zc extends Fe{constructor(){super(...arguments),ge(this,"xmlKeys",{id:"w:id",name:"w:name"})}}class Hc extends Fe{constructor(){super(...arguments),ge(this,"xmlKeys",{id:"w:id"})}}class Wc{constructor(e){ge(this,"bookmarkUniqueNumericId",vc()),ge(this,"start"),ge(this,"children"),ge(this,"end");const t=this.bookmarkUniqueNumericId();this.start=new Gc(e.id,t),this.children=e.children,this.end=new $c(t)}}class Gc extends ve{constructor(e,t){super("w:bookmarkStart");const s=new zc({name:e,id:t});this.root.push(s)}}class $c extends ve{constructor(e){super("w:bookmarkEnd");const t=new Hc({id:e});this.root.push(t)}}class Vc extends ve{constructor(e){super("w:outlineLvl"),this.level=e,this.root.push(new nt({val:e}))}}class Kc extends Fe{constructor(){super(...arguments),ge(this,"xmlKeys",{verticalAlign:"w:val"})}}class qc extends ve{constructor(e){super("w:vAlign"),this.root.push(new Kc({verticalAlign:e}))}}const tr={DEFAULT:"default",FIRST:"first",EVEN:"even"};class Xc extends Fe{constructor(){super(...arguments),ge(this,"xmlKeys",{type:"w:type",id:"r:id"})}}const Do={HEADER:"w:headerReference",FOOTER:"w:footerReference"};class Zn extends ve{constructor(e,t){super(e),this.root.push(new Xc({type:t.type||tr.DEFAULT,id:`rId${t.id}`}))}}class Zc extends ve{constructor({space:e,count:t,separate:s,equalWidth:l,children:i}){super("w:cols"),this.root.push(new Sr({space:{key:"w:space",value:e===void 0?void 0:_t(e)},count:{key:"w:num",value:t===void 0?void 0:pt(t)},separate:{key:"w:sep",value:s},equalWidth:{key:"w:equalWidth",value:l}})),!l&&i&&i.forEach(c=>this.addChildElement(c))}}class Yc extends Fe{constructor(){super(...arguments),ge(this,"xmlKeys",{type:"w:type",linePitch:"w:linePitch",charSpace:"w:charSpace"})}}class Jc extends ve{constructor(e,t,s){super("w:docGrid"),this.root.push(new Yc({type:s,linePitch:pt(e),charSpace:t?pt(t):void 0}))}}const Qc=({countBy:r,start:e,restart:t,distance:s})=>new Pt({name:"w:lnNumType",attributes:{countBy:{key:"w:countBy",value:r===void 0?void 0:pt(r)},start:{key:"w:start",value:e===void 0?void 0:pt(e)},restart:{key:"w:restart",value:t},distance:{key:"w:distance",value:s===void 0?void 0:_t(s)}}});class Oo extends Fe{constructor(){super(...arguments),ge(this,"xmlKeys",{display:"w:display",offsetFrom:"w:offsetFrom",zOrder:"w:zOrder"})}}class eu extends Zr{constructor(e){if(super("w:pgBorders"),!e)return this;e.pageBorders?this.root.push(new Oo({display:e.pageBorders.display,offsetFrom:e.pageBorders.offsetFrom,zOrder:e.pageBorders.zOrder})):this.root.push(new Oo({})),e.pageBorderTop&&this.root.push(new et("w:top",e.pageBorderTop)),e.pageBorderLeft&&this.root.push(new et("w:left",e.pageBorderLeft)),e.pageBorderBottom&&this.root.push(new et("w:bottom",e.pageBorderBottom)),e.pageBorderRight&&this.root.push(new et("w:right",e.pageBorderRight))}}class tu extends ve{constructor(e,t,s,l,i,c,n){super("w:pgMar"),this.root.push(new Sr({top:{key:"w:top",value:Wt(e)},right:{key:"w:right",value:_t(t)},bottom:{key:"w:bottom",value:Wt(s)},left:{key:"w:left",value:_t(l)},header:{key:"w:header",value:_t(i)},footer:{key:"w:footer",value:_t(c)},gutter:{key:"w:gutter",value:_t(n)}}))}}class ru extends Fe{constructor(){super(...arguments),ge(this,"xmlKeys",{start:"w:start",formatType:"w:fmt",separator:"w:chapSep"})}}class nu extends ve{constructor({start:e,formatType:t,separator:s}){super("w:pgNumType"),this.root.push(new ru({start:e===void 0?void 0:pt(e),formatType:t,separator:s}))}}const Qs={PORTRAIT:"portrait",LANDSCAPE:"landscape"};class iu extends ve{constructor(e,t,s){super("w:pgSz");const l=s===Qs.LANDSCAPE,i=_t(e),c=_t(t);this.root.push(new Sr({width:{key:"w:w",value:l?c:i},height:{key:"w:h",value:l?i:c},orientation:{key:"w:orient",value:s}}))}}class ou extends Fe{constructor(){super(...arguments),ge(this,"xmlKeys",{val:"w:val"})}}class su extends ve{constructor(e){super("w:textDirection"),this.root.push(new ou({val:e}))}}class au extends Fe{constructor(){super(...arguments),ge(this,"xmlKeys",{val:"w:val"})}}class lu extends ve{constructor(e){super("w:type"),this.root.push(new au({val:e}))}}const zt={TOP:1440,RIGHT:1440,BOTTOM:1440,LEFT:1440,HEADER:708,FOOTER:708,GUTTER:0},Yn={WIDTH:11906,HEIGHT:16838,ORIENTATION:Qs.PORTRAIT};class cu extends ve{constructor({page:{size:{width:e=Yn.WIDTH,height:t=Yn.HEIGHT,orientation:s=Yn.ORIENTATION}={},margin:{top:l=zt.TOP,right:i=zt.RIGHT,bottom:c=zt.BOTTOM,left:n=zt.LEFT,header:u=zt.HEADER,footer:m=zt.FOOTER,gutter:w=zt.GUTTER}={},pageNumbers:b={},borders:T,textDirection:p}={},grid:{linePitch:S=360,charSpace:y,type:_}={},headerWrapperGroup:f={},footerWrapperGroup:x={},lineNumbers:k,titlePage:C,verticalAlign:D,column:q,type:M}={}){super("w:sectPr"),this.addHeaderFooterGroup(Do.HEADER,f),this.addHeaderFooterGroup(Do.FOOTER,x),M&&this.root.push(new lu(M)),this.root.push(new iu(e,t,s)),this.root.push(new tu(l,i,c,n,u,m,w)),T&&this.root.push(new eu(T)),k&&this.root.push(Qc(k)),this.root.push(new nu(b)),q&&this.root.push(new Zc(q)),D&&this.root.push(new qc(D)),C!==void 0&&this.root.push(new _e("w:titlePg",C)),p&&this.root.push(new su(p)),this.root.push(new Jc(S,y,_))}addHeaderFooterGroup(e,t){t.default&&this.root.push(new Zn(e,{type:tr.DEFAULT,id:t.default.View.ReferenceId})),t.first&&this.root.push(new Zn(e,{type:tr.FIRST,id:t.first.View.ReferenceId})),t.even&&this.root.push(new Zn(e,{type:tr.EVEN,id:t.even.View.ReferenceId}))}}class uu extends ve{constructor(){super("w:body"),ge(this,"sections",[])}addSection(e){const t=this.sections.pop();this.root.push(this.createSectionParagraph(t)),this.sections.push(new cu(e))}prepForXml(e){return this.sections.length===1&&(this.root.splice(0,1),this.root.push(this.sections.pop())),super.prepForXml(e)}push(e){this.root.push(e)}createSectionParagraph(e){const t=new Ar({}),s=new ar({});return s.push(e),t.addChildElement(s),t}}class Cr extends Fe{constructor(){super(...arguments),ge(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",Ignorable:"mc:Ignorable",cp:"xmlns:cp",dc:"xmlns:dc",dcterms:"xmlns:dcterms",dcmitype:"xmlns:dcmitype",xsi:"xmlns:xsi",type:"xsi:type",cx:"xmlns:cx",cx1:"xmlns:cx1",cx2:"xmlns:cx2",cx3:"xmlns:cx3",cx4:"xmlns:cx4",cx5:"xmlns:cx5",cx6:"xmlns:cx6",cx7:"xmlns:cx7",cx8:"xmlns:cx8",aink:"xmlns:aink",am3d:"xmlns:am3d",w16cex:"xmlns:w16cex",w16cid:"xmlns:w16cid",w16:"xmlns:w16",w16sdtdh:"xmlns:w16sdtdh",w16se:"xmlns:w16se"})}}class fu extends Fe{constructor(){super(...arguments),ge(this,"xmlKeys",{color:"w:color",themeColor:"w:themeColor",themeShade:"w:themeShade",themeTint:"w:themeTint"})}}class hu extends ve{constructor(e){super("w:background"),this.root.push(new fu({color:e.color===void 0?void 0:ir(e.color),themeColor:e.themeColor,themeShade:e.themeShade===void 0?void 0:Co(e.themeShade),themeTint:e.themeTint===void 0?void 0:Co(e.themeTint)}))}}class du extends ve{constructor(e){super("w:document"),ge(this,"body"),this.root.push(new Cr({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",cx:"http://schemas.microsoft.com/office/drawing/2014/chartex",cx1:"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex",cx2:"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex",cx3:"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex",cx4:"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex",cx5:"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex",cx6:"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex",cx7:"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex",cx8:"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex",aink:"http://schemas.microsoft.com/office/drawing/2016/ink",am3d:"http://schemas.microsoft.com/office/drawing/2017/model3d",w16cex:"http://schemas.microsoft.com/office/word/2018/wordml/cex",w16cid:"http://schemas.microsoft.com/office/word/2016/wordml/cid",w16:"http://schemas.microsoft.com/office/word/2018/wordml",w16sdtdh:"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash",w16se:"http://schemas.microsoft.com/office/word/2015/wordml/symex",Ignorable:"w14 w15 wp14"})),this.body=new uu,e.background&&this.root.push(new hu(e.background)),this.root.push(this.body)}add(e){return this.body.push(e),this}get Body(){return this.body}}class pu extends Fe{constructor(){super(...arguments),ge(this,"xmlKeys",{xmlns:"xmlns"})}}class gr extends ve{constructor(){super("Relationships"),this.root.push(new pu({xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"}))}createRelationship(e,t,s,l){const i=new Pc(`rId${e}`,t,s,l);return this.root.push(i),i}get RelationshipCount(){return this.root.length-1}}class ea{constructor(e){ge(this,"document"),ge(this,"relationships"),this.document=new du(e),this.relationships=new gr}get View(){return this.document}get Relationships(){return this.relationships}}class mu extends Fe{constructor(){super(...arguments),ge(this,"xmlKeys",{val:"w:val"})}}class gu extends ve{constructor(){super("w:wordWrap"),this.root.push(new mu({val:0}))}}const wu=r=>{var e,t;return new Pt({name:"w:framePr",attributes:{anchorLock:{key:"w:anchorLock",value:r.anchorLock},dropCap:{key:"w:dropCap",value:r.dropCap},width:{key:"w:w",value:r.width},height:{key:"w:h",value:r.height},x:{key:"w:x",value:r.position?r.position.x:void 0},y:{key:"w:y",value:r.position?r.position.y:void 0},anchorHorizontal:{key:"w:hAnchor",value:r.anchor.horizontal},anchorVertical:{key:"w:vAnchor",value:r.anchor.vertical},spaceHorizontal:{key:"w:hSpace",value:(e=r.space)==null?void 0:e.horizontal},spaceVertical:{key:"w:vSpace",value:(t=r.space)==null?void 0:t.vertical},rule:{key:"w:hRule",value:r.rule},alignmentX:{key:"w:xAlign",value:r.alignment?r.alignment.x:void 0},alignmentY:{key:"w:yAlign",value:r.alignment?r.alignment.y:void 0},lines:{key:"w:lines",value:r.lines},wrap:{key:"w:wrap",value:r.wrap}}})};class ar extends Zr{constructor(e){var t,s;if(super("w:pPr"),ge(this,"numberingReferences",[]),!e)return this;e.heading&&this.push(new Ur(e.heading)),e.bullet&&this.push(new Ur("ListParagraph")),e.numbering&&!e.style&&!e.heading&&(e.numbering.custom||this.push(new Ur("ListParagraph"))),e.style&&this.push(new Ur(e.style)),e.keepNext!==void 0&&this.push(new _e("w:keepNext",e.keepNext)),e.keepLines!==void 0&&this.push(new _e("w:keepLines",e.keepLines)),e.pageBreakBefore&&this.push(new Sc),e.frame&&this.push(wu(e.frame)),e.widowControl!==void 0&&this.push(new _e("w:widowControl",e.widowControl)),e.bullet&&this.push(new No(1,e.bullet.level)),e.numbering&&(this.numberingReferences.push({reference:e.numbering.reference,instance:(t=e.numbering.instance)!=null?t:0}),this.push(new No(`${e.numbering.reference}-${(s=e.numbering.instance)!=null?s:0}`,e.numbering.level))),e.border&&this.push(new Vl(e.border)),e.thematicBreak&&this.push(new Kl),e.shading&&this.push(new Zs(e.shading)),e.wordWrap&&this.push(new gu),e.overflowPunctuation&&this.push(new _e("w:overflowPunct",e.overflowPunctuation));const l=[...e.rightTabStop!==void 0?[{type:Ro.RIGHT,position:e.rightTabStop}]:[],...e.tabStops?e.tabStops:[],...e.leftTabStop!==void 0?[{type:Ro.LEFT,position:e.leftTabStop}]:[]];l.length>0&&this.push(new Ic(l)),e.bidirectional!==void 0&&this.push(new _e("w:bidi",e.bidirectional)),e.spacing&&this.push(new Cc(e.spacing)),e.indent&&this.push(new ql(e.indent)),e.contextualSpacing!==void 0&&this.push(new _e("w:contextualSpacing",e.contextualSpacing)),e.alignment&&this.push(new Gl(e.alignment)),e.outlineLevel!==void 0&&this.push(new Vc(e.outlineLevel)),e.suppressLineNumbers!==void 0&&this.push(new _e("w:suppressLineNumbers",e.suppressLineNumbers)),e.autoSpaceEastAsianText!==void 0&&this.push(new _e("w:autoSpaceDN",e.autoSpaceEastAsianText)),e.run&&this.push(new qt(e.run))}push(e){this.root.push(e)}prepForXml(e){if(e.viewWrapper instanceof ea)for(const t of this.numberingReferences)e.file.Numbering.createConcreteNumberingInstance(t.reference,t.instance);return super.prepForXml(e)}}class Ar extends Bc{constructor(e){if(super("w:p"),ge(this,"properties"),typeof e=="string")return this.properties=new ar({}),this.root.push(this.properties),this.root.push(new $r(e)),this;if(this.properties=new ar(e),this.root.push(this.properties),e.text&&this.root.push(new $r(e.text)),e.children)for(const t of e.children){if(t instanceof Wc){this.root.push(t.start);for(const s of t.children)this.root.push(s);this.root.push(t.end);continue}this.root.push(t)}}prepForXml(e){for(const t of this.root)if(t instanceof jc){const s=this.root.indexOf(t),l=new Mc(t.options.children,bc());e.viewWrapper.Relationships.createRelationship(l.linkId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",t.options.link,Lc.EXTERNAL),this.root[s]=l}return super.prepForXml(e)}addRunToFront(e){return this.root.splice(1,0,e),this}}const Xt={style:Ai.NONE,size:0,color:"auto"},Zt={style:Ai.SINGLE,size:4,color:"auto"};class yu extends ve{constructor(e){super("w:tblBorders"),e.top?this.root.push(new et("w:top",e.top)):this.root.push(new et("w:top",Zt)),e.left?this.root.push(new et("w:left",e.left)):this.root.push(new et("w:left",Zt)),e.bottom?this.root.push(new et("w:bottom",e.bottom)):this.root.push(new et("w:bottom",Zt)),e.right?this.root.push(new et("w:right",e.right)):this.root.push(new et("w:right",Zt)),e.insideHorizontal?this.root.push(new et("w:insideH",e.insideHorizontal)):this.root.push(new et("w:insideH",Zt)),e.insideVertical?this.root.push(new et("w:insideV",e.insideVertical)):this.root.push(new et("w:insideV",Zt))}}ge(yu,"NONE",{top:Xt,bottom:Xt,left:Xt,right:Xt,insideHorizontal:Xt,insideVertical:Xt});class vu extends Fe{constructor(){super(...arguments),ge(this,"xmlKeys",{xmlns:"xmlns",vt:"xmlns:vt"})}}class bu extends ve{constructor(){super("Properties"),this.root.push(new vu({xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"}))}}class _u extends Fe{constructor(){super(...arguments),ge(this,"xmlKeys",{xmlns:"xmlns"})}}class Eu extends Fe{constructor(){super(...arguments),ge(this,"xmlKeys",{contentType:"ContentType",extension:"Extension"})}}class Ft extends ve{constructor(e,t){super("Default"),this.root.push(new Eu({contentType:e,extension:t}))}}class xu extends Fe{constructor(){super(...arguments),ge(this,"xmlKeys",{contentType:"ContentType",partName:"PartName"})}}class wt extends ve{constructor(e,t){super("Override"),this.root.push(new xu({contentType:e,partName:t}))}}class Tu extends ve{constructor(){super("Types"),this.root.push(new _u({xmlns:"http://schemas.openxmlformats.org/package/2006/content-types"})),this.root.push(new Ft("image/png","png")),this.root.push(new Ft("image/jpeg","jpeg")),this.root.push(new Ft("image/jpeg","jpg")),this.root.push(new Ft("image/bmp","bmp")),this.root.push(new Ft("image/gif","gif")),this.root.push(new Ft("application/vnd.openxmlformats-package.relationships+xml","rels")),this.root.push(new Ft("application/xml","xml")),this.root.push(new Ft("application/vnd.openxmlformats-officedocument.obfuscatedFont","odttf")),this.root.push(new wt("application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml","/word/document.xml")),this.root.push(new wt("application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml","/word/styles.xml")),this.root.push(new wt("application/vnd.openxmlformats-package.core-properties+xml","/docProps/core.xml")),this.root.push(new wt("application/vnd.openxmlformats-officedocument.custom-properties+xml","/docProps/custom.xml")),this.root.push(new wt("application/vnd.openxmlformats-officedocument.extended-properties+xml","/docProps/app.xml")),this.root.push(new wt("application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml","/word/numbering.xml")),this.root.push(new wt("application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml","/word/footnotes.xml")),this.root.push(new wt("application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml","/word/settings.xml")),this.root.push(new wt("application/vnd.openxmlformats-officedocument.wordprocessingml.comments+xml","/word/comments.xml")),this.root.push(new wt("application/vnd.openxmlformats-officedocument.wordprocessingml.fontTable+xml","/word/fontTable.xml"))}addFooter(e){this.root.push(new wt("application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml",`/word/footer${e}.xml`))}addHeader(e){this.root.push(new wt("application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml",`/word/header${e}.xml`))}}class Au extends ve{constructor(e){super("cp:coreProperties"),this.root.push(new Cr({cp:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",xsi:"http://www.w3.org/2001/XMLSchema-instance"})),e.title&&this.root.push(new jt("dc:title",e.title)),e.subject&&this.root.push(new jt("dc:subject",e.subject)),e.creator&&this.root.push(new jt("dc:creator",e.creator)),e.keywords&&this.root.push(new jt("cp:keywords",e.keywords)),e.description&&this.root.push(new jt("dc:description",e.description)),e.lastModifiedBy&&this.root.push(new jt("cp:lastModifiedBy",e.lastModifiedBy)),e.revision&&this.root.push(new jt("cp:revision",String(e.revision))),this.root.push(new Bo("dcterms:created")),this.root.push(new Bo("dcterms:modified"))}}class Bo extends ve{constructor(e){super(e),this.root.push(new Cr({type:"dcterms:W3CDTF"})),this.root.push(Hl(new Date))}}class Su extends Fe{constructor(){super(...arguments),ge(this,"xmlKeys",{xmlns:"xmlns",vt:"xmlns:vt"})}}class ku extends Fe{constructor(){super(...arguments),ge(this,"xmlKeys",{fmtid:"fmtid",pid:"pid",name:"name"})}}class Cu extends ve{constructor(e,t){super("property"),this.root.push(new ku({fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:e.toString(),name:t.name})),this.root.push(new Iu(t.value))}}class Iu extends ve{constructor(e){super("vt:lpwstr"),this.root.push(e)}}class Ru extends ve{constructor(e){super("Properties"),ge(this,"nextId"),ge(this,"properties",[]),this.root.push(new Su({xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"})),this.nextId=2;for(const t of e)this.addCustomProperty(t)}prepForXml(e){return this.properties.forEach(t=>this.root.push(t)),super.prepForXml(e)}addCustomProperty(e){this.properties.push(new Cu(this.nextId++,e))}}class Nu extends Fe{constructor(){super(...arguments),ge(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",cp:"xmlns:cp",dc:"xmlns:dc",dcterms:"xmlns:dcterms",dcmitype:"xmlns:dcmitype",xsi:"xmlns:xsi",type:"xsi:type"})}}let Du=class extends Vs{constructor(e,t){super("w:ftr",t),ge(this,"refId"),this.refId=e,t||this.root.push(new Nu({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape"}))}get ReferenceId(){return this.refId}add(e){this.root.push(e)}};class Ou{constructor(e,t,s){ge(this,"footer"),ge(this,"relationships"),this.media=e,this.footer=new Du(t,s),this.relationships=new gr}add(e){this.footer.add(e)}addChildElement(e){this.footer.addChildElement(e)}get View(){return this.footer}get Relationships(){return this.relationships}get Media(){return this.media}}class Bu extends Fe{constructor(){super(...arguments),ge(this,"xmlKeys",{type:"w:type",id:"w:id"})}}class Fu extends ve{constructor(){super("w:footnoteRef")}}class Lu extends tn{constructor(){super({style:"FootnoteReference"}),this.root.push(new Fu)}}const Fo={SEPERATOR:"separator",CONTINUATION_SEPERATOR:"continuationSeparator"};class Jn extends ve{constructor(e){super("w:footnote"),this.root.push(new Bu({type:e.type,id:e.id}));for(let t=0;t<e.children.length;t++){const s=e.children[t];t===0&&s.addRunToFront(new Lu),this.root.push(s)}}}class Pu extends ve{constructor(){super("w:continuationSeparator")}}class Uu extends tn{constructor(){super({}),this.root.push(new Pu)}}class Mu extends ve{constructor(){super("w:separator")}}class ju extends tn{constructor(){super({}),this.root.push(new Mu)}}class zu extends Fe{constructor(){super(...arguments),ge(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",Ignorable:"mc:Ignorable"})}}class Hu extends ve{constructor(){super("w:footnotes"),this.root.push(new zu({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",Ignorable:"w14 w15 wp14"}));const e=new Jn({id:-1,type:Fo.SEPERATOR,children:[new Ar({spacing:{after:0,line:240,lineRule:ai.AUTO},children:[new ju]})]});this.root.push(e);const t=new Jn({id:0,type:Fo.CONTINUATION_SEPERATOR,children:[new Ar({spacing:{after:0,line:240,lineRule:ai.AUTO},children:[new Uu]})]});this.root.push(t)}createFootNote(e,t){const s=new Jn({id:e,children:t});this.root.push(s)}}class Wu{constructor(){ge(this,"footnotess"),ge(this,"relationships"),this.footnotess=new Hu,this.relationships=new gr}get View(){return this.footnotess}get Relationships(){return this.relationships}}class Gu extends Fe{constructor(){super(...arguments),ge(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",cp:"xmlns:cp",dc:"xmlns:dc",dcterms:"xmlns:dcterms",dcmitype:"xmlns:dcmitype",xsi:"xmlns:xsi",type:"xsi:type",cx:"xmlns:cx",cx1:"xmlns:cx1",cx2:"xmlns:cx2",cx3:"xmlns:cx3",cx4:"xmlns:cx4",cx5:"xmlns:cx5",cx6:"xmlns:cx6",cx7:"xmlns:cx7",cx8:"xmlns:cx8",w16cid:"xmlns:w16cid",w16se:"xmlns:w16se"})}}let $u=class extends Vs{constructor(e,t){super("w:hdr",t),ge(this,"refId"),this.refId=e,t||this.root.push(new Gu({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",cx:"http://schemas.microsoft.com/office/drawing/2014/chartex",cx1:"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex",cx2:"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex",cx3:"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex",cx4:"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex",cx5:"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex",cx6:"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex",cx7:"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex",cx8:"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex",w16cid:"http://schemas.microsoft.com/office/word/2016/wordml/cid",w16se:"http://schemas.microsoft.com/office/word/2015/wordml/symex"}))}get ReferenceId(){return this.refId}add(e){this.root.push(e)}};class Vu{constructor(e,t,s){ge(this,"header"),ge(this,"relationships"),this.media=e,this.header=new $u(t,s),this.relationships=new gr}add(e){return this.header.add(e),this}addChildElement(e){this.header.addChildElement(e)}get View(){return this.header}get Relationships(){return this.relationships}get Media(){return this.media}}class Ku{constructor(){ge(this,"map"),this.map=new Map}addImage(e,t){this.map.set(e,t)}get Array(){return Array.from(this.map.values())}}const Dt={DECIMAL:"decimal",UPPER_ROMAN:"upperRoman",LOWER_ROMAN:"lowerRoman",UPPER_LETTER:"upperLetter",LOWER_LETTER:"lowerLetter",ORDINAL:"ordinal",CARDINAL_TEXT:"cardinalText",ORDINAL_TEXT:"ordinalText",HEX:"hex",CHICAGO:"chicago",IDEOGRAPH__DIGITAL:"ideographDigital",JAPANESE_COUNTING:"japaneseCounting",AIUEO:"aiueo",IROHA:"iroha",DECIMAL_FULL_WIDTH:"decimalFullWidth",DECIMAL_HALF_WIDTH:"decimalHalfWidth",JAPANESE_LEGAL:"japaneseLegal",JAPANESE_DIGITAL_TEN_THOUSAND:"japaneseDigitalTenThousand",DECIMAL_ENCLOSED_CIRCLE:"decimalEnclosedCircle",DECIMAL_FULL_WIDTH2:"decimalFullWidth2",AIUEO_FULL_WIDTH:"aiueoFullWidth",IROHA_FULL_WIDTH:"irohaFullWidth",DECIMAL_ZERO:"decimalZero",BULLET:"bullet",GANADA:"ganada",CHOSUNG:"chosung",DECIMAL_ENCLOSED_FULLSTOP:"decimalEnclosedFullstop",DECIMAL_ENCLOSED_PARENTHESES:"decimalEnclosedParen",DECIMAL_ENCLOSED_CIRCLE_CHINESE:"decimalEnclosedCircleChinese",IDEOGRAPH_ENCLOSED_CIRCLE:"ideographEnclosedCircle",IDEOGRAPH_TRADITIONAL:"ideographTraditional",IDEOGRAPH_ZODIAC:"ideographZodiac",IDEOGRAPH_ZODIAC_TRADITIONAL:"ideographZodiacTraditional",TAIWANESE_COUNTING:"taiwaneseCounting",IDEOGRAPH_LEGAL_TRADITIONAL:"ideographLegalTraditional",TAIWANESE_COUNTING_THOUSAND:"taiwaneseCountingThousand",TAIWANESE_DIGITAL:"taiwaneseDigital",CHINESE_COUNTING:"chineseCounting",CHINESE_LEGAL_SIMPLIFIED:"chineseLegalSimplified",CHINESE_COUNTING_THOUSAND:"chineseCountingThousand",KOREAN_DIGITAL:"koreanDigital",KOREAN_COUNTING:"koreanCounting",KOREAN_LEGAL:"koreanLegal",KOREAN_DIGITAL2:"koreanDigital2",VIETNAMESE_COUNTING:"vietnameseCounting",RUSSIAN_LOWER:"russianLower",RUSSIAN_UPPER:"russianUpper",NONE:"none",NUMBER_IN_DASH:"numberInDash",HEBREW1:"hebrew1",HEBREW2:"hebrew2",ARABIC_ALPHA:"arabicAlpha",ARABIC_ABJAD:"arabicAbjad",HINDI_VOWELS:"hindiVowels",HINDI_CONSONANTS:"hindiConsonants",HINDI_NUMBERS:"hindiNumbers",HINDI_COUNTING:"hindiCounting",THAI_LETTERS:"thaiLetters",THAI_NUMBERS:"thaiNumbers",THAI_COUNTING:"thaiCounting",BAHT_TEXT:"bahtText",DOLLAR_TEXT:"dollarText",CUSTOM:"custom"};class qu extends Fe{constructor(){super(...arguments),ge(this,"xmlKeys",{ilvl:"w:ilvl",tentative:"w15:tentative"})}}class Xu extends ve{constructor(e){super("w:numFmt"),this.root.push(new nt({val:e}))}}class Zu extends ve{constructor(e){super("w:lvlText"),this.root.push(new nt({val:e}))}}class Yu extends ve{constructor(e){super("w:lvlJc"),this.root.push(new nt({val:e}))}}class Ju extends ve{constructor(e){super("w:suff"),this.root.push(new nt({val:e}))}}class Qu extends ve{constructor(){super("w:isLgl")}}class ef extends ve{constructor({level:e,format:t,text:s,alignment:l=Tt.START,start:i=1,style:c,suffix:n,isLegalNumberingStyle:u}){if(super("w:lvl"),ge(this,"paragraphProperties"),ge(this,"runProperties"),this.root.push(new Ti("w:start",pt(i))),t&&this.root.push(new Xu(t)),n&&this.root.push(new Ju(n)),u&&this.root.push(new Qu),s&&this.root.push(new Zu(s)),this.root.push(new Yu(l)),this.paragraphProperties=new ar(c&&c.paragraph),this.runProperties=new qt(c&&c.run),this.root.push(this.paragraphProperties),this.root.push(this.runProperties),e>9)throw new Error("Level cannot be greater than 9. Read more here: https://answers.microsoft.com/en-us/msoffice/forum/all/does-word-support-more-than-9-list-levels/d130fdcd-1781-446d-8c84-c6c79124e4d7");this.root.push(new qu({ilvl:pt(e),tentative:1}))}}class tf extends ef{}class rf extends ve{constructor(e){super("w:multiLevelType"),this.root.push(new nt({val:e}))}}class nf extends Fe{constructor(){super(...arguments),ge(this,"xmlKeys",{abstractNumId:"w:abstractNumId",restartNumberingAfterBreak:"w15:restartNumberingAfterBreak"})}}class Lo extends ve{constructor(e,t){super("w:abstractNum"),ge(this,"id"),this.root.push(new nf({abstractNumId:pt(e),restartNumberingAfterBreak:0})),this.root.push(new rf("hybridMultilevel")),this.id=e;for(const s of t)this.root.push(new tf(s))}}class of extends ve{constructor(e){super("w:abstractNumId"),this.root.push(new nt({val:e}))}}class sf extends Fe{constructor(){super(...arguments),ge(this,"xmlKeys",{numId:"w:numId"})}}class Po extends ve{constructor(e){if(super("w:num"),ge(this,"numId"),ge(this,"reference"),ge(this,"instance"),this.numId=e.numId,this.reference=e.reference,this.instance=e.instance,this.root.push(new sf({numId:pt(e.numId)})),this.root.push(new of(pt(e.abstractNumId))),e.overrideLevels&&e.overrideLevels.length)for(const t of e.overrideLevels)this.root.push(new lf(t.num,t.start))}}class af extends Fe{constructor(){super(...arguments),ge(this,"xmlKeys",{ilvl:"w:ilvl"})}}class lf extends ve{constructor(e,t){super("w:lvlOverride"),this.root.push(new af({ilvl:e})),t!==void 0&&this.root.push(new uf(t))}}class cf extends Fe{constructor(){super(...arguments),ge(this,"xmlKeys",{val:"w:val"})}}class uf extends ve{constructor(e){super("w:startOverride"),this.root.push(new cf({val:e}))}}class ff extends ve{constructor(e){super("w:numbering"),ge(this,"abstractNumberingMap",new Map),ge(this,"concreteNumberingMap",new Map),ge(this,"referenceConfigMap",new Map),ge(this,"abstractNumUniqueNumericId",wc()),ge(this,"concreteNumUniqueNumericId",yc()),this.root.push(new Cr({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",Ignorable:"w14 w15 wp14"}));const t=new Lo(this.abstractNumUniqueNumericId(),[{level:0,format:Dt.BULLET,text:"●",alignment:Tt.LEFT,style:{paragraph:{indent:{left:bt(.5),hanging:bt(.25)}}}},{level:1,format:Dt.BULLET,text:"○",alignment:Tt.LEFT,style:{paragraph:{indent:{left:bt(1),hanging:bt(.25)}}}},{level:2,format:Dt.BULLET,text:"■",alignment:Tt.LEFT,style:{paragraph:{indent:{left:2160,hanging:bt(.25)}}}},{level:3,format:Dt.BULLET,text:"●",alignment:Tt.LEFT,style:{paragraph:{indent:{left:2880,hanging:bt(.25)}}}},{level:4,format:Dt.BULLET,text:"○",alignment:Tt.LEFT,style:{paragraph:{indent:{left:3600,hanging:bt(.25)}}}},{level:5,format:Dt.BULLET,text:"■",alignment:Tt.LEFT,style:{paragraph:{indent:{left:4320,hanging:bt(.25)}}}},{level:6,format:Dt.BULLET,text:"●",alignment:Tt.LEFT,style:{paragraph:{indent:{left:5040,hanging:bt(.25)}}}},{level:7,format:Dt.BULLET,text:"●",alignment:Tt.LEFT,style:{paragraph:{indent:{left:5760,hanging:bt(.25)}}}},{level:8,format:Dt.BULLET,text:"●",alignment:Tt.LEFT,style:{paragraph:{indent:{left:6480,hanging:bt(.25)}}}}]);this.concreteNumberingMap.set("default-bullet-numbering",new Po({numId:1,abstractNumId:t.id,reference:"default-bullet-numbering",instance:0,overrideLevels:[{num:0,start:1}]})),this.abstractNumberingMap.set("default-bullet-numbering",t);for(const s of e.config)this.abstractNumberingMap.set(s.reference,new Lo(this.abstractNumUniqueNumericId(),s.levels)),this.referenceConfigMap.set(s.reference,s.levels)}prepForXml(e){for(const t of this.abstractNumberingMap.values())this.root.push(t);for(const t of this.concreteNumberingMap.values())this.root.push(t);return super.prepForXml(e)}createConcreteNumberingInstance(e,t){const s=this.abstractNumberingMap.get(e);if(!s)return;const l=`${e}-${t}`;if(this.concreteNumberingMap.has(l))return;const i=this.referenceConfigMap.get(e),c=i&&i[0].start,n={numId:this.concreteNumUniqueNumericId(),abstractNumId:s.id,reference:e,instance:t,overrideLevels:[c&&Number.isInteger(c)?{num:0,start:c}:{num:0,start:1}]};this.concreteNumberingMap.set(l,new Po(n))}get ConcreteNumbering(){return Array.from(this.concreteNumberingMap.values())}get ReferenceConfig(){return Array.from(this.referenceConfigMap.values())}}class hf extends Fe{constructor(){super(...arguments),ge(this,"xmlKeys",{version:"w:val",name:"w:name",uri:"w:uri"})}}class df extends ve{constructor(e){super("w:compatSetting"),this.root.push(new hf({version:e,uri:"http://schemas.microsoft.com/office/word",name:"compatibilityMode"}))}}class pf extends ve{constructor(e){super("w:compat"),e.version&&this.root.push(new df(e.version)),e.useSingleBorderforContiguousCells&&this.root.push(new _e("w:useSingleBorderforContiguousCells",e.useSingleBorderforContiguousCells)),e.wordPerfectJustification&&this.root.push(new _e("w:wpJustification",e.wordPerfectJustification)),e.noTabStopForHangingIndent&&this.root.push(new _e("w:noTabHangInd",e.noTabStopForHangingIndent)),e.noLeading&&this.root.push(new _e("w:noLeading",e.noLeading)),e.spaceForUnderline&&this.root.push(new _e("w:spaceForUL",e.spaceForUnderline)),e.noColumnBalance&&this.root.push(new _e("w:noColumnBalance",e.noColumnBalance)),e.balanceSingleByteDoubleByteWidth&&this.root.push(new _e("w:balanceSingleByteDoubleByteWidth",e.balanceSingleByteDoubleByteWidth)),e.noExtraLineSpacing&&this.root.push(new _e("w:noExtraLineSpacing",e.noExtraLineSpacing)),e.doNotLeaveBackslashAlone&&this.root.push(new _e("w:doNotLeaveBackslashAlone",e.doNotLeaveBackslashAlone)),e.underlineTrailingSpaces&&this.root.push(new _e("w:ulTrailSpace",e.underlineTrailingSpaces)),e.doNotExpandShiftReturn&&this.root.push(new _e("w:doNotExpandShiftReturn",e.doNotExpandShiftReturn)),e.spacingInWholePoints&&this.root.push(new _e("w:spacingInWholePoints",e.spacingInWholePoints)),e.lineWrapLikeWord6&&this.root.push(new _e("w:lineWrapLikeWord6",e.lineWrapLikeWord6)),e.printBodyTextBeforeHeader&&this.root.push(new _e("w:printBodyTextBeforeHeader",e.printBodyTextBeforeHeader)),e.printColorsBlack&&this.root.push(new _e("w:printColBlack",e.printColorsBlack)),e.spaceWidth&&this.root.push(new _e("w:wpSpaceWidth",e.spaceWidth)),e.showBreaksInFrames&&this.root.push(new _e("w:showBreaksInFrames",e.showBreaksInFrames)),e.subFontBySize&&this.root.push(new _e("w:subFontBySize",e.subFontBySize)),e.suppressBottomSpacing&&this.root.push(new _e("w:suppressBottomSpacing",e.suppressBottomSpacing)),e.suppressTopSpacing&&this.root.push(new _e("w:suppressTopSpacing",e.suppressTopSpacing)),e.suppressSpacingAtTopOfPage&&this.root.push(new _e("w:suppressSpacingAtTopOfPage",e.suppressSpacingAtTopOfPage)),e.suppressTopSpacingWP&&this.root.push(new _e("w:suppressTopSpacingWP",e.suppressTopSpacingWP)),e.suppressSpBfAfterPgBrk&&this.root.push(new _e("w:suppressSpBfAfterPgBrk",e.suppressSpBfAfterPgBrk)),e.swapBordersFacingPages&&this.root.push(new _e("w:swapBordersFacingPages",e.swapBordersFacingPages)),e.convertMailMergeEsc&&this.root.push(new _e("w:convMailMergeEsc",e.convertMailMergeEsc)),e.truncateFontHeightsLikeWP6&&this.root.push(new _e("w:truncateFontHeightsLikeWP6",e.truncateFontHeightsLikeWP6)),e.macWordSmallCaps&&this.root.push(new _e("w:mwSmallCaps",e.macWordSmallCaps)),e.usePrinterMetrics&&this.root.push(new _e("w:usePrinterMetrics",e.usePrinterMetrics)),e.doNotSuppressParagraphBorders&&this.root.push(new _e("w:doNotSuppressParagraphBorders",e.doNotSuppressParagraphBorders)),e.wrapTrailSpaces&&this.root.push(new _e("w:wrapTrailSpaces",e.wrapTrailSpaces)),e.footnoteLayoutLikeWW8&&this.root.push(new _e("w:footnoteLayoutLikeWW8",e.footnoteLayoutLikeWW8)),e.shapeLayoutLikeWW8&&this.root.push(new _e("w:shapeLayoutLikeWW8",e.shapeLayoutLikeWW8)),e.alignTablesRowByRow&&this.root.push(new _e("w:alignTablesRowByRow",e.alignTablesRowByRow)),e.forgetLastTabAlignment&&this.root.push(new _e("w:forgetLastTabAlignment",e.forgetLastTabAlignment)),e.adjustLineHeightInTable&&this.root.push(new _e("w:adjustLineHeightInTable",e.adjustLineHeightInTable)),e.autoSpaceLikeWord95&&this.root.push(new _e("w:autoSpaceLikeWord95",e.autoSpaceLikeWord95)),e.noSpaceRaiseLower&&this.root.push(new _e("w:noSpaceRaiseLower",e.noSpaceRaiseLower)),e.doNotUseHTMLParagraphAutoSpacing&&this.root.push(new _e("w:doNotUseHTMLParagraphAutoSpacing",e.doNotUseHTMLParagraphAutoSpacing)),e.layoutRawTableWidth&&this.root.push(new _e("w:layoutRawTableWidth",e.layoutRawTableWidth)),e.layoutTableRowsApart&&this.root.push(new _e("w:layoutTableRowsApart",e.layoutTableRowsApart)),e.useWord97LineBreakRules&&this.root.push(new _e("w:useWord97LineBreakRules",e.useWord97LineBreakRules)),e.doNotBreakWrappedTables&&this.root.push(new _e("w:doNotBreakWrappedTables",e.doNotBreakWrappedTables)),e.doNotSnapToGridInCell&&this.root.push(new _e("w:doNotSnapToGridInCell",e.doNotSnapToGridInCell)),e.selectFieldWithFirstOrLastCharacter&&this.root.push(new _e("w:selectFldWithFirstOrLastChar",e.selectFieldWithFirstOrLastCharacter)),e.applyBreakingRules&&this.root.push(new _e("w:applyBreakingRules",e.applyBreakingRules)),e.doNotWrapTextWithPunctuation&&this.root.push(new _e("w:doNotWrapTextWithPunct",e.doNotWrapTextWithPunctuation)),e.doNotUseEastAsianBreakRules&&this.root.push(new _e("w:doNotUseEastAsianBreakRules",e.doNotUseEastAsianBreakRules)),e.useWord2002TableStyleRules&&this.root.push(new _e("w:useWord2002TableStyleRules",e.useWord2002TableStyleRules)),e.growAutofit&&this.root.push(new _e("w:growAutofit",e.growAutofit)),e.useFELayout&&this.root.push(new _e("w:useFELayout",e.useFELayout)),e.useNormalStyleForList&&this.root.push(new _e("w:useNormalStyleForList",e.useNormalStyleForList)),e.doNotUseIndentAsNumberingTabStop&&this.root.push(new _e("w:doNotUseIndentAsNumberingTabStop",e.doNotUseIndentAsNumberingTabStop)),e.useAlternateEastAsianLineBreakRules&&this.root.push(new _e("w:useAltKinsokuLineBreakRules",e.useAlternateEastAsianLineBreakRules)),e.allowSpaceOfSameStyleInTable&&this.root.push(new _e("w:allowSpaceOfSameStyleInTable",e.allowSpaceOfSameStyleInTable)),e.doNotSuppressIndentation&&this.root.push(new _e("w:doNotSuppressIndentation",e.doNotSuppressIndentation)),e.doNotAutofitConstrainedTables&&this.root.push(new _e("w:doNotAutofitConstrainedTables",e.doNotAutofitConstrainedTables)),e.autofitToFirstFixedWidthCell&&this.root.push(new _e("w:autofitToFirstFixedWidthCell",e.autofitToFirstFixedWidthCell)),e.underlineTabInNumberingList&&this.root.push(new _e("w:underlineTabInNumList",e.underlineTabInNumberingList)),e.displayHangulFixedWidth&&this.root.push(new _e("w:displayHangulFixedWidth",e.displayHangulFixedWidth)),e.splitPgBreakAndParaMark&&this.root.push(new _e("w:splitPgBreakAndParaMark",e.splitPgBreakAndParaMark)),e.doNotVerticallyAlignCellWithSp&&this.root.push(new _e("w:doNotVertAlignCellWithSp",e.doNotVerticallyAlignCellWithSp)),e.doNotBreakConstrainedForcedTable&&this.root.push(new _e("w:doNotBreakConstrainedForcedTable",e.doNotBreakConstrainedForcedTable)),e.ignoreVerticalAlignmentInTextboxes&&this.root.push(new _e("w:doNotVertAlignInTxbx",e.ignoreVerticalAlignmentInTextboxes)),e.useAnsiKerningPairs&&this.root.push(new _e("w:useAnsiKerningPairs",e.useAnsiKerningPairs)),e.cachedColumnBalance&&this.root.push(new _e("w:cachedColBalance",e.cachedColumnBalance))}}class mf extends Fe{constructor(){super(...arguments),ge(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",Ignorable:"mc:Ignorable"})}}class gf extends ve{constructor(e){var t,s,l,i;super("w:settings"),this.root.push(new mf({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",Ignorable:"w14 w15 wp14"})),this.root.push(new _e("w:displayBackgroundShape",!0)),e.trackRevisions!==void 0&&this.root.push(new _e("w:trackRevisions",e.trackRevisions)),e.evenAndOddHeaders!==void 0&&this.root.push(new _e("w:evenAndOddHeaders",e.evenAndOddHeaders)),e.updateFields!==void 0&&this.root.push(new _e("w:updateFields",e.updateFields)),e.defaultTabStop!==void 0&&this.root.push(new Ti("w:defaultTabStop",e.defaultTabStop)),this.root.push(new pf(Tr(ze({},(t=e.compatibility)!=null?t:{}),{version:(i=(l=(s=e.compatibility)==null?void 0:s.version)!=null?l:e.compatibilityModeVersion)!=null?i:15})))}}class ta extends Fe{constructor(){super(...arguments),ge(this,"xmlKeys",{val:"w:val"})}}class wf extends ve{constructor(e){super("w:name"),this.root.push(new ta({val:e}))}}class yf extends ve{constructor(e){super("w:uiPriority"),this.root.push(new ta({val:pt(e)}))}}class vf extends Fe{constructor(){super(...arguments),ge(this,"xmlKeys",{type:"w:type",styleId:"w:styleId",default:"w:default",customStyle:"w:customStyle"})}}class ra extends ve{constructor(e,t){super("w:style"),this.root.push(new vf(e)),t.name&&this.root.push(new wf(t.name)),t.basedOn&&this.root.push(new er("w:basedOn",t.basedOn)),t.next&&this.root.push(new er("w:next",t.next)),t.link&&this.root.push(new er("w:link",t.link)),t.uiPriority!==void 0&&this.root.push(new yf(t.uiPriority)),t.semiHidden!==void 0&&this.root.push(new _e("w:semiHidden",t.semiHidden)),t.unhideWhenUsed!==void 0&&this.root.push(new _e("w:unhideWhenUsed",t.unhideWhenUsed)),t.quickFormat!==void 0&&this.root.push(new _e("w:qFormat",t.quickFormat))}}class rn extends ra{constructor(e){super({type:"paragraph",styleId:e.id},e),ge(this,"paragraphProperties"),ge(this,"runProperties"),this.paragraphProperties=new ar(e.paragraph),this.runProperties=new qt(e.run),this.root.push(this.paragraphProperties),this.root.push(this.runProperties)}}class nn extends ra{constructor(e){super({type:"character",styleId:e.id},ze({uiPriority:99,unhideWhenUsed:!0},e)),ge(this,"runProperties"),this.runProperties=new qt(e.run),this.root.push(this.runProperties)}}class Ut extends rn{constructor(e){super(ze({basedOn:"Normal",next:"Normal",quickFormat:!0},e))}}class bf extends Ut{constructor(e){super(ze({id:"Title",name:"Title"},e))}}class _f extends Ut{constructor(e){super(ze({id:"Heading1",name:"Heading 1"},e))}}class Ef extends Ut{constructor(e){super(ze({id:"Heading2",name:"Heading 2"},e))}}class xf extends Ut{constructor(e){super(ze({id:"Heading3",name:"Heading 3"},e))}}class Tf extends Ut{constructor(e){super(ze({id:"Heading4",name:"Heading 4"},e))}}class Af extends Ut{constructor(e){super(ze({id:"Heading5",name:"Heading 5"},e))}}class Sf extends Ut{constructor(e){super(ze({id:"Heading6",name:"Heading 6"},e))}}class kf extends Ut{constructor(e){super(ze({id:"Strong",name:"Strong"},e))}}class Cf extends rn{constructor(e){super(ze({id:"ListParagraph",name:"List Paragraph",basedOn:"Normal",quickFormat:!0},e))}}class If extends rn{constructor(e){super(ze({id:"FootnoteText",name:"footnote text",link:"FootnoteTextChar",basedOn:"Normal",uiPriority:99,semiHidden:!0,unhideWhenUsed:!0,paragraph:{spacing:{after:0,line:240,lineRule:ai.AUTO}},run:{size:20}},e))}}class Rf extends nn{constructor(e){super(ze({id:"FootnoteReference",name:"footnote reference",basedOn:"DefaultParagraphFont",semiHidden:!0,run:{superScript:!0}},e))}}class Nf extends nn{constructor(e){super(ze({id:"FootnoteTextChar",name:"Footnote Text Char",basedOn:"DefaultParagraphFont",link:"FootnoteText",semiHidden:!0,run:{size:20}},e))}}class Df extends nn{constructor(e){super(ze({id:"Hyperlink",name:"Hyperlink",basedOn:"DefaultParagraphFont",run:{color:"0563C1",underline:{type:Js.SINGLE}}},e))}}class li extends ve{constructor(e){if(super("w:styles"),e.initialStyles&&this.root.push(e.initialStyles),e.importedStyles)for(const t of e.importedStyles)this.root.push(t);if(e.paragraphStyles)for(const t of e.paragraphStyles)this.root.push(new rn(t));if(e.characterStyles)for(const t of e.characterStyles)this.root.push(new nn(t))}}class Of extends ve{constructor(e){super("w:pPrDefault"),this.root.push(new ar(e))}}class Bf extends ve{constructor(e){super("w:rPrDefault"),this.root.push(new qt(e))}}class Ff extends ve{constructor(e){super("w:docDefaults"),ge(this,"runPropertiesDefaults"),ge(this,"paragraphPropertiesDefaults"),this.runPropertiesDefaults=new Bf(e.run),this.paragraphPropertiesDefaults=new Of(e.paragraph),this.root.push(this.runPropertiesDefaults),this.root.push(this.paragraphPropertiesDefaults)}}class Lf{newInstance(e){const t=$s.xml2js(e,{compact:!1});let s;for(const c of t.elements||[])c.name==="w:styles"&&(s=c);if(s===void 0)throw new Error("can not find styles element");const l=s.elements||[];return new li({initialStyles:new Ul(s.attributes),importedStyles:l.map(c=>xi(c))})}}class Uo{newInstance(e={}){var t;return{initialStyles:new Cr({mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",Ignorable:"w14 w15"}),importedStyles:[new Ff((t=e.document)!=null?t:{}),new bf(ze({run:{size:56}},e.title)),new _f(ze({run:{color:"2E74B5",size:32}},e.heading1)),new Ef(ze({run:{color:"2E74B5",size:26}},e.heading2)),new xf(ze({run:{color:"1F4D78",size:24}},e.heading3)),new Tf(ze({run:{color:"2E74B5",italics:!0}},e.heading4)),new Af(ze({run:{color:"2E74B5"}},e.heading5)),new Sf(ze({run:{color:"1F4D78"}},e.heading6)),new kf(ze({run:{bold:!0}},e.strong)),new Cf(e.listParagraph||{}),new Df(e.hyperlink||{}),new Rf(e.footnoteReference||{}),new If(e.footnoteText||{}),new Nf(e.footnoteTextChar||{})]}}}const Mr=({id:r,fontKey:e,subsetted:t},s)=>new Pt({name:s,attributes:ze({id:{key:"r:id",value:r}},e?{fontKey:{key:"w:fontKey",value:`{${e}}`}}:{}),children:[...t?[new _e("w:subsetted",t)]:[]]}),Pf=({name:r,altName:e,panose1:t,charset:s,family:l,notTrueType:i,pitch:c,sig:n,embedRegular:u,embedBold:m,embedItalic:w,embedBoldItalic:b})=>new Pt({name:"w:font",attributes:{name:{key:"w:name",value:r}},children:[...e?[_r("w:altName",e)]:[],...t?[_r("w:panose1",t)]:[],...s?[_r("w:charset",s)]:[],...l?[_r("w:family",l)]:[],...i?[new _e("w:notTrueType",i)]:[],...c?[_r("w:pitch",c)]:[],...n?[new Pt({name:"w:sig",attributes:{usb0:{key:"w:usb0",value:n.usb0},usb1:{key:"w:usb1",value:n.usb1},usb2:{key:"w:usb2",value:n.usb2},usb3:{key:"w:usb3",value:n.usb3},csb0:{key:"w:csb0",value:n.csb0},csb1:{key:"w:csb1",value:n.csb1}}})]:[],...u?[Mr(u,"w:embedRegular")]:[],...m?[Mr(m,"w:embedBold")]:[],...w?[Mr(w,"w:embedItalic")]:[],...b?[Mr(b,"w:embedBoldItalic")]:[]]}),Uf=({name:r,index:e,fontKey:t,characterSet:s})=>Pf({name:r,sig:{usb0:"E0002AFF",usb1:"C000247B",usb2:"00000009",usb3:"00000000",csb0:"000001FF",csb1:"00000000"},charset:s,family:"auto",pitch:"variable",embedRegular:{fontKey:t,id:`rId${e}`}}),Mf=r=>new Pt({name:"w:fonts",attributes:{mc:{key:"xmlns:mc",value:"http://schemas.openxmlformats.org/markup-compatibility/2006"},r:{key:"xmlns:r",value:"http://schemas.openxmlformats.org/officeDocument/2006/relationships"},w:{key:"xmlns:w",value:"http://schemas.openxmlformats.org/wordprocessingml/2006/main"},w14:{key:"xmlns:w14",value:"http://schemas.microsoft.com/office/word/2010/wordml"},w15:{key:"xmlns:w15",value:"http://schemas.microsoft.com/office/word/2012/wordml"},w16cex:{key:"xmlns:w16cex",value:"http://schemas.microsoft.com/office/word/2018/wordml/cex"},w16cid:{key:"xmlns:w16cid",value:"http://schemas.microsoft.com/office/word/2016/wordml/cid"},w16:{key:"xmlns:w16",value:"http://schemas.microsoft.com/office/word/2018/wordml"},w16sdtdh:{key:"xmlns:w16sdtdh",value:"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash"},w16se:{key:"xmlns:w16se",value:"http://schemas.microsoft.com/office/word/2015/wordml/symex"},Ignorable:{key:"mc:Ignorable",value:"w14 w15 w16se w16cid w16 w16cex w16sdtdh"}},children:r.map((e,t)=>Uf({name:e.name,index:t+1,fontKey:e.fontKey}))});class jf{constructor(e){ge(this,"fontTable"),ge(this,"relationships"),ge(this,"fontOptionsWithKey",[]),this.options=e,this.fontOptionsWithKey=e.map(t=>Tr(ze({},t),{fontKey:_c()})),this.fontTable=Mf(this.fontOptionsWithKey),this.relationships=new gr;for(let t=0;t<e.length;t++)this.relationships.createRelationship(t+1,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/font",`fonts/${e[t].name}.odttf`)}get View(){return this.fontTable}get Relationships(){return this.relationships}}class zf{constructor(e){ge(this,"currentRelationshipId",1),ge(this,"documentWrapper"),ge(this,"headers",[]),ge(this,"footers",[]),ge(this,"coreProperties"),ge(this,"numbering"),ge(this,"media"),ge(this,"fileRelationships"),ge(this,"footnotesWrapper"),ge(this,"settings"),ge(this,"contentTypes"),ge(this,"customProperties"),ge(this,"appProperties"),ge(this,"styles"),ge(this,"comments"),ge(this,"fontWrapper");var t,s,l,i,c,n,u,m;if(this.coreProperties=new Au(Tr(ze({},e),{creator:(t=e.creator)!=null?t:"Un-named",revision:(s=e.revision)!=null?s:1,lastModifiedBy:(l=e.lastModifiedBy)!=null?l:"Un-named"})),this.numbering=new ff(e.numbering?e.numbering:{config:[]}),this.comments=new Ac((i=e.comments)!=null?i:{children:[]}),this.fileRelationships=new gr,this.customProperties=new Ru((c=e.customProperties)!=null?c:[]),this.appProperties=new bu,this.footnotesWrapper=new Wu,this.contentTypes=new Tu,this.documentWrapper=new ea({background:e.background}),this.settings=new gf({compatibilityModeVersion:e.compatabilityModeVersion,compatibility:e.compatibility,evenAndOddHeaders:!!e.evenAndOddHeaderAndFooters,trackRevisions:(n=e.features)==null?void 0:n.trackRevisions,updateFields:(u=e.features)==null?void 0:u.updateFields,defaultTabStop:e.defaultTabStop}),this.media=new Ku,e.externalStyles){const w=new Lf;this.styles=w.newInstance(e.externalStyles)}else if(e.styles){const b=new Uo().newInstance(e.styles.default);this.styles=new li(ze(ze({},b),e.styles))}else{const w=new Uo;this.styles=new li(w.newInstance())}this.addDefaultRelationships();for(const w of e.sections)this.addSection(w);if(e.footnotes)for(const w in e.footnotes)this.footnotesWrapper.View.createFootNote(parseFloat(w),e.footnotes[w].children);this.fontWrapper=new jf((m=e.fonts)!=null?m:[])}addSection({headers:e={},footers:t={},children:s,properties:l}){this.documentWrapper.View.Body.addSection(Tr(ze({},l),{headerWrapperGroup:{default:e.default?this.createHeader(e.default):void 0,first:e.first?this.createHeader(e.first):void 0,even:e.even?this.createHeader(e.even):void 0},footerWrapperGroup:{default:t.default?this.createFooter(t.default):void 0,first:t.first?this.createFooter(t.first):void 0,even:t.even?this.createFooter(t.even):void 0}}));for(const i of s)this.documentWrapper.View.add(i)}createHeader(e){const t=new Vu(this.media,this.currentRelationshipId++);for(const s of e.options.children)t.add(s);return this.addHeaderToDocument(t),t}createFooter(e){const t=new Ou(this.media,this.currentRelationshipId++);for(const s of e.options.children)t.add(s);return this.addFooterToDocument(t),t}addHeaderToDocument(e,t=tr.DEFAULT){this.headers.push({header:e,type:t}),this.documentWrapper.Relationships.createRelationship(e.View.ReferenceId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/header",`header${this.headers.length}.xml`),this.contentTypes.addHeader(this.headers.length)}addFooterToDocument(e,t=tr.DEFAULT){this.footers.push({footer:e,type:t}),this.documentWrapper.Relationships.createRelationship(e.View.ReferenceId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer",`footer${this.footers.length}.xml`),this.contentTypes.addFooter(this.footers.length)}addDefaultRelationships(){this.fileRelationships.createRelationship(1,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument","word/document.xml"),this.fileRelationships.createRelationship(2,"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties","docProps/core.xml"),this.fileRelationships.createRelationship(3,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties","docProps/app.xml"),this.fileRelationships.createRelationship(4,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties","docProps/custom.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles","styles.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/numbering","numbering.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes","footnotes.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings","settings.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments","comments.xml")}get Document(){return this.documentWrapper}get Styles(){return this.styles}get CoreProperties(){return this.coreProperties}get Numbering(){return this.numbering}get Media(){return this.media}get FileRelationships(){return this.fileRelationships}get Headers(){return this.headers.map(e=>e.header)}get Footers(){return this.footers.map(e=>e.footer)}get ContentTypes(){return this.contentTypes}get CustomProperties(){return this.customProperties}get AppProperties(){return this.appProperties}get FootNotes(){return this.footnotesWrapper}get Settings(){return this.settings}get Comments(){return this.comments}get FontTable(){return this.fontWrapper}}function jr(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var na={exports:{}};(function(r,e){(function(t){r.exports=t()})(function(){return function t(s,l,i){function c(m,w){if(!l[m]){if(!s[m]){var b=typeof jr=="function"&&jr;if(!w&&b)return b(m,!0);if(n)return n(m,!0);var T=new Error("Cannot find module '"+m+"'");throw T.code="MODULE_NOT_FOUND",T}var p=l[m]={exports:{}};s[m][0].call(p.exports,function(S){var y=s[m][1][S];return c(y||S)},p,p.exports,t,s,l,i)}return l[m].exports}for(var n=typeof jr=="function"&&jr,u=0;u<i.length;u++)c(i[u]);return c}({1:[function(t,s,l){var i=t("./utils"),c=t("./support"),n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";l.encode=function(u){for(var m,w,b,T,p,S,y,_=[],f=0,x=u.length,k=x,C=i.getTypeOf(u)!=="string";f<u.length;)k=x-f,b=C?(m=u[f++],w=f<x?u[f++]:0,f<x?u[f++]:0):(m=u.charCodeAt(f++),w=f<x?u.charCodeAt(f++):0,f<x?u.charCodeAt(f++):0),T=m>>2,p=(3&m)<<4|w>>4,S=1<k?(15&w)<<2|b>>6:64,y=2<k?63&b:64,_.push(n.charAt(T)+n.charAt(p)+n.charAt(S)+n.charAt(y));return _.join("")},l.decode=function(u){var m,w,b,T,p,S,y=0,_=0,f="data:";if(u.substr(0,f.length)===f)throw new Error("Invalid base64 input, it looks like a data url.");var x,k=3*(u=u.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(u.charAt(u.length-1)===n.charAt(64)&&k--,u.charAt(u.length-2)===n.charAt(64)&&k--,k%1!=0)throw new Error("Invalid base64 input, bad content length.");for(x=c.uint8array?new Uint8Array(0|k):new Array(0|k);y<u.length;)m=n.indexOf(u.charAt(y++))<<2|(T=n.indexOf(u.charAt(y++)))>>4,w=(15&T)<<4|(p=n.indexOf(u.charAt(y++)))>>2,b=(3&p)<<6|(S=n.indexOf(u.charAt(y++))),x[_++]=m,p!==64&&(x[_++]=w),S!==64&&(x[_++]=b);return x}},{"./support":30,"./utils":32}],2:[function(t,s,l){var i=t("./external"),c=t("./stream/DataWorker"),n=t("./stream/Crc32Probe"),u=t("./stream/DataLengthProbe");function m(w,b,T,p,S){this.compressedSize=w,this.uncompressedSize=b,this.crc32=T,this.compression=p,this.compressedContent=S}m.prototype={getContentWorker:function(){var w=new c(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new u("data_length")),b=this;return w.on("end",function(){if(this.streamInfo.data_length!==b.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),w},getCompressedWorker:function(){return new c(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},m.createWorkerFrom=function(w,b,T){return w.pipe(new n).pipe(new u("uncompressedSize")).pipe(b.compressWorker(T)).pipe(new u("compressedSize")).withStreamInfo("compression",b)},s.exports=m},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,s,l){var i=t("./stream/GenericWorker");l.STORE={magic:"\0\0",compressWorker:function(){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},l.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,s,l){var i=t("./utils"),c=function(){for(var n,u=[],m=0;m<256;m++){n=m;for(var w=0;w<8;w++)n=1&n?3988292384^n>>>1:n>>>1;u[m]=n}return u}();s.exports=function(n,u){return n!==void 0&&n.length?i.getTypeOf(n)!=="string"?function(m,w,b,T){var p=c,S=T+b;m^=-1;for(var y=T;y<S;y++)m=m>>>8^p[255&(m^w[y])];return-1^m}(0|u,n,n.length,0):function(m,w,b,T){var p=c,S=T+b;m^=-1;for(var y=T;y<S;y++)m=m>>>8^p[255&(m^w.charCodeAt(y))];return-1^m}(0|u,n,n.length,0):0}},{"./utils":32}],5:[function(t,s,l){l.base64=!1,l.binary=!1,l.dir=!1,l.createFolders=!0,l.date=null,l.compression=null,l.compressionOptions=null,l.comment=null,l.unixPermissions=null,l.dosPermissions=null},{}],6:[function(t,s,l){var i=null;i=typeof Promise<"u"?Promise:t("lie"),s.exports={Promise:i}},{lie:37}],7:[function(t,s,l){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",c=t("pako"),n=t("./utils"),u=t("./stream/GenericWorker"),m=i?"uint8array":"array";function w(b,T){u.call(this,"FlateWorker/"+b),this._pako=null,this._pakoAction=b,this._pakoOptions=T,this.meta={}}l.magic="\b\0",n.inherits(w,u),w.prototype.processChunk=function(b){this.meta=b.meta,this._pako===null&&this._createPako(),this._pako.push(n.transformTo(m,b.data),!1)},w.prototype.flush=function(){u.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},w.prototype.cleanUp=function(){u.prototype.cleanUp.call(this),this._pako=null},w.prototype._createPako=function(){this._pako=new c[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var b=this;this._pako.onData=function(T){b.push({data:T,meta:b.meta})}},l.compressWorker=function(b){return new w("Deflate",b)},l.uncompressWorker=function(){return new w("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,s,l){function i(p,S){var y,_="";for(y=0;y<S;y++)_+=String.fromCharCode(255&p),p>>>=8;return _}function c(p,S,y,_,f,x){var k,C,D=p.file,q=p.compression,M=x!==m.utf8encode,J=n.transformTo("string",x(D.name)),I=n.transformTo("string",m.utf8encode(D.name)),ue=D.comment,ee=n.transformTo("string",x(ue)),B=n.transformTo("string",m.utf8encode(ue)),W=I.length!==D.name.length,A=B.length!==ue.length,z="",se="",V="",ye=D.dir,Z=D.date,re={crc32:0,compressedSize:0,uncompressedSize:0};S&&!y||(re.crc32=p.crc32,re.compressedSize=p.compressedSize,re.uncompressedSize=p.uncompressedSize);var j=0;S&&(j|=8),M||!W&&!A||(j|=2048);var R=0,K=0;ye&&(R|=16),f==="UNIX"?(K=798,R|=function(oe,H){var v=oe;return oe||(v=H?16893:33204),(65535&v)<<16}(D.unixPermissions,ye)):(K=20,R|=function(oe){return 63&(oe||0)}(D.dosPermissions)),k=Z.getUTCHours(),k<<=6,k|=Z.getUTCMinutes(),k<<=5,k|=Z.getUTCSeconds()/2,C=Z.getUTCFullYear()-1980,C<<=4,C|=Z.getUTCMonth()+1,C<<=5,C|=Z.getUTCDate(),W&&(se=i(1,1)+i(w(J),4)+I,z+="up"+i(se.length,2)+se),A&&(V=i(1,1)+i(w(ee),4)+B,z+="uc"+i(V.length,2)+V);var X="";return X+=`
\0`,X+=i(j,2),X+=q.magic,X+=i(k,2),X+=i(C,2),X+=i(re.crc32,4),X+=i(re.compressedSize,4),X+=i(re.uncompressedSize,4),X+=i(J.length,2),X+=i(z.length,2),{fileRecord:b.LOCAL_FILE_HEADER+X+J+z,dirRecord:b.CENTRAL_FILE_HEADER+i(K,2)+X+i(ee.length,2)+"\0\0\0\0"+i(R,4)+i(_,4)+J+z+ee}}var n=t("../utils"),u=t("../stream/GenericWorker"),m=t("../utf8"),w=t("../crc32"),b=t("../signature");function T(p,S,y,_){u.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=S,this.zipPlatform=y,this.encodeFileName=_,this.streamFiles=p,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}n.inherits(T,u),T.prototype.push=function(p){var S=p.meta.percent||0,y=this.entriesCount,_=this._sources.length;this.accumulate?this.contentBuffer.push(p):(this.bytesWritten+=p.data.length,u.prototype.push.call(this,{data:p.data,meta:{currentFile:this.currentFile,percent:y?(S+100*(y-_-1))/y:100}}))},T.prototype.openedSource=function(p){this.currentSourceOffset=this.bytesWritten,this.currentFile=p.file.name;var S=this.streamFiles&&!p.file.dir;if(S){var y=c(p,S,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:y.fileRecord,meta:{percent:0}})}else this.accumulate=!0},T.prototype.closedSource=function(p){this.accumulate=!1;var S=this.streamFiles&&!p.file.dir,y=c(p,S,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(y.dirRecord),S)this.push({data:function(_){return b.DATA_DESCRIPTOR+i(_.crc32,4)+i(_.compressedSize,4)+i(_.uncompressedSize,4)}(p),meta:{percent:100}});else for(this.push({data:y.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},T.prototype.flush=function(){for(var p=this.bytesWritten,S=0;S<this.dirRecords.length;S++)this.push({data:this.dirRecords[S],meta:{percent:100}});var y=this.bytesWritten-p,_=function(f,x,k,C,D){var q=n.transformTo("string",D(C));return b.CENTRAL_DIRECTORY_END+"\0\0\0\0"+i(f,2)+i(f,2)+i(x,4)+i(k,4)+i(q.length,2)+q}(this.dirRecords.length,y,p,this.zipComment,this.encodeFileName);this.push({data:_,meta:{percent:100}})},T.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},T.prototype.registerPrevious=function(p){this._sources.push(p);var S=this;return p.on("data",function(y){S.processChunk(y)}),p.on("end",function(){S.closedSource(S.previous.streamInfo),S._sources.length?S.prepareNextSource():S.end()}),p.on("error",function(y){S.error(y)}),this},T.prototype.resume=function(){return!!u.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},T.prototype.error=function(p){var S=this._sources;if(!u.prototype.error.call(this,p))return!1;for(var y=0;y<S.length;y++)try{S[y].error(p)}catch{}return!0},T.prototype.lock=function(){u.prototype.lock.call(this);for(var p=this._sources,S=0;S<p.length;S++)p[S].lock()},s.exports=T},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,s,l){var i=t("../compressions"),c=t("./ZipFileWorker");l.generateWorker=function(n,u,m){var w=new c(u.streamFiles,m,u.platform,u.encodeFileName),b=0;try{n.forEach(function(T,p){b++;var S=function(x,k){var C=x||k,D=i[C];if(!D)throw new Error(C+" is not a valid compression method !");return D}(p.options.compression,u.compression),y=p.options.compressionOptions||u.compressionOptions||{},_=p.dir,f=p.date;p._compressWorker(S,y).withStreamInfo("file",{name:T,dir:_,date:f,comment:p.comment||"",unixPermissions:p.unixPermissions,dosPermissions:p.dosPermissions}).pipe(w)}),w.entriesCount=b}catch(T){w.error(T)}return w}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,s,l){function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var c=new i;for(var n in this)typeof this[n]!="function"&&(c[n]=this[n]);return c}}(i.prototype=t("./object")).loadAsync=t("./load"),i.support=t("./support"),i.defaults=t("./defaults"),i.version="3.10.1",i.loadAsync=function(c,n){return new i().loadAsync(c,n)},i.external=t("./external"),s.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,s,l){var i=t("./utils"),c=t("./external"),n=t("./utf8"),u=t("./zipEntries"),m=t("./stream/Crc32Probe"),w=t("./nodejsUtils");function b(T){return new c.Promise(function(p,S){var y=T.decompressed.getContentWorker().pipe(new m);y.on("error",function(_){S(_)}).on("end",function(){y.streamInfo.crc32!==T.decompressed.crc32?S(new Error("Corrupted zip : CRC32 mismatch")):p()}).resume()})}s.exports=function(T,p){var S=this;return p=i.extend(p||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:n.utf8decode}),w.isNode&&w.isStream(T)?c.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",T,!0,p.optimizedBinaryString,p.base64).then(function(y){var _=new u(p);return _.load(y),_}).then(function(y){var _=[c.Promise.resolve(y)],f=y.files;if(p.checkCRC32)for(var x=0;x<f.length;x++)_.push(b(f[x]));return c.Promise.all(_)}).then(function(y){for(var _=y.shift(),f=_.files,x=0;x<f.length;x++){var k=f[x],C=k.fileNameStr,D=i.resolve(k.fileNameStr);S.file(D,k.decompressed,{binary:!0,optimizedBinaryString:!0,date:k.date,dir:k.dir,comment:k.fileCommentStr.length?k.fileCommentStr:null,unixPermissions:k.unixPermissions,dosPermissions:k.dosPermissions,createFolders:p.createFolders}),k.dir||(S.file(D).unsafeOriginalName=C)}return _.zipComment.length&&(S.comment=_.zipComment),S})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,s,l){var i=t("../utils"),c=t("../stream/GenericWorker");function n(u,m){c.call(this,"Nodejs stream input adapter for "+u),this._upstreamEnded=!1,this._bindStream(m)}i.inherits(n,c),n.prototype._bindStream=function(u){var m=this;(this._stream=u).pause(),u.on("data",function(w){m.push({data:w,meta:{percent:0}})}).on("error",function(w){m.isPaused?this.generatedError=w:m.error(w)}).on("end",function(){m.isPaused?m._upstreamEnded=!0:m.end()})},n.prototype.pause=function(){return!!c.prototype.pause.call(this)&&(this._stream.pause(),!0)},n.prototype.resume=function(){return!!c.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},s.exports=n},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,s,l){var i=t("readable-stream").Readable;function c(n,u,m){i.call(this,u),this._helper=n;var w=this;n.on("data",function(b,T){w.push(b)||w._helper.pause(),m&&m(T)}).on("error",function(b){w.emit("error",b)}).on("end",function(){w.push(null)})}t("../utils").inherits(c,i),c.prototype._read=function(){this._helper.resume()},s.exports=c},{"../utils":32,"readable-stream":16}],14:[function(t,s,l){s.exports={isNode:typeof Buffer<"u",newBufferFrom:function(i,c){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(i,c);if(typeof i=="number")throw new Error('The "data" argument must not be a number');return new Buffer(i,c)},allocBuffer:function(i){if(Buffer.alloc)return Buffer.alloc(i);var c=new Buffer(i);return c.fill(0),c},isBuffer:function(i){return Buffer.isBuffer(i)},isStream:function(i){return i&&typeof i.on=="function"&&typeof i.pause=="function"&&typeof i.resume=="function"}}},{}],15:[function(t,s,l){function i(D,q,M){var J,I=n.getTypeOf(q),ue=n.extend(M||{},w);ue.date=ue.date||new Date,ue.compression!==null&&(ue.compression=ue.compression.toUpperCase()),typeof ue.unixPermissions=="string"&&(ue.unixPermissions=parseInt(ue.unixPermissions,8)),ue.unixPermissions&&16384&ue.unixPermissions&&(ue.dir=!0),ue.dosPermissions&&16&ue.dosPermissions&&(ue.dir=!0),ue.dir&&(D=f(D)),ue.createFolders&&(J=_(D))&&x.call(this,J,!0);var ee=I==="string"&&ue.binary===!1&&ue.base64===!1;M&&M.binary!==void 0||(ue.binary=!ee),(q instanceof b&&q.uncompressedSize===0||ue.dir||!q||q.length===0)&&(ue.base64=!1,ue.binary=!0,q="",ue.compression="STORE",I="string");var B=null;B=q instanceof b||q instanceof u?q:S.isNode&&S.isStream(q)?new y(D,q):n.prepareContent(D,q,ue.binary,ue.optimizedBinaryString,ue.base64);var W=new T(D,B,ue);this.files[D]=W}var c=t("./utf8"),n=t("./utils"),u=t("./stream/GenericWorker"),m=t("./stream/StreamHelper"),w=t("./defaults"),b=t("./compressedObject"),T=t("./zipObject"),p=t("./generate"),S=t("./nodejsUtils"),y=t("./nodejs/NodejsStreamInputAdapter"),_=function(D){D.slice(-1)==="/"&&(D=D.substring(0,D.length-1));var q=D.lastIndexOf("/");return 0<q?D.substring(0,q):""},f=function(D){return D.slice(-1)!=="/"&&(D+="/"),D},x=function(D,q){return q=q!==void 0?q:w.createFolders,D=f(D),this.files[D]||i.call(this,D,null,{dir:!0,createFolders:q}),this.files[D]};function k(D){return Object.prototype.toString.call(D)==="[object RegExp]"}var C={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(D){var q,M,J;for(q in this.files)J=this.files[q],(M=q.slice(this.root.length,q.length))&&q.slice(0,this.root.length)===this.root&&D(M,J)},filter:function(D){var q=[];return this.forEach(function(M,J){D(M,J)&&q.push(J)}),q},file:function(D,q,M){if(arguments.length!==1)return D=this.root+D,i.call(this,D,q,M),this;if(k(D)){var J=D;return this.filter(function(ue,ee){return!ee.dir&&J.test(ue)})}var I=this.files[this.root+D];return I&&!I.dir?I:null},folder:function(D){if(!D)return this;if(k(D))return this.filter(function(I,ue){return ue.dir&&D.test(I)});var q=this.root+D,M=x.call(this,q),J=this.clone();return J.root=M.name,J},remove:function(D){D=this.root+D;var q=this.files[D];if(q||(D.slice(-1)!=="/"&&(D+="/"),q=this.files[D]),q&&!q.dir)delete this.files[D];else for(var M=this.filter(function(I,ue){return ue.name.slice(0,D.length)===D}),J=0;J<M.length;J++)delete this.files[M[J].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(D){var q,M={};try{if((M=n.extend(D||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:c.utf8encode})).type=M.type.toLowerCase(),M.compression=M.compression.toUpperCase(),M.type==="binarystring"&&(M.type="string"),!M.type)throw new Error("No output type specified.");n.checkSupport(M.type),M.platform!=="darwin"&&M.platform!=="freebsd"&&M.platform!=="linux"&&M.platform!=="sunos"||(M.platform="UNIX"),M.platform==="win32"&&(M.platform="DOS");var J=M.comment||this.comment||"";q=p.generateWorker(this,M,J)}catch(I){(q=new u("error")).error(I)}return new m(q,M.type||"string",M.mimeType)},generateAsync:function(D,q){return this.generateInternalStream(D).accumulate(q)},generateNodeStream:function(D,q){return(D=D||{}).type||(D.type="nodebuffer"),this.generateInternalStream(D).toNodejsStream(q)}};s.exports=C},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,s,l){s.exports=t("stream")},{stream:void 0}],17:[function(t,s,l){var i=t("./DataReader");function c(n){i.call(this,n);for(var u=0;u<this.data.length;u++)n[u]=255&n[u]}t("../utils").inherits(c,i),c.prototype.byteAt=function(n){return this.data[this.zero+n]},c.prototype.lastIndexOfSignature=function(n){for(var u=n.charCodeAt(0),m=n.charCodeAt(1),w=n.charCodeAt(2),b=n.charCodeAt(3),T=this.length-4;0<=T;--T)if(this.data[T]===u&&this.data[T+1]===m&&this.data[T+2]===w&&this.data[T+3]===b)return T-this.zero;return-1},c.prototype.readAndCheckSignature=function(n){var u=n.charCodeAt(0),m=n.charCodeAt(1),w=n.charCodeAt(2),b=n.charCodeAt(3),T=this.readData(4);return u===T[0]&&m===T[1]&&w===T[2]&&b===T[3]},c.prototype.readData=function(n){if(this.checkOffset(n),n===0)return[];var u=this.data.slice(this.zero+this.index,this.zero+this.index+n);return this.index+=n,u},s.exports=c},{"../utils":32,"./DataReader":18}],18:[function(t,s,l){var i=t("../utils");function c(n){this.data=n,this.length=n.length,this.index=0,this.zero=0}c.prototype={checkOffset:function(n){this.checkIndex(this.index+n)},checkIndex:function(n){if(this.length<this.zero+n||n<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+n+"). Corrupted zip ?")},setIndex:function(n){this.checkIndex(n),this.index=n},skip:function(n){this.setIndex(this.index+n)},byteAt:function(){},readInt:function(n){var u,m=0;for(this.checkOffset(n),u=this.index+n-1;u>=this.index;u--)m=(m<<8)+this.byteAt(u);return this.index+=n,m},readString:function(n){return i.transformTo("string",this.readData(n))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var n=this.readInt(4);return new Date(Date.UTC(1980+(n>>25&127),(n>>21&15)-1,n>>16&31,n>>11&31,n>>5&63,(31&n)<<1))}},s.exports=c},{"../utils":32}],19:[function(t,s,l){var i=t("./Uint8ArrayReader");function c(n){i.call(this,n)}t("../utils").inherits(c,i),c.prototype.readData=function(n){this.checkOffset(n);var u=this.data.slice(this.zero+this.index,this.zero+this.index+n);return this.index+=n,u},s.exports=c},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,s,l){var i=t("./DataReader");function c(n){i.call(this,n)}t("../utils").inherits(c,i),c.prototype.byteAt=function(n){return this.data.charCodeAt(this.zero+n)},c.prototype.lastIndexOfSignature=function(n){return this.data.lastIndexOf(n)-this.zero},c.prototype.readAndCheckSignature=function(n){return n===this.readData(4)},c.prototype.readData=function(n){this.checkOffset(n);var u=this.data.slice(this.zero+this.index,this.zero+this.index+n);return this.index+=n,u},s.exports=c},{"../utils":32,"./DataReader":18}],21:[function(t,s,l){var i=t("./ArrayReader");function c(n){i.call(this,n)}t("../utils").inherits(c,i),c.prototype.readData=function(n){if(this.checkOffset(n),n===0)return new Uint8Array(0);var u=this.data.subarray(this.zero+this.index,this.zero+this.index+n);return this.index+=n,u},s.exports=c},{"../utils":32,"./ArrayReader":17}],22:[function(t,s,l){var i=t("../utils"),c=t("../support"),n=t("./ArrayReader"),u=t("./StringReader"),m=t("./NodeBufferReader"),w=t("./Uint8ArrayReader");s.exports=function(b){var T=i.getTypeOf(b);return i.checkSupport(T),T!=="string"||c.uint8array?T==="nodebuffer"?new m(b):c.uint8array?new w(i.transformTo("uint8array",b)):new n(i.transformTo("array",b)):new u(b)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,s,l){l.LOCAL_FILE_HEADER="PK",l.CENTRAL_FILE_HEADER="PK",l.CENTRAL_DIRECTORY_END="PK",l.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",l.ZIP64_CENTRAL_DIRECTORY_END="PK",l.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,s,l){var i=t("./GenericWorker"),c=t("../utils");function n(u){i.call(this,"ConvertWorker to "+u),this.destType=u}c.inherits(n,i),n.prototype.processChunk=function(u){this.push({data:c.transformTo(this.destType,u.data),meta:u.meta})},s.exports=n},{"../utils":32,"./GenericWorker":28}],25:[function(t,s,l){var i=t("./GenericWorker"),c=t("../crc32");function n(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(n,i),n.prototype.processChunk=function(u){this.streamInfo.crc32=c(u.data,this.streamInfo.crc32||0),this.push(u)},s.exports=n},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,s,l){var i=t("../utils"),c=t("./GenericWorker");function n(u){c.call(this,"DataLengthProbe for "+u),this.propName=u,this.withStreamInfo(u,0)}i.inherits(n,c),n.prototype.processChunk=function(u){if(u){var m=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=m+u.data.length}c.prototype.processChunk.call(this,u)},s.exports=n},{"../utils":32,"./GenericWorker":28}],27:[function(t,s,l){var i=t("../utils"),c=t("./GenericWorker");function n(u){c.call(this,"DataWorker");var m=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,u.then(function(w){m.dataIsReady=!0,m.data=w,m.max=w&&w.length||0,m.type=i.getTypeOf(w),m.isPaused||m._tickAndRepeat()},function(w){m.error(w)})}i.inherits(n,c),n.prototype.cleanUp=function(){c.prototype.cleanUp.call(this),this.data=null},n.prototype.resume=function(){return!!c.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},n.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},n.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var u=null,m=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":u=this.data.substring(this.index,m);break;case"uint8array":u=this.data.subarray(this.index,m);break;case"array":case"nodebuffer":u=this.data.slice(this.index,m)}return this.index=m,this.push({data:u,meta:{percent:this.max?this.index/this.max*100:0}})},s.exports=n},{"../utils":32,"./GenericWorker":28}],28:[function(t,s,l){function i(c){this.name=c||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(c){this.emit("data",c)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(c){this.emit("error",c)}return!0},error:function(c){return!this.isFinished&&(this.isPaused?this.generatedError=c:(this.isFinished=!0,this.emit("error",c),this.previous&&this.previous.error(c),this.cleanUp()),!0)},on:function(c,n){return this._listeners[c].push(n),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(c,n){if(this._listeners[c])for(var u=0;u<this._listeners[c].length;u++)this._listeners[c][u].call(this,n)},pipe:function(c){return c.registerPrevious(this)},registerPrevious:function(c){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=c.streamInfo,this.mergeStreamInfo(),this.previous=c;var n=this;return c.on("data",function(u){n.processChunk(u)}),c.on("end",function(){n.end()}),c.on("error",function(u){n.error(u)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var c=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),c=!0),this.previous&&this.previous.resume(),!c},flush:function(){},processChunk:function(c){this.push(c)},withStreamInfo:function(c,n){return this.extraStreamInfo[c]=n,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var c in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,c)&&(this.streamInfo[c]=this.extraStreamInfo[c])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var c="Worker "+this.name;return this.previous?this.previous+" -> "+c:c}},s.exports=i},{}],29:[function(t,s,l){var i=t("../utils"),c=t("./ConvertWorker"),n=t("./GenericWorker"),u=t("../base64"),m=t("../support"),w=t("../external"),b=null;if(m.nodestream)try{b=t("../nodejs/NodejsStreamOutputAdapter")}catch{}function T(S,y){return new w.Promise(function(_,f){var x=[],k=S._internalType,C=S._outputType,D=S._mimeType;S.on("data",function(q,M){x.push(q),y&&y(M)}).on("error",function(q){x=[],f(q)}).on("end",function(){try{var q=function(M,J,I){switch(M){case"blob":return i.newBlob(i.transformTo("arraybuffer",J),I);case"base64":return u.encode(J);default:return i.transformTo(M,J)}}(C,function(M,J){var I,ue=0,ee=null,B=0;for(I=0;I<J.length;I++)B+=J[I].length;switch(M){case"string":return J.join("");case"array":return Array.prototype.concat.apply([],J);case"uint8array":for(ee=new Uint8Array(B),I=0;I<J.length;I++)ee.set(J[I],ue),ue+=J[I].length;return ee;case"nodebuffer":return Buffer.concat(J);default:throw new Error("concat : unsupported type '"+M+"'")}}(k,x),D);_(q)}catch(M){f(M)}x=[]}).resume()})}function p(S,y,_){var f=y;switch(y){case"blob":case"arraybuffer":f="uint8array";break;case"base64":f="string"}try{this._internalType=f,this._outputType=y,this._mimeType=_,i.checkSupport(f),this._worker=S.pipe(new c(f)),S.lock()}catch(x){this._worker=new n("error"),this._worker.error(x)}}p.prototype={accumulate:function(S){return T(this,S)},on:function(S,y){var _=this;return S==="data"?this._worker.on(S,function(f){y.call(_,f.data,f.meta)}):this._worker.on(S,function(){i.delay(y,arguments,_)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(S){if(i.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new b(this,{objectMode:this._outputType!=="nodebuffer"},S)}},s.exports=p},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,s,l){if(l.base64=!0,l.array=!0,l.string=!0,l.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",l.nodebuffer=typeof Buffer<"u",l.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")l.blob=!1;else{var i=new ArrayBuffer(0);try{l.blob=new Blob([i],{type:"application/zip"}).size===0}catch{try{var c=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);c.append(i),l.blob=c.getBlob("application/zip").size===0}catch{l.blob=!1}}}try{l.nodestream=!!t("readable-stream").Readable}catch{l.nodestream=!1}},{"readable-stream":16}],31:[function(t,s,l){for(var i=t("./utils"),c=t("./support"),n=t("./nodejsUtils"),u=t("./stream/GenericWorker"),m=new Array(256),w=0;w<256;w++)m[w]=252<=w?6:248<=w?5:240<=w?4:224<=w?3:192<=w?2:1;m[254]=m[254]=1;function b(){u.call(this,"utf-8 decode"),this.leftOver=null}function T(){u.call(this,"utf-8 encode")}l.utf8encode=function(p){return c.nodebuffer?n.newBufferFrom(p,"utf-8"):function(S){var y,_,f,x,k,C=S.length,D=0;for(x=0;x<C;x++)(64512&(_=S.charCodeAt(x)))==55296&&x+1<C&&(64512&(f=S.charCodeAt(x+1)))==56320&&(_=65536+(_-55296<<10)+(f-56320),x++),D+=_<128?1:_<2048?2:_<65536?3:4;for(y=c.uint8array?new Uint8Array(D):new Array(D),x=k=0;k<D;x++)(64512&(_=S.charCodeAt(x)))==55296&&x+1<C&&(64512&(f=S.charCodeAt(x+1)))==56320&&(_=65536+(_-55296<<10)+(f-56320),x++),_<128?y[k++]=_:(_<2048?y[k++]=192|_>>>6:(_<65536?y[k++]=224|_>>>12:(y[k++]=240|_>>>18,y[k++]=128|_>>>12&63),y[k++]=128|_>>>6&63),y[k++]=128|63&_);return y}(p)},l.utf8decode=function(p){return c.nodebuffer?i.transformTo("nodebuffer",p).toString("utf-8"):function(S){var y,_,f,x,k=S.length,C=new Array(2*k);for(y=_=0;y<k;)if((f=S[y++])<128)C[_++]=f;else if(4<(x=m[f]))C[_++]=65533,y+=x-1;else{for(f&=x===2?31:x===3?15:7;1<x&&y<k;)f=f<<6|63&S[y++],x--;1<x?C[_++]=65533:f<65536?C[_++]=f:(f-=65536,C[_++]=55296|f>>10&1023,C[_++]=56320|1023&f)}return C.length!==_&&(C.subarray?C=C.subarray(0,_):C.length=_),i.applyFromCharCode(C)}(p=i.transformTo(c.uint8array?"uint8array":"array",p))},i.inherits(b,u),b.prototype.processChunk=function(p){var S=i.transformTo(c.uint8array?"uint8array":"array",p.data);if(this.leftOver&&this.leftOver.length){if(c.uint8array){var y=S;(S=new Uint8Array(y.length+this.leftOver.length)).set(this.leftOver,0),S.set(y,this.leftOver.length)}else S=this.leftOver.concat(S);this.leftOver=null}var _=function(x,k){var C;for((k=k||x.length)>x.length&&(k=x.length),C=k-1;0<=C&&(192&x[C])==128;)C--;return C<0||C===0?k:C+m[x[C]]>k?C:k}(S),f=S;_!==S.length&&(c.uint8array?(f=S.subarray(0,_),this.leftOver=S.subarray(_,S.length)):(f=S.slice(0,_),this.leftOver=S.slice(_,S.length))),this.push({data:l.utf8decode(f),meta:p.meta})},b.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:l.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},l.Utf8DecodeWorker=b,i.inherits(T,u),T.prototype.processChunk=function(p){this.push({data:l.utf8encode(p.data),meta:p.meta})},l.Utf8EncodeWorker=T},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,s,l){var i=t("./support"),c=t("./base64"),n=t("./nodejsUtils"),u=t("./external");function m(y){return y}function w(y,_){for(var f=0;f<y.length;++f)_[f]=255&y.charCodeAt(f);return _}t("setimmediate"),l.newBlob=function(y,_){l.checkSupport("blob");try{return new Blob([y],{type:_})}catch{try{var f=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return f.append(y),f.getBlob(_)}catch{throw new Error("Bug : can't construct the Blob.")}}};var b={stringifyByChunk:function(y,_,f){var x=[],k=0,C=y.length;if(C<=f)return String.fromCharCode.apply(null,y);for(;k<C;)_==="array"||_==="nodebuffer"?x.push(String.fromCharCode.apply(null,y.slice(k,Math.min(k+f,C)))):x.push(String.fromCharCode.apply(null,y.subarray(k,Math.min(k+f,C)))),k+=f;return x.join("")},stringifyByChar:function(y){for(var _="",f=0;f<y.length;f++)_+=String.fromCharCode(y[f]);return _},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&String.fromCharCode.apply(null,n.allocBuffer(1)).length===1}catch{return!1}}()}};function T(y){var _=65536,f=l.getTypeOf(y),x=!0;if(f==="uint8array"?x=b.applyCanBeUsed.uint8array:f==="nodebuffer"&&(x=b.applyCanBeUsed.nodebuffer),x)for(;1<_;)try{return b.stringifyByChunk(y,f,_)}catch{_=Math.floor(_/2)}return b.stringifyByChar(y)}function p(y,_){for(var f=0;f<y.length;f++)_[f]=y[f];return _}l.applyFromCharCode=T;var S={};S.string={string:m,array:function(y){return w(y,new Array(y.length))},arraybuffer:function(y){return S.string.uint8array(y).buffer},uint8array:function(y){return w(y,new Uint8Array(y.length))},nodebuffer:function(y){return w(y,n.allocBuffer(y.length))}},S.array={string:T,array:m,arraybuffer:function(y){return new Uint8Array(y).buffer},uint8array:function(y){return new Uint8Array(y)},nodebuffer:function(y){return n.newBufferFrom(y)}},S.arraybuffer={string:function(y){return T(new Uint8Array(y))},array:function(y){return p(new Uint8Array(y),new Array(y.byteLength))},arraybuffer:m,uint8array:function(y){return new Uint8Array(y)},nodebuffer:function(y){return n.newBufferFrom(new Uint8Array(y))}},S.uint8array={string:T,array:function(y){return p(y,new Array(y.length))},arraybuffer:function(y){return y.buffer},uint8array:m,nodebuffer:function(y){return n.newBufferFrom(y)}},S.nodebuffer={string:T,array:function(y){return p(y,new Array(y.length))},arraybuffer:function(y){return S.nodebuffer.uint8array(y).buffer},uint8array:function(y){return p(y,new Uint8Array(y.length))},nodebuffer:m},l.transformTo=function(y,_){if(_=_||"",!y)return _;l.checkSupport(y);var f=l.getTypeOf(_);return S[f][y](_)},l.resolve=function(y){for(var _=y.split("/"),f=[],x=0;x<_.length;x++){var k=_[x];k==="."||k===""&&x!==0&&x!==_.length-1||(k===".."?f.pop():f.push(k))}return f.join("/")},l.getTypeOf=function(y){return typeof y=="string"?"string":Object.prototype.toString.call(y)==="[object Array]"?"array":i.nodebuffer&&n.isBuffer(y)?"nodebuffer":i.uint8array&&y instanceof Uint8Array?"uint8array":i.arraybuffer&&y instanceof ArrayBuffer?"arraybuffer":void 0},l.checkSupport=function(y){if(!i[y.toLowerCase()])throw new Error(y+" is not supported by this platform")},l.MAX_VALUE_16BITS=65535,l.MAX_VALUE_32BITS=-1,l.pretty=function(y){var _,f,x="";for(f=0;f<(y||"").length;f++)x+="\\x"+((_=y.charCodeAt(f))<16?"0":"")+_.toString(16).toUpperCase();return x},l.delay=function(y,_,f){setImmediate(function(){y.apply(f||null,_||[])})},l.inherits=function(y,_){function f(){}f.prototype=_.prototype,y.prototype=new f},l.extend=function(){var y,_,f={};for(y=0;y<arguments.length;y++)for(_ in arguments[y])Object.prototype.hasOwnProperty.call(arguments[y],_)&&f[_]===void 0&&(f[_]=arguments[y][_]);return f},l.prepareContent=function(y,_,f,x,k){return u.Promise.resolve(_).then(function(C){return i.blob&&(C instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(C))!==-1)&&typeof FileReader<"u"?new u.Promise(function(D,q){var M=new FileReader;M.onload=function(J){D(J.target.result)},M.onerror=function(J){q(J.target.error)},M.readAsArrayBuffer(C)}):C}).then(function(C){var D=l.getTypeOf(C);return D?(D==="arraybuffer"?C=l.transformTo("uint8array",C):D==="string"&&(k?C=c.decode(C):f&&x!==!0&&(C=function(q){return w(q,i.uint8array?new Uint8Array(q.length):new Array(q.length))}(C))),C):u.Promise.reject(new Error("Can't read the data of '"+y+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,s,l){var i=t("./reader/readerFor"),c=t("./utils"),n=t("./signature"),u=t("./zipEntry"),m=t("./support");function w(b){this.files=[],this.loadOptions=b}w.prototype={checkSignature:function(b){if(!this.reader.readAndCheckSignature(b)){this.reader.index-=4;var T=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+c.pretty(T)+", expected "+c.pretty(b)+")")}},isSignature:function(b,T){var p=this.reader.index;this.reader.setIndex(b);var S=this.reader.readString(4)===T;return this.reader.setIndex(p),S},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var b=this.reader.readData(this.zipCommentLength),T=m.uint8array?"uint8array":"array",p=c.transformTo(T,b);this.zipComment=this.loadOptions.decodeFileName(p)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var b,T,p,S=this.zip64EndOfCentralSize-44;0<S;)b=this.reader.readInt(2),T=this.reader.readInt(4),p=this.reader.readData(T),this.zip64ExtensibleData[b]={id:b,length:T,value:p}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var b,T;for(b=0;b<this.files.length;b++)T=this.files[b],this.reader.setIndex(T.localHeaderOffset),this.checkSignature(n.LOCAL_FILE_HEADER),T.readLocalPart(this.reader),T.handleUTF8(),T.processAttributes()},readCentralDir:function(){var b;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(n.CENTRAL_FILE_HEADER);)(b=new u({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(b);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var b=this.reader.lastIndexOfSignature(n.CENTRAL_DIRECTORY_END);if(b<0)throw this.isSignature(0,n.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(b);var T=b;if(this.checkSignature(n.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===c.MAX_VALUE_16BITS||this.diskWithCentralDirStart===c.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===c.MAX_VALUE_16BITS||this.centralDirRecords===c.MAX_VALUE_16BITS||this.centralDirSize===c.MAX_VALUE_32BITS||this.centralDirOffset===c.MAX_VALUE_32BITS){if(this.zip64=!0,(b=this.reader.lastIndexOfSignature(n.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(b),this.checkSignature(n.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,n.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(n.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(n.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var p=this.centralDirOffset+this.centralDirSize;this.zip64&&(p+=20,p+=12+this.zip64EndOfCentralSize);var S=T-p;if(0<S)this.isSignature(T,n.CENTRAL_FILE_HEADER)||(this.reader.zero=S);else if(S<0)throw new Error("Corrupted zip: missing "+Math.abs(S)+" bytes.")},prepareReader:function(b){this.reader=i(b)},load:function(b){this.prepareReader(b),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},s.exports=w},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,s,l){var i=t("./reader/readerFor"),c=t("./utils"),n=t("./compressedObject"),u=t("./crc32"),m=t("./utf8"),w=t("./compressions"),b=t("./support");function T(p,S){this.options=p,this.loadOptions=S}T.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(p){var S,y;if(p.skip(22),this.fileNameLength=p.readInt(2),y=p.readInt(2),this.fileName=p.readData(this.fileNameLength),p.skip(y),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((S=function(_){for(var f in w)if(Object.prototype.hasOwnProperty.call(w,f)&&w[f].magic===_)return w[f];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+c.pretty(this.compressionMethod)+" unknown (inner file : "+c.transformTo("string",this.fileName)+")");this.decompressed=new n(this.compressedSize,this.uncompressedSize,this.crc32,S,p.readData(this.compressedSize))},readCentralPart:function(p){this.versionMadeBy=p.readInt(2),p.skip(2),this.bitFlag=p.readInt(2),this.compressionMethod=p.readString(2),this.date=p.readDate(),this.crc32=p.readInt(4),this.compressedSize=p.readInt(4),this.uncompressedSize=p.readInt(4);var S=p.readInt(2);if(this.extraFieldsLength=p.readInt(2),this.fileCommentLength=p.readInt(2),this.diskNumberStart=p.readInt(2),this.internalFileAttributes=p.readInt(2),this.externalFileAttributes=p.readInt(4),this.localHeaderOffset=p.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");p.skip(S),this.readExtraFields(p),this.parseZIP64ExtraField(p),this.fileComment=p.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var p=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),p==0&&(this.dosPermissions=63&this.externalFileAttributes),p==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var p=i(this.extraFields[1].value);this.uncompressedSize===c.MAX_VALUE_32BITS&&(this.uncompressedSize=p.readInt(8)),this.compressedSize===c.MAX_VALUE_32BITS&&(this.compressedSize=p.readInt(8)),this.localHeaderOffset===c.MAX_VALUE_32BITS&&(this.localHeaderOffset=p.readInt(8)),this.diskNumberStart===c.MAX_VALUE_32BITS&&(this.diskNumberStart=p.readInt(4))}},readExtraFields:function(p){var S,y,_,f=p.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});p.index+4<f;)S=p.readInt(2),y=p.readInt(2),_=p.readData(y),this.extraFields[S]={id:S,length:y,value:_};p.setIndex(f)},handleUTF8:function(){var p=b.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=m.utf8decode(this.fileName),this.fileCommentStr=m.utf8decode(this.fileComment);else{var S=this.findExtraFieldUnicodePath();if(S!==null)this.fileNameStr=S;else{var y=c.transformTo(p,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(y)}var _=this.findExtraFieldUnicodeComment();if(_!==null)this.fileCommentStr=_;else{var f=c.transformTo(p,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(f)}}},findExtraFieldUnicodePath:function(){var p=this.extraFields[28789];if(p){var S=i(p.value);return S.readInt(1)!==1||u(this.fileName)!==S.readInt(4)?null:m.utf8decode(S.readData(p.length-5))}return null},findExtraFieldUnicodeComment:function(){var p=this.extraFields[25461];if(p){var S=i(p.value);return S.readInt(1)!==1||u(this.fileComment)!==S.readInt(4)?null:m.utf8decode(S.readData(p.length-5))}return null}},s.exports=T},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,s,l){function i(S,y,_){this.name=S,this.dir=_.dir,this.date=_.date,this.comment=_.comment,this.unixPermissions=_.unixPermissions,this.dosPermissions=_.dosPermissions,this._data=y,this._dataBinary=_.binary,this.options={compression:_.compression,compressionOptions:_.compressionOptions}}var c=t("./stream/StreamHelper"),n=t("./stream/DataWorker"),u=t("./utf8"),m=t("./compressedObject"),w=t("./stream/GenericWorker");i.prototype={internalStream:function(S){var y=null,_="string";try{if(!S)throw new Error("No output type specified.");var f=(_=S.toLowerCase())==="string"||_==="text";_!=="binarystring"&&_!=="text"||(_="string"),y=this._decompressWorker();var x=!this._dataBinary;x&&!f&&(y=y.pipe(new u.Utf8EncodeWorker)),!x&&f&&(y=y.pipe(new u.Utf8DecodeWorker))}catch(k){(y=new w("error")).error(k)}return new c(y,_,"")},async:function(S,y){return this.internalStream(S).accumulate(y)},nodeStream:function(S,y){return this.internalStream(S||"nodebuffer").toNodejsStream(y)},_compressWorker:function(S,y){if(this._data instanceof m&&this._data.compression.magic===S.magic)return this._data.getCompressedWorker();var _=this._decompressWorker();return this._dataBinary||(_=_.pipe(new u.Utf8EncodeWorker)),m.createWorkerFrom(_,S,y)},_decompressWorker:function(){return this._data instanceof m?this._data.getContentWorker():this._data instanceof w?this._data:new n(this._data)}};for(var b=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],T=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},p=0;p<b.length;p++)i.prototype[b[p]]=T;s.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,s,l){(function(i){var c,n,u=i.MutationObserver||i.WebKitMutationObserver;if(u){var m=0,w=new u(S),b=i.document.createTextNode("");w.observe(b,{characterData:!0}),c=function(){b.data=m=++m%2}}else if(i.setImmediate||i.MessageChannel===void 0)c="document"in i&&"onreadystatechange"in i.document.createElement("script")?function(){var y=i.document.createElement("script");y.onreadystatechange=function(){S(),y.onreadystatechange=null,y.parentNode.removeChild(y),y=null},i.document.documentElement.appendChild(y)}:function(){setTimeout(S,0)};else{var T=new i.MessageChannel;T.port1.onmessage=S,c=function(){T.port2.postMessage(0)}}var p=[];function S(){var y,_;n=!0;for(var f=p.length;f;){for(_=p,p=[],y=-1;++y<f;)_[y]();f=p.length}n=!1}s.exports=function(y){p.push(y)!==1||n||c()}}).call(this,typeof Rt<"u"?Rt:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(t,s,l){var i=t("immediate");function c(){}var n={},u=["REJECTED"],m=["FULFILLED"],w=["PENDING"];function b(f){if(typeof f!="function")throw new TypeError("resolver must be a function");this.state=w,this.queue=[],this.outcome=void 0,f!==c&&y(this,f)}function T(f,x,k){this.promise=f,typeof x=="function"&&(this.onFulfilled=x,this.callFulfilled=this.otherCallFulfilled),typeof k=="function"&&(this.onRejected=k,this.callRejected=this.otherCallRejected)}function p(f,x,k){i(function(){var C;try{C=x(k)}catch(D){return n.reject(f,D)}C===f?n.reject(f,new TypeError("Cannot resolve promise with itself")):n.resolve(f,C)})}function S(f){var x=f&&f.then;if(f&&(typeof f=="object"||typeof f=="function")&&typeof x=="function")return function(){x.apply(f,arguments)}}function y(f,x){var k=!1;function C(M){k||(k=!0,n.reject(f,M))}function D(M){k||(k=!0,n.resolve(f,M))}var q=_(function(){x(D,C)});q.status==="error"&&C(q.value)}function _(f,x){var k={};try{k.value=f(x),k.status="success"}catch(C){k.status="error",k.value=C}return k}(s.exports=b).prototype.finally=function(f){if(typeof f!="function")return this;var x=this.constructor;return this.then(function(k){return x.resolve(f()).then(function(){return k})},function(k){return x.resolve(f()).then(function(){throw k})})},b.prototype.catch=function(f){return this.then(null,f)},b.prototype.then=function(f,x){if(typeof f!="function"&&this.state===m||typeof x!="function"&&this.state===u)return this;var k=new this.constructor(c);return this.state!==w?p(k,this.state===m?f:x,this.outcome):this.queue.push(new T(k,f,x)),k},T.prototype.callFulfilled=function(f){n.resolve(this.promise,f)},T.prototype.otherCallFulfilled=function(f){p(this.promise,this.onFulfilled,f)},T.prototype.callRejected=function(f){n.reject(this.promise,f)},T.prototype.otherCallRejected=function(f){p(this.promise,this.onRejected,f)},n.resolve=function(f,x){var k=_(S,x);if(k.status==="error")return n.reject(f,k.value);var C=k.value;if(C)y(f,C);else{f.state=m,f.outcome=x;for(var D=-1,q=f.queue.length;++D<q;)f.queue[D].callFulfilled(x)}return f},n.reject=function(f,x){f.state=u,f.outcome=x;for(var k=-1,C=f.queue.length;++k<C;)f.queue[k].callRejected(x);return f},b.resolve=function(f){return f instanceof this?f:n.resolve(new this(c),f)},b.reject=function(f){var x=new this(c);return n.reject(x,f)},b.all=function(f){var x=this;if(Object.prototype.toString.call(f)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=f.length,C=!1;if(!k)return this.resolve([]);for(var D=new Array(k),q=0,M=-1,J=new this(c);++M<k;)I(f[M],M);return J;function I(ue,ee){x.resolve(ue).then(function(B){D[ee]=B,++q!==k||C||(C=!0,n.resolve(J,D))},function(B){C||(C=!0,n.reject(J,B))})}},b.race=function(f){var x=this;if(Object.prototype.toString.call(f)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=f.length,C=!1;if(!k)return this.resolve([]);for(var D=-1,q=new this(c);++D<k;)M=f[D],x.resolve(M).then(function(J){C||(C=!0,n.resolve(q,J))},function(J){C||(C=!0,n.reject(q,J))});var M;return q}},{immediate:36}],38:[function(t,s,l){var i={};(0,t("./lib/utils/common").assign)(i,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),s.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,s,l){var i=t("./zlib/deflate"),c=t("./utils/common"),n=t("./utils/strings"),u=t("./zlib/messages"),m=t("./zlib/zstream"),w=Object.prototype.toString,b=0,T=-1,p=0,S=8;function y(f){if(!(this instanceof y))return new y(f);this.options=c.assign({level:T,method:S,chunkSize:16384,windowBits:15,memLevel:8,strategy:p,to:""},f||{});var x=this.options;x.raw&&0<x.windowBits?x.windowBits=-x.windowBits:x.gzip&&0<x.windowBits&&x.windowBits<16&&(x.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new m,this.strm.avail_out=0;var k=i.deflateInit2(this.strm,x.level,x.method,x.windowBits,x.memLevel,x.strategy);if(k!==b)throw new Error(u[k]);if(x.header&&i.deflateSetHeader(this.strm,x.header),x.dictionary){var C;if(C=typeof x.dictionary=="string"?n.string2buf(x.dictionary):w.call(x.dictionary)==="[object ArrayBuffer]"?new Uint8Array(x.dictionary):x.dictionary,(k=i.deflateSetDictionary(this.strm,C))!==b)throw new Error(u[k]);this._dict_set=!0}}function _(f,x){var k=new y(x);if(k.push(f,!0),k.err)throw k.msg||u[k.err];return k.result}y.prototype.push=function(f,x){var k,C,D=this.strm,q=this.options.chunkSize;if(this.ended)return!1;C=x===~~x?x:x===!0?4:0,typeof f=="string"?D.input=n.string2buf(f):w.call(f)==="[object ArrayBuffer]"?D.input=new Uint8Array(f):D.input=f,D.next_in=0,D.avail_in=D.input.length;do{if(D.avail_out===0&&(D.output=new c.Buf8(q),D.next_out=0,D.avail_out=q),(k=i.deflate(D,C))!==1&&k!==b)return this.onEnd(k),!(this.ended=!0);D.avail_out!==0&&(D.avail_in!==0||C!==4&&C!==2)||(this.options.to==="string"?this.onData(n.buf2binstring(c.shrinkBuf(D.output,D.next_out))):this.onData(c.shrinkBuf(D.output,D.next_out)))}while((0<D.avail_in||D.avail_out===0)&&k!==1);return C===4?(k=i.deflateEnd(this.strm),this.onEnd(k),this.ended=!0,k===b):C!==2||(this.onEnd(b),!(D.avail_out=0))},y.prototype.onData=function(f){this.chunks.push(f)},y.prototype.onEnd=function(f){f===b&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=c.flattenChunks(this.chunks)),this.chunks=[],this.err=f,this.msg=this.strm.msg},l.Deflate=y,l.deflate=_,l.deflateRaw=function(f,x){return(x=x||{}).raw=!0,_(f,x)},l.gzip=function(f,x){return(x=x||{}).gzip=!0,_(f,x)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,s,l){var i=t("./zlib/inflate"),c=t("./utils/common"),n=t("./utils/strings"),u=t("./zlib/constants"),m=t("./zlib/messages"),w=t("./zlib/zstream"),b=t("./zlib/gzheader"),T=Object.prototype.toString;function p(y){if(!(this instanceof p))return new p(y);this.options=c.assign({chunkSize:16384,windowBits:0,to:""},y||{});var _=this.options;_.raw&&0<=_.windowBits&&_.windowBits<16&&(_.windowBits=-_.windowBits,_.windowBits===0&&(_.windowBits=-15)),!(0<=_.windowBits&&_.windowBits<16)||y&&y.windowBits||(_.windowBits+=32),15<_.windowBits&&_.windowBits<48&&!(15&_.windowBits)&&(_.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new w,this.strm.avail_out=0;var f=i.inflateInit2(this.strm,_.windowBits);if(f!==u.Z_OK)throw new Error(m[f]);this.header=new b,i.inflateGetHeader(this.strm,this.header)}function S(y,_){var f=new p(_);if(f.push(y,!0),f.err)throw f.msg||m[f.err];return f.result}p.prototype.push=function(y,_){var f,x,k,C,D,q,M=this.strm,J=this.options.chunkSize,I=this.options.dictionary,ue=!1;if(this.ended)return!1;x=_===~~_?_:_===!0?u.Z_FINISH:u.Z_NO_FLUSH,typeof y=="string"?M.input=n.binstring2buf(y):T.call(y)==="[object ArrayBuffer]"?M.input=new Uint8Array(y):M.input=y,M.next_in=0,M.avail_in=M.input.length;do{if(M.avail_out===0&&(M.output=new c.Buf8(J),M.next_out=0,M.avail_out=J),(f=i.inflate(M,u.Z_NO_FLUSH))===u.Z_NEED_DICT&&I&&(q=typeof I=="string"?n.string2buf(I):T.call(I)==="[object ArrayBuffer]"?new Uint8Array(I):I,f=i.inflateSetDictionary(this.strm,q)),f===u.Z_BUF_ERROR&&ue===!0&&(f=u.Z_OK,ue=!1),f!==u.Z_STREAM_END&&f!==u.Z_OK)return this.onEnd(f),!(this.ended=!0);M.next_out&&(M.avail_out!==0&&f!==u.Z_STREAM_END&&(M.avail_in!==0||x!==u.Z_FINISH&&x!==u.Z_SYNC_FLUSH)||(this.options.to==="string"?(k=n.utf8border(M.output,M.next_out),C=M.next_out-k,D=n.buf2string(M.output,k),M.next_out=C,M.avail_out=J-C,C&&c.arraySet(M.output,M.output,k,C,0),this.onData(D)):this.onData(c.shrinkBuf(M.output,M.next_out)))),M.avail_in===0&&M.avail_out===0&&(ue=!0)}while((0<M.avail_in||M.avail_out===0)&&f!==u.Z_STREAM_END);return f===u.Z_STREAM_END&&(x=u.Z_FINISH),x===u.Z_FINISH?(f=i.inflateEnd(this.strm),this.onEnd(f),this.ended=!0,f===u.Z_OK):x!==u.Z_SYNC_FLUSH||(this.onEnd(u.Z_OK),!(M.avail_out=0))},p.prototype.onData=function(y){this.chunks.push(y)},p.prototype.onEnd=function(y){y===u.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=c.flattenChunks(this.chunks)),this.chunks=[],this.err=y,this.msg=this.strm.msg},l.Inflate=p,l.inflate=S,l.inflateRaw=function(y,_){return(_=_||{}).raw=!0,S(y,_)},l.ungzip=S},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,s,l){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";l.assign=function(u){for(var m=Array.prototype.slice.call(arguments,1);m.length;){var w=m.shift();if(w){if(typeof w!="object")throw new TypeError(w+"must be non-object");for(var b in w)w.hasOwnProperty(b)&&(u[b]=w[b])}}return u},l.shrinkBuf=function(u,m){return u.length===m?u:u.subarray?u.subarray(0,m):(u.length=m,u)};var c={arraySet:function(u,m,w,b,T){if(m.subarray&&u.subarray)u.set(m.subarray(w,w+b),T);else for(var p=0;p<b;p++)u[T+p]=m[w+p]},flattenChunks:function(u){var m,w,b,T,p,S;for(m=b=0,w=u.length;m<w;m++)b+=u[m].length;for(S=new Uint8Array(b),m=T=0,w=u.length;m<w;m++)p=u[m],S.set(p,T),T+=p.length;return S}},n={arraySet:function(u,m,w,b,T){for(var p=0;p<b;p++)u[T+p]=m[w+p]},flattenChunks:function(u){return[].concat.apply([],u)}};l.setTyped=function(u){u?(l.Buf8=Uint8Array,l.Buf16=Uint16Array,l.Buf32=Int32Array,l.assign(l,c)):(l.Buf8=Array,l.Buf16=Array,l.Buf32=Array,l.assign(l,n))},l.setTyped(i)},{}],42:[function(t,s,l){var i=t("./common"),c=!0,n=!0;try{String.fromCharCode.apply(null,[0])}catch{c=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{n=!1}for(var u=new i.Buf8(256),m=0;m<256;m++)u[m]=252<=m?6:248<=m?5:240<=m?4:224<=m?3:192<=m?2:1;function w(b,T){if(T<65537&&(b.subarray&&n||!b.subarray&&c))return String.fromCharCode.apply(null,i.shrinkBuf(b,T));for(var p="",S=0;S<T;S++)p+=String.fromCharCode(b[S]);return p}u[254]=u[254]=1,l.string2buf=function(b){var T,p,S,y,_,f=b.length,x=0;for(y=0;y<f;y++)(64512&(p=b.charCodeAt(y)))==55296&&y+1<f&&(64512&(S=b.charCodeAt(y+1)))==56320&&(p=65536+(p-55296<<10)+(S-56320),y++),x+=p<128?1:p<2048?2:p<65536?3:4;for(T=new i.Buf8(x),y=_=0;_<x;y++)(64512&(p=b.charCodeAt(y)))==55296&&y+1<f&&(64512&(S=b.charCodeAt(y+1)))==56320&&(p=65536+(p-55296<<10)+(S-56320),y++),p<128?T[_++]=p:(p<2048?T[_++]=192|p>>>6:(p<65536?T[_++]=224|p>>>12:(T[_++]=240|p>>>18,T[_++]=128|p>>>12&63),T[_++]=128|p>>>6&63),T[_++]=128|63&p);return T},l.buf2binstring=function(b){return w(b,b.length)},l.binstring2buf=function(b){for(var T=new i.Buf8(b.length),p=0,S=T.length;p<S;p++)T[p]=b.charCodeAt(p);return T},l.buf2string=function(b,T){var p,S,y,_,f=T||b.length,x=new Array(2*f);for(p=S=0;p<f;)if((y=b[p++])<128)x[S++]=y;else if(4<(_=u[y]))x[S++]=65533,p+=_-1;else{for(y&=_===2?31:_===3?15:7;1<_&&p<f;)y=y<<6|63&b[p++],_--;1<_?x[S++]=65533:y<65536?x[S++]=y:(y-=65536,x[S++]=55296|y>>10&1023,x[S++]=56320|1023&y)}return w(x,S)},l.utf8border=function(b,T){var p;for((T=T||b.length)>b.length&&(T=b.length),p=T-1;0<=p&&(192&b[p])==128;)p--;return p<0||p===0?T:p+u[b[p]]>T?p:T}},{"./common":41}],43:[function(t,s,l){s.exports=function(i,c,n,u){for(var m=65535&i|0,w=i>>>16&65535|0,b=0;n!==0;){for(n-=b=2e3<n?2e3:n;w=w+(m=m+c[u++]|0)|0,--b;);m%=65521,w%=65521}return m|w<<16|0}},{}],44:[function(t,s,l){s.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,s,l){var i=function(){for(var c,n=[],u=0;u<256;u++){c=u;for(var m=0;m<8;m++)c=1&c?3988292384^c>>>1:c>>>1;n[u]=c}return n}();s.exports=function(c,n,u,m){var w=i,b=m+u;c^=-1;for(var T=m;T<b;T++)c=c>>>8^w[255&(c^n[T])];return-1^c}},{}],46:[function(t,s,l){var i,c=t("../utils/common"),n=t("./trees"),u=t("./adler32"),m=t("./crc32"),w=t("./messages"),b=0,T=4,p=0,S=-2,y=-1,_=4,f=2,x=8,k=9,C=286,D=30,q=19,M=2*C+1,J=15,I=3,ue=258,ee=ue+I+1,B=42,W=113,A=1,z=2,se=3,V=4;function ye(h,Q){return h.msg=w[Q],Q}function Z(h){return(h<<1)-(4<h?9:0)}function re(h){for(var Q=h.length;0<=--Q;)h[Q]=0}function j(h){var Q=h.state,E=Q.pending;E>h.avail_out&&(E=h.avail_out),E!==0&&(c.arraySet(h.output,Q.pending_buf,Q.pending_out,E,h.next_out),h.next_out+=E,Q.pending_out+=E,h.total_out+=E,h.avail_out-=E,Q.pending-=E,Q.pending===0&&(Q.pending_out=0))}function R(h,Q){n._tr_flush_block(h,0<=h.block_start?h.block_start:-1,h.strstart-h.block_start,Q),h.block_start=h.strstart,j(h.strm)}function K(h,Q){h.pending_buf[h.pending++]=Q}function X(h,Q){h.pending_buf[h.pending++]=Q>>>8&255,h.pending_buf[h.pending++]=255&Q}function oe(h,Q){var E,o,a=h.max_chain_length,d=h.strstart,F=h.prev_length,$=h.nice_match,P=h.strstart>h.w_size-ee?h.strstart-(h.w_size-ee):0,fe=h.window,we=h.w_mask,he=h.prev,xe=h.strstart+ue,ke=fe[d+F-1],Ne=fe[d+F];h.prev_length>=h.good_match&&(a>>=2),$>h.lookahead&&($=h.lookahead);do if(fe[(E=Q)+F]===Ne&&fe[E+F-1]===ke&&fe[E]===fe[d]&&fe[++E]===fe[d+1]){d+=2,E++;do;while(fe[++d]===fe[++E]&&fe[++d]===fe[++E]&&fe[++d]===fe[++E]&&fe[++d]===fe[++E]&&fe[++d]===fe[++E]&&fe[++d]===fe[++E]&&fe[++d]===fe[++E]&&fe[++d]===fe[++E]&&d<xe);if(o=ue-(xe-d),d=xe-ue,F<o){if(h.match_start=Q,$<=(F=o))break;ke=fe[d+F-1],Ne=fe[d+F]}}while((Q=he[Q&we])>P&&--a!=0);return F<=h.lookahead?F:h.lookahead}function H(h){var Q,E,o,a,d,F,$,P,fe,we,he=h.w_size;do{if(a=h.window_size-h.lookahead-h.strstart,h.strstart>=he+(he-ee)){for(c.arraySet(h.window,h.window,he,he,0),h.match_start-=he,h.strstart-=he,h.block_start-=he,Q=E=h.hash_size;o=h.head[--Q],h.head[Q]=he<=o?o-he:0,--E;);for(Q=E=he;o=h.prev[--Q],h.prev[Q]=he<=o?o-he:0,--E;);a+=he}if(h.strm.avail_in===0)break;if(F=h.strm,$=h.window,P=h.strstart+h.lookahead,fe=a,we=void 0,we=F.avail_in,fe<we&&(we=fe),E=we===0?0:(F.avail_in-=we,c.arraySet($,F.input,F.next_in,we,P),F.state.wrap===1?F.adler=u(F.adler,$,we,P):F.state.wrap===2&&(F.adler=m(F.adler,$,we,P)),F.next_in+=we,F.total_in+=we,we),h.lookahead+=E,h.lookahead+h.insert>=I)for(d=h.strstart-h.insert,h.ins_h=h.window[d],h.ins_h=(h.ins_h<<h.hash_shift^h.window[d+1])&h.hash_mask;h.insert&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[d+I-1])&h.hash_mask,h.prev[d&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=d,d++,h.insert--,!(h.lookahead+h.insert<I)););}while(h.lookahead<ee&&h.strm.avail_in!==0)}function v(h,Q){for(var E,o;;){if(h.lookahead<ee){if(H(h),h.lookahead<ee&&Q===b)return A;if(h.lookahead===0)break}if(E=0,h.lookahead>=I&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+I-1])&h.hash_mask,E=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart),E!==0&&h.strstart-E<=h.w_size-ee&&(h.match_length=oe(h,E)),h.match_length>=I)if(o=n._tr_tally(h,h.strstart-h.match_start,h.match_length-I),h.lookahead-=h.match_length,h.match_length<=h.max_lazy_match&&h.lookahead>=I){for(h.match_length--;h.strstart++,h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+I-1])&h.hash_mask,E=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart,--h.match_length!=0;);h.strstart++}else h.strstart+=h.match_length,h.match_length=0,h.ins_h=h.window[h.strstart],h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+1])&h.hash_mask;else o=n._tr_tally(h,0,h.window[h.strstart]),h.lookahead--,h.strstart++;if(o&&(R(h,!1),h.strm.avail_out===0))return A}return h.insert=h.strstart<I-1?h.strstart:I-1,Q===T?(R(h,!0),h.strm.avail_out===0?se:V):h.last_lit&&(R(h,!1),h.strm.avail_out===0)?A:z}function g(h,Q){for(var E,o,a;;){if(h.lookahead<ee){if(H(h),h.lookahead<ee&&Q===b)return A;if(h.lookahead===0)break}if(E=0,h.lookahead>=I&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+I-1])&h.hash_mask,E=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart),h.prev_length=h.match_length,h.prev_match=h.match_start,h.match_length=I-1,E!==0&&h.prev_length<h.max_lazy_match&&h.strstart-E<=h.w_size-ee&&(h.match_length=oe(h,E),h.match_length<=5&&(h.strategy===1||h.match_length===I&&4096<h.strstart-h.match_start)&&(h.match_length=I-1)),h.prev_length>=I&&h.match_length<=h.prev_length){for(a=h.strstart+h.lookahead-I,o=n._tr_tally(h,h.strstart-1-h.prev_match,h.prev_length-I),h.lookahead-=h.prev_length-1,h.prev_length-=2;++h.strstart<=a&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+I-1])&h.hash_mask,E=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart),--h.prev_length!=0;);if(h.match_available=0,h.match_length=I-1,h.strstart++,o&&(R(h,!1),h.strm.avail_out===0))return A}else if(h.match_available){if((o=n._tr_tally(h,0,h.window[h.strstart-1]))&&R(h,!1),h.strstart++,h.lookahead--,h.strm.avail_out===0)return A}else h.match_available=1,h.strstart++,h.lookahead--}return h.match_available&&(o=n._tr_tally(h,0,h.window[h.strstart-1]),h.match_available=0),h.insert=h.strstart<I-1?h.strstart:I-1,Q===T?(R(h,!0),h.strm.avail_out===0?se:V):h.last_lit&&(R(h,!1),h.strm.avail_out===0)?A:z}function U(h,Q,E,o,a){this.good_length=h,this.max_lazy=Q,this.nice_length=E,this.max_chain=o,this.func=a}function L(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=x,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new c.Buf16(2*M),this.dyn_dtree=new c.Buf16(2*(2*D+1)),this.bl_tree=new c.Buf16(2*(2*q+1)),re(this.dyn_ltree),re(this.dyn_dtree),re(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new c.Buf16(J+1),this.heap=new c.Buf16(2*C+1),re(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new c.Buf16(2*C+1),re(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function N(h){var Q;return h&&h.state?(h.total_in=h.total_out=0,h.data_type=f,(Q=h.state).pending=0,Q.pending_out=0,Q.wrap<0&&(Q.wrap=-Q.wrap),Q.status=Q.wrap?B:W,h.adler=Q.wrap===2?0:1,Q.last_flush=b,n._tr_init(Q),p):ye(h,S)}function O(h){var Q=N(h);return Q===p&&function(E){E.window_size=2*E.w_size,re(E.head),E.max_lazy_match=i[E.level].max_lazy,E.good_match=i[E.level].good_length,E.nice_match=i[E.level].nice_length,E.max_chain_length=i[E.level].max_chain,E.strstart=0,E.block_start=0,E.lookahead=0,E.insert=0,E.match_length=E.prev_length=I-1,E.match_available=0,E.ins_h=0}(h.state),Q}function ae(h,Q,E,o,a,d){if(!h)return S;var F=1;if(Q===y&&(Q=6),o<0?(F=0,o=-o):15<o&&(F=2,o-=16),a<1||k<a||E!==x||o<8||15<o||Q<0||9<Q||d<0||_<d)return ye(h,S);o===8&&(o=9);var $=new L;return(h.state=$).strm=h,$.wrap=F,$.gzhead=null,$.w_bits=o,$.w_size=1<<$.w_bits,$.w_mask=$.w_size-1,$.hash_bits=a+7,$.hash_size=1<<$.hash_bits,$.hash_mask=$.hash_size-1,$.hash_shift=~~(($.hash_bits+I-1)/I),$.window=new c.Buf8(2*$.w_size),$.head=new c.Buf16($.hash_size),$.prev=new c.Buf16($.w_size),$.lit_bufsize=1<<a+6,$.pending_buf_size=4*$.lit_bufsize,$.pending_buf=new c.Buf8($.pending_buf_size),$.d_buf=1*$.lit_bufsize,$.l_buf=3*$.lit_bufsize,$.level=Q,$.strategy=d,$.method=E,O(h)}i=[new U(0,0,0,0,function(h,Q){var E=65535;for(E>h.pending_buf_size-5&&(E=h.pending_buf_size-5);;){if(h.lookahead<=1){if(H(h),h.lookahead===0&&Q===b)return A;if(h.lookahead===0)break}h.strstart+=h.lookahead,h.lookahead=0;var o=h.block_start+E;if((h.strstart===0||h.strstart>=o)&&(h.lookahead=h.strstart-o,h.strstart=o,R(h,!1),h.strm.avail_out===0)||h.strstart-h.block_start>=h.w_size-ee&&(R(h,!1),h.strm.avail_out===0))return A}return h.insert=0,Q===T?(R(h,!0),h.strm.avail_out===0?se:V):(h.strstart>h.block_start&&(R(h,!1),h.strm.avail_out),A)}),new U(4,4,8,4,v),new U(4,5,16,8,v),new U(4,6,32,32,v),new U(4,4,16,16,g),new U(8,16,32,32,g),new U(8,16,128,128,g),new U(8,32,128,256,g),new U(32,128,258,1024,g),new U(32,258,258,4096,g)],l.deflateInit=function(h,Q){return ae(h,Q,x,15,8,0)},l.deflateInit2=ae,l.deflateReset=O,l.deflateResetKeep=N,l.deflateSetHeader=function(h,Q){return h&&h.state?h.state.wrap!==2?S:(h.state.gzhead=Q,p):S},l.deflate=function(h,Q){var E,o,a,d;if(!h||!h.state||5<Q||Q<0)return h?ye(h,S):S;if(o=h.state,!h.output||!h.input&&h.avail_in!==0||o.status===666&&Q!==T)return ye(h,h.avail_out===0?-5:S);if(o.strm=h,E=o.last_flush,o.last_flush=Q,o.status===B)if(o.wrap===2)h.adler=0,K(o,31),K(o,139),K(o,8),o.gzhead?(K(o,(o.gzhead.text?1:0)+(o.gzhead.hcrc?2:0)+(o.gzhead.extra?4:0)+(o.gzhead.name?8:0)+(o.gzhead.comment?16:0)),K(o,255&o.gzhead.time),K(o,o.gzhead.time>>8&255),K(o,o.gzhead.time>>16&255),K(o,o.gzhead.time>>24&255),K(o,o.level===9?2:2<=o.strategy||o.level<2?4:0),K(o,255&o.gzhead.os),o.gzhead.extra&&o.gzhead.extra.length&&(K(o,255&o.gzhead.extra.length),K(o,o.gzhead.extra.length>>8&255)),o.gzhead.hcrc&&(h.adler=m(h.adler,o.pending_buf,o.pending,0)),o.gzindex=0,o.status=69):(K(o,0),K(o,0),K(o,0),K(o,0),K(o,0),K(o,o.level===9?2:2<=o.strategy||o.level<2?4:0),K(o,3),o.status=W);else{var F=x+(o.w_bits-8<<4)<<8;F|=(2<=o.strategy||o.level<2?0:o.level<6?1:o.level===6?2:3)<<6,o.strstart!==0&&(F|=32),F+=31-F%31,o.status=W,X(o,F),o.strstart!==0&&(X(o,h.adler>>>16),X(o,65535&h.adler)),h.adler=1}if(o.status===69)if(o.gzhead.extra){for(a=o.pending;o.gzindex<(65535&o.gzhead.extra.length)&&(o.pending!==o.pending_buf_size||(o.gzhead.hcrc&&o.pending>a&&(h.adler=m(h.adler,o.pending_buf,o.pending-a,a)),j(h),a=o.pending,o.pending!==o.pending_buf_size));)K(o,255&o.gzhead.extra[o.gzindex]),o.gzindex++;o.gzhead.hcrc&&o.pending>a&&(h.adler=m(h.adler,o.pending_buf,o.pending-a,a)),o.gzindex===o.gzhead.extra.length&&(o.gzindex=0,o.status=73)}else o.status=73;if(o.status===73)if(o.gzhead.name){a=o.pending;do{if(o.pending===o.pending_buf_size&&(o.gzhead.hcrc&&o.pending>a&&(h.adler=m(h.adler,o.pending_buf,o.pending-a,a)),j(h),a=o.pending,o.pending===o.pending_buf_size)){d=1;break}d=o.gzindex<o.gzhead.name.length?255&o.gzhead.name.charCodeAt(o.gzindex++):0,K(o,d)}while(d!==0);o.gzhead.hcrc&&o.pending>a&&(h.adler=m(h.adler,o.pending_buf,o.pending-a,a)),d===0&&(o.gzindex=0,o.status=91)}else o.status=91;if(o.status===91)if(o.gzhead.comment){a=o.pending;do{if(o.pending===o.pending_buf_size&&(o.gzhead.hcrc&&o.pending>a&&(h.adler=m(h.adler,o.pending_buf,o.pending-a,a)),j(h),a=o.pending,o.pending===o.pending_buf_size)){d=1;break}d=o.gzindex<o.gzhead.comment.length?255&o.gzhead.comment.charCodeAt(o.gzindex++):0,K(o,d)}while(d!==0);o.gzhead.hcrc&&o.pending>a&&(h.adler=m(h.adler,o.pending_buf,o.pending-a,a)),d===0&&(o.status=103)}else o.status=103;if(o.status===103&&(o.gzhead.hcrc?(o.pending+2>o.pending_buf_size&&j(h),o.pending+2<=o.pending_buf_size&&(K(o,255&h.adler),K(o,h.adler>>8&255),h.adler=0,o.status=W)):o.status=W),o.pending!==0){if(j(h),h.avail_out===0)return o.last_flush=-1,p}else if(h.avail_in===0&&Z(Q)<=Z(E)&&Q!==T)return ye(h,-5);if(o.status===666&&h.avail_in!==0)return ye(h,-5);if(h.avail_in!==0||o.lookahead!==0||Q!==b&&o.status!==666){var $=o.strategy===2?function(P,fe){for(var we;;){if(P.lookahead===0&&(H(P),P.lookahead===0)){if(fe===b)return A;break}if(P.match_length=0,we=n._tr_tally(P,0,P.window[P.strstart]),P.lookahead--,P.strstart++,we&&(R(P,!1),P.strm.avail_out===0))return A}return P.insert=0,fe===T?(R(P,!0),P.strm.avail_out===0?se:V):P.last_lit&&(R(P,!1),P.strm.avail_out===0)?A:z}(o,Q):o.strategy===3?function(P,fe){for(var we,he,xe,ke,Ne=P.window;;){if(P.lookahead<=ue){if(H(P),P.lookahead<=ue&&fe===b)return A;if(P.lookahead===0)break}if(P.match_length=0,P.lookahead>=I&&0<P.strstart&&(he=Ne[xe=P.strstart-1])===Ne[++xe]&&he===Ne[++xe]&&he===Ne[++xe]){ke=P.strstart+ue;do;while(he===Ne[++xe]&&he===Ne[++xe]&&he===Ne[++xe]&&he===Ne[++xe]&&he===Ne[++xe]&&he===Ne[++xe]&&he===Ne[++xe]&&he===Ne[++xe]&&xe<ke);P.match_length=ue-(ke-xe),P.match_length>P.lookahead&&(P.match_length=P.lookahead)}if(P.match_length>=I?(we=n._tr_tally(P,1,P.match_length-I),P.lookahead-=P.match_length,P.strstart+=P.match_length,P.match_length=0):(we=n._tr_tally(P,0,P.window[P.strstart]),P.lookahead--,P.strstart++),we&&(R(P,!1),P.strm.avail_out===0))return A}return P.insert=0,fe===T?(R(P,!0),P.strm.avail_out===0?se:V):P.last_lit&&(R(P,!1),P.strm.avail_out===0)?A:z}(o,Q):i[o.level].func(o,Q);if($!==se&&$!==V||(o.status=666),$===A||$===se)return h.avail_out===0&&(o.last_flush=-1),p;if($===z&&(Q===1?n._tr_align(o):Q!==5&&(n._tr_stored_block(o,0,0,!1),Q===3&&(re(o.head),o.lookahead===0&&(o.strstart=0,o.block_start=0,o.insert=0))),j(h),h.avail_out===0))return o.last_flush=-1,p}return Q!==T?p:o.wrap<=0?1:(o.wrap===2?(K(o,255&h.adler),K(o,h.adler>>8&255),K(o,h.adler>>16&255),K(o,h.adler>>24&255),K(o,255&h.total_in),K(o,h.total_in>>8&255),K(o,h.total_in>>16&255),K(o,h.total_in>>24&255)):(X(o,h.adler>>>16),X(o,65535&h.adler)),j(h),0<o.wrap&&(o.wrap=-o.wrap),o.pending!==0?p:1)},l.deflateEnd=function(h){var Q;return h&&h.state?(Q=h.state.status)!==B&&Q!==69&&Q!==73&&Q!==91&&Q!==103&&Q!==W&&Q!==666?ye(h,S):(h.state=null,Q===W?ye(h,-3):p):S},l.deflateSetDictionary=function(h,Q){var E,o,a,d,F,$,P,fe,we=Q.length;if(!h||!h.state||(d=(E=h.state).wrap)===2||d===1&&E.status!==B||E.lookahead)return S;for(d===1&&(h.adler=u(h.adler,Q,we,0)),E.wrap=0,we>=E.w_size&&(d===0&&(re(E.head),E.strstart=0,E.block_start=0,E.insert=0),fe=new c.Buf8(E.w_size),c.arraySet(fe,Q,we-E.w_size,E.w_size,0),Q=fe,we=E.w_size),F=h.avail_in,$=h.next_in,P=h.input,h.avail_in=we,h.next_in=0,h.input=Q,H(E);E.lookahead>=I;){for(o=E.strstart,a=E.lookahead-(I-1);E.ins_h=(E.ins_h<<E.hash_shift^E.window[o+I-1])&E.hash_mask,E.prev[o&E.w_mask]=E.head[E.ins_h],E.head[E.ins_h]=o,o++,--a;);E.strstart=o,E.lookahead=I-1,H(E)}return E.strstart+=E.lookahead,E.block_start=E.strstart,E.insert=E.lookahead,E.lookahead=0,E.match_length=E.prev_length=I-1,E.match_available=0,h.next_in=$,h.input=P,h.avail_in=F,E.wrap=d,p},l.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,s,l){s.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,s,l){s.exports=function(i,c){var n,u,m,w,b,T,p,S,y,_,f,x,k,C,D,q,M,J,I,ue,ee,B,W,A,z;n=i.state,u=i.next_in,A=i.input,m=u+(i.avail_in-5),w=i.next_out,z=i.output,b=w-(c-i.avail_out),T=w+(i.avail_out-257),p=n.dmax,S=n.wsize,y=n.whave,_=n.wnext,f=n.window,x=n.hold,k=n.bits,C=n.lencode,D=n.distcode,q=(1<<n.lenbits)-1,M=(1<<n.distbits)-1;e:do{k<15&&(x+=A[u++]<<k,k+=8,x+=A[u++]<<k,k+=8),J=C[x&q];t:for(;;){if(x>>>=I=J>>>24,k-=I,(I=J>>>16&255)===0)z[w++]=65535&J;else{if(!(16&I)){if(!(64&I)){J=C[(65535&J)+(x&(1<<I)-1)];continue t}if(32&I){n.mode=12;break e}i.msg="invalid literal/length code",n.mode=30;break e}ue=65535&J,(I&=15)&&(k<I&&(x+=A[u++]<<k,k+=8),ue+=x&(1<<I)-1,x>>>=I,k-=I),k<15&&(x+=A[u++]<<k,k+=8,x+=A[u++]<<k,k+=8),J=D[x&M];r:for(;;){if(x>>>=I=J>>>24,k-=I,!(16&(I=J>>>16&255))){if(!(64&I)){J=D[(65535&J)+(x&(1<<I)-1)];continue r}i.msg="invalid distance code",n.mode=30;break e}if(ee=65535&J,k<(I&=15)&&(x+=A[u++]<<k,(k+=8)<I&&(x+=A[u++]<<k,k+=8)),p<(ee+=x&(1<<I)-1)){i.msg="invalid distance too far back",n.mode=30;break e}if(x>>>=I,k-=I,(I=w-b)<ee){if(y<(I=ee-I)&&n.sane){i.msg="invalid distance too far back",n.mode=30;break e}if(W=f,(B=0)===_){if(B+=S-I,I<ue){for(ue-=I;z[w++]=f[B++],--I;);B=w-ee,W=z}}else if(_<I){if(B+=S+_-I,(I-=_)<ue){for(ue-=I;z[w++]=f[B++],--I;);if(B=0,_<ue){for(ue-=I=_;z[w++]=f[B++],--I;);B=w-ee,W=z}}}else if(B+=_-I,I<ue){for(ue-=I;z[w++]=f[B++],--I;);B=w-ee,W=z}for(;2<ue;)z[w++]=W[B++],z[w++]=W[B++],z[w++]=W[B++],ue-=3;ue&&(z[w++]=W[B++],1<ue&&(z[w++]=W[B++]))}else{for(B=w-ee;z[w++]=z[B++],z[w++]=z[B++],z[w++]=z[B++],2<(ue-=3););ue&&(z[w++]=z[B++],1<ue&&(z[w++]=z[B++]))}break}}break}}while(u<m&&w<T);u-=ue=k>>3,x&=(1<<(k-=ue<<3))-1,i.next_in=u,i.next_out=w,i.avail_in=u<m?m-u+5:5-(u-m),i.avail_out=w<T?T-w+257:257-(w-T),n.hold=x,n.bits=k}},{}],49:[function(t,s,l){var i=t("../utils/common"),c=t("./adler32"),n=t("./crc32"),u=t("./inffast"),m=t("./inftrees"),w=1,b=2,T=0,p=-2,S=1,y=852,_=592;function f(B){return(B>>>24&255)+(B>>>8&65280)+((65280&B)<<8)+((255&B)<<24)}function x(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function k(B){var W;return B&&B.state?(W=B.state,B.total_in=B.total_out=W.total=0,B.msg="",W.wrap&&(B.adler=1&W.wrap),W.mode=S,W.last=0,W.havedict=0,W.dmax=32768,W.head=null,W.hold=0,W.bits=0,W.lencode=W.lendyn=new i.Buf32(y),W.distcode=W.distdyn=new i.Buf32(_),W.sane=1,W.back=-1,T):p}function C(B){var W;return B&&B.state?((W=B.state).wsize=0,W.whave=0,W.wnext=0,k(B)):p}function D(B,W){var A,z;return B&&B.state?(z=B.state,W<0?(A=0,W=-W):(A=1+(W>>4),W<48&&(W&=15)),W&&(W<8||15<W)?p:(z.window!==null&&z.wbits!==W&&(z.window=null),z.wrap=A,z.wbits=W,C(B))):p}function q(B,W){var A,z;return B?(z=new x,(B.state=z).window=null,(A=D(B,W))!==T&&(B.state=null),A):p}var M,J,I=!0;function ue(B){if(I){var W;for(M=new i.Buf32(512),J=new i.Buf32(32),W=0;W<144;)B.lens[W++]=8;for(;W<256;)B.lens[W++]=9;for(;W<280;)B.lens[W++]=7;for(;W<288;)B.lens[W++]=8;for(m(w,B.lens,0,288,M,0,B.work,{bits:9}),W=0;W<32;)B.lens[W++]=5;m(b,B.lens,0,32,J,0,B.work,{bits:5}),I=!1}B.lencode=M,B.lenbits=9,B.distcode=J,B.distbits=5}function ee(B,W,A,z){var se,V=B.state;return V.window===null&&(V.wsize=1<<V.wbits,V.wnext=0,V.whave=0,V.window=new i.Buf8(V.wsize)),z>=V.wsize?(i.arraySet(V.window,W,A-V.wsize,V.wsize,0),V.wnext=0,V.whave=V.wsize):(z<(se=V.wsize-V.wnext)&&(se=z),i.arraySet(V.window,W,A-z,se,V.wnext),(z-=se)?(i.arraySet(V.window,W,A-z,z,0),V.wnext=z,V.whave=V.wsize):(V.wnext+=se,V.wnext===V.wsize&&(V.wnext=0),V.whave<V.wsize&&(V.whave+=se))),0}l.inflateReset=C,l.inflateReset2=D,l.inflateResetKeep=k,l.inflateInit=function(B){return q(B,15)},l.inflateInit2=q,l.inflate=function(B,W){var A,z,se,V,ye,Z,re,j,R,K,X,oe,H,v,g,U,L,N,O,ae,h,Q,E,o,a=0,d=new i.Buf8(4),F=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!B||!B.state||!B.output||!B.input&&B.avail_in!==0)return p;(A=B.state).mode===12&&(A.mode=13),ye=B.next_out,se=B.output,re=B.avail_out,V=B.next_in,z=B.input,Z=B.avail_in,j=A.hold,R=A.bits,K=Z,X=re,Q=T;e:for(;;)switch(A.mode){case S:if(A.wrap===0){A.mode=13;break}for(;R<16;){if(Z===0)break e;Z--,j+=z[V++]<<R,R+=8}if(2&A.wrap&&j===35615){d[A.check=0]=255&j,d[1]=j>>>8&255,A.check=n(A.check,d,2,0),R=j=0,A.mode=2;break}if(A.flags=0,A.head&&(A.head.done=!1),!(1&A.wrap)||(((255&j)<<8)+(j>>8))%31){B.msg="incorrect header check",A.mode=30;break}if((15&j)!=8){B.msg="unknown compression method",A.mode=30;break}if(R-=4,h=8+(15&(j>>>=4)),A.wbits===0)A.wbits=h;else if(h>A.wbits){B.msg="invalid window size",A.mode=30;break}A.dmax=1<<h,B.adler=A.check=1,A.mode=512&j?10:12,R=j=0;break;case 2:for(;R<16;){if(Z===0)break e;Z--,j+=z[V++]<<R,R+=8}if(A.flags=j,(255&A.flags)!=8){B.msg="unknown compression method",A.mode=30;break}if(57344&A.flags){B.msg="unknown header flags set",A.mode=30;break}A.head&&(A.head.text=j>>8&1),512&A.flags&&(d[0]=255&j,d[1]=j>>>8&255,A.check=n(A.check,d,2,0)),R=j=0,A.mode=3;case 3:for(;R<32;){if(Z===0)break e;Z--,j+=z[V++]<<R,R+=8}A.head&&(A.head.time=j),512&A.flags&&(d[0]=255&j,d[1]=j>>>8&255,d[2]=j>>>16&255,d[3]=j>>>24&255,A.check=n(A.check,d,4,0)),R=j=0,A.mode=4;case 4:for(;R<16;){if(Z===0)break e;Z--,j+=z[V++]<<R,R+=8}A.head&&(A.head.xflags=255&j,A.head.os=j>>8),512&A.flags&&(d[0]=255&j,d[1]=j>>>8&255,A.check=n(A.check,d,2,0)),R=j=0,A.mode=5;case 5:if(1024&A.flags){for(;R<16;){if(Z===0)break e;Z--,j+=z[V++]<<R,R+=8}A.length=j,A.head&&(A.head.extra_len=j),512&A.flags&&(d[0]=255&j,d[1]=j>>>8&255,A.check=n(A.check,d,2,0)),R=j=0}else A.head&&(A.head.extra=null);A.mode=6;case 6:if(1024&A.flags&&(Z<(oe=A.length)&&(oe=Z),oe&&(A.head&&(h=A.head.extra_len-A.length,A.head.extra||(A.head.extra=new Array(A.head.extra_len)),i.arraySet(A.head.extra,z,V,oe,h)),512&A.flags&&(A.check=n(A.check,z,oe,V)),Z-=oe,V+=oe,A.length-=oe),A.length))break e;A.length=0,A.mode=7;case 7:if(2048&A.flags){if(Z===0)break e;for(oe=0;h=z[V+oe++],A.head&&h&&A.length<65536&&(A.head.name+=String.fromCharCode(h)),h&&oe<Z;);if(512&A.flags&&(A.check=n(A.check,z,oe,V)),Z-=oe,V+=oe,h)break e}else A.head&&(A.head.name=null);A.length=0,A.mode=8;case 8:if(4096&A.flags){if(Z===0)break e;for(oe=0;h=z[V+oe++],A.head&&h&&A.length<65536&&(A.head.comment+=String.fromCharCode(h)),h&&oe<Z;);if(512&A.flags&&(A.check=n(A.check,z,oe,V)),Z-=oe,V+=oe,h)break e}else A.head&&(A.head.comment=null);A.mode=9;case 9:if(512&A.flags){for(;R<16;){if(Z===0)break e;Z--,j+=z[V++]<<R,R+=8}if(j!==(65535&A.check)){B.msg="header crc mismatch",A.mode=30;break}R=j=0}A.head&&(A.head.hcrc=A.flags>>9&1,A.head.done=!0),B.adler=A.check=0,A.mode=12;break;case 10:for(;R<32;){if(Z===0)break e;Z--,j+=z[V++]<<R,R+=8}B.adler=A.check=f(j),R=j=0,A.mode=11;case 11:if(A.havedict===0)return B.next_out=ye,B.avail_out=re,B.next_in=V,B.avail_in=Z,A.hold=j,A.bits=R,2;B.adler=A.check=1,A.mode=12;case 12:if(W===5||W===6)break e;case 13:if(A.last){j>>>=7&R,R-=7&R,A.mode=27;break}for(;R<3;){if(Z===0)break e;Z--,j+=z[V++]<<R,R+=8}switch(A.last=1&j,R-=1,3&(j>>>=1)){case 0:A.mode=14;break;case 1:if(ue(A),A.mode=20,W!==6)break;j>>>=2,R-=2;break e;case 2:A.mode=17;break;case 3:B.msg="invalid block type",A.mode=30}j>>>=2,R-=2;break;case 14:for(j>>>=7&R,R-=7&R;R<32;){if(Z===0)break e;Z--,j+=z[V++]<<R,R+=8}if((65535&j)!=(j>>>16^65535)){B.msg="invalid stored block lengths",A.mode=30;break}if(A.length=65535&j,R=j=0,A.mode=15,W===6)break e;case 15:A.mode=16;case 16:if(oe=A.length){if(Z<oe&&(oe=Z),re<oe&&(oe=re),oe===0)break e;i.arraySet(se,z,V,oe,ye),Z-=oe,V+=oe,re-=oe,ye+=oe,A.length-=oe;break}A.mode=12;break;case 17:for(;R<14;){if(Z===0)break e;Z--,j+=z[V++]<<R,R+=8}if(A.nlen=257+(31&j),j>>>=5,R-=5,A.ndist=1+(31&j),j>>>=5,R-=5,A.ncode=4+(15&j),j>>>=4,R-=4,286<A.nlen||30<A.ndist){B.msg="too many length or distance symbols",A.mode=30;break}A.have=0,A.mode=18;case 18:for(;A.have<A.ncode;){for(;R<3;){if(Z===0)break e;Z--,j+=z[V++]<<R,R+=8}A.lens[F[A.have++]]=7&j,j>>>=3,R-=3}for(;A.have<19;)A.lens[F[A.have++]]=0;if(A.lencode=A.lendyn,A.lenbits=7,E={bits:A.lenbits},Q=m(0,A.lens,0,19,A.lencode,0,A.work,E),A.lenbits=E.bits,Q){B.msg="invalid code lengths set",A.mode=30;break}A.have=0,A.mode=19;case 19:for(;A.have<A.nlen+A.ndist;){for(;U=(a=A.lencode[j&(1<<A.lenbits)-1])>>>16&255,L=65535&a,!((g=a>>>24)<=R);){if(Z===0)break e;Z--,j+=z[V++]<<R,R+=8}if(L<16)j>>>=g,R-=g,A.lens[A.have++]=L;else{if(L===16){for(o=g+2;R<o;){if(Z===0)break e;Z--,j+=z[V++]<<R,R+=8}if(j>>>=g,R-=g,A.have===0){B.msg="invalid bit length repeat",A.mode=30;break}h=A.lens[A.have-1],oe=3+(3&j),j>>>=2,R-=2}else if(L===17){for(o=g+3;R<o;){if(Z===0)break e;Z--,j+=z[V++]<<R,R+=8}R-=g,h=0,oe=3+(7&(j>>>=g)),j>>>=3,R-=3}else{for(o=g+7;R<o;){if(Z===0)break e;Z--,j+=z[V++]<<R,R+=8}R-=g,h=0,oe=11+(127&(j>>>=g)),j>>>=7,R-=7}if(A.have+oe>A.nlen+A.ndist){B.msg="invalid bit length repeat",A.mode=30;break}for(;oe--;)A.lens[A.have++]=h}}if(A.mode===30)break;if(A.lens[256]===0){B.msg="invalid code -- missing end-of-block",A.mode=30;break}if(A.lenbits=9,E={bits:A.lenbits},Q=m(w,A.lens,0,A.nlen,A.lencode,0,A.work,E),A.lenbits=E.bits,Q){B.msg="invalid literal/lengths set",A.mode=30;break}if(A.distbits=6,A.distcode=A.distdyn,E={bits:A.distbits},Q=m(b,A.lens,A.nlen,A.ndist,A.distcode,0,A.work,E),A.distbits=E.bits,Q){B.msg="invalid distances set",A.mode=30;break}if(A.mode=20,W===6)break e;case 20:A.mode=21;case 21:if(6<=Z&&258<=re){B.next_out=ye,B.avail_out=re,B.next_in=V,B.avail_in=Z,A.hold=j,A.bits=R,u(B,X),ye=B.next_out,se=B.output,re=B.avail_out,V=B.next_in,z=B.input,Z=B.avail_in,j=A.hold,R=A.bits,A.mode===12&&(A.back=-1);break}for(A.back=0;U=(a=A.lencode[j&(1<<A.lenbits)-1])>>>16&255,L=65535&a,!((g=a>>>24)<=R);){if(Z===0)break e;Z--,j+=z[V++]<<R,R+=8}if(U&&!(240&U)){for(N=g,O=U,ae=L;U=(a=A.lencode[ae+((j&(1<<N+O)-1)>>N)])>>>16&255,L=65535&a,!(N+(g=a>>>24)<=R);){if(Z===0)break e;Z--,j+=z[V++]<<R,R+=8}j>>>=N,R-=N,A.back+=N}if(j>>>=g,R-=g,A.back+=g,A.length=L,U===0){A.mode=26;break}if(32&U){A.back=-1,A.mode=12;break}if(64&U){B.msg="invalid literal/length code",A.mode=30;break}A.extra=15&U,A.mode=22;case 22:if(A.extra){for(o=A.extra;R<o;){if(Z===0)break e;Z--,j+=z[V++]<<R,R+=8}A.length+=j&(1<<A.extra)-1,j>>>=A.extra,R-=A.extra,A.back+=A.extra}A.was=A.length,A.mode=23;case 23:for(;U=(a=A.distcode[j&(1<<A.distbits)-1])>>>16&255,L=65535&a,!((g=a>>>24)<=R);){if(Z===0)break e;Z--,j+=z[V++]<<R,R+=8}if(!(240&U)){for(N=g,O=U,ae=L;U=(a=A.distcode[ae+((j&(1<<N+O)-1)>>N)])>>>16&255,L=65535&a,!(N+(g=a>>>24)<=R);){if(Z===0)break e;Z--,j+=z[V++]<<R,R+=8}j>>>=N,R-=N,A.back+=N}if(j>>>=g,R-=g,A.back+=g,64&U){B.msg="invalid distance code",A.mode=30;break}A.offset=L,A.extra=15&U,A.mode=24;case 24:if(A.extra){for(o=A.extra;R<o;){if(Z===0)break e;Z--,j+=z[V++]<<R,R+=8}A.offset+=j&(1<<A.extra)-1,j>>>=A.extra,R-=A.extra,A.back+=A.extra}if(A.offset>A.dmax){B.msg="invalid distance too far back",A.mode=30;break}A.mode=25;case 25:if(re===0)break e;if(oe=X-re,A.offset>oe){if((oe=A.offset-oe)>A.whave&&A.sane){B.msg="invalid distance too far back",A.mode=30;break}H=oe>A.wnext?(oe-=A.wnext,A.wsize-oe):A.wnext-oe,oe>A.length&&(oe=A.length),v=A.window}else v=se,H=ye-A.offset,oe=A.length;for(re<oe&&(oe=re),re-=oe,A.length-=oe;se[ye++]=v[H++],--oe;);A.length===0&&(A.mode=21);break;case 26:if(re===0)break e;se[ye++]=A.length,re--,A.mode=21;break;case 27:if(A.wrap){for(;R<32;){if(Z===0)break e;Z--,j|=z[V++]<<R,R+=8}if(X-=re,B.total_out+=X,A.total+=X,X&&(B.adler=A.check=A.flags?n(A.check,se,X,ye-X):c(A.check,se,X,ye-X)),X=re,(A.flags?j:f(j))!==A.check){B.msg="incorrect data check",A.mode=30;break}R=j=0}A.mode=28;case 28:if(A.wrap&&A.flags){for(;R<32;){if(Z===0)break e;Z--,j+=z[V++]<<R,R+=8}if(j!==(4294967295&A.total)){B.msg="incorrect length check",A.mode=30;break}R=j=0}A.mode=29;case 29:Q=1;break e;case 30:Q=-3;break e;case 31:return-4;case 32:default:return p}return B.next_out=ye,B.avail_out=re,B.next_in=V,B.avail_in=Z,A.hold=j,A.bits=R,(A.wsize||X!==B.avail_out&&A.mode<30&&(A.mode<27||W!==4))&&ee(B,B.output,B.next_out,X-B.avail_out)?(A.mode=31,-4):(K-=B.avail_in,X-=B.avail_out,B.total_in+=K,B.total_out+=X,A.total+=X,A.wrap&&X&&(B.adler=A.check=A.flags?n(A.check,se,X,B.next_out-X):c(A.check,se,X,B.next_out-X)),B.data_type=A.bits+(A.last?64:0)+(A.mode===12?128:0)+(A.mode===20||A.mode===15?256:0),(K==0&&X===0||W===4)&&Q===T&&(Q=-5),Q)},l.inflateEnd=function(B){if(!B||!B.state)return p;var W=B.state;return W.window&&(W.window=null),B.state=null,T},l.inflateGetHeader=function(B,W){var A;return B&&B.state&&2&(A=B.state).wrap?((A.head=W).done=!1,T):p},l.inflateSetDictionary=function(B,W){var A,z=W.length;return B&&B.state?(A=B.state).wrap!==0&&A.mode!==11?p:A.mode===11&&c(1,W,z,0)!==A.check?-3:ee(B,W,z,z)?(A.mode=31,-4):(A.havedict=1,T):p},l.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,s,l){var i=t("../utils/common"),c=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],n=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],u=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],m=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];s.exports=function(w,b,T,p,S,y,_,f){var x,k,C,D,q,M,J,I,ue,ee=f.bits,B=0,W=0,A=0,z=0,se=0,V=0,ye=0,Z=0,re=0,j=0,R=null,K=0,X=new i.Buf16(16),oe=new i.Buf16(16),H=null,v=0;for(B=0;B<=15;B++)X[B]=0;for(W=0;W<p;W++)X[b[T+W]]++;for(se=ee,z=15;1<=z&&X[z]===0;z--);if(z<se&&(se=z),z===0)return S[y++]=20971520,S[y++]=20971520,f.bits=1,0;for(A=1;A<z&&X[A]===0;A++);for(se<A&&(se=A),B=Z=1;B<=15;B++)if(Z<<=1,(Z-=X[B])<0)return-1;if(0<Z&&(w===0||z!==1))return-1;for(oe[1]=0,B=1;B<15;B++)oe[B+1]=oe[B]+X[B];for(W=0;W<p;W++)b[T+W]!==0&&(_[oe[b[T+W]]++]=W);if(M=w===0?(R=H=_,19):w===1?(R=c,K-=257,H=n,v-=257,256):(R=u,H=m,-1),B=A,q=y,ye=W=j=0,C=-1,D=(re=1<<(V=se))-1,w===1&&852<re||w===2&&592<re)return 1;for(;;){for(J=B-ye,ue=_[W]<M?(I=0,_[W]):_[W]>M?(I=H[v+_[W]],R[K+_[W]]):(I=96,0),x=1<<B-ye,A=k=1<<V;S[q+(j>>ye)+(k-=x)]=J<<24|I<<16|ue|0,k!==0;);for(x=1<<B-1;j&x;)x>>=1;if(x!==0?(j&=x-1,j+=x):j=0,W++,--X[B]==0){if(B===z)break;B=b[T+_[W]]}if(se<B&&(j&D)!==C){for(ye===0&&(ye=se),q+=A,Z=1<<(V=B-ye);V+ye<z&&!((Z-=X[V+ye])<=0);)V++,Z<<=1;if(re+=1<<V,w===1&&852<re||w===2&&592<re)return 1;S[C=j&D]=se<<24|V<<16|q-y|0}}return j!==0&&(S[q+j]=B-ye<<24|64<<16|0),f.bits=se,0}},{"../utils/common":41}],51:[function(t,s,l){s.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,s,l){var i=t("../utils/common"),c=0,n=1;function u(a){for(var d=a.length;0<=--d;)a[d]=0}var m=0,w=29,b=256,T=b+1+w,p=30,S=19,y=2*T+1,_=15,f=16,x=7,k=256,C=16,D=17,q=18,M=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],J=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],I=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],ue=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ee=new Array(2*(T+2));u(ee);var B=new Array(2*p);u(B);var W=new Array(512);u(W);var A=new Array(256);u(A);var z=new Array(w);u(z);var se,V,ye,Z=new Array(p);function re(a,d,F,$,P){this.static_tree=a,this.extra_bits=d,this.extra_base=F,this.elems=$,this.max_length=P,this.has_stree=a&&a.length}function j(a,d){this.dyn_tree=a,this.max_code=0,this.stat_desc=d}function R(a){return a<256?W[a]:W[256+(a>>>7)]}function K(a,d){a.pending_buf[a.pending++]=255&d,a.pending_buf[a.pending++]=d>>>8&255}function X(a,d,F){a.bi_valid>f-F?(a.bi_buf|=d<<a.bi_valid&65535,K(a,a.bi_buf),a.bi_buf=d>>f-a.bi_valid,a.bi_valid+=F-f):(a.bi_buf|=d<<a.bi_valid&65535,a.bi_valid+=F)}function oe(a,d,F){X(a,F[2*d],F[2*d+1])}function H(a,d){for(var F=0;F|=1&a,a>>>=1,F<<=1,0<--d;);return F>>>1}function v(a,d,F){var $,P,fe=new Array(_+1),we=0;for($=1;$<=_;$++)fe[$]=we=we+F[$-1]<<1;for(P=0;P<=d;P++){var he=a[2*P+1];he!==0&&(a[2*P]=H(fe[he]++,he))}}function g(a){var d;for(d=0;d<T;d++)a.dyn_ltree[2*d]=0;for(d=0;d<p;d++)a.dyn_dtree[2*d]=0;for(d=0;d<S;d++)a.bl_tree[2*d]=0;a.dyn_ltree[2*k]=1,a.opt_len=a.static_len=0,a.last_lit=a.matches=0}function U(a){8<a.bi_valid?K(a,a.bi_buf):0<a.bi_valid&&(a.pending_buf[a.pending++]=a.bi_buf),a.bi_buf=0,a.bi_valid=0}function L(a,d,F,$){var P=2*d,fe=2*F;return a[P]<a[fe]||a[P]===a[fe]&&$[d]<=$[F]}function N(a,d,F){for(var $=a.heap[F],P=F<<1;P<=a.heap_len&&(P<a.heap_len&&L(d,a.heap[P+1],a.heap[P],a.depth)&&P++,!L(d,$,a.heap[P],a.depth));)a.heap[F]=a.heap[P],F=P,P<<=1;a.heap[F]=$}function O(a,d,F){var $,P,fe,we,he=0;if(a.last_lit!==0)for(;$=a.pending_buf[a.d_buf+2*he]<<8|a.pending_buf[a.d_buf+2*he+1],P=a.pending_buf[a.l_buf+he],he++,$===0?oe(a,P,d):(oe(a,(fe=A[P])+b+1,d),(we=M[fe])!==0&&X(a,P-=z[fe],we),oe(a,fe=R(--$),F),(we=J[fe])!==0&&X(a,$-=Z[fe],we)),he<a.last_lit;);oe(a,k,d)}function ae(a,d){var F,$,P,fe=d.dyn_tree,we=d.stat_desc.static_tree,he=d.stat_desc.has_stree,xe=d.stat_desc.elems,ke=-1;for(a.heap_len=0,a.heap_max=y,F=0;F<xe;F++)fe[2*F]!==0?(a.heap[++a.heap_len]=ke=F,a.depth[F]=0):fe[2*F+1]=0;for(;a.heap_len<2;)fe[2*(P=a.heap[++a.heap_len]=ke<2?++ke:0)]=1,a.depth[P]=0,a.opt_len--,he&&(a.static_len-=we[2*P+1]);for(d.max_code=ke,F=a.heap_len>>1;1<=F;F--)N(a,fe,F);for(P=xe;F=a.heap[1],a.heap[1]=a.heap[a.heap_len--],N(a,fe,1),$=a.heap[1],a.heap[--a.heap_max]=F,a.heap[--a.heap_max]=$,fe[2*P]=fe[2*F]+fe[2*$],a.depth[P]=(a.depth[F]>=a.depth[$]?a.depth[F]:a.depth[$])+1,fe[2*F+1]=fe[2*$+1]=P,a.heap[1]=P++,N(a,fe,1),2<=a.heap_len;);a.heap[--a.heap_max]=a.heap[1],function(Ne,ot){var mt,ft,Et,Ge,G,ne,le=ot.dyn_tree,be=ot.max_code,Te=ot.stat_desc.static_tree,Ee=ot.stat_desc.has_stree,Ce=ot.stat_desc.extra_bits,Re=ot.stat_desc.extra_base,Ue=ot.stat_desc.max_length,je=0;for(Ge=0;Ge<=_;Ge++)Ne.bl_count[Ge]=0;for(le[2*Ne.heap[Ne.heap_max]+1]=0,mt=Ne.heap_max+1;mt<y;mt++)Ue<(Ge=le[2*le[2*(ft=Ne.heap[mt])+1]+1]+1)&&(Ge=Ue,je++),le[2*ft+1]=Ge,be<ft||(Ne.bl_count[Ge]++,G=0,Re<=ft&&(G=Ce[ft-Re]),ne=le[2*ft],Ne.opt_len+=ne*(Ge+G),Ee&&(Ne.static_len+=ne*(Te[2*ft+1]+G)));if(je!==0){do{for(Ge=Ue-1;Ne.bl_count[Ge]===0;)Ge--;Ne.bl_count[Ge]--,Ne.bl_count[Ge+1]+=2,Ne.bl_count[Ue]--,je-=2}while(0<je);for(Ge=Ue;Ge!==0;Ge--)for(ft=Ne.bl_count[Ge];ft!==0;)be<(Et=Ne.heap[--mt])||(le[2*Et+1]!==Ge&&(Ne.opt_len+=(Ge-le[2*Et+1])*le[2*Et],le[2*Et+1]=Ge),ft--)}}(a,d),v(fe,ke,a.bl_count)}function h(a,d,F){var $,P,fe=-1,we=d[1],he=0,xe=7,ke=4;for(we===0&&(xe=138,ke=3),d[2*(F+1)+1]=65535,$=0;$<=F;$++)P=we,we=d[2*($+1)+1],++he<xe&&P===we||(he<ke?a.bl_tree[2*P]+=he:P!==0?(P!==fe&&a.bl_tree[2*P]++,a.bl_tree[2*C]++):he<=10?a.bl_tree[2*D]++:a.bl_tree[2*q]++,fe=P,ke=(he=0)===we?(xe=138,3):P===we?(xe=6,3):(xe=7,4))}function Q(a,d,F){var $,P,fe=-1,we=d[1],he=0,xe=7,ke=4;for(we===0&&(xe=138,ke=3),$=0;$<=F;$++)if(P=we,we=d[2*($+1)+1],!(++he<xe&&P===we)){if(he<ke)for(;oe(a,P,a.bl_tree),--he!=0;);else P!==0?(P!==fe&&(oe(a,P,a.bl_tree),he--),oe(a,C,a.bl_tree),X(a,he-3,2)):he<=10?(oe(a,D,a.bl_tree),X(a,he-3,3)):(oe(a,q,a.bl_tree),X(a,he-11,7));fe=P,ke=(he=0)===we?(xe=138,3):P===we?(xe=6,3):(xe=7,4)}}u(Z);var E=!1;function o(a,d,F,$){X(a,(m<<1)+($?1:0),3),function(P,fe,we,he){U(P),K(P,we),K(P,~we),i.arraySet(P.pending_buf,P.window,fe,we,P.pending),P.pending+=we}(a,d,F)}l._tr_init=function(a){E||(function(){var d,F,$,P,fe,we=new Array(_+1);for(P=$=0;P<w-1;P++)for(z[P]=$,d=0;d<1<<M[P];d++)A[$++]=P;for(A[$-1]=P,P=fe=0;P<16;P++)for(Z[P]=fe,d=0;d<1<<J[P];d++)W[fe++]=P;for(fe>>=7;P<p;P++)for(Z[P]=fe<<7,d=0;d<1<<J[P]-7;d++)W[256+fe++]=P;for(F=0;F<=_;F++)we[F]=0;for(d=0;d<=143;)ee[2*d+1]=8,d++,we[8]++;for(;d<=255;)ee[2*d+1]=9,d++,we[9]++;for(;d<=279;)ee[2*d+1]=7,d++,we[7]++;for(;d<=287;)ee[2*d+1]=8,d++,we[8]++;for(v(ee,T+1,we),d=0;d<p;d++)B[2*d+1]=5,B[2*d]=H(d,5);se=new re(ee,M,b+1,T,_),V=new re(B,J,0,p,_),ye=new re(new Array(0),I,0,S,x)}(),E=!0),a.l_desc=new j(a.dyn_ltree,se),a.d_desc=new j(a.dyn_dtree,V),a.bl_desc=new j(a.bl_tree,ye),a.bi_buf=0,a.bi_valid=0,g(a)},l._tr_stored_block=o,l._tr_flush_block=function(a,d,F,$){var P,fe,we=0;0<a.level?(a.strm.data_type===2&&(a.strm.data_type=function(he){var xe,ke=4093624447;for(xe=0;xe<=31;xe++,ke>>>=1)if(1&ke&&he.dyn_ltree[2*xe]!==0)return c;if(he.dyn_ltree[18]!==0||he.dyn_ltree[20]!==0||he.dyn_ltree[26]!==0)return n;for(xe=32;xe<b;xe++)if(he.dyn_ltree[2*xe]!==0)return n;return c}(a)),ae(a,a.l_desc),ae(a,a.d_desc),we=function(he){var xe;for(h(he,he.dyn_ltree,he.l_desc.max_code),h(he,he.dyn_dtree,he.d_desc.max_code),ae(he,he.bl_desc),xe=S-1;3<=xe&&he.bl_tree[2*ue[xe]+1]===0;xe--);return he.opt_len+=3*(xe+1)+5+5+4,xe}(a),P=a.opt_len+3+7>>>3,(fe=a.static_len+3+7>>>3)<=P&&(P=fe)):P=fe=F+5,F+4<=P&&d!==-1?o(a,d,F,$):a.strategy===4||fe===P?(X(a,2+($?1:0),3),O(a,ee,B)):(X(a,4+($?1:0),3),function(he,xe,ke,Ne){var ot;for(X(he,xe-257,5),X(he,ke-1,5),X(he,Ne-4,4),ot=0;ot<Ne;ot++)X(he,he.bl_tree[2*ue[ot]+1],3);Q(he,he.dyn_ltree,xe-1),Q(he,he.dyn_dtree,ke-1)}(a,a.l_desc.max_code+1,a.d_desc.max_code+1,we+1),O(a,a.dyn_ltree,a.dyn_dtree)),g(a),$&&U(a)},l._tr_tally=function(a,d,F){return a.pending_buf[a.d_buf+2*a.last_lit]=d>>>8&255,a.pending_buf[a.d_buf+2*a.last_lit+1]=255&d,a.pending_buf[a.l_buf+a.last_lit]=255&F,a.last_lit++,d===0?a.dyn_ltree[2*F]++:(a.matches++,d--,a.dyn_ltree[2*(A[F]+b+1)]++,a.dyn_dtree[2*R(d)]++),a.last_lit===a.lit_bufsize-1},l._tr_align=function(a){X(a,2,3),oe(a,k,ee),function(d){d.bi_valid===16?(K(d,d.bi_buf),d.bi_buf=0,d.bi_valid=0):8<=d.bi_valid&&(d.pending_buf[d.pending++]=255&d.bi_buf,d.bi_buf>>=8,d.bi_valid-=8)}(a)}},{"../utils/common":41}],53:[function(t,s,l){s.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,s,l){(function(i){(function(c,n){if(!c.setImmediate){var u,m,w,b,T=1,p={},S=!1,y=c.document,_=Object.getPrototypeOf&&Object.getPrototypeOf(c);_=_&&_.setTimeout?_:c,u={}.toString.call(c.process)==="[object process]"?function(C){Me.nextTick(function(){x(C)})}:function(){if(c.postMessage&&!c.importScripts){var C=!0,D=c.onmessage;return c.onmessage=function(){C=!1},c.postMessage("","*"),c.onmessage=D,C}}()?(b="setImmediate$"+Math.random()+"$",c.addEventListener?c.addEventListener("message",k,!1):c.attachEvent("onmessage",k),function(C){c.postMessage(b+C,"*")}):c.MessageChannel?((w=new MessageChannel).port1.onmessage=function(C){x(C.data)},function(C){w.port2.postMessage(C)}):y&&"onreadystatechange"in y.createElement("script")?(m=y.documentElement,function(C){var D=y.createElement("script");D.onreadystatechange=function(){x(C),D.onreadystatechange=null,m.removeChild(D),D=null},m.appendChild(D)}):function(C){setTimeout(x,0,C)},_.setImmediate=function(C){typeof C!="function"&&(C=new Function(""+C));for(var D=new Array(arguments.length-1),q=0;q<D.length;q++)D[q]=arguments[q+1];var M={callback:C,args:D};return p[T]=M,u(T),T++},_.clearImmediate=f}function f(C){delete p[C]}function x(C){if(S)setTimeout(x,0,C);else{var D=p[C];if(D){S=!0;try{(function(q){var M=q.callback,J=q.args;switch(J.length){case 0:M();break;case 1:M(J[0]);break;case 2:M(J[0],J[1]);break;case 3:M(J[0],J[1],J[2]);break;default:M.apply(n,J)}})(D)}finally{f(C),S=!1}}}}function k(C){C.source===c&&typeof C.data=="string"&&C.data.indexOf(b)===0&&x(+C.data.slice(b.length))}})(typeof self>"u"?i===void 0?this:i:self)}).call(this,typeof Rt<"u"?Rt:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(na);var Hf=na.exports;const Wf=as(Hf);var Vr={exports:{}},Gf={"&":"&amp;",'"':"&quot;","'":"&apos;","<":"&lt;",">":"&gt;"};function $f(r){return r&&r.replace?r.replace(/([&"<>'])/g,function(e,t){return Gf[t]}):r}var Vf=$f,ci=Vf,Mo=yi.Stream,Kf="    ";function qf(r,e){typeof e!="object"&&(e={indent:e});var t=e.stream?new Mo:null,s="",l=!1,i=e.indent?e.indent===!0?Kf:e.indent:"",c=!0;function n(T){c?Me.nextTick(T):T()}function u(T,p){if(p!==void 0&&(s+=p),T&&!l&&(t=t||new Mo,l=!0),T&&l){var S=s;n(function(){t.emit("data",S)}),s=""}}function m(T,p){Ii(u,Kr(T,i,i?1:0),p)}function w(){if(t){var T=s;n(function(){t.emit("data",T),t.emit("end"),t.readable=!1,t.emit("close")})}}function b(T){var p=T.encoding||"UTF-8",S={version:"1.0",encoding:p};T.standalone&&(S.standalone=T.standalone),m({"?xml":{_attr:S}}),s=s.replace("/>","?>")}return n(function(){c=!1}),e.declaration&&b(e.declaration),r&&r.forEach?r.forEach(function(T,p){var S;p+1===r.length&&(S=w),m(T,S)}):m(r,w),t?(t.readable=!0,t):s}function Xf(){var r=Array.prototype.slice.call(arguments),e={_elem:Kr(r)};return e.push=function(t){if(!this.append)throw new Error("not assigned to a parent!");var s=this,l=this._elem.indent;Ii(this.append,Kr(t,l,this._elem.icount+(l?1:0)),function(){s.append(!0)})},e.close=function(t){t!==void 0&&this.push(t),this.end&&this.end()},e}function Zf(r,e){return new Array(e||0).join(r||"")}function Kr(r,e,t){t=t||0;var s=Zf(e,t),l,i=r,c=!1;if(typeof r=="object"){var n=Object.keys(r);if(l=n[0],i=r[l],i&&i._elem)return i._elem.name=l,i._elem.icount=t,i._elem.indent=e,i._elem.indents=s,i._elem.interrupt=i,i._elem}var u=[],m=[],w;function b(T){var p=Object.keys(T);p.forEach(function(S){u.push(Yf(S,T[S]))})}switch(typeof i){case"object":if(i===null)break;i._attr&&b(i._attr),i._cdata&&m.push(("<![CDATA["+i._cdata).replace(/\]\]>/g,"]]]]><![CDATA[>")+"]]>"),i.forEach&&(w=!1,m.push(""),i.forEach(function(T){if(typeof T=="object"){var p=Object.keys(T)[0];p=="_attr"?b(T._attr):m.push(Kr(T,e,t+1))}else m.pop(),w=!0,m.push(ci(T))}),w||m.push(""));break;default:m.push(ci(i))}return{name:l,interrupt:c,attributes:u,content:m,icount:t,indents:s,indent:e}}function Ii(r,e,t){if(typeof e!="object")return r(!1,e);var s=e.interrupt?1:e.content.length;function l(){for(;e.content.length;){var c=e.content.shift();if(c!==void 0){if(i(c))return;Ii(r,c)}}r(!1,(s>1?e.indents:"")+(e.name?"</"+e.name+">":"")+(e.indent&&!t?`
`:"")),t&&t()}function i(c){return c.interrupt?(c.interrupt.append=r,c.interrupt.end=l,c.interrupt=!1,r(!0),!0):!1}if(r(!1,e.indents+(e.name?"<"+e.name:"")+(e.attributes.length?" "+e.attributes.join(" "):"")+(s?e.name?">":"":e.name?"/>":"")+(e.indent&&s>1?`
`:"")),!s)return r(!1,e.indent?`
`:"");i(e)||l()}function Yf(r,e){return r+'="'+ci(e)+'"'}Vr.exports=qf;Vr.exports.element=Vr.exports.Element=Xf;var Jf=Vr.exports;const tt=as(Jf),jo=0,zo=32,Qf=32,eh=(r,e)=>{const t=e.replace(/-/g,"");if(t.length!==Qf)throw new Error(`Error: Cannot extract GUID from font filename: ${e}`);const l=t.replace(/(..)/g,"$1 ").trim().split(" ").map(u=>parseInt(u,16));l.reverse();const c=r.slice(jo,zo).map((u,m)=>u^l[m%l.length]);return Buffer.concat([r.slice(0,jo),c,r.slice(zo)])};class th{format(e,t={stack:[]}){const s=e.prepForXml(t);if(s)return s;throw Error("XMLComponent did not format correctly")}}class rh{replace(e,t,s){let l=e;return t.forEach((i,c)=>{l=l.replace(new RegExp(`{${i.fileName}}`,"g"),(s+c).toString())}),l}getMediaData(e,t){return t.Array.filter(s=>e.search(`{${s.fileName}}`)>0)}}class nh{replace(e,t){let s=e;for(const l of t)s=s.replace(new RegExp(`{${l.reference}-${l.instance}}`,"g"),l.numId.toString());return s}}class ih{constructor(){ge(this,"formatter"),ge(this,"imageReplacer"),ge(this,"numberingReplacer"),this.formatter=new th,this.imageReplacer=new rh,this.numberingReplacer=new nh}compile(e,t){const s=new Wf,l=this.xmlifyFile(e,t),i=new Map(Object.entries(l));for(const[,c]of i)if(Array.isArray(c))for(const n of c)s.file(n.path,n.data);else s.file(c.path,c.data);for(const{stream:c,fileName:n}of e.Media.Array)s.file(`word/media/${n}`,c);for(const{data:c,name:n,fontKey:u}of e.FontTable.fontOptionsWithKey){const[m]=n.split(".");s.file(`word/fonts/${m}.odttf`,eh(c,u))}return s}xmlifyFile(e,t){const s=e.Document.Relationships.RelationshipCount+1,l=tt(this.formatter.format(e.Document.View,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),i=this.imageReplacer.getMediaData(l,e.Media);return{Relationships:{data:(i.forEach((c,n)=>{e.Document.Relationships.createRelationship(s+n,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${c.fileName}`)}),tt(this.formatter.format(e.Document.Relationships,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}})),path:"word/_rels/document.xml.rels"},Document:{data:(()=>{const c=this.imageReplacer.replace(l,i,s);return this.numberingReplacer.replace(c,e.Numbering.ConcreteNumbering)})(),path:"word/document.xml"},Styles:{data:(()=>{const c=tt(this.formatter.format(e.Styles,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}});return this.numberingReplacer.replace(c,e.Numbering.ConcreteNumbering)})(),path:"word/styles.xml"},Properties:{data:tt(this.formatter.format(e.CoreProperties,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/core.xml"},Numbering:{data:tt(this.formatter.format(e.Numbering,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/numbering.xml"},FileRelationships:{data:tt(this.formatter.format(e.FileRelationships,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),path:"_rels/.rels"},HeaderRelationships:e.Headers.map((c,n)=>{const u=tt(this.formatter.format(c.View,{viewWrapper:c,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}});return this.imageReplacer.getMediaData(u,e.Media).forEach((w,b)=>{c.Relationships.createRelationship(b,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${w.fileName}`)}),{data:tt(this.formatter.format(c.Relationships,{viewWrapper:c,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),path:`word/_rels/header${n+1}.xml.rels`}}),FooterRelationships:e.Footers.map((c,n)=>{const u=tt(this.formatter.format(c.View,{viewWrapper:c,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}});return this.imageReplacer.getMediaData(u,e.Media).forEach((w,b)=>{c.Relationships.createRelationship(b,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${w.fileName}`)}),{data:tt(this.formatter.format(c.Relationships,{viewWrapper:c,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),path:`word/_rels/footer${n+1}.xml.rels`}}),Headers:e.Headers.map((c,n)=>{const u=tt(this.formatter.format(c.View,{viewWrapper:c,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),m=this.imageReplacer.getMediaData(u,e.Media),w=this.imageReplacer.replace(u,m,0);return{data:this.numberingReplacer.replace(w,e.Numbering.ConcreteNumbering),path:`word/header${n+1}.xml`}}),Footers:e.Footers.map((c,n)=>{const u=tt(this.formatter.format(c.View,{viewWrapper:c,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),m=this.imageReplacer.getMediaData(u,e.Media),w=this.imageReplacer.replace(u,m,0);return{data:this.numberingReplacer.replace(w,e.Numbering.ConcreteNumbering),path:`word/footer${n+1}.xml`}}),ContentTypes:{data:tt(this.formatter.format(e.ContentTypes,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),path:"[Content_Types].xml"},CustomProperties:{data:tt(this.formatter.format(e.CustomProperties,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/custom.xml"},AppProperties:{data:tt(this.formatter.format(e.AppProperties,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/app.xml"},FootNotes:{data:tt(this.formatter.format(e.FootNotes.View,{viewWrapper:e.FootNotes,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),path:"word/footnotes.xml"},FootNotesRelationships:{data:tt(this.formatter.format(e.FootNotes.Relationships,{viewWrapper:e.FootNotes,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),path:"word/_rels/footnotes.xml.rels"},Settings:{data:tt(this.formatter.format(e.Settings,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/settings.xml"},Comments:{data:tt(this.formatter.format(e.Comments,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/comments.xml"},FontTable:{data:tt(this.formatter.format(e.FontTable.View,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/fontTable.xml"},FontTableRelationships:{data:tt(this.formatter.format(e.FontTable.Relationships,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),path:"word/_rels/fontTable.xml.rels"}}}}const oh={NONE:"",WITH_2_BLANKS:"  ",WITH_4_BLANKS:"    ",WITH_TAB:"	"},xr=r=>r===!0?oh.WITH_2_BLANKS:r===!1?void 0:r;class ia{static toString(e,t){return Nr(this,null,function*(){return yield this.compiler.compile(e,xr(t)).generateAsync({type:"string",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"})})}static toBuffer(e,t){return Nr(this,null,function*(){return yield this.compiler.compile(e,xr(t)).generateAsync({type:"nodebuffer",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"})})}static toBase64String(e,t){return Nr(this,null,function*(){return yield this.compiler.compile(e,xr(t)).generateAsync({type:"base64",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"})})}static toBlob(e,t){return Nr(this,null,function*(){return yield this.compiler.compile(e,xr(t)).generateAsync({type:"blob",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"})})}static toStream(e,t){const s=new yi.Stream;return this.compiler.compile(e,xr(t)).generateAsync({type:"nodebuffer",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"}).then(i=>{s.emit("data",i),s.emit("end")}),s}}ge(ia,"compiler",new ih);async function sh(r,e){console.log("[DOCX DEBUG] Creating minimal document");try{console.log("[DOCX DEBUG] Using Docxtemplater for simple document");const t=`
      <w:document xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main">
        <w:body>
          <w:p>
            <w:pPr>
              <w:pStyle w:val="Heading1"/>
              <w:jc w:val="center"/>
            </w:pPr>
            <w:r>
              <w:t>{title}</w:t>
            </w:r>
          </w:p>
          
          <w:p><w:r><w:t>{content}</w:t></w:r></w:p>
        </w:body>
      </w:document>
    `,s=new ba(t),l=new _a(s,{paragraphLoop:!0,linebreaks:!0}),i=e?String(e).trim():"Analysis Report",c=r?String(r).trim():"";l.setData({title:i,content:c}),l.render();const n=l.getZip().generate({type:"blob",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"});return console.log("[DOCX DEBUG] Document created successfully with size:",n.size),n}catch(t){console.error("[DOCX DEBUG] Docxtemplater failed, falling back to original method:",t);try{const s=e?String(e).trim():"Analysis Report",c=(r?String(r).trim():"").split(`
`).map(w=>new Ar({children:[new $r({text:w||" ",size:24})]})),n=new Ar({children:[new $r({text:s,bold:!0,size:32})],spacing:{after:400}}),u=new zf({sections:[{children:[n,...c]}]});console.log("[DOCX DEBUG] Document created, generating blob");const m=await ia.toBlob(u);return console.log("[DOCX DEBUG] Blob generated, size:",m.size),m}catch(s){console.error("[DOCX DEBUG] Error creating document:",s);const l=`${e||"Analysis Report"}

${r||""}`,i=new Blob([l],{type:"text/plain"});return console.log("[DOCX DEBUG] Created fallback text blob"),i}}}function ah(r,e){try{console.log("[DOCX DEBUG] Downloading document, blob size:",r.size),Ta.saveAs(r,e),console.log("[DOCX DEBUG] Download initiated")}catch(t){throw console.error("[DOCX DEBUG] Download error:",t),t}}const{document:Ho}=wa;function Wo(r,e,t){const s=r.slice();return s[71]=e[t],s}function Qn(r){const e=r.slice(),t=[...new Set(e[9].map(i=>i.document))];e[74]=t;const s=e[9].reduce((i,c)=>i+(c.debit||0),0);e[75]=s;const l=e[9].reduce((i,c)=>i+(c.credit||0),0);return e[76]=l,e}function Go(r,e,t){const s=r.slice();return s[68]=e[t],s}function $o(r,e,t){const s=r.slice();return s[77]=e[t],s}function Vo(r){let e,t,s,l,i=r[15].title+"",c,n,u,m='<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg>',w,b,T,p,S,y;const _=[uh,ch,lh],f=[];function x(k,C){return k[15].isLoading?0:k[15].isEditing?1:2}return b=x(r),T=f[b]=_[b](r),{c(){e=pe("div"),t=pe("div"),s=pe("div"),l=pe("h2"),c=De(i),n=Ae(),u=pe("button"),u.innerHTML=m,w=Ae(),T.c(),this.h()},l(k){e=me(k,"DIV",{class:!0});var C=de(e);t=me(C,"DIV",{class:!0});var D=de(t);s=me(D,"DIV",{class:!0});var q=de(s);l=me(q,"H2",{class:!0});var M=de(l);c=Oe(M,i),M.forEach(ie),n=Se(q),u=me(q,"BUTTON",{class:!0,"data-svelte-h":!0}),Vt(u)!=="svelte-1xal31m"&&(u.innerHTML=m),q.forEach(ie),w=Se(D),T.l(D),D.forEach(ie),C.forEach(ie),this.h()},h(){te(l,"class","text-xl font-bold"),te(u,"class","p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full"),te(s,"class","flex justify-between items-center mb-4"),te(t,"class","w-full max-w-2xl bg-white dark:bg-gray-900 rounded-xl p-6 max-h-[80vh] overflow-auto"),te(e,"class","fixed inset-0 z-50 flex items-center justify-center bg-black/60")},m(k,C){Pe(k,e,C),Y(e,t),Y(t,s),Y(s,l),Y(l,c),Y(s,n),Y(s,u),Y(t,w),f[b].m(t,null),p=!0,S||(y=[rt(u,"click",r[18]),rt(e,"click",ha(r[18]))],S=!0)},p(k,C){(!p||C[0]&32768)&&i!==(i=k[15].title+"")&&Be(c,i);let D=b;b=x(k),b===D?f[b].p(k,C):($t(),st(f[D],1,1,()=>{f[D]=null}),Gt(),T=f[b],T?T.p(k,C):(T=f[b]=_[b](k),T.c()),Qe(T,1),T.m(t,null))},i(k){p||(Qe(T),p=!0)},o(k){st(T),p=!1},d(k){k&&ie(e),f[b].d(),S=!1,lr(y)}}}function lh(r){let e,t,s,l,i,c,n,u=r[14].t("Download Report")+"",m,w,b,T=r[14].t("Edit Analysis")+"",p,S,y,_=rr((r[15].content||"").split("<br>")),f=[];for(let x=0;x<_.length;x+=1)f[x]=Ko($o(r,_,x));return{c(){e=pe("div");for(let x=0;x<f.length;x+=1)f[x].c();t=Ae(),s=pe("div"),l=pe("button"),i=kt("svg"),c=kt("path"),n=Ae(),m=De(u),w=Ae(),b=pe("button"),p=De(T),this.h()},l(x){e=me(x,"DIV",{class:!0});var k=de(e);for(let J=0;J<f.length;J+=1)f[J].l(k);k.forEach(ie),t=Se(x),s=me(x,"DIV",{class:!0});var C=de(s);l=me(C,"BUTTON",{class:!0});var D=de(l);i=Ct(D,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var q=de(i);c=Ct(q,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),de(c).forEach(ie),q.forEach(ie),n=Se(D),m=Oe(D,u),D.forEach(ie),w=Se(C),b=me(C,"BUTTON",{class:!0});var M=de(b);p=Oe(M,T),M.forEach(ie),C.forEach(ie),this.h()},h(){te(e,"class","analysis-content prose dark:prose-invert max-w-none"),te(c,"stroke-linecap","round"),te(c,"stroke-linejoin","round"),te(c,"stroke-width","2"),te(c,"d","M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l2.414 2.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"),te(i,"xmlns","http://www.w3.org/2000/svg"),te(i,"class","h-5 w-5 mr-2"),te(i,"fill","none"),te(i,"viewBox","0 0 24 24"),te(i,"stroke","currentColor"),te(l,"class","px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition flex items-center"),te(b,"class","px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition"),te(s,"class","mt-4 flex justify-end space-x-3")},m(x,k){Pe(x,e,k);for(let C=0;C<f.length;C+=1)f[C]&&f[C].m(e,null);Pe(x,t,k),Pe(x,s,k),Y(s,l),Y(l,i),Y(i,c),Y(l,n),Y(l,m),Y(s,w),Y(s,b),Y(b,p),S||(y=[rt(l,"click",r[37]),rt(b,"click",r[19])],S=!0)},p(x,k){if(k[0]&32768){_=rr((x[15].content||"").split("<br>"));let C;for(C=0;C<_.length;C+=1){const D=$o(x,_,C);f[C]?f[C].p(D,k):(f[C]=Ko(D),f[C].c(),f[C].m(e,null))}for(;C<f.length;C+=1)f[C].d(1);f.length=_.length}k[0]&16384&&u!==(u=x[14].t("Download Report")+"")&&Be(m,u),k[0]&16384&&T!==(T=x[14].t("Edit Analysis")+"")&&Be(p,T)},i:dt,o:dt,d(x){x&&(ie(e),ie(t),ie(s)),fi(f,x),S=!1,lr(y)}}}function ch(r){let e,t,s,l,i,c,n=r[14].t("Cancel")+"",u,m,w,b=r[14].t("Save")+"",T,p,S;return{c(){e=pe("div"),t=pe("textarea"),l=Ae(),i=pe("div"),c=pe("button"),u=De(n),m=Ae(),w=pe("button"),T=De(b),this.h()},l(y){e=me(y,"DIV",{class:!0});var _=de(e);t=me(_,"TEXTAREA",{class:!0,placeholder:!0}),de(t).forEach(ie),_.forEach(ie),l=Se(y),i=me(y,"DIV",{class:!0});var f=de(i);c=me(f,"BUTTON",{class:!0});var x=de(c);u=Oe(x,n),x.forEach(ie),m=Se(f),w=me(f,"BUTTON",{class:!0});var k=de(w);T=Oe(k,b),k.forEach(ie),f.forEach(ie),this.h()},h(){te(t,"class","w-full h-64 px-3 py-2 text-sm rounded border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800"),te(t,"placeholder",s=r[14].t("Enter your analysis here...")),te(e,"class","mb-4"),te(c,"class","px-4 py-2 rounded-lg bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 transition"),te(w,"class","px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 transition"),te(i,"class","flex justify-end space-x-3")},m(y,_){Pe(y,e,_),Y(e,t),Lt(t,r[15].editText),Pe(y,l,_),Pe(y,i,_),Y(i,c),Y(c,u),Y(i,m),Y(i,w),Y(w,T),p||(S=[rt(t,"input",r[36]),rt(c,"click",r[19]),rt(w,"click",r[20])],p=!0)},p(y,_){_[0]&16384&&s!==(s=y[14].t("Enter your analysis here..."))&&te(t,"placeholder",s),_[0]&32768&&Lt(t,y[15].editText),_[0]&16384&&n!==(n=y[14].t("Cancel")+"")&&Be(u,n),_[0]&16384&&b!==(b=y[14].t("Save")+"")&&Be(T,b)},i:dt,o:dt,d(y){y&&(ie(e),ie(l),ie(i)),p=!1,lr(S)}}}function uh(r){let e,t,s,l,i=r[14].t("Generating analysis...")+"",c,n;return t=new dr({props:{className:"size-8"}}),{c(){e=pe("div"),cr(t.$$.fragment),s=Ae(),l=pe("p"),c=De(i),this.h()},l(u){e=me(u,"DIV",{class:!0});var m=de(e);ur(t.$$.fragment,m),s=Se(m),l=me(m,"P",{class:!0});var w=de(l);c=Oe(w,i),w.forEach(ie),m.forEach(ie),this.h()},h(){te(l,"class","ml-3 text-gray-600 dark:text-gray-400"),te(e,"class","flex justify-center items-center py-8")},m(u,m){Pe(u,e,m),fr(t,e,null),Y(e,s),Y(e,l),Y(l,c),n=!0},p(u,m){(!n||m[0]&16384)&&i!==(i=u[14].t("Generating analysis...")+"")&&Be(c,i)},i(u){n||(Qe(t.$$.fragment,u),n=!0)},o(u){st(t.$$.fragment,u),n=!1},d(u){u&&ie(e),hr(t)}}}function Ko(r){let e,t,s=r[77]+"";return{c(){e=pe("p"),t=new qr(!1),this.h()},l(l){e=me(l,"P",{class:!0});var i=de(e);t=Xr(i,!1),i.forEach(ie),this.h()},h(){t.a=null,te(e,"class","mb-1")},m(l,i){Pe(l,e,i),t.m(s,e)},p(l,i){i[0]&32768&&s!==(s=l[77]+"")&&t.p(s)},d(l){l&&ie(e)}}}function fh(r){let e,t,s,l,i='<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path></svg>',c,n,u=r[14].t("Edit Analysis")+"",m,w,b,T,p,S,y,_,f,x=r[14].t("Cancel")+"",k,C,D,q,M,J,I=r[14].t("Download")+"",ue,ee,B,W,A=r[14].t("Save")+"",z,se,V,ye,Z=r[12]&&qo(r);return{c(){e=pe("div"),t=pe("div"),s=pe("div"),l=pe("button"),l.innerHTML=i,c=Ae(),n=pe("h2"),m=De(u),w=Ae(),b=pe("div"),T=pe("textarea"),S=Ae(),Z&&Z.c(),y=Ae(),_=pe("div"),f=pe("button"),k=De(x),C=Ae(),D=pe("button"),q=kt("svg"),M=kt("path"),J=Ae(),ue=De(I),B=Ae(),W=pe("button"),z=De(A),this.h()},l(re){e=me(re,"DIV",{class:!0});var j=de(e);t=me(j,"DIV",{class:!0});var R=de(t);s=me(R,"DIV",{class:!0});var K=de(s);l=me(K,"BUTTON",{class:!0,"data-svelte-h":!0}),Vt(l)!=="svelte-1hnzekv"&&(l.innerHTML=i),c=Se(K),n=me(K,"H2",{class:!0});var X=de(n);m=Oe(X,u),X.forEach(ie),K.forEach(ie),R.forEach(ie),w=Se(j),b=me(j,"DIV",{class:!0});var oe=de(b);T=me(oe,"TEXTAREA",{class:!0,placeholder:!0}),de(T).forEach(ie),S=Se(oe),Z&&Z.l(oe),oe.forEach(ie),y=Se(j),_=me(j,"DIV",{class:!0});var H=de(_);f=me(H,"BUTTON",{class:!0});var v=de(f);k=Oe(v,x),v.forEach(ie),C=Se(H),D=me(H,"BUTTON",{class:!0});var g=de(D);q=Ct(g,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var U=de(q);M=Ct(U,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),de(M).forEach(ie),U.forEach(ie),J=Se(g),ue=Oe(g,I),g.forEach(ie),B=Se(H),W=me(H,"BUTTON",{class:!0});var L=de(W);z=Oe(L,A),L.forEach(ie),H.forEach(ie),j.forEach(ie),this.h()},h(){te(l,"class","mr-2 p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full"),te(n,"class","text-xl font-bold"),te(s,"class","flex items-center"),te(t,"class","flex justify-between items-center mb-4"),te(T,"class","w-full h-64 px-3 py-2 text-sm rounded border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800"),te(T,"placeholder",p=r[14].t("Enter your analysis here...")),T.disabled=r[12],te(b,"class","mb-4 relative"),te(f,"class","px-4 py-2 rounded-lg bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 transition"),te(M,"stroke-linecap","round"),te(M,"stroke-linejoin","round"),te(M,"stroke-width","2"),te(M,"d","M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l2.414 2.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"),te(q,"xmlns","http://www.w3.org/2000/svg"),te(q,"class","h-5 w-5 mr-2"),te(q,"fill","none"),te(q,"viewBox","0 0 24 24"),te(q,"stroke","currentColor"),te(D,"class","px-4 py-2 rounded-lg bg-green-600 text-white hover:bg-green-700 transition flex items-center"),D.disabled=ee=!r[11]||r[12],te(W,"class","px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 transition"),W.disabled=r[12],te(_,"class","flex justify-end space-x-3"),te(e,"class","bg-white dark:bg-gray-800 p-6 rounded-lg shadow")},m(re,j){Pe(re,e,j),Y(e,t),Y(t,s),Y(s,l),Y(s,c),Y(s,n),Y(n,m),Y(e,w),Y(e,b),Y(b,T),Lt(T,r[11]),Y(b,S),Z&&Z.m(b,null),Y(e,y),Y(e,_),Y(_,f),Y(f,k),Y(_,C),Y(_,D),Y(D,q),Y(q,M),Y(D,J),Y(D,ue),Y(_,B),Y(_,W),Y(W,z),se=!0,V||(ye=[rt(l,"click",r[29]),rt(T,"input",r[41]),rt(f,"click",r[29]),rt(D,"click",r[42]),rt(W,"click",r[24])],V=!0)},p(re,j){(!se||j[0]&16384)&&u!==(u=re[14].t("Edit Analysis")+"")&&Be(m,u),(!se||j[0]&16384&&p!==(p=re[14].t("Enter your analysis here...")))&&te(T,"placeholder",p),(!se||j[0]&4096)&&(T.disabled=re[12]),j[0]&2048&&Lt(T,re[11]),re[12]?Z?(Z.p(re,j),j[0]&4096&&Qe(Z,1)):(Z=qo(re),Z.c(),Qe(Z,1),Z.m(b,null)):Z&&($t(),st(Z,1,1,()=>{Z=null}),Gt()),(!se||j[0]&16384)&&x!==(x=re[14].t("Cancel")+"")&&Be(k,x),(!se||j[0]&16384)&&I!==(I=re[14].t("Download")+"")&&Be(ue,I),(!se||j[0]&6144&&ee!==(ee=!re[11]||re[12]))&&(D.disabled=ee),(!se||j[0]&16384)&&A!==(A=re[14].t("Save")+"")&&Be(z,A),(!se||j[0]&4096)&&(W.disabled=re[12])},i(re){se||(Qe(Z),se=!0)},o(re){st(Z),se=!1},d(re){re&&ie(e),Z&&Z.d(),V=!1,lr(ye)}}}function hh(r){let e,t,s,l,i='<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path></svg>',c,n,u,m,w,b,T,p,S;const y=[gh,mh],_=[];function f(x,k){return x[3]?0:1}return w=f(r),b=_[w]=y[w](r),{c(){e=pe("div"),t=pe("div"),s=pe("div"),l=pe("button"),l.innerHTML=i,c=Ae(),n=pe("h2"),u=De(r[4]),m=Ae(),b.c(),this.h()},l(x){e=me(x,"DIV",{class:!0});var k=de(e);t=me(k,"DIV",{class:!0});var C=de(t);s=me(C,"DIV",{class:!0});var D=de(s);l=me(D,"BUTTON",{class:!0,"data-svelte-h":!0}),Vt(l)!=="svelte-1hnzekv"&&(l.innerHTML=i),c=Se(D),n=me(D,"H2",{class:!0});var q=de(n);u=Oe(q,r[4]),q.forEach(ie),D.forEach(ie),C.forEach(ie),m=Se(k),b.l(k),k.forEach(ie),this.h()},h(){te(l,"class","mr-2 p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full"),te(n,"class","text-xl font-bold"),te(s,"class","flex items-center"),te(t,"class","flex justify-between items-center mb-6"),te(e,"class","bg-white dark:bg-gray-800 p-6 rounded-lg shadow")},m(x,k){Pe(x,e,k),Y(e,t),Y(t,s),Y(s,l),Y(s,c),Y(s,n),Y(n,u),Y(e,m),_[w].m(e,null),T=!0,p||(S=rt(l,"click",r[29]),p=!0)},p(x,k){(!T||k[0]&16)&&Be(u,x[4]);let C=w;w=f(x),w===C?_[w].p(x,k):($t(),st(_[C],1,1,()=>{_[C]=null}),Gt(),b=_[w],b?b.p(x,k):(b=_[w]=y[w](x),b.c()),Qe(b,1),b.m(e,null))},i(x){T||(Qe(b),T=!0)},o(x){st(b),T=!1},d(x){x&&ie(e),_[w].d(),p=!1,S()}}}function dh(r){let e,t,s,l,i='<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path></svg>',c,n,u,m,w,b,T,p,S,y,_,f=r[14].t("Date")+"",x,k,C,D=r[14].t("Journal Entry")+"",q,M,J,I=r[14].t("Account")+"",ue,ee,B,W=r[14].t("Note")+"",A,z,se,V=r[14].t("Debit")+"",ye,Z,re,j=r[14].t("Credit")+"",R,K,X,oe=r[14].t("Flags")+"",H,v,g,U,L,N,O=r[9].length>0&&Xo(Qn(r)),ae=rr(r[9]),h=[];for(let E=0;E<ae.length;E+=1)h[E]=ts(Wo(r,ae,E));let Q=r[9].length===0&&rs(r);return{c(){e=pe("div"),t=pe("div"),s=pe("div"),l=pe("button"),l.innerHTML=i,c=Ae(),n=pe("h2"),u=De(r[10]),m=Ae(),w=pe("div"),O&&O.c(),b=Ae(),T=pe("div"),p=pe("table"),S=pe("thead"),y=pe("tr"),_=pe("th"),x=De(f),k=Ae(),C=pe("th"),q=De(D),M=Ae(),J=pe("th"),ue=De(I),ee=Ae(),B=pe("th"),A=De(W),z=Ae(),se=pe("th"),ye=De(V),Z=Ae(),re=pe("th"),R=De(j),K=Ae(),X=pe("th"),H=De(oe),v=Ae(),g=pe("tbody");for(let E=0;E<h.length;E+=1)h[E].c();U=Ae(),Q&&Q.c(),this.h()},l(E){e=me(E,"DIV",{class:!0});var o=de(e);t=me(o,"DIV",{class:!0});var a=de(t);s=me(a,"DIV",{class:!0});var d=de(s);l=me(d,"BUTTON",{class:!0,"data-svelte-h":!0}),Vt(l)!=="svelte-1hnzekv"&&(l.innerHTML=i),c=Se(d),n=me(d,"H2",{class:!0});var F=de(n);u=Oe(F,r[10]),F.forEach(ie),d.forEach(ie),a.forEach(ie),m=Se(o),w=me(o,"DIV",{class:!0});var $=de(w);O&&O.l($),$.forEach(ie),b=Se(o),T=me(o,"DIV",{class:!0});var P=de(T);p=me(P,"TABLE",{class:!0});var fe=de(p);S=me(fe,"THEAD",{class:!0});var we=de(S);y=me(we,"TR",{});var he=de(y);_=me(he,"TH",{class:!0});var xe=de(_);x=Oe(xe,f),xe.forEach(ie),k=Se(he),C=me(he,"TH",{class:!0});var ke=de(C);q=Oe(ke,D),ke.forEach(ie),M=Se(he),J=me(he,"TH",{class:!0});var Ne=de(J);ue=Oe(Ne,I),Ne.forEach(ie),ee=Se(he),B=me(he,"TH",{class:!0});var ot=de(B);A=Oe(ot,W),ot.forEach(ie),z=Se(he),se=me(he,"TH",{class:!0});var mt=de(se);ye=Oe(mt,V),mt.forEach(ie),Z=Se(he),re=me(he,"TH",{class:!0});var ft=de(re);R=Oe(ft,j),ft.forEach(ie),K=Se(he),X=me(he,"TH",{class:!0});var Et=de(X);H=Oe(Et,oe),Et.forEach(ie),he.forEach(ie),we.forEach(ie),v=Se(fe),g=me(fe,"TBODY",{});var Ge=de(g);for(let G=0;G<h.length;G+=1)h[G].l(Ge);U=Se(Ge),Q&&Q.l(Ge),Ge.forEach(ie),fe.forEach(ie),P.forEach(ie),o.forEach(ie),this.h()},h(){te(l,"class","mr-2 p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full"),te(n,"class","text-xl font-bold"),te(s,"class","flex items-center"),te(t,"class","flex justify-between items-center mb-6"),te(w,"class","transaction-summary mb-6 grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3"),te(_,"class","px-4 py-2 text-left"),te(C,"class","px-4 py-2 text-left"),te(J,"class","px-4 py-2 text-left"),te(B,"class","px-4 py-2 text-left"),te(se,"class","px-4 py-2 text-right"),te(re,"class","px-4 py-2 text-right"),te(X,"class","px-4 py-2 text-center"),te(S,"class","bg-gray-50 dark:bg-gray-700 text-gray-500 dark:text-gray-300"),te(p,"class","w-full text-sm"),te(T,"class","overflow-x-auto"),te(e,"class","bg-white dark:bg-gray-800 p-6 rounded-lg shadow")},m(E,o){Pe(E,e,o),Y(e,t),Y(t,s),Y(s,l),Y(s,c),Y(s,n),Y(n,u),Y(e,m),Y(e,w),O&&O.m(w,null),Y(e,b),Y(e,T),Y(T,p),Y(p,S),Y(S,y),Y(y,_),Y(_,x),Y(y,k),Y(y,C),Y(C,q),Y(y,M),Y(y,J),Y(J,ue),Y(y,ee),Y(y,B),Y(B,A),Y(y,z),Y(y,se),Y(se,ye),Y(y,Z),Y(y,re),Y(re,R),Y(y,K),Y(y,X),Y(X,H),Y(p,v),Y(p,g);for(let a=0;a<h.length;a+=1)h[a]&&h[a].m(g,null);Y(g,U),Q&&Q.m(g,null),L||(N=rt(l,"click",r[29]),L=!0)},p(E,o){if(o[0]&1024&&Be(u,E[10]),E[9].length>0?O?O.p(Qn(E),o):(O=Xo(Qn(E)),O.c(),O.m(w,null)):O&&(O.d(1),O=null),o[0]&16384&&f!==(f=E[14].t("Date")+"")&&Be(x,f),o[0]&16384&&D!==(D=E[14].t("Journal Entry")+"")&&Be(q,D),o[0]&16384&&I!==(I=E[14].t("Account")+"")&&Be(ue,I),o[0]&16384&&W!==(W=E[14].t("Note")+"")&&Be(A,W),o[0]&16384&&V!==(V=E[14].t("Debit")+"")&&Be(ye,V),o[0]&16384&&j!==(j=E[14].t("Credit")+"")&&Be(R,j),o[0]&16384&&oe!==(oe=E[14].t("Flags")+"")&&Be(H,oe),o[0]&67125760){ae=rr(E[9]);let a;for(a=0;a<ae.length;a+=1){const d=Wo(E,ae,a);h[a]?h[a].p(d,o):(h[a]=ts(d),h[a].c(),h[a].m(g,U))}for(;a<h.length;a+=1)h[a].d(1);h.length=ae.length}E[9].length===0?Q?Q.p(E,o):(Q=rs(E),Q.c(),Q.m(g,null)):Q&&(Q.d(1),Q=null)},i:dt,o:dt,d(E){E&&ie(e),O&&O.d(),fi(h,E),Q&&Q.d(),L=!1,N()}}}function ph(r){let e,t,s=r[14].t("Account Analysis")+"",l,i,c,n="",u,m,w,b,T;const p=[bh,vh,yh,wh],S=[];function y(_,f){return _[5]?0:_[6]?_[0]?2:3:1}return m=y(r),w=S[m]=p[m](r),{c(){e=pe("div"),t=pe("h1"),l=De(s),i=Ae(),c=pe("div"),c.innerHTML=n,u=Ae(),w.c(),b=Ni(),this.h()},l(_){e=me(_,"DIV",{class:!0});var f=de(e);t=me(f,"H1",{class:!0});var x=de(t);l=Oe(x,s),x.forEach(ie),i=Se(f),c=me(f,"DIV",{class:!0,"data-svelte-h":!0}),Vt(c)!=="svelte-prv37y"&&(c.innerHTML=n),f.forEach(ie),u=Se(_),w.l(_),b=Ni(),this.h()},h(){te(t,"class","text-2xl font-bold text-blue-800 dark:text-blue-300"),te(c,"class","flex items-center space-x-2"),te(e,"class","flex justify-between items-center mb-6")},m(_,f){Pe(_,e,f),Y(e,t),Y(t,l),Y(e,i),Y(e,c),Pe(_,u,f),S[m].m(_,f),Pe(_,b,f),T=!0},p(_,f){(!T||f[0]&16384)&&s!==(s=_[14].t("Account Analysis")+"")&&Be(l,s);let x=m;m=y(_),m===x?S[m].p(_,f):($t(),st(S[x],1,1,()=>{S[x]=null}),Gt(),w=S[m],w?w.p(_,f):(w=S[m]=p[m](_),w.c()),Qe(w,1),w.m(b.parentNode,b))},i(_){T||(Qe(w),T=!0)},o(_){st(w),T=!1},d(_){_&&(ie(e),ie(u),ie(b)),S[m].d(_)}}}function qo(r){let e,t,s,l,i,c=r[14].t("Generating analysis...")+"",n,u;return s=new dr({props:{className:"size-8 mb-2"}}),{c(){e=pe("div"),t=pe("div"),cr(s.$$.fragment),l=Ae(),i=pe("div"),n=De(c),this.h()},l(m){e=me(m,"DIV",{class:!0});var w=de(e);t=me(w,"DIV",{class:!0});var b=de(t);ur(s.$$.fragment,b),l=Se(b),i=me(b,"DIV",{class:!0});var T=de(i);n=Oe(T,c),T.forEach(ie),b.forEach(ie),w.forEach(ie),this.h()},h(){te(i,"class","text-sm font-medium"),te(t,"class","flex flex-col items-center"),te(e,"class","absolute inset-0 bg-black/10 flex items-center justify-center")},m(m,w){Pe(m,e,w),Y(e,t),fr(s,t,null),Y(t,l),Y(t,i),Y(i,n),u=!0},p(m,w){(!u||w[0]&16384)&&c!==(c=m[14].t("Generating analysis...")+"")&&Be(n,c)},i(m){u||(Qe(s.$$.fragment,m),u=!0)},o(m){st(s.$$.fragment,m),u=!1},d(m){m&&ie(e),hr(s)}}}function mh(r){let e,t,s;return t=new dr({props:{className:"size-8"}}),{c(){e=pe("div"),cr(t.$$.fragment),this.h()},l(l){e=me(l,"DIV",{class:!0});var i=de(e);ur(t.$$.fragment,i),i.forEach(ie),this.h()},h(){te(e,"class","flex justify-center items-center h-64")},m(l,i){Pe(l,e,i),fr(t,e,null),s=!0},p:dt,i(l){s||(Qe(t.$$.fragment,l),s=!0)},o(l){st(t.$$.fragment,l),s=!1},d(l){l&&ie(e),hr(t)}}}function gh(r){let e,t,s,l=r[30]()+"";return{c(){e=pe("div"),t=pe("div"),s=new qr(!1),this.h()},l(i){e=me(i,"DIV",{class:!0});var c=de(e);t=me(c,"DIV",{class:!0});var n=de(t);s=Xr(n,!1),n.forEach(ie),c.forEach(ie),this.h()},h(){s.a=null,te(t,"class","timeline-section mb-6"),te(e,"class","chart-content svelte-126e3bb")},m(i,c){Pe(i,e,c),Y(e,t),s.m(l,t)},p:dt,i:dt,o:dt,d(i){i&&ie(e)}}}function Xo(r){let e,t,s=r[14].t("Total Transactions")+"",l,i,c,n=r[74].length+"",u,m,w,b,T=r[14].t("Total Debits")+"",p,S,y,_=lt(r[75])+"",f,x,k,C,D=r[14].t("Total Credits")+"",q,M,J,I=lt(r[76])+"",ue,ee,B,W,A=r[14].t("Net Amount")+"",z,se,V,ye=lt(r[75]-r[76])+"",Z;return{c(){e=pe("div"),t=pe("div"),l=De(s),i=Ae(),c=pe("div"),u=De(n),m=Ae(),w=pe("div"),b=pe("div"),p=De(T),S=Ae(),y=pe("div"),f=De(_),x=Ae(),k=pe("div"),C=pe("div"),q=De(D),M=Ae(),J=pe("div"),ue=De(I),ee=Ae(),B=pe("div"),W=pe("div"),z=De(A),se=Ae(),V=pe("div"),Z=De(ye),this.h()},l(re){e=me(re,"DIV",{class:!0});var j=de(e);t=me(j,"DIV",{class:!0});var R=de(t);l=Oe(R,s),R.forEach(ie),i=Se(j),c=me(j,"DIV",{class:!0});var K=de(c);u=Oe(K,n),K.forEach(ie),j.forEach(ie),m=Se(re),w=me(re,"DIV",{class:!0});var X=de(w);b=me(X,"DIV",{class:!0});var oe=de(b);p=Oe(oe,T),oe.forEach(ie),S=Se(X),y=me(X,"DIV",{class:!0});var H=de(y);f=Oe(H,_),H.forEach(ie),X.forEach(ie),x=Se(re),k=me(re,"DIV",{class:!0});var v=de(k);C=me(v,"DIV",{class:!0});var g=de(C);q=Oe(g,D),g.forEach(ie),M=Se(v),J=me(v,"DIV",{class:!0});var U=de(J);ue=Oe(U,I),U.forEach(ie),v.forEach(ie),ee=Se(re),B=me(re,"DIV",{class:!0});var L=de(B);W=me(L,"DIV",{class:!0});var N=de(W);z=Oe(N,A),N.forEach(ie),se=Se(L),V=me(L,"DIV",{class:!0});var O=de(V);Z=Oe(O,ye),O.forEach(ie),L.forEach(ie),this.h()},h(){te(t,"class","text-xs text-blue-600 dark:text-blue-400"),te(c,"class","text-xl font-bold"),te(e,"class","p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg"),te(b,"class","text-xs text-green-600 dark:text-green-400"),te(y,"class","text-xl font-bold"),te(w,"class","p-3 bg-green-50 dark:bg-green-900/20 rounded-lg"),te(C,"class","text-xs text-red-600 dark:text-red-400"),te(J,"class","text-xl font-bold"),te(k,"class","p-3 bg-red-50 dark:bg-red-900/20 rounded-lg"),te(W,"class","text-xs text-purple-600 dark:text-purple-400"),te(V,"class","text-xl font-bold"),te(B,"class","p-3 bg-purple-50 dark:bg-purple-900/20 rounded-lg")},m(re,j){Pe(re,e,j),Y(e,t),Y(t,l),Y(e,i),Y(e,c),Y(c,u),Pe(re,m,j),Pe(re,w,j),Y(w,b),Y(b,p),Y(w,S),Y(w,y),Y(y,f),Pe(re,x,j),Pe(re,k,j),Y(k,C),Y(C,q),Y(k,M),Y(k,J),Y(J,ue),Pe(re,ee,j),Pe(re,B,j),Y(B,W),Y(W,z),Y(B,se),Y(B,V),Y(V,Z)},p(re,j){j[0]&16384&&s!==(s=re[14].t("Total Transactions")+"")&&Be(l,s),j[0]&512&&n!==(n=re[74].length+"")&&Be(u,n),j[0]&16384&&T!==(T=re[14].t("Total Debits")+"")&&Be(p,T),j[0]&512&&_!==(_=lt(re[75])+"")&&Be(f,_),j[0]&16384&&D!==(D=re[14].t("Total Credits")+"")&&Be(q,D),j[0]&512&&I!==(I=lt(re[76])+"")&&Be(ue,I),j[0]&16384&&A!==(A=re[14].t("Net Amount")+"")&&Be(z,A),j[0]&512&&ye!==(ye=lt(re[75]-re[76])+"")&&Be(Z,ye)},d(re){re&&(ie(e),ie(m),ie(w),ie(x),ie(k),ie(ee),ie(B))}}}function Zo(r){let e,t=lt(r[71].debit)+"",s;return{c(){e=pe("span"),s=De(t),this.h()},l(l){e=me(l,"SPAN",{class:!0});var i=de(e);s=Oe(i,t),i.forEach(ie),this.h()},h(){te(e,"class","font-medium")},m(l,i){Pe(l,e,i),Y(e,s)},p(l,i){i[0]&512&&t!==(t=lt(l[71].debit)+"")&&Be(s,t)},d(l){l&&ie(e)}}}function Yo(r){let e,t=lt(r[71].credit)+"",s;return{c(){e=pe("span"),s=De(t),this.h()},l(l){e=me(l,"SPAN",{class:!0});var i=de(e);s=Oe(i,t),i.forEach(ie),this.h()},h(){te(e,"class","font-medium")},m(l,i){Pe(l,e,i),Y(e,s)},p(l,i){i[0]&512&&t!==(t=lt(l[71].credit)+"")&&Be(s,t)},d(l){l&&ie(e)}}}function Jo(r){let e,t=r[14].t("Recurring")+"",s;return{c(){e=pe("span"),s=De(t),this.h()},l(l){e=me(l,"SPAN",{class:!0});var i=de(e);s=Oe(i,t),i.forEach(ie),this.h()},h(){te(e,"class","inline-flex items-center px-1.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300")},m(l,i){Pe(l,e,i),Y(e,s)},p(l,i){i[0]&16384&&t!==(t=l[14].t("Recurring")+"")&&Be(s,t)},d(l){l&&ie(e)}}}function Qo(r){let e,t=r[14].t("Unusual")+"",s;return{c(){e=pe("span"),s=De(t),this.h()},l(l){e=me(l,"SPAN",{class:!0});var i=de(e);s=Oe(i,t),i.forEach(ie),this.h()},h(){te(e,"class","inline-flex items-center px-1.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300")},m(l,i){Pe(l,e,i),Y(e,s)},p(l,i){i[0]&16384&&t!==(t=l[14].t("Unusual")+"")&&Be(s,t)},d(l){l&&ie(e)}}}function es(r){let e,t,s=r[26](r[71].iqr_flag)+"";return{c(){e=pe("span"),t=new qr(!1),this.h()},l(l){e=me(l,"SPAN",{class:!0});var i=de(e);t=Xr(i,!1),i.forEach(ie),this.h()},h(){t.a=null,te(e,"class","ml-1")},m(l,i){Pe(l,e,i),t.m(s,e)},p(l,i){i[0]&512&&s!==(s=l[26](l[71].iqr_flag)+"")&&t.p(s)},d(l){l&&ie(e)}}}function ts(r){let e,t,s=r[71].postingDate+"",l,i,c,n=r[71].document+"",u,m,w,b,T=r[71].account+"",p,S,y,_=r[71].accountName+"",f,x,k,C=r[71].text+"",D,q,M,J,I,ue,ee,B,W,A=r[71].debit&&Zo(r),z=r[71].credit&&Yo(r),se=r[71].isRecurring&&Jo(r),V=r[71].isUnusual&&Qo(r),ye=r[71].iqr_flag!==void 0&&es(r);return{c(){e=pe("tr"),t=pe("td"),l=De(s),i=Ae(),c=pe("td"),u=De(n),m=Ae(),w=pe("td"),b=pe("div"),p=De(T),S=Ae(),y=pe("div"),f=De(_),x=Ae(),k=pe("td"),D=De(C),q=Ae(),M=pe("td"),A&&A.c(),J=Ae(),I=pe("td"),z&&z.c(),ue=Ae(),ee=pe("td"),se&&se.c(),B=Ae(),V&&V.c(),W=Ae(),ye&&ye.c(),this.h()},l(Z){e=me(Z,"TR",{class:!0});var re=de(e);t=me(re,"TD",{class:!0});var j=de(t);l=Oe(j,s),j.forEach(ie),i=Se(re),c=me(re,"TD",{class:!0});var R=de(c);u=Oe(R,n),R.forEach(ie),m=Se(re),w=me(re,"TD",{class:!0});var K=de(w);b=me(K,"DIV",{class:!0});var X=de(b);p=Oe(X,T),X.forEach(ie),S=Se(K),y=me(K,"DIV",{});var oe=de(y);f=Oe(oe,_),oe.forEach(ie),K.forEach(ie),x=Se(re),k=me(re,"TD",{class:!0});var H=de(k);D=Oe(H,C),H.forEach(ie),q=Se(re),M=me(re,"TD",{class:!0});var v=de(M);A&&A.l(v),v.forEach(ie),J=Se(re),I=me(re,"TD",{class:!0});var g=de(I);z&&z.l(g),g.forEach(ie),ue=Se(re),ee=me(re,"TD",{class:!0});var U=de(ee);se&&se.l(U),B=Se(U),V&&V.l(U),W=Se(U),ye&&ye.l(U),U.forEach(ie),re.forEach(ie),this.h()},h(){te(t,"class","px-4 py-2"),te(c,"class","px-4 py-2 font-medium"),te(b,"class","font-mono text-xs"),te(w,"class","px-4 py-2"),te(k,"class","px-4 py-2"),te(M,"class","px-4 py-2 text-right"),te(I,"class","px-4 py-2 text-right"),te(ee,"class","px-4 py-2 text-center"),te(e,"class","border-t border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800/50")},m(Z,re){Pe(Z,e,re),Y(e,t),Y(t,l),Y(e,i),Y(e,c),Y(c,u),Y(e,m),Y(e,w),Y(w,b),Y(b,p),Y(w,S),Y(w,y),Y(y,f),Y(e,x),Y(e,k),Y(k,D),Y(e,q),Y(e,M),A&&A.m(M,null),Y(e,J),Y(e,I),z&&z.m(I,null),Y(e,ue),Y(e,ee),se&&se.m(ee,null),Y(ee,B),V&&V.m(ee,null),Y(ee,W),ye&&ye.m(ee,null)},p(Z,re){re[0]&512&&s!==(s=Z[71].postingDate+"")&&Be(l,s),re[0]&512&&n!==(n=Z[71].document+"")&&Be(u,n),re[0]&512&&T!==(T=Z[71].account+"")&&Be(p,T),re[0]&512&&_!==(_=Z[71].accountName+"")&&Be(f,_),re[0]&512&&C!==(C=Z[71].text+"")&&Be(D,C),Z[71].debit?A?A.p(Z,re):(A=Zo(Z),A.c(),A.m(M,null)):A&&(A.d(1),A=null),Z[71].credit?z?z.p(Z,re):(z=Yo(Z),z.c(),z.m(I,null)):z&&(z.d(1),z=null),Z[71].isRecurring?se?se.p(Z,re):(se=Jo(Z),se.c(),se.m(ee,B)):se&&(se.d(1),se=null),Z[71].isUnusual?V?V.p(Z,re):(V=Qo(Z),V.c(),V.m(ee,W)):V&&(V.d(1),V=null),Z[71].iqr_flag!==void 0?ye?ye.p(Z,re):(ye=es(Z),ye.c(),ye.m(ee,null)):ye&&(ye.d(1),ye=null)},d(Z){Z&&ie(e),A&&A.d(),z&&z.d(),se&&se.d(),V&&V.d(),ye&&ye.d()}}}function rs(r){let e,t,s=r[14].t("No transactions found for this period")+"",l;return{c(){e=pe("tr"),t=pe("td"),l=De(s),this.h()},l(i){e=me(i,"TR",{});var c=de(e);t=me(c,"TD",{colspan:!0,class:!0});var n=de(t);l=Oe(n,s),n.forEach(ie),c.forEach(ie),this.h()},h(){te(t,"colspan","7"),te(t,"class","px-4 py-8 text-center text-gray-500")},m(i,c){Pe(i,e,c),Y(e,t),Y(t,l)},p(i,c){c[0]&16384&&s!==(s=i[14].t("No transactions found for this period")+"")&&Be(l,s)},d(i){i&&ie(e)}}}function wh(r){let e,t,s,l,i="Loading account data...",c;return t=new dr({props:{className:"size-8"}}),{c(){e=pe("div"),cr(t.$$.fragment),s=Ae(),l=pe("div"),l.textContent=i,this.h()},l(n){e=me(n,"DIV",{class:!0});var u=de(e);ur(t.$$.fragment,u),s=Se(u),l=me(u,"DIV",{class:!0,"data-svelte-h":!0}),Vt(l)!=="svelte-1xgbd6n"&&(l.textContent=i),u.forEach(ie),this.h()},h(){te(l,"class","ml-3"),te(e,"class","flex justify-center items-center h-64")},m(n,u){Pe(n,e,u),fr(t,e,null),Y(e,s),Y(e,l),c=!0},p:dt,i(n){c||(Qe(t.$$.fragment,n),c=!0)},o(n){st(t.$$.fragment,n),c=!1},d(n){n&&ie(e),hr(t)}}}function yh(r){let e,t,s,l,i,c=r[14].t("Significance Threshold")+"",n,u,m,w,b,T,p="%",S,y,_,f,x,k,C,D,q,M,J=r[27]()+"",I,ue,ee,B=rr(r[7]),W=[];for(let z=0;z<B.length;z+=1)W[z]=ns(Go(r,B,z));let A=r[5]&&is(r);return{c(){e=pe("div"),t=pe("div"),s=pe("div"),l=pe("div"),i=pe("span"),n=De(c),u=De(":"),m=Ae(),w=pe("input"),b=Ae(),T=pe("span"),T.textContent=p,S=Ae(),y=pe("div"),_=pe("select");for(let z=0;z<W.length;z+=1)W[z].c();f=Ae(),x=pe("div"),k=De(r[13]),C=Ae(),D=pe("div"),A&&A.c(),q=Ae(),M=new qr(!1),this.h()},l(z){e=me(z,"DIV",{class:!0});var se=de(e);t=me(se,"DIV",{class:!0});var V=de(t);s=me(V,"DIV",{class:!0});var ye=de(s);l=me(ye,"DIV",{class:!0});var Z=de(l);i=me(Z,"SPAN",{class:!0});var re=de(i);n=Oe(re,c),u=Oe(re,":"),re.forEach(ie),m=Se(Z),w=me(Z,"INPUT",{type:!0,min:!0,max:!0,class:!0}),b=Se(Z),T=me(Z,"SPAN",{class:!0,"data-svelte-h":!0}),Vt(T)!=="svelte-opx6g7"&&(T.textContent=p),Z.forEach(ie),S=Se(ye),y=me(ye,"DIV",{class:!0});var j=de(y);_=me(j,"SELECT",{id:!0,class:!0});var R=de(_);for(let oe=0;oe<W.length;oe+=1)W[oe].l(R);R.forEach(ie),j.forEach(ie),ye.forEach(ie),V.forEach(ie),f=Se(se),x=me(se,"DIV",{class:!0});var K=de(x);k=Oe(K,r[13]),K.forEach(ie),C=Se(se),D=me(se,"DIV",{class:!0,"data-tree-container":!0});var X=de(D);A&&A.l(X),q=Se(X),M=Xr(X,!1),X.forEach(ie),se.forEach(ie),this.h()},h(){te(i,"class","mr-2 text-sm font-medium text-gray-700 dark:text-gray-300"),te(w,"type","number"),te(w,"min","0"),te(w,"max","100"),te(w,"class","w-16 h-8 px-3 py-1 text-sm border border-blue-200 dark:border-blue-800 rounded-md bg-white dark:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"),te(T,"class","ml-1 text-sm text-gray-700 dark:text-gray-300"),te(l,"class","flex items-center"),te(_,"id","monthSelector"),te(_,"class","h-8 px-3 py-1 min-w-[130px] border border-blue-200 dark:border-blue-800 rounded-md bg-white dark:bg-gray-800 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"),r[1]===void 0&&pa(()=>r[40].call(_)),te(y,"class","ml-auto"),te(s,"class","flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3"),te(t,"class","controls-section mb-6 p-4 rounded-lg bg-blue-50 dark:bg-blue-950/30 border border-blue-200 dark:border-blue-900/50 shadow-sm"),te(x,"class","hidden"),M.a=null,te(D,"class","analysis-content rounded-lg border border-blue-200 dark:border-blue-800 overflow-hidden bg-white dark:bg-gray-800 shadow-md shadow-blue-100 dark:shadow-none relative"),te(D,"data-tree-container","true"),te(e,"class","mb-6")},m(z,se){Pe(z,e,se),Y(e,t),Y(t,s),Y(s,l),Y(l,i),Y(i,n),Y(i,u),Y(l,m),Y(l,w),Lt(w,r[8]),Y(l,b),Y(l,T),Y(s,S),Y(s,y),Y(y,_);for(let V=0;V<W.length;V+=1)W[V]&&W[V].m(_,null);Di(_,r[1],!0),Y(e,f),Y(e,x),Y(x,k),Y(e,C),Y(e,D),A&&A.m(D,null),Y(D,q),M.m(J,D),I=!0,ue||(ee=[rt(w,"input",r[39]),rt(w,"change",r[22]),rt(_,"change",r[40]),rt(_,"change",r[23]),rt(D,"click",r[28])],ue=!0)},p(z,se){if((!I||se[0]&16384)&&c!==(c=z[14].t("Significance Threshold")+"")&&Be(n,c),se[0]&256&&ss(w.value)!==z[8]&&Lt(w,z[8]),se[0]&128){B=rr(z[7]);let V;for(V=0;V<B.length;V+=1){const ye=Go(z,B,V);W[V]?W[V].p(ye,se):(W[V]=ns(ye),W[V].c(),W[V].m(_,null))}for(;V<W.length;V+=1)W[V].d(1);W.length=B.length}se[0]&130&&Di(_,z[1]),(!I||se[0]&8192)&&Be(k,z[13]),z[5]?A?(A.p(z,se),se[0]&32&&Qe(A,1)):(A=is(z),A.c(),Qe(A,1),A.m(D,q)):A&&($t(),st(A,1,1,()=>{A=null}),Gt())},i(z){I||(Qe(A),I=!0)},o(z){st(A),I=!1},d(z){z&&ie(e),fi(W,z),A&&A.d(),ue=!1,lr(ee)}}}function vh(r){let e,t,s,l,i,c=r[14].t("Account Tree Missing")+"",n,u,m,w=r[14].t("To use the Account Analysis feature, you need to upload an account tree file first.")+"",b,T,p,S,y,_,f,x=r[14].t("Download Template")+"",k,C,D,q,M,J,I=r[14].t("Upload Account Tree")+"",ue,ee,B,W,A;return{c(){e=pe("div"),t=kt("svg"),s=kt("path"),l=Ae(),i=pe("p"),n=De(c),u=Ae(),m=pe("p"),b=De(w),T=Ae(),p=pe("div"),S=pe("button"),y=kt("svg"),_=kt("path"),f=Ae(),k=De(x),C=Ae(),D=pe("label"),q=kt("svg"),M=kt("path"),J=Ae(),ue=De(I),ee=Ae(),B=pe("input"),this.h()},l(z){e=me(z,"DIV",{class:!0});var se=de(e);t=Ct(se,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var V=de(t);s=Ct(V,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),de(s).forEach(ie),V.forEach(ie),l=Se(se),i=me(se,"P",{class:!0});var ye=de(i);n=Oe(ye,c),ye.forEach(ie),u=Se(se),m=me(se,"P",{class:!0});var Z=de(m);b=Oe(Z,w),Z.forEach(ie),T=Se(se),p=me(se,"DIV",{class:!0});var re=de(p);S=me(re,"BUTTON",{class:!0});var j=de(S);y=Ct(j,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var R=de(y);_=Ct(R,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),de(_).forEach(ie),R.forEach(ie),f=Se(j),k=Oe(j,x),j.forEach(ie),C=Se(re),D=me(re,"LABEL",{class:!0});var K=de(D);q=Ct(K,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var X=de(q);M=Ct(X,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),de(M).forEach(ie),X.forEach(ie),J=Se(K),ue=Oe(K,I),ee=Se(K),B=me(K,"INPUT",{type:!0,class:!0,accept:!0}),K.forEach(ie),re.forEach(ie),se.forEach(ie),this.h()},h(){te(s,"stroke-linecap","round"),te(s,"stroke-linejoin","round"),te(s,"stroke-width","2"),te(s,"d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"),te(t,"xmlns","http://www.w3.org/2000/svg"),te(t,"class","h-12 w-12 mx-auto mb-4 text-gray-400"),te(t,"fill","none"),te(t,"viewBox","0 0 24 24"),te(t,"stroke","currentColor"),te(i,"class","text-lg font-medium"),te(m,"class","text-sm mt-1 mb-4"),te(_,"stroke-linecap","round"),te(_,"stroke-linejoin","round"),te(_,"stroke-width","2"),te(_,"d","M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l2.414 2.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"),te(y,"xmlns","http://www.w3.org/2000/svg"),te(y,"class","h-5 w-5 mr-2"),te(y,"fill","none"),te(y,"viewBox","0 0 24 24"),te(y,"stroke","currentColor"),te(S,"class","px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition flex items-center"),te(M,"stroke-linecap","round"),te(M,"stroke-linejoin","round"),te(M,"stroke-width","2"),te(M,"d","M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"),te(q,"xmlns","http://www.w3.org/2000/svg"),te(q,"class","h-5 w-5 mr-2"),te(q,"fill","none"),te(q,"viewBox","0 0 24 24"),te(q,"stroke","currentColor"),te(B,"type","file"),te(B,"class","hidden"),te(B,"accept",".xlsx,.xls,.csv"),te(D,"class","px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition cursor-pointer flex items-center"),te(p,"class","flex justify-center space-x-3"),te(e,"class","text-center py-12 bg-white dark:bg-gray-800 rounded-lg shadow")},m(z,se){Pe(z,e,se),Y(e,t),Y(t,s),Y(e,l),Y(e,i),Y(i,n),Y(e,u),Y(e,m),Y(m,b),Y(e,T),Y(e,p),Y(p,S),Y(S,y),Y(y,_),Y(S,f),Y(S,k),Y(p,C),Y(p,D),Y(D,q),Y(q,M),Y(D,J),Y(D,ue),Y(D,ee),Y(D,B),W||(A=[rt(S,"click",r[25]),rt(B,"change",r[38])],W=!0)},p(z,se){se[0]&16384&&c!==(c=z[14].t("Account Tree Missing")+"")&&Be(n,c),se[0]&16384&&w!==(w=z[14].t("To use the Account Analysis feature, you need to upload an account tree file first.")+"")&&Be(b,w),se[0]&16384&&x!==(x=z[14].t("Download Template")+"")&&Be(k,x),se[0]&16384&&I!==(I=z[14].t("Upload Account Tree")+"")&&Be(ue,I)},i:dt,o:dt,d(z){z&&ie(e),W=!1,lr(A)}}}function bh(r){let e,t,s;return t=new dr({props:{className:"size-8"}}),{c(){e=pe("div"),cr(t.$$.fragment),this.h()},l(l){e=me(l,"DIV",{class:!0});var i=de(e);ur(t.$$.fragment,i),i.forEach(ie),this.h()},h(){te(e,"class","flex justify-center items-center h-64")},m(l,i){Pe(l,e,i),fr(t,e,null),s=!0},p:dt,i(l){s||(Qe(t.$$.fragment,l),s=!0)},o(l){st(t.$$.fragment,l),s=!1},d(l){l&&ie(e),hr(t)}}}function ns(r){let e,t=r[68]+"",s,l;return{c(){e=pe("option"),s=De(t),this.h()},l(i){e=me(i,"OPTION",{});var c=de(e);s=Oe(c,t),c.forEach(ie),this.h()},h(){e.__value=l=r[68],Lt(e,e.__value)},m(i,c){Pe(i,e,c),Y(e,s)},p(i,c){c[0]&128&&t!==(t=i[68]+"")&&Be(s,t),c[0]&128&&l!==(l=i[68])&&(e.__value=l,Lt(e,e.__value))},d(i){i&&ie(e)}}}function is(r){let e,t,s,l,i,c=r[14].t("Loading...")+"",n,u;return s=new dr({props:{className:"size-10"}}),{c(){e=pe("div"),t=pe("div"),cr(s.$$.fragment),l=Ae(),i=pe("p"),n=De(c),this.h()},l(m){e=me(m,"DIV",{class:!0});var w=de(e);t=me(w,"DIV",{class:!0});var b=de(t);ur(s.$$.fragment,b),l=Se(b),i=me(b,"P",{class:!0});var T=de(i);n=Oe(T,c),T.forEach(ie),b.forEach(ie),w.forEach(ie),this.h()},h(){te(i,"class","mt-2 text-gray-600 dark:text-gray-400"),te(t,"class","flex flex-col items-center"),te(e,"class","absolute inset-0 bg-white/60 dark:bg-gray-900/60 flex items-center justify-center z-10")},m(m,w){Pe(m,e,w),Y(e,t),fr(s,t,null),Y(t,l),Y(t,i),Y(i,n),u=!0},p(m,w){(!u||w[0]&16384)&&c!==(c=m[14].t("Loading...")+"")&&Be(n,c)},i(m){u||(Qe(s.$$.fragment,m),u=!0)},o(m){st(s.$$.fragment,m),u=!1},d(m){m&&ie(e),hr(s)}}}function _h(r){let e,t,s,l,i,c,n=r[15].isOpen&&Vo(r);const u=[ph,dh,hh,fh],m=[];function w(b,T){return b[2]==="main"?0:b[2]==="transactions"?1:b[2]==="chart"?2:b[2]==="analysis"?3:-1}return~(l=w(r))&&(i=m[l]=u[l](r)),{c(){n&&n.c(),e=Ae(),t=Ae(),s=pe("div"),i&&i.c(),this.h()},l(b){n&&n.l(b),e=Se(b),ca("svelte-ktehck",Ho.head).forEach(ie),t=Se(b),s=me(b,"DIV",{class:!0});var p=de(s);i&&i.l(p),p.forEach(ie),this.h()},h(){Ho.title="Account Analysis",te(s,"class","page-container w-full max-w-7xl mx-auto px-4 py-6 svelte-126e3bb")},m(b,T){n&&n.m(b,T),Pe(b,e,T),Pe(b,t,T),Pe(b,s,T),~l&&m[l].m(s,null),c=!0},p(b,T){b[15].isOpen?n?(n.p(b,T),T[0]&32768&&Qe(n,1)):(n=Vo(b),n.c(),Qe(n,1),n.m(e.parentNode,e)):n&&($t(),st(n,1,1,()=>{n=null}),Gt());let p=l;l=w(b),l===p?~l&&m[l].p(b,T):(i&&($t(),st(m[p],1,1,()=>{m[p]=null}),Gt()),~l?(i=m[l],i?i.p(b,T):(i=m[l]=u[l](b),i.c()),Qe(i,1),i.m(s,null)):i=null)},i(b){c||(Qe(n),Qe(i),c=!0)},o(b){st(n),st(i),c=!1},d(b){b&&(ie(e),ie(t),ie(s)),n&&n.d(b),~l&&m[l].d()}}}const yt="token_59b8b43a_aiurmmm0_upload_long_demo",xt="http://localhost:5002";function ei(r){if(!r||!r.name)return!1;const e=r.name;return/^\d/.test(e)||/\(A\d+\)/.test(e)||/\[A\d+\]/.test(e)||r.accounts&&Array.isArray(r.accounts)&&r.accounts.length>0?!0:r.level>=2&&(!r.children||Object.keys(r.children).length===0)?["account","acct","a/c","科目","账户"].some(s=>e.toLowerCase().includes(s)):!1}function oa(r){if(!r)return console.error("Invalid node provided to structureAccountTree"),{name:"Unknown",level:1,currentTotal:0,previousTotal:0,children:{}};const e={name:r.name||"Unknown",level:r.level||1,currentTotal:0,previousTotal:0,children:{}};return r.children&&Object.entries(r.children).forEach(([t,s])=>{e.children[t]=oa(s)}),e}function ui(r,e,t,s=[]){if(!t)return null;const l=t.name||"",c=l.split(" ")[0];if(console.log("Searching for account in tree:",{searchingFor:{account:r,accountName:e},currentNode:{nodeName:l,nodeAccountNumber:c,level:t.level},currentPath:s}),c===r||l===r){const n=[...s,l];return console.log("Found exact account match:",{account:r,foundPath:n}),n}if(l.includes(r)||e&&l.includes(e)){const n=[...s,l];return console.log("Found account number/name in node name:",{account:r,nodeName:l,foundPath:n}),n}if(t.accounts&&Array.isArray(t.accounts)&&t.accounts.some(u=>u===r||u.startsWith(r+" ")||e&&u.includes(e))){const u=[...s,l];return console.log("Found account in accounts array:",{account:r,foundPath:u}),u}if(t.children)for(const[n,u]of Object.entries(t.children)){const m=s.length===0&&t.level===0?[]:[...s,l],w=ui(r,e,u,m);if(w)return console.log("Found account in child node:",{account:r,childKey:n,childLevel:u.level,foundPath:w}),w}return null}function sa(r){r&&(r.currentTotal=0,r.previousTotal=0,r.children&&Object.values(r.children).forEach(e=>{sa(e)}))}function Eh(r,e,t,s){let l=r,i=1;if(console.log("Updating category totals:",{path:e,currentAmount:t,previousAmount:s,rootNodeName:r==null?void 0:r.name}),!e||e.length===0){console.log("Empty path provided to updateCategoryTotals");return}let c=0;e[0]===(r==null?void 0:r.name)&&(console.log("First path element matches root node name, skipping:",{rootNodeName:r.name,firstPathElement:e[0]}),c=1);for(let n=c;n<e.length;n++){const u=e[n];if(!u){console.log("Undefined category in path",{index:n,path:e});continue}u.startsWith("-")&&(i*=-1,console.log("Negating values for category:",{category:u,multiplier:i}));const m=(u.startsWith("-"),u);if(l.children&&(l.children[u]||l.children[m])){const w=l.children[u]||l.children[m];n===e.length-1&&(w.currentTotal+=t*i,w.previousTotal+=s*i,console.log("Updated leaf node totals:",{category:u,newTotals:{currentTotal:w.currentTotal,previousTotal:w.previousTotal},addedAmount:{current:t*i,previous:s*i}})),l=w}else{console.log("Category not found in children",{category:u,pathIndex:n,availableChildren:l.children?Object.keys(l.children):"none"});return}}}function aa(r){if(!r)return console.log("Null category in rollUpCategoryTotals"),{current:0,previous:0};let e=0,t=0;return!r.children||Object.keys(r.children).length===0?(e=r.currentTotal,t=r.previousTotal,{current:e,previous:t}):(Object.entries(r.children).forEach(([s,l])=>{const i=aa(l),c=s.startsWith("-")||l.name&&l.name.startsWith("-")?-1:1;e+=i.current*c,t+=i.previous*c}),r.currentTotal=e,r.previousTotal=t,{current:e,previous:t})}function lt(r){return r==null?"-":new Intl.NumberFormat("en-US",{minimumFractionDigits:0,maximumFractionDigits:0}).format(r)}function os(r){return r==null?"-":`${r>0?"+":""}${r.toFixed(1)}%`}function zr(r){return r?String(r).replace(/\n/g,"<br>"):""}function xh(r,e,t){let s,l,i,c,n;sn(r,va,G=>t(48,n=G));const u=ua("i18n");sn(r,u,G=>t(14,i=G));const m=ya({isOpen:!1,title:"",content:"",isLoading:!1,company:"",account:"",isEditing:!1,editText:""});sn(r,m,G=>t(15,c=G));function w(G,ne,le){m.update(be=>({...be,isOpen:!0,title:G,isLoading:!0,company:ne,account:le,isEditing:!1,editText:""}))}function b(){m.update(G=>({...G,isOpen:!1}))}function T(){m.update(G=>{const ne=G.isEditing?G.editText:G.content.replace(/<br>/g,`
`);return{...G,isEditing:!G.isEditing,editText:ne}})}function p(){m.update(G=>{if(!G.isEditing)return G;const ne=zr(G.editText);if(G.company&&G.account&&C){const le=`${G.company}-${G.account}-${C}`,be=`${G.company}-${G.account}`;t(34,M={...M,[le]:G.editText,[be]:G.editText}),ae(G.company,G.account,G.editText).then(()=>{Je.success(i.t("Analysis saved"))}).catch(Te=>{console.error("Error saving analysis:",Te),Je.error(i.t("Failed to save analysis"))})}return{...G,content:ne,isEditing:!1}})}let S="en";localStorage.getItem("locale")==="zh-CN"?S="zh-cn":S="en";let y=!1,_=null,f=null,x={},k={},C=null,D=[],q=10,M={},J="main",I=[],ue="",ee=null,B="",W=null,A="",z=!1,se=!1,V={month:null,company:null,account:null,timestamp:0},ye=!1;fa(()=>{if(console.log("Current user language:",i.language),console.log("Current user API key:",n),console.log("Component mounted, loading account tree..."),Z(),document.addEventListener("select-month",ne=>{if(console.log("Custom select-month event received:",ne.detail),ye){console.log("Already processing an event, skipping new event");return}if(ne.detail){const{month:le,company:be,account:Te}=ne.detail;console.log("Extracted values from event:",{month:le,company:be||"null/undefined",account:Te||"null/undefined",typeofCompany:typeof be,typeofAccount:typeof Te});const Ee=Date.now();if(V.month===le&&V.company===be&&V.account===Te&&Ee-V.timestamp<500){console.log("Ignoring duplicate event within debounce period");return}ye=!0,V={month:le,company:be,account:Te,timestamp:Ee},le?(console.log("Setting selected month to:",le),t(1,C=le),t(12,z=!0),setTimeout(async()=>{try{if(be&&Te&&be!=="undefined"&&Te!=="undefined"){console.log("Using company/account from event:",be,Te);const Re=`${be}-${Te}-${le}`,Ue=`${be}-${Te}`;console.log("Analysis keys to check:",{analysisKey:Re,generalKey:Ue,hasMonthSpecificAnalysis:!!M[Re],hasGeneralAnalysis:!!M[Ue]}),await L(be,Te)}else if(ee&&ee.company&&ee.account){console.log("Using company/account from chartData:",ee.company,ee.account);const Re=`${ee.company}-${ee.account}-${le}`,Ue=`${ee.company}-${ee.account}`;console.log("Analysis keys to check:",{analysisKey:Re,generalKey:Ue,hasMonthSpecificAnalysis:!!M[Re],hasGeneralAnalysis:!!M[Ue]}),await L(ee.company,ee.account)}else console.error("Cannot fetch analysis: missing company or account information",{fromEvent:{company:be,account:Te},fromChartData:ee?{company:ee.company,account:ee.account}:"chartData is null",chartData:ee}),t(12,z=!1)}finally{console.log("Finished processing select-month event"),ye=!1}},50)):ye=!1}else ye=!1}),setTimeout(()=>{const ne=document.getElementById("monthSelector");ne&&(console.log("Adding event listener to month selector"),ne.addEventListener("change",le=>{J==="chart"&&ee&&(console.log("Month selector changed, updating chart"),setTimeout(()=>we(),50))}))},500),typeof window<"u"&&!window.hasOwnProperty("Chart")){const ne=document.createElement("script");ne.src="https://cdn.jsdelivr.net/npm/chart.js",ne.async=!0,document.head.appendChild(ne)}const G=new MutationObserver(ne=>{ne.forEach(le=>{if(le.type==="attributes"&&le.attributeName==="data-ready"){const be=document.getElementById("trendChart");be&&be.getAttribute("data-ready")==="true"&&we()}})});setTimeout(()=>{const ne=document.getElementById("trendChart");ne&&(G.observe(ne,{attributes:!0}),ne.getAttribute("data-ready")==="true"&&we())},200)});async function Z(){try{t(5,y=!0),console.log("=== REQUEST ==="),console.log(`URL: ${xt}/api/account_tree`),console.log("Method: GET"),console.log("Headers:",{"Content-Type":"application/json","Accept-Language":S,Authorization:`Bearer ${yt}`}),console.log(`
`);const G=await fetch(`${xt}/api/account_tree`,{method:"GET",headers:{"Content-Type":"application/json","Accept-Language":S,Authorization:`Bearer ${yt}`}});console.log("=== RESPONSE ==="),console.log("Status:",G.status),console.log("Headers:",Object.fromEntries([...G.headers.entries()]));const ne=await G.json();console.log("Body:",ne),console.log(`
`),ne.success&&ne.data?(console.log("Account tree loaded successfully"),t(6,f=ne.data),re(f),await j()):(console.error("Account tree response indicates failure:",ne.error||"Unknown error"),t(6,f=null))}catch(G){console.error("Error loading account tree:",G),Je.error(i.t("Failed to load account tree")),t(6,f=null)}finally{t(5,y=!1)}}function re(G){if(!G)return;const ne=Object.keys(G);t(32,x={}),t(33,k={}),ne.length>0&&(ne.forEach(le=>{t(32,x[le]=!0,x),Object.keys(G).forEach(Te=>{const Ee=G[Te];if(Ee&&typeof Ee=="object"){const Ce=`${le}/${Te}`;t(33,k[Ce]=!0,k),Ee.children&&Object.entries(Ee.children).forEach(([Re,Ue])=>{const je=(Ue==null?void 0:Ue.name)||Re;if(je.includes("Operating")||je.includes("Profit")||je.includes("Revenue")||je.includes("Sales")||je.includes("Costs")||je.includes("Expenses")){const Ie=`${le}/${Te}/${Re}`;t(33,k[Ie]=!0,k),console.log(`Auto-expanded category: ${je}, Path: ${Ie}`)}})}})}),console.log("Initialized expanded states:",{companies:Object.keys(x),categories:Object.keys(k).length}))}async function j(){if(!f)return console.log("fetchData: No account tree available, returning early"),Promise.resolve();try{const G=C?`${xt}/api/is_analysis?month=${C}`:`${xt}/api/is_analysis`;console.log("=== REQUEST ==="),console.log(`URL: ${G}`),console.log("Method: GET"),console.log("Headers:",{"Content-Type":"application/json","Accept-Language":S,Authorization:`Bearer ${yt}`}),console.log(`
`);const ne=await fetch(G,{method:"GET",headers:{"Content-Type":"application/json","Accept-Language":S,Authorization:`Bearer ${yt}`}});console.log("=== RESPONSE ==="),console.log("Status:",ne.status),console.log("Headers:",Object.fromEntries([...ne.headers.entries()]));const le=await ne.json();if(console.log("Body:",le),console.log(`
`),le.success&&le.data)return console.log("IS analysis data loaded successfully"),t(0,_=R(le.data)),t(7,D=le.data.monthOptions||[]),C||t(1,C=le.data.selectedMonth),console.log("Selected month:",C),console.log("Available months:",D),console.log("Processed data:",_),Promise.resolve();throw console.error("IS analysis response indicates failure:",le.error||"Unknown error"),new Error(le.error||"Invalid data structure received")}catch(G){return console.error("Error loading IS analysis data:",G),Je.error(i.t("Failed to load analysis data")),Promise.reject(G)}}function R(G){if(!f)return{companies:{}};try{const ne={companies:{}};return console.log("Processing data with account tree:",{companiesCount:Object.keys(G.companies||{}).length,hasAccountTree:!!f}),Object.entries(G.companies||{}).forEach(([le,be])=>{ne.companies[le]={accounts:{},categories:oa(K()),currentTotal:0,previousTotal:0},console.log("Processing company data:",{company:le,accountsCount:Object.keys(be.accounts||{}).length}),Object.entries(be.accounts||{}).forEach(([Ee,Ce])=>{const Re=ui(Ee,Ce.name,K());console.log("Account category path found:",{account:Ee,accountName:Ce.name,categoryPath:Re||"Not found"}),Re?ne.companies[le].accounts[Ee]={...Ce,categoryPath:Re}:console.log("No category path found for account",{account:Ee,accountName:Ce.name})}),sa(ne.companies[le].categories);const Te=[];Object.entries(be.accounts||{}).forEach(([Ee,Ce])=>{const Re=ui(Ee,Ce.name,K());Re&&Te.push({account:Ee,accountName:Ce.name,categoryPath:Re,currentTotal:Ce.currentTotal||0,previousTotal:Ce.previousTotal||0})}),Te.sort((Ee,Ce)=>Ce.categoryPath.length-Ee.categoryPath.length),Te.forEach(({account:Ee,accountName:Ce,categoryPath:Re,currentTotal:Ue,previousTotal:je})=>{Eh(ne.companies[le].categories,Re,Ue,je)}),aa(ne.companies[le].categories)}),console.log("Processed data structure:",ne),ne}catch(ne){return console.error("Error processing data with tree:",ne),{companies:{}}}}function K(){if(!f||typeof f!="object")return console.error("Invalid account tree structure",{tree:f}),null;const G=Object.keys(f);if(G.length===0)return console.error("Account tree has no root nodes",{tree:f}),null;const ne={name:"Root",level:0,children:{}};return G.forEach(le=>{f[le]&&(ne.children[le]=f[le])}),console.log("Using merged root node for account tree:",{rootKeys:G,childrenCount:Object.keys(ne.children).length,childrenNames:Object.keys(ne.children).join(", ")}),ne}function X(G){if(!G){console.error("Invalid company name in toggleCompany");return}console.log("Toggling company:",G,"Current state:",x[G]);const ne={...x};ne[G]=!x[G],t(32,x=ne),console.log("New expanded state for company:",G,x[G]),t(13,s=Date.now().toString()),setTimeout(()=>{const le=document.querySelector('[data-tree-container="true"]');le?le.innerHTML=$():console.error("Analysis content container not found")},10)}function oe(G){if(!G||G==="Unknown"||G==="undefined"){console.error("Invalid category path in toggleCategory:",G);return}console.log("Toggling category:",G,"Current state:",k[G]);const ne={...k};ne[G]=!k[G],t(33,k=ne),console.log("New expanded state for category:",G,k[G]),t(13,s=Date.now().toString()),setTimeout(()=>{const le=document.querySelector('[data-tree-container="true"]');le?le.innerHTML=$():console.error("Analysis content container not found")},10)}function H(G){const ne=G.target.value.replace(/^0+/,"")||"0";t(8,q=Number(ne))}function v(G){t(1,C=G.target.value),console.log("Month changed to:",C),t(5,y=!0),j().then(()=>{console.log("Data fetched for new month, updating UI"),t(13,s=Date.now().toString()),J==="chart"&&ee&&(console.log("Updating chart with new month:",C),setTimeout(()=>we(),50)),t(5,y=!1)})}async function g(G,ne,le,be=!1){try{const Te=`${xt}/api/transactions?company=${encodeURIComponent(G)}&account=${encodeURIComponent(ne)}&month=${encodeURIComponent(le)}`;console.log("=== REQUEST ==="),console.log(`URL: ${Te}`),console.log("Method: GET"),console.log("Headers:",{"Content-Type":"application/json","Accept-Language":S,Authorization:`Bearer ${yt}`}),console.log(`
`);const Ee=await fetch(Te,{method:"GET",headers:{"Content-Type":"application/json","Accept-Language":S,Authorization:`Bearer ${yt}`}});console.log("=== RESPONSE ==="),console.log("Status:",Ee.status),console.log("Headers:",Object.fromEntries([...Ee.headers.entries()]));const Ce=await Ee.json();if(console.log("Body:",Ce),console.log(`
`),Ce.success&&Ce.data)t(9,I=Ce.data.transactions),t(10,ue=`${G} - ${ne} - ${le} ${be?"(Previous)":"(Current)"}`),t(2,J="transactions");else throw console.error("Transactions response indicates failure:",Ce.error||"Unknown error"),new Error(Ce.error||"Failed to load transactions")}catch(Te){console.error("Error loading transactions:",Te),Je.error(i.t("Failed to load transactions"))}}async function U(G,ne,le){console.log("handleAccountClick called with:",{company:G,account:ne,accountName:le});try{const be=`${xt}/api/account_trend?company=${encodeURIComponent(G)}&account=${encodeURIComponent(ne)}`;console.log("=== REQUEST ==="),console.log(`URL: ${be}`),console.log("Method: GET"),console.log("Headers:",{"Content-Type":"application/json","Accept-Language":S,Authorization:`Bearer ${yt}`}),console.log(`
`);const Te=await fetch(be,{method:"GET",headers:{"Content-Type":"application/json","Accept-Language":S,Authorization:`Bearer ${yt}`}});console.log("=== RESPONSE ==="),console.log("Status:",Te.status),console.log("Headers:",Object.fromEntries([...Te.headers.entries()]));const Ee=await Te.json();if(console.log("Body:",Ee),console.log(`
`),Ee.success&&Ee.data)t(3,ee={...Ee.data,company:G,account:ne}),console.log("ChartData set with explicit company/account:",ee),t(4,B=`${G} - ${ne} - ${le}`),t(2,J="chart"),M[`${G}-${ne}`]||L(G,ne);else throw console.error("Account trend response indicates failure:",Ee.error||"Unknown error"),new Error(Ee.error||"Failed to load trend data")}catch(be){console.error("Error loading trend data:",be),Je.error(i.t("Failed to load trend data"))}}async function L(G,ne){var be,Te,Ee,Ce;if(console.log("Fetching auto analysis for:",G,ne,"with selected month:",C),!G||!ne||G==="undefined"||ne==="undefined"){console.error("Invalid company or account for auto analysis:",{company:G,account:ne}),Je.error(i.t("Missing company or account information")),m.update(Re=>({...Re,isLoading:!1,content:`<p class="text-red-500">${i.t("Missing company or account information")}</p>`}));return}if(!C){console.error("Missing selected month for analysis"),Je.error(i.t("Missing month information")),m.update(Re=>({...Re,isLoading:!1,content:`<p class="text-red-500">${i.t("Missing month information")}</p>`}));return}if(!((Ee=(Te=(be=_==null?void 0:_.companies)==null?void 0:be[G])==null?void 0:Te.accounts)!=null&&Ee[ne])){console.debug("Data for auto analysis not available yet:",{company:G,account:ne,dataAvailable:!!_,companiesAvailable:_?Object.keys(_.companies||{}):[],accountsAvailable:(Ce=_==null?void 0:_.companies)!=null&&Ce[G]?Object.keys(_.companies[G].accounts||{}):[]});const Re=ne;w(`${G} - ${ne} - ${Re}`,G,ne);const Ue={name:Re,currentTotal:0,previousTotal:0,months:[{previousMonth:""}]};try{await N(G,ne,Ue)}catch(je){console.debug("Error in analysis with fallback data:",je),m.update($e=>({...$e,isLoading:!1,content:`<p>${i.t("Analysis data not available for this account yet. Please try again later.")}</p>`}))}return}const le=_.companies[G].accounts[ne];w(`${G} - ${ne} - ${le.name}`,G,ne),await N(G,ne,le)}async function N(G,ne,le){var Te,Ee;const be=setTimeout(()=>{m.update(Ce=>Ce.isLoading?(console.log("Analysis request timed out after 15 seconds"),Je.error(i.t("Analysis request timed out. Please try again.")),{...Ce,isLoading:!1,content:`<p class="text-red-500">${i.t("Analysis request timed out. Please try again.")}</p>`}):Ce)},15e3);try{console.log("Account data for analysis:",le);const Ce={company:G,account:ne,accountName:le.name,currentMonth:C,previousMonth:(Ee=(Te=le.months)==null?void 0:Te[0])==null?void 0:Ee.previousMonth,changePercentage:(le.currentTotal-le.previousTotal)/Math.abs(le.previousTotal||1)*100};console.log("Auto analysis request data:",Ce);const Re=new AbortController,Ue=setTimeout(()=>Re.abort(),1e4);let je,$e;try{if(je=await fetch(`${xt}/api/auto_analysis`,{method:"POST",headers:{"Content-Type":"application/json","Accept-Language":S,Authorization:`Bearer ${yt}`},body:JSON.stringify(Ce),signal:Re.signal}),clearTimeout(Ue),console.log("Auto analysis response status:",je.status),!je.ok)throw new Error(`Server responded with ${je.status}: ${je.statusText}`);$e=await je.json(),console.log("Auto analysis response data:",$e)}catch(Ie){Ie.name==="AbortError"?(console.error("Analysis request aborted due to timeout"),Je.error(i.t("Analysis request timed out")),m.update(He=>({...He,isLoading:!1,content:`<p class="text-red-500">${i.t("Analysis request timed out")}</p>`}))):(console.error("Error during fetch:",Ie),Je.error(i.t("Error communicating with server")),m.update(He=>({...He,isLoading:!1,content:`<p class="text-red-500">${i.t("Error communicating with server")}</p>`}))),clearTimeout(be);return}if($e&&$e.success){console.log("Auto analysis generated successfully");const Ie=typeof $e.analysis=="string"?$e.analysis:String($e.analysis||""),He=`${G}-${ne}-${C}`;t(34,M={...M,[He]:Ie,[`${G}-${ne}`]:Ie}),console.log("Analysis stored with keys:",{monthSpecificKey:He,generalKey:`${G}-${ne}`}),m.update(at=>({...at,isLoading:!1,content:zr(Ie),editText:Ie})),t(11,A=Ie),W=He}else{console.error("Auto analysis response indicates failure:",($e==null?void 0:$e.error)||"Unknown error"),Je.error(i.t("Failed to generate analysis")),m.update(at=>({...at,isLoading:!1,content:`<p class="text-red-500">${i.t("Failed to generate analysis")}</p>`}));const Ie=`${G}-${ne}-${C}`,He=`${G}-${ne}`;t(11,A=M[Ie]||M[He]||""),W=Ie}}catch(Ce){console.error("Error generating analysis:",Ce),Je.error(i.t("Error generating analysis")),m.update(je=>({...je,isLoading:!1,content:`<p class="text-red-500">${i.t("Error generating analysis")}</p>`}));const Re=`${G}-${ne}-${C}`,Ue=`${G}-${ne}`;t(11,A=M[Re]||M[Ue]||""),W=Re}finally{clearTimeout(be)}}async function O(){if(!W)return;const G=W.split("-"),ne=G[0],le=G[1],be=G.length>2?G.slice(2).join("-"):C;try{const Te=`${ne}-${le}-${be}`,Ee=`${ne}-${le}`;t(34,M={...M,[Te]:A,[Ee]:A}),await ae(ne,le,A),t(2,J="main"),Je.success(i.t("Analysis saved"))}catch(Te){console.error("Error saving analysis:",Te),Je.error(i.t("Failed to save analysis"))}}async function ae(G,ne,le){try{const be=_.companies[G].accounts[ne],Ee=await(await fetch(`${xt}/api/update_graph_analysis`,{method:"POST",headers:{"Content-Type":"application/json","Accept-Language":S,Authorization:`Bearer ${yt}`},body:JSON.stringify({company:G,account:ne,accountName:be.name,currentMonth:C,llm_analysis:le})})).json();if(!Ee.success)throw new Error(Ee.error||"Failed to update graph analysis")}catch(be){throw console.error("Error updating graph node analysis:",be),be}}async function h(){try{const G=await fetch(`${xt}/api/download_account_tree_template`,{method:"GET",headers:{"Content-Type":"application/json","Accept-Language":S,Authorization:`Bearer ${yt}`}});if(!G.ok)throw new Error("Failed to download template");const ne=await G.blob(),le=window.URL.createObjectURL(ne),be=document.createElement("a");be.style.display="none",be.href=le,be.download="account_tree_template.xlsx",document.body.appendChild(be),be.click(),setTimeout(()=>{window.URL.revokeObjectURL(le),document.body.removeChild(be)},100),Je.success(i.t("Template downloaded"))}catch(G){console.error("Error downloading template:",G),Je.error(i.t("Failed to download template"))}}function Q(G){return G?Math.abs(G)>=q:!1}function E(G){return G===1?`<span title="${i.t("Above normal range")}">🚩 +</span>`:G===-1?`<span title="${i.t("Below normal range")}">🚩 -</span>`:G===0?`<span title="${i.t("Within normal range")}">═</span>`:"-"}function o(){return`
      <div class="table-header w-full grid grid-cols-5 text-sm font-semibold py-2 px-3 bg-blue-100 dark:bg-blue-900/30 border-b border-blue-200 dark:border-blue-900/50 rounded-t-lg">
        <div class="col-span-1">${i.t("Account")}</div>
        <div class="text-right pr-4">${i.t("Current")}</div>
        <div class="text-right pr-4">${i.t("Previous")}</div>
        <div class="text-right pr-4">${i.t("Variance")}</div>
        <div class="text-right pr-4">${i.t("Change %")}</div>
      </div>
    `}function a(G,ne,le,be){var Ce,Re;const Te=be.previousTotal!==0?(be.currentTotal-be.previousTotal)/Math.abs(be.previousTotal)*100:0,Ee=Q(Te);return`
      <div class="account-row w-full grid grid-cols-5 text-sm py-2 px-3 border-b border-blue-100 dark:border-blue-900/20 hover:bg-blue-50 dark:hover:bg-blue-900/10 ${Ee?"bg-yellow-50 dark:bg-yellow-900/10":""}">
        <div class="flex items-center" style="padding-left: 16px;">
          <span class="font-mono text-xs mr-2 text-gray-500 dark:text-gray-400">${ne}</span>
          <span class="cursor-pointer hover:text-blue-600 dark:hover:text-blue-400" 
             data-action="account-click" 
             data-company="${G}" 
             data-account="${ne}" 
             data-name="${le}">
            ${le}
          </span>
        </div>
        <div class="text-right pr-4 cursor-pointer hover:text-blue-600 dark:hover:text-blue-400" 
           data-action="transactions" 
           data-company="${G}" 
           data-account="${ne}" 
           data-month="${C}">
          ${lt(be.currentTotal)}
        </div>
        <div class="text-right pr-4 cursor-pointer hover:text-blue-600 dark:hover:text-blue-400" 
           data-action="transactions-prev" 
           data-company="${G}" 
           data-account="${ne}" 
           data-month="${((Re=(Ce=be.months)==null?void 0:Ce[0])==null?void 0:Re.previousMonth)||""}">
          ${lt(be.previousTotal)}
        </div>
        <div class="text-right pr-4">
          ${lt(be.currentTotal-be.previousTotal)}
        </div>
        <div class="text-right pr-4 ${Ee?"text-red-600 dark:text-red-400 font-semibold":""}">
          ${os(Te)}
          <i class="edit-icon ml-2 cursor-pointer" 
             data-action="show-analysis" 
             data-company="${G}" 
             data-account="${ne}"
             data-name="${le}"
             title="${i.t("View Analysis")}">
            🔍
          </i>
        </div>
      </div>
    `}function d(G,ne,le,be){var He,at,Xe;if(!ne)return"";let Te="";const Ee=ne.name||"";if(!Ee)return console.error("Category has no name:",ne),"";if(le===0&&Ee==="Root")return console.log("Rendering root node children as categories:",Ee),ne.children&&Object.entries(ne.children).sort((Ve,Ke)=>{const gt=Ve[1].name||Ve[0],ht=Ke[1].name||Ke[0];return gt.includes("Operating Profit")||gt.includes("Profit")?-1:ht.includes("Operating Profit")||ht.includes("Profit")||gt.includes("Operating Costs")||gt.includes("Costs")?1:ht.includes("Operating Costs")||ht.includes("Costs")?-1:String(gt).localeCompare(String(ht))}).forEach(([Ve,Ke])=>{console.log(`Rendering top-level category: ${Ve}`),Te+=d(G,Ke,le+1,[...be,Ee])}),Te;if(le!==0&&(Ee==="利润"||Ee.toLowerCase()==="profit"))return console.log("Bypassing profit/loss node:",Ee),ne.children&&Object.entries(ne.children).forEach(([Ze,Ve])=>{Te+=d(G,Ve,le+1,[...be,Ee])}),Te;if(ei(ne)){console.log("Rendering account node:",Ee);const Ze=Ee.split(" ")[0],Ve=Ee.substring(Ze.length+1).trim(),Ke=((Xe=(at=(He=_==null?void 0:_.companies)==null?void 0:He[G])==null?void 0:at.accounts)==null?void 0:Xe[Ze])||{currentTotal:ne.currentTotal||0,previousTotal:ne.previousTotal||0};return a(G,Ze,Ve,Ke)}const Ce=[...be,Ee].join("/"),Re=!!k[Ce],Ue=Ee.startsWith("-")?Ee.substring(1):Ee;console.log(`Rendering category: ${Ee}, Path: ${Ce}, Level: ${le}`);const je=ne.currentTotal||0,$e=ne.previousTotal||0,Ie=$e!==0&&$e!=null?(je-$e)/Math.abs($e)*100:0;if(Te+=`
      <div class="category-section">
        <div 
          class="category-header w-full grid grid-cols-5 text-sm py-2 px-3 
          ${le>0?"bg-blue-50/70 dark:bg-blue-900/20":"bg-blue-100 dark:bg-blue-900/30"} 
          cursor-pointer hover:bg-blue-100 dark:hover:bg-blue-900/40 border-b border-blue-200 dark:border-blue-900/30"
          data-action="toggle-category" 
          data-path="${Ce}"
          style="padding-left: ${le*20+12}px">
          <div class="flex items-center">
            <div class="toggle-icon mr-2 text-blue-600 dark:text-blue-400">${Re?"▼":"▶"}</div>
            <div class="font-medium text-blue-800 dark:text-blue-300">${Ue}</div>
          </div>
          <div class="text-right pr-4">${lt(je)}</div>
          <div class="text-right pr-4">${lt($e)}</div>
          <div class="text-right pr-4">${lt(je-$e)}</div>
          <div class="text-right pr-4 ${Q(Ie)?"text-red-600 dark:text-red-400 font-semibold":""}">
            ${os(Ie)}
          </div>
        </div>
    `,Re&&ne.children){Te+='<div class="category-content">';try{Object.entries(ne.children).sort((Ve,Ke)=>{const gt=ei(Ve[1]),ht=ei(Ke[1]);if(gt&&!ht)return 1;if(!gt&&ht)return-1;const Nt=Ve[1].name||Ve[0],Mt=Ke[1].name||Ke[0];return String(Nt).localeCompare(String(Mt))}).forEach(([Ve,Ke])=>{Ke&&(Te+=d(G,Ke,le+1,[...be,Ee]))})}catch(Ze){console.error("Error rendering category children:",Ze),Te+=`<div class="error p-2 text-red-500">Error rendering children: ${Ze.message||"Unknown error"}</div>`}Te+="</div>"}return Te+="</div>",Te}function F(G,ne){if(!ne)return console.error("Invalid company data:",G),"";console.log("Rendering company:",G,ne);const le=!!x[G];let be=`
      <div class="company-section mb-4">
        <div class="company-header flex items-center justify-between p-3 bg-blue-50 dark:bg-blue-950/30 border border-blue-200 dark:border-blue-900/50 rounded-t-lg cursor-pointer transition duration-150 hover:bg-blue-100 dark:hover:bg-blue-900/50"
             data-action="toggle-company" 
             data-company="${G}">
          <div class="flex items-center">
            <div class="toggle-icon mr-2 text-blue-600 dark:text-blue-400">${le?"▼":"▶"}</div>
            <div class="font-bold text-blue-800 dark:text-blue-300">${G}</div>
          </div>
        </div>
    `;return le&&(be+=`
        <div class="company-content">
          <div class="company-data border border-blue-200 dark:border-blue-900/50 rounded-b-lg bg-white dark:bg-gray-800">
            ${o()}
    `,ne.categories&&(be+=d(G,ne.categories,0,[])),be+=`
        </div>
      </div>
    `),be+="</div>",be}function $(){if(!f||!_)return console.log("Cannot render tree: missing accountTree or data"),"";let G="";return console.log("Rendering tree structure with data:",_),Object.entries(_.companies||{}).forEach(([ne,le])=>{G+=F(ne,le)}),G}function P(G){const le=G.target.closest("[data-action]");if(!le)return;const be=le.dataset.action;switch(console.log("Modal action clicked:",be,le.dataset),be){case"toggle-company":const Te=le.dataset.company;if(!Te){console.error("No company key provided in toggle-company action");return}console.log("Toggle company clicked for:",Te),X(Te);break;case"toggle-category":const Ee=le.dataset.path;if(!Ee){console.error("No path provided in toggle-category action");return}console.log("Toggle category path:",Ee),oe(Ee);break;case"select-month":const Ce=le.dataset.month;if(Ce&&ee){console.log("Month selected:",Ce),t(1,C=Ce);const wr=`${ee.company}-${ee.account}-${Ce}`,yr=`${ee.company}-${ee.account}`;!M[wr]&&!M[yr]&&L(ee.company,ee.account)}break;case"close-popup":t(1,C=null);break;case"account-click":const Re=le.dataset.company,Ue=le.dataset.account,je=le.dataset.name;if(console.log("Account click action with data:",{company:Re,account:Ue,name:je}),!Re||!Ue){console.error("Missing company or account data for account-click action");return}U(Re,Ue,je);break;case"transactions":const $e=le.dataset.company,Ie=le.dataset.account,He=le.dataset.month;g($e,Ie,He);break;case"transactions-prev":const at=le.dataset.company,Xe=le.dataset.account;let Ze=le.dataset.month;if(!Ze)if(C){const[wr,yr]=C.split("-").map(Number);let vr=yr-1,Ri=wr;vr===0&&(vr=12,Ri--),Ze=`${Ri}-${vr.toString().padStart(2,"0")}`,console.log("Calculated previous month:",Ze)}else Ze=C;Ze&&g(at,Xe,Ze,!0);break;case"show-analysis":const Ve=le.dataset.company,Ke=le.dataset.account,gt=le.dataset.name;console.log("Show analysis for:",Ve,Ke,gt);const ht=`${Ve} - ${Ke} - ${gt}`,Nt=`${Ve}-${Ke}-${C}`,Mt=`${Ve}-${Ke}`;if(M[Nt]||M[Mt]){const wr=zr(M[Nt]||M[Mt]),yr=M[Nt]||M[Mt]||"";m.update(vr=>({...vr,isOpen:!0,title:ht,content:wr,isLoading:!1,company:Ve||"",account:Ke||"",isEditing:!1,editText:yr}))}else L(Ve,Ke);break;case"generate-analysis":const Ir=le.dataset.company,Rr=le.dataset.account,on=le.dataset.month;W=`${Ir}-${Rr}-${on}`,L(Ir,Rr);break}}function fe(){console.log("Navigating back from view:",J),t(2,J="main")}function we(){if(typeof window>"u")return;const G=document.getElementById("trendChart");if(!G||!ee)return;const ne=G.getAttribute("data-company"),le=G.getAttribute("data-account");if(console.log("Chart initialization with data attributes:",{company:ne,account:le,hasChartData:!!ee,dataReady:G.getAttribute("data-ready"),selectedMonth:C}),typeof Chart>"u"){console.log("Chart.js not loaded yet, trying again in 100ms"),setTimeout(we,100);return}try{const be=G.getContext("2d");if(!be)return;window.trendChartInstance&&(console.log("Destroying previous chart instance"),window.trendChartInstance.destroy());const Te=ee.months.map((Ie,He)=>({month:Ie,value:ee.values[He]||0,dateValue:Ie.split("-").map(Number).reduce((at,Xe)=>at*100+Xe,0),originalIndex:He})).sort((Ie,He)=>Ie.dateValue-He.dateValue),Ee=Te.map(Ie=>Ie.month),Ce=Te.map(Ie=>Ie.value),Re=Ee.map((Ie,He)=>{if(C===Ie)return"#8b5cf6";if(!C&&He===Ee.length-1)return"#3b82f6";const at=`${ee.company}-${ee.account}-${Ie}`,Xe=`${ee.company}-${ee.account}`;return M[at]||M[Xe]?"#60a5fa":"#94a3b8"}),Ue=be.createLinearGradient(0,0,800,0);Ue.addColorStop(0,"rgba(59, 130, 246, 0.8)"),Ue.addColorStop(1,"rgba(139, 92, 246, 0.8)"),console.log("Creating chart with following configuration:",{labels:Ee,company:ne,account:le,selectedMonth:C,canvasDataAttributes:{company:G.getAttribute("data-company"),account:G.getAttribute("data-account")},pointColors:Re});const je=Ee.map(Ie=>Ie===C?8:6),$e=Ee.map(Ie=>Ie===C?10:8);window.trendChartInstance=new Chart(be,{type:"line",data:{labels:Ee,datasets:[{label:"Monthly Values",data:Ce,borderColor:Ue,backgroundColor:Ue,pointBackgroundColor:Re,pointBorderColor:Ee.map(Ie=>"#ffffff"),pointBorderWidth:Ee.map(Ie=>Ie===C?2:1.5),pointRadius:je,pointHoverRadius:$e,borderWidth:3,tension:.1,fill:!1}]},options:{responsive:!0,maintainAspectRatio:!1,animation:{duration:500},plugins:{legend:{display:!1},tooltip:{callbacks:{label(Ie){return new Intl.NumberFormat().format(Ie.parsed.y)},title(Ie){return Ie[0].label}},backgroundColor:"rgba(0, 0, 0, 0.7)",titleFont:{size:14,weight:"bold"},bodyFont:{size:13},padding:10,displayColors:!1}},scales:{x:{ticks:{callback(Ie,He){return Ee[He].split("-")[1]||""},maxRotation:0,color(Ie){return Ee[Ie.index]===C?"#8b5cf6":void 0},font:{size:10,weight(Ie){return Ee[Ie.index]===C?"bold":"normal"}}},grid:{display:!1}},y:{beginAtZero:!0,ticks:{callback(Ie){return new Intl.NumberFormat().format(Ie)},font:{size:10}},grid:{color:"rgba(0, 0, 0, 0.05)"}}},onClick(Ie,He){if(He.length===0){console.log("Chart background clicked, clearing selected month"),t(1,C=null),setTimeout(()=>we(),50);return}const at=He[0].index,Xe=Ee[at];console.log("Chart point clicked:",{month:Xe,index:at,chartDataCompany:ee==null?void 0:ee.company,chartDataAccount:ee==null?void 0:ee.account}),t(1,C=Xe),setTimeout(()=>we(),50);const Ze=document.getElementById("trendChart"),Ve=Ze?Ze.getAttribute("data-company"):null,Ke=Ze?Ze.getAttribute("data-account"):null,gt=B+` - ${Xe}`,ht=`${Ve}-${Ke}-${Xe}`,Nt=`${Ve}-${Ke}`;if(M[ht]||M[Nt]){const Ir=zr(M[ht]||M[Nt]),Rr=M[ht]||M[Nt]||"";m.update(on=>({...on,isOpen:!0,title:gt,content:Ir,isLoading:!1,company:Ve||"",account:Ke||"",isEditing:!1,editText:Rr}))}else Ve&&Ke&&L(Ve,Ke);const Mt=new CustomEvent("select-month",{detail:{month:Xe,company:Ve,account:Ke}});console.log("Dispatching select-month event with:",{month:Xe,company:Ve,account:Ke}),document.dispatchEvent(Mt)}}}),console.log("Chart initialized successfully")}catch(be){console.error("Error initializing chart:",be)}}function he(){if(!ee||!ee.months||ee.months.length===0)return console.log("No chart data available"),"";const G=l;console.log("Rendering timeline with data:",{company:ee.company,account:ee.account,months:ee.months.length,refreshTimestamp:G,selectedMonth:C,isGeneratingAnalysis:z});const ne=ee.company||"",le=ee.account||"";console.log("Setting chart data attributes:",{company:ne,account:le});let be='<div class="chart-visualization relative bg-gradient-to-b from-blue-100/50 to-purple-100/30 dark:from-blue-900/20 dark:to-purple-900/10 p-6 pt-8 pb-12 rounded-xl shadow-sm border border-blue-100 dark:border-blue-900/30 mb-6">';if(be+=`<h3 class="text-lg font-medium mb-4 text-gray-700 dark:text-gray-300">${i.t("Monthly Trend")}</h3>`,be+='<div class="chart-container h-64 relative">',be+=`<canvas id="trendChart" width="800" height="250" data-company="${ne}" data-account="${le}" data-ready="true"></canvas>`,be+="</div>",C){const Te=ee.months.findIndex(Xe=>Xe===C),Ee=Te!==-1?ee.values[Te]:null;let Ce=null,Re=null,Ue=null;const je=[...ee.months].map((Xe,Ze)=>({month:Xe,value:ee.values[Ze],date:new Date(Xe.split("-")[0],parseInt(Xe.split("-")[1])-1)})).sort((Xe,Ze)=>Xe.date.getTime()-Ze.date.getTime()),$e=je.findIndex(Xe=>Xe.month===C);$e>0&&(Ce=je[$e-1].month,Re=je[$e-1].value,Re&&Re!==0&&(Ue=(Ee-Re)/Math.abs(Re)*100));const[Ie,He]=C.split("-"),at=`${He}/${Ie}`;if(be+='<div class="selected-month-indicator flex flex-col md:flex-row justify-between items-start md:items-center mt-4 p-4 bg-white dark:bg-gray-800 rounded-lg border border-blue-100 dark:border-blue-900/30 shadow-sm animate-fade-in">',be+='<div class="flex items-center mb-3 md:mb-0">',be+='<div class="w-3 h-3 rounded-full bg-purple-500 mr-2"></div>',be+=`<span class="font-medium text-gray-700 dark:text-gray-300">${at}</span>`,be+="</div>",be+='<div class="flex flex-col items-end">',be+=`<div class="text-xl font-bold">${lt(Ee)}</div>`,Ue!==null){const Xe=Ue>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400";be+=`<div class="text-sm ${Xe}">`,be+=`${Ue>=0?"+":""}${Ue.toFixed(1)}% vs ${Ce.split("-")[1]}/${Ce.split("-")[0]}`,be+="</div>"}be+="</div>",be+="</div>"}return be+="</div>",be}async function xe(){try{console.log("[DEBUG] Starting Word document download");let G="",ne="";if(c.isOpen?(console.log("[DEBUG] Getting content from modal"),G=c.editText||"",ne=c.title||"Analysis Report",!G&&c.content&&(G=c.content.replace(/<br>/g,`
`).replace(/<[^>]*>/g,""))):A&&(console.log("[DEBUG] Using input text"),G=A,ne=W||"Analysis Report"),!G){console.error("[DEBUG] No analysis content available"),Je.error(i.t("No analysis content to download"));return}console.log("[DEBUG] Creating document with Docxtemplater"),console.log("[DEBUG] Content length:",G.length),console.log("[DEBUG] Title:",ne);const Te=`${(ne||"analysis").replace(/[^a-z0-9]/gi,"_").toLowerCase()}_${new Date().toISOString().replace(/[-:.]/g,"").substring(0,14)}.docx`;try{const Ee=await Ea(G,ne);xa(Ee,Te)}catch(Ee){console.error("[DEBUG] Docxtemplater failed, falling back to simple document:",Ee);const Ce=await sh(G,ne);ah(Ce,Te)}console.log("[DEBUG] Download complete"),Je.success(i.t("Report downloaded successfully"))}catch(G){console.error("[DEBUG] Error downloading Word report:",G),Je.error(i.t("Failed to download report: ")+(G.message||"Unknown error"))}}function ke(){c.editText=this.value,m.set(c)}const Ne=async()=>{try{const G=event.currentTarget;G.classList.add("opacity-50","pointer-events-none"),G.innerHTML=`<svg class="animate-spin -ml-1 mr-2 h-4 w-4 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"></path></svg> ${i.t("Downloading...")}`,await xe(),setTimeout(()=>{G.classList.remove("opacity-50","pointer-events-none"),G.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l2.414 2.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg> ${i.t("Download Report")}`},1e3)}catch(G){console.error("Error in download button click handler:",G),Je.error(i.t("Download failed: ")+(G.message||""));const ne=event.currentTarget;ne.classList.remove("opacity-50","pointer-events-none"),ne.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l2.414 2.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg> ${i.t("Download Report")}`}},ot=G=>{if(G.target.files&&G.target.files.length>0){const ne=new FormData;ne.append("file",G.target.files[0]),fetch(`${xt}/api/upload_account_tree`,{method:"POST",headers:{Authorization:`Bearer ${yt}`},body:ne}).then(le=>le.json()).then(le=>{le.success?(Je.success(i.t("Account tree uploaded successfully")),Z()):Je.error(le.error||i.t("Upload failed"))}).catch(le=>{console.error("Error uploading account tree:",le),Je.error(i.t("Upload failed"))})}};function mt(){q=ss(this.value),t(8,q)}function ft(){C=da(this),t(1,C),t(7,D)}function Et(){A=this.value,t(11,A)}const Ge=async()=>{try{const G=event.currentTarget;G.classList.add("opacity-50","pointer-events-none"),G.innerHTML=`<svg class="animate-spin -ml-1 mr-2 h-4 w-4 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"></path></svg> ${i.t("Downloading...")}`,await xe(),setTimeout(()=>{G.classList.remove("opacity-50","pointer-events-none"),G.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l2.414 2.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg> ${i.t("Download Report")}`},1e3)}catch(G){console.error("Error in download button click handler:",G),Je.error(i.t("Download failed: ")+(G.message||""));const ne=event.currentTarget;ne.classList.remove("opacity-50","pointer-events-none"),ne.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l2.414 2.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg> ${i.t("Download Report")}`}};return r.$$.update=()=>{if(r.$$.dirty[0]&1|r.$$.dirty[1]&18&&_&&_.companies&&!se){console.log("Initializing expanded states (one-time)"),t(35,se=!0);const G=Object.keys(_.companies)[0];if(G){console.log("Automatically expanding first company:",G);const ne={...x};ne[G]=!0,t(32,x=ne)}}if(r.$$.dirty[1]&2&&console.log("expandedCompanies changed:",x),r.$$.dirty[1]&4&&console.log("expandedCategories changed:",Object.keys(k).length,"categories"),r.$$.dirty[0]&28&&ee&&J==="chart"){if(console.log("chartData changed, scheduling chart initialization"),(!ee.company||!ee.account)&&(console.warn("chartData missing company or account:",ee),B)){const G=B.split(" - ");G.length>=2&&(t(3,ee={...ee,company:G[0],account:G[1]}),console.log("Fixed chartData by extracting from title:",ee))}setTimeout(()=>{we()},200)}r.$$.dirty[0]&14&&C&&ee&&(console.log("Reactive update triggered for analysis UI with selected month:",C),l=Date.now(),J==="chart"&&(console.log("Updating chart for new selected month:",C),setTimeout(()=>we(),50))),r.$$.dirty[1]&8&&Object.keys(M).length>0&&(console.log("Analysis data updated, refreshing UI"),l=Date.now()),r.$$.dirty[0]&6&&C&&J==="chart"&&(console.log("Selected month changed to:",C),setTimeout(()=>{document.getElementById("trendChart")&&(console.log("Re-initializing chart with new month:",C),we())},50))},t(13,s=Date.now().toString()),l=Date.now(),[_,C,J,ee,B,y,f,D,q,I,ue,A,z,s,i,c,u,m,b,T,p,Z,H,v,O,h,E,$,P,fe,he,xe,x,k,M,se,ke,Ne,ot,mt,ft,Et,Ge]}class zh extends ma{constructor(e){super(),ga(this,e,xh,_h,la,{},null,[-1,-1,-1])}}export{zh as component};
//# sourceMappingURL=15.BMTywhuB.js.map
