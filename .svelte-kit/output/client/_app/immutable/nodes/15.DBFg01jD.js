import{s as la,k as Ae,e as de,o as Se,m as ca,d as ne,c as pe,a as he,f as te,i as Pe,j as sn,p as ua,q as fa,t as De,b as Oe,M as Vt,g as J,u as rt,a0 as ha,h as Be,G as lr,R as ss,Q as da,D as kt,E as Ct,n as dt,P as fi,B as Lt,a4 as qr,a5 as Xr,l as Ni,O as pa,N as Di}from"../chunks/Dc4_ziGv.js";import{S as ma,i as ga,t as Qe,a as st,c as Gt,g as $t,b as cr,d as ur,m as fr,e as hr}from"../chunks/CAZSMy3J.js";import{g as wa}from"../chunks/D0QH3NT1.js";import{e as rr}from"../chunks/C6kX8Nm-.js";import{t as Je}from"../chunks/gLvYLTeg.js";import{w as ya}from"../chunks/03rUxzUZ.js";import{S as dr}from"../chunks/7Z-YgjJE.js";import{l as va}from"../chunks/DhUbH0v9.js";import"../chunks/RkzYe8eb.js";import{P as ba,D as _a,c as Ea,d as xa}from"../chunks/BgXee8Yk.js";import{F as Ta}from"../chunks/0n0hRmjK.js";import{b as Aa}from"../chunks/CisIfe-u.js";var Sa=Object.defineProperty,ka=Object.defineProperties,Ca=Object.getOwnPropertyDescriptors,Oi=Object.getOwnPropertySymbols,Ia=Object.prototype.hasOwnProperty,Ra=Object.prototype.propertyIsEnumerable,ti=(r,e,t)=>e in r?Sa(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,ze=(r,e)=>{for(var t in e||(e={}))Ia.call(e,t)&&ti(r,t,e[t]);if(Oi)for(var t of Oi(e))Ra.call(e,t)&&ti(r,t,e[t]);return r},Tr=(r,e)=>ka(r,Ca(e)),me=(r,e,t)=>(ti(r,typeof e!="symbol"?e+"":e,t),t),Nr=(r,e,t)=>new Promise((s,l)=>{var i=u=>{try{n(t.next(u))}catch(m){l(m)}},c=u=>{try{n(t.throw(u))}catch(m){l(m)}},n=u=>u.done?s(u.value):Promise.resolve(u.value).then(i,c);n((t=t.apply(r,e)).next())});class Gr{constructor(e){me(this,"rootKey"),this.rootKey=e}}const Na=Object.seal({});class ye extends Gr{constructor(e){super(e),me(this,"root"),this.root=new Array}prepForXml(e){var t;e.stack.push(this);const s=this.root.map(l=>l instanceof Gr?l.prepForXml(e):l).filter(l=>l!==void 0);return e.stack.pop(),{[this.rootKey]:s.length?s.length===1&&((t=s[0])!=null&&t._attr)?s[0]:s:Na}}addChildElement(e){return this.root.push(e),this}}class Zr extends ye{prepForXml(e){const t=super.prepForXml(e);if(t&&(typeof t[this.rootKey]!="object"||Object.keys(t[this.rootKey]).length))return t}}class Fe extends Gr{constructor(e){super("_attr"),me(this,"xmlKeys"),this.root=e}prepForXml(e){const t={};return Object.keys(this.root).forEach(s=>{const l=this.root[s];if(l!==void 0){const i=this.xmlKeys&&this.xmlKeys[s]||s;t[i]=l}}),{_attr:t}}}class Sr extends Gr{constructor(e){super("_attr"),this.root=e}prepForXml(e){return{_attr:Object.values(this.root).filter(({value:s})=>s!==void 0).reduce((s,{key:l,value:i})=>Tr(ze({},s),{[l]:i}),{})}}}class nt extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{val:"w:val",color:"w:color",fill:"w:fill",space:"w:space",sz:"w:sz",type:"w:type",rsidR:"w:rsidR",rsidRPr:"w:rsidRPr",rsidSect:"w:rsidSect",w:"w:w",h:"w:h",top:"w:top",right:"w:right",bottom:"w:bottom",left:"w:left",header:"w:header",footer:"w:footer",gutter:"w:gutter",linePitch:"w:linePitch",pos:"w:pos"})}}var Rt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function as(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var ls={},hi={exports:{}},Yt=typeof Reflect=="object"?Reflect:null,Bi=Yt&&typeof Yt.apply=="function"?Yt.apply:function(e,t,s){return Function.prototype.apply.call(e,t,s)},Hr;Yt&&typeof Yt.ownKeys=="function"?Hr=Yt.ownKeys:Object.getOwnPropertySymbols?Hr=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Hr=function(e){return Object.getOwnPropertyNames(e)};function Da(r){console&&console.warn&&console.warn(r)}var cs=Number.isNaN||function(e){return e!==e};function qe(){qe.init.call(this)}hi.exports=qe;hi.exports.once=La;qe.EventEmitter=qe;qe.prototype._events=void 0;qe.prototype._eventsCount=0;qe.prototype._maxListeners=void 0;var Fi=10;function Yr(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(qe,"defaultMaxListeners",{enumerable:!0,get:function(){return Fi},set:function(r){if(typeof r!="number"||r<0||cs(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");Fi=r}});qe.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};qe.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||cs(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function us(r){return r._maxListeners===void 0?qe.defaultMaxListeners:r._maxListeners}qe.prototype.getMaxListeners=function(){return us(this)};qe.prototype.emit=function(e){for(var t=[],s=1;s<arguments.length;s++)t.push(arguments[s]);var l=e==="error",i=this._events;if(i!==void 0)l=l&&i.error===void 0;else if(!l)return!1;if(l){var c;if(t.length>0&&(c=t[0]),c instanceof Error)throw c;var n=new Error("Unhandled error."+(c?" ("+c.message+")":""));throw n.context=c,n}var u=i[e];if(u===void 0)return!1;if(typeof u=="function")Bi(u,this,t);else for(var m=u.length,y=ms(u,m),s=0;s<m;++s)Bi(y[s],this,t);return!0};function fs(r,e,t,s){var l,i,c;if(Yr(t),i=r._events,i===void 0?(i=r._events=Object.create(null),r._eventsCount=0):(i.newListener!==void 0&&(r.emit("newListener",e,t.listener?t.listener:t),i=r._events),c=i[e]),c===void 0)c=i[e]=t,++r._eventsCount;else if(typeof c=="function"?c=i[e]=s?[t,c]:[c,t]:s?c.unshift(t):c.push(t),l=us(r),l>0&&c.length>l&&!c.warned){c.warned=!0;var n=new Error("Possible EventEmitter memory leak detected. "+c.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");n.name="MaxListenersExceededWarning",n.emitter=r,n.type=e,n.count=c.length,Da(n)}return r}qe.prototype.addListener=function(e,t){return fs(this,e,t,!1)};qe.prototype.on=qe.prototype.addListener;qe.prototype.prependListener=function(e,t){return fs(this,e,t,!0)};function Oa(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function hs(r,e,t){var s={fired:!1,wrapFn:void 0,target:r,type:e,listener:t},l=Oa.bind(s);return l.listener=t,s.wrapFn=l,l}qe.prototype.once=function(e,t){return Yr(t),this.on(e,hs(this,e,t)),this};qe.prototype.prependOnceListener=function(e,t){return Yr(t),this.prependListener(e,hs(this,e,t)),this};qe.prototype.removeListener=function(e,t){var s,l,i,c,n;if(Yr(t),l=this._events,l===void 0)return this;if(s=l[e],s===void 0)return this;if(s===t||s.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete l[e],l.removeListener&&this.emit("removeListener",e,s.listener||t));else if(typeof s!="function"){for(i=-1,c=s.length-1;c>=0;c--)if(s[c]===t||s[c].listener===t){n=s[c].listener,i=c;break}if(i<0)return this;i===0?s.shift():Ba(s,i),s.length===1&&(l[e]=s[0]),l.removeListener!==void 0&&this.emit("removeListener",e,n||t)}return this};qe.prototype.off=qe.prototype.removeListener;qe.prototype.removeAllListeners=function(e){var t,s,l;if(s=this._events,s===void 0)return this;if(s.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):s[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete s[e]),this;if(arguments.length===0){var i=Object.keys(s),c;for(l=0;l<i.length;++l)c=i[l],c!=="removeListener"&&this.removeAllListeners(c);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=s[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(l=t.length-1;l>=0;l--)this.removeListener(e,t[l]);return this};function ds(r,e,t){var s=r._events;if(s===void 0)return[];var l=s[e];return l===void 0?[]:typeof l=="function"?t?[l.listener||l]:[l]:t?Fa(l):ms(l,l.length)}qe.prototype.listeners=function(e){return ds(this,e,!0)};qe.prototype.rawListeners=function(e){return ds(this,e,!1)};qe.listenerCount=function(r,e){return typeof r.listenerCount=="function"?r.listenerCount(e):ps.call(r,e)};qe.prototype.listenerCount=ps;function ps(r){var e=this._events;if(e!==void 0){var t=e[r];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}qe.prototype.eventNames=function(){return this._eventsCount>0?Hr(this._events):[]};function ms(r,e){for(var t=new Array(e),s=0;s<e;++s)t[s]=r[s];return t}function Ba(r,e){for(;e+1<r.length;e++)r[e]=r[e+1];r.pop()}function Fa(r){for(var e=new Array(r.length),t=0;t<e.length;++t)e[t]=r[t].listener||r[t];return e}function La(r,e){return new Promise(function(t,s){function l(c){r.removeListener(e,i),s(c)}function i(){typeof r.removeListener=="function"&&r.removeListener("error",l),t([].slice.call(arguments))}gs(r,e,i,{once:!0}),e!=="error"&&Pa(r,l,{once:!0})})}function Pa(r,e,t){typeof r.on=="function"&&gs(r,"error",e,t)}function gs(r,e,t,s){if(typeof r.on=="function")s.once?r.once(e,t):r.on(e,t);else if(typeof r.addEventListener=="function")r.addEventListener(e,function l(i){s.once&&r.removeEventListener(e,l),t(i)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}var di=hi.exports,ri={exports:{}};typeof Object.create=="function"?ri.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:ri.exports=function(e,t){if(t){e.super_=t;var s=function(){};s.prototype=t.prototype,e.prototype=new s,e.prototype.constructor=e}};var Kt=ri.exports;function Ua(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var ws={exports:{}},it=ws.exports={},At,St;function ni(){throw new Error("setTimeout has not been defined")}function ii(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?At=setTimeout:At=ni}catch{At=ni}try{typeof clearTimeout=="function"?St=clearTimeout:St=ii}catch{St=ii}})();function ys(r){if(At===setTimeout)return setTimeout(r,0);if((At===ni||!At)&&setTimeout)return At=setTimeout,setTimeout(r,0);try{return At(r,0)}catch{try{return At.call(null,r,0)}catch{return At.call(this,r,0)}}}function Ma(r){if(St===clearTimeout)return clearTimeout(r);if((St===ii||!St)&&clearTimeout)return St=clearTimeout,clearTimeout(r);try{return St(r)}catch{try{return St.call(null,r)}catch{return St.call(this,r)}}}var Ot=[],Jt=!1,Ht,Wr=-1;function ja(){!Jt||!Ht||(Jt=!1,Ht.length?Ot=Ht.concat(Ot):Wr=-1,Ot.length&&vs())}function vs(){if(!Jt){var r=ys(ja);Jt=!0;for(var e=Ot.length;e;){for(Ht=Ot,Ot=[];++Wr<e;)Ht&&Ht[Wr].run();Wr=-1,e=Ot.length}Ht=null,Jt=!1,Ma(r)}}it.nextTick=function(r){var e=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)e[t-1]=arguments[t];Ot.push(new bs(r,e)),Ot.length===1&&!Jt&&ys(vs)};function bs(r,e){this.fun=r,this.array=e}bs.prototype.run=function(){this.fun.apply(null,this.array)};it.title="browser";it.browser=!0;it.env={};it.argv=[];it.version="";it.versions={};function Bt(){}it.on=Bt;it.addListener=Bt;it.once=Bt;it.off=Bt;it.removeListener=Bt;it.removeAllListeners=Bt;it.emit=Bt;it.prependListener=Bt;it.prependOnceListener=Bt;it.listeners=function(r){return[]};it.binding=function(r){throw new Error("process.binding is not supported")};it.cwd=function(){return"/"};it.chdir=function(r){throw new Error("process.chdir is not supported")};it.umask=function(){return 0};var za=ws.exports;const Me=Ua(za);var an,Li;function _s(){return Li||(Li=1,an=di.EventEmitter),an}var ln={},br={},Pi;function Ha(){if(Pi)return br;Pi=1,br.byteLength=n,br.toByteArray=m,br.fromByteArray=T;for(var r=[],e=[],t=typeof Uint8Array<"u"?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l=0,i=s.length;l<i;++l)r[l]=s[l],e[s.charCodeAt(l)]=l;e[45]=62,e[95]=63;function c(p){var S=p.length;if(S%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var g=p.indexOf("=");g===-1&&(g=S);var x=g===S?0:4-g%4;return[g,x]}function n(p){var S=c(p),g=S[0],x=S[1];return(g+x)*3/4-x}function u(p,S,g){return(S+g)*3/4-g}function m(p){var S,g=c(p),x=g[0],f=g[1],_=new t(u(p,x,f)),k=0,N=f>0?x-4:x,I;for(I=0;I<N;I+=4)S=e[p.charCodeAt(I)]<<18|e[p.charCodeAt(I+1)]<<12|e[p.charCodeAt(I+2)]<<6|e[p.charCodeAt(I+3)],_[k++]=S>>16&255,_[k++]=S>>8&255,_[k++]=S&255;return f===2&&(S=e[p.charCodeAt(I)]<<2|e[p.charCodeAt(I+1)]>>4,_[k++]=S&255),f===1&&(S=e[p.charCodeAt(I)]<<10|e[p.charCodeAt(I+1)]<<4|e[p.charCodeAt(I+2)]>>2,_[k++]=S>>8&255,_[k++]=S&255),_}function y(p){return r[p>>18&63]+r[p>>12&63]+r[p>>6&63]+r[p&63]}function b(p,S,g){for(var x,f=[],_=S;_<g;_+=3)x=(p[_]<<16&16711680)+(p[_+1]<<8&65280)+(p[_+2]&255),f.push(y(x));return f.join("")}function T(p){for(var S,g=p.length,x=g%3,f=[],_=16383,k=0,N=g-x;k<N;k+=_)f.push(b(p,k,k+_>N?N:k+_));return x===1?(S=p[g-1],f.push(r[S>>2]+r[S<<4&63]+"==")):x===2&&(S=(p[g-2]<<8)+p[g-1],f.push(r[S>>10]+r[S>>4&63]+r[S<<2&63]+"=")),f.join("")}return br}var Dr={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var Ui;function Wa(){return Ui||(Ui=1,Dr.read=function(r,e,t,s,l){var i,c,n=l*8-s-1,u=(1<<n)-1,m=u>>1,y=-7,b=t?l-1:0,T=t?-1:1,p=r[e+b];for(b+=T,i=p&(1<<-y)-1,p>>=-y,y+=n;y>0;i=i*256+r[e+b],b+=T,y-=8);for(c=i&(1<<-y)-1,i>>=-y,y+=s;y>0;c=c*256+r[e+b],b+=T,y-=8);if(i===0)i=1-m;else{if(i===u)return c?NaN:(p?-1:1)*(1/0);c=c+Math.pow(2,s),i=i-m}return(p?-1:1)*c*Math.pow(2,i-s)},Dr.write=function(r,e,t,s,l,i){var c,n,u,m=i*8-l-1,y=(1<<m)-1,b=y>>1,T=l===23?Math.pow(2,-24)-Math.pow(2,-77):0,p=s?0:i-1,S=s?1:-1,g=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(n=isNaN(e)?1:0,c=y):(c=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-c))<1&&(c--,u*=2),c+b>=1?e+=T/u:e+=T*Math.pow(2,1-b),e*u>=2&&(c++,u/=2),c+b>=y?(n=0,c=y):c+b>=1?(n=(e*u-1)*Math.pow(2,l),c=c+b):(n=e*Math.pow(2,b-1)*Math.pow(2,l),c=0));l>=8;r[t+p]=n&255,p+=S,n/=256,l-=8);for(c=c<<l|n,m+=l;m>0;r[t+p]=c&255,p+=S,c/=256,m-=8);r[t+p-S]|=g*128}),Dr}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var Mi;function Jr(){return Mi||(Mi=1,function(r){var e=Ha(),t=Wa(),s=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;r.Buffer=n,r.SlowBuffer=_,r.INSPECT_MAX_BYTES=50;var l=2147483647;r.kMaxLength=l,n.TYPED_ARRAY_SUPPORT=i(),!n.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function i(){try{var E=new Uint8Array(1),o={foo:function(){return 42}};return Object.setPrototypeOf(o,Uint8Array.prototype),Object.setPrototypeOf(E,o),E.foo()===42}catch{return!1}}Object.defineProperty(n.prototype,"parent",{enumerable:!0,get:function(){if(n.isBuffer(this))return this.buffer}}),Object.defineProperty(n.prototype,"offset",{enumerable:!0,get:function(){if(n.isBuffer(this))return this.byteOffset}});function c(E){if(E>l)throw new RangeError('The value "'+E+'" is invalid for option "size"');var o=new Uint8Array(E);return Object.setPrototypeOf(o,n.prototype),o}function n(E,o,a){if(typeof E=="number"){if(typeof o=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return b(E)}return u(E,o,a)}n.poolSize=8192;function u(E,o,a){if(typeof E=="string")return T(E,o);if(ArrayBuffer.isView(E))return S(E);if(E==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof E);if(se(E,ArrayBuffer)||E&&se(E.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(se(E,SharedArrayBuffer)||E&&se(E.buffer,SharedArrayBuffer)))return g(E,o,a);if(typeof E=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var d=E.valueOf&&E.valueOf();if(d!=null&&d!==E)return n.from(d,o,a);var F=x(E);if(F)return F;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof E[Symbol.toPrimitive]=="function")return n.from(E[Symbol.toPrimitive]("string"),o,a);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof E)}n.from=function(E,o,a){return u(E,o,a)},Object.setPrototypeOf(n.prototype,Uint8Array.prototype),Object.setPrototypeOf(n,Uint8Array);function m(E){if(typeof E!="number")throw new TypeError('"size" argument must be of type number');if(E<0)throw new RangeError('The value "'+E+'" is invalid for option "size"')}function y(E,o,a){return m(E),E<=0?c(E):o!==void 0?typeof a=="string"?c(E).fill(o,a):c(E).fill(o):c(E)}n.alloc=function(E,o,a){return y(E,o,a)};function b(E){return m(E),c(E<0?0:f(E)|0)}n.allocUnsafe=function(E){return b(E)},n.allocUnsafeSlow=function(E){return b(E)};function T(E,o){if((typeof o!="string"||o==="")&&(o="utf8"),!n.isEncoding(o))throw new TypeError("Unknown encoding: "+o);var a=k(E,o)|0,d=c(a),F=d.write(E,o);return F!==a&&(d=d.slice(0,F)),d}function p(E){for(var o=E.length<0?0:f(E.length)|0,a=c(o),d=0;d<o;d+=1)a[d]=E[d]&255;return a}function S(E){if(se(E,Uint8Array)){var o=new Uint8Array(E);return g(o.buffer,o.byteOffset,o.byteLength)}return p(E)}function g(E,o,a){if(o<0||E.byteLength<o)throw new RangeError('"offset" is outside of buffer bounds');if(E.byteLength<o+(a||0))throw new RangeError('"length" is outside of buffer bounds');var d;return o===void 0&&a===void 0?d=new Uint8Array(E):a===void 0?d=new Uint8Array(E,o):d=new Uint8Array(E,o,a),Object.setPrototypeOf(d,n.prototype),d}function x(E){if(n.isBuffer(E)){var o=f(E.length)|0,a=c(o);return a.length===0||E.copy(a,0,0,o),a}if(E.length!==void 0)return typeof E.length!="number"||h(E.length)?c(0):p(E);if(E.type==="Buffer"&&Array.isArray(E.data))return p(E.data)}function f(E){if(E>=l)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+l.toString(16)+" bytes");return E|0}function _(E){return+E!=E&&(E=0),n.alloc(+E)}n.isBuffer=function(o){return o!=null&&o._isBuffer===!0&&o!==n.prototype},n.compare=function(o,a){if(se(o,Uint8Array)&&(o=n.from(o,o.offset,o.byteLength)),se(a,Uint8Array)&&(a=n.from(a,a.offset,a.byteLength)),!n.isBuffer(o)||!n.isBuffer(a))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(o===a)return 0;for(var d=o.length,F=a.length,$=0,P=Math.min(d,F);$<P;++$)if(o[$]!==a[$]){d=o[$],F=a[$];break}return d<F?-1:F<d?1:0},n.isEncoding=function(o){switch(String(o).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},n.concat=function(o,a){if(!Array.isArray(o))throw new TypeError('"list" argument must be an Array of Buffers');if(o.length===0)return n.alloc(0);var d;if(a===void 0)for(a=0,d=0;d<o.length;++d)a+=o[d].length;var F=n.allocUnsafe(a),$=0;for(d=0;d<o.length;++d){var P=o[d];if(se(P,Uint8Array))$+P.length>F.length?n.from(P).copy(F,$):Uint8Array.prototype.set.call(F,P,$);else if(n.isBuffer(P))P.copy(F,$);else throw new TypeError('"list" argument must be an Array of Buffers');$+=P.length}return F};function k(E,o){if(n.isBuffer(E))return E.length;if(ArrayBuffer.isView(E)||se(E,ArrayBuffer))return E.byteLength;if(typeof E!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof E);var a=E.length,d=arguments.length>2&&arguments[2]===!0;if(!d&&a===0)return 0;for(var F=!1;;)switch(o){case"ascii":case"latin1":case"binary":return a;case"utf8":case"utf-8":return w(E).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return a*2;case"hex":return a>>>1;case"base64":return D(E).length;default:if(F)return d?-1:w(E).length;o=(""+o).toLowerCase(),F=!0}}n.byteLength=k;function N(E,o,a){var d=!1;if((o===void 0||o<0)&&(o=0),o>this.length||((a===void 0||a>this.length)&&(a=this.length),a<=0)||(a>>>=0,o>>>=0,a<=o))return"";for(E||(E="utf8");;)switch(E){case"hex":return Y(this,o,a);case"utf8":case"utf-8":return A(this,o,a);case"ascii":return V(this,o,a);case"latin1":case"binary":return we(this,o,a);case"base64":return H(this,o,a);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ee(this,o,a);default:if(d)throw new TypeError("Unknown encoding: "+E);E=(E+"").toLowerCase(),d=!0}}n.prototype._isBuffer=!0;function I(E,o,a){var d=E[o];E[o]=E[a],E[a]=d}n.prototype.swap16=function(){var o=this.length;if(o%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var a=0;a<o;a+=2)I(this,a,a+1);return this},n.prototype.swap32=function(){var o=this.length;if(o%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var a=0;a<o;a+=4)I(this,a,a+3),I(this,a+1,a+2);return this},n.prototype.swap64=function(){var o=this.length;if(o%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var a=0;a<o;a+=8)I(this,a,a+7),I(this,a+1,a+6),I(this,a+2,a+5),I(this,a+3,a+4);return this},n.prototype.toString=function(){var o=this.length;return o===0?"":arguments.length===0?A(this,0,o):N.apply(this,arguments)},n.prototype.toLocaleString=n.prototype.toString,n.prototype.equals=function(o){if(!n.isBuffer(o))throw new TypeError("Argument must be a Buffer");return this===o?!0:n.compare(this,o)===0},n.prototype.inspect=function(){var o="",a=r.INSPECT_MAX_BYTES;return o=this.toString("hex",0,a).replace(/(.{2})/g,"$1 ").trim(),this.length>a&&(o+=" ... "),"<Buffer "+o+">"},s&&(n.prototype[s]=n.prototype.inspect),n.prototype.compare=function(o,a,d,F,$){if(se(o,Uint8Array)&&(o=n.from(o,o.offset,o.byteLength)),!n.isBuffer(o))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof o);if(a===void 0&&(a=0),d===void 0&&(d=o?o.length:0),F===void 0&&(F=0),$===void 0&&($=this.length),a<0||d>o.length||F<0||$>this.length)throw new RangeError("out of range index");if(F>=$&&a>=d)return 0;if(F>=$)return-1;if(a>=d)return 1;if(a>>>=0,d>>>=0,F>>>=0,$>>>=0,this===o)return 0;for(var P=$-F,ue=d-a,ve=Math.min(P,ue),ae=this.slice(F,$),xe=o.slice(a,d),ke=0;ke<ve;++ke)if(ae[ke]!==xe[ke]){P=ae[ke],ue=xe[ke];break}return P<ue?-1:ue<P?1:0};function X(E,o,a,d,F){if(E.length===0)return-1;if(typeof a=="string"?(d=a,a=0):a>2147483647?a=2147483647:a<-2147483648&&(a=-2147483648),a=+a,h(a)&&(a=F?0:E.length-1),a<0&&(a=E.length+a),a>=E.length){if(F)return-1;a=E.length-1}else if(a<0)if(F)a=0;else return-1;if(typeof o=="string"&&(o=n.from(o,d)),n.isBuffer(o))return o.length===0?-1:G(E,o,a,d,F);if(typeof o=="number")return o=o&255,typeof Uint8Array.prototype.indexOf=="function"?F?Uint8Array.prototype.indexOf.call(E,o,a):Uint8Array.prototype.lastIndexOf.call(E,o,a):G(E,[o],a,d,F);throw new TypeError("val must be string, number or Buffer")}function G(E,o,a,d,F){var $=1,P=E.length,ue=o.length;if(d!==void 0&&(d=String(d).toLowerCase(),d==="ucs2"||d==="ucs-2"||d==="utf16le"||d==="utf-16le")){if(E.length<2||o.length<2)return-1;$=2,P/=2,ue/=2,a/=2}function ve(ot,mt){return $===1?ot[mt]:ot.readUInt16BE(mt*$)}var ae;if(F){var xe=-1;for(ae=a;ae<P;ae++)if(ve(E,ae)===ve(o,xe===-1?0:ae-xe)){if(xe===-1&&(xe=ae),ae-xe+1===ue)return xe*$}else xe!==-1&&(ae-=ae-xe),xe=-1}else for(a+ue>P&&(a=P-ue),ae=a;ae>=0;ae--){for(var ke=!0,Ne=0;Ne<ue;Ne++)if(ve(E,ae+Ne)!==ve(o,Ne)){ke=!1;break}if(ke)return ae}return-1}n.prototype.includes=function(o,a,d){return this.indexOf(o,a,d)!==-1},n.prototype.indexOf=function(o,a,d){return X(this,o,a,d,!0)},n.prototype.lastIndexOf=function(o,a,d){return X(this,o,a,d,!1)};function Z(E,o,a,d){a=Number(a)||0;var F=E.length-a;d?(d=Number(d),d>F&&(d=F)):d=F;var $=o.length;d>$/2&&(d=$/2);for(var P=0;P<d;++P){var ue=parseInt(o.substr(P*2,2),16);if(h(ue))return P;E[a+P]=ue}return P}function C(E,o,a,d){return B(w(o,E.length-a),E,a,d)}function ce(E,o,a,d){return B(U(o),E,a,d)}function ge(E,o,a,d){return B(D(o),E,a,d)}function R(E,o,a,d){return B(L(o,E.length-a),E,a,d)}n.prototype.write=function(o,a,d,F){if(a===void 0)F="utf8",d=this.length,a=0;else if(d===void 0&&typeof a=="string")F=a,d=this.length,a=0;else if(isFinite(a))a=a>>>0,isFinite(d)?(d=d>>>0,F===void 0&&(F="utf8")):(F=d,d=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var $=this.length-a;if((d===void 0||d>$)&&(d=$),o.length>0&&(d<0||a<0)||a>this.length)throw new RangeError("Attempt to write outside buffer bounds");F||(F="utf8");for(var P=!1;;)switch(F){case"hex":return Z(this,o,a,d);case"utf8":case"utf-8":return C(this,o,a,d);case"ascii":case"latin1":case"binary":return ce(this,o,a,d);case"base64":return ge(this,o,a,d);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,o,a,d);default:if(P)throw new TypeError("Unknown encoding: "+F);F=(""+F).toLowerCase(),P=!0}},n.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function H(E,o,a){return o===0&&a===E.length?e.fromByteArray(E):e.fromByteArray(E.slice(o,a))}function A(E,o,a){a=Math.min(E.length,a);for(var d=[],F=o;F<a;){var $=E[F],P=null,ue=$>239?4:$>223?3:$>191?2:1;if(F+ue<=a){var ve,ae,xe,ke;switch(ue){case 1:$<128&&(P=$);break;case 2:ve=E[F+1],(ve&192)===128&&(ke=($&31)<<6|ve&63,ke>127&&(P=ke));break;case 3:ve=E[F+1],ae=E[F+2],(ve&192)===128&&(ae&192)===128&&(ke=($&15)<<12|(ve&63)<<6|ae&63,ke>2047&&(ke<55296||ke>57343)&&(P=ke));break;case 4:ve=E[F+1],ae=E[F+2],xe=E[F+3],(ve&192)===128&&(ae&192)===128&&(xe&192)===128&&(ke=($&15)<<18|(ve&63)<<12|(ae&63)<<6|xe&63,ke>65535&&ke<1114112&&(P=ke))}}P===null?(P=65533,ue=1):P>65535&&(P-=65536,d.push(P>>>10&1023|55296),P=56320|P&1023),d.push(P),F+=ue}return oe(d)}var j=4096;function oe(E){var o=E.length;if(o<=j)return String.fromCharCode.apply(String,E);for(var a="",d=0;d<o;)a+=String.fromCharCode.apply(String,E.slice(d,d+=j));return a}function V(E,o,a){var d="";a=Math.min(E.length,a);for(var F=o;F<a;++F)d+=String.fromCharCode(E[F]&127);return d}function we(E,o,a){var d="";a=Math.min(E.length,a);for(var F=o;F<a;++F)d+=String.fromCharCode(E[F]);return d}function Y(E,o,a){var d=E.length;(!o||o<0)&&(o=0),(!a||a<0||a>d)&&(a=d);for(var F="",$=o;$<a;++$)F+=Q[E[$]];return F}function ee(E,o,a){for(var d=E.slice(o,a),F="",$=0;$<d.length-1;$+=2)F+=String.fromCharCode(d[$]+d[$+1]*256);return F}n.prototype.slice=function(o,a){var d=this.length;o=~~o,a=a===void 0?d:~~a,o<0?(o+=d,o<0&&(o=0)):o>d&&(o=d),a<0?(a+=d,a<0&&(a=0)):a>d&&(a=d),a<o&&(a=o);var F=this.subarray(o,a);return Object.setPrototypeOf(F,n.prototype),F};function M(E,o,a){if(E%1!==0||E<0)throw new RangeError("offset is not uint");if(E+o>a)throw new RangeError("Trying to access beyond buffer length")}n.prototype.readUintLE=n.prototype.readUIntLE=function(o,a,d){o=o>>>0,a=a>>>0,d||M(o,a,this.length);for(var F=this[o],$=1,P=0;++P<a&&($*=256);)F+=this[o+P]*$;return F},n.prototype.readUintBE=n.prototype.readUIntBE=function(o,a,d){o=o>>>0,a=a>>>0,d||M(o,a,this.length);for(var F=this[o+--a],$=1;a>0&&($*=256);)F+=this[o+--a]*$;return F},n.prototype.readUint8=n.prototype.readUInt8=function(o,a){return o=o>>>0,a||M(o,1,this.length),this[o]},n.prototype.readUint16LE=n.prototype.readUInt16LE=function(o,a){return o=o>>>0,a||M(o,2,this.length),this[o]|this[o+1]<<8},n.prototype.readUint16BE=n.prototype.readUInt16BE=function(o,a){return o=o>>>0,a||M(o,2,this.length),this[o]<<8|this[o+1]},n.prototype.readUint32LE=n.prototype.readUInt32LE=function(o,a){return o=o>>>0,a||M(o,4,this.length),(this[o]|this[o+1]<<8|this[o+2]<<16)+this[o+3]*16777216},n.prototype.readUint32BE=n.prototype.readUInt32BE=function(o,a){return o=o>>>0,a||M(o,4,this.length),this[o]*16777216+(this[o+1]<<16|this[o+2]<<8|this[o+3])},n.prototype.readIntLE=function(o,a,d){o=o>>>0,a=a>>>0,d||M(o,a,this.length);for(var F=this[o],$=1,P=0;++P<a&&($*=256);)F+=this[o+P]*$;return $*=128,F>=$&&(F-=Math.pow(2,8*a)),F},n.prototype.readIntBE=function(o,a,d){o=o>>>0,a=a>>>0,d||M(o,a,this.length);for(var F=a,$=1,P=this[o+--F];F>0&&($*=256);)P+=this[o+--F]*$;return $*=128,P>=$&&(P-=Math.pow(2,8*a)),P},n.prototype.readInt8=function(o,a){return o=o>>>0,a||M(o,1,this.length),this[o]&128?(255-this[o]+1)*-1:this[o]},n.prototype.readInt16LE=function(o,a){o=o>>>0,a||M(o,2,this.length);var d=this[o]|this[o+1]<<8;return d&32768?d|4294901760:d},n.prototype.readInt16BE=function(o,a){o=o>>>0,a||M(o,2,this.length);var d=this[o+1]|this[o]<<8;return d&32768?d|4294901760:d},n.prototype.readInt32LE=function(o,a){return o=o>>>0,a||M(o,4,this.length),this[o]|this[o+1]<<8|this[o+2]<<16|this[o+3]<<24},n.prototype.readInt32BE=function(o,a){return o=o>>>0,a||M(o,4,this.length),this[o]<<24|this[o+1]<<16|this[o+2]<<8|this[o+3]},n.prototype.readFloatLE=function(o,a){return o=o>>>0,a||M(o,4,this.length),t.read(this,o,!0,23,4)},n.prototype.readFloatBE=function(o,a){return o=o>>>0,a||M(o,4,this.length),t.read(this,o,!1,23,4)},n.prototype.readDoubleLE=function(o,a){return o=o>>>0,a||M(o,8,this.length),t.read(this,o,!0,52,8)},n.prototype.readDoubleBE=function(o,a){return o=o>>>0,a||M(o,8,this.length),t.read(this,o,!1,52,8)};function O(E,o,a,d,F,$){if(!n.isBuffer(E))throw new TypeError('"buffer" argument must be a Buffer instance');if(o>F||o<$)throw new RangeError('"value" argument is out of bounds');if(a+d>E.length)throw new RangeError("Index out of range")}n.prototype.writeUintLE=n.prototype.writeUIntLE=function(o,a,d,F){if(o=+o,a=a>>>0,d=d>>>0,!F){var $=Math.pow(2,8*d)-1;O(this,o,a,d,$,0)}var P=1,ue=0;for(this[a]=o&255;++ue<d&&(P*=256);)this[a+ue]=o/P&255;return a+d},n.prototype.writeUintBE=n.prototype.writeUIntBE=function(o,a,d,F){if(o=+o,a=a>>>0,d=d>>>0,!F){var $=Math.pow(2,8*d)-1;O(this,o,a,d,$,0)}var P=d-1,ue=1;for(this[a+P]=o&255;--P>=0&&(ue*=256);)this[a+P]=o/ue&255;return a+d},n.prototype.writeUint8=n.prototype.writeUInt8=function(o,a,d){return o=+o,a=a>>>0,d||O(this,o,a,1,255,0),this[a]=o&255,a+1},n.prototype.writeUint16LE=n.prototype.writeUInt16LE=function(o,a,d){return o=+o,a=a>>>0,d||O(this,o,a,2,65535,0),this[a]=o&255,this[a+1]=o>>>8,a+2},n.prototype.writeUint16BE=n.prototype.writeUInt16BE=function(o,a,d){return o=+o,a=a>>>0,d||O(this,o,a,2,65535,0),this[a]=o>>>8,this[a+1]=o&255,a+2},n.prototype.writeUint32LE=n.prototype.writeUInt32LE=function(o,a,d){return o=+o,a=a>>>0,d||O(this,o,a,4,4294967295,0),this[a+3]=o>>>24,this[a+2]=o>>>16,this[a+1]=o>>>8,this[a]=o&255,a+4},n.prototype.writeUint32BE=n.prototype.writeUInt32BE=function(o,a,d){return o=+o,a=a>>>0,d||O(this,o,a,4,4294967295,0),this[a]=o>>>24,this[a+1]=o>>>16,this[a+2]=o>>>8,this[a+3]=o&255,a+4},n.prototype.writeIntLE=function(o,a,d,F){if(o=+o,a=a>>>0,!F){var $=Math.pow(2,8*d-1);O(this,o,a,d,$-1,-$)}var P=0,ue=1,ve=0;for(this[a]=o&255;++P<d&&(ue*=256);)o<0&&ve===0&&this[a+P-1]!==0&&(ve=1),this[a+P]=(o/ue>>0)-ve&255;return a+d},n.prototype.writeIntBE=function(o,a,d,F){if(o=+o,a=a>>>0,!F){var $=Math.pow(2,8*d-1);O(this,o,a,d,$-1,-$)}var P=d-1,ue=1,ve=0;for(this[a+P]=o&255;--P>=0&&(ue*=256);)o<0&&ve===0&&this[a+P+1]!==0&&(ve=1),this[a+P]=(o/ue>>0)-ve&255;return a+d},n.prototype.writeInt8=function(o,a,d){return o=+o,a=a>>>0,d||O(this,o,a,1,127,-128),o<0&&(o=255+o+1),this[a]=o&255,a+1},n.prototype.writeInt16LE=function(o,a,d){return o=+o,a=a>>>0,d||O(this,o,a,2,32767,-32768),this[a]=o&255,this[a+1]=o>>>8,a+2},n.prototype.writeInt16BE=function(o,a,d){return o=+o,a=a>>>0,d||O(this,o,a,2,32767,-32768),this[a]=o>>>8,this[a+1]=o&255,a+2},n.prototype.writeInt32LE=function(o,a,d){return o=+o,a=a>>>0,d||O(this,o,a,4,2147483647,-2147483648),this[a]=o&255,this[a+1]=o>>>8,this[a+2]=o>>>16,this[a+3]=o>>>24,a+4},n.prototype.writeInt32BE=function(o,a,d){return o=+o,a=a>>>0,d||O(this,o,a,4,2147483647,-2147483648),o<0&&(o=4294967295+o+1),this[a]=o>>>24,this[a+1]=o>>>16,this[a+2]=o>>>8,this[a+3]=o&255,a+4};function K(E,o,a,d,F,$){if(a+d>E.length)throw new RangeError("Index out of range");if(a<0)throw new RangeError("Index out of range")}function q(E,o,a,d,F){return o=+o,a=a>>>0,F||K(E,o,a,4),t.write(E,o,a,d,23,4),a+4}n.prototype.writeFloatLE=function(o,a,d){return q(this,o,a,!0,d)},n.prototype.writeFloatBE=function(o,a,d){return q(this,o,a,!1,d)};function ie(E,o,a,d,F){return o=+o,a=a>>>0,F||K(E,o,a,8),t.write(E,o,a,d,52,8),a+8}n.prototype.writeDoubleLE=function(o,a,d){return ie(this,o,a,!0,d)},n.prototype.writeDoubleBE=function(o,a,d){return ie(this,o,a,!1,d)},n.prototype.copy=function(o,a,d,F){if(!n.isBuffer(o))throw new TypeError("argument should be a Buffer");if(d||(d=0),!F&&F!==0&&(F=this.length),a>=o.length&&(a=o.length),a||(a=0),F>0&&F<d&&(F=d),F===d||o.length===0||this.length===0)return 0;if(a<0)throw new RangeError("targetStart out of bounds");if(d<0||d>=this.length)throw new RangeError("Index out of range");if(F<0)throw new RangeError("sourceEnd out of bounds");F>this.length&&(F=this.length),o.length-a<F-d&&(F=o.length-a+d);var $=F-d;return this===o&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(a,d,F):Uint8Array.prototype.set.call(o,this.subarray(d,F),a),$},n.prototype.fill=function(o,a,d,F){if(typeof o=="string"){if(typeof a=="string"?(F=a,a=0,d=this.length):typeof d=="string"&&(F=d,d=this.length),F!==void 0&&typeof F!="string")throw new TypeError("encoding must be a string");if(typeof F=="string"&&!n.isEncoding(F))throw new TypeError("Unknown encoding: "+F);if(o.length===1){var $=o.charCodeAt(0);(F==="utf8"&&$<128||F==="latin1")&&(o=$)}}else typeof o=="number"?o=o&255:typeof o=="boolean"&&(o=Number(o));if(a<0||this.length<a||this.length<d)throw new RangeError("Out of range index");if(d<=a)return this;a=a>>>0,d=d===void 0?this.length:d>>>0,o||(o=0);var P;if(typeof o=="number")for(P=a;P<d;++P)this[P]=o;else{var ue=n.isBuffer(o)?o:n.from(o,F),ve=ue.length;if(ve===0)throw new TypeError('The value "'+o+'" is invalid for argument "value"');for(P=0;P<d-a;++P)this[P+a]=ue[P%ve]}return this};var z=/[^+/0-9A-Za-z-_]/g;function v(E){if(E=E.split("=")[0],E=E.trim().replace(z,""),E.length<2)return"";for(;E.length%4!==0;)E=E+"=";return E}function w(E,o){o=o||1/0;for(var a,d=E.length,F=null,$=[],P=0;P<d;++P){if(a=E.charCodeAt(P),a>55295&&a<57344){if(!F){if(a>56319){(o-=3)>-1&&$.push(239,191,189);continue}else if(P+1===d){(o-=3)>-1&&$.push(239,191,189);continue}F=a;continue}if(a<56320){(o-=3)>-1&&$.push(239,191,189),F=a;continue}a=(F-55296<<10|a-56320)+65536}else F&&(o-=3)>-1&&$.push(239,191,189);if(F=null,a<128){if((o-=1)<0)break;$.push(a)}else if(a<2048){if((o-=2)<0)break;$.push(a>>6|192,a&63|128)}else if(a<65536){if((o-=3)<0)break;$.push(a>>12|224,a>>6&63|128,a&63|128)}else if(a<1114112){if((o-=4)<0)break;$.push(a>>18|240,a>>12&63|128,a>>6&63|128,a&63|128)}else throw new Error("Invalid code point")}return $}function U(E){for(var o=[],a=0;a<E.length;++a)o.push(E.charCodeAt(a)&255);return o}function L(E,o){for(var a,d,F,$=[],P=0;P<E.length&&!((o-=2)<0);++P)a=E.charCodeAt(P),d=a>>8,F=a%256,$.push(F),$.push(d);return $}function D(E){return e.toByteArray(v(E))}function B(E,o,a,d){for(var F=0;F<d&&!(F+a>=o.length||F>=E.length);++F)o[F+a]=E[F];return F}function se(E,o){return E instanceof o||E!=null&&E.constructor!=null&&E.constructor.name!=null&&E.constructor.name===o.name}function h(E){return E!==E}var Q=function(){for(var E="0123456789abcdef",o=new Array(256),a=0;a<16;++a)for(var d=a*16,F=0;F<16;++F)o[d+F]=E[a]+E[F];return o}()}(ln)),ln}var cn={},un={},fn,ji;function Es(){return ji||(ji=1,fn=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},t=Symbol("test"),s=Object(t);if(typeof t=="string"||Object.prototype.toString.call(t)!=="[object Symbol]"||Object.prototype.toString.call(s)!=="[object Symbol]")return!1;var l=42;e[t]=l;for(t in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var i=Object.getOwnPropertySymbols(e);if(i.length!==1||i[0]!==t||!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var c=Object.getOwnPropertyDescriptor(e,t);if(c.value!==l||c.enumerable!==!0)return!1}return!0}),fn}var hn,zi;function pi(){if(zi)return hn;zi=1;var r=Es();return hn=function(){return r()&&!!Symbol.toStringTag},hn}var dn,Hi;function Ga(){if(Hi)return dn;Hi=1;var r=typeof Symbol<"u"&&Symbol,e=Es();return dn=function(){return typeof r!="function"||typeof Symbol!="function"||typeof r("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:e()},dn}var pn,Wi;function $a(){if(Wi)return pn;Wi=1;var r={foo:{}},e=Object;return pn=function(){return{__proto__:r}.foo===r.foo&&!({__proto__:null}instanceof e)},pn}var mn,Gi;function Va(){if(Gi)return mn;Gi=1;var r="Function.prototype.bind called on incompatible ",e=Object.prototype.toString,t=Math.max,s="[object Function]",l=function(u,m){for(var y=[],b=0;b<u.length;b+=1)y[b]=u[b];for(var T=0;T<m.length;T+=1)y[T+u.length]=m[T];return y},i=function(u,m){for(var y=[],b=m,T=0;b<u.length;b+=1,T+=1)y[T]=u[b];return y},c=function(n,u){for(var m="",y=0;y<n.length;y+=1)m+=n[y],y+1<n.length&&(m+=u);return m};return mn=function(u){var m=this;if(typeof m!="function"||e.apply(m)!==s)throw new TypeError(r+m);for(var y=i(arguments,1),b,T=function(){if(this instanceof b){var f=m.apply(this,l(y,arguments));return Object(f)===f?f:this}return m.apply(u,l(y,arguments))},p=t(0,m.length-y.length),S=[],g=0;g<p;g++)S[g]="$"+g;if(b=Function("binder","return function ("+c(S,",")+"){ return binder.apply(this,arguments); }")(T),m.prototype){var x=function(){};x.prototype=m.prototype,b.prototype=new x,x.prototype=null}return b},mn}var gn,$i;function mi(){if($i)return gn;$i=1;var r=Va();return gn=Function.prototype.bind||r,gn}var wn,Vi;function Ka(){if(Vi)return wn;Vi=1;var r=Function.prototype.call,e=Object.prototype.hasOwnProperty,t=mi();return wn=t.call(r,e),wn}var yn,Ki;function pr(){if(Ki)return yn;Ki=1;var r,e=SyntaxError,t=Function,s=TypeError,l=function(R){try{return t('"use strict"; return ('+R+").constructor;")()}catch{}},i=Object.getOwnPropertyDescriptor;if(i)try{i({},"")}catch{i=null}var c=function(){throw new s},n=i?function(){try{return arguments.callee,c}catch{try{return i(arguments,"callee").get}catch{return c}}}():c,u=Ga()(),m=$a()(),y=Object.getPrototypeOf||(m?function(R){return R.__proto__}:null),b={},T=typeof Uint8Array>"u"||!y?r:y(Uint8Array),p={"%AggregateError%":typeof AggregateError>"u"?r:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?r:ArrayBuffer,"%ArrayIteratorPrototype%":u&&y?y([][Symbol.iterator]()):r,"%AsyncFromSyncIteratorPrototype%":r,"%AsyncFunction%":b,"%AsyncGenerator%":b,"%AsyncGeneratorFunction%":b,"%AsyncIteratorPrototype%":b,"%Atomics%":typeof Atomics>"u"?r:Atomics,"%BigInt%":typeof BigInt>"u"?r:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?r:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?r:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?r:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?r:Float32Array,"%Float64Array%":typeof Float64Array>"u"?r:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?r:FinalizationRegistry,"%Function%":t,"%GeneratorFunction%":b,"%Int8Array%":typeof Int8Array>"u"?r:Int8Array,"%Int16Array%":typeof Int16Array>"u"?r:Int16Array,"%Int32Array%":typeof Int32Array>"u"?r:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":u&&y?y(y([][Symbol.iterator]())):r,"%JSON%":typeof JSON=="object"?JSON:r,"%Map%":typeof Map>"u"?r:Map,"%MapIteratorPrototype%":typeof Map>"u"||!u||!y?r:y(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?r:Promise,"%Proxy%":typeof Proxy>"u"?r:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?r:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?r:Set,"%SetIteratorPrototype%":typeof Set>"u"||!u||!y?r:y(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?r:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":u&&y?y(""[Symbol.iterator]()):r,"%Symbol%":u?Symbol:r,"%SyntaxError%":e,"%ThrowTypeError%":n,"%TypedArray%":T,"%TypeError%":s,"%Uint8Array%":typeof Uint8Array>"u"?r:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?r:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?r:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?r:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?r:WeakMap,"%WeakRef%":typeof WeakRef>"u"?r:WeakRef,"%WeakSet%":typeof WeakSet>"u"?r:WeakSet};if(y)try{null.error}catch(R){var S=y(y(R));p["%Error.prototype%"]=S}var g=function R(H){var A;if(H==="%AsyncFunction%")A=l("async function () {}");else if(H==="%GeneratorFunction%")A=l("function* () {}");else if(H==="%AsyncGeneratorFunction%")A=l("async function* () {}");else if(H==="%AsyncGenerator%"){var j=R("%AsyncGeneratorFunction%");j&&(A=j.prototype)}else if(H==="%AsyncIteratorPrototype%"){var oe=R("%AsyncGenerator%");oe&&y&&(A=y(oe.prototype))}return p[H]=A,A},x={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},f=mi(),_=Ka(),k=f.call(Function.call,Array.prototype.concat),N=f.call(Function.apply,Array.prototype.splice),I=f.call(Function.call,String.prototype.replace),X=f.call(Function.call,String.prototype.slice),G=f.call(Function.call,RegExp.prototype.exec),Z=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,C=/\\(\\)?/g,ce=function(H){var A=X(H,0,1),j=X(H,-1);if(A==="%"&&j!=="%")throw new e("invalid intrinsic syntax, expected closing `%`");if(j==="%"&&A!=="%")throw new e("invalid intrinsic syntax, expected opening `%`");var oe=[];return I(H,Z,function(V,we,Y,ee){oe[oe.length]=Y?I(ee,C,"$1"):we||V}),oe},ge=function(H,A){var j=H,oe;if(_(x,j)&&(oe=x[j],j="%"+oe[0]+"%"),_(p,j)){var V=p[j];if(V===b&&(V=g(j)),typeof V>"u"&&!A)throw new s("intrinsic "+H+" exists, but is not available. Please file an issue!");return{alias:oe,name:j,value:V}}throw new e("intrinsic "+H+" does not exist!")};return yn=function(H,A){if(typeof H!="string"||H.length===0)throw new s("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof A!="boolean")throw new s('"allowMissing" argument must be a boolean');if(G(/^%?[^%]*%?$/,H)===null)throw new e("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var j=ce(H),oe=j.length>0?j[0]:"",V=ge("%"+oe+"%",A),we=V.name,Y=V.value,ee=!1,M=V.alias;M&&(oe=M[0],N(j,k([0,1],M)));for(var O=1,K=!0;O<j.length;O+=1){var q=j[O],ie=X(q,0,1),z=X(q,-1);if((ie==='"'||ie==="'"||ie==="`"||z==='"'||z==="'"||z==="`")&&ie!==z)throw new e("property names with quotes must have matching quotes");if((q==="constructor"||!K)&&(ee=!0),oe+="."+q,we="%"+oe+"%",_(p,we))Y=p[we];else if(Y!=null){if(!(q in Y)){if(!A)throw new s("base intrinsic for "+H+" exists, but the property is not available.");return}if(i&&O+1>=j.length){var v=i(Y,q);K=!!v,K&&"get"in v&&!("originalValue"in v.get)?Y=v.get:Y=Y[q]}else K=_(Y,q),Y=Y[q];K&&!ee&&(p[we]=Y)}}return Y},yn}var vn={exports:{}},bn,qi;function xs(){if(qi)return bn;qi=1;var r=pr(),e=r("%Object.defineProperty%",!0),t=function(){if(e)try{return e({},"a",{value:1}),!0}catch{return!1}return!1};return t.hasArrayLengthDefineBug=function(){if(!t())return null;try{return e([],"length",{value:1}).length!==1}catch{return!0}},bn=t,bn}var _n,Xi;function gi(){if(Xi)return _n;Xi=1;var r=pr(),e=r("%Object.getOwnPropertyDescriptor%",!0);if(e)try{e([],"length")}catch{e=null}return _n=e,_n}var En,Zi;function qa(){if(Zi)return En;Zi=1;var r=xs()(),e=pr(),t=r&&e("%Object.defineProperty%",!0);if(t)try{t({},"a",{value:1})}catch{t=!1}var s=e("%SyntaxError%"),l=e("%TypeError%"),i=gi();return En=function(n,u,m){if(!n||typeof n!="object"&&typeof n!="function")throw new l("`obj` must be an object or a function`");if(typeof u!="string"&&typeof u!="symbol")throw new l("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new l("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new l("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new l("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new l("`loose`, if provided, must be a boolean");var y=arguments.length>3?arguments[3]:null,b=arguments.length>4?arguments[4]:null,T=arguments.length>5?arguments[5]:null,p=arguments.length>6?arguments[6]:!1,S=!!i&&i(n,u);if(t)t(n,u,{configurable:T===null&&S?S.configurable:!T,enumerable:y===null&&S?S.enumerable:!y,value:m,writable:b===null&&S?S.writable:!b});else if(p||!y&&!b&&!T)n[u]=m;else throw new s("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},En}var xn,Yi;function Xa(){if(Yi)return xn;Yi=1;var r=pr(),e=qa(),t=xs()(),s=gi(),l=r("%TypeError%"),i=r("%Math.floor%");return xn=function(n,u){if(typeof n!="function")throw new l("`fn` is not a function");if(typeof u!="number"||u<0||u>4294967295||i(u)!==u)throw new l("`length` must be a positive 32-bit integer");var m=arguments.length>2&&!!arguments[2],y=!0,b=!0;if("length"in n&&s){var T=s(n,"length");T&&!T.configurable&&(y=!1),T&&!T.writable&&(b=!1)}return(y||b||!m)&&(t?e(n,"length",u,!0,!0):e(n,"length",u)),n},xn}var Ji;function Ts(){return Ji||(Ji=1,function(r){var e=mi(),t=pr(),s=Xa(),l=t("%TypeError%"),i=t("%Function.prototype.apply%"),c=t("%Function.prototype.call%"),n=t("%Reflect.apply%",!0)||e.call(c,i),u=t("%Object.defineProperty%",!0),m=t("%Math.max%");if(u)try{u({},"a",{value:1})}catch{u=null}r.exports=function(T){if(typeof T!="function")throw new l("a function is required");var p=n(e,c,arguments);return s(p,1+m(0,T.length-(arguments.length-1)),!0)};var y=function(){return n(e,i,arguments)};u?u(r.exports,"apply",{value:y}):r.exports.apply=y}(vn)),vn.exports}var Tn,Qi;function As(){if(Qi)return Tn;Qi=1;var r=pr(),e=Ts(),t=e(r("String.prototype.indexOf"));return Tn=function(l,i){var c=r(l,!!i);return typeof c=="function"&&t(l,".prototype.")>-1?e(c):c},Tn}var An,eo;function Za(){if(eo)return An;eo=1;var r=pi()(),e=As(),t=e("Object.prototype.toString"),s=function(n){return r&&n&&typeof n=="object"&&Symbol.toStringTag in n?!1:t(n)==="[object Arguments]"},l=function(n){return s(n)?!0:n!==null&&typeof n=="object"&&typeof n.length=="number"&&n.length>=0&&t(n)!=="[object Array]"&&t(n.callee)==="[object Function]"},i=function(){return s(arguments)}();return s.isLegacyArguments=l,An=i?s:l,An}var Sn,to;function Ya(){if(to)return Sn;to=1;var r=Object.prototype.toString,e=Function.prototype.toString,t=/^\s*(?:function)?\*/,s=pi()(),l=Object.getPrototypeOf,i=function(){if(!s)return!1;try{return Function("return function*() {}")()}catch{}},c;return Sn=function(u){if(typeof u!="function")return!1;if(t.test(e.call(u)))return!0;if(!s){var m=r.call(u);return m==="[object GeneratorFunction]"}if(!l)return!1;if(typeof c>"u"){var y=i();c=y?l(y):!1}return l(u)===c},Sn}var kn,ro;function Ja(){if(ro)return kn;ro=1;var r=Function.prototype.toString,e=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,t,s;if(typeof e=="function"&&typeof Object.defineProperty=="function")try{t=Object.defineProperty({},"length",{get:function(){throw s}}),s={},e(function(){throw 42},null,t)}catch(_){_!==s&&(e=null)}else e=null;var l=/^\s*class\b/,i=function(k){try{var N=r.call(k);return l.test(N)}catch{return!1}},c=function(k){try{return i(k)?!1:(r.call(k),!0)}catch{return!1}},n=Object.prototype.toString,u="[object Object]",m="[object Function]",y="[object GeneratorFunction]",b="[object HTMLAllCollection]",T="[object HTML document.all class]",p="[object HTMLCollection]",S=typeof Symbol=="function"&&!!Symbol.toStringTag,g=!(0 in[,]),x=function(){return!1};if(typeof document=="object"){var f=document.all;n.call(f)===n.call(document.all)&&(x=function(k){if((g||!k)&&(typeof k>"u"||typeof k=="object"))try{var N=n.call(k);return(N===b||N===T||N===p||N===u)&&k("")==null}catch{}return!1})}return kn=e?function(k){if(x(k))return!0;if(!k||typeof k!="function"&&typeof k!="object")return!1;try{e(k,null,t)}catch(N){if(N!==s)return!1}return!i(k)&&c(k)}:function(k){if(x(k))return!0;if(!k||typeof k!="function"&&typeof k!="object")return!1;if(S)return c(k);if(i(k))return!1;var N=n.call(k);return N!==m&&N!==y&&!/^\[object HTML/.test(N)?!1:c(k)},kn}var Cn,no;function Qa(){if(no)return Cn;no=1;var r=Ja(),e=Object.prototype.toString,t=Object.prototype.hasOwnProperty,s=function(u,m,y){for(var b=0,T=u.length;b<T;b++)t.call(u,b)&&(y==null?m(u[b],b,u):m.call(y,u[b],b,u))},l=function(u,m,y){for(var b=0,T=u.length;b<T;b++)y==null?m(u.charAt(b),b,u):m.call(y,u.charAt(b),b,u)},i=function(u,m,y){for(var b in u)t.call(u,b)&&(y==null?m(u[b],b,u):m.call(y,u[b],b,u))},c=function(u,m,y){if(!r(m))throw new TypeError("iterator must be a function");var b;arguments.length>=3&&(b=y),e.call(u)==="[object Array]"?s(u,m,b):typeof u=="string"?l(u,m,b):i(u,m,b)};return Cn=c,Cn}var In,io;function el(){if(io)return In;io=1;var r=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"],e=typeof globalThis>"u"?Rt:globalThis;return In=function(){for(var s=[],l=0;l<r.length;l++)typeof e[r[l]]=="function"&&(s[s.length]=r[l]);return s},In}var Rn,oo;function Ss(){if(oo)return Rn;oo=1;var r=Qa(),e=el(),t=Ts(),s=As(),l=gi(),i=s("Object.prototype.toString"),c=pi()(),n=typeof globalThis>"u"?Rt:globalThis,u=e(),m=s("String.prototype.slice"),y=Object.getPrototypeOf,b=s("Array.prototype.indexOf",!0)||function(x,f){for(var _=0;_<x.length;_+=1)if(x[_]===f)return _;return-1},T={__proto__:null};c&&l&&y?r(u,function(g){var x=new n[g];if(Symbol.toStringTag in x){var f=y(x),_=l(f,Symbol.toStringTag);if(!_){var k=y(f);_=l(k,Symbol.toStringTag)}T["$"+g]=t(_.get)}}):r(u,function(g){var x=new n[g],f=x.slice||x.set;f&&(T["$"+g]=t(f))});var p=function(x){var f=!1;return r(T,function(_,k){if(!f)try{"$"+_(x)===k&&(f=m(k,1))}catch{}}),f},S=function(x){var f=!1;return r(T,function(_,k){if(!f)try{_(x),f=m(k,1)}catch{}}),f};return Rn=function(x){if(!x||typeof x!="object")return!1;if(!c){var f=m(i(x),8,-1);return b(u,f)>-1?f:f!=="Object"?!1:S(x)}return l?p(x):null},Rn}var Nn,so;function tl(){if(so)return Nn;so=1;var r=Ss();return Nn=function(t){return!!r(t)},Nn}var ao;function rl(){return ao||(ao=1,function(r){var e=Za(),t=Ya(),s=Ss(),l=tl();function i(d){return d.call.bind(d)}var c=typeof BigInt<"u",n=typeof Symbol<"u",u=i(Object.prototype.toString),m=i(Number.prototype.valueOf),y=i(String.prototype.valueOf),b=i(Boolean.prototype.valueOf);if(c)var T=i(BigInt.prototype.valueOf);if(n)var p=i(Symbol.prototype.valueOf);function S(d,F){if(typeof d!="object")return!1;try{return F(d),!0}catch{return!1}}r.isArgumentsObject=e,r.isGeneratorFunction=t,r.isTypedArray=l;function g(d){return typeof Promise<"u"&&d instanceof Promise||d!==null&&typeof d=="object"&&typeof d.then=="function"&&typeof d.catch=="function"}r.isPromise=g;function x(d){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(d):l(d)||K(d)}r.isArrayBufferView=x;function f(d){return s(d)==="Uint8Array"}r.isUint8Array=f;function _(d){return s(d)==="Uint8ClampedArray"}r.isUint8ClampedArray=_;function k(d){return s(d)==="Uint16Array"}r.isUint16Array=k;function N(d){return s(d)==="Uint32Array"}r.isUint32Array=N;function I(d){return s(d)==="Int8Array"}r.isInt8Array=I;function X(d){return s(d)==="Int16Array"}r.isInt16Array=X;function G(d){return s(d)==="Int32Array"}r.isInt32Array=G;function Z(d){return s(d)==="Float32Array"}r.isFloat32Array=Z;function C(d){return s(d)==="Float64Array"}r.isFloat64Array=C;function ce(d){return s(d)==="BigInt64Array"}r.isBigInt64Array=ce;function ge(d){return s(d)==="BigUint64Array"}r.isBigUint64Array=ge;function R(d){return u(d)==="[object Map]"}R.working=typeof Map<"u"&&R(new Map);function H(d){return typeof Map>"u"?!1:R.working?R(d):d instanceof Map}r.isMap=H;function A(d){return u(d)==="[object Set]"}A.working=typeof Set<"u"&&A(new Set);function j(d){return typeof Set>"u"?!1:A.working?A(d):d instanceof Set}r.isSet=j;function oe(d){return u(d)==="[object WeakMap]"}oe.working=typeof WeakMap<"u"&&oe(new WeakMap);function V(d){return typeof WeakMap>"u"?!1:oe.working?oe(d):d instanceof WeakMap}r.isWeakMap=V;function we(d){return u(d)==="[object WeakSet]"}we.working=typeof WeakSet<"u"&&we(new WeakSet);function Y(d){return we(d)}r.isWeakSet=Y;function ee(d){return u(d)==="[object ArrayBuffer]"}ee.working=typeof ArrayBuffer<"u"&&ee(new ArrayBuffer);function M(d){return typeof ArrayBuffer>"u"?!1:ee.working?ee(d):d instanceof ArrayBuffer}r.isArrayBuffer=M;function O(d){return u(d)==="[object DataView]"}O.working=typeof ArrayBuffer<"u"&&typeof DataView<"u"&&O(new DataView(new ArrayBuffer(1),0,1));function K(d){return typeof DataView>"u"?!1:O.working?O(d):d instanceof DataView}r.isDataView=K;var q=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:void 0;function ie(d){return u(d)==="[object SharedArrayBuffer]"}function z(d){return typeof q>"u"?!1:(typeof ie.working>"u"&&(ie.working=ie(new q)),ie.working?ie(d):d instanceof q)}r.isSharedArrayBuffer=z;function v(d){return u(d)==="[object AsyncFunction]"}r.isAsyncFunction=v;function w(d){return u(d)==="[object Map Iterator]"}r.isMapIterator=w;function U(d){return u(d)==="[object Set Iterator]"}r.isSetIterator=U;function L(d){return u(d)==="[object Generator]"}r.isGeneratorObject=L;function D(d){return u(d)==="[object WebAssembly.Module]"}r.isWebAssemblyCompiledModule=D;function B(d){return S(d,m)}r.isNumberObject=B;function se(d){return S(d,y)}r.isStringObject=se;function h(d){return S(d,b)}r.isBooleanObject=h;function Q(d){return c&&S(d,T)}r.isBigIntObject=Q;function E(d){return n&&S(d,p)}r.isSymbolObject=E;function o(d){return B(d)||se(d)||h(d)||Q(d)||E(d)}r.isBoxedPrimitive=o;function a(d){return typeof Uint8Array<"u"&&(M(d)||z(d))}r.isAnyArrayBuffer=a,["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(d){Object.defineProperty(r,d,{enumerable:!1,value:function(){throw new Error(d+" is not supported in userland")}})})}(un)),un}var Dn,lo;function nl(){return lo||(lo=1,Dn=function(e){return e&&typeof e=="object"&&typeof e.copy=="function"&&typeof e.fill=="function"&&typeof e.readUInt8=="function"}),Dn}var co;function ks(){return co||(co=1,function(r){var e=Object.getOwnPropertyDescriptors||function(K){for(var q=Object.keys(K),ie={},z=0;z<q.length;z++)ie[q[z]]=Object.getOwnPropertyDescriptor(K,q[z]);return ie},t=/%[sdj%]/g;r.format=function(O){if(!I(O)){for(var K=[],q=0;q<arguments.length;q++)K.push(c(arguments[q]));return K.join(" ")}for(var q=1,ie=arguments,z=ie.length,v=String(O).replace(t,function(U){if(U==="%%")return"%";if(q>=z)return U;switch(U){case"%s":return String(ie[q++]);case"%d":return Number(ie[q++]);case"%j":try{return JSON.stringify(ie[q++])}catch{return"[Circular]"}default:return U}}),w=ie[q];q<z;w=ie[++q])_(w)||!C(w)?v+=" "+w:v+=" "+c(w);return v},r.deprecate=function(O,K){if(typeof Me<"u"&&Me.noDeprecation===!0)return O;if(typeof Me>"u")return function(){return r.deprecate(O,K).apply(this,arguments)};var q=!1;function ie(){if(!q){if(Me.throwDeprecation)throw new Error(K);Me.traceDeprecation?console.trace(K):console.error(K),q=!0}return O.apply(this,arguments)}return ie};var s={},l=/^$/;if(Me.env.NODE_DEBUG){var i=Me.env.NODE_DEBUG;i=i.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),l=new RegExp("^"+i+"$","i")}r.debuglog=function(O){if(O=O.toUpperCase(),!s[O])if(l.test(O)){var K=Me.pid;s[O]=function(){var q=r.format.apply(r,arguments);console.error("%s %d: %s",O,K,q)}}else s[O]=function(){};return s[O]};function c(O,K){var q={seen:[],stylize:u};return arguments.length>=3&&(q.depth=arguments[2]),arguments.length>=4&&(q.colors=arguments[3]),f(K)?q.showHidden=K:K&&r._extend(q,K),G(q.showHidden)&&(q.showHidden=!1),G(q.depth)&&(q.depth=2),G(q.colors)&&(q.colors=!1),G(q.customInspect)&&(q.customInspect=!0),q.colors&&(q.stylize=n),y(q,O,q.depth)}r.inspect=c,c.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},c.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function n(O,K){var q=c.styles[K];return q?"\x1B["+c.colors[q][0]+"m"+O+"\x1B["+c.colors[q][1]+"m":O}function u(O,K){return O}function m(O){var K={};return O.forEach(function(q,ie){K[q]=!0}),K}function y(O,K,q){if(O.customInspect&&K&&R(K.inspect)&&K.inspect!==r.inspect&&!(K.constructor&&K.constructor.prototype===K)){var ie=K.inspect(q,O);return I(ie)||(ie=y(O,ie,q)),ie}var z=b(O,K);if(z)return z;var v=Object.keys(K),w=m(v);if(O.showHidden&&(v=Object.getOwnPropertyNames(K)),ge(K)&&(v.indexOf("message")>=0||v.indexOf("description")>=0))return T(K);if(v.length===0){if(R(K)){var U=K.name?": "+K.name:"";return O.stylize("[Function"+U+"]","special")}if(Z(K))return O.stylize(RegExp.prototype.toString.call(K),"regexp");if(ce(K))return O.stylize(Date.prototype.toString.call(K),"date");if(ge(K))return T(K)}var L="",D=!1,B=["{","}"];if(x(K)&&(D=!0,B=["[","]"]),R(K)){var se=K.name?": "+K.name:"";L=" [Function"+se+"]"}if(Z(K)&&(L=" "+RegExp.prototype.toString.call(K)),ce(K)&&(L=" "+Date.prototype.toUTCString.call(K)),ge(K)&&(L=" "+T(K)),v.length===0&&(!D||K.length==0))return B[0]+L+B[1];if(q<0)return Z(K)?O.stylize(RegExp.prototype.toString.call(K),"regexp"):O.stylize("[Object]","special");O.seen.push(K);var h;return D?h=p(O,K,q,w,v):h=v.map(function(Q){return S(O,K,q,w,Q,D)}),O.seen.pop(),g(h,L,B)}function b(O,K){if(G(K))return O.stylize("undefined","undefined");if(I(K)){var q="'"+JSON.stringify(K).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return O.stylize(q,"string")}if(N(K))return O.stylize(""+K,"number");if(f(K))return O.stylize(""+K,"boolean");if(_(K))return O.stylize("null","null")}function T(O){return"["+Error.prototype.toString.call(O)+"]"}function p(O,K,q,ie,z){for(var v=[],w=0,U=K.length;w<U;++w)we(K,String(w))?v.push(S(O,K,q,ie,String(w),!0)):v.push("");return z.forEach(function(L){L.match(/^\d+$/)||v.push(S(O,K,q,ie,L,!0))}),v}function S(O,K,q,ie,z,v){var w,U,L;if(L=Object.getOwnPropertyDescriptor(K,z)||{value:K[z]},L.get?L.set?U=O.stylize("[Getter/Setter]","special"):U=O.stylize("[Getter]","special"):L.set&&(U=O.stylize("[Setter]","special")),we(ie,z)||(w="["+z+"]"),U||(O.seen.indexOf(L.value)<0?(_(q)?U=y(O,L.value,null):U=y(O,L.value,q-1),U.indexOf(`
`)>-1&&(v?U=U.split(`
`).map(function(D){return"  "+D}).join(`
`).slice(2):U=`
`+U.split(`
`).map(function(D){return"   "+D}).join(`
`))):U=O.stylize("[Circular]","special")),G(w)){if(v&&z.match(/^\d+$/))return U;w=JSON.stringify(""+z),w.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(w=w.slice(1,-1),w=O.stylize(w,"name")):(w=w.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),w=O.stylize(w,"string"))}return w+": "+U}function g(O,K,q){var ie=O.reduce(function(z,v){return v.indexOf(`
`)>=0,z+v.replace(/\u001b\[\d\d?m/g,"").length+1},0);return ie>60?q[0]+(K===""?"":K+`
 `)+" "+O.join(`,
  `)+" "+q[1]:q[0]+K+" "+O.join(", ")+" "+q[1]}r.types=rl();function x(O){return Array.isArray(O)}r.isArray=x;function f(O){return typeof O=="boolean"}r.isBoolean=f;function _(O){return O===null}r.isNull=_;function k(O){return O==null}r.isNullOrUndefined=k;function N(O){return typeof O=="number"}r.isNumber=N;function I(O){return typeof O=="string"}r.isString=I;function X(O){return typeof O=="symbol"}r.isSymbol=X;function G(O){return O===void 0}r.isUndefined=G;function Z(O){return C(O)&&A(O)==="[object RegExp]"}r.isRegExp=Z,r.types.isRegExp=Z;function C(O){return typeof O=="object"&&O!==null}r.isObject=C;function ce(O){return C(O)&&A(O)==="[object Date]"}r.isDate=ce,r.types.isDate=ce;function ge(O){return C(O)&&(A(O)==="[object Error]"||O instanceof Error)}r.isError=ge,r.types.isNativeError=ge;function R(O){return typeof O=="function"}r.isFunction=R;function H(O){return O===null||typeof O=="boolean"||typeof O=="number"||typeof O=="string"||typeof O=="symbol"||typeof O>"u"}r.isPrimitive=H,r.isBuffer=nl();function A(O){return Object.prototype.toString.call(O)}function j(O){return O<10?"0"+O.toString(10):O.toString(10)}var oe=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function V(){var O=new Date,K=[j(O.getHours()),j(O.getMinutes()),j(O.getSeconds())].join(":");return[O.getDate(),oe[O.getMonth()],K].join(" ")}r.log=function(){console.log("%s - %s",V(),r.format.apply(r,arguments))},r.inherits=Kt,r._extend=function(O,K){if(!K||!C(K))return O;for(var q=Object.keys(K),ie=q.length;ie--;)O[q[ie]]=K[q[ie]];return O};function we(O,K){return Object.prototype.hasOwnProperty.call(O,K)}var Y=typeof Symbol<"u"?Symbol("util.promisify.custom"):void 0;r.promisify=function(K){if(typeof K!="function")throw new TypeError('The "original" argument must be of type Function');if(Y&&K[Y]){var q=K[Y];if(typeof q!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(q,Y,{value:q,enumerable:!1,writable:!1,configurable:!0}),q}function q(){for(var ie,z,v=new Promise(function(L,D){ie=L,z=D}),w=[],U=0;U<arguments.length;U++)w.push(arguments[U]);w.push(function(L,D){L?z(L):ie(D)});try{K.apply(this,w)}catch(L){z(L)}return v}return Object.setPrototypeOf(q,Object.getPrototypeOf(K)),Y&&Object.defineProperty(q,Y,{value:q,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(q,e(K))},r.promisify.custom=Y;function ee(O,K){if(!O){var q=new Error("Promise was rejected with a falsy value");q.reason=O,O=q}return K(O)}function M(O){if(typeof O!="function")throw new TypeError('The "original" argument must be of type Function');function K(){for(var q=[],ie=0;ie<arguments.length;ie++)q.push(arguments[ie]);var z=q.pop();if(typeof z!="function")throw new TypeError("The last argument must be of type Function");var v=this,w=function(){return z.apply(v,arguments)};O.apply(this,q).then(function(U){Me.nextTick(w.bind(null,null,U))},function(U){Me.nextTick(ee.bind(null,U,w))})}return Object.setPrototypeOf(K,Object.getPrototypeOf(O)),Object.defineProperties(K,e(O)),K}r.callbackify=M}(cn)),cn}var On,uo;function il(){if(uo)return On;uo=1;function r(T,p){var S=Object.keys(T);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(T);p&&(g=g.filter(function(x){return Object.getOwnPropertyDescriptor(T,x).enumerable})),S.push.apply(S,g)}return S}function e(T){for(var p=1;p<arguments.length;p++){var S=arguments[p]!=null?arguments[p]:{};p%2?r(Object(S),!0).forEach(function(g){t(T,g,S[g])}):Object.getOwnPropertyDescriptors?Object.defineProperties(T,Object.getOwnPropertyDescriptors(S)):r(Object(S)).forEach(function(g){Object.defineProperty(T,g,Object.getOwnPropertyDescriptor(S,g))})}return T}function t(T,p,S){return p in T?Object.defineProperty(T,p,{value:S,enumerable:!0,configurable:!0,writable:!0}):T[p]=S,T}function s(T,p){if(!(T instanceof p))throw new TypeError("Cannot call a class as a function")}function l(T,p){for(var S=0;S<p.length;S++){var g=p[S];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(T,g.key,g)}}function i(T,p,S){return p&&l(T.prototype,p),T}var c=Jr(),n=c.Buffer,u=ks(),m=u.inspect,y=m&&m.custom||"inspect";function b(T,p,S){n.prototype.copy.call(T,p,S)}return On=function(){function T(){s(this,T),this.head=null,this.tail=null,this.length=0}return i(T,[{key:"push",value:function(S){var g={data:S,next:null};this.length>0?this.tail.next=g:this.head=g,this.tail=g,++this.length}},{key:"unshift",value:function(S){var g={data:S,next:this.head};this.length===0&&(this.tail=g),this.head=g,++this.length}},{key:"shift",value:function(){if(this.length!==0){var S=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,S}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(S){if(this.length===0)return"";for(var g=this.head,x=""+g.data;g=g.next;)x+=S+g.data;return x}},{key:"concat",value:function(S){if(this.length===0)return n.alloc(0);for(var g=n.allocUnsafe(S>>>0),x=this.head,f=0;x;)b(x.data,g,f),f+=x.data.length,x=x.next;return g}},{key:"consume",value:function(S,g){var x;return S<this.head.data.length?(x=this.head.data.slice(0,S),this.head.data=this.head.data.slice(S)):S===this.head.data.length?x=this.shift():x=g?this._getString(S):this._getBuffer(S),x}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(S){var g=this.head,x=1,f=g.data;for(S-=f.length;g=g.next;){var _=g.data,k=S>_.length?_.length:S;if(k===_.length?f+=_:f+=_.slice(0,S),S-=k,S===0){k===_.length?(++x,g.next?this.head=g.next:this.head=this.tail=null):(this.head=g,g.data=_.slice(k));break}++x}return this.length-=x,f}},{key:"_getBuffer",value:function(S){var g=n.allocUnsafe(S),x=this.head,f=1;for(x.data.copy(g),S-=x.data.length;x=x.next;){var _=x.data,k=S>_.length?_.length:S;if(_.copy(g,g.length-S,0,k),S-=k,S===0){k===_.length?(++f,x.next?this.head=x.next:this.head=this.tail=null):(this.head=x,x.data=_.slice(k));break}++f}return this.length-=f,g}},{key:y,value:function(S,g){return m(this,e({},g,{depth:0,customInspect:!1}))}}]),T}(),On}var Bn,fo;function Cs(){if(fo)return Bn;fo=1;function r(c,n){var u=this,m=this._readableState&&this._readableState.destroyed,y=this._writableState&&this._writableState.destroyed;return m||y?(n?n(c):c&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,Me.nextTick(l,this,c)):Me.nextTick(l,this,c)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(c||null,function(b){!n&&b?u._writableState?u._writableState.errorEmitted?Me.nextTick(t,u):(u._writableState.errorEmitted=!0,Me.nextTick(e,u,b)):Me.nextTick(e,u,b):n?(Me.nextTick(t,u),n(b)):Me.nextTick(t,u)}),this)}function e(c,n){l(c,n),t(c)}function t(c){c._writableState&&!c._writableState.emitClose||c._readableState&&!c._readableState.emitClose||c.emit("close")}function s(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function l(c,n){c.emit("error",n)}function i(c,n){var u=c._readableState,m=c._writableState;u&&u.autoDestroy||m&&m.autoDestroy?c.destroy(n):c.emit("error",n)}return Bn={destroy:r,undestroy:s,errorOrDestroy:i},Bn}var Fn={},ho;function mr(){if(ho)return Fn;ho=1;function r(n,u){n.prototype=Object.create(u.prototype),n.prototype.constructor=n,n.__proto__=u}var e={};function t(n,u,m){m||(m=Error);function y(T,p,S){return typeof u=="string"?u:u(T,p,S)}var b=function(T){r(p,T);function p(S,g,x){return T.call(this,y(S,g,x))||this}return p}(m);b.prototype.name=m.name,b.prototype.code=n,e[n]=b}function s(n,u){if(Array.isArray(n)){var m=n.length;return n=n.map(function(y){return String(y)}),m>2?"one of ".concat(u," ").concat(n.slice(0,m-1).join(", "),", or ")+n[m-1]:m===2?"one of ".concat(u," ").concat(n[0]," or ").concat(n[1]):"of ".concat(u," ").concat(n[0])}else return"of ".concat(u," ").concat(String(n))}function l(n,u,m){return n.substr(0,u.length)===u}function i(n,u,m){return(m===void 0||m>n.length)&&(m=n.length),n.substring(m-u.length,m)===u}function c(n,u,m){return typeof m!="number"&&(m=0),m+u.length>n.length?!1:n.indexOf(u,m)!==-1}return t("ERR_INVALID_OPT_VALUE",function(n,u){return'The value "'+u+'" is invalid for option "'+n+'"'},TypeError),t("ERR_INVALID_ARG_TYPE",function(n,u,m){var y;typeof u=="string"&&l(u,"not ")?(y="must not be",u=u.replace(/^not /,"")):y="must be";var b;if(i(n," argument"))b="The ".concat(n," ").concat(y," ").concat(s(u,"type"));else{var T=c(n,".")?"property":"argument";b='The "'.concat(n,'" ').concat(T," ").concat(y," ").concat(s(u,"type"))}return b+=". Received type ".concat(typeof m),b},TypeError),t("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),t("ERR_METHOD_NOT_IMPLEMENTED",function(n){return"The "+n+" method is not implemented"}),t("ERR_STREAM_PREMATURE_CLOSE","Premature close"),t("ERR_STREAM_DESTROYED",function(n){return"Cannot call "+n+" after a stream was destroyed"}),t("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),t("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),t("ERR_STREAM_WRITE_AFTER_END","write after end"),t("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),t("ERR_UNKNOWN_ENCODING",function(n){return"Unknown encoding: "+n},TypeError),t("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),Fn.codes=e,Fn}var Ln,po;function Is(){if(po)return Ln;po=1;var r=mr().codes.ERR_INVALID_OPT_VALUE;function e(s,l,i){return s.highWaterMark!=null?s.highWaterMark:l?s[i]:null}function t(s,l,i,c){var n=e(l,c,i);if(n!=null){if(!(isFinite(n)&&Math.floor(n)===n)||n<0){var u=c?i:"highWaterMark";throw new r(u,n)}return Math.floor(n)}return s.objectMode?16:16*1024}return Ln={getHighWaterMark:t},Ln}var Pn,mo;function ol(){if(mo)return Pn;mo=1,Pn=r;function r(t,s){if(e("noDeprecation"))return t;var l=!1;function i(){if(!l){if(e("throwDeprecation"))throw new Error(s);e("traceDeprecation")?console.trace(s):console.warn(s),l=!0}return t.apply(this,arguments)}return i}function e(t){try{if(!Rt.localStorage)return!1}catch{return!1}var s=Rt.localStorage[t];return s==null?!1:String(s).toLowerCase()==="true"}return Pn}var Un,go;function Rs(){if(go)return Un;go=1,Un=Z;function r(z){var v=this;this.next=null,this.entry=null,this.finish=function(){ie(v,z)}}var e;Z.WritableState=X;var t={deprecate:ol()},s=_s(),l=Jr().Buffer,i=Rt.Uint8Array||function(){};function c(z){return l.from(z)}function n(z){return l.isBuffer(z)||z instanceof i}var u=Cs(),m=Is(),y=m.getHighWaterMark,b=mr().codes,T=b.ERR_INVALID_ARG_TYPE,p=b.ERR_METHOD_NOT_IMPLEMENTED,S=b.ERR_MULTIPLE_CALLBACK,g=b.ERR_STREAM_CANNOT_PIPE,x=b.ERR_STREAM_DESTROYED,f=b.ERR_STREAM_NULL_VALUES,_=b.ERR_STREAM_WRITE_AFTER_END,k=b.ERR_UNKNOWN_ENCODING,N=u.errorOrDestroy;Kt(Z,s);function I(){}function X(z,v,w){e=e||nr(),z=z||{},typeof w!="boolean"&&(w=v instanceof e),this.objectMode=!!z.objectMode,w&&(this.objectMode=this.objectMode||!!z.writableObjectMode),this.highWaterMark=y(this,z,"writableHighWaterMark",w),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var U=z.decodeStrings===!1;this.decodeStrings=!U,this.defaultEncoding=z.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(L){oe(v,L)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=z.emitClose!==!1,this.autoDestroy=!!z.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new r(this)}X.prototype.getBuffer=function(){for(var v=this.bufferedRequest,w=[];v;)w.push(v),v=v.next;return w},function(){try{Object.defineProperty(X.prototype,"buffer",{get:t.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var G;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(G=Function.prototype[Symbol.hasInstance],Object.defineProperty(Z,Symbol.hasInstance,{value:function(v){return G.call(this,v)?!0:this!==Z?!1:v&&v._writableState instanceof X}})):G=function(v){return v instanceof this};function Z(z){e=e||nr();var v=this instanceof e;if(!v&&!G.call(Z,this))return new Z(z);this._writableState=new X(z,this,v),this.writable=!0,z&&(typeof z.write=="function"&&(this._write=z.write),typeof z.writev=="function"&&(this._writev=z.writev),typeof z.destroy=="function"&&(this._destroy=z.destroy),typeof z.final=="function"&&(this._final=z.final)),s.call(this)}Z.prototype.pipe=function(){N(this,new g)};function C(z,v){var w=new _;N(z,w),Me.nextTick(v,w)}function ce(z,v,w,U){var L;return w===null?L=new f:typeof w!="string"&&!v.objectMode&&(L=new T("chunk",["string","Buffer"],w)),L?(N(z,L),Me.nextTick(U,L),!1):!0}Z.prototype.write=function(z,v,w){var U=this._writableState,L=!1,D=!U.objectMode&&n(z);return D&&!l.isBuffer(z)&&(z=c(z)),typeof v=="function"&&(w=v,v=null),D?v="buffer":v||(v=U.defaultEncoding),typeof w!="function"&&(w=I),U.ending?C(this,w):(D||ce(this,U,z,w))&&(U.pendingcb++,L=R(this,U,D,z,v,w)),L},Z.prototype.cork=function(){this._writableState.corked++},Z.prototype.uncork=function(){var z=this._writableState;z.corked&&(z.corked--,!z.writing&&!z.corked&&!z.bufferProcessing&&z.bufferedRequest&&Y(this,z))},Z.prototype.setDefaultEncoding=function(v){if(typeof v=="string"&&(v=v.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((v+"").toLowerCase())>-1))throw new k(v);return this._writableState.defaultEncoding=v,this},Object.defineProperty(Z.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function ge(z,v,w){return!z.objectMode&&z.decodeStrings!==!1&&typeof v=="string"&&(v=l.from(v,w)),v}Object.defineProperty(Z.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function R(z,v,w,U,L,D){if(!w){var B=ge(v,U,L);U!==B&&(w=!0,L="buffer",U=B)}var se=v.objectMode?1:U.length;v.length+=se;var h=v.length<v.highWaterMark;if(h||(v.needDrain=!0),v.writing||v.corked){var Q=v.lastBufferedRequest;v.lastBufferedRequest={chunk:U,encoding:L,isBuf:w,callback:D,next:null},Q?Q.next=v.lastBufferedRequest:v.bufferedRequest=v.lastBufferedRequest,v.bufferedRequestCount+=1}else H(z,v,!1,se,U,L,D);return h}function H(z,v,w,U,L,D,B){v.writelen=U,v.writecb=B,v.writing=!0,v.sync=!0,v.destroyed?v.onwrite(new x("write")):w?z._writev(L,v.onwrite):z._write(L,D,v.onwrite),v.sync=!1}function A(z,v,w,U,L){--v.pendingcb,w?(Me.nextTick(L,U),Me.nextTick(K,z,v),z._writableState.errorEmitted=!0,N(z,U)):(L(U),z._writableState.errorEmitted=!0,N(z,U),K(z,v))}function j(z){z.writing=!1,z.writecb=null,z.length-=z.writelen,z.writelen=0}function oe(z,v){var w=z._writableState,U=w.sync,L=w.writecb;if(typeof L!="function")throw new S;if(j(w),v)A(z,w,U,v,L);else{var D=ee(w)||z.destroyed;!D&&!w.corked&&!w.bufferProcessing&&w.bufferedRequest&&Y(z,w),U?Me.nextTick(V,z,w,D,L):V(z,w,D,L)}}function V(z,v,w,U){w||we(z,v),v.pendingcb--,U(),K(z,v)}function we(z,v){v.length===0&&v.needDrain&&(v.needDrain=!1,z.emit("drain"))}function Y(z,v){v.bufferProcessing=!0;var w=v.bufferedRequest;if(z._writev&&w&&w.next){var U=v.bufferedRequestCount,L=new Array(U),D=v.corkedRequestsFree;D.entry=w;for(var B=0,se=!0;w;)L[B]=w,w.isBuf||(se=!1),w=w.next,B+=1;L.allBuffers=se,H(z,v,!0,v.length,L,"",D.finish),v.pendingcb++,v.lastBufferedRequest=null,D.next?(v.corkedRequestsFree=D.next,D.next=null):v.corkedRequestsFree=new r(v),v.bufferedRequestCount=0}else{for(;w;){var h=w.chunk,Q=w.encoding,E=w.callback,o=v.objectMode?1:h.length;if(H(z,v,!1,o,h,Q,E),w=w.next,v.bufferedRequestCount--,v.writing)break}w===null&&(v.lastBufferedRequest=null)}v.bufferedRequest=w,v.bufferProcessing=!1}Z.prototype._write=function(z,v,w){w(new p("_write()"))},Z.prototype._writev=null,Z.prototype.end=function(z,v,w){var U=this._writableState;return typeof z=="function"?(w=z,z=null,v=null):typeof v=="function"&&(w=v,v=null),z!=null&&this.write(z,v),U.corked&&(U.corked=1,this.uncork()),U.ending||q(this,U,w),this},Object.defineProperty(Z.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function ee(z){return z.ending&&z.length===0&&z.bufferedRequest===null&&!z.finished&&!z.writing}function M(z,v){z._final(function(w){v.pendingcb--,w&&N(z,w),v.prefinished=!0,z.emit("prefinish"),K(z,v)})}function O(z,v){!v.prefinished&&!v.finalCalled&&(typeof z._final=="function"&&!v.destroyed?(v.pendingcb++,v.finalCalled=!0,Me.nextTick(M,z,v)):(v.prefinished=!0,z.emit("prefinish")))}function K(z,v){var w=ee(v);if(w&&(O(z,v),v.pendingcb===0&&(v.finished=!0,z.emit("finish"),v.autoDestroy))){var U=z._readableState;(!U||U.autoDestroy&&U.endEmitted)&&z.destroy()}return w}function q(z,v,w){v.ending=!0,K(z,v),w&&(v.finished?Me.nextTick(w):z.once("finish",w)),v.ended=!0,z.writable=!1}function ie(z,v,w){var U=z.entry;for(z.entry=null;U;){var L=U.callback;v.pendingcb--,L(w),U=U.next}v.corkedRequestsFree.next=z}return Object.defineProperty(Z.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(v){this._writableState&&(this._writableState.destroyed=v)}}),Z.prototype.destroy=u.destroy,Z.prototype._undestroy=u.undestroy,Z.prototype._destroy=function(z,v){v(z)},Un}var Mn,wo;function nr(){if(wo)return Mn;wo=1;var r=Object.keys||function(m){var y=[];for(var b in m)y.push(b);return y};Mn=c;var e=Ns(),t=Rs();Kt(c,e);for(var s=r(t.prototype),l=0;l<s.length;l++){var i=s[l];c.prototype[i]||(c.prototype[i]=t.prototype[i])}function c(m){if(!(this instanceof c))return new c(m);e.call(this,m),t.call(this,m),this.allowHalfOpen=!0,m&&(m.readable===!1&&(this.readable=!1),m.writable===!1&&(this.writable=!1),m.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",n)))}Object.defineProperty(c.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(c.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(c.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function n(){this._writableState.ended||Me.nextTick(u,this)}function u(m){m.end()}return Object.defineProperty(c.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(y){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=y,this._writableState.destroyed=y)}}),Mn}var jn={},Or={exports:{}},yo;function sl(){return yo||(yo=1,function(r,e){var t=Jr(),s=t.Buffer;function l(c,n){for(var u in c)n[u]=c[u]}s.from&&s.alloc&&s.allocUnsafe&&s.allocUnsafeSlow?r.exports=t:(l(t,e),e.Buffer=i);function i(c,n,u){return s(c,n,u)}l(s,i),i.from=function(c,n,u){if(typeof c=="number")throw new TypeError("Argument must not be a number");return s(c,n,u)},i.alloc=function(c,n,u){if(typeof c!="number")throw new TypeError("Argument must be a number");var m=s(c);return n!==void 0?typeof u=="string"?m.fill(n,u):m.fill(n):m.fill(0),m},i.allocUnsafe=function(c){if(typeof c!="number")throw new TypeError("Argument must be a number");return s(c)},i.allocUnsafeSlow=function(c){if(typeof c!="number")throw new TypeError("Argument must be a number");return t.SlowBuffer(c)}}(Or,Or.exports)),Or.exports}var vo;function oi(){if(vo)return jn;vo=1;var r=sl().Buffer,e=r.isEncoding||function(f){switch(f=""+f,f&&f.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function t(f){if(!f)return"utf8";for(var _;;)switch(f){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return f;default:if(_)return;f=(""+f).toLowerCase(),_=!0}}function s(f){var _=t(f);if(typeof _!="string"&&(r.isEncoding===e||!e(f)))throw new Error("Unknown encoding: "+f);return _||f}jn.StringDecoder=l;function l(f){this.encoding=s(f);var _;switch(this.encoding){case"utf16le":this.text=b,this.end=T,_=4;break;case"utf8":this.fillLast=u,_=4;break;case"base64":this.text=p,this.end=S,_=3;break;default:this.write=g,this.end=x;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(_)}l.prototype.write=function(f){if(f.length===0)return"";var _,k;if(this.lastNeed){if(_=this.fillLast(f),_===void 0)return"";k=this.lastNeed,this.lastNeed=0}else k=0;return k<f.length?_?_+this.text(f,k):this.text(f,k):_||""},l.prototype.end=y,l.prototype.text=m,l.prototype.fillLast=function(f){if(this.lastNeed<=f.length)return f.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);f.copy(this.lastChar,this.lastTotal-this.lastNeed,0,f.length),this.lastNeed-=f.length};function i(f){return f<=127?0:f>>5===6?2:f>>4===14?3:f>>3===30?4:f>>6===2?-1:-2}function c(f,_,k){var N=_.length-1;if(N<k)return 0;var I=i(_[N]);return I>=0?(I>0&&(f.lastNeed=I-1),I):--N<k||I===-2?0:(I=i(_[N]),I>=0?(I>0&&(f.lastNeed=I-2),I):--N<k||I===-2?0:(I=i(_[N]),I>=0?(I>0&&(I===2?I=0:f.lastNeed=I-3),I):0))}function n(f,_,k){if((_[0]&192)!==128)return f.lastNeed=0,"";if(f.lastNeed>1&&_.length>1){if((_[1]&192)!==128)return f.lastNeed=1,"";if(f.lastNeed>2&&_.length>2&&(_[2]&192)!==128)return f.lastNeed=2,""}}function u(f){var _=this.lastTotal-this.lastNeed,k=n(this,f);if(k!==void 0)return k;if(this.lastNeed<=f.length)return f.copy(this.lastChar,_,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);f.copy(this.lastChar,_,0,f.length),this.lastNeed-=f.length}function m(f,_){var k=c(this,f,_);if(!this.lastNeed)return f.toString("utf8",_);this.lastTotal=k;var N=f.length-(k-this.lastNeed);return f.copy(this.lastChar,0,N),f.toString("utf8",_,N)}function y(f){var _=f&&f.length?this.write(f):"";return this.lastNeed?_+"":_}function b(f,_){if((f.length-_)%2===0){var k=f.toString("utf16le",_);if(k){var N=k.charCodeAt(k.length-1);if(N>=55296&&N<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=f[f.length-2],this.lastChar[1]=f[f.length-1],k.slice(0,-1)}return k}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=f[f.length-1],f.toString("utf16le",_,f.length-1)}function T(f){var _=f&&f.length?this.write(f):"";if(this.lastNeed){var k=this.lastTotal-this.lastNeed;return _+this.lastChar.toString("utf16le",0,k)}return _}function p(f,_){var k=(f.length-_)%3;return k===0?f.toString("base64",_):(this.lastNeed=3-k,this.lastTotal=3,k===1?this.lastChar[0]=f[f.length-1]:(this.lastChar[0]=f[f.length-2],this.lastChar[1]=f[f.length-1]),f.toString("base64",_,f.length-k))}function S(f){var _=f&&f.length?this.write(f):"";return this.lastNeed?_+this.lastChar.toString("base64",0,3-this.lastNeed):_}function g(f){return f.toString(this.encoding)}function x(f){return f&&f.length?this.write(f):""}return jn}var zn,bo;function wi(){if(bo)return zn;bo=1;var r=mr().codes.ERR_STREAM_PREMATURE_CLOSE;function e(i){var c=!1;return function(){if(!c){c=!0;for(var n=arguments.length,u=new Array(n),m=0;m<n;m++)u[m]=arguments[m];i.apply(this,u)}}}function t(){}function s(i){return i.setHeader&&typeof i.abort=="function"}function l(i,c,n){if(typeof c=="function")return l(i,null,c);c||(c={}),n=e(n||t);var u=c.readable||c.readable!==!1&&i.readable,m=c.writable||c.writable!==!1&&i.writable,y=function(){i.writable||T()},b=i._writableState&&i._writableState.finished,T=function(){m=!1,b=!0,u||n.call(i)},p=i._readableState&&i._readableState.endEmitted,S=function(){u=!1,p=!0,m||n.call(i)},g=function(k){n.call(i,k)},x=function(){var k;if(u&&!p)return(!i._readableState||!i._readableState.ended)&&(k=new r),n.call(i,k);if(m&&!b)return(!i._writableState||!i._writableState.ended)&&(k=new r),n.call(i,k)},f=function(){i.req.on("finish",T)};return s(i)?(i.on("complete",T),i.on("abort",x),i.req?f():i.on("request",f)):m&&!i._writableState&&(i.on("end",y),i.on("close",y)),i.on("end",S),i.on("finish",T),c.error!==!1&&i.on("error",g),i.on("close",x),function(){i.removeListener("complete",T),i.removeListener("abort",x),i.removeListener("request",f),i.req&&i.req.removeListener("finish",T),i.removeListener("end",y),i.removeListener("close",y),i.removeListener("finish",T),i.removeListener("end",S),i.removeListener("error",g),i.removeListener("close",x)}}return zn=l,zn}var Hn,_o;function al(){if(_o)return Hn;_o=1;var r;function e(f,_,k){return _ in f?Object.defineProperty(f,_,{value:k,enumerable:!0,configurable:!0,writable:!0}):f[_]=k,f}var t=wi(),s=Symbol("lastResolve"),l=Symbol("lastReject"),i=Symbol("error"),c=Symbol("ended"),n=Symbol("lastPromise"),u=Symbol("handlePromise"),m=Symbol("stream");function y(f,_){return{value:f,done:_}}function b(f){var _=f[s];if(_!==null){var k=f[m].read();k!==null&&(f[n]=null,f[s]=null,f[l]=null,_(y(k,!1)))}}function T(f){Me.nextTick(b,f)}function p(f,_){return function(k,N){f.then(function(){if(_[c]){k(y(void 0,!0));return}_[u](k,N)},N)}}var S=Object.getPrototypeOf(function(){}),g=Object.setPrototypeOf((r={get stream(){return this[m]},next:function(){var _=this,k=this[i];if(k!==null)return Promise.reject(k);if(this[c])return Promise.resolve(y(void 0,!0));if(this[m].destroyed)return new Promise(function(G,Z){Me.nextTick(function(){_[i]?Z(_[i]):G(y(void 0,!0))})});var N=this[n],I;if(N)I=new Promise(p(N,this));else{var X=this[m].read();if(X!==null)return Promise.resolve(y(X,!1));I=new Promise(this[u])}return this[n]=I,I}},e(r,Symbol.asyncIterator,function(){return this}),e(r,"return",function(){var _=this;return new Promise(function(k,N){_[m].destroy(null,function(I){if(I){N(I);return}k(y(void 0,!0))})})}),r),S),x=function(_){var k,N=Object.create(g,(k={},e(k,m,{value:_,writable:!0}),e(k,s,{value:null,writable:!0}),e(k,l,{value:null,writable:!0}),e(k,i,{value:null,writable:!0}),e(k,c,{value:_._readableState.endEmitted,writable:!0}),e(k,u,{value:function(X,G){var Z=N[m].read();Z?(N[n]=null,N[s]=null,N[l]=null,X(y(Z,!1))):(N[s]=X,N[l]=G)},writable:!0}),k));return N[n]=null,t(_,function(I){if(I&&I.code!=="ERR_STREAM_PREMATURE_CLOSE"){var X=N[l];X!==null&&(N[n]=null,N[s]=null,N[l]=null,X(I)),N[i]=I;return}var G=N[s];G!==null&&(N[n]=null,N[s]=null,N[l]=null,G(y(void 0,!0))),N[c]=!0}),_.on("readable",T.bind(null,N)),N};return Hn=x,Hn}var Wn,Eo;function ll(){return Eo||(Eo=1,Wn=function(){throw new Error("Readable.from is not available in the browser")}),Wn}var Gn,xo;function Ns(){if(xo)return Gn;xo=1,Gn=C;var r;C.ReadableState=Z,di.EventEmitter;var e=function(B,se){return B.listeners(se).length},t=_s(),s=Jr().Buffer,l=Rt.Uint8Array||function(){};function i(D){return s.from(D)}function c(D){return s.isBuffer(D)||D instanceof l}var n=ks(),u;n&&n.debuglog?u=n.debuglog("stream"):u=function(){};var m=il(),y=Cs(),b=Is(),T=b.getHighWaterMark,p=mr().codes,S=p.ERR_INVALID_ARG_TYPE,g=p.ERR_STREAM_PUSH_AFTER_EOF,x=p.ERR_METHOD_NOT_IMPLEMENTED,f=p.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,_,k,N;Kt(C,t);var I=y.errorOrDestroy,X=["error","close","destroy","pause","resume"];function G(D,B,se){if(typeof D.prependListener=="function")return D.prependListener(B,se);!D._events||!D._events[B]?D.on(B,se):Array.isArray(D._events[B])?D._events[B].unshift(se):D._events[B]=[se,D._events[B]]}function Z(D,B,se){r=r||nr(),D=D||{},typeof se!="boolean"&&(se=B instanceof r),this.objectMode=!!D.objectMode,se&&(this.objectMode=this.objectMode||!!D.readableObjectMode),this.highWaterMark=T(this,D,"readableHighWaterMark",se),this.buffer=new m,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=D.emitClose!==!1,this.autoDestroy=!!D.autoDestroy,this.destroyed=!1,this.defaultEncoding=D.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,D.encoding&&(_||(_=oi().StringDecoder),this.decoder=new _(D.encoding),this.encoding=D.encoding)}function C(D){if(r=r||nr(),!(this instanceof C))return new C(D);var B=this instanceof r;this._readableState=new Z(D,this,B),this.readable=!0,D&&(typeof D.read=="function"&&(this._read=D.read),typeof D.destroy=="function"&&(this._destroy=D.destroy)),t.call(this)}Object.defineProperty(C.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(B){this._readableState&&(this._readableState.destroyed=B)}}),C.prototype.destroy=y.destroy,C.prototype._undestroy=y.undestroy,C.prototype._destroy=function(D,B){B(D)},C.prototype.push=function(D,B){var se=this._readableState,h;return se.objectMode?h=!0:typeof D=="string"&&(B=B||se.defaultEncoding,B!==se.encoding&&(D=s.from(D,B),B=""),h=!0),ce(this,D,B,!1,h)},C.prototype.unshift=function(D){return ce(this,D,null,!0,!1)};function ce(D,B,se,h,Q){u("readableAddChunk",B);var E=D._readableState;if(B===null)E.reading=!1,oe(D,E);else{var o;if(Q||(o=R(E,B)),o)I(D,o);else if(E.objectMode||B&&B.length>0)if(typeof B!="string"&&!E.objectMode&&Object.getPrototypeOf(B)!==s.prototype&&(B=i(B)),h)E.endEmitted?I(D,new f):ge(D,E,B,!0);else if(E.ended)I(D,new g);else{if(E.destroyed)return!1;E.reading=!1,E.decoder&&!se?(B=E.decoder.write(B),E.objectMode||B.length!==0?ge(D,E,B,!1):Y(D,E)):ge(D,E,B,!1)}else h||(E.reading=!1,Y(D,E))}return!E.ended&&(E.length<E.highWaterMark||E.length===0)}function ge(D,B,se,h){B.flowing&&B.length===0&&!B.sync?(B.awaitDrain=0,D.emit("data",se)):(B.length+=B.objectMode?1:se.length,h?B.buffer.unshift(se):B.buffer.push(se),B.needReadable&&V(D)),Y(D,B)}function R(D,B){var se;return!c(B)&&typeof B!="string"&&B!==void 0&&!D.objectMode&&(se=new S("chunk",["string","Buffer","Uint8Array"],B)),se}C.prototype.isPaused=function(){return this._readableState.flowing===!1},C.prototype.setEncoding=function(D){_||(_=oi().StringDecoder);var B=new _(D);this._readableState.decoder=B,this._readableState.encoding=this._readableState.decoder.encoding;for(var se=this._readableState.buffer.head,h="";se!==null;)h+=B.write(se.data),se=se.next;return this._readableState.buffer.clear(),h!==""&&this._readableState.buffer.push(h),this._readableState.length=h.length,this};var H=1073741824;function A(D){return D>=H?D=H:(D--,D|=D>>>1,D|=D>>>2,D|=D>>>4,D|=D>>>8,D|=D>>>16,D++),D}function j(D,B){return D<=0||B.length===0&&B.ended?0:B.objectMode?1:D!==D?B.flowing&&B.length?B.buffer.head.data.length:B.length:(D>B.highWaterMark&&(B.highWaterMark=A(D)),D<=B.length?D:B.ended?B.length:(B.needReadable=!0,0))}C.prototype.read=function(D){u("read",D),D=parseInt(D,10);var B=this._readableState,se=D;if(D!==0&&(B.emittedReadable=!1),D===0&&B.needReadable&&((B.highWaterMark!==0?B.length>=B.highWaterMark:B.length>0)||B.ended))return u("read: emitReadable",B.length,B.ended),B.length===0&&B.ended?w(this):V(this),null;if(D=j(D,B),D===0&&B.ended)return B.length===0&&w(this),null;var h=B.needReadable;u("need readable",h),(B.length===0||B.length-D<B.highWaterMark)&&(h=!0,u("length less than watermark",h)),B.ended||B.reading?(h=!1,u("reading or ended",h)):h&&(u("do read"),B.reading=!0,B.sync=!0,B.length===0&&(B.needReadable=!0),this._read(B.highWaterMark),B.sync=!1,B.reading||(D=j(se,B)));var Q;return D>0?Q=v(D,B):Q=null,Q===null?(B.needReadable=B.length<=B.highWaterMark,D=0):(B.length-=D,B.awaitDrain=0),B.length===0&&(B.ended||(B.needReadable=!0),se!==D&&B.ended&&w(this)),Q!==null&&this.emit("data",Q),Q};function oe(D,B){if(u("onEofChunk"),!B.ended){if(B.decoder){var se=B.decoder.end();se&&se.length&&(B.buffer.push(se),B.length+=B.objectMode?1:se.length)}B.ended=!0,B.sync?V(D):(B.needReadable=!1,B.emittedReadable||(B.emittedReadable=!0,we(D)))}}function V(D){var B=D._readableState;u("emitReadable",B.needReadable,B.emittedReadable),B.needReadable=!1,B.emittedReadable||(u("emitReadable",B.flowing),B.emittedReadable=!0,Me.nextTick(we,D))}function we(D){var B=D._readableState;u("emitReadable_",B.destroyed,B.length,B.ended),!B.destroyed&&(B.length||B.ended)&&(D.emit("readable"),B.emittedReadable=!1),B.needReadable=!B.flowing&&!B.ended&&B.length<=B.highWaterMark,z(D)}function Y(D,B){B.readingMore||(B.readingMore=!0,Me.nextTick(ee,D,B))}function ee(D,B){for(;!B.reading&&!B.ended&&(B.length<B.highWaterMark||B.flowing&&B.length===0);){var se=B.length;if(u("maybeReadMore read 0"),D.read(0),se===B.length)break}B.readingMore=!1}C.prototype._read=function(D){I(this,new x("_read()"))},C.prototype.pipe=function(D,B){var se=this,h=this._readableState;switch(h.pipesCount){case 0:h.pipes=D;break;case 1:h.pipes=[h.pipes,D];break;default:h.pipes.push(D);break}h.pipesCount+=1,u("pipe count=%d opts=%j",h.pipesCount,B);var Q=(!B||B.end!==!1)&&D!==Me.stdout&&D!==Me.stderr,E=Q?a:xe;h.endEmitted?Me.nextTick(E):se.once("end",E),D.on("unpipe",o);function o(ke,Ne){u("onunpipe"),ke===se&&Ne&&Ne.hasUnpiped===!1&&(Ne.hasUnpiped=!0,$())}function a(){u("onend"),D.end()}var d=M(se);D.on("drain",d);var F=!1;function $(){u("cleanup"),D.removeListener("close",ve),D.removeListener("finish",ae),D.removeListener("drain",d),D.removeListener("error",ue),D.removeListener("unpipe",o),se.removeListener("end",a),se.removeListener("end",xe),se.removeListener("data",P),F=!0,h.awaitDrain&&(!D._writableState||D._writableState.needDrain)&&d()}se.on("data",P);function P(ke){u("ondata");var Ne=D.write(ke);u("dest.write",Ne),Ne===!1&&((h.pipesCount===1&&h.pipes===D||h.pipesCount>1&&L(h.pipes,D)!==-1)&&!F&&(u("false write response, pause",h.awaitDrain),h.awaitDrain++),se.pause())}function ue(ke){u("onerror",ke),xe(),D.removeListener("error",ue),e(D,"error")===0&&I(D,ke)}G(D,"error",ue);function ve(){D.removeListener("finish",ae),xe()}D.once("close",ve);function ae(){u("onfinish"),D.removeListener("close",ve),xe()}D.once("finish",ae);function xe(){u("unpipe"),se.unpipe(D)}return D.emit("pipe",se),h.flowing||(u("pipe resume"),se.resume()),D};function M(D){return function(){var se=D._readableState;u("pipeOnDrain",se.awaitDrain),se.awaitDrain&&se.awaitDrain--,se.awaitDrain===0&&e(D,"data")&&(se.flowing=!0,z(D))}}C.prototype.unpipe=function(D){var B=this._readableState,se={hasUnpiped:!1};if(B.pipesCount===0)return this;if(B.pipesCount===1)return D&&D!==B.pipes?this:(D||(D=B.pipes),B.pipes=null,B.pipesCount=0,B.flowing=!1,D&&D.emit("unpipe",this,se),this);if(!D){var h=B.pipes,Q=B.pipesCount;B.pipes=null,B.pipesCount=0,B.flowing=!1;for(var E=0;E<Q;E++)h[E].emit("unpipe",this,{hasUnpiped:!1});return this}var o=L(B.pipes,D);return o===-1?this:(B.pipes.splice(o,1),B.pipesCount-=1,B.pipesCount===1&&(B.pipes=B.pipes[0]),D.emit("unpipe",this,se),this)},C.prototype.on=function(D,B){var se=t.prototype.on.call(this,D,B),h=this._readableState;return D==="data"?(h.readableListening=this.listenerCount("readable")>0,h.flowing!==!1&&this.resume()):D==="readable"&&!h.endEmitted&&!h.readableListening&&(h.readableListening=h.needReadable=!0,h.flowing=!1,h.emittedReadable=!1,u("on readable",h.length,h.reading),h.length?V(this):h.reading||Me.nextTick(K,this)),se},C.prototype.addListener=C.prototype.on,C.prototype.removeListener=function(D,B){var se=t.prototype.removeListener.call(this,D,B);return D==="readable"&&Me.nextTick(O,this),se},C.prototype.removeAllListeners=function(D){var B=t.prototype.removeAllListeners.apply(this,arguments);return(D==="readable"||D===void 0)&&Me.nextTick(O,this),B};function O(D){var B=D._readableState;B.readableListening=D.listenerCount("readable")>0,B.resumeScheduled&&!B.paused?B.flowing=!0:D.listenerCount("data")>0&&D.resume()}function K(D){u("readable nexttick read 0"),D.read(0)}C.prototype.resume=function(){var D=this._readableState;return D.flowing||(u("resume"),D.flowing=!D.readableListening,q(this,D)),D.paused=!1,this};function q(D,B){B.resumeScheduled||(B.resumeScheduled=!0,Me.nextTick(ie,D,B))}function ie(D,B){u("resume",B.reading),B.reading||D.read(0),B.resumeScheduled=!1,D.emit("resume"),z(D),B.flowing&&!B.reading&&D.read(0)}C.prototype.pause=function(){return u("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(u("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function z(D){var B=D._readableState;for(u("flow",B.flowing);B.flowing&&D.read()!==null;);}C.prototype.wrap=function(D){var B=this,se=this._readableState,h=!1;D.on("end",function(){if(u("wrapped end"),se.decoder&&!se.ended){var o=se.decoder.end();o&&o.length&&B.push(o)}B.push(null)}),D.on("data",function(o){if(u("wrapped data"),se.decoder&&(o=se.decoder.write(o)),!(se.objectMode&&o==null)&&!(!se.objectMode&&(!o||!o.length))){var a=B.push(o);a||(h=!0,D.pause())}});for(var Q in D)this[Q]===void 0&&typeof D[Q]=="function"&&(this[Q]=function(a){return function(){return D[a].apply(D,arguments)}}(Q));for(var E=0;E<X.length;E++)D.on(X[E],this.emit.bind(this,X[E]));return this._read=function(o){u("wrapped _read",o),h&&(h=!1,D.resume())},this},typeof Symbol=="function"&&(C.prototype[Symbol.asyncIterator]=function(){return k===void 0&&(k=al()),k(this)}),Object.defineProperty(C.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(C.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(C.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(B){this._readableState&&(this._readableState.flowing=B)}}),C._fromList=v,Object.defineProperty(C.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function v(D,B){if(B.length===0)return null;var se;return B.objectMode?se=B.buffer.shift():!D||D>=B.length?(B.decoder?se=B.buffer.join(""):B.buffer.length===1?se=B.buffer.first():se=B.buffer.concat(B.length),B.buffer.clear()):se=B.buffer.consume(D,B.decoder),se}function w(D){var B=D._readableState;u("endReadable",B.endEmitted),B.endEmitted||(B.ended=!0,Me.nextTick(U,B,D))}function U(D,B){if(u("endReadableNT",D.endEmitted,D.length),!D.endEmitted&&D.length===0&&(D.endEmitted=!0,B.readable=!1,B.emit("end"),D.autoDestroy)){var se=B._writableState;(!se||se.autoDestroy&&se.finished)&&B.destroy()}}typeof Symbol=="function"&&(C.from=function(D,B){return N===void 0&&(N=ll()),N(C,D,B)});function L(D,B){for(var se=0,h=D.length;se<h;se++)if(D[se]===B)return se;return-1}return Gn}var $n,To;function Ds(){if(To)return $n;To=1,$n=n;var r=mr().codes,e=r.ERR_METHOD_NOT_IMPLEMENTED,t=r.ERR_MULTIPLE_CALLBACK,s=r.ERR_TRANSFORM_ALREADY_TRANSFORMING,l=r.ERR_TRANSFORM_WITH_LENGTH_0,i=nr();Kt(n,i);function c(y,b){var T=this._transformState;T.transforming=!1;var p=T.writecb;if(p===null)return this.emit("error",new t);T.writechunk=null,T.writecb=null,b!=null&&this.push(b),p(y);var S=this._readableState;S.reading=!1,(S.needReadable||S.length<S.highWaterMark)&&this._read(S.highWaterMark)}function n(y){if(!(this instanceof n))return new n(y);i.call(this,y),this._transformState={afterTransform:c.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,y&&(typeof y.transform=="function"&&(this._transform=y.transform),typeof y.flush=="function"&&(this._flush=y.flush)),this.on("prefinish",u)}function u(){var y=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(b,T){m(y,b,T)}):m(this,null,null)}n.prototype.push=function(y,b){return this._transformState.needTransform=!1,i.prototype.push.call(this,y,b)},n.prototype._transform=function(y,b,T){T(new e("_transform()"))},n.prototype._write=function(y,b,T){var p=this._transformState;if(p.writecb=T,p.writechunk=y,p.writeencoding=b,!p.transforming){var S=this._readableState;(p.needTransform||S.needReadable||S.length<S.highWaterMark)&&this._read(S.highWaterMark)}},n.prototype._read=function(y){var b=this._transformState;b.writechunk!==null&&!b.transforming?(b.transforming=!0,this._transform(b.writechunk,b.writeencoding,b.afterTransform)):b.needTransform=!0},n.prototype._destroy=function(y,b){i.prototype._destroy.call(this,y,function(T){b(T)})};function m(y,b,T){if(b)return y.emit("error",b);if(T!=null&&y.push(T),y._writableState.length)throw new l;if(y._transformState.transforming)throw new s;return y.push(null)}return $n}var Vn,Ao;function cl(){if(Ao)return Vn;Ao=1,Vn=e;var r=Ds();Kt(e,r);function e(t){if(!(this instanceof e))return new e(t);r.call(this,t)}return e.prototype._transform=function(t,s,l){l(null,t)},Vn}var Kn,So;function ul(){if(So)return Kn;So=1;var r;function e(T){var p=!1;return function(){p||(p=!0,T.apply(void 0,arguments))}}var t=mr().codes,s=t.ERR_MISSING_ARGS,l=t.ERR_STREAM_DESTROYED;function i(T){if(T)throw T}function c(T){return T.setHeader&&typeof T.abort=="function"}function n(T,p,S,g){g=e(g);var x=!1;T.on("close",function(){x=!0}),r===void 0&&(r=wi()),r(T,{readable:p,writable:S},function(_){if(_)return g(_);x=!0,g()});var f=!1;return function(_){if(!x&&!f){if(f=!0,c(T))return T.abort();if(typeof T.destroy=="function")return T.destroy();g(_||new l("pipe"))}}}function u(T){T()}function m(T,p){return T.pipe(p)}function y(T){return!T.length||typeof T[T.length-1]!="function"?i:T.pop()}function b(){for(var T=arguments.length,p=new Array(T),S=0;S<T;S++)p[S]=arguments[S];var g=y(p);if(Array.isArray(p[0])&&(p=p[0]),p.length<2)throw new s("streams");var x,f=p.map(function(_,k){var N=k<p.length-1,I=k>0;return n(_,N,I,function(X){x||(x=X),X&&f.forEach(u),!N&&(f.forEach(u),g(x))})});return p.reduce(m)}return Kn=b,Kn}var yi=vt,vi=di.EventEmitter,fl=Kt;fl(vt,vi);vt.Readable=Ns();vt.Writable=Rs();vt.Duplex=nr();vt.Transform=Ds();vt.PassThrough=cl();vt.finished=wi();vt.pipeline=ul();vt.Stream=vt;function vt(){vi.call(this)}vt.prototype.pipe=function(r,e){var t=this;function s(y){r.writable&&r.write(y)===!1&&t.pause&&t.pause()}t.on("data",s);function l(){t.readable&&t.resume&&t.resume()}r.on("drain",l),!r._isStdio&&(!e||e.end!==!1)&&(t.on("end",c),t.on("close",n));var i=!1;function c(){i||(i=!0,r.end())}function n(){i||(i=!0,typeof r.destroy=="function"&&r.destroy())}function u(y){if(m(),vi.listenerCount(this,"error")===0)throw y}t.on("error",u),r.on("error",u);function m(){t.removeListener("data",s),r.removeListener("drain",l),t.removeListener("end",c),t.removeListener("close",n),t.removeListener("error",u),r.removeListener("error",u),t.removeListener("end",m),t.removeListener("close",m),r.removeListener("close",m)}return t.on("end",m),t.on("close",m),r.on("close",m),r.emit("pipe",t),r};(function(r){(function(e){e.parser=function(v,w){return new s(v,w)},e.SAXParser=s,e.SAXStream=y,e.createStream=m,e.MAX_BUFFER_LENGTH=64*1024;var t=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];e.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function s(v,w){if(!(this instanceof s))return new s(v,w);var U=this;i(U),U.q=U.c="",U.bufferCheckPosition=e.MAX_BUFFER_LENGTH,U.opt=w||{},U.opt.lowercase=U.opt.lowercase||U.opt.lowercasetags,U.looseCase=U.opt.lowercase?"toLowerCase":"toUpperCase",U.tags=[],U.closed=U.closedRoot=U.sawRoot=!1,U.tag=U.error=null,U.strict=!!v,U.noscript=!!(v||U.opt.noscript),U.state=C.BEGIN,U.strictEntities=U.opt.strictEntities,U.ENTITIES=U.strictEntities?Object.create(e.XML_ENTITIES):Object.create(e.ENTITIES),U.attribList=[],U.opt.xmlns&&(U.ns=Object.create(g)),U.trackPosition=U.opt.position!==!1,U.trackPosition&&(U.position=U.line=U.column=0),ge(U,"onready")}Object.create||(Object.create=function(v){function w(){}w.prototype=v;var U=new w;return U}),Object.keys||(Object.keys=function(v){var w=[];for(var U in v)v.hasOwnProperty(U)&&w.push(U);return w});function l(v){for(var w=Math.max(e.MAX_BUFFER_LENGTH,10),U=0,L=0,D=t.length;L<D;L++){var B=v[t[L]].length;if(B>w)switch(t[L]){case"textNode":H(v);break;case"cdata":R(v,"oncdata",v.cdata),v.cdata="";break;case"script":R(v,"onscript",v.script),v.script="";break;default:j(v,"Max buffer length exceeded: "+t[L])}U=Math.max(U,B)}var se=e.MAX_BUFFER_LENGTH-U;v.bufferCheckPosition=se+v.position}function i(v){for(var w=0,U=t.length;w<U;w++)v[t[w]]=""}function c(v){H(v),v.cdata!==""&&(R(v,"oncdata",v.cdata),v.cdata=""),v.script!==""&&(R(v,"onscript",v.script),v.script="")}s.prototype={end:function(){oe(this)},write:z,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){c(this)}};var n;try{n=yi.Stream}catch{n=function(){}}var u=e.EVENTS.filter(function(v){return v!=="error"&&v!=="end"});function m(v,w){return new y(v,w)}function y(v,w){if(!(this instanceof y))return new y(v,w);n.apply(this),this._parser=new s(v,w),this.writable=!0,this.readable=!0;var U=this;this._parser.onend=function(){U.emit("end")},this._parser.onerror=function(L){U.emit("error",L),U._parser.error=null},this._decoder=null,u.forEach(function(L){Object.defineProperty(U,"on"+L,{get:function(){return U._parser["on"+L]},set:function(D){if(!D)return U.removeAllListeners(L),U._parser["on"+L]=D,D;U.on(L,D)},enumerable:!0,configurable:!1})})}y.prototype=Object.create(n.prototype,{constructor:{value:y}}),y.prototype.write=function(v){if(typeof Buffer=="function"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(v)){if(!this._decoder){var w=oi().StringDecoder;this._decoder=new w("utf8")}v=this._decoder.write(v)}return this._parser.write(v.toString()),this.emit("data",v),!0},y.prototype.end=function(v){return v&&v.length&&this.write(v),this._parser.end(),!0},y.prototype.on=function(v,w){var U=this;return!U._parser["on"+v]&&u.indexOf(v)!==-1&&(U._parser["on"+v]=function(){var L=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);L.splice(0,0,v),U.emit.apply(U,L)}),n.prototype.on.call(U,v,w)};var b="[CDATA[",T="DOCTYPE",p="http://www.w3.org/XML/1998/namespace",S="http://www.w3.org/2000/xmlns/",g={xml:p,xmlns:S},x=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,f=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,_=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,k=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function N(v){return v===" "||v===`
`||v==="\r"||v==="	"}function I(v){return v==='"'||v==="'"}function X(v){return v===">"||N(v)}function G(v,w){return v.test(w)}function Z(v,w){return!G(v,w)}var C=0;e.STATE={BEGIN:C++,BEGIN_WHITESPACE:C++,TEXT:C++,TEXT_ENTITY:C++,OPEN_WAKA:C++,SGML_DECL:C++,SGML_DECL_QUOTED:C++,DOCTYPE:C++,DOCTYPE_QUOTED:C++,DOCTYPE_DTD:C++,DOCTYPE_DTD_QUOTED:C++,COMMENT_STARTING:C++,COMMENT:C++,COMMENT_ENDING:C++,COMMENT_ENDED:C++,CDATA:C++,CDATA_ENDING:C++,CDATA_ENDING_2:C++,PROC_INST:C++,PROC_INST_BODY:C++,PROC_INST_ENDING:C++,OPEN_TAG:C++,OPEN_TAG_SLASH:C++,ATTRIB:C++,ATTRIB_NAME:C++,ATTRIB_NAME_SAW_WHITE:C++,ATTRIB_VALUE:C++,ATTRIB_VALUE_QUOTED:C++,ATTRIB_VALUE_CLOSED:C++,ATTRIB_VALUE_UNQUOTED:C++,ATTRIB_VALUE_ENTITY_Q:C++,ATTRIB_VALUE_ENTITY_U:C++,CLOSE_TAG:C++,CLOSE_TAG_SAW_WHITE:C++,SCRIPT:C++,SCRIPT_ENDING:C++},e.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},e.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(e.ENTITIES).forEach(function(v){var w=e.ENTITIES[v],U=typeof w=="number"?String.fromCharCode(w):w;e.ENTITIES[v]=U});for(var ce in e.STATE)e.STATE[e.STATE[ce]]=ce;C=e.STATE;function ge(v,w,U){v[w]&&v[w](U)}function R(v,w,U){v.textNode&&H(v),ge(v,w,U)}function H(v){v.textNode=A(v.opt,v.textNode),v.textNode&&ge(v,"ontext",v.textNode),v.textNode=""}function A(v,w){return v.trim&&(w=w.trim()),v.normalize&&(w=w.replace(/\s+/g," ")),w}function j(v,w){return H(v),v.trackPosition&&(w+=`
Line: `+v.line+`
Column: `+v.column+`
Char: `+v.c),w=new Error(w),v.error=w,ge(v,"onerror",w),v}function oe(v){return v.sawRoot&&!v.closedRoot&&V(v,"Unclosed root tag"),v.state!==C.BEGIN&&v.state!==C.BEGIN_WHITESPACE&&v.state!==C.TEXT&&j(v,"Unexpected end"),H(v),v.c="",v.closed=!0,ge(v,"onend"),s.call(v,v.strict,v.opt),v}function V(v,w){if(typeof v!="object"||!(v instanceof s))throw new Error("bad call to strictFail");v.strict&&j(v,w)}function we(v){v.strict||(v.tagName=v.tagName[v.looseCase]());var w=v.tags[v.tags.length-1]||v,U=v.tag={name:v.tagName,attributes:{}};v.opt.xmlns&&(U.ns=w.ns),v.attribList.length=0,R(v,"onopentagstart",U)}function Y(v,w){var U=v.indexOf(":"),L=U<0?["",v]:v.split(":"),D=L[0],B=L[1];return w&&v==="xmlns"&&(D="xmlns",B=""),{prefix:D,local:B}}function ee(v){if(v.strict||(v.attribName=v.attribName[v.looseCase]()),v.attribList.indexOf(v.attribName)!==-1||v.tag.attributes.hasOwnProperty(v.attribName)){v.attribName=v.attribValue="";return}if(v.opt.xmlns){var w=Y(v.attribName,!0),U=w.prefix,L=w.local;if(U==="xmlns")if(L==="xml"&&v.attribValue!==p)V(v,"xml: prefix must be bound to "+p+`
Actual: `+v.attribValue);else if(L==="xmlns"&&v.attribValue!==S)V(v,"xmlns: prefix must be bound to "+S+`
Actual: `+v.attribValue);else{var D=v.tag,B=v.tags[v.tags.length-1]||v;D.ns===B.ns&&(D.ns=Object.create(B.ns)),D.ns[L]=v.attribValue}v.attribList.push([v.attribName,v.attribValue])}else v.tag.attributes[v.attribName]=v.attribValue,R(v,"onattribute",{name:v.attribName,value:v.attribValue});v.attribName=v.attribValue=""}function M(v,w){if(v.opt.xmlns){var U=v.tag,L=Y(v.tagName);U.prefix=L.prefix,U.local=L.local,U.uri=U.ns[L.prefix]||"",U.prefix&&!U.uri&&(V(v,"Unbound namespace prefix: "+JSON.stringify(v.tagName)),U.uri=L.prefix);var D=v.tags[v.tags.length-1]||v;U.ns&&D.ns!==U.ns&&Object.keys(U.ns).forEach(function(P){R(v,"onopennamespace",{prefix:P,uri:U.ns[P]})});for(var B=0,se=v.attribList.length;B<se;B++){var h=v.attribList[B],Q=h[0],E=h[1],o=Y(Q,!0),a=o.prefix,d=o.local,F=a===""?"":U.ns[a]||"",$={name:Q,value:E,prefix:a,local:d,uri:F};a&&a!=="xmlns"&&!F&&(V(v,"Unbound namespace prefix: "+JSON.stringify(a)),$.uri=a),v.tag.attributes[Q]=$,R(v,"onattribute",$)}v.attribList.length=0}v.tag.isSelfClosing=!!w,v.sawRoot=!0,v.tags.push(v.tag),R(v,"onopentag",v.tag),w||(!v.noscript&&v.tagName.toLowerCase()==="script"?v.state=C.SCRIPT:v.state=C.TEXT,v.tag=null,v.tagName=""),v.attribName=v.attribValue="",v.attribList.length=0}function O(v){if(!v.tagName){V(v,"Weird empty close tag."),v.textNode+="</>",v.state=C.TEXT;return}if(v.script){if(v.tagName!=="script"){v.script+="</"+v.tagName+">",v.tagName="",v.state=C.SCRIPT;return}R(v,"onscript",v.script),v.script=""}var w=v.tags.length,U=v.tagName;v.strict||(U=U[v.looseCase]());for(var L=U;w--;){var D=v.tags[w];if(D.name!==L)V(v,"Unexpected close tag");else break}if(w<0){V(v,"Unmatched closing tag: "+v.tagName),v.textNode+="</"+v.tagName+">",v.state=C.TEXT;return}v.tagName=U;for(var B=v.tags.length;B-- >w;){var se=v.tag=v.tags.pop();v.tagName=v.tag.name,R(v,"onclosetag",v.tagName);var h={};for(var Q in se.ns)h[Q]=se.ns[Q];var E=v.tags[v.tags.length-1]||v;v.opt.xmlns&&se.ns!==E.ns&&Object.keys(se.ns).forEach(function(o){var a=se.ns[o];R(v,"onclosenamespace",{prefix:o,uri:a})})}w===0&&(v.closedRoot=!0),v.tagName=v.attribValue=v.attribName="",v.attribList.length=0,v.state=C.TEXT}function K(v){var w=v.entity,U=w.toLowerCase(),L,D="";return v.ENTITIES[w]?v.ENTITIES[w]:v.ENTITIES[U]?v.ENTITIES[U]:(w=U,w.charAt(0)==="#"&&(w.charAt(1)==="x"?(w=w.slice(2),L=parseInt(w,16),D=L.toString(16)):(w=w.slice(1),L=parseInt(w,10),D=L.toString(10))),w=w.replace(/^0+/,""),isNaN(L)||D.toLowerCase()!==w?(V(v,"Invalid character entity"),"&"+v.entity+";"):String.fromCodePoint(L))}function q(v,w){w==="<"?(v.state=C.OPEN_WAKA,v.startTagPosition=v.position):N(w)||(V(v,"Non-whitespace before first tag."),v.textNode=w,v.state=C.TEXT)}function ie(v,w){var U="";return w<v.length&&(U=v.charAt(w)),U}function z(v){var w=this;if(this.error)throw this.error;if(w.closed)return j(w,"Cannot write after close. Assign an onready handler.");if(v===null)return oe(w);typeof v=="object"&&(v=v.toString());for(var U=0,L="";L=ie(v,U++),w.c=L,!!L;)switch(w.trackPosition&&(w.position++,L===`
`?(w.line++,w.column=0):w.column++),w.state){case C.BEGIN:if(w.state=C.BEGIN_WHITESPACE,L==="\uFEFF")continue;q(w,L);continue;case C.BEGIN_WHITESPACE:q(w,L);continue;case C.TEXT:if(w.sawRoot&&!w.closedRoot){for(var D=U-1;L&&L!=="<"&&L!=="&";)L=ie(v,U++),L&&w.trackPosition&&(w.position++,L===`
`?(w.line++,w.column=0):w.column++);w.textNode+=v.substring(D,U-1)}L==="<"&&!(w.sawRoot&&w.closedRoot&&!w.strict)?(w.state=C.OPEN_WAKA,w.startTagPosition=w.position):(!N(L)&&(!w.sawRoot||w.closedRoot)&&V(w,"Text data outside of root node."),L==="&"?w.state=C.TEXT_ENTITY:w.textNode+=L);continue;case C.SCRIPT:L==="<"?w.state=C.SCRIPT_ENDING:w.script+=L;continue;case C.SCRIPT_ENDING:L==="/"?w.state=C.CLOSE_TAG:(w.script+="<"+L,w.state=C.SCRIPT);continue;case C.OPEN_WAKA:if(L==="!")w.state=C.SGML_DECL,w.sgmlDecl="";else if(!N(L))if(G(x,L))w.state=C.OPEN_TAG,w.tagName=L;else if(L==="/")w.state=C.CLOSE_TAG,w.tagName="";else if(L==="?")w.state=C.PROC_INST,w.procInstName=w.procInstBody="";else{if(V(w,"Unencoded <"),w.startTagPosition+1<w.position){var B=w.position-w.startTagPosition;L=new Array(B).join(" ")+L}w.textNode+="<"+L,w.state=C.TEXT}continue;case C.SGML_DECL:(w.sgmlDecl+L).toUpperCase()===b?(R(w,"onopencdata"),w.state=C.CDATA,w.sgmlDecl="",w.cdata=""):w.sgmlDecl+L==="--"?(w.state=C.COMMENT,w.comment="",w.sgmlDecl=""):(w.sgmlDecl+L).toUpperCase()===T?(w.state=C.DOCTYPE,(w.doctype||w.sawRoot)&&V(w,"Inappropriately located doctype declaration"),w.doctype="",w.sgmlDecl=""):L===">"?(R(w,"onsgmldeclaration",w.sgmlDecl),w.sgmlDecl="",w.state=C.TEXT):(I(L)&&(w.state=C.SGML_DECL_QUOTED),w.sgmlDecl+=L);continue;case C.SGML_DECL_QUOTED:L===w.q&&(w.state=C.SGML_DECL,w.q=""),w.sgmlDecl+=L;continue;case C.DOCTYPE:L===">"?(w.state=C.TEXT,R(w,"ondoctype",w.doctype),w.doctype=!0):(w.doctype+=L,L==="["?w.state=C.DOCTYPE_DTD:I(L)&&(w.state=C.DOCTYPE_QUOTED,w.q=L));continue;case C.DOCTYPE_QUOTED:w.doctype+=L,L===w.q&&(w.q="",w.state=C.DOCTYPE);continue;case C.DOCTYPE_DTD:w.doctype+=L,L==="]"?w.state=C.DOCTYPE:I(L)&&(w.state=C.DOCTYPE_DTD_QUOTED,w.q=L);continue;case C.DOCTYPE_DTD_QUOTED:w.doctype+=L,L===w.q&&(w.state=C.DOCTYPE_DTD,w.q="");continue;case C.COMMENT:L==="-"?w.state=C.COMMENT_ENDING:w.comment+=L;continue;case C.COMMENT_ENDING:L==="-"?(w.state=C.COMMENT_ENDED,w.comment=A(w.opt,w.comment),w.comment&&R(w,"oncomment",w.comment),w.comment=""):(w.comment+="-"+L,w.state=C.COMMENT);continue;case C.COMMENT_ENDED:L!==">"?(V(w,"Malformed comment"),w.comment+="--"+L,w.state=C.COMMENT):w.state=C.TEXT;continue;case C.CDATA:L==="]"?w.state=C.CDATA_ENDING:w.cdata+=L;continue;case C.CDATA_ENDING:L==="]"?w.state=C.CDATA_ENDING_2:(w.cdata+="]"+L,w.state=C.CDATA);continue;case C.CDATA_ENDING_2:L===">"?(w.cdata&&R(w,"oncdata",w.cdata),R(w,"onclosecdata"),w.cdata="",w.state=C.TEXT):L==="]"?w.cdata+="]":(w.cdata+="]]"+L,w.state=C.CDATA);continue;case C.PROC_INST:L==="?"?w.state=C.PROC_INST_ENDING:N(L)?w.state=C.PROC_INST_BODY:w.procInstName+=L;continue;case C.PROC_INST_BODY:if(!w.procInstBody&&N(L))continue;L==="?"?w.state=C.PROC_INST_ENDING:w.procInstBody+=L;continue;case C.PROC_INST_ENDING:L===">"?(R(w,"onprocessinginstruction",{name:w.procInstName,body:w.procInstBody}),w.procInstName=w.procInstBody="",w.state=C.TEXT):(w.procInstBody+="?"+L,w.state=C.PROC_INST_BODY);continue;case C.OPEN_TAG:G(f,L)?w.tagName+=L:(we(w),L===">"?M(w):L==="/"?w.state=C.OPEN_TAG_SLASH:(N(L)||V(w,"Invalid character in tag name"),w.state=C.ATTRIB));continue;case C.OPEN_TAG_SLASH:L===">"?(M(w,!0),O(w)):(V(w,"Forward-slash in opening tag not followed by >"),w.state=C.ATTRIB);continue;case C.ATTRIB:if(N(L))continue;L===">"?M(w):L==="/"?w.state=C.OPEN_TAG_SLASH:G(x,L)?(w.attribName=L,w.attribValue="",w.state=C.ATTRIB_NAME):V(w,"Invalid attribute name");continue;case C.ATTRIB_NAME:L==="="?w.state=C.ATTRIB_VALUE:L===">"?(V(w,"Attribute without value"),w.attribValue=w.attribName,ee(w),M(w)):N(L)?w.state=C.ATTRIB_NAME_SAW_WHITE:G(f,L)?w.attribName+=L:V(w,"Invalid attribute name");continue;case C.ATTRIB_NAME_SAW_WHITE:if(L==="=")w.state=C.ATTRIB_VALUE;else{if(N(L))continue;V(w,"Attribute without value"),w.tag.attributes[w.attribName]="",w.attribValue="",R(w,"onattribute",{name:w.attribName,value:""}),w.attribName="",L===">"?M(w):G(x,L)?(w.attribName=L,w.state=C.ATTRIB_NAME):(V(w,"Invalid attribute name"),w.state=C.ATTRIB)}continue;case C.ATTRIB_VALUE:if(N(L))continue;I(L)?(w.q=L,w.state=C.ATTRIB_VALUE_QUOTED):(V(w,"Unquoted attribute value"),w.state=C.ATTRIB_VALUE_UNQUOTED,w.attribValue=L);continue;case C.ATTRIB_VALUE_QUOTED:if(L!==w.q){L==="&"?w.state=C.ATTRIB_VALUE_ENTITY_Q:w.attribValue+=L;continue}ee(w),w.q="",w.state=C.ATTRIB_VALUE_CLOSED;continue;case C.ATTRIB_VALUE_CLOSED:N(L)?w.state=C.ATTRIB:L===">"?M(w):L==="/"?w.state=C.OPEN_TAG_SLASH:G(x,L)?(V(w,"No whitespace between attributes"),w.attribName=L,w.attribValue="",w.state=C.ATTRIB_NAME):V(w,"Invalid attribute name");continue;case C.ATTRIB_VALUE_UNQUOTED:if(!X(L)){L==="&"?w.state=C.ATTRIB_VALUE_ENTITY_U:w.attribValue+=L;continue}ee(w),L===">"?M(w):w.state=C.ATTRIB;continue;case C.CLOSE_TAG:if(w.tagName)L===">"?O(w):G(f,L)?w.tagName+=L:w.script?(w.script+="</"+w.tagName,w.tagName="",w.state=C.SCRIPT):(N(L)||V(w,"Invalid tagname in closing tag"),w.state=C.CLOSE_TAG_SAW_WHITE);else{if(N(L))continue;Z(x,L)?w.script?(w.script+="</"+L,w.state=C.SCRIPT):V(w,"Invalid tagname in closing tag."):w.tagName=L}continue;case C.CLOSE_TAG_SAW_WHITE:if(N(L))continue;L===">"?O(w):V(w,"Invalid characters in closing tag");continue;case C.TEXT_ENTITY:case C.ATTRIB_VALUE_ENTITY_Q:case C.ATTRIB_VALUE_ENTITY_U:var se,h;switch(w.state){case C.TEXT_ENTITY:se=C.TEXT,h="textNode";break;case C.ATTRIB_VALUE_ENTITY_Q:se=C.ATTRIB_VALUE_QUOTED,h="attribValue";break;case C.ATTRIB_VALUE_ENTITY_U:se=C.ATTRIB_VALUE_UNQUOTED,h="attribValue";break}L===";"?(w[h]+=K(w),w.entity="",w.state=se):G(w.entity.length?k:_,L)?w.entity+=L:(V(w,"Invalid character in entity name"),w[h]+="&"+w.entity+L,w.entity="",w.state=se);continue;default:throw new Error(w,"Unknown state: "+w.state)}return w.position>=w.bufferCheckPosition&&l(w),w}/*! http://mths.be/fromcodepoint v0.1.0 by @mathias */String.fromCodePoint||function(){var v=String.fromCharCode,w=Math.floor,U=function(){var L=16384,D=[],B,se,h=-1,Q=arguments.length;if(!Q)return"";for(var E="";++h<Q;){var o=Number(arguments[h]);if(!isFinite(o)||o<0||o>1114111||w(o)!==o)throw RangeError("Invalid code point: "+o);o<=65535?D.push(o):(o-=65536,B=(o>>10)+55296,se=o%1024+56320,D.push(B,se)),(h+1===Q||D.length>L)&&(E+=v.apply(null,D),D.length=0)}return E};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:U,configurable:!0,writable:!0}):String.fromCodePoint=U}()})(r)})(ls);var bi={isArray:function(r){return Array.isArray?Array.isArray(r):Object.prototype.toString.call(r)==="[object Array]"}},hl=bi.isArray,_i={copyOptions:function(r){var e,t={};for(e in r)r.hasOwnProperty(e)&&(t[e]=r[e]);return t},ensureFlagExists:function(r,e){(!(r in e)||typeof e[r]!="boolean")&&(e[r]=!1)},ensureSpacesExists:function(r){(!("spaces"in r)||typeof r.spaces!="number"&&typeof r.spaces!="string")&&(r.spaces=0)},ensureAlwaysArrayExists:function(r){(!("alwaysArray"in r)||typeof r.alwaysArray!="boolean"&&!hl(r.alwaysArray))&&(r.alwaysArray=!1)},ensureKeyExists:function(r,e){(!(r+"Key"in e)||typeof e[r+"Key"]!="string")&&(e[r+"Key"]=e.compact?"_"+r:r)},checkFnExists:function(r,e){return r+"Fn"in e}},dl=ls,We=_i,Qt=bi.isArray,le,Le;function pl(r){return le=We.copyOptions(r),We.ensureFlagExists("ignoreDeclaration",le),We.ensureFlagExists("ignoreInstruction",le),We.ensureFlagExists("ignoreAttributes",le),We.ensureFlagExists("ignoreText",le),We.ensureFlagExists("ignoreComment",le),We.ensureFlagExists("ignoreCdata",le),We.ensureFlagExists("ignoreDoctype",le),We.ensureFlagExists("compact",le),We.ensureFlagExists("alwaysChildren",le),We.ensureFlagExists("addParent",le),We.ensureFlagExists("trim",le),We.ensureFlagExists("nativeType",le),We.ensureFlagExists("nativeTypeAttributes",le),We.ensureFlagExists("sanitize",le),We.ensureFlagExists("instructionHasAttributes",le),We.ensureFlagExists("captureSpacesBetweenElements",le),We.ensureAlwaysArrayExists(le),We.ensureKeyExists("declaration",le),We.ensureKeyExists("instruction",le),We.ensureKeyExists("attributes",le),We.ensureKeyExists("text",le),We.ensureKeyExists("comment",le),We.ensureKeyExists("cdata",le),We.ensureKeyExists("doctype",le),We.ensureKeyExists("type",le),We.ensureKeyExists("name",le),We.ensureKeyExists("elements",le),We.ensureKeyExists("parent",le),le}function Os(r){var e=Number(r);if(!isNaN(e))return e;var t=r.toLowerCase();return t==="true"?!0:t==="false"?!1:r}function kr(r,e){var t;if(le.compact){if(!Le[le[r+"Key"]]&&(Qt(le.alwaysArray)?le.alwaysArray.indexOf(le[r+"Key"])!==-1:le.alwaysArray)&&(Le[le[r+"Key"]]=[]),Le[le[r+"Key"]]&&!Qt(Le[le[r+"Key"]])&&(Le[le[r+"Key"]]=[Le[le[r+"Key"]]]),r+"Fn"in le&&typeof e=="string"&&(e=le[r+"Fn"](e,Le)),r==="instruction"&&("instructionFn"in le||"instructionNameFn"in le)){for(t in e)if(e.hasOwnProperty(t))if("instructionFn"in le)e[t]=le.instructionFn(e[t],t,Le);else{var s=e[t];delete e[t],e[le.instructionNameFn(t,s,Le)]=s}}Qt(Le[le[r+"Key"]])?Le[le[r+"Key"]].push(e):Le[le[r+"Key"]]=e}else{Le[le.elementsKey]||(Le[le.elementsKey]=[]);var l={};if(l[le.typeKey]=r,r==="instruction"){for(t in e)if(e.hasOwnProperty(t))break;l[le.nameKey]="instructionNameFn"in le?le.instructionNameFn(t,e,Le):t,le.instructionHasAttributes?(l[le.attributesKey]=e[t][le.attributesKey],"instructionFn"in le&&(l[le.attributesKey]=le.instructionFn(l[le.attributesKey],t,Le))):("instructionFn"in le&&(e[t]=le.instructionFn(e[t],t,Le)),l[le.instructionKey]=e[t])}else r+"Fn"in le&&(e=le[r+"Fn"](e,Le)),l[le[r+"Key"]]=e;le.addParent&&(l[le.parentKey]=Le),Le[le.elementsKey].push(l)}}function Bs(r){if("attributesFn"in le&&r&&(r=le.attributesFn(r,Le)),(le.trim||"attributeValueFn"in le||"attributeNameFn"in le||le.nativeTypeAttributes)&&r){var e;for(e in r)if(r.hasOwnProperty(e)&&(le.trim&&(r[e]=r[e].trim()),le.nativeTypeAttributes&&(r[e]=Os(r[e])),"attributeValueFn"in le&&(r[e]=le.attributeValueFn(r[e],e,Le)),"attributeNameFn"in le)){var t=r[e];delete r[e],r[le.attributeNameFn(e,r[e],Le)]=t}}return r}function ml(r){var e={};if(r.body&&(r.name.toLowerCase()==="xml"||le.instructionHasAttributes)){for(var t=/([\w:-]+)\s*=\s*(?:"([^"]*)"|'([^']*)'|(\w+))\s*/g,s;(s=t.exec(r.body))!==null;)e[s[1]]=s[2]||s[3]||s[4];e=Bs(e)}if(r.name.toLowerCase()==="xml"){if(le.ignoreDeclaration)return;Le[le.declarationKey]={},Object.keys(e).length&&(Le[le.declarationKey][le.attributesKey]=e),le.addParent&&(Le[le.declarationKey][le.parentKey]=Le)}else{if(le.ignoreInstruction)return;le.trim&&(r.body=r.body.trim());var l={};le.instructionHasAttributes&&Object.keys(e).length?(l[r.name]={},l[r.name][le.attributesKey]=e):l[r.name]=r.body,kr("instruction",l)}}function gl(r,e){var t;if(typeof r=="object"&&(e=r.attributes,r=r.name),e=Bs(e),"elementNameFn"in le&&(r=le.elementNameFn(r,Le)),le.compact){if(t={},!le.ignoreAttributes&&e&&Object.keys(e).length){t[le.attributesKey]={};var s;for(s in e)e.hasOwnProperty(s)&&(t[le.attributesKey][s]=e[s])}!(r in Le)&&(Qt(le.alwaysArray)?le.alwaysArray.indexOf(r)!==-1:le.alwaysArray)&&(Le[r]=[]),Le[r]&&!Qt(Le[r])&&(Le[r]=[Le[r]]),Qt(Le[r])?Le[r].push(t):Le[r]=t}else Le[le.elementsKey]||(Le[le.elementsKey]=[]),t={},t[le.typeKey]="element",t[le.nameKey]=r,!le.ignoreAttributes&&e&&Object.keys(e).length&&(t[le.attributesKey]=e),le.alwaysChildren&&(t[le.elementsKey]=[]),Le[le.elementsKey].push(t);t[le.parentKey]=Le,Le=t}function wl(r){le.ignoreText||!r.trim()&&!le.captureSpacesBetweenElements||(le.trim&&(r=r.trim()),le.nativeType&&(r=Os(r)),le.sanitize&&(r=r.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),kr("text",r))}function yl(r){le.ignoreComment||(le.trim&&(r=r.trim()),kr("comment",r))}function vl(r){var e=Le[le.parentKey];le.addParent||delete Le[le.parentKey],Le=e}function bl(r){le.ignoreCdata||(le.trim&&(r=r.trim()),kr("cdata",r))}function _l(r){le.ignoreDoctype||(r=r.replace(/^ /,""),le.trim&&(r=r.trim()),kr("doctype",r))}function El(r){r.note=r}var Fs=function(r,e){var t=dl.parser(!0,{}),s={};if(Le=s,le=pl(e),t.opt={strictEntities:!0},t.onopentag=gl,t.ontext=wl,t.oncomment=yl,t.onclosetag=vl,t.onerror=El,t.oncdata=bl,t.ondoctype=_l,t.onprocessinginstruction=ml,t.write(r).close(),s[le.elementsKey]){var l=s[le.elementsKey];delete s[le.elementsKey],s[le.elementsKey]=l,delete s.text}return s},ko=_i,xl=Fs;function Tl(r){var e=ko.copyOptions(r);return ko.ensureSpacesExists(e),e}var Al=function(r,e){var t,s,l,i;return t=Tl(e),s=xl(r,t),i="compact"in t&&t.compact?"_parent":"parent","addParent"in t&&t.addParent?l=JSON.stringify(s,function(c,n){return c===i?"_":n},t.spaces):l=JSON.stringify(s,null,t.spaces),l.replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")},Ye=_i,Sl=bi.isArray,ct,ut;function kl(r){var e=Ye.copyOptions(r);return Ye.ensureFlagExists("ignoreDeclaration",e),Ye.ensureFlagExists("ignoreInstruction",e),Ye.ensureFlagExists("ignoreAttributes",e),Ye.ensureFlagExists("ignoreText",e),Ye.ensureFlagExists("ignoreComment",e),Ye.ensureFlagExists("ignoreCdata",e),Ye.ensureFlagExists("ignoreDoctype",e),Ye.ensureFlagExists("compact",e),Ye.ensureFlagExists("indentText",e),Ye.ensureFlagExists("indentCdata",e),Ye.ensureFlagExists("indentAttributes",e),Ye.ensureFlagExists("indentInstruction",e),Ye.ensureFlagExists("fullTagEmptyElement",e),Ye.ensureFlagExists("noQuotesForNativeAttributes",e),Ye.ensureSpacesExists(e),typeof e.spaces=="number"&&(e.spaces=Array(e.spaces+1).join(" ")),Ye.ensureKeyExists("declaration",e),Ye.ensureKeyExists("instruction",e),Ye.ensureKeyExists("attributes",e),Ye.ensureKeyExists("text",e),Ye.ensureKeyExists("comment",e),Ye.ensureKeyExists("cdata",e),Ye.ensureKeyExists("doctype",e),Ye.ensureKeyExists("type",e),Ye.ensureKeyExists("name",e),Ye.ensureKeyExists("elements",e),e}function It(r,e,t){return(!t&&r.spaces?`
`:"")+Array(e+1).join(r.spaces)}function Qr(r,e,t){if(e.ignoreAttributes)return"";"attributesFn"in e&&(r=e.attributesFn(r,ut,ct));var s,l,i,c,n=[];for(s in r)r.hasOwnProperty(s)&&r[s]!==null&&r[s]!==void 0&&(c=e.noQuotesForNativeAttributes&&typeof r[s]!="string"?"":'"',l=""+r[s],l=l.replace(/"/g,"&quot;"),i="attributeNameFn"in e?e.attributeNameFn(s,l,ut,ct):s,n.push(e.spaces&&e.indentAttributes?It(e,t+1,!1):" "),n.push(i+"="+c+("attributeValueFn"in e?e.attributeValueFn(l,s,ut,ct):l)+c));return r&&Object.keys(r).length&&e.spaces&&e.indentAttributes&&n.push(It(e,t,!1)),n.join("")}function Ls(r,e,t){return ct=r,ut="xml",e.ignoreDeclaration?"":"<?xml"+Qr(r[e.attributesKey],e,t)+"?>"}function Ps(r,e,t){if(e.ignoreInstruction)return"";var s;for(s in r)if(r.hasOwnProperty(s))break;var l="instructionNameFn"in e?e.instructionNameFn(s,r[s],ut,ct):s;if(typeof r[s]=="object")return ct=r,ut=l,"<?"+l+Qr(r[s][e.attributesKey],e,t)+"?>";var i=r[s]?r[s]:"";return"instructionFn"in e&&(i=e.instructionFn(i,s,ut,ct)),"<?"+l+(i?" "+i:"")+"?>"}function Us(r,e){return e.ignoreComment?"":"<!--"+("commentFn"in e?e.commentFn(r,ut,ct):r)+"-->"}function Ms(r,e){return e.ignoreCdata?"":"<![CDATA["+("cdataFn"in e?e.cdataFn(r,ut,ct):r.replace("]]>","]]]]><![CDATA[>"))+"]]>"}function js(r,e){return e.ignoreDoctype?"":"<!DOCTYPE "+("doctypeFn"in e?e.doctypeFn(r,ut,ct):r)+">"}function Ei(r,e){return e.ignoreText?"":(r=""+r,r=r.replace(/&amp;/g,"&"),r=r.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"textFn"in e?e.textFn(r,ut,ct):r)}function Cl(r,e){var t;if(r.elements&&r.elements.length)for(t=0;t<r.elements.length;++t)switch(r.elements[t][e.typeKey]){case"text":if(e.indentText)return!0;break;case"cdata":if(e.indentCdata)return!0;break;case"instruction":if(e.indentInstruction)return!0;break;case"doctype":case"comment":case"element":return!0;default:return!0}return!1}function Il(r,e,t){ct=r,ut=r.name;var s=[],l="elementNameFn"in e?e.elementNameFn(r.name,r):r.name;s.push("<"+l),r[e.attributesKey]&&s.push(Qr(r[e.attributesKey],e,t));var i=r[e.elementsKey]&&r[e.elementsKey].length||r[e.attributesKey]&&r[e.attributesKey]["xml:space"]==="preserve";return i||("fullTagEmptyElementFn"in e?i=e.fullTagEmptyElementFn(r.name,r):i=e.fullTagEmptyElement),i?(s.push(">"),r[e.elementsKey]&&r[e.elementsKey].length&&(s.push(zs(r[e.elementsKey],e,t+1)),ct=r,ut=r.name),s.push(e.spaces&&Cl(r,e)?`
`+Array(t+1).join(e.spaces):""),s.push("</"+l+">")):s.push("/>"),s.join("")}function zs(r,e,t,s){return r.reduce(function(l,i){var c=It(e,t,s&&!l);switch(i.type){case"element":return l+c+Il(i,e,t);case"comment":return l+c+Us(i[e.commentKey],e);case"doctype":return l+c+js(i[e.doctypeKey],e);case"cdata":return l+(e.indentCdata?c:"")+Ms(i[e.cdataKey],e);case"text":return l+(e.indentText?c:"")+Ei(i[e.textKey],e);case"instruction":var n={};return n[i[e.nameKey]]=i[e.attributesKey]?i:i[e.instructionKey],l+(e.indentInstruction?c:"")+Ps(n,e,t)}},"")}function Hs(r,e,t){var s;for(s in r)if(r.hasOwnProperty(s))switch(s){case e.parentKey:case e.attributesKey:break;case e.textKey:if(e.indentText||t)return!0;break;case e.cdataKey:if(e.indentCdata||t)return!0;break;case e.instructionKey:if(e.indentInstruction||t)return!0;break;case e.doctypeKey:case e.commentKey:return!0;default:return!0}return!1}function Rl(r,e,t,s,l){ct=r,ut=e;var i="elementNameFn"in t?t.elementNameFn(e,r):e;if(typeof r>"u"||r===null||r==="")return"fullTagEmptyElementFn"in t&&t.fullTagEmptyElementFn(e,r)||t.fullTagEmptyElement?"<"+i+"></"+i+">":"<"+i+"/>";var c=[];if(e){if(c.push("<"+i),typeof r!="object")return c.push(">"+Ei(r,t)+"</"+i+">"),c.join("");r[t.attributesKey]&&c.push(Qr(r[t.attributesKey],t,s));var n=Hs(r,t,!0)||r[t.attributesKey]&&r[t.attributesKey]["xml:space"]==="preserve";if(n||("fullTagEmptyElementFn"in t?n=t.fullTagEmptyElementFn(e,r):n=t.fullTagEmptyElement),n)c.push(">");else return c.push("/>"),c.join("")}return c.push(Ws(r,t,s+1,!1)),ct=r,ut=e,e&&c.push((l?It(t,s,!1):"")+"</"+i+">"),c.join("")}function Ws(r,e,t,s){var l,i,c,n=[];for(i in r)if(r.hasOwnProperty(i))for(c=Sl(r[i])?r[i]:[r[i]],l=0;l<c.length;++l){switch(i){case e.declarationKey:n.push(Ls(c[l],e,t));break;case e.instructionKey:n.push((e.indentInstruction?It(e,t,s):"")+Ps(c[l],e,t));break;case e.attributesKey:case e.parentKey:break;case e.textKey:n.push((e.indentText?It(e,t,s):"")+Ei(c[l],e));break;case e.cdataKey:n.push((e.indentCdata?It(e,t,s):"")+Ms(c[l],e));break;case e.doctypeKey:n.push(It(e,t,s)+js(c[l],e));break;case e.commentKey:n.push(It(e,t,s)+Us(c[l],e));break;default:n.push(It(e,t,s)+Rl(c[l],i,e,t,Hs(c[l],e)))}s=s&&!n.length}return n.join("")}var Gs=function(r,e){e=kl(e);var t=[];return ct=r,ut="_root_",e.compact?t.push(Ws(r,e,0,!0)):(r[e.declarationKey]&&t.push(Ls(r[e.declarationKey],e,0)),r[e.elementsKey]&&r[e.elementsKey].length&&t.push(zs(r[e.elementsKey],e,0,!t.length))),t.join("")},Nl=Gs,Dl=function(r,e){r instanceof Buffer&&(r=r.toString());var t=null;if(typeof r=="string")try{t=JSON.parse(r)}catch{throw new Error("The JSON structure is invalid")}else t=r;return Nl(t,e)},Ol=Fs,Bl=Al,Fl=Gs,Ll=Dl,$s={xml2js:Ol,xml2json:Bl,js2xml:Fl,json2xml:Ll};const xi=r=>{switch(r.type){case void 0:case"element":const e=new Ul(r.name,r.attributes),t=r.elements||[];for(const s of t){const l=xi(s);l!==void 0&&e.push(l)}return e;case"text":return r.text;default:return}};class Pl extends Fe{}class Ul extends ye{static fromXmlString(e){const t=$s.xml2js(e,{compact:!1});return xi(t)}constructor(e,t){super(e),t&&this.root.push(new Pl(t))}push(e){this.root.push(e)}}class Ml extends ye{constructor(e){super(""),this._attr=e}prepForXml(e){return{_attr:this._attr}}}class Vs extends ye{constructor(e,t){super(e),t&&(this.root=t.root)}}const pt=r=>{if(isNaN(r))throw new Error(`Invalid value '${r}' specified. Must be an integer.`);return Math.floor(r)},en=r=>{const e=pt(r);if(e<0)throw new Error(`Invalid value '${r}' specified. Must be a positive integer.`);return e},Ks=(r,e)=>{const t=e*2;if(r.length!==t||isNaN(+`0x${r}`))throw new Error(`Invalid hex value '${r}'. Expected ${t} digit hex value`);return r},Co=r=>Ks(r,1),qs=r=>{const e=r.slice(-2),t=r.substring(0,r.length-2);return`${Number(t)}${e}`},Xs=r=>{const e=qs(r);if(parseFloat(e)<0)throw new Error(`Invalid value '${e}' specified. Expected a positive number.`);return e},ir=r=>{if(r==="auto")return r;const e=r.charAt(0)==="#"?r.substring(1):r;return Ks(e,3)},Wt=r=>typeof r=="string"?qs(r):pt(r),jl=r=>typeof r=="string"?Xs(r):en(r),_t=r=>typeof r=="string"?Xs(r):en(r),zl=en,Hl=en,Wl=r=>r.toISOString();class _e extends ye{constructor(e,t=!0){super(e),t!==!0&&this.root.push(new nt({val:t}))}}class qn extends ye{constructor(e,t){super(e),this.root.push(new nt({val:jl(t)}))}}class er extends ye{constructor(e,t){super(e),this.root.push(new nt({val:t}))}}const _r=(r,e)=>new Pt({name:r,attributes:{value:{key:"w:val",value:e}}});class Ti extends ye{constructor(e,t){super(e),this.root.push(new nt({val:t}))}}class jt extends ye{constructor(e,t){super(e),this.root.push(t)}}class Pt extends ye{constructor({name:e,attributes:t,children:s}){super(e),t&&this.root.push(new Sr(t)),s&&this.root.push(...s)}}const Tt={START:"start",CENTER:"center",END:"end",BOTH:"both",MEDIUM_KASHIDA:"mediumKashida",DISTRIBUTE:"distribute",NUM_TAB:"numTab",HIGH_KASHIDA:"highKashida",LOW_KASHIDA:"lowKashida",THAI_DISTRIBUTE:"thaiDistribute",LEFT:"left",RIGHT:"right",JUSTIFIED:"both"};class Gl extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{val:"w:val"})}}class $l extends ye{constructor(e){super("w:jc"),this.root.push(new Gl({val:e}))}}class et extends ye{constructor(e,{color:t,size:s,space:l,style:i}){super(e),this.root.push(new Vl({style:i,color:t===void 0?void 0:ir(t),size:s===void 0?void 0:zl(s),space:l===void 0?void 0:Hl(l)}))}}class Vl extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{style:"w:val",color:"w:color",size:"w:sz",space:"w:space"})}}const Ai={SINGLE:"single",DASH_DOT_STROKED:"dashDotStroked",DASHED:"dashed",DASH_SMALL_GAP:"dashSmallGap",DOT_DASH:"dotDash",DOT_DOT_DASH:"dotDotDash",DOTTED:"dotted",DOUBLE:"double",DOUBLE_WAVE:"doubleWave",INSET:"inset",NIL:"nil",NONE:"none",OUTSET:"outset",THICK:"thick",THICK_THIN_LARGE_GAP:"thickThinLargeGap",THICK_THIN_MEDIUM_GAP:"thickThinMediumGap",THICK_THIN_SMALL_GAP:"thickThinSmallGap",THIN_THICK_LARGE_GAP:"thinThickLargeGap",THIN_THICK_MEDIUM_GAP:"thinThickMediumGap",THIN_THICK_SMALL_GAP:"thinThickSmallGap",THIN_THICK_THIN_LARGE_GAP:"thinThickThinLargeGap",THIN_THICK_THIN_MEDIUM_GAP:"thinThickThinMediumGap",THIN_THICK_THIN_SMALL_GAP:"thinThickThinSmallGap",THREE_D_EMBOSS:"threeDEmboss",THREE_D_ENGRAVE:"threeDEngrave",TRIPLE:"triple",WAVE:"wave"};class Kl extends Zr{constructor(e){super("w:pBdr"),e.top&&this.root.push(new et("w:top",e.top)),e.bottom&&this.root.push(new et("w:bottom",e.bottom)),e.left&&this.root.push(new et("w:left",e.left)),e.right&&this.root.push(new et("w:right",e.right))}}class ql extends ye{constructor(){super("w:pBdr");const e=new et("w:bottom",{color:"auto",space:1,style:Ai.SINGLE,size:6});this.root.push(e)}}class Xl extends ye{constructor({start:e,end:t,left:s,right:l,hanging:i,firstLine:c}){super("w:ind"),this.root.push(new Sr({start:{key:"w:start",value:e===void 0?void 0:Wt(e)},end:{key:"w:end",value:t===void 0?void 0:Wt(t)},left:{key:"w:left",value:s===void 0?void 0:Wt(s)},right:{key:"w:right",value:l===void 0?void 0:Wt(l)},hanging:{key:"w:hanging",value:i===void 0?void 0:_t(i)},firstLine:{key:"w:firstLine",value:c===void 0?void 0:_t(c)}}))}}let Zl=class extends ye{constructor(){super("w:br")}};const Si={BEGIN:"begin",END:"end",SEPARATE:"separate"};class ki extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{type:"w:fldCharType",dirty:"w:dirty"})}}class Br extends ye{constructor(e){super("w:fldChar"),this.root.push(new ki({type:Si.BEGIN,dirty:e}))}}class Fr extends ye{constructor(e){super("w:fldChar"),this.root.push(new ki({type:Si.SEPARATE,dirty:e}))}}class Lr extends ye{constructor(e){super("w:fldChar"),this.root.push(new ki({type:Si.END,dirty:e}))}}const or={DEFAULT:"default",PRESERVE:"preserve"};class sr extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{space:"xml:space"})}}let Yl=class extends ye{constructor(){super("w:instrText"),this.root.push(new sr({space:or.PRESERVE})),this.root.push("PAGE")}};class Jl extends ye{constructor(){super("w:instrText"),this.root.push(new sr({space:or.PRESERVE})),this.root.push("NUMPAGES")}}class Ql extends ye{constructor(){super("w:instrText"),this.root.push(new sr({space:or.PRESERVE})),this.root.push("SECTIONPAGES")}}class ec extends ye{constructor(){super("w:instrText"),this.root.push(new sr({space:or.PRESERVE})),this.root.push("SECTION")}}class tc extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{fill:"w:fill",color:"w:color",type:"w:val"})}}class Zs extends ye{constructor({fill:e,color:t,type:s}){super("w:shd"),this.root.push(new tc({fill:e===void 0?void 0:ir(e),color:t===void 0?void 0:ir(t),type:s}))}}class rc extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{id:"w:id",author:"w:author",date:"w:date"})}}const nc={DOT:"dot"};class ic extends ye{constructor(e){super("w:em"),this.root.push(new nt({val:e}))}}class oc extends ic{constructor(e=nc.DOT){super(e)}}class sc extends ye{constructor(e){super("w:spacing"),this.root.push(new nt({val:Wt(e)}))}}class ac extends ye{constructor(e){super("w:color"),this.root.push(new nt({val:ir(e)}))}}class lc extends ye{constructor(e){super("w:highlight"),this.root.push(new nt({val:e}))}}class cc extends ye{constructor(e){super("w:highlightCs"),this.root.push(new nt({val:e}))}}const uc=r=>new Pt({name:"w:lang",attributes:{value:{key:"w:val",value:r.value},eastAsia:{key:"w:eastAsia",value:r.eastAsia},bidirectional:{key:"w:bidi",value:r.bidirectional}}});class Io extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{ascii:"w:ascii",cs:"w:cs",eastAsia:"w:eastAsia",hAnsi:"w:hAnsi",hint:"w:hint"})}}class Xn extends ye{constructor(e,t){if(super("w:rFonts"),typeof e=="string"){const s=e;this.root.push(new Io({ascii:s,cs:s,eastAsia:s,hAnsi:s,hint:t}))}else{const s=e;this.root.push(new Io(s))}}}let Ys=class extends ye{constructor(e){super("w:vertAlign"),this.root.push(new nt({val:e}))}};class fc extends Ys{constructor(){super("superscript")}}class hc extends Ys{constructor(){super("subscript")}}const Js={SINGLE:"single",WORDS:"words",DOUBLE:"double",THICK:"thick",DOTTED:"dotted",DOTTEDHEAVY:"dottedHeavy",DASH:"dash",DASHEDHEAVY:"dashedHeavy",DASHLONG:"dashLong",DASHLONGHEAVY:"dashLongHeavy",DOTDASH:"dotDash",DASHDOTHEAVY:"dashDotHeavy",DOTDOTDASH:"dotDotDash",DASHDOTDOTHEAVY:"dashDotDotHeavy",WAVE:"wave",WAVYHEAVY:"wavyHeavy",WAVYDOUBLE:"wavyDouble",NONE:"none"};class dc extends ye{constructor(e=Js.SINGLE,t){super("w:u"),this.root.push(new nt({val:e,color:t===void 0?void 0:ir(t)}))}}class qt extends Zr{constructor(e){var t,s;if(super("w:rPr"),!e)return;e.noProof!==void 0&&this.push(new _e("w:noProof",e.noProof)),e.bold!==void 0&&this.push(new _e("w:b",e.bold)),(e.boldComplexScript===void 0&&e.bold!==void 0||e.boldComplexScript)&&this.push(new _e("w:bCs",(t=e.boldComplexScript)!=null?t:e.bold)),e.italics!==void 0&&this.push(new _e("w:i",e.italics)),(e.italicsComplexScript===void 0&&e.italics!==void 0||e.italicsComplexScript)&&this.push(new _e("w:iCs",(s=e.italicsComplexScript)!=null?s:e.italics)),e.underline&&this.push(new dc(e.underline.type,e.underline.color)),e.effect&&this.push(new er("w:effect",e.effect)),e.emphasisMark&&this.push(new oc(e.emphasisMark.type)),e.color&&this.push(new ac(e.color)),e.kern&&this.push(new qn("w:kern",e.kern)),e.position&&this.push(new er("w:position",e.position)),e.size!==void 0&&this.push(new qn("w:sz",e.size));const l=e.sizeComplexScript===void 0||e.sizeComplexScript===!0?e.size:e.sizeComplexScript;l&&this.push(new qn("w:szCs",l)),e.rightToLeft!==void 0&&this.push(new _e("w:rtl",e.rightToLeft)),e.smallCaps!==void 0?this.push(new _e("w:smallCaps",e.smallCaps)):e.allCaps!==void 0&&this.push(new _e("w:caps",e.allCaps)),e.strike!==void 0&&this.push(new _e("w:strike",e.strike)),e.doubleStrike!==void 0&&this.push(new _e("w:dstrike",e.doubleStrike)),e.subScript&&this.push(new hc),e.superScript&&this.push(new fc),e.style&&this.push(new er("w:rStyle",e.style)),e.font&&(typeof e.font=="string"?this.push(new Xn(e.font)):"name"in e.font?this.push(new Xn(e.font.name,e.font.hint)):this.push(new Xn(e.font))),e.highlight&&this.push(new lc(e.highlight));const i=e.highlightComplexScript===void 0||e.highlightComplexScript===!0?e.highlight:e.highlightComplexScript;i&&this.push(new cc(i)),e.characterSpacing&&this.push(new sc(e.characterSpacing)),e.emboss!==void 0&&this.push(new _e("w:emboss",e.emboss)),e.imprint!==void 0&&this.push(new _e("w:imprint",e.imprint)),e.shading&&this.push(new Zs(e.shading)),e.revision&&this.push(new pc(e.revision)),e.border&&this.push(new et("w:bdr",e.border)),e.snapToGrid!==void 0&&this.push(new _e("w:snapToGrid",e.snapToGrid)),e.vanish&&this.push(new _e("w:vanish",e.vanish)),e.specVanish&&this.push(new _e("w:specVanish",e.vanish)),e.scale!==void 0&&this.push(new Ti("w:w",e.scale)),e.language&&this.push(uc(e.language)),e.math&&this.push(new _e("w:oMath",e.math))}push(e){this.root.push(e)}}class pc extends ye{constructor(e){super("w:rPrChange"),this.root.push(new rc({id:e.id,author:e.author,date:e.date})),this.addChildElement(new qt(e))}}class si extends ye{constructor(e){var t;return super("w:t"),typeof e=="string"?(this.root.push(new sr({space:or.PRESERVE})),this.root.push(e),this):(this.root.push(new sr({space:(t=e.space)!=null?t:or.DEFAULT})),this.root.push(e.text),this)}}const Pr={CURRENT:"CURRENT",TOTAL_PAGES:"TOTAL_PAGES",TOTAL_PAGES_IN_SECTION:"TOTAL_PAGES_IN_SECTION",CURRENT_SECTION:"SECTION"};class tn extends ye{constructor(e){if(super("w:r"),me(this,"properties"),this.properties=new qt(e),this.root.push(this.properties),e.break)for(let t=0;t<e.break;t++)this.root.push(new Zl);if(e.children)for(const t of e.children){if(typeof t=="string"){switch(t){case Pr.CURRENT:this.root.push(new Br),this.root.push(new Yl),this.root.push(new Fr),this.root.push(new Lr);break;case Pr.TOTAL_PAGES:this.root.push(new Br),this.root.push(new Jl),this.root.push(new Fr),this.root.push(new Lr);break;case Pr.TOTAL_PAGES_IN_SECTION:this.root.push(new Br),this.root.push(new Ql),this.root.push(new Fr),this.root.push(new Lr);break;case Pr.CURRENT_SECTION:this.root.push(new Br),this.root.push(new ec),this.root.push(new Fr),this.root.push(new Lr);break;default:this.root.push(new si(t));break}continue}this.root.push(t)}else e.text&&this.root.push(new si(e.text))}}class $r extends tn{constructor(e){if(typeof e=="string")return super({}),this.root.push(new si(e)),this;super(e)}}let mc="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",gc=(r,e=21)=>(t=e)=>{let s="",l=t;for(;l--;)s+=r[Math.random()*r.length|0];return s},wc=(r=21)=>{let e="",t=r;for(;t--;)e+=mc[Math.random()*64|0];return e};const bt=r=>Math.floor(r*72*20),Ci=(r=0)=>{let e=r;return()=>++e},yc=()=>Ci(),vc=()=>Ci(1),bc=()=>Ci(),_c=()=>wc().toLowerCase(),Er=r=>gc("1234567890abcdef",r)(),Ec=()=>`${Er(8)}-${Er(4)}-${Er(4)}-${Er(4)}-${Er(12)}`;class xc extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{id:"w:id",initials:"w:initials",author:"w:author",date:"w:date"})}}class Tc extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{"xmlns:cx":"xmlns:cx","xmlns:cx1":"xmlns:cx1","xmlns:cx2":"xmlns:cx2","xmlns:cx3":"xmlns:cx3","xmlns:cx4":"xmlns:cx4","xmlns:cx5":"xmlns:cx5","xmlns:cx6":"xmlns:cx6","xmlns:cx7":"xmlns:cx7","xmlns:cx8":"xmlns:cx8","xmlns:mc":"xmlns:mc","xmlns:aink":"xmlns:aink","xmlns:am3d":"xmlns:am3d","xmlns:o":"xmlns:o","xmlns:r":"xmlns:r","xmlns:m":"xmlns:m","xmlns:v":"xmlns:v","xmlns:wp14":"xmlns:wp14","xmlns:wp":"xmlns:wp","xmlns:w10":"xmlns:w10","xmlns:w":"xmlns:w","xmlns:w14":"xmlns:w14","xmlns:w15":"xmlns:w15","xmlns:w16cex":"xmlns:w16cex","xmlns:w16cid":"xmlns:w16cid","xmlns:w16":"xmlns:w16","xmlns:w16sdtdh":"xmlns:w16sdtdh","xmlns:w16se":"xmlns:w16se","xmlns:wpg":"xmlns:wpg","xmlns:wpi":"xmlns:wpi","xmlns:wne":"xmlns:wne","xmlns:wps":"xmlns:wps"})}}class Ac extends ye{constructor({id:e,initials:t,author:s,date:l=new Date,children:i}){super("w:comment"),this.root.push(new xc({id:e,initials:t,author:s,date:l.toISOString()}));for(const c of i)this.root.push(c)}}class Sc extends ye{constructor({children:e}){super("w:comments"),this.root.push(new Tc({"xmlns:cx":"http://schemas.microsoft.com/office/drawing/2014/chartex","xmlns:cx1":"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex","xmlns:cx2":"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex","xmlns:cx3":"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex","xmlns:cx4":"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex","xmlns:cx5":"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex","xmlns:cx6":"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex","xmlns:cx7":"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex","xmlns:cx8":"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","xmlns:aink":"http://schemas.microsoft.com/office/drawing/2016/ink","xmlns:am3d":"http://schemas.microsoft.com/office/drawing/2017/model3d","xmlns:o":"urn:schemas-microsoft-com:office:office","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:m":"http://schemas.openxmlformats.org/officeDocument/2006/math","xmlns:v":"urn:schemas-microsoft-com:vml","xmlns:wp14":"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing","xmlns:wp":"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing","xmlns:w10":"urn:schemas-microsoft-com:office:word","xmlns:w":"http://schemas.openxmlformats.org/wordprocessingml/2006/main","xmlns:w14":"http://schemas.microsoft.com/office/word/2010/wordml","xmlns:w15":"http://schemas.microsoft.com/office/word/2012/wordml","xmlns:w16cex":"http://schemas.microsoft.com/office/word/2018/wordml/cex","xmlns:w16cid":"http://schemas.microsoft.com/office/word/2016/wordml/cid","xmlns:w16":"http://schemas.microsoft.com/office/word/2018/wordml","xmlns:w16sdtdh":"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash","xmlns:w16se":"http://schemas.microsoft.com/office/word/2015/wordml/symex","xmlns:wpg":"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup","xmlns:wpi":"http://schemas.microsoft.com/office/word/2010/wordprocessingInk","xmlns:wne":"http://schemas.microsoft.com/office/word/2006/wordml","xmlns:wps":"http://schemas.microsoft.com/office/word/2010/wordprocessingShape"}));for(const t of e)this.root.push(new Ac(t))}}class kc extends ye{constructor(){super("w:pageBreakBefore")}}const ai={AT_LEAST:"atLeast",EXACTLY:"exactly",EXACT:"exact",AUTO:"auto"};class Cc extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{after:"w:after",before:"w:before",line:"w:line",lineRule:"w:lineRule"})}}class Ic extends ye{constructor(e){super("w:spacing"),this.root.push(new Cc(e))}}let Ur=class extends ye{constructor(e){super("w:pStyle"),this.root.push(new nt({val:e}))}};class Rc extends ye{constructor(e){super("w:tabs");for(const t of e)this.root.push(new Dc(t))}}const Ro={LEFT:"left",RIGHT:"right",CENTER:"center",BAR:"bar",CLEAR:"clear",DECIMAL:"decimal",END:"end",NUM:"num",START:"start"};class Nc extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{val:"w:val",pos:"w:pos",leader:"w:leader"})}}class Dc extends ye{constructor({type:e,position:t,leader:s}){super("w:tab"),this.root.push(new Nc({val:e,pos:t,leader:s}))}}class No extends ye{constructor(e,t){super("w:numPr"),this.root.push(new Oc(t)),this.root.push(new Bc(e))}}class Oc extends ye{constructor(e){if(super("w:ilvl"),e>9)throw new Error("Level cannot be greater than 9. Read more here: https://answers.microsoft.com/en-us/msoffice/forum/all/does-word-support-more-than-9-list-levels/d130fdcd-1781-446d-8c84-c6c79124e4d7");this.root.push(new nt({val:e}))}}class Bc extends ye{constructor(e){super("w:numId"),this.root.push(new nt({val:typeof e=="string"?`{${e}}`:e}))}}class Fc extends ye{constructor(){super(...arguments),me(this,"fileChild",Symbol())}}class Lc extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{id:"Id",type:"Type",target:"Target",targetMode:"TargetMode"})}}const Pc={EXTERNAL:"External"};class Uc extends ye{constructor(e,t,s,l){super("Relationship"),this.root.push(new Lc({id:e,type:t,target:s,targetMode:l}))}}class Mc extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{id:"r:id",history:"w:history",anchor:"w:anchor"})}}class jc extends ye{constructor(e,t,s){super("w:hyperlink"),me(this,"linkId"),this.linkId=t;const l={history:1,anchor:s||void 0,id:s?void 0:`rId${this.linkId}`},i=new Mc(l);this.root.push(i),e.forEach(c=>{this.root.push(c)})}}class zc extends ye{constructor(e){super("w:externalHyperlink"),this.options=e}}class Hc extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{id:"w:id",name:"w:name"})}}class Wc extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{id:"w:id"})}}class Gc{constructor(e){me(this,"bookmarkUniqueNumericId",bc()),me(this,"start"),me(this,"children"),me(this,"end");const t=this.bookmarkUniqueNumericId();this.start=new $c(e.id,t),this.children=e.children,this.end=new Vc(t)}}class $c extends ye{constructor(e,t){super("w:bookmarkStart");const s=new Hc({name:e,id:t});this.root.push(s)}}class Vc extends ye{constructor(e){super("w:bookmarkEnd");const t=new Wc({id:e});this.root.push(t)}}class Kc extends ye{constructor(e){super("w:outlineLvl"),this.level=e,this.root.push(new nt({val:e}))}}class qc extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{verticalAlign:"w:val"})}}class Xc extends ye{constructor(e){super("w:vAlign"),this.root.push(new qc({verticalAlign:e}))}}const tr={DEFAULT:"default",FIRST:"first",EVEN:"even"};class Zc extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{type:"w:type",id:"r:id"})}}const Do={HEADER:"w:headerReference",FOOTER:"w:footerReference"};class Zn extends ye{constructor(e,t){super(e),this.root.push(new Zc({type:t.type||tr.DEFAULT,id:`rId${t.id}`}))}}class Yc extends ye{constructor({space:e,count:t,separate:s,equalWidth:l,children:i}){super("w:cols"),this.root.push(new Sr({space:{key:"w:space",value:e===void 0?void 0:_t(e)},count:{key:"w:num",value:t===void 0?void 0:pt(t)},separate:{key:"w:sep",value:s},equalWidth:{key:"w:equalWidth",value:l}})),!l&&i&&i.forEach(c=>this.addChildElement(c))}}class Jc extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{type:"w:type",linePitch:"w:linePitch",charSpace:"w:charSpace"})}}class Qc extends ye{constructor(e,t,s){super("w:docGrid"),this.root.push(new Jc({type:s,linePitch:pt(e),charSpace:t?pt(t):void 0}))}}const eu=({countBy:r,start:e,restart:t,distance:s})=>new Pt({name:"w:lnNumType",attributes:{countBy:{key:"w:countBy",value:r===void 0?void 0:pt(r)},start:{key:"w:start",value:e===void 0?void 0:pt(e)},restart:{key:"w:restart",value:t},distance:{key:"w:distance",value:s===void 0?void 0:_t(s)}}});class Oo extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{display:"w:display",offsetFrom:"w:offsetFrom",zOrder:"w:zOrder"})}}class tu extends Zr{constructor(e){if(super("w:pgBorders"),!e)return this;e.pageBorders?this.root.push(new Oo({display:e.pageBorders.display,offsetFrom:e.pageBorders.offsetFrom,zOrder:e.pageBorders.zOrder})):this.root.push(new Oo({})),e.pageBorderTop&&this.root.push(new et("w:top",e.pageBorderTop)),e.pageBorderLeft&&this.root.push(new et("w:left",e.pageBorderLeft)),e.pageBorderBottom&&this.root.push(new et("w:bottom",e.pageBorderBottom)),e.pageBorderRight&&this.root.push(new et("w:right",e.pageBorderRight))}}class ru extends ye{constructor(e,t,s,l,i,c,n){super("w:pgMar"),this.root.push(new Sr({top:{key:"w:top",value:Wt(e)},right:{key:"w:right",value:_t(t)},bottom:{key:"w:bottom",value:Wt(s)},left:{key:"w:left",value:_t(l)},header:{key:"w:header",value:_t(i)},footer:{key:"w:footer",value:_t(c)},gutter:{key:"w:gutter",value:_t(n)}}))}}class nu extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{start:"w:start",formatType:"w:fmt",separator:"w:chapSep"})}}class iu extends ye{constructor({start:e,formatType:t,separator:s}){super("w:pgNumType"),this.root.push(new nu({start:e===void 0?void 0:pt(e),formatType:t,separator:s}))}}const Qs={PORTRAIT:"portrait",LANDSCAPE:"landscape"};class ou extends ye{constructor(e,t,s){super("w:pgSz");const l=s===Qs.LANDSCAPE,i=_t(e),c=_t(t);this.root.push(new Sr({width:{key:"w:w",value:l?c:i},height:{key:"w:h",value:l?i:c},orientation:{key:"w:orient",value:s}}))}}class su extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{val:"w:val"})}}class au extends ye{constructor(e){super("w:textDirection"),this.root.push(new su({val:e}))}}class lu extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{val:"w:val"})}}class cu extends ye{constructor(e){super("w:type"),this.root.push(new lu({val:e}))}}const zt={TOP:1440,RIGHT:1440,BOTTOM:1440,LEFT:1440,HEADER:708,FOOTER:708,GUTTER:0},Yn={WIDTH:11906,HEIGHT:16838,ORIENTATION:Qs.PORTRAIT};class uu extends ye{constructor({page:{size:{width:e=Yn.WIDTH,height:t=Yn.HEIGHT,orientation:s=Yn.ORIENTATION}={},margin:{top:l=zt.TOP,right:i=zt.RIGHT,bottom:c=zt.BOTTOM,left:n=zt.LEFT,header:u=zt.HEADER,footer:m=zt.FOOTER,gutter:y=zt.GUTTER}={},pageNumbers:b={},borders:T,textDirection:p}={},grid:{linePitch:S=360,charSpace:g,type:x}={},headerWrapperGroup:f={},footerWrapperGroup:_={},lineNumbers:k,titlePage:N,verticalAlign:I,column:X,type:G}={}){super("w:sectPr"),this.addHeaderFooterGroup(Do.HEADER,f),this.addHeaderFooterGroup(Do.FOOTER,_),G&&this.root.push(new cu(G)),this.root.push(new ou(e,t,s)),this.root.push(new ru(l,i,c,n,u,m,y)),T&&this.root.push(new tu(T)),k&&this.root.push(eu(k)),this.root.push(new iu(b)),X&&this.root.push(new Yc(X)),I&&this.root.push(new Xc(I)),N!==void 0&&this.root.push(new _e("w:titlePg",N)),p&&this.root.push(new au(p)),this.root.push(new Qc(S,g,x))}addHeaderFooterGroup(e,t){t.default&&this.root.push(new Zn(e,{type:tr.DEFAULT,id:t.default.View.ReferenceId})),t.first&&this.root.push(new Zn(e,{type:tr.FIRST,id:t.first.View.ReferenceId})),t.even&&this.root.push(new Zn(e,{type:tr.EVEN,id:t.even.View.ReferenceId}))}}class fu extends ye{constructor(){super("w:body"),me(this,"sections",[])}addSection(e){const t=this.sections.pop();this.root.push(this.createSectionParagraph(t)),this.sections.push(new uu(e))}prepForXml(e){return this.sections.length===1&&(this.root.splice(0,1),this.root.push(this.sections.pop())),super.prepForXml(e)}push(e){this.root.push(e)}createSectionParagraph(e){const t=new Ar({}),s=new ar({});return s.push(e),t.addChildElement(s),t}}class Cr extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",Ignorable:"mc:Ignorable",cp:"xmlns:cp",dc:"xmlns:dc",dcterms:"xmlns:dcterms",dcmitype:"xmlns:dcmitype",xsi:"xmlns:xsi",type:"xsi:type",cx:"xmlns:cx",cx1:"xmlns:cx1",cx2:"xmlns:cx2",cx3:"xmlns:cx3",cx4:"xmlns:cx4",cx5:"xmlns:cx5",cx6:"xmlns:cx6",cx7:"xmlns:cx7",cx8:"xmlns:cx8",aink:"xmlns:aink",am3d:"xmlns:am3d",w16cex:"xmlns:w16cex",w16cid:"xmlns:w16cid",w16:"xmlns:w16",w16sdtdh:"xmlns:w16sdtdh",w16se:"xmlns:w16se"})}}class hu extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{color:"w:color",themeColor:"w:themeColor",themeShade:"w:themeShade",themeTint:"w:themeTint"})}}class du extends ye{constructor(e){super("w:background"),this.root.push(new hu({color:e.color===void 0?void 0:ir(e.color),themeColor:e.themeColor,themeShade:e.themeShade===void 0?void 0:Co(e.themeShade),themeTint:e.themeTint===void 0?void 0:Co(e.themeTint)}))}}class pu extends ye{constructor(e){super("w:document"),me(this,"body"),this.root.push(new Cr({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",cx:"http://schemas.microsoft.com/office/drawing/2014/chartex",cx1:"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex",cx2:"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex",cx3:"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex",cx4:"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex",cx5:"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex",cx6:"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex",cx7:"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex",cx8:"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex",aink:"http://schemas.microsoft.com/office/drawing/2016/ink",am3d:"http://schemas.microsoft.com/office/drawing/2017/model3d",w16cex:"http://schemas.microsoft.com/office/word/2018/wordml/cex",w16cid:"http://schemas.microsoft.com/office/word/2016/wordml/cid",w16:"http://schemas.microsoft.com/office/word/2018/wordml",w16sdtdh:"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash",w16se:"http://schemas.microsoft.com/office/word/2015/wordml/symex",Ignorable:"w14 w15 wp14"})),this.body=new fu,e.background&&this.root.push(new du(e.background)),this.root.push(this.body)}add(e){return this.body.push(e),this}get Body(){return this.body}}class mu extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{xmlns:"xmlns"})}}class gr extends ye{constructor(){super("Relationships"),this.root.push(new mu({xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"}))}createRelationship(e,t,s,l){const i=new Uc(`rId${e}`,t,s,l);return this.root.push(i),i}get RelationshipCount(){return this.root.length-1}}class ea{constructor(e){me(this,"document"),me(this,"relationships"),this.document=new pu(e),this.relationships=new gr}get View(){return this.document}get Relationships(){return this.relationships}}class gu extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{val:"w:val"})}}class wu extends ye{constructor(){super("w:wordWrap"),this.root.push(new gu({val:0}))}}const yu=r=>{var e,t;return new Pt({name:"w:framePr",attributes:{anchorLock:{key:"w:anchorLock",value:r.anchorLock},dropCap:{key:"w:dropCap",value:r.dropCap},width:{key:"w:w",value:r.width},height:{key:"w:h",value:r.height},x:{key:"w:x",value:r.position?r.position.x:void 0},y:{key:"w:y",value:r.position?r.position.y:void 0},anchorHorizontal:{key:"w:hAnchor",value:r.anchor.horizontal},anchorVertical:{key:"w:vAnchor",value:r.anchor.vertical},spaceHorizontal:{key:"w:hSpace",value:(e=r.space)==null?void 0:e.horizontal},spaceVertical:{key:"w:vSpace",value:(t=r.space)==null?void 0:t.vertical},rule:{key:"w:hRule",value:r.rule},alignmentX:{key:"w:xAlign",value:r.alignment?r.alignment.x:void 0},alignmentY:{key:"w:yAlign",value:r.alignment?r.alignment.y:void 0},lines:{key:"w:lines",value:r.lines},wrap:{key:"w:wrap",value:r.wrap}}})};class ar extends Zr{constructor(e){var t,s;if(super("w:pPr"),me(this,"numberingReferences",[]),!e)return this;e.heading&&this.push(new Ur(e.heading)),e.bullet&&this.push(new Ur("ListParagraph")),e.numbering&&!e.style&&!e.heading&&(e.numbering.custom||this.push(new Ur("ListParagraph"))),e.style&&this.push(new Ur(e.style)),e.keepNext!==void 0&&this.push(new _e("w:keepNext",e.keepNext)),e.keepLines!==void 0&&this.push(new _e("w:keepLines",e.keepLines)),e.pageBreakBefore&&this.push(new kc),e.frame&&this.push(yu(e.frame)),e.widowControl!==void 0&&this.push(new _e("w:widowControl",e.widowControl)),e.bullet&&this.push(new No(1,e.bullet.level)),e.numbering&&(this.numberingReferences.push({reference:e.numbering.reference,instance:(t=e.numbering.instance)!=null?t:0}),this.push(new No(`${e.numbering.reference}-${(s=e.numbering.instance)!=null?s:0}`,e.numbering.level))),e.border&&this.push(new Kl(e.border)),e.thematicBreak&&this.push(new ql),e.shading&&this.push(new Zs(e.shading)),e.wordWrap&&this.push(new wu),e.overflowPunctuation&&this.push(new _e("w:overflowPunct",e.overflowPunctuation));const l=[...e.rightTabStop!==void 0?[{type:Ro.RIGHT,position:e.rightTabStop}]:[],...e.tabStops?e.tabStops:[],...e.leftTabStop!==void 0?[{type:Ro.LEFT,position:e.leftTabStop}]:[]];l.length>0&&this.push(new Rc(l)),e.bidirectional!==void 0&&this.push(new _e("w:bidi",e.bidirectional)),e.spacing&&this.push(new Ic(e.spacing)),e.indent&&this.push(new Xl(e.indent)),e.contextualSpacing!==void 0&&this.push(new _e("w:contextualSpacing",e.contextualSpacing)),e.alignment&&this.push(new $l(e.alignment)),e.outlineLevel!==void 0&&this.push(new Kc(e.outlineLevel)),e.suppressLineNumbers!==void 0&&this.push(new _e("w:suppressLineNumbers",e.suppressLineNumbers)),e.autoSpaceEastAsianText!==void 0&&this.push(new _e("w:autoSpaceDN",e.autoSpaceEastAsianText)),e.run&&this.push(new qt(e.run))}push(e){this.root.push(e)}prepForXml(e){if(e.viewWrapper instanceof ea)for(const t of this.numberingReferences)e.file.Numbering.createConcreteNumberingInstance(t.reference,t.instance);return super.prepForXml(e)}}class Ar extends Fc{constructor(e){if(super("w:p"),me(this,"properties"),typeof e=="string")return this.properties=new ar({}),this.root.push(this.properties),this.root.push(new $r(e)),this;if(this.properties=new ar(e),this.root.push(this.properties),e.text&&this.root.push(new $r(e.text)),e.children)for(const t of e.children){if(t instanceof Gc){this.root.push(t.start);for(const s of t.children)this.root.push(s);this.root.push(t.end);continue}this.root.push(t)}}prepForXml(e){for(const t of this.root)if(t instanceof zc){const s=this.root.indexOf(t),l=new jc(t.options.children,_c());e.viewWrapper.Relationships.createRelationship(l.linkId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",t.options.link,Pc.EXTERNAL),this.root[s]=l}return super.prepForXml(e)}addRunToFront(e){return this.root.splice(1,0,e),this}}const Xt={style:Ai.NONE,size:0,color:"auto"},Zt={style:Ai.SINGLE,size:4,color:"auto"};class vu extends ye{constructor(e){super("w:tblBorders"),e.top?this.root.push(new et("w:top",e.top)):this.root.push(new et("w:top",Zt)),e.left?this.root.push(new et("w:left",e.left)):this.root.push(new et("w:left",Zt)),e.bottom?this.root.push(new et("w:bottom",e.bottom)):this.root.push(new et("w:bottom",Zt)),e.right?this.root.push(new et("w:right",e.right)):this.root.push(new et("w:right",Zt)),e.insideHorizontal?this.root.push(new et("w:insideH",e.insideHorizontal)):this.root.push(new et("w:insideH",Zt)),e.insideVertical?this.root.push(new et("w:insideV",e.insideVertical)):this.root.push(new et("w:insideV",Zt))}}me(vu,"NONE",{top:Xt,bottom:Xt,left:Xt,right:Xt,insideHorizontal:Xt,insideVertical:Xt});class bu extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{xmlns:"xmlns",vt:"xmlns:vt"})}}class _u extends ye{constructor(){super("Properties"),this.root.push(new bu({xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"}))}}class Eu extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{xmlns:"xmlns"})}}class xu extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{contentType:"ContentType",extension:"Extension"})}}class Ft extends ye{constructor(e,t){super("Default"),this.root.push(new xu({contentType:e,extension:t}))}}class Tu extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{contentType:"ContentType",partName:"PartName"})}}class wt extends ye{constructor(e,t){super("Override"),this.root.push(new Tu({contentType:e,partName:t}))}}class Au extends ye{constructor(){super("Types"),this.root.push(new Eu({xmlns:"http://schemas.openxmlformats.org/package/2006/content-types"})),this.root.push(new Ft("image/png","png")),this.root.push(new Ft("image/jpeg","jpeg")),this.root.push(new Ft("image/jpeg","jpg")),this.root.push(new Ft("image/bmp","bmp")),this.root.push(new Ft("image/gif","gif")),this.root.push(new Ft("application/vnd.openxmlformats-package.relationships+xml","rels")),this.root.push(new Ft("application/xml","xml")),this.root.push(new Ft("application/vnd.openxmlformats-officedocument.obfuscatedFont","odttf")),this.root.push(new wt("application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml","/word/document.xml")),this.root.push(new wt("application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml","/word/styles.xml")),this.root.push(new wt("application/vnd.openxmlformats-package.core-properties+xml","/docProps/core.xml")),this.root.push(new wt("application/vnd.openxmlformats-officedocument.custom-properties+xml","/docProps/custom.xml")),this.root.push(new wt("application/vnd.openxmlformats-officedocument.extended-properties+xml","/docProps/app.xml")),this.root.push(new wt("application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml","/word/numbering.xml")),this.root.push(new wt("application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml","/word/footnotes.xml")),this.root.push(new wt("application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml","/word/settings.xml")),this.root.push(new wt("application/vnd.openxmlformats-officedocument.wordprocessingml.comments+xml","/word/comments.xml")),this.root.push(new wt("application/vnd.openxmlformats-officedocument.wordprocessingml.fontTable+xml","/word/fontTable.xml"))}addFooter(e){this.root.push(new wt("application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml",`/word/footer${e}.xml`))}addHeader(e){this.root.push(new wt("application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml",`/word/header${e}.xml`))}}class Su extends ye{constructor(e){super("cp:coreProperties"),this.root.push(new Cr({cp:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",xsi:"http://www.w3.org/2001/XMLSchema-instance"})),e.title&&this.root.push(new jt("dc:title",e.title)),e.subject&&this.root.push(new jt("dc:subject",e.subject)),e.creator&&this.root.push(new jt("dc:creator",e.creator)),e.keywords&&this.root.push(new jt("cp:keywords",e.keywords)),e.description&&this.root.push(new jt("dc:description",e.description)),e.lastModifiedBy&&this.root.push(new jt("cp:lastModifiedBy",e.lastModifiedBy)),e.revision&&this.root.push(new jt("cp:revision",String(e.revision))),this.root.push(new Bo("dcterms:created")),this.root.push(new Bo("dcterms:modified"))}}class Bo extends ye{constructor(e){super(e),this.root.push(new Cr({type:"dcterms:W3CDTF"})),this.root.push(Wl(new Date))}}class ku extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{xmlns:"xmlns",vt:"xmlns:vt"})}}class Cu extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{fmtid:"fmtid",pid:"pid",name:"name"})}}class Iu extends ye{constructor(e,t){super("property"),this.root.push(new Cu({fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:e.toString(),name:t.name})),this.root.push(new Ru(t.value))}}class Ru extends ye{constructor(e){super("vt:lpwstr"),this.root.push(e)}}class Nu extends ye{constructor(e){super("Properties"),me(this,"nextId"),me(this,"properties",[]),this.root.push(new ku({xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"})),this.nextId=2;for(const t of e)this.addCustomProperty(t)}prepForXml(e){return this.properties.forEach(t=>this.root.push(t)),super.prepForXml(e)}addCustomProperty(e){this.properties.push(new Iu(this.nextId++,e))}}class Du extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",cp:"xmlns:cp",dc:"xmlns:dc",dcterms:"xmlns:dcterms",dcmitype:"xmlns:dcmitype",xsi:"xmlns:xsi",type:"xsi:type"})}}let Ou=class extends Vs{constructor(e,t){super("w:ftr",t),me(this,"refId"),this.refId=e,t||this.root.push(new Du({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape"}))}get ReferenceId(){return this.refId}add(e){this.root.push(e)}};class Bu{constructor(e,t,s){me(this,"footer"),me(this,"relationships"),this.media=e,this.footer=new Ou(t,s),this.relationships=new gr}add(e){this.footer.add(e)}addChildElement(e){this.footer.addChildElement(e)}get View(){return this.footer}get Relationships(){return this.relationships}get Media(){return this.media}}class Fu extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{type:"w:type",id:"w:id"})}}class Lu extends ye{constructor(){super("w:footnoteRef")}}class Pu extends tn{constructor(){super({style:"FootnoteReference"}),this.root.push(new Lu)}}const Fo={SEPERATOR:"separator",CONTINUATION_SEPERATOR:"continuationSeparator"};class Jn extends ye{constructor(e){super("w:footnote"),this.root.push(new Fu({type:e.type,id:e.id}));for(let t=0;t<e.children.length;t++){const s=e.children[t];t===0&&s.addRunToFront(new Pu),this.root.push(s)}}}class Uu extends ye{constructor(){super("w:continuationSeparator")}}class Mu extends tn{constructor(){super({}),this.root.push(new Uu)}}class ju extends ye{constructor(){super("w:separator")}}class zu extends tn{constructor(){super({}),this.root.push(new ju)}}class Hu extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",Ignorable:"mc:Ignorable"})}}class Wu extends ye{constructor(){super("w:footnotes"),this.root.push(new Hu({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",Ignorable:"w14 w15 wp14"}));const e=new Jn({id:-1,type:Fo.SEPERATOR,children:[new Ar({spacing:{after:0,line:240,lineRule:ai.AUTO},children:[new zu]})]});this.root.push(e);const t=new Jn({id:0,type:Fo.CONTINUATION_SEPERATOR,children:[new Ar({spacing:{after:0,line:240,lineRule:ai.AUTO},children:[new Mu]})]});this.root.push(t)}createFootNote(e,t){const s=new Jn({id:e,children:t});this.root.push(s)}}class Gu{constructor(){me(this,"footnotess"),me(this,"relationships"),this.footnotess=new Wu,this.relationships=new gr}get View(){return this.footnotess}get Relationships(){return this.relationships}}class $u extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",cp:"xmlns:cp",dc:"xmlns:dc",dcterms:"xmlns:dcterms",dcmitype:"xmlns:dcmitype",xsi:"xmlns:xsi",type:"xsi:type",cx:"xmlns:cx",cx1:"xmlns:cx1",cx2:"xmlns:cx2",cx3:"xmlns:cx3",cx4:"xmlns:cx4",cx5:"xmlns:cx5",cx6:"xmlns:cx6",cx7:"xmlns:cx7",cx8:"xmlns:cx8",w16cid:"xmlns:w16cid",w16se:"xmlns:w16se"})}}let Vu=class extends Vs{constructor(e,t){super("w:hdr",t),me(this,"refId"),this.refId=e,t||this.root.push(new $u({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",cx:"http://schemas.microsoft.com/office/drawing/2014/chartex",cx1:"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex",cx2:"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex",cx3:"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex",cx4:"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex",cx5:"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex",cx6:"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex",cx7:"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex",cx8:"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex",w16cid:"http://schemas.microsoft.com/office/word/2016/wordml/cid",w16se:"http://schemas.microsoft.com/office/word/2015/wordml/symex"}))}get ReferenceId(){return this.refId}add(e){this.root.push(e)}};class Ku{constructor(e,t,s){me(this,"header"),me(this,"relationships"),this.media=e,this.header=new Vu(t,s),this.relationships=new gr}add(e){return this.header.add(e),this}addChildElement(e){this.header.addChildElement(e)}get View(){return this.header}get Relationships(){return this.relationships}get Media(){return this.media}}class qu{constructor(){me(this,"map"),this.map=new Map}addImage(e,t){this.map.set(e,t)}get Array(){return Array.from(this.map.values())}}const Dt={DECIMAL:"decimal",UPPER_ROMAN:"upperRoman",LOWER_ROMAN:"lowerRoman",UPPER_LETTER:"upperLetter",LOWER_LETTER:"lowerLetter",ORDINAL:"ordinal",CARDINAL_TEXT:"cardinalText",ORDINAL_TEXT:"ordinalText",HEX:"hex",CHICAGO:"chicago",IDEOGRAPH__DIGITAL:"ideographDigital",JAPANESE_COUNTING:"japaneseCounting",AIUEO:"aiueo",IROHA:"iroha",DECIMAL_FULL_WIDTH:"decimalFullWidth",DECIMAL_HALF_WIDTH:"decimalHalfWidth",JAPANESE_LEGAL:"japaneseLegal",JAPANESE_DIGITAL_TEN_THOUSAND:"japaneseDigitalTenThousand",DECIMAL_ENCLOSED_CIRCLE:"decimalEnclosedCircle",DECIMAL_FULL_WIDTH2:"decimalFullWidth2",AIUEO_FULL_WIDTH:"aiueoFullWidth",IROHA_FULL_WIDTH:"irohaFullWidth",DECIMAL_ZERO:"decimalZero",BULLET:"bullet",GANADA:"ganada",CHOSUNG:"chosung",DECIMAL_ENCLOSED_FULLSTOP:"decimalEnclosedFullstop",DECIMAL_ENCLOSED_PARENTHESES:"decimalEnclosedParen",DECIMAL_ENCLOSED_CIRCLE_CHINESE:"decimalEnclosedCircleChinese",IDEOGRAPH_ENCLOSED_CIRCLE:"ideographEnclosedCircle",IDEOGRAPH_TRADITIONAL:"ideographTraditional",IDEOGRAPH_ZODIAC:"ideographZodiac",IDEOGRAPH_ZODIAC_TRADITIONAL:"ideographZodiacTraditional",TAIWANESE_COUNTING:"taiwaneseCounting",IDEOGRAPH_LEGAL_TRADITIONAL:"ideographLegalTraditional",TAIWANESE_COUNTING_THOUSAND:"taiwaneseCountingThousand",TAIWANESE_DIGITAL:"taiwaneseDigital",CHINESE_COUNTING:"chineseCounting",CHINESE_LEGAL_SIMPLIFIED:"chineseLegalSimplified",CHINESE_COUNTING_THOUSAND:"chineseCountingThousand",KOREAN_DIGITAL:"koreanDigital",KOREAN_COUNTING:"koreanCounting",KOREAN_LEGAL:"koreanLegal",KOREAN_DIGITAL2:"koreanDigital2",VIETNAMESE_COUNTING:"vietnameseCounting",RUSSIAN_LOWER:"russianLower",RUSSIAN_UPPER:"russianUpper",NONE:"none",NUMBER_IN_DASH:"numberInDash",HEBREW1:"hebrew1",HEBREW2:"hebrew2",ARABIC_ALPHA:"arabicAlpha",ARABIC_ABJAD:"arabicAbjad",HINDI_VOWELS:"hindiVowels",HINDI_CONSONANTS:"hindiConsonants",HINDI_NUMBERS:"hindiNumbers",HINDI_COUNTING:"hindiCounting",THAI_LETTERS:"thaiLetters",THAI_NUMBERS:"thaiNumbers",THAI_COUNTING:"thaiCounting",BAHT_TEXT:"bahtText",DOLLAR_TEXT:"dollarText",CUSTOM:"custom"};class Xu extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{ilvl:"w:ilvl",tentative:"w15:tentative"})}}class Zu extends ye{constructor(e){super("w:numFmt"),this.root.push(new nt({val:e}))}}class Yu extends ye{constructor(e){super("w:lvlText"),this.root.push(new nt({val:e}))}}class Ju extends ye{constructor(e){super("w:lvlJc"),this.root.push(new nt({val:e}))}}class Qu extends ye{constructor(e){super("w:suff"),this.root.push(new nt({val:e}))}}class ef extends ye{constructor(){super("w:isLgl")}}class tf extends ye{constructor({level:e,format:t,text:s,alignment:l=Tt.START,start:i=1,style:c,suffix:n,isLegalNumberingStyle:u}){if(super("w:lvl"),me(this,"paragraphProperties"),me(this,"runProperties"),this.root.push(new Ti("w:start",pt(i))),t&&this.root.push(new Zu(t)),n&&this.root.push(new Qu(n)),u&&this.root.push(new ef),s&&this.root.push(new Yu(s)),this.root.push(new Ju(l)),this.paragraphProperties=new ar(c&&c.paragraph),this.runProperties=new qt(c&&c.run),this.root.push(this.paragraphProperties),this.root.push(this.runProperties),e>9)throw new Error("Level cannot be greater than 9. Read more here: https://answers.microsoft.com/en-us/msoffice/forum/all/does-word-support-more-than-9-list-levels/d130fdcd-1781-446d-8c84-c6c79124e4d7");this.root.push(new Xu({ilvl:pt(e),tentative:1}))}}class rf extends tf{}class nf extends ye{constructor(e){super("w:multiLevelType"),this.root.push(new nt({val:e}))}}class of extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{abstractNumId:"w:abstractNumId",restartNumberingAfterBreak:"w15:restartNumberingAfterBreak"})}}class Lo extends ye{constructor(e,t){super("w:abstractNum"),me(this,"id"),this.root.push(new of({abstractNumId:pt(e),restartNumberingAfterBreak:0})),this.root.push(new nf("hybridMultilevel")),this.id=e;for(const s of t)this.root.push(new rf(s))}}class sf extends ye{constructor(e){super("w:abstractNumId"),this.root.push(new nt({val:e}))}}class af extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{numId:"w:numId"})}}class Po extends ye{constructor(e){if(super("w:num"),me(this,"numId"),me(this,"reference"),me(this,"instance"),this.numId=e.numId,this.reference=e.reference,this.instance=e.instance,this.root.push(new af({numId:pt(e.numId)})),this.root.push(new sf(pt(e.abstractNumId))),e.overrideLevels&&e.overrideLevels.length)for(const t of e.overrideLevels)this.root.push(new cf(t.num,t.start))}}class lf extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{ilvl:"w:ilvl"})}}class cf extends ye{constructor(e,t){super("w:lvlOverride"),this.root.push(new lf({ilvl:e})),t!==void 0&&this.root.push(new ff(t))}}class uf extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{val:"w:val"})}}class ff extends ye{constructor(e){super("w:startOverride"),this.root.push(new uf({val:e}))}}class hf extends ye{constructor(e){super("w:numbering"),me(this,"abstractNumberingMap",new Map),me(this,"concreteNumberingMap",new Map),me(this,"referenceConfigMap",new Map),me(this,"abstractNumUniqueNumericId",yc()),me(this,"concreteNumUniqueNumericId",vc()),this.root.push(new Cr({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",Ignorable:"w14 w15 wp14"}));const t=new Lo(this.abstractNumUniqueNumericId(),[{level:0,format:Dt.BULLET,text:"",alignment:Tt.LEFT,style:{paragraph:{indent:{left:bt(.5),hanging:bt(.25)}}}},{level:1,format:Dt.BULLET,text:"",alignment:Tt.LEFT,style:{paragraph:{indent:{left:bt(1),hanging:bt(.25)}}}},{level:2,format:Dt.BULLET,text:"",alignment:Tt.LEFT,style:{paragraph:{indent:{left:2160,hanging:bt(.25)}}}},{level:3,format:Dt.BULLET,text:"",alignment:Tt.LEFT,style:{paragraph:{indent:{left:2880,hanging:bt(.25)}}}},{level:4,format:Dt.BULLET,text:"",alignment:Tt.LEFT,style:{paragraph:{indent:{left:3600,hanging:bt(.25)}}}},{level:5,format:Dt.BULLET,text:"",alignment:Tt.LEFT,style:{paragraph:{indent:{left:4320,hanging:bt(.25)}}}},{level:6,format:Dt.BULLET,text:"",alignment:Tt.LEFT,style:{paragraph:{indent:{left:5040,hanging:bt(.25)}}}},{level:7,format:Dt.BULLET,text:"",alignment:Tt.LEFT,style:{paragraph:{indent:{left:5760,hanging:bt(.25)}}}},{level:8,format:Dt.BULLET,text:"",alignment:Tt.LEFT,style:{paragraph:{indent:{left:6480,hanging:bt(.25)}}}}]);this.concreteNumberingMap.set("default-bullet-numbering",new Po({numId:1,abstractNumId:t.id,reference:"default-bullet-numbering",instance:0,overrideLevels:[{num:0,start:1}]})),this.abstractNumberingMap.set("default-bullet-numbering",t);for(const s of e.config)this.abstractNumberingMap.set(s.reference,new Lo(this.abstractNumUniqueNumericId(),s.levels)),this.referenceConfigMap.set(s.reference,s.levels)}prepForXml(e){for(const t of this.abstractNumberingMap.values())this.root.push(t);for(const t of this.concreteNumberingMap.values())this.root.push(t);return super.prepForXml(e)}createConcreteNumberingInstance(e,t){const s=this.abstractNumberingMap.get(e);if(!s)return;const l=`${e}-${t}`;if(this.concreteNumberingMap.has(l))return;const i=this.referenceConfigMap.get(e),c=i&&i[0].start,n={numId:this.concreteNumUniqueNumericId(),abstractNumId:s.id,reference:e,instance:t,overrideLevels:[c&&Number.isInteger(c)?{num:0,start:c}:{num:0,start:1}]};this.concreteNumberingMap.set(l,new Po(n))}get ConcreteNumbering(){return Array.from(this.concreteNumberingMap.values())}get ReferenceConfig(){return Array.from(this.referenceConfigMap.values())}}class df extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{version:"w:val",name:"w:name",uri:"w:uri"})}}class pf extends ye{constructor(e){super("w:compatSetting"),this.root.push(new df({version:e,uri:"http://schemas.microsoft.com/office/word",name:"compatibilityMode"}))}}class mf extends ye{constructor(e){super("w:compat"),e.version&&this.root.push(new pf(e.version)),e.useSingleBorderforContiguousCells&&this.root.push(new _e("w:useSingleBorderforContiguousCells",e.useSingleBorderforContiguousCells)),e.wordPerfectJustification&&this.root.push(new _e("w:wpJustification",e.wordPerfectJustification)),e.noTabStopForHangingIndent&&this.root.push(new _e("w:noTabHangInd",e.noTabStopForHangingIndent)),e.noLeading&&this.root.push(new _e("w:noLeading",e.noLeading)),e.spaceForUnderline&&this.root.push(new _e("w:spaceForUL",e.spaceForUnderline)),e.noColumnBalance&&this.root.push(new _e("w:noColumnBalance",e.noColumnBalance)),e.balanceSingleByteDoubleByteWidth&&this.root.push(new _e("w:balanceSingleByteDoubleByteWidth",e.balanceSingleByteDoubleByteWidth)),e.noExtraLineSpacing&&this.root.push(new _e("w:noExtraLineSpacing",e.noExtraLineSpacing)),e.doNotLeaveBackslashAlone&&this.root.push(new _e("w:doNotLeaveBackslashAlone",e.doNotLeaveBackslashAlone)),e.underlineTrailingSpaces&&this.root.push(new _e("w:ulTrailSpace",e.underlineTrailingSpaces)),e.doNotExpandShiftReturn&&this.root.push(new _e("w:doNotExpandShiftReturn",e.doNotExpandShiftReturn)),e.spacingInWholePoints&&this.root.push(new _e("w:spacingInWholePoints",e.spacingInWholePoints)),e.lineWrapLikeWord6&&this.root.push(new _e("w:lineWrapLikeWord6",e.lineWrapLikeWord6)),e.printBodyTextBeforeHeader&&this.root.push(new _e("w:printBodyTextBeforeHeader",e.printBodyTextBeforeHeader)),e.printColorsBlack&&this.root.push(new _e("w:printColBlack",e.printColorsBlack)),e.spaceWidth&&this.root.push(new _e("w:wpSpaceWidth",e.spaceWidth)),e.showBreaksInFrames&&this.root.push(new _e("w:showBreaksInFrames",e.showBreaksInFrames)),e.subFontBySize&&this.root.push(new _e("w:subFontBySize",e.subFontBySize)),e.suppressBottomSpacing&&this.root.push(new _e("w:suppressBottomSpacing",e.suppressBottomSpacing)),e.suppressTopSpacing&&this.root.push(new _e("w:suppressTopSpacing",e.suppressTopSpacing)),e.suppressSpacingAtTopOfPage&&this.root.push(new _e("w:suppressSpacingAtTopOfPage",e.suppressSpacingAtTopOfPage)),e.suppressTopSpacingWP&&this.root.push(new _e("w:suppressTopSpacingWP",e.suppressTopSpacingWP)),e.suppressSpBfAfterPgBrk&&this.root.push(new _e("w:suppressSpBfAfterPgBrk",e.suppressSpBfAfterPgBrk)),e.swapBordersFacingPages&&this.root.push(new _e("w:swapBordersFacingPages",e.swapBordersFacingPages)),e.convertMailMergeEsc&&this.root.push(new _e("w:convMailMergeEsc",e.convertMailMergeEsc)),e.truncateFontHeightsLikeWP6&&this.root.push(new _e("w:truncateFontHeightsLikeWP6",e.truncateFontHeightsLikeWP6)),e.macWordSmallCaps&&this.root.push(new _e("w:mwSmallCaps",e.macWordSmallCaps)),e.usePrinterMetrics&&this.root.push(new _e("w:usePrinterMetrics",e.usePrinterMetrics)),e.doNotSuppressParagraphBorders&&this.root.push(new _e("w:doNotSuppressParagraphBorders",e.doNotSuppressParagraphBorders)),e.wrapTrailSpaces&&this.root.push(new _e("w:wrapTrailSpaces",e.wrapTrailSpaces)),e.footnoteLayoutLikeWW8&&this.root.push(new _e("w:footnoteLayoutLikeWW8",e.footnoteLayoutLikeWW8)),e.shapeLayoutLikeWW8&&this.root.push(new _e("w:shapeLayoutLikeWW8",e.shapeLayoutLikeWW8)),e.alignTablesRowByRow&&this.root.push(new _e("w:alignTablesRowByRow",e.alignTablesRowByRow)),e.forgetLastTabAlignment&&this.root.push(new _e("w:forgetLastTabAlignment",e.forgetLastTabAlignment)),e.adjustLineHeightInTable&&this.root.push(new _e("w:adjustLineHeightInTable",e.adjustLineHeightInTable)),e.autoSpaceLikeWord95&&this.root.push(new _e("w:autoSpaceLikeWord95",e.autoSpaceLikeWord95)),e.noSpaceRaiseLower&&this.root.push(new _e("w:noSpaceRaiseLower",e.noSpaceRaiseLower)),e.doNotUseHTMLParagraphAutoSpacing&&this.root.push(new _e("w:doNotUseHTMLParagraphAutoSpacing",e.doNotUseHTMLParagraphAutoSpacing)),e.layoutRawTableWidth&&this.root.push(new _e("w:layoutRawTableWidth",e.layoutRawTableWidth)),e.layoutTableRowsApart&&this.root.push(new _e("w:layoutTableRowsApart",e.layoutTableRowsApart)),e.useWord97LineBreakRules&&this.root.push(new _e("w:useWord97LineBreakRules",e.useWord97LineBreakRules)),e.doNotBreakWrappedTables&&this.root.push(new _e("w:doNotBreakWrappedTables",e.doNotBreakWrappedTables)),e.doNotSnapToGridInCell&&this.root.push(new _e("w:doNotSnapToGridInCell",e.doNotSnapToGridInCell)),e.selectFieldWithFirstOrLastCharacter&&this.root.push(new _e("w:selectFldWithFirstOrLastChar",e.selectFieldWithFirstOrLastCharacter)),e.applyBreakingRules&&this.root.push(new _e("w:applyBreakingRules",e.applyBreakingRules)),e.doNotWrapTextWithPunctuation&&this.root.push(new _e("w:doNotWrapTextWithPunct",e.doNotWrapTextWithPunctuation)),e.doNotUseEastAsianBreakRules&&this.root.push(new _e("w:doNotUseEastAsianBreakRules",e.doNotUseEastAsianBreakRules)),e.useWord2002TableStyleRules&&this.root.push(new _e("w:useWord2002TableStyleRules",e.useWord2002TableStyleRules)),e.growAutofit&&this.root.push(new _e("w:growAutofit",e.growAutofit)),e.useFELayout&&this.root.push(new _e("w:useFELayout",e.useFELayout)),e.useNormalStyleForList&&this.root.push(new _e("w:useNormalStyleForList",e.useNormalStyleForList)),e.doNotUseIndentAsNumberingTabStop&&this.root.push(new _e("w:doNotUseIndentAsNumberingTabStop",e.doNotUseIndentAsNumberingTabStop)),e.useAlternateEastAsianLineBreakRules&&this.root.push(new _e("w:useAltKinsokuLineBreakRules",e.useAlternateEastAsianLineBreakRules)),e.allowSpaceOfSameStyleInTable&&this.root.push(new _e("w:allowSpaceOfSameStyleInTable",e.allowSpaceOfSameStyleInTable)),e.doNotSuppressIndentation&&this.root.push(new _e("w:doNotSuppressIndentation",e.doNotSuppressIndentation)),e.doNotAutofitConstrainedTables&&this.root.push(new _e("w:doNotAutofitConstrainedTables",e.doNotAutofitConstrainedTables)),e.autofitToFirstFixedWidthCell&&this.root.push(new _e("w:autofitToFirstFixedWidthCell",e.autofitToFirstFixedWidthCell)),e.underlineTabInNumberingList&&this.root.push(new _e("w:underlineTabInNumList",e.underlineTabInNumberingList)),e.displayHangulFixedWidth&&this.root.push(new _e("w:displayHangulFixedWidth",e.displayHangulFixedWidth)),e.splitPgBreakAndParaMark&&this.root.push(new _e("w:splitPgBreakAndParaMark",e.splitPgBreakAndParaMark)),e.doNotVerticallyAlignCellWithSp&&this.root.push(new _e("w:doNotVertAlignCellWithSp",e.doNotVerticallyAlignCellWithSp)),e.doNotBreakConstrainedForcedTable&&this.root.push(new _e("w:doNotBreakConstrainedForcedTable",e.doNotBreakConstrainedForcedTable)),e.ignoreVerticalAlignmentInTextboxes&&this.root.push(new _e("w:doNotVertAlignInTxbx",e.ignoreVerticalAlignmentInTextboxes)),e.useAnsiKerningPairs&&this.root.push(new _e("w:useAnsiKerningPairs",e.useAnsiKerningPairs)),e.cachedColumnBalance&&this.root.push(new _e("w:cachedColBalance",e.cachedColumnBalance))}}class gf extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",Ignorable:"mc:Ignorable"})}}class wf extends ye{constructor(e){var t,s,l,i;super("w:settings"),this.root.push(new gf({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",Ignorable:"w14 w15 wp14"})),this.root.push(new _e("w:displayBackgroundShape",!0)),e.trackRevisions!==void 0&&this.root.push(new _e("w:trackRevisions",e.trackRevisions)),e.evenAndOddHeaders!==void 0&&this.root.push(new _e("w:evenAndOddHeaders",e.evenAndOddHeaders)),e.updateFields!==void 0&&this.root.push(new _e("w:updateFields",e.updateFields)),e.defaultTabStop!==void 0&&this.root.push(new Ti("w:defaultTabStop",e.defaultTabStop)),this.root.push(new mf(Tr(ze({},(t=e.compatibility)!=null?t:{}),{version:(i=(l=(s=e.compatibility)==null?void 0:s.version)!=null?l:e.compatibilityModeVersion)!=null?i:15})))}}class ta extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{val:"w:val"})}}class yf extends ye{constructor(e){super("w:name"),this.root.push(new ta({val:e}))}}class vf extends ye{constructor(e){super("w:uiPriority"),this.root.push(new ta({val:pt(e)}))}}class bf extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{type:"w:type",styleId:"w:styleId",default:"w:default",customStyle:"w:customStyle"})}}class ra extends ye{constructor(e,t){super("w:style"),this.root.push(new bf(e)),t.name&&this.root.push(new yf(t.name)),t.basedOn&&this.root.push(new er("w:basedOn",t.basedOn)),t.next&&this.root.push(new er("w:next",t.next)),t.link&&this.root.push(new er("w:link",t.link)),t.uiPriority!==void 0&&this.root.push(new vf(t.uiPriority)),t.semiHidden!==void 0&&this.root.push(new _e("w:semiHidden",t.semiHidden)),t.unhideWhenUsed!==void 0&&this.root.push(new _e("w:unhideWhenUsed",t.unhideWhenUsed)),t.quickFormat!==void 0&&this.root.push(new _e("w:qFormat",t.quickFormat))}}class rn extends ra{constructor(e){super({type:"paragraph",styleId:e.id},e),me(this,"paragraphProperties"),me(this,"runProperties"),this.paragraphProperties=new ar(e.paragraph),this.runProperties=new qt(e.run),this.root.push(this.paragraphProperties),this.root.push(this.runProperties)}}class nn extends ra{constructor(e){super({type:"character",styleId:e.id},ze({uiPriority:99,unhideWhenUsed:!0},e)),me(this,"runProperties"),this.runProperties=new qt(e.run),this.root.push(this.runProperties)}}class Ut extends rn{constructor(e){super(ze({basedOn:"Normal",next:"Normal",quickFormat:!0},e))}}class _f extends Ut{constructor(e){super(ze({id:"Title",name:"Title"},e))}}class Ef extends Ut{constructor(e){super(ze({id:"Heading1",name:"Heading 1"},e))}}class xf extends Ut{constructor(e){super(ze({id:"Heading2",name:"Heading 2"},e))}}class Tf extends Ut{constructor(e){super(ze({id:"Heading3",name:"Heading 3"},e))}}class Af extends Ut{constructor(e){super(ze({id:"Heading4",name:"Heading 4"},e))}}class Sf extends Ut{constructor(e){super(ze({id:"Heading5",name:"Heading 5"},e))}}class kf extends Ut{constructor(e){super(ze({id:"Heading6",name:"Heading 6"},e))}}class Cf extends Ut{constructor(e){super(ze({id:"Strong",name:"Strong"},e))}}class If extends rn{constructor(e){super(ze({id:"ListParagraph",name:"List Paragraph",basedOn:"Normal",quickFormat:!0},e))}}class Rf extends rn{constructor(e){super(ze({id:"FootnoteText",name:"footnote text",link:"FootnoteTextChar",basedOn:"Normal",uiPriority:99,semiHidden:!0,unhideWhenUsed:!0,paragraph:{spacing:{after:0,line:240,lineRule:ai.AUTO}},run:{size:20}},e))}}class Nf extends nn{constructor(e){super(ze({id:"FootnoteReference",name:"footnote reference",basedOn:"DefaultParagraphFont",semiHidden:!0,run:{superScript:!0}},e))}}class Df extends nn{constructor(e){super(ze({id:"FootnoteTextChar",name:"Footnote Text Char",basedOn:"DefaultParagraphFont",link:"FootnoteText",semiHidden:!0,run:{size:20}},e))}}class Of extends nn{constructor(e){super(ze({id:"Hyperlink",name:"Hyperlink",basedOn:"DefaultParagraphFont",run:{color:"0563C1",underline:{type:Js.SINGLE}}},e))}}class li extends ye{constructor(e){if(super("w:styles"),e.initialStyles&&this.root.push(e.initialStyles),e.importedStyles)for(const t of e.importedStyles)this.root.push(t);if(e.paragraphStyles)for(const t of e.paragraphStyles)this.root.push(new rn(t));if(e.characterStyles)for(const t of e.characterStyles)this.root.push(new nn(t))}}class Bf extends ye{constructor(e){super("w:pPrDefault"),this.root.push(new ar(e))}}class Ff extends ye{constructor(e){super("w:rPrDefault"),this.root.push(new qt(e))}}class Lf extends ye{constructor(e){super("w:docDefaults"),me(this,"runPropertiesDefaults"),me(this,"paragraphPropertiesDefaults"),this.runPropertiesDefaults=new Ff(e.run),this.paragraphPropertiesDefaults=new Bf(e.paragraph),this.root.push(this.runPropertiesDefaults),this.root.push(this.paragraphPropertiesDefaults)}}class Pf{newInstance(e){const t=$s.xml2js(e,{compact:!1});let s;for(const c of t.elements||[])c.name==="w:styles"&&(s=c);if(s===void 0)throw new Error("can not find styles element");const l=s.elements||[];return new li({initialStyles:new Ml(s.attributes),importedStyles:l.map(c=>xi(c))})}}class Uo{newInstance(e={}){var t;return{initialStyles:new Cr({mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",Ignorable:"w14 w15"}),importedStyles:[new Lf((t=e.document)!=null?t:{}),new _f(ze({run:{size:56}},e.title)),new Ef(ze({run:{color:"2E74B5",size:32}},e.heading1)),new xf(ze({run:{color:"2E74B5",size:26}},e.heading2)),new Tf(ze({run:{color:"1F4D78",size:24}},e.heading3)),new Af(ze({run:{color:"2E74B5",italics:!0}},e.heading4)),new Sf(ze({run:{color:"2E74B5"}},e.heading5)),new kf(ze({run:{color:"1F4D78"}},e.heading6)),new Cf(ze({run:{bold:!0}},e.strong)),new If(e.listParagraph||{}),new Of(e.hyperlink||{}),new Nf(e.footnoteReference||{}),new Rf(e.footnoteText||{}),new Df(e.footnoteTextChar||{})]}}}const Mr=({id:r,fontKey:e,subsetted:t},s)=>new Pt({name:s,attributes:ze({id:{key:"r:id",value:r}},e?{fontKey:{key:"w:fontKey",value:`{${e}}`}}:{}),children:[...t?[new _e("w:subsetted",t)]:[]]}),Uf=({name:r,altName:e,panose1:t,charset:s,family:l,notTrueType:i,pitch:c,sig:n,embedRegular:u,embedBold:m,embedItalic:y,embedBoldItalic:b})=>new Pt({name:"w:font",attributes:{name:{key:"w:name",value:r}},children:[...e?[_r("w:altName",e)]:[],...t?[_r("w:panose1",t)]:[],...s?[_r("w:charset",s)]:[],...l?[_r("w:family",l)]:[],...i?[new _e("w:notTrueType",i)]:[],...c?[_r("w:pitch",c)]:[],...n?[new Pt({name:"w:sig",attributes:{usb0:{key:"w:usb0",value:n.usb0},usb1:{key:"w:usb1",value:n.usb1},usb2:{key:"w:usb2",value:n.usb2},usb3:{key:"w:usb3",value:n.usb3},csb0:{key:"w:csb0",value:n.csb0},csb1:{key:"w:csb1",value:n.csb1}}})]:[],...u?[Mr(u,"w:embedRegular")]:[],...m?[Mr(m,"w:embedBold")]:[],...y?[Mr(y,"w:embedItalic")]:[],...b?[Mr(b,"w:embedBoldItalic")]:[]]}),Mf=({name:r,index:e,fontKey:t,characterSet:s})=>Uf({name:r,sig:{usb0:"E0002AFF",usb1:"C000247B",usb2:"00000009",usb3:"00000000",csb0:"000001FF",csb1:"00000000"},charset:s,family:"auto",pitch:"variable",embedRegular:{fontKey:t,id:`rId${e}`}}),jf=r=>new Pt({name:"w:fonts",attributes:{mc:{key:"xmlns:mc",value:"http://schemas.openxmlformats.org/markup-compatibility/2006"},r:{key:"xmlns:r",value:"http://schemas.openxmlformats.org/officeDocument/2006/relationships"},w:{key:"xmlns:w",value:"http://schemas.openxmlformats.org/wordprocessingml/2006/main"},w14:{key:"xmlns:w14",value:"http://schemas.microsoft.com/office/word/2010/wordml"},w15:{key:"xmlns:w15",value:"http://schemas.microsoft.com/office/word/2012/wordml"},w16cex:{key:"xmlns:w16cex",value:"http://schemas.microsoft.com/office/word/2018/wordml/cex"},w16cid:{key:"xmlns:w16cid",value:"http://schemas.microsoft.com/office/word/2016/wordml/cid"},w16:{key:"xmlns:w16",value:"http://schemas.microsoft.com/office/word/2018/wordml"},w16sdtdh:{key:"xmlns:w16sdtdh",value:"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash"},w16se:{key:"xmlns:w16se",value:"http://schemas.microsoft.com/office/word/2015/wordml/symex"},Ignorable:{key:"mc:Ignorable",value:"w14 w15 w16se w16cid w16 w16cex w16sdtdh"}},children:r.map((e,t)=>Mf({name:e.name,index:t+1,fontKey:e.fontKey}))});class zf{constructor(e){me(this,"fontTable"),me(this,"relationships"),me(this,"fontOptionsWithKey",[]),this.options=e,this.fontOptionsWithKey=e.map(t=>Tr(ze({},t),{fontKey:Ec()})),this.fontTable=jf(this.fontOptionsWithKey),this.relationships=new gr;for(let t=0;t<e.length;t++)this.relationships.createRelationship(t+1,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/font",`fonts/${e[t].name}.odttf`)}get View(){return this.fontTable}get Relationships(){return this.relationships}}class Hf{constructor(e){me(this,"currentRelationshipId",1),me(this,"documentWrapper"),me(this,"headers",[]),me(this,"footers",[]),me(this,"coreProperties"),me(this,"numbering"),me(this,"media"),me(this,"fileRelationships"),me(this,"footnotesWrapper"),me(this,"settings"),me(this,"contentTypes"),me(this,"customProperties"),me(this,"appProperties"),me(this,"styles"),me(this,"comments"),me(this,"fontWrapper");var t,s,l,i,c,n,u,m;if(this.coreProperties=new Su(Tr(ze({},e),{creator:(t=e.creator)!=null?t:"Un-named",revision:(s=e.revision)!=null?s:1,lastModifiedBy:(l=e.lastModifiedBy)!=null?l:"Un-named"})),this.numbering=new hf(e.numbering?e.numbering:{config:[]}),this.comments=new Sc((i=e.comments)!=null?i:{children:[]}),this.fileRelationships=new gr,this.customProperties=new Nu((c=e.customProperties)!=null?c:[]),this.appProperties=new _u,this.footnotesWrapper=new Gu,this.contentTypes=new Au,this.documentWrapper=new ea({background:e.background}),this.settings=new wf({compatibilityModeVersion:e.compatabilityModeVersion,compatibility:e.compatibility,evenAndOddHeaders:!!e.evenAndOddHeaderAndFooters,trackRevisions:(n=e.features)==null?void 0:n.trackRevisions,updateFields:(u=e.features)==null?void 0:u.updateFields,defaultTabStop:e.defaultTabStop}),this.media=new qu,e.externalStyles){const y=new Pf;this.styles=y.newInstance(e.externalStyles)}else if(e.styles){const b=new Uo().newInstance(e.styles.default);this.styles=new li(ze(ze({},b),e.styles))}else{const y=new Uo;this.styles=new li(y.newInstance())}this.addDefaultRelationships();for(const y of e.sections)this.addSection(y);if(e.footnotes)for(const y in e.footnotes)this.footnotesWrapper.View.createFootNote(parseFloat(y),e.footnotes[y].children);this.fontWrapper=new zf((m=e.fonts)!=null?m:[])}addSection({headers:e={},footers:t={},children:s,properties:l}){this.documentWrapper.View.Body.addSection(Tr(ze({},l),{headerWrapperGroup:{default:e.default?this.createHeader(e.default):void 0,first:e.first?this.createHeader(e.first):void 0,even:e.even?this.createHeader(e.even):void 0},footerWrapperGroup:{default:t.default?this.createFooter(t.default):void 0,first:t.first?this.createFooter(t.first):void 0,even:t.even?this.createFooter(t.even):void 0}}));for(const i of s)this.documentWrapper.View.add(i)}createHeader(e){const t=new Ku(this.media,this.currentRelationshipId++);for(const s of e.options.children)t.add(s);return this.addHeaderToDocument(t),t}createFooter(e){const t=new Bu(this.media,this.currentRelationshipId++);for(const s of e.options.children)t.add(s);return this.addFooterToDocument(t),t}addHeaderToDocument(e,t=tr.DEFAULT){this.headers.push({header:e,type:t}),this.documentWrapper.Relationships.createRelationship(e.View.ReferenceId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/header",`header${this.headers.length}.xml`),this.contentTypes.addHeader(this.headers.length)}addFooterToDocument(e,t=tr.DEFAULT){this.footers.push({footer:e,type:t}),this.documentWrapper.Relationships.createRelationship(e.View.ReferenceId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer",`footer${this.footers.length}.xml`),this.contentTypes.addFooter(this.footers.length)}addDefaultRelationships(){this.fileRelationships.createRelationship(1,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument","word/document.xml"),this.fileRelationships.createRelationship(2,"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties","docProps/core.xml"),this.fileRelationships.createRelationship(3,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties","docProps/app.xml"),this.fileRelationships.createRelationship(4,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties","docProps/custom.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles","styles.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/numbering","numbering.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes","footnotes.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings","settings.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments","comments.xml")}get Document(){return this.documentWrapper}get Styles(){return this.styles}get CoreProperties(){return this.coreProperties}get Numbering(){return this.numbering}get Media(){return this.media}get FileRelationships(){return this.fileRelationships}get Headers(){return this.headers.map(e=>e.header)}get Footers(){return this.footers.map(e=>e.footer)}get ContentTypes(){return this.contentTypes}get CustomProperties(){return this.customProperties}get AppProperties(){return this.appProperties}get FootNotes(){return this.footnotesWrapper}get Settings(){return this.settings}get Comments(){return this.comments}get FontTable(){return this.fontWrapper}}function jr(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var na={exports:{}};(function(r,e){(function(t){r.exports=t()})(function(){return function t(s,l,i){function c(m,y){if(!l[m]){if(!s[m]){var b=typeof jr=="function"&&jr;if(!y&&b)return b(m,!0);if(n)return n(m,!0);var T=new Error("Cannot find module '"+m+"'");throw T.code="MODULE_NOT_FOUND",T}var p=l[m]={exports:{}};s[m][0].call(p.exports,function(S){var g=s[m][1][S];return c(g||S)},p,p.exports,t,s,l,i)}return l[m].exports}for(var n=typeof jr=="function"&&jr,u=0;u<i.length;u++)c(i[u]);return c}({1:[function(t,s,l){var i=t("./utils"),c=t("./support"),n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";l.encode=function(u){for(var m,y,b,T,p,S,g,x=[],f=0,_=u.length,k=_,N=i.getTypeOf(u)!=="string";f<u.length;)k=_-f,b=N?(m=u[f++],y=f<_?u[f++]:0,f<_?u[f++]:0):(m=u.charCodeAt(f++),y=f<_?u.charCodeAt(f++):0,f<_?u.charCodeAt(f++):0),T=m>>2,p=(3&m)<<4|y>>4,S=1<k?(15&y)<<2|b>>6:64,g=2<k?63&b:64,x.push(n.charAt(T)+n.charAt(p)+n.charAt(S)+n.charAt(g));return x.join("")},l.decode=function(u){var m,y,b,T,p,S,g=0,x=0,f="data:";if(u.substr(0,f.length)===f)throw new Error("Invalid base64 input, it looks like a data url.");var _,k=3*(u=u.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(u.charAt(u.length-1)===n.charAt(64)&&k--,u.charAt(u.length-2)===n.charAt(64)&&k--,k%1!=0)throw new Error("Invalid base64 input, bad content length.");for(_=c.uint8array?new Uint8Array(0|k):new Array(0|k);g<u.length;)m=n.indexOf(u.charAt(g++))<<2|(T=n.indexOf(u.charAt(g++)))>>4,y=(15&T)<<4|(p=n.indexOf(u.charAt(g++)))>>2,b=(3&p)<<6|(S=n.indexOf(u.charAt(g++))),_[x++]=m,p!==64&&(_[x++]=y),S!==64&&(_[x++]=b);return _}},{"./support":30,"./utils":32}],2:[function(t,s,l){var i=t("./external"),c=t("./stream/DataWorker"),n=t("./stream/Crc32Probe"),u=t("./stream/DataLengthProbe");function m(y,b,T,p,S){this.compressedSize=y,this.uncompressedSize=b,this.crc32=T,this.compression=p,this.compressedContent=S}m.prototype={getContentWorker:function(){var y=new c(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new u("data_length")),b=this;return y.on("end",function(){if(this.streamInfo.data_length!==b.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),y},getCompressedWorker:function(){return new c(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},m.createWorkerFrom=function(y,b,T){return y.pipe(new n).pipe(new u("uncompressedSize")).pipe(b.compressWorker(T)).pipe(new u("compressedSize")).withStreamInfo("compression",b)},s.exports=m},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,s,l){var i=t("./stream/GenericWorker");l.STORE={magic:"\0\0",compressWorker:function(){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},l.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,s,l){var i=t("./utils"),c=function(){for(var n,u=[],m=0;m<256;m++){n=m;for(var y=0;y<8;y++)n=1&n?3988292384^n>>>1:n>>>1;u[m]=n}return u}();s.exports=function(n,u){return n!==void 0&&n.length?i.getTypeOf(n)!=="string"?function(m,y,b,T){var p=c,S=T+b;m^=-1;for(var g=T;g<S;g++)m=m>>>8^p[255&(m^y[g])];return-1^m}(0|u,n,n.length,0):function(m,y,b,T){var p=c,S=T+b;m^=-1;for(var g=T;g<S;g++)m=m>>>8^p[255&(m^y.charCodeAt(g))];return-1^m}(0|u,n,n.length,0):0}},{"./utils":32}],5:[function(t,s,l){l.base64=!1,l.binary=!1,l.dir=!1,l.createFolders=!0,l.date=null,l.compression=null,l.compressionOptions=null,l.comment=null,l.unixPermissions=null,l.dosPermissions=null},{}],6:[function(t,s,l){var i=null;i=typeof Promise<"u"?Promise:t("lie"),s.exports={Promise:i}},{lie:37}],7:[function(t,s,l){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",c=t("pako"),n=t("./utils"),u=t("./stream/GenericWorker"),m=i?"uint8array":"array";function y(b,T){u.call(this,"FlateWorker/"+b),this._pako=null,this._pakoAction=b,this._pakoOptions=T,this.meta={}}l.magic="\b\0",n.inherits(y,u),y.prototype.processChunk=function(b){this.meta=b.meta,this._pako===null&&this._createPako(),this._pako.push(n.transformTo(m,b.data),!1)},y.prototype.flush=function(){u.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},y.prototype.cleanUp=function(){u.prototype.cleanUp.call(this),this._pako=null},y.prototype._createPako=function(){this._pako=new c[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var b=this;this._pako.onData=function(T){b.push({data:T,meta:b.meta})}},l.compressWorker=function(b){return new y("Deflate",b)},l.uncompressWorker=function(){return new y("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,s,l){function i(p,S){var g,x="";for(g=0;g<S;g++)x+=String.fromCharCode(255&p),p>>>=8;return x}function c(p,S,g,x,f,_){var k,N,I=p.file,X=p.compression,G=_!==m.utf8encode,Z=n.transformTo("string",_(I.name)),C=n.transformTo("string",m.utf8encode(I.name)),ce=I.comment,ge=n.transformTo("string",_(ce)),R=n.transformTo("string",m.utf8encode(ce)),H=C.length!==I.name.length,A=R.length!==ce.length,j="",oe="",V="",we=I.dir,Y=I.date,ee={crc32:0,compressedSize:0,uncompressedSize:0};S&&!g||(ee.crc32=p.crc32,ee.compressedSize=p.compressedSize,ee.uncompressedSize=p.uncompressedSize);var M=0;S&&(M|=8),G||!H&&!A||(M|=2048);var O=0,K=0;we&&(O|=16),f==="UNIX"?(K=798,O|=function(ie,z){var v=ie;return ie||(v=z?16893:33204),(65535&v)<<16}(I.unixPermissions,we)):(K=20,O|=function(ie){return 63&(ie||0)}(I.dosPermissions)),k=Y.getUTCHours(),k<<=6,k|=Y.getUTCMinutes(),k<<=5,k|=Y.getUTCSeconds()/2,N=Y.getUTCFullYear()-1980,N<<=4,N|=Y.getUTCMonth()+1,N<<=5,N|=Y.getUTCDate(),H&&(oe=i(1,1)+i(y(Z),4)+C,j+="up"+i(oe.length,2)+oe),A&&(V=i(1,1)+i(y(ge),4)+R,j+="uc"+i(V.length,2)+V);var q="";return q+=`
\0`,q+=i(M,2),q+=X.magic,q+=i(k,2),q+=i(N,2),q+=i(ee.crc32,4),q+=i(ee.compressedSize,4),q+=i(ee.uncompressedSize,4),q+=i(Z.length,2),q+=i(j.length,2),{fileRecord:b.LOCAL_FILE_HEADER+q+Z+j,dirRecord:b.CENTRAL_FILE_HEADER+i(K,2)+q+i(ge.length,2)+"\0\0\0\0"+i(O,4)+i(x,4)+Z+j+ge}}var n=t("../utils"),u=t("../stream/GenericWorker"),m=t("../utf8"),y=t("../crc32"),b=t("../signature");function T(p,S,g,x){u.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=S,this.zipPlatform=g,this.encodeFileName=x,this.streamFiles=p,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}n.inherits(T,u),T.prototype.push=function(p){var S=p.meta.percent||0,g=this.entriesCount,x=this._sources.length;this.accumulate?this.contentBuffer.push(p):(this.bytesWritten+=p.data.length,u.prototype.push.call(this,{data:p.data,meta:{currentFile:this.currentFile,percent:g?(S+100*(g-x-1))/g:100}}))},T.prototype.openedSource=function(p){this.currentSourceOffset=this.bytesWritten,this.currentFile=p.file.name;var S=this.streamFiles&&!p.file.dir;if(S){var g=c(p,S,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:g.fileRecord,meta:{percent:0}})}else this.accumulate=!0},T.prototype.closedSource=function(p){this.accumulate=!1;var S=this.streamFiles&&!p.file.dir,g=c(p,S,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(g.dirRecord),S)this.push({data:function(x){return b.DATA_DESCRIPTOR+i(x.crc32,4)+i(x.compressedSize,4)+i(x.uncompressedSize,4)}(p),meta:{percent:100}});else for(this.push({data:g.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},T.prototype.flush=function(){for(var p=this.bytesWritten,S=0;S<this.dirRecords.length;S++)this.push({data:this.dirRecords[S],meta:{percent:100}});var g=this.bytesWritten-p,x=function(f,_,k,N,I){var X=n.transformTo("string",I(N));return b.CENTRAL_DIRECTORY_END+"\0\0\0\0"+i(f,2)+i(f,2)+i(_,4)+i(k,4)+i(X.length,2)+X}(this.dirRecords.length,g,p,this.zipComment,this.encodeFileName);this.push({data:x,meta:{percent:100}})},T.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},T.prototype.registerPrevious=function(p){this._sources.push(p);var S=this;return p.on("data",function(g){S.processChunk(g)}),p.on("end",function(){S.closedSource(S.previous.streamInfo),S._sources.length?S.prepareNextSource():S.end()}),p.on("error",function(g){S.error(g)}),this},T.prototype.resume=function(){return!!u.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},T.prototype.error=function(p){var S=this._sources;if(!u.prototype.error.call(this,p))return!1;for(var g=0;g<S.length;g++)try{S[g].error(p)}catch{}return!0},T.prototype.lock=function(){u.prototype.lock.call(this);for(var p=this._sources,S=0;S<p.length;S++)p[S].lock()},s.exports=T},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,s,l){var i=t("../compressions"),c=t("./ZipFileWorker");l.generateWorker=function(n,u,m){var y=new c(u.streamFiles,m,u.platform,u.encodeFileName),b=0;try{n.forEach(function(T,p){b++;var S=function(_,k){var N=_||k,I=i[N];if(!I)throw new Error(N+" is not a valid compression method !");return I}(p.options.compression,u.compression),g=p.options.compressionOptions||u.compressionOptions||{},x=p.dir,f=p.date;p._compressWorker(S,g).withStreamInfo("file",{name:T,dir:x,date:f,comment:p.comment||"",unixPermissions:p.unixPermissions,dosPermissions:p.dosPermissions}).pipe(y)}),y.entriesCount=b}catch(T){y.error(T)}return y}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,s,l){function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var c=new i;for(var n in this)typeof this[n]!="function"&&(c[n]=this[n]);return c}}(i.prototype=t("./object")).loadAsync=t("./load"),i.support=t("./support"),i.defaults=t("./defaults"),i.version="3.10.1",i.loadAsync=function(c,n){return new i().loadAsync(c,n)},i.external=t("./external"),s.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,s,l){var i=t("./utils"),c=t("./external"),n=t("./utf8"),u=t("./zipEntries"),m=t("./stream/Crc32Probe"),y=t("./nodejsUtils");function b(T){return new c.Promise(function(p,S){var g=T.decompressed.getContentWorker().pipe(new m);g.on("error",function(x){S(x)}).on("end",function(){g.streamInfo.crc32!==T.decompressed.crc32?S(new Error("Corrupted zip : CRC32 mismatch")):p()}).resume()})}s.exports=function(T,p){var S=this;return p=i.extend(p||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:n.utf8decode}),y.isNode&&y.isStream(T)?c.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",T,!0,p.optimizedBinaryString,p.base64).then(function(g){var x=new u(p);return x.load(g),x}).then(function(g){var x=[c.Promise.resolve(g)],f=g.files;if(p.checkCRC32)for(var _=0;_<f.length;_++)x.push(b(f[_]));return c.Promise.all(x)}).then(function(g){for(var x=g.shift(),f=x.files,_=0;_<f.length;_++){var k=f[_],N=k.fileNameStr,I=i.resolve(k.fileNameStr);S.file(I,k.decompressed,{binary:!0,optimizedBinaryString:!0,date:k.date,dir:k.dir,comment:k.fileCommentStr.length?k.fileCommentStr:null,unixPermissions:k.unixPermissions,dosPermissions:k.dosPermissions,createFolders:p.createFolders}),k.dir||(S.file(I).unsafeOriginalName=N)}return x.zipComment.length&&(S.comment=x.zipComment),S})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,s,l){var i=t("../utils"),c=t("../stream/GenericWorker");function n(u,m){c.call(this,"Nodejs stream input adapter for "+u),this._upstreamEnded=!1,this._bindStream(m)}i.inherits(n,c),n.prototype._bindStream=function(u){var m=this;(this._stream=u).pause(),u.on("data",function(y){m.push({data:y,meta:{percent:0}})}).on("error",function(y){m.isPaused?this.generatedError=y:m.error(y)}).on("end",function(){m.isPaused?m._upstreamEnded=!0:m.end()})},n.prototype.pause=function(){return!!c.prototype.pause.call(this)&&(this._stream.pause(),!0)},n.prototype.resume=function(){return!!c.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},s.exports=n},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,s,l){var i=t("readable-stream").Readable;function c(n,u,m){i.call(this,u),this._helper=n;var y=this;n.on("data",function(b,T){y.push(b)||y._helper.pause(),m&&m(T)}).on("error",function(b){y.emit("error",b)}).on("end",function(){y.push(null)})}t("../utils").inherits(c,i),c.prototype._read=function(){this._helper.resume()},s.exports=c},{"../utils":32,"readable-stream":16}],14:[function(t,s,l){s.exports={isNode:typeof Buffer<"u",newBufferFrom:function(i,c){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(i,c);if(typeof i=="number")throw new Error('The "data" argument must not be a number');return new Buffer(i,c)},allocBuffer:function(i){if(Buffer.alloc)return Buffer.alloc(i);var c=new Buffer(i);return c.fill(0),c},isBuffer:function(i){return Buffer.isBuffer(i)},isStream:function(i){return i&&typeof i.on=="function"&&typeof i.pause=="function"&&typeof i.resume=="function"}}},{}],15:[function(t,s,l){function i(I,X,G){var Z,C=n.getTypeOf(X),ce=n.extend(G||{},y);ce.date=ce.date||new Date,ce.compression!==null&&(ce.compression=ce.compression.toUpperCase()),typeof ce.unixPermissions=="string"&&(ce.unixPermissions=parseInt(ce.unixPermissions,8)),ce.unixPermissions&&16384&ce.unixPermissions&&(ce.dir=!0),ce.dosPermissions&&16&ce.dosPermissions&&(ce.dir=!0),ce.dir&&(I=f(I)),ce.createFolders&&(Z=x(I))&&_.call(this,Z,!0);var ge=C==="string"&&ce.binary===!1&&ce.base64===!1;G&&G.binary!==void 0||(ce.binary=!ge),(X instanceof b&&X.uncompressedSize===0||ce.dir||!X||X.length===0)&&(ce.base64=!1,ce.binary=!0,X="",ce.compression="STORE",C="string");var R=null;R=X instanceof b||X instanceof u?X:S.isNode&&S.isStream(X)?new g(I,X):n.prepareContent(I,X,ce.binary,ce.optimizedBinaryString,ce.base64);var H=new T(I,R,ce);this.files[I]=H}var c=t("./utf8"),n=t("./utils"),u=t("./stream/GenericWorker"),m=t("./stream/StreamHelper"),y=t("./defaults"),b=t("./compressedObject"),T=t("./zipObject"),p=t("./generate"),S=t("./nodejsUtils"),g=t("./nodejs/NodejsStreamInputAdapter"),x=function(I){I.slice(-1)==="/"&&(I=I.substring(0,I.length-1));var X=I.lastIndexOf("/");return 0<X?I.substring(0,X):""},f=function(I){return I.slice(-1)!=="/"&&(I+="/"),I},_=function(I,X){return X=X!==void 0?X:y.createFolders,I=f(I),this.files[I]||i.call(this,I,null,{dir:!0,createFolders:X}),this.files[I]};function k(I){return Object.prototype.toString.call(I)==="[object RegExp]"}var N={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(I){var X,G,Z;for(X in this.files)Z=this.files[X],(G=X.slice(this.root.length,X.length))&&X.slice(0,this.root.length)===this.root&&I(G,Z)},filter:function(I){var X=[];return this.forEach(function(G,Z){I(G,Z)&&X.push(Z)}),X},file:function(I,X,G){if(arguments.length!==1)return I=this.root+I,i.call(this,I,X,G),this;if(k(I)){var Z=I;return this.filter(function(ce,ge){return!ge.dir&&Z.test(ce)})}var C=this.files[this.root+I];return C&&!C.dir?C:null},folder:function(I){if(!I)return this;if(k(I))return this.filter(function(C,ce){return ce.dir&&I.test(C)});var X=this.root+I,G=_.call(this,X),Z=this.clone();return Z.root=G.name,Z},remove:function(I){I=this.root+I;var X=this.files[I];if(X||(I.slice(-1)!=="/"&&(I+="/"),X=this.files[I]),X&&!X.dir)delete this.files[I];else for(var G=this.filter(function(C,ce){return ce.name.slice(0,I.length)===I}),Z=0;Z<G.length;Z++)delete this.files[G[Z].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(I){var X,G={};try{if((G=n.extend(I||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:c.utf8encode})).type=G.type.toLowerCase(),G.compression=G.compression.toUpperCase(),G.type==="binarystring"&&(G.type="string"),!G.type)throw new Error("No output type specified.");n.checkSupport(G.type),G.platform!=="darwin"&&G.platform!=="freebsd"&&G.platform!=="linux"&&G.platform!=="sunos"||(G.platform="UNIX"),G.platform==="win32"&&(G.platform="DOS");var Z=G.comment||this.comment||"";X=p.generateWorker(this,G,Z)}catch(C){(X=new u("error")).error(C)}return new m(X,G.type||"string",G.mimeType)},generateAsync:function(I,X){return this.generateInternalStream(I).accumulate(X)},generateNodeStream:function(I,X){return(I=I||{}).type||(I.type="nodebuffer"),this.generateInternalStream(I).toNodejsStream(X)}};s.exports=N},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,s,l){s.exports=t("stream")},{stream:void 0}],17:[function(t,s,l){var i=t("./DataReader");function c(n){i.call(this,n);for(var u=0;u<this.data.length;u++)n[u]=255&n[u]}t("../utils").inherits(c,i),c.prototype.byteAt=function(n){return this.data[this.zero+n]},c.prototype.lastIndexOfSignature=function(n){for(var u=n.charCodeAt(0),m=n.charCodeAt(1),y=n.charCodeAt(2),b=n.charCodeAt(3),T=this.length-4;0<=T;--T)if(this.data[T]===u&&this.data[T+1]===m&&this.data[T+2]===y&&this.data[T+3]===b)return T-this.zero;return-1},c.prototype.readAndCheckSignature=function(n){var u=n.charCodeAt(0),m=n.charCodeAt(1),y=n.charCodeAt(2),b=n.charCodeAt(3),T=this.readData(4);return u===T[0]&&m===T[1]&&y===T[2]&&b===T[3]},c.prototype.readData=function(n){if(this.checkOffset(n),n===0)return[];var u=this.data.slice(this.zero+this.index,this.zero+this.index+n);return this.index+=n,u},s.exports=c},{"../utils":32,"./DataReader":18}],18:[function(t,s,l){var i=t("../utils");function c(n){this.data=n,this.length=n.length,this.index=0,this.zero=0}c.prototype={checkOffset:function(n){this.checkIndex(this.index+n)},checkIndex:function(n){if(this.length<this.zero+n||n<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+n+"). Corrupted zip ?")},setIndex:function(n){this.checkIndex(n),this.index=n},skip:function(n){this.setIndex(this.index+n)},byteAt:function(){},readInt:function(n){var u,m=0;for(this.checkOffset(n),u=this.index+n-1;u>=this.index;u--)m=(m<<8)+this.byteAt(u);return this.index+=n,m},readString:function(n){return i.transformTo("string",this.readData(n))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var n=this.readInt(4);return new Date(Date.UTC(1980+(n>>25&127),(n>>21&15)-1,n>>16&31,n>>11&31,n>>5&63,(31&n)<<1))}},s.exports=c},{"../utils":32}],19:[function(t,s,l){var i=t("./Uint8ArrayReader");function c(n){i.call(this,n)}t("../utils").inherits(c,i),c.prototype.readData=function(n){this.checkOffset(n);var u=this.data.slice(this.zero+this.index,this.zero+this.index+n);return this.index+=n,u},s.exports=c},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,s,l){var i=t("./DataReader");function c(n){i.call(this,n)}t("../utils").inherits(c,i),c.prototype.byteAt=function(n){return this.data.charCodeAt(this.zero+n)},c.prototype.lastIndexOfSignature=function(n){return this.data.lastIndexOf(n)-this.zero},c.prototype.readAndCheckSignature=function(n){return n===this.readData(4)},c.prototype.readData=function(n){this.checkOffset(n);var u=this.data.slice(this.zero+this.index,this.zero+this.index+n);return this.index+=n,u},s.exports=c},{"../utils":32,"./DataReader":18}],21:[function(t,s,l){var i=t("./ArrayReader");function c(n){i.call(this,n)}t("../utils").inherits(c,i),c.prototype.readData=function(n){if(this.checkOffset(n),n===0)return new Uint8Array(0);var u=this.data.subarray(this.zero+this.index,this.zero+this.index+n);return this.index+=n,u},s.exports=c},{"../utils":32,"./ArrayReader":17}],22:[function(t,s,l){var i=t("../utils"),c=t("../support"),n=t("./ArrayReader"),u=t("./StringReader"),m=t("./NodeBufferReader"),y=t("./Uint8ArrayReader");s.exports=function(b){var T=i.getTypeOf(b);return i.checkSupport(T),T!=="string"||c.uint8array?T==="nodebuffer"?new m(b):c.uint8array?new y(i.transformTo("uint8array",b)):new n(i.transformTo("array",b)):new u(b)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,s,l){l.LOCAL_FILE_HEADER="PK",l.CENTRAL_FILE_HEADER="PK",l.CENTRAL_DIRECTORY_END="PK",l.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",l.ZIP64_CENTRAL_DIRECTORY_END="PK",l.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,s,l){var i=t("./GenericWorker"),c=t("../utils");function n(u){i.call(this,"ConvertWorker to "+u),this.destType=u}c.inherits(n,i),n.prototype.processChunk=function(u){this.push({data:c.transformTo(this.destType,u.data),meta:u.meta})},s.exports=n},{"../utils":32,"./GenericWorker":28}],25:[function(t,s,l){var i=t("./GenericWorker"),c=t("../crc32");function n(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(n,i),n.prototype.processChunk=function(u){this.streamInfo.crc32=c(u.data,this.streamInfo.crc32||0),this.push(u)},s.exports=n},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,s,l){var i=t("../utils"),c=t("./GenericWorker");function n(u){c.call(this,"DataLengthProbe for "+u),this.propName=u,this.withStreamInfo(u,0)}i.inherits(n,c),n.prototype.processChunk=function(u){if(u){var m=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=m+u.data.length}c.prototype.processChunk.call(this,u)},s.exports=n},{"../utils":32,"./GenericWorker":28}],27:[function(t,s,l){var i=t("../utils"),c=t("./GenericWorker");function n(u){c.call(this,"DataWorker");var m=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,u.then(function(y){m.dataIsReady=!0,m.data=y,m.max=y&&y.length||0,m.type=i.getTypeOf(y),m.isPaused||m._tickAndRepeat()},function(y){m.error(y)})}i.inherits(n,c),n.prototype.cleanUp=function(){c.prototype.cleanUp.call(this),this.data=null},n.prototype.resume=function(){return!!c.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},n.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},n.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var u=null,m=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":u=this.data.substring(this.index,m);break;case"uint8array":u=this.data.subarray(this.index,m);break;case"array":case"nodebuffer":u=this.data.slice(this.index,m)}return this.index=m,this.push({data:u,meta:{percent:this.max?this.index/this.max*100:0}})},s.exports=n},{"../utils":32,"./GenericWorker":28}],28:[function(t,s,l){function i(c){this.name=c||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(c){this.emit("data",c)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(c){this.emit("error",c)}return!0},error:function(c){return!this.isFinished&&(this.isPaused?this.generatedError=c:(this.isFinished=!0,this.emit("error",c),this.previous&&this.previous.error(c),this.cleanUp()),!0)},on:function(c,n){return this._listeners[c].push(n),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(c,n){if(this._listeners[c])for(var u=0;u<this._listeners[c].length;u++)this._listeners[c][u].call(this,n)},pipe:function(c){return c.registerPrevious(this)},registerPrevious:function(c){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=c.streamInfo,this.mergeStreamInfo(),this.previous=c;var n=this;return c.on("data",function(u){n.processChunk(u)}),c.on("end",function(){n.end()}),c.on("error",function(u){n.error(u)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var c=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),c=!0),this.previous&&this.previous.resume(),!c},flush:function(){},processChunk:function(c){this.push(c)},withStreamInfo:function(c,n){return this.extraStreamInfo[c]=n,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var c in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,c)&&(this.streamInfo[c]=this.extraStreamInfo[c])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var c="Worker "+this.name;return this.previous?this.previous+" -> "+c:c}},s.exports=i},{}],29:[function(t,s,l){var i=t("../utils"),c=t("./ConvertWorker"),n=t("./GenericWorker"),u=t("../base64"),m=t("../support"),y=t("../external"),b=null;if(m.nodestream)try{b=t("../nodejs/NodejsStreamOutputAdapter")}catch{}function T(S,g){return new y.Promise(function(x,f){var _=[],k=S._internalType,N=S._outputType,I=S._mimeType;S.on("data",function(X,G){_.push(X),g&&g(G)}).on("error",function(X){_=[],f(X)}).on("end",function(){try{var X=function(G,Z,C){switch(G){case"blob":return i.newBlob(i.transformTo("arraybuffer",Z),C);case"base64":return u.encode(Z);default:return i.transformTo(G,Z)}}(N,function(G,Z){var C,ce=0,ge=null,R=0;for(C=0;C<Z.length;C++)R+=Z[C].length;switch(G){case"string":return Z.join("");case"array":return Array.prototype.concat.apply([],Z);case"uint8array":for(ge=new Uint8Array(R),C=0;C<Z.length;C++)ge.set(Z[C],ce),ce+=Z[C].length;return ge;case"nodebuffer":return Buffer.concat(Z);default:throw new Error("concat : unsupported type '"+G+"'")}}(k,_),I);x(X)}catch(G){f(G)}_=[]}).resume()})}function p(S,g,x){var f=g;switch(g){case"blob":case"arraybuffer":f="uint8array";break;case"base64":f="string"}try{this._internalType=f,this._outputType=g,this._mimeType=x,i.checkSupport(f),this._worker=S.pipe(new c(f)),S.lock()}catch(_){this._worker=new n("error"),this._worker.error(_)}}p.prototype={accumulate:function(S){return T(this,S)},on:function(S,g){var x=this;return S==="data"?this._worker.on(S,function(f){g.call(x,f.data,f.meta)}):this._worker.on(S,function(){i.delay(g,arguments,x)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(S){if(i.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new b(this,{objectMode:this._outputType!=="nodebuffer"},S)}},s.exports=p},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,s,l){if(l.base64=!0,l.array=!0,l.string=!0,l.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",l.nodebuffer=typeof Buffer<"u",l.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")l.blob=!1;else{var i=new ArrayBuffer(0);try{l.blob=new Blob([i],{type:"application/zip"}).size===0}catch{try{var c=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);c.append(i),l.blob=c.getBlob("application/zip").size===0}catch{l.blob=!1}}}try{l.nodestream=!!t("readable-stream").Readable}catch{l.nodestream=!1}},{"readable-stream":16}],31:[function(t,s,l){for(var i=t("./utils"),c=t("./support"),n=t("./nodejsUtils"),u=t("./stream/GenericWorker"),m=new Array(256),y=0;y<256;y++)m[y]=252<=y?6:248<=y?5:240<=y?4:224<=y?3:192<=y?2:1;m[254]=m[254]=1;function b(){u.call(this,"utf-8 decode"),this.leftOver=null}function T(){u.call(this,"utf-8 encode")}l.utf8encode=function(p){return c.nodebuffer?n.newBufferFrom(p,"utf-8"):function(S){var g,x,f,_,k,N=S.length,I=0;for(_=0;_<N;_++)(64512&(x=S.charCodeAt(_)))==55296&&_+1<N&&(64512&(f=S.charCodeAt(_+1)))==56320&&(x=65536+(x-55296<<10)+(f-56320),_++),I+=x<128?1:x<2048?2:x<65536?3:4;for(g=c.uint8array?new Uint8Array(I):new Array(I),_=k=0;k<I;_++)(64512&(x=S.charCodeAt(_)))==55296&&_+1<N&&(64512&(f=S.charCodeAt(_+1)))==56320&&(x=65536+(x-55296<<10)+(f-56320),_++),x<128?g[k++]=x:(x<2048?g[k++]=192|x>>>6:(x<65536?g[k++]=224|x>>>12:(g[k++]=240|x>>>18,g[k++]=128|x>>>12&63),g[k++]=128|x>>>6&63),g[k++]=128|63&x);return g}(p)},l.utf8decode=function(p){return c.nodebuffer?i.transformTo("nodebuffer",p).toString("utf-8"):function(S){var g,x,f,_,k=S.length,N=new Array(2*k);for(g=x=0;g<k;)if((f=S[g++])<128)N[x++]=f;else if(4<(_=m[f]))N[x++]=65533,g+=_-1;else{for(f&=_===2?31:_===3?15:7;1<_&&g<k;)f=f<<6|63&S[g++],_--;1<_?N[x++]=65533:f<65536?N[x++]=f:(f-=65536,N[x++]=55296|f>>10&1023,N[x++]=56320|1023&f)}return N.length!==x&&(N.subarray?N=N.subarray(0,x):N.length=x),i.applyFromCharCode(N)}(p=i.transformTo(c.uint8array?"uint8array":"array",p))},i.inherits(b,u),b.prototype.processChunk=function(p){var S=i.transformTo(c.uint8array?"uint8array":"array",p.data);if(this.leftOver&&this.leftOver.length){if(c.uint8array){var g=S;(S=new Uint8Array(g.length+this.leftOver.length)).set(this.leftOver,0),S.set(g,this.leftOver.length)}else S=this.leftOver.concat(S);this.leftOver=null}var x=function(_,k){var N;for((k=k||_.length)>_.length&&(k=_.length),N=k-1;0<=N&&(192&_[N])==128;)N--;return N<0||N===0?k:N+m[_[N]]>k?N:k}(S),f=S;x!==S.length&&(c.uint8array?(f=S.subarray(0,x),this.leftOver=S.subarray(x,S.length)):(f=S.slice(0,x),this.leftOver=S.slice(x,S.length))),this.push({data:l.utf8decode(f),meta:p.meta})},b.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:l.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},l.Utf8DecodeWorker=b,i.inherits(T,u),T.prototype.processChunk=function(p){this.push({data:l.utf8encode(p.data),meta:p.meta})},l.Utf8EncodeWorker=T},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,s,l){var i=t("./support"),c=t("./base64"),n=t("./nodejsUtils"),u=t("./external");function m(g){return g}function y(g,x){for(var f=0;f<g.length;++f)x[f]=255&g.charCodeAt(f);return x}t("setimmediate"),l.newBlob=function(g,x){l.checkSupport("blob");try{return new Blob([g],{type:x})}catch{try{var f=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return f.append(g),f.getBlob(x)}catch{throw new Error("Bug : can't construct the Blob.")}}};var b={stringifyByChunk:function(g,x,f){var _=[],k=0,N=g.length;if(N<=f)return String.fromCharCode.apply(null,g);for(;k<N;)x==="array"||x==="nodebuffer"?_.push(String.fromCharCode.apply(null,g.slice(k,Math.min(k+f,N)))):_.push(String.fromCharCode.apply(null,g.subarray(k,Math.min(k+f,N)))),k+=f;return _.join("")},stringifyByChar:function(g){for(var x="",f=0;f<g.length;f++)x+=String.fromCharCode(g[f]);return x},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&String.fromCharCode.apply(null,n.allocBuffer(1)).length===1}catch{return!1}}()}};function T(g){var x=65536,f=l.getTypeOf(g),_=!0;if(f==="uint8array"?_=b.applyCanBeUsed.uint8array:f==="nodebuffer"&&(_=b.applyCanBeUsed.nodebuffer),_)for(;1<x;)try{return b.stringifyByChunk(g,f,x)}catch{x=Math.floor(x/2)}return b.stringifyByChar(g)}function p(g,x){for(var f=0;f<g.length;f++)x[f]=g[f];return x}l.applyFromCharCode=T;var S={};S.string={string:m,array:function(g){return y(g,new Array(g.length))},arraybuffer:function(g){return S.string.uint8array(g).buffer},uint8array:function(g){return y(g,new Uint8Array(g.length))},nodebuffer:function(g){return y(g,n.allocBuffer(g.length))}},S.array={string:T,array:m,arraybuffer:function(g){return new Uint8Array(g).buffer},uint8array:function(g){return new Uint8Array(g)},nodebuffer:function(g){return n.newBufferFrom(g)}},S.arraybuffer={string:function(g){return T(new Uint8Array(g))},array:function(g){return p(new Uint8Array(g),new Array(g.byteLength))},arraybuffer:m,uint8array:function(g){return new Uint8Array(g)},nodebuffer:function(g){return n.newBufferFrom(new Uint8Array(g))}},S.uint8array={string:T,array:function(g){return p(g,new Array(g.length))},arraybuffer:function(g){return g.buffer},uint8array:m,nodebuffer:function(g){return n.newBufferFrom(g)}},S.nodebuffer={string:T,array:function(g){return p(g,new Array(g.length))},arraybuffer:function(g){return S.nodebuffer.uint8array(g).buffer},uint8array:function(g){return p(g,new Uint8Array(g.length))},nodebuffer:m},l.transformTo=function(g,x){if(x=x||"",!g)return x;l.checkSupport(g);var f=l.getTypeOf(x);return S[f][g](x)},l.resolve=function(g){for(var x=g.split("/"),f=[],_=0;_<x.length;_++){var k=x[_];k==="."||k===""&&_!==0&&_!==x.length-1||(k===".."?f.pop():f.push(k))}return f.join("/")},l.getTypeOf=function(g){return typeof g=="string"?"string":Object.prototype.toString.call(g)==="[object Array]"?"array":i.nodebuffer&&n.isBuffer(g)?"nodebuffer":i.uint8array&&g instanceof Uint8Array?"uint8array":i.arraybuffer&&g instanceof ArrayBuffer?"arraybuffer":void 0},l.checkSupport=function(g){if(!i[g.toLowerCase()])throw new Error(g+" is not supported by this platform")},l.MAX_VALUE_16BITS=65535,l.MAX_VALUE_32BITS=-1,l.pretty=function(g){var x,f,_="";for(f=0;f<(g||"").length;f++)_+="\\x"+((x=g.charCodeAt(f))<16?"0":"")+x.toString(16).toUpperCase();return _},l.delay=function(g,x,f){setImmediate(function(){g.apply(f||null,x||[])})},l.inherits=function(g,x){function f(){}f.prototype=x.prototype,g.prototype=new f},l.extend=function(){var g,x,f={};for(g=0;g<arguments.length;g++)for(x in arguments[g])Object.prototype.hasOwnProperty.call(arguments[g],x)&&f[x]===void 0&&(f[x]=arguments[g][x]);return f},l.prepareContent=function(g,x,f,_,k){return u.Promise.resolve(x).then(function(N){return i.blob&&(N instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(N))!==-1)&&typeof FileReader<"u"?new u.Promise(function(I,X){var G=new FileReader;G.onload=function(Z){I(Z.target.result)},G.onerror=function(Z){X(Z.target.error)},G.readAsArrayBuffer(N)}):N}).then(function(N){var I=l.getTypeOf(N);return I?(I==="arraybuffer"?N=l.transformTo("uint8array",N):I==="string"&&(k?N=c.decode(N):f&&_!==!0&&(N=function(X){return y(X,i.uint8array?new Uint8Array(X.length):new Array(X.length))}(N))),N):u.Promise.reject(new Error("Can't read the data of '"+g+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,s,l){var i=t("./reader/readerFor"),c=t("./utils"),n=t("./signature"),u=t("./zipEntry"),m=t("./support");function y(b){this.files=[],this.loadOptions=b}y.prototype={checkSignature:function(b){if(!this.reader.readAndCheckSignature(b)){this.reader.index-=4;var T=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+c.pretty(T)+", expected "+c.pretty(b)+")")}},isSignature:function(b,T){var p=this.reader.index;this.reader.setIndex(b);var S=this.reader.readString(4)===T;return this.reader.setIndex(p),S},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var b=this.reader.readData(this.zipCommentLength),T=m.uint8array?"uint8array":"array",p=c.transformTo(T,b);this.zipComment=this.loadOptions.decodeFileName(p)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var b,T,p,S=this.zip64EndOfCentralSize-44;0<S;)b=this.reader.readInt(2),T=this.reader.readInt(4),p=this.reader.readData(T),this.zip64ExtensibleData[b]={id:b,length:T,value:p}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var b,T;for(b=0;b<this.files.length;b++)T=this.files[b],this.reader.setIndex(T.localHeaderOffset),this.checkSignature(n.LOCAL_FILE_HEADER),T.readLocalPart(this.reader),T.handleUTF8(),T.processAttributes()},readCentralDir:function(){var b;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(n.CENTRAL_FILE_HEADER);)(b=new u({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(b);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var b=this.reader.lastIndexOfSignature(n.CENTRAL_DIRECTORY_END);if(b<0)throw this.isSignature(0,n.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(b);var T=b;if(this.checkSignature(n.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===c.MAX_VALUE_16BITS||this.diskWithCentralDirStart===c.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===c.MAX_VALUE_16BITS||this.centralDirRecords===c.MAX_VALUE_16BITS||this.centralDirSize===c.MAX_VALUE_32BITS||this.centralDirOffset===c.MAX_VALUE_32BITS){if(this.zip64=!0,(b=this.reader.lastIndexOfSignature(n.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(b),this.checkSignature(n.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,n.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(n.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(n.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var p=this.centralDirOffset+this.centralDirSize;this.zip64&&(p+=20,p+=12+this.zip64EndOfCentralSize);var S=T-p;if(0<S)this.isSignature(T,n.CENTRAL_FILE_HEADER)||(this.reader.zero=S);else if(S<0)throw new Error("Corrupted zip: missing "+Math.abs(S)+" bytes.")},prepareReader:function(b){this.reader=i(b)},load:function(b){this.prepareReader(b),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},s.exports=y},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,s,l){var i=t("./reader/readerFor"),c=t("./utils"),n=t("./compressedObject"),u=t("./crc32"),m=t("./utf8"),y=t("./compressions"),b=t("./support");function T(p,S){this.options=p,this.loadOptions=S}T.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(p){var S,g;if(p.skip(22),this.fileNameLength=p.readInt(2),g=p.readInt(2),this.fileName=p.readData(this.fileNameLength),p.skip(g),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((S=function(x){for(var f in y)if(Object.prototype.hasOwnProperty.call(y,f)&&y[f].magic===x)return y[f];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+c.pretty(this.compressionMethod)+" unknown (inner file : "+c.transformTo("string",this.fileName)+")");this.decompressed=new n(this.compressedSize,this.uncompressedSize,this.crc32,S,p.readData(this.compressedSize))},readCentralPart:function(p){this.versionMadeBy=p.readInt(2),p.skip(2),this.bitFlag=p.readInt(2),this.compressionMethod=p.readString(2),this.date=p.readDate(),this.crc32=p.readInt(4),this.compressedSize=p.readInt(4),this.uncompressedSize=p.readInt(4);var S=p.readInt(2);if(this.extraFieldsLength=p.readInt(2),this.fileCommentLength=p.readInt(2),this.diskNumberStart=p.readInt(2),this.internalFileAttributes=p.readInt(2),this.externalFileAttributes=p.readInt(4),this.localHeaderOffset=p.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");p.skip(S),this.readExtraFields(p),this.parseZIP64ExtraField(p),this.fileComment=p.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var p=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),p==0&&(this.dosPermissions=63&this.externalFileAttributes),p==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var p=i(this.extraFields[1].value);this.uncompressedSize===c.MAX_VALUE_32BITS&&(this.uncompressedSize=p.readInt(8)),this.compressedSize===c.MAX_VALUE_32BITS&&(this.compressedSize=p.readInt(8)),this.localHeaderOffset===c.MAX_VALUE_32BITS&&(this.localHeaderOffset=p.readInt(8)),this.diskNumberStart===c.MAX_VALUE_32BITS&&(this.diskNumberStart=p.readInt(4))}},readExtraFields:function(p){var S,g,x,f=p.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});p.index+4<f;)S=p.readInt(2),g=p.readInt(2),x=p.readData(g),this.extraFields[S]={id:S,length:g,value:x};p.setIndex(f)},handleUTF8:function(){var p=b.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=m.utf8decode(this.fileName),this.fileCommentStr=m.utf8decode(this.fileComment);else{var S=this.findExtraFieldUnicodePath();if(S!==null)this.fileNameStr=S;else{var g=c.transformTo(p,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(g)}var x=this.findExtraFieldUnicodeComment();if(x!==null)this.fileCommentStr=x;else{var f=c.transformTo(p,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(f)}}},findExtraFieldUnicodePath:function(){var p=this.extraFields[28789];if(p){var S=i(p.value);return S.readInt(1)!==1||u(this.fileName)!==S.readInt(4)?null:m.utf8decode(S.readData(p.length-5))}return null},findExtraFieldUnicodeComment:function(){var p=this.extraFields[25461];if(p){var S=i(p.value);return S.readInt(1)!==1||u(this.fileComment)!==S.readInt(4)?null:m.utf8decode(S.readData(p.length-5))}return null}},s.exports=T},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,s,l){function i(S,g,x){this.name=S,this.dir=x.dir,this.date=x.date,this.comment=x.comment,this.unixPermissions=x.unixPermissions,this.dosPermissions=x.dosPermissions,this._data=g,this._dataBinary=x.binary,this.options={compression:x.compression,compressionOptions:x.compressionOptions}}var c=t("./stream/StreamHelper"),n=t("./stream/DataWorker"),u=t("./utf8"),m=t("./compressedObject"),y=t("./stream/GenericWorker");i.prototype={internalStream:function(S){var g=null,x="string";try{if(!S)throw new Error("No output type specified.");var f=(x=S.toLowerCase())==="string"||x==="text";x!=="binarystring"&&x!=="text"||(x="string"),g=this._decompressWorker();var _=!this._dataBinary;_&&!f&&(g=g.pipe(new u.Utf8EncodeWorker)),!_&&f&&(g=g.pipe(new u.Utf8DecodeWorker))}catch(k){(g=new y("error")).error(k)}return new c(g,x,"")},async:function(S,g){return this.internalStream(S).accumulate(g)},nodeStream:function(S,g){return this.internalStream(S||"nodebuffer").toNodejsStream(g)},_compressWorker:function(S,g){if(this._data instanceof m&&this._data.compression.magic===S.magic)return this._data.getCompressedWorker();var x=this._decompressWorker();return this._dataBinary||(x=x.pipe(new u.Utf8EncodeWorker)),m.createWorkerFrom(x,S,g)},_decompressWorker:function(){return this._data instanceof m?this._data.getContentWorker():this._data instanceof y?this._data:new n(this._data)}};for(var b=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],T=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},p=0;p<b.length;p++)i.prototype[b[p]]=T;s.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,s,l){(function(i){var c,n,u=i.MutationObserver||i.WebKitMutationObserver;if(u){var m=0,y=new u(S),b=i.document.createTextNode("");y.observe(b,{characterData:!0}),c=function(){b.data=m=++m%2}}else if(i.setImmediate||i.MessageChannel===void 0)c="document"in i&&"onreadystatechange"in i.document.createElement("script")?function(){var g=i.document.createElement("script");g.onreadystatechange=function(){S(),g.onreadystatechange=null,g.parentNode.removeChild(g),g=null},i.document.documentElement.appendChild(g)}:function(){setTimeout(S,0)};else{var T=new i.MessageChannel;T.port1.onmessage=S,c=function(){T.port2.postMessage(0)}}var p=[];function S(){var g,x;n=!0;for(var f=p.length;f;){for(x=p,p=[],g=-1;++g<f;)x[g]();f=p.length}n=!1}s.exports=function(g){p.push(g)!==1||n||c()}}).call(this,typeof Rt<"u"?Rt:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(t,s,l){var i=t("immediate");function c(){}var n={},u=["REJECTED"],m=["FULFILLED"],y=["PENDING"];function b(f){if(typeof f!="function")throw new TypeError("resolver must be a function");this.state=y,this.queue=[],this.outcome=void 0,f!==c&&g(this,f)}function T(f,_,k){this.promise=f,typeof _=="function"&&(this.onFulfilled=_,this.callFulfilled=this.otherCallFulfilled),typeof k=="function"&&(this.onRejected=k,this.callRejected=this.otherCallRejected)}function p(f,_,k){i(function(){var N;try{N=_(k)}catch(I){return n.reject(f,I)}N===f?n.reject(f,new TypeError("Cannot resolve promise with itself")):n.resolve(f,N)})}function S(f){var _=f&&f.then;if(f&&(typeof f=="object"||typeof f=="function")&&typeof _=="function")return function(){_.apply(f,arguments)}}function g(f,_){var k=!1;function N(G){k||(k=!0,n.reject(f,G))}function I(G){k||(k=!0,n.resolve(f,G))}var X=x(function(){_(I,N)});X.status==="error"&&N(X.value)}function x(f,_){var k={};try{k.value=f(_),k.status="success"}catch(N){k.status="error",k.value=N}return k}(s.exports=b).prototype.finally=function(f){if(typeof f!="function")return this;var _=this.constructor;return this.then(function(k){return _.resolve(f()).then(function(){return k})},function(k){return _.resolve(f()).then(function(){throw k})})},b.prototype.catch=function(f){return this.then(null,f)},b.prototype.then=function(f,_){if(typeof f!="function"&&this.state===m||typeof _!="function"&&this.state===u)return this;var k=new this.constructor(c);return this.state!==y?p(k,this.state===m?f:_,this.outcome):this.queue.push(new T(k,f,_)),k},T.prototype.callFulfilled=function(f){n.resolve(this.promise,f)},T.prototype.otherCallFulfilled=function(f){p(this.promise,this.onFulfilled,f)},T.prototype.callRejected=function(f){n.reject(this.promise,f)},T.prototype.otherCallRejected=function(f){p(this.promise,this.onRejected,f)},n.resolve=function(f,_){var k=x(S,_);if(k.status==="error")return n.reject(f,k.value);var N=k.value;if(N)g(f,N);else{f.state=m,f.outcome=_;for(var I=-1,X=f.queue.length;++I<X;)f.queue[I].callFulfilled(_)}return f},n.reject=function(f,_){f.state=u,f.outcome=_;for(var k=-1,N=f.queue.length;++k<N;)f.queue[k].callRejected(_);return f},b.resolve=function(f){return f instanceof this?f:n.resolve(new this(c),f)},b.reject=function(f){var _=new this(c);return n.reject(_,f)},b.all=function(f){var _=this;if(Object.prototype.toString.call(f)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=f.length,N=!1;if(!k)return this.resolve([]);for(var I=new Array(k),X=0,G=-1,Z=new this(c);++G<k;)C(f[G],G);return Z;function C(ce,ge){_.resolve(ce).then(function(R){I[ge]=R,++X!==k||N||(N=!0,n.resolve(Z,I))},function(R){N||(N=!0,n.reject(Z,R))})}},b.race=function(f){var _=this;if(Object.prototype.toString.call(f)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=f.length,N=!1;if(!k)return this.resolve([]);for(var I=-1,X=new this(c);++I<k;)G=f[I],_.resolve(G).then(function(Z){N||(N=!0,n.resolve(X,Z))},function(Z){N||(N=!0,n.reject(X,Z))});var G;return X}},{immediate:36}],38:[function(t,s,l){var i={};(0,t("./lib/utils/common").assign)(i,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),s.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,s,l){var i=t("./zlib/deflate"),c=t("./utils/common"),n=t("./utils/strings"),u=t("./zlib/messages"),m=t("./zlib/zstream"),y=Object.prototype.toString,b=0,T=-1,p=0,S=8;function g(f){if(!(this instanceof g))return new g(f);this.options=c.assign({level:T,method:S,chunkSize:16384,windowBits:15,memLevel:8,strategy:p,to:""},f||{});var _=this.options;_.raw&&0<_.windowBits?_.windowBits=-_.windowBits:_.gzip&&0<_.windowBits&&_.windowBits<16&&(_.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new m,this.strm.avail_out=0;var k=i.deflateInit2(this.strm,_.level,_.method,_.windowBits,_.memLevel,_.strategy);if(k!==b)throw new Error(u[k]);if(_.header&&i.deflateSetHeader(this.strm,_.header),_.dictionary){var N;if(N=typeof _.dictionary=="string"?n.string2buf(_.dictionary):y.call(_.dictionary)==="[object ArrayBuffer]"?new Uint8Array(_.dictionary):_.dictionary,(k=i.deflateSetDictionary(this.strm,N))!==b)throw new Error(u[k]);this._dict_set=!0}}function x(f,_){var k=new g(_);if(k.push(f,!0),k.err)throw k.msg||u[k.err];return k.result}g.prototype.push=function(f,_){var k,N,I=this.strm,X=this.options.chunkSize;if(this.ended)return!1;N=_===~~_?_:_===!0?4:0,typeof f=="string"?I.input=n.string2buf(f):y.call(f)==="[object ArrayBuffer]"?I.input=new Uint8Array(f):I.input=f,I.next_in=0,I.avail_in=I.input.length;do{if(I.avail_out===0&&(I.output=new c.Buf8(X),I.next_out=0,I.avail_out=X),(k=i.deflate(I,N))!==1&&k!==b)return this.onEnd(k),!(this.ended=!0);I.avail_out!==0&&(I.avail_in!==0||N!==4&&N!==2)||(this.options.to==="string"?this.onData(n.buf2binstring(c.shrinkBuf(I.output,I.next_out))):this.onData(c.shrinkBuf(I.output,I.next_out)))}while((0<I.avail_in||I.avail_out===0)&&k!==1);return N===4?(k=i.deflateEnd(this.strm),this.onEnd(k),this.ended=!0,k===b):N!==2||(this.onEnd(b),!(I.avail_out=0))},g.prototype.onData=function(f){this.chunks.push(f)},g.prototype.onEnd=function(f){f===b&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=c.flattenChunks(this.chunks)),this.chunks=[],this.err=f,this.msg=this.strm.msg},l.Deflate=g,l.deflate=x,l.deflateRaw=function(f,_){return(_=_||{}).raw=!0,x(f,_)},l.gzip=function(f,_){return(_=_||{}).gzip=!0,x(f,_)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,s,l){var i=t("./zlib/inflate"),c=t("./utils/common"),n=t("./utils/strings"),u=t("./zlib/constants"),m=t("./zlib/messages"),y=t("./zlib/zstream"),b=t("./zlib/gzheader"),T=Object.prototype.toString;function p(g){if(!(this instanceof p))return new p(g);this.options=c.assign({chunkSize:16384,windowBits:0,to:""},g||{});var x=this.options;x.raw&&0<=x.windowBits&&x.windowBits<16&&(x.windowBits=-x.windowBits,x.windowBits===0&&(x.windowBits=-15)),!(0<=x.windowBits&&x.windowBits<16)||g&&g.windowBits||(x.windowBits+=32),15<x.windowBits&&x.windowBits<48&&!(15&x.windowBits)&&(x.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new y,this.strm.avail_out=0;var f=i.inflateInit2(this.strm,x.windowBits);if(f!==u.Z_OK)throw new Error(m[f]);this.header=new b,i.inflateGetHeader(this.strm,this.header)}function S(g,x){var f=new p(x);if(f.push(g,!0),f.err)throw f.msg||m[f.err];return f.result}p.prototype.push=function(g,x){var f,_,k,N,I,X,G=this.strm,Z=this.options.chunkSize,C=this.options.dictionary,ce=!1;if(this.ended)return!1;_=x===~~x?x:x===!0?u.Z_FINISH:u.Z_NO_FLUSH,typeof g=="string"?G.input=n.binstring2buf(g):T.call(g)==="[object ArrayBuffer]"?G.input=new Uint8Array(g):G.input=g,G.next_in=0,G.avail_in=G.input.length;do{if(G.avail_out===0&&(G.output=new c.Buf8(Z),G.next_out=0,G.avail_out=Z),(f=i.inflate(G,u.Z_NO_FLUSH))===u.Z_NEED_DICT&&C&&(X=typeof C=="string"?n.string2buf(C):T.call(C)==="[object ArrayBuffer]"?new Uint8Array(C):C,f=i.inflateSetDictionary(this.strm,X)),f===u.Z_BUF_ERROR&&ce===!0&&(f=u.Z_OK,ce=!1),f!==u.Z_STREAM_END&&f!==u.Z_OK)return this.onEnd(f),!(this.ended=!0);G.next_out&&(G.avail_out!==0&&f!==u.Z_STREAM_END&&(G.avail_in!==0||_!==u.Z_FINISH&&_!==u.Z_SYNC_FLUSH)||(this.options.to==="string"?(k=n.utf8border(G.output,G.next_out),N=G.next_out-k,I=n.buf2string(G.output,k),G.next_out=N,G.avail_out=Z-N,N&&c.arraySet(G.output,G.output,k,N,0),this.onData(I)):this.onData(c.shrinkBuf(G.output,G.next_out)))),G.avail_in===0&&G.avail_out===0&&(ce=!0)}while((0<G.avail_in||G.avail_out===0)&&f!==u.Z_STREAM_END);return f===u.Z_STREAM_END&&(_=u.Z_FINISH),_===u.Z_FINISH?(f=i.inflateEnd(this.strm),this.onEnd(f),this.ended=!0,f===u.Z_OK):_!==u.Z_SYNC_FLUSH||(this.onEnd(u.Z_OK),!(G.avail_out=0))},p.prototype.onData=function(g){this.chunks.push(g)},p.prototype.onEnd=function(g){g===u.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=c.flattenChunks(this.chunks)),this.chunks=[],this.err=g,this.msg=this.strm.msg},l.Inflate=p,l.inflate=S,l.inflateRaw=function(g,x){return(x=x||{}).raw=!0,S(g,x)},l.ungzip=S},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,s,l){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";l.assign=function(u){for(var m=Array.prototype.slice.call(arguments,1);m.length;){var y=m.shift();if(y){if(typeof y!="object")throw new TypeError(y+"must be non-object");for(var b in y)y.hasOwnProperty(b)&&(u[b]=y[b])}}return u},l.shrinkBuf=function(u,m){return u.length===m?u:u.subarray?u.subarray(0,m):(u.length=m,u)};var c={arraySet:function(u,m,y,b,T){if(m.subarray&&u.subarray)u.set(m.subarray(y,y+b),T);else for(var p=0;p<b;p++)u[T+p]=m[y+p]},flattenChunks:function(u){var m,y,b,T,p,S;for(m=b=0,y=u.length;m<y;m++)b+=u[m].length;for(S=new Uint8Array(b),m=T=0,y=u.length;m<y;m++)p=u[m],S.set(p,T),T+=p.length;return S}},n={arraySet:function(u,m,y,b,T){for(var p=0;p<b;p++)u[T+p]=m[y+p]},flattenChunks:function(u){return[].concat.apply([],u)}};l.setTyped=function(u){u?(l.Buf8=Uint8Array,l.Buf16=Uint16Array,l.Buf32=Int32Array,l.assign(l,c)):(l.Buf8=Array,l.Buf16=Array,l.Buf32=Array,l.assign(l,n))},l.setTyped(i)},{}],42:[function(t,s,l){var i=t("./common"),c=!0,n=!0;try{String.fromCharCode.apply(null,[0])}catch{c=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{n=!1}for(var u=new i.Buf8(256),m=0;m<256;m++)u[m]=252<=m?6:248<=m?5:240<=m?4:224<=m?3:192<=m?2:1;function y(b,T){if(T<65537&&(b.subarray&&n||!b.subarray&&c))return String.fromCharCode.apply(null,i.shrinkBuf(b,T));for(var p="",S=0;S<T;S++)p+=String.fromCharCode(b[S]);return p}u[254]=u[254]=1,l.string2buf=function(b){var T,p,S,g,x,f=b.length,_=0;for(g=0;g<f;g++)(64512&(p=b.charCodeAt(g)))==55296&&g+1<f&&(64512&(S=b.charCodeAt(g+1)))==56320&&(p=65536+(p-55296<<10)+(S-56320),g++),_+=p<128?1:p<2048?2:p<65536?3:4;for(T=new i.Buf8(_),g=x=0;x<_;g++)(64512&(p=b.charCodeAt(g)))==55296&&g+1<f&&(64512&(S=b.charCodeAt(g+1)))==56320&&(p=65536+(p-55296<<10)+(S-56320),g++),p<128?T[x++]=p:(p<2048?T[x++]=192|p>>>6:(p<65536?T[x++]=224|p>>>12:(T[x++]=240|p>>>18,T[x++]=128|p>>>12&63),T[x++]=128|p>>>6&63),T[x++]=128|63&p);return T},l.buf2binstring=function(b){return y(b,b.length)},l.binstring2buf=function(b){for(var T=new i.Buf8(b.length),p=0,S=T.length;p<S;p++)T[p]=b.charCodeAt(p);return T},l.buf2string=function(b,T){var p,S,g,x,f=T||b.length,_=new Array(2*f);for(p=S=0;p<f;)if((g=b[p++])<128)_[S++]=g;else if(4<(x=u[g]))_[S++]=65533,p+=x-1;else{for(g&=x===2?31:x===3?15:7;1<x&&p<f;)g=g<<6|63&b[p++],x--;1<x?_[S++]=65533:g<65536?_[S++]=g:(g-=65536,_[S++]=55296|g>>10&1023,_[S++]=56320|1023&g)}return y(_,S)},l.utf8border=function(b,T){var p;for((T=T||b.length)>b.length&&(T=b.length),p=T-1;0<=p&&(192&b[p])==128;)p--;return p<0||p===0?T:p+u[b[p]]>T?p:T}},{"./common":41}],43:[function(t,s,l){s.exports=function(i,c,n,u){for(var m=65535&i|0,y=i>>>16&65535|0,b=0;n!==0;){for(n-=b=2e3<n?2e3:n;y=y+(m=m+c[u++]|0)|0,--b;);m%=65521,y%=65521}return m|y<<16|0}},{}],44:[function(t,s,l){s.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,s,l){var i=function(){for(var c,n=[],u=0;u<256;u++){c=u;for(var m=0;m<8;m++)c=1&c?3988292384^c>>>1:c>>>1;n[u]=c}return n}();s.exports=function(c,n,u,m){var y=i,b=m+u;c^=-1;for(var T=m;T<b;T++)c=c>>>8^y[255&(c^n[T])];return-1^c}},{}],46:[function(t,s,l){var i,c=t("../utils/common"),n=t("./trees"),u=t("./adler32"),m=t("./crc32"),y=t("./messages"),b=0,T=4,p=0,S=-2,g=-1,x=4,f=2,_=8,k=9,N=286,I=30,X=19,G=2*N+1,Z=15,C=3,ce=258,ge=ce+C+1,R=42,H=113,A=1,j=2,oe=3,V=4;function we(h,Q){return h.msg=y[Q],Q}function Y(h){return(h<<1)-(4<h?9:0)}function ee(h){for(var Q=h.length;0<=--Q;)h[Q]=0}function M(h){var Q=h.state,E=Q.pending;E>h.avail_out&&(E=h.avail_out),E!==0&&(c.arraySet(h.output,Q.pending_buf,Q.pending_out,E,h.next_out),h.next_out+=E,Q.pending_out+=E,h.total_out+=E,h.avail_out-=E,Q.pending-=E,Q.pending===0&&(Q.pending_out=0))}function O(h,Q){n._tr_flush_block(h,0<=h.block_start?h.block_start:-1,h.strstart-h.block_start,Q),h.block_start=h.strstart,M(h.strm)}function K(h,Q){h.pending_buf[h.pending++]=Q}function q(h,Q){h.pending_buf[h.pending++]=Q>>>8&255,h.pending_buf[h.pending++]=255&Q}function ie(h,Q){var E,o,a=h.max_chain_length,d=h.strstart,F=h.prev_length,$=h.nice_match,P=h.strstart>h.w_size-ge?h.strstart-(h.w_size-ge):0,ue=h.window,ve=h.w_mask,ae=h.prev,xe=h.strstart+ce,ke=ue[d+F-1],Ne=ue[d+F];h.prev_length>=h.good_match&&(a>>=2),$>h.lookahead&&($=h.lookahead);do if(ue[(E=Q)+F]===Ne&&ue[E+F-1]===ke&&ue[E]===ue[d]&&ue[++E]===ue[d+1]){d+=2,E++;do;while(ue[++d]===ue[++E]&&ue[++d]===ue[++E]&&ue[++d]===ue[++E]&&ue[++d]===ue[++E]&&ue[++d]===ue[++E]&&ue[++d]===ue[++E]&&ue[++d]===ue[++E]&&ue[++d]===ue[++E]&&d<xe);if(o=ce-(xe-d),d=xe-ce,F<o){if(h.match_start=Q,$<=(F=o))break;ke=ue[d+F-1],Ne=ue[d+F]}}while((Q=ae[Q&ve])>P&&--a!=0);return F<=h.lookahead?F:h.lookahead}function z(h){var Q,E,o,a,d,F,$,P,ue,ve,ae=h.w_size;do{if(a=h.window_size-h.lookahead-h.strstart,h.strstart>=ae+(ae-ge)){for(c.arraySet(h.window,h.window,ae,ae,0),h.match_start-=ae,h.strstart-=ae,h.block_start-=ae,Q=E=h.hash_size;o=h.head[--Q],h.head[Q]=ae<=o?o-ae:0,--E;);for(Q=E=ae;o=h.prev[--Q],h.prev[Q]=ae<=o?o-ae:0,--E;);a+=ae}if(h.strm.avail_in===0)break;if(F=h.strm,$=h.window,P=h.strstart+h.lookahead,ue=a,ve=void 0,ve=F.avail_in,ue<ve&&(ve=ue),E=ve===0?0:(F.avail_in-=ve,c.arraySet($,F.input,F.next_in,ve,P),F.state.wrap===1?F.adler=u(F.adler,$,ve,P):F.state.wrap===2&&(F.adler=m(F.adler,$,ve,P)),F.next_in+=ve,F.total_in+=ve,ve),h.lookahead+=E,h.lookahead+h.insert>=C)for(d=h.strstart-h.insert,h.ins_h=h.window[d],h.ins_h=(h.ins_h<<h.hash_shift^h.window[d+1])&h.hash_mask;h.insert&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[d+C-1])&h.hash_mask,h.prev[d&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=d,d++,h.insert--,!(h.lookahead+h.insert<C)););}while(h.lookahead<ge&&h.strm.avail_in!==0)}function v(h,Q){for(var E,o;;){if(h.lookahead<ge){if(z(h),h.lookahead<ge&&Q===b)return A;if(h.lookahead===0)break}if(E=0,h.lookahead>=C&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+C-1])&h.hash_mask,E=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart),E!==0&&h.strstart-E<=h.w_size-ge&&(h.match_length=ie(h,E)),h.match_length>=C)if(o=n._tr_tally(h,h.strstart-h.match_start,h.match_length-C),h.lookahead-=h.match_length,h.match_length<=h.max_lazy_match&&h.lookahead>=C){for(h.match_length--;h.strstart++,h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+C-1])&h.hash_mask,E=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart,--h.match_length!=0;);h.strstart++}else h.strstart+=h.match_length,h.match_length=0,h.ins_h=h.window[h.strstart],h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+1])&h.hash_mask;else o=n._tr_tally(h,0,h.window[h.strstart]),h.lookahead--,h.strstart++;if(o&&(O(h,!1),h.strm.avail_out===0))return A}return h.insert=h.strstart<C-1?h.strstart:C-1,Q===T?(O(h,!0),h.strm.avail_out===0?oe:V):h.last_lit&&(O(h,!1),h.strm.avail_out===0)?A:j}function w(h,Q){for(var E,o,a;;){if(h.lookahead<ge){if(z(h),h.lookahead<ge&&Q===b)return A;if(h.lookahead===0)break}if(E=0,h.lookahead>=C&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+C-1])&h.hash_mask,E=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart),h.prev_length=h.match_length,h.prev_match=h.match_start,h.match_length=C-1,E!==0&&h.prev_length<h.max_lazy_match&&h.strstart-E<=h.w_size-ge&&(h.match_length=ie(h,E),h.match_length<=5&&(h.strategy===1||h.match_length===C&&4096<h.strstart-h.match_start)&&(h.match_length=C-1)),h.prev_length>=C&&h.match_length<=h.prev_length){for(a=h.strstart+h.lookahead-C,o=n._tr_tally(h,h.strstart-1-h.prev_match,h.prev_length-C),h.lookahead-=h.prev_length-1,h.prev_length-=2;++h.strstart<=a&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+C-1])&h.hash_mask,E=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart),--h.prev_length!=0;);if(h.match_available=0,h.match_length=C-1,h.strstart++,o&&(O(h,!1),h.strm.avail_out===0))return A}else if(h.match_available){if((o=n._tr_tally(h,0,h.window[h.strstart-1]))&&O(h,!1),h.strstart++,h.lookahead--,h.strm.avail_out===0)return A}else h.match_available=1,h.strstart++,h.lookahead--}return h.match_available&&(o=n._tr_tally(h,0,h.window[h.strstart-1]),h.match_available=0),h.insert=h.strstart<C-1?h.strstart:C-1,Q===T?(O(h,!0),h.strm.avail_out===0?oe:V):h.last_lit&&(O(h,!1),h.strm.avail_out===0)?A:j}function U(h,Q,E,o,a){this.good_length=h,this.max_lazy=Q,this.nice_length=E,this.max_chain=o,this.func=a}function L(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=_,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new c.Buf16(2*G),this.dyn_dtree=new c.Buf16(2*(2*I+1)),this.bl_tree=new c.Buf16(2*(2*X+1)),ee(this.dyn_ltree),ee(this.dyn_dtree),ee(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new c.Buf16(Z+1),this.heap=new c.Buf16(2*N+1),ee(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new c.Buf16(2*N+1),ee(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function D(h){var Q;return h&&h.state?(h.total_in=h.total_out=0,h.data_type=f,(Q=h.state).pending=0,Q.pending_out=0,Q.wrap<0&&(Q.wrap=-Q.wrap),Q.status=Q.wrap?R:H,h.adler=Q.wrap===2?0:1,Q.last_flush=b,n._tr_init(Q),p):we(h,S)}function B(h){var Q=D(h);return Q===p&&function(E){E.window_size=2*E.w_size,ee(E.head),E.max_lazy_match=i[E.level].max_lazy,E.good_match=i[E.level].good_length,E.nice_match=i[E.level].nice_length,E.max_chain_length=i[E.level].max_chain,E.strstart=0,E.block_start=0,E.lookahead=0,E.insert=0,E.match_length=E.prev_length=C-1,E.match_available=0,E.ins_h=0}(h.state),Q}function se(h,Q,E,o,a,d){if(!h)return S;var F=1;if(Q===g&&(Q=6),o<0?(F=0,o=-o):15<o&&(F=2,o-=16),a<1||k<a||E!==_||o<8||15<o||Q<0||9<Q||d<0||x<d)return we(h,S);o===8&&(o=9);var $=new L;return(h.state=$).strm=h,$.wrap=F,$.gzhead=null,$.w_bits=o,$.w_size=1<<$.w_bits,$.w_mask=$.w_size-1,$.hash_bits=a+7,$.hash_size=1<<$.hash_bits,$.hash_mask=$.hash_size-1,$.hash_shift=~~(($.hash_bits+C-1)/C),$.window=new c.Buf8(2*$.w_size),$.head=new c.Buf16($.hash_size),$.prev=new c.Buf16($.w_size),$.lit_bufsize=1<<a+6,$.pending_buf_size=4*$.lit_bufsize,$.pending_buf=new c.Buf8($.pending_buf_size),$.d_buf=1*$.lit_bufsize,$.l_buf=3*$.lit_bufsize,$.level=Q,$.strategy=d,$.method=E,B(h)}i=[new U(0,0,0,0,function(h,Q){var E=65535;for(E>h.pending_buf_size-5&&(E=h.pending_buf_size-5);;){if(h.lookahead<=1){if(z(h),h.lookahead===0&&Q===b)return A;if(h.lookahead===0)break}h.strstart+=h.lookahead,h.lookahead=0;var o=h.block_start+E;if((h.strstart===0||h.strstart>=o)&&(h.lookahead=h.strstart-o,h.strstart=o,O(h,!1),h.strm.avail_out===0)||h.strstart-h.block_start>=h.w_size-ge&&(O(h,!1),h.strm.avail_out===0))return A}return h.insert=0,Q===T?(O(h,!0),h.strm.avail_out===0?oe:V):(h.strstart>h.block_start&&(O(h,!1),h.strm.avail_out),A)}),new U(4,4,8,4,v),new U(4,5,16,8,v),new U(4,6,32,32,v),new U(4,4,16,16,w),new U(8,16,32,32,w),new U(8,16,128,128,w),new U(8,32,128,256,w),new U(32,128,258,1024,w),new U(32,258,258,4096,w)],l.deflateInit=function(h,Q){return se(h,Q,_,15,8,0)},l.deflateInit2=se,l.deflateReset=B,l.deflateResetKeep=D,l.deflateSetHeader=function(h,Q){return h&&h.state?h.state.wrap!==2?S:(h.state.gzhead=Q,p):S},l.deflate=function(h,Q){var E,o,a,d;if(!h||!h.state||5<Q||Q<0)return h?we(h,S):S;if(o=h.state,!h.output||!h.input&&h.avail_in!==0||o.status===666&&Q!==T)return we(h,h.avail_out===0?-5:S);if(o.strm=h,E=o.last_flush,o.last_flush=Q,o.status===R)if(o.wrap===2)h.adler=0,K(o,31),K(o,139),K(o,8),o.gzhead?(K(o,(o.gzhead.text?1:0)+(o.gzhead.hcrc?2:0)+(o.gzhead.extra?4:0)+(o.gzhead.name?8:0)+(o.gzhead.comment?16:0)),K(o,255&o.gzhead.time),K(o,o.gzhead.time>>8&255),K(o,o.gzhead.time>>16&255),K(o,o.gzhead.time>>24&255),K(o,o.level===9?2:2<=o.strategy||o.level<2?4:0),K(o,255&o.gzhead.os),o.gzhead.extra&&o.gzhead.extra.length&&(K(o,255&o.gzhead.extra.length),K(o,o.gzhead.extra.length>>8&255)),o.gzhead.hcrc&&(h.adler=m(h.adler,o.pending_buf,o.pending,0)),o.gzindex=0,o.status=69):(K(o,0),K(o,0),K(o,0),K(o,0),K(o,0),K(o,o.level===9?2:2<=o.strategy||o.level<2?4:0),K(o,3),o.status=H);else{var F=_+(o.w_bits-8<<4)<<8;F|=(2<=o.strategy||o.level<2?0:o.level<6?1:o.level===6?2:3)<<6,o.strstart!==0&&(F|=32),F+=31-F%31,o.status=H,q(o,F),o.strstart!==0&&(q(o,h.adler>>>16),q(o,65535&h.adler)),h.adler=1}if(o.status===69)if(o.gzhead.extra){for(a=o.pending;o.gzindex<(65535&o.gzhead.extra.length)&&(o.pending!==o.pending_buf_size||(o.gzhead.hcrc&&o.pending>a&&(h.adler=m(h.adler,o.pending_buf,o.pending-a,a)),M(h),a=o.pending,o.pending!==o.pending_buf_size));)K(o,255&o.gzhead.extra[o.gzindex]),o.gzindex++;o.gzhead.hcrc&&o.pending>a&&(h.adler=m(h.adler,o.pending_buf,o.pending-a,a)),o.gzindex===o.gzhead.extra.length&&(o.gzindex=0,o.status=73)}else o.status=73;if(o.status===73)if(o.gzhead.name){a=o.pending;do{if(o.pending===o.pending_buf_size&&(o.gzhead.hcrc&&o.pending>a&&(h.adler=m(h.adler,o.pending_buf,o.pending-a,a)),M(h),a=o.pending,o.pending===o.pending_buf_size)){d=1;break}d=o.gzindex<o.gzhead.name.length?255&o.gzhead.name.charCodeAt(o.gzindex++):0,K(o,d)}while(d!==0);o.gzhead.hcrc&&o.pending>a&&(h.adler=m(h.adler,o.pending_buf,o.pending-a,a)),d===0&&(o.gzindex=0,o.status=91)}else o.status=91;if(o.status===91)if(o.gzhead.comment){a=o.pending;do{if(o.pending===o.pending_buf_size&&(o.gzhead.hcrc&&o.pending>a&&(h.adler=m(h.adler,o.pending_buf,o.pending-a,a)),M(h),a=o.pending,o.pending===o.pending_buf_size)){d=1;break}d=o.gzindex<o.gzhead.comment.length?255&o.gzhead.comment.charCodeAt(o.gzindex++):0,K(o,d)}while(d!==0);o.gzhead.hcrc&&o.pending>a&&(h.adler=m(h.adler,o.pending_buf,o.pending-a,a)),d===0&&(o.status=103)}else o.status=103;if(o.status===103&&(o.gzhead.hcrc?(o.pending+2>o.pending_buf_size&&M(h),o.pending+2<=o.pending_buf_size&&(K(o,255&h.adler),K(o,h.adler>>8&255),h.adler=0,o.status=H)):o.status=H),o.pending!==0){if(M(h),h.avail_out===0)return o.last_flush=-1,p}else if(h.avail_in===0&&Y(Q)<=Y(E)&&Q!==T)return we(h,-5);if(o.status===666&&h.avail_in!==0)return we(h,-5);if(h.avail_in!==0||o.lookahead!==0||Q!==b&&o.status!==666){var $=o.strategy===2?function(P,ue){for(var ve;;){if(P.lookahead===0&&(z(P),P.lookahead===0)){if(ue===b)return A;break}if(P.match_length=0,ve=n._tr_tally(P,0,P.window[P.strstart]),P.lookahead--,P.strstart++,ve&&(O(P,!1),P.strm.avail_out===0))return A}return P.insert=0,ue===T?(O(P,!0),P.strm.avail_out===0?oe:V):P.last_lit&&(O(P,!1),P.strm.avail_out===0)?A:j}(o,Q):o.strategy===3?function(P,ue){for(var ve,ae,xe,ke,Ne=P.window;;){if(P.lookahead<=ce){if(z(P),P.lookahead<=ce&&ue===b)return A;if(P.lookahead===0)break}if(P.match_length=0,P.lookahead>=C&&0<P.strstart&&(ae=Ne[xe=P.strstart-1])===Ne[++xe]&&ae===Ne[++xe]&&ae===Ne[++xe]){ke=P.strstart+ce;do;while(ae===Ne[++xe]&&ae===Ne[++xe]&&ae===Ne[++xe]&&ae===Ne[++xe]&&ae===Ne[++xe]&&ae===Ne[++xe]&&ae===Ne[++xe]&&ae===Ne[++xe]&&xe<ke);P.match_length=ce-(ke-xe),P.match_length>P.lookahead&&(P.match_length=P.lookahead)}if(P.match_length>=C?(ve=n._tr_tally(P,1,P.match_length-C),P.lookahead-=P.match_length,P.strstart+=P.match_length,P.match_length=0):(ve=n._tr_tally(P,0,P.window[P.strstart]),P.lookahead--,P.strstart++),ve&&(O(P,!1),P.strm.avail_out===0))return A}return P.insert=0,ue===T?(O(P,!0),P.strm.avail_out===0?oe:V):P.last_lit&&(O(P,!1),P.strm.avail_out===0)?A:j}(o,Q):i[o.level].func(o,Q);if($!==oe&&$!==V||(o.status=666),$===A||$===oe)return h.avail_out===0&&(o.last_flush=-1),p;if($===j&&(Q===1?n._tr_align(o):Q!==5&&(n._tr_stored_block(o,0,0,!1),Q===3&&(ee(o.head),o.lookahead===0&&(o.strstart=0,o.block_start=0,o.insert=0))),M(h),h.avail_out===0))return o.last_flush=-1,p}return Q!==T?p:o.wrap<=0?1:(o.wrap===2?(K(o,255&h.adler),K(o,h.adler>>8&255),K(o,h.adler>>16&255),K(o,h.adler>>24&255),K(o,255&h.total_in),K(o,h.total_in>>8&255),K(o,h.total_in>>16&255),K(o,h.total_in>>24&255)):(q(o,h.adler>>>16),q(o,65535&h.adler)),M(h),0<o.wrap&&(o.wrap=-o.wrap),o.pending!==0?p:1)},l.deflateEnd=function(h){var Q;return h&&h.state?(Q=h.state.status)!==R&&Q!==69&&Q!==73&&Q!==91&&Q!==103&&Q!==H&&Q!==666?we(h,S):(h.state=null,Q===H?we(h,-3):p):S},l.deflateSetDictionary=function(h,Q){var E,o,a,d,F,$,P,ue,ve=Q.length;if(!h||!h.state||(d=(E=h.state).wrap)===2||d===1&&E.status!==R||E.lookahead)return S;for(d===1&&(h.adler=u(h.adler,Q,ve,0)),E.wrap=0,ve>=E.w_size&&(d===0&&(ee(E.head),E.strstart=0,E.block_start=0,E.insert=0),ue=new c.Buf8(E.w_size),c.arraySet(ue,Q,ve-E.w_size,E.w_size,0),Q=ue,ve=E.w_size),F=h.avail_in,$=h.next_in,P=h.input,h.avail_in=ve,h.next_in=0,h.input=Q,z(E);E.lookahead>=C;){for(o=E.strstart,a=E.lookahead-(C-1);E.ins_h=(E.ins_h<<E.hash_shift^E.window[o+C-1])&E.hash_mask,E.prev[o&E.w_mask]=E.head[E.ins_h],E.head[E.ins_h]=o,o++,--a;);E.strstart=o,E.lookahead=C-1,z(E)}return E.strstart+=E.lookahead,E.block_start=E.strstart,E.insert=E.lookahead,E.lookahead=0,E.match_length=E.prev_length=C-1,E.match_available=0,h.next_in=$,h.input=P,h.avail_in=F,E.wrap=d,p},l.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,s,l){s.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,s,l){s.exports=function(i,c){var n,u,m,y,b,T,p,S,g,x,f,_,k,N,I,X,G,Z,C,ce,ge,R,H,A,j;n=i.state,u=i.next_in,A=i.input,m=u+(i.avail_in-5),y=i.next_out,j=i.output,b=y-(c-i.avail_out),T=y+(i.avail_out-257),p=n.dmax,S=n.wsize,g=n.whave,x=n.wnext,f=n.window,_=n.hold,k=n.bits,N=n.lencode,I=n.distcode,X=(1<<n.lenbits)-1,G=(1<<n.distbits)-1;e:do{k<15&&(_+=A[u++]<<k,k+=8,_+=A[u++]<<k,k+=8),Z=N[_&X];t:for(;;){if(_>>>=C=Z>>>24,k-=C,(C=Z>>>16&255)===0)j[y++]=65535&Z;else{if(!(16&C)){if(!(64&C)){Z=N[(65535&Z)+(_&(1<<C)-1)];continue t}if(32&C){n.mode=12;break e}i.msg="invalid literal/length code",n.mode=30;break e}ce=65535&Z,(C&=15)&&(k<C&&(_+=A[u++]<<k,k+=8),ce+=_&(1<<C)-1,_>>>=C,k-=C),k<15&&(_+=A[u++]<<k,k+=8,_+=A[u++]<<k,k+=8),Z=I[_&G];r:for(;;){if(_>>>=C=Z>>>24,k-=C,!(16&(C=Z>>>16&255))){if(!(64&C)){Z=I[(65535&Z)+(_&(1<<C)-1)];continue r}i.msg="invalid distance code",n.mode=30;break e}if(ge=65535&Z,k<(C&=15)&&(_+=A[u++]<<k,(k+=8)<C&&(_+=A[u++]<<k,k+=8)),p<(ge+=_&(1<<C)-1)){i.msg="invalid distance too far back",n.mode=30;break e}if(_>>>=C,k-=C,(C=y-b)<ge){if(g<(C=ge-C)&&n.sane){i.msg="invalid distance too far back",n.mode=30;break e}if(H=f,(R=0)===x){if(R+=S-C,C<ce){for(ce-=C;j[y++]=f[R++],--C;);R=y-ge,H=j}}else if(x<C){if(R+=S+x-C,(C-=x)<ce){for(ce-=C;j[y++]=f[R++],--C;);if(R=0,x<ce){for(ce-=C=x;j[y++]=f[R++],--C;);R=y-ge,H=j}}}else if(R+=x-C,C<ce){for(ce-=C;j[y++]=f[R++],--C;);R=y-ge,H=j}for(;2<ce;)j[y++]=H[R++],j[y++]=H[R++],j[y++]=H[R++],ce-=3;ce&&(j[y++]=H[R++],1<ce&&(j[y++]=H[R++]))}else{for(R=y-ge;j[y++]=j[R++],j[y++]=j[R++],j[y++]=j[R++],2<(ce-=3););ce&&(j[y++]=j[R++],1<ce&&(j[y++]=j[R++]))}break}}break}}while(u<m&&y<T);u-=ce=k>>3,_&=(1<<(k-=ce<<3))-1,i.next_in=u,i.next_out=y,i.avail_in=u<m?m-u+5:5-(u-m),i.avail_out=y<T?T-y+257:257-(y-T),n.hold=_,n.bits=k}},{}],49:[function(t,s,l){var i=t("../utils/common"),c=t("./adler32"),n=t("./crc32"),u=t("./inffast"),m=t("./inftrees"),y=1,b=2,T=0,p=-2,S=1,g=852,x=592;function f(R){return(R>>>24&255)+(R>>>8&65280)+((65280&R)<<8)+((255&R)<<24)}function _(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function k(R){var H;return R&&R.state?(H=R.state,R.total_in=R.total_out=H.total=0,R.msg="",H.wrap&&(R.adler=1&H.wrap),H.mode=S,H.last=0,H.havedict=0,H.dmax=32768,H.head=null,H.hold=0,H.bits=0,H.lencode=H.lendyn=new i.Buf32(g),H.distcode=H.distdyn=new i.Buf32(x),H.sane=1,H.back=-1,T):p}function N(R){var H;return R&&R.state?((H=R.state).wsize=0,H.whave=0,H.wnext=0,k(R)):p}function I(R,H){var A,j;return R&&R.state?(j=R.state,H<0?(A=0,H=-H):(A=1+(H>>4),H<48&&(H&=15)),H&&(H<8||15<H)?p:(j.window!==null&&j.wbits!==H&&(j.window=null),j.wrap=A,j.wbits=H,N(R))):p}function X(R,H){var A,j;return R?(j=new _,(R.state=j).window=null,(A=I(R,H))!==T&&(R.state=null),A):p}var G,Z,C=!0;function ce(R){if(C){var H;for(G=new i.Buf32(512),Z=new i.Buf32(32),H=0;H<144;)R.lens[H++]=8;for(;H<256;)R.lens[H++]=9;for(;H<280;)R.lens[H++]=7;for(;H<288;)R.lens[H++]=8;for(m(y,R.lens,0,288,G,0,R.work,{bits:9}),H=0;H<32;)R.lens[H++]=5;m(b,R.lens,0,32,Z,0,R.work,{bits:5}),C=!1}R.lencode=G,R.lenbits=9,R.distcode=Z,R.distbits=5}function ge(R,H,A,j){var oe,V=R.state;return V.window===null&&(V.wsize=1<<V.wbits,V.wnext=0,V.whave=0,V.window=new i.Buf8(V.wsize)),j>=V.wsize?(i.arraySet(V.window,H,A-V.wsize,V.wsize,0),V.wnext=0,V.whave=V.wsize):(j<(oe=V.wsize-V.wnext)&&(oe=j),i.arraySet(V.window,H,A-j,oe,V.wnext),(j-=oe)?(i.arraySet(V.window,H,A-j,j,0),V.wnext=j,V.whave=V.wsize):(V.wnext+=oe,V.wnext===V.wsize&&(V.wnext=0),V.whave<V.wsize&&(V.whave+=oe))),0}l.inflateReset=N,l.inflateReset2=I,l.inflateResetKeep=k,l.inflateInit=function(R){return X(R,15)},l.inflateInit2=X,l.inflate=function(R,H){var A,j,oe,V,we,Y,ee,M,O,K,q,ie,z,v,w,U,L,D,B,se,h,Q,E,o,a=0,d=new i.Buf8(4),F=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!R||!R.state||!R.output||!R.input&&R.avail_in!==0)return p;(A=R.state).mode===12&&(A.mode=13),we=R.next_out,oe=R.output,ee=R.avail_out,V=R.next_in,j=R.input,Y=R.avail_in,M=A.hold,O=A.bits,K=Y,q=ee,Q=T;e:for(;;)switch(A.mode){case S:if(A.wrap===0){A.mode=13;break}for(;O<16;){if(Y===0)break e;Y--,M+=j[V++]<<O,O+=8}if(2&A.wrap&&M===35615){d[A.check=0]=255&M,d[1]=M>>>8&255,A.check=n(A.check,d,2,0),O=M=0,A.mode=2;break}if(A.flags=0,A.head&&(A.head.done=!1),!(1&A.wrap)||(((255&M)<<8)+(M>>8))%31){R.msg="incorrect header check",A.mode=30;break}if((15&M)!=8){R.msg="unknown compression method",A.mode=30;break}if(O-=4,h=8+(15&(M>>>=4)),A.wbits===0)A.wbits=h;else if(h>A.wbits){R.msg="invalid window size",A.mode=30;break}A.dmax=1<<h,R.adler=A.check=1,A.mode=512&M?10:12,O=M=0;break;case 2:for(;O<16;){if(Y===0)break e;Y--,M+=j[V++]<<O,O+=8}if(A.flags=M,(255&A.flags)!=8){R.msg="unknown compression method",A.mode=30;break}if(57344&A.flags){R.msg="unknown header flags set",A.mode=30;break}A.head&&(A.head.text=M>>8&1),512&A.flags&&(d[0]=255&M,d[1]=M>>>8&255,A.check=n(A.check,d,2,0)),O=M=0,A.mode=3;case 3:for(;O<32;){if(Y===0)break e;Y--,M+=j[V++]<<O,O+=8}A.head&&(A.head.time=M),512&A.flags&&(d[0]=255&M,d[1]=M>>>8&255,d[2]=M>>>16&255,d[3]=M>>>24&255,A.check=n(A.check,d,4,0)),O=M=0,A.mode=4;case 4:for(;O<16;){if(Y===0)break e;Y--,M+=j[V++]<<O,O+=8}A.head&&(A.head.xflags=255&M,A.head.os=M>>8),512&A.flags&&(d[0]=255&M,d[1]=M>>>8&255,A.check=n(A.check,d,2,0)),O=M=0,A.mode=5;case 5:if(1024&A.flags){for(;O<16;){if(Y===0)break e;Y--,M+=j[V++]<<O,O+=8}A.length=M,A.head&&(A.head.extra_len=M),512&A.flags&&(d[0]=255&M,d[1]=M>>>8&255,A.check=n(A.check,d,2,0)),O=M=0}else A.head&&(A.head.extra=null);A.mode=6;case 6:if(1024&A.flags&&(Y<(ie=A.length)&&(ie=Y),ie&&(A.head&&(h=A.head.extra_len-A.length,A.head.extra||(A.head.extra=new Array(A.head.extra_len)),i.arraySet(A.head.extra,j,V,ie,h)),512&A.flags&&(A.check=n(A.check,j,ie,V)),Y-=ie,V+=ie,A.length-=ie),A.length))break e;A.length=0,A.mode=7;case 7:if(2048&A.flags){if(Y===0)break e;for(ie=0;h=j[V+ie++],A.head&&h&&A.length<65536&&(A.head.name+=String.fromCharCode(h)),h&&ie<Y;);if(512&A.flags&&(A.check=n(A.check,j,ie,V)),Y-=ie,V+=ie,h)break e}else A.head&&(A.head.name=null);A.length=0,A.mode=8;case 8:if(4096&A.flags){if(Y===0)break e;for(ie=0;h=j[V+ie++],A.head&&h&&A.length<65536&&(A.head.comment+=String.fromCharCode(h)),h&&ie<Y;);if(512&A.flags&&(A.check=n(A.check,j,ie,V)),Y-=ie,V+=ie,h)break e}else A.head&&(A.head.comment=null);A.mode=9;case 9:if(512&A.flags){for(;O<16;){if(Y===0)break e;Y--,M+=j[V++]<<O,O+=8}if(M!==(65535&A.check)){R.msg="header crc mismatch",A.mode=30;break}O=M=0}A.head&&(A.head.hcrc=A.flags>>9&1,A.head.done=!0),R.adler=A.check=0,A.mode=12;break;case 10:for(;O<32;){if(Y===0)break e;Y--,M+=j[V++]<<O,O+=8}R.adler=A.check=f(M),O=M=0,A.mode=11;case 11:if(A.havedict===0)return R.next_out=we,R.avail_out=ee,R.next_in=V,R.avail_in=Y,A.hold=M,A.bits=O,2;R.adler=A.check=1,A.mode=12;case 12:if(H===5||H===6)break e;case 13:if(A.last){M>>>=7&O,O-=7&O,A.mode=27;break}for(;O<3;){if(Y===0)break e;Y--,M+=j[V++]<<O,O+=8}switch(A.last=1&M,O-=1,3&(M>>>=1)){case 0:A.mode=14;break;case 1:if(ce(A),A.mode=20,H!==6)break;M>>>=2,O-=2;break e;case 2:A.mode=17;break;case 3:R.msg="invalid block type",A.mode=30}M>>>=2,O-=2;break;case 14:for(M>>>=7&O,O-=7&O;O<32;){if(Y===0)break e;Y--,M+=j[V++]<<O,O+=8}if((65535&M)!=(M>>>16^65535)){R.msg="invalid stored block lengths",A.mode=30;break}if(A.length=65535&M,O=M=0,A.mode=15,H===6)break e;case 15:A.mode=16;case 16:if(ie=A.length){if(Y<ie&&(ie=Y),ee<ie&&(ie=ee),ie===0)break e;i.arraySet(oe,j,V,ie,we),Y-=ie,V+=ie,ee-=ie,we+=ie,A.length-=ie;break}A.mode=12;break;case 17:for(;O<14;){if(Y===0)break e;Y--,M+=j[V++]<<O,O+=8}if(A.nlen=257+(31&M),M>>>=5,O-=5,A.ndist=1+(31&M),M>>>=5,O-=5,A.ncode=4+(15&M),M>>>=4,O-=4,286<A.nlen||30<A.ndist){R.msg="too many length or distance symbols",A.mode=30;break}A.have=0,A.mode=18;case 18:for(;A.have<A.ncode;){for(;O<3;){if(Y===0)break e;Y--,M+=j[V++]<<O,O+=8}A.lens[F[A.have++]]=7&M,M>>>=3,O-=3}for(;A.have<19;)A.lens[F[A.have++]]=0;if(A.lencode=A.lendyn,A.lenbits=7,E={bits:A.lenbits},Q=m(0,A.lens,0,19,A.lencode,0,A.work,E),A.lenbits=E.bits,Q){R.msg="invalid code lengths set",A.mode=30;break}A.have=0,A.mode=19;case 19:for(;A.have<A.nlen+A.ndist;){for(;U=(a=A.lencode[M&(1<<A.lenbits)-1])>>>16&255,L=65535&a,!((w=a>>>24)<=O);){if(Y===0)break e;Y--,M+=j[V++]<<O,O+=8}if(L<16)M>>>=w,O-=w,A.lens[A.have++]=L;else{if(L===16){for(o=w+2;O<o;){if(Y===0)break e;Y--,M+=j[V++]<<O,O+=8}if(M>>>=w,O-=w,A.have===0){R.msg="invalid bit length repeat",A.mode=30;break}h=A.lens[A.have-1],ie=3+(3&M),M>>>=2,O-=2}else if(L===17){for(o=w+3;O<o;){if(Y===0)break e;Y--,M+=j[V++]<<O,O+=8}O-=w,h=0,ie=3+(7&(M>>>=w)),M>>>=3,O-=3}else{for(o=w+7;O<o;){if(Y===0)break e;Y--,M+=j[V++]<<O,O+=8}O-=w,h=0,ie=11+(127&(M>>>=w)),M>>>=7,O-=7}if(A.have+ie>A.nlen+A.ndist){R.msg="invalid bit length repeat",A.mode=30;break}for(;ie--;)A.lens[A.have++]=h}}if(A.mode===30)break;if(A.lens[256]===0){R.msg="invalid code -- missing end-of-block",A.mode=30;break}if(A.lenbits=9,E={bits:A.lenbits},Q=m(y,A.lens,0,A.nlen,A.lencode,0,A.work,E),A.lenbits=E.bits,Q){R.msg="invalid literal/lengths set",A.mode=30;break}if(A.distbits=6,A.distcode=A.distdyn,E={bits:A.distbits},Q=m(b,A.lens,A.nlen,A.ndist,A.distcode,0,A.work,E),A.distbits=E.bits,Q){R.msg="invalid distances set",A.mode=30;break}if(A.mode=20,H===6)break e;case 20:A.mode=21;case 21:if(6<=Y&&258<=ee){R.next_out=we,R.avail_out=ee,R.next_in=V,R.avail_in=Y,A.hold=M,A.bits=O,u(R,q),we=R.next_out,oe=R.output,ee=R.avail_out,V=R.next_in,j=R.input,Y=R.avail_in,M=A.hold,O=A.bits,A.mode===12&&(A.back=-1);break}for(A.back=0;U=(a=A.lencode[M&(1<<A.lenbits)-1])>>>16&255,L=65535&a,!((w=a>>>24)<=O);){if(Y===0)break e;Y--,M+=j[V++]<<O,O+=8}if(U&&!(240&U)){for(D=w,B=U,se=L;U=(a=A.lencode[se+((M&(1<<D+B)-1)>>D)])>>>16&255,L=65535&a,!(D+(w=a>>>24)<=O);){if(Y===0)break e;Y--,M+=j[V++]<<O,O+=8}M>>>=D,O-=D,A.back+=D}if(M>>>=w,O-=w,A.back+=w,A.length=L,U===0){A.mode=26;break}if(32&U){A.back=-1,A.mode=12;break}if(64&U){R.msg="invalid literal/length code",A.mode=30;break}A.extra=15&U,A.mode=22;case 22:if(A.extra){for(o=A.extra;O<o;){if(Y===0)break e;Y--,M+=j[V++]<<O,O+=8}A.length+=M&(1<<A.extra)-1,M>>>=A.extra,O-=A.extra,A.back+=A.extra}A.was=A.length,A.mode=23;case 23:for(;U=(a=A.distcode[M&(1<<A.distbits)-1])>>>16&255,L=65535&a,!((w=a>>>24)<=O);){if(Y===0)break e;Y--,M+=j[V++]<<O,O+=8}if(!(240&U)){for(D=w,B=U,se=L;U=(a=A.distcode[se+((M&(1<<D+B)-1)>>D)])>>>16&255,L=65535&a,!(D+(w=a>>>24)<=O);){if(Y===0)break e;Y--,M+=j[V++]<<O,O+=8}M>>>=D,O-=D,A.back+=D}if(M>>>=w,O-=w,A.back+=w,64&U){R.msg="invalid distance code",A.mode=30;break}A.offset=L,A.extra=15&U,A.mode=24;case 24:if(A.extra){for(o=A.extra;O<o;){if(Y===0)break e;Y--,M+=j[V++]<<O,O+=8}A.offset+=M&(1<<A.extra)-1,M>>>=A.extra,O-=A.extra,A.back+=A.extra}if(A.offset>A.dmax){R.msg="invalid distance too far back",A.mode=30;break}A.mode=25;case 25:if(ee===0)break e;if(ie=q-ee,A.offset>ie){if((ie=A.offset-ie)>A.whave&&A.sane){R.msg="invalid distance too far back",A.mode=30;break}z=ie>A.wnext?(ie-=A.wnext,A.wsize-ie):A.wnext-ie,ie>A.length&&(ie=A.length),v=A.window}else v=oe,z=we-A.offset,ie=A.length;for(ee<ie&&(ie=ee),ee-=ie,A.length-=ie;oe[we++]=v[z++],--ie;);A.length===0&&(A.mode=21);break;case 26:if(ee===0)break e;oe[we++]=A.length,ee--,A.mode=21;break;case 27:if(A.wrap){for(;O<32;){if(Y===0)break e;Y--,M|=j[V++]<<O,O+=8}if(q-=ee,R.total_out+=q,A.total+=q,q&&(R.adler=A.check=A.flags?n(A.check,oe,q,we-q):c(A.check,oe,q,we-q)),q=ee,(A.flags?M:f(M))!==A.check){R.msg="incorrect data check",A.mode=30;break}O=M=0}A.mode=28;case 28:if(A.wrap&&A.flags){for(;O<32;){if(Y===0)break e;Y--,M+=j[V++]<<O,O+=8}if(M!==(4294967295&A.total)){R.msg="incorrect length check",A.mode=30;break}O=M=0}A.mode=29;case 29:Q=1;break e;case 30:Q=-3;break e;case 31:return-4;case 32:default:return p}return R.next_out=we,R.avail_out=ee,R.next_in=V,R.avail_in=Y,A.hold=M,A.bits=O,(A.wsize||q!==R.avail_out&&A.mode<30&&(A.mode<27||H!==4))&&ge(R,R.output,R.next_out,q-R.avail_out)?(A.mode=31,-4):(K-=R.avail_in,q-=R.avail_out,R.total_in+=K,R.total_out+=q,A.total+=q,A.wrap&&q&&(R.adler=A.check=A.flags?n(A.check,oe,q,R.next_out-q):c(A.check,oe,q,R.next_out-q)),R.data_type=A.bits+(A.last?64:0)+(A.mode===12?128:0)+(A.mode===20||A.mode===15?256:0),(K==0&&q===0||H===4)&&Q===T&&(Q=-5),Q)},l.inflateEnd=function(R){if(!R||!R.state)return p;var H=R.state;return H.window&&(H.window=null),R.state=null,T},l.inflateGetHeader=function(R,H){var A;return R&&R.state&&2&(A=R.state).wrap?((A.head=H).done=!1,T):p},l.inflateSetDictionary=function(R,H){var A,j=H.length;return R&&R.state?(A=R.state).wrap!==0&&A.mode!==11?p:A.mode===11&&c(1,H,j,0)!==A.check?-3:ge(R,H,j,j)?(A.mode=31,-4):(A.havedict=1,T):p},l.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,s,l){var i=t("../utils/common"),c=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],n=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],u=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],m=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];s.exports=function(y,b,T,p,S,g,x,f){var _,k,N,I,X,G,Z,C,ce,ge=f.bits,R=0,H=0,A=0,j=0,oe=0,V=0,we=0,Y=0,ee=0,M=0,O=null,K=0,q=new i.Buf16(16),ie=new i.Buf16(16),z=null,v=0;for(R=0;R<=15;R++)q[R]=0;for(H=0;H<p;H++)q[b[T+H]]++;for(oe=ge,j=15;1<=j&&q[j]===0;j--);if(j<oe&&(oe=j),j===0)return S[g++]=20971520,S[g++]=20971520,f.bits=1,0;for(A=1;A<j&&q[A]===0;A++);for(oe<A&&(oe=A),R=Y=1;R<=15;R++)if(Y<<=1,(Y-=q[R])<0)return-1;if(0<Y&&(y===0||j!==1))return-1;for(ie[1]=0,R=1;R<15;R++)ie[R+1]=ie[R]+q[R];for(H=0;H<p;H++)b[T+H]!==0&&(x[ie[b[T+H]]++]=H);if(G=y===0?(O=z=x,19):y===1?(O=c,K-=257,z=n,v-=257,256):(O=u,z=m,-1),R=A,X=g,we=H=M=0,N=-1,I=(ee=1<<(V=oe))-1,y===1&&852<ee||y===2&&592<ee)return 1;for(;;){for(Z=R-we,ce=x[H]<G?(C=0,x[H]):x[H]>G?(C=z[v+x[H]],O[K+x[H]]):(C=96,0),_=1<<R-we,A=k=1<<V;S[X+(M>>we)+(k-=_)]=Z<<24|C<<16|ce|0,k!==0;);for(_=1<<R-1;M&_;)_>>=1;if(_!==0?(M&=_-1,M+=_):M=0,H++,--q[R]==0){if(R===j)break;R=b[T+x[H]]}if(oe<R&&(M&I)!==N){for(we===0&&(we=oe),X+=A,Y=1<<(V=R-we);V+we<j&&!((Y-=q[V+we])<=0);)V++,Y<<=1;if(ee+=1<<V,y===1&&852<ee||y===2&&592<ee)return 1;S[N=M&I]=oe<<24|V<<16|X-g|0}}return M!==0&&(S[X+M]=R-we<<24|64<<16|0),f.bits=oe,0}},{"../utils/common":41}],51:[function(t,s,l){s.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,s,l){var i=t("../utils/common"),c=0,n=1;function u(a){for(var d=a.length;0<=--d;)a[d]=0}var m=0,y=29,b=256,T=b+1+y,p=30,S=19,g=2*T+1,x=15,f=16,_=7,k=256,N=16,I=17,X=18,G=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Z=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],C=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],ce=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ge=new Array(2*(T+2));u(ge);var R=new Array(2*p);u(R);var H=new Array(512);u(H);var A=new Array(256);u(A);var j=new Array(y);u(j);var oe,V,we,Y=new Array(p);function ee(a,d,F,$,P){this.static_tree=a,this.extra_bits=d,this.extra_base=F,this.elems=$,this.max_length=P,this.has_stree=a&&a.length}function M(a,d){this.dyn_tree=a,this.max_code=0,this.stat_desc=d}function O(a){return a<256?H[a]:H[256+(a>>>7)]}function K(a,d){a.pending_buf[a.pending++]=255&d,a.pending_buf[a.pending++]=d>>>8&255}function q(a,d,F){a.bi_valid>f-F?(a.bi_buf|=d<<a.bi_valid&65535,K(a,a.bi_buf),a.bi_buf=d>>f-a.bi_valid,a.bi_valid+=F-f):(a.bi_buf|=d<<a.bi_valid&65535,a.bi_valid+=F)}function ie(a,d,F){q(a,F[2*d],F[2*d+1])}function z(a,d){for(var F=0;F|=1&a,a>>>=1,F<<=1,0<--d;);return F>>>1}function v(a,d,F){var $,P,ue=new Array(x+1),ve=0;for($=1;$<=x;$++)ue[$]=ve=ve+F[$-1]<<1;for(P=0;P<=d;P++){var ae=a[2*P+1];ae!==0&&(a[2*P]=z(ue[ae]++,ae))}}function w(a){var d;for(d=0;d<T;d++)a.dyn_ltree[2*d]=0;for(d=0;d<p;d++)a.dyn_dtree[2*d]=0;for(d=0;d<S;d++)a.bl_tree[2*d]=0;a.dyn_ltree[2*k]=1,a.opt_len=a.static_len=0,a.last_lit=a.matches=0}function U(a){8<a.bi_valid?K(a,a.bi_buf):0<a.bi_valid&&(a.pending_buf[a.pending++]=a.bi_buf),a.bi_buf=0,a.bi_valid=0}function L(a,d,F,$){var P=2*d,ue=2*F;return a[P]<a[ue]||a[P]===a[ue]&&$[d]<=$[F]}function D(a,d,F){for(var $=a.heap[F],P=F<<1;P<=a.heap_len&&(P<a.heap_len&&L(d,a.heap[P+1],a.heap[P],a.depth)&&P++,!L(d,$,a.heap[P],a.depth));)a.heap[F]=a.heap[P],F=P,P<<=1;a.heap[F]=$}function B(a,d,F){var $,P,ue,ve,ae=0;if(a.last_lit!==0)for(;$=a.pending_buf[a.d_buf+2*ae]<<8|a.pending_buf[a.d_buf+2*ae+1],P=a.pending_buf[a.l_buf+ae],ae++,$===0?ie(a,P,d):(ie(a,(ue=A[P])+b+1,d),(ve=G[ue])!==0&&q(a,P-=j[ue],ve),ie(a,ue=O(--$),F),(ve=Z[ue])!==0&&q(a,$-=Y[ue],ve)),ae<a.last_lit;);ie(a,k,d)}function se(a,d){var F,$,P,ue=d.dyn_tree,ve=d.stat_desc.static_tree,ae=d.stat_desc.has_stree,xe=d.stat_desc.elems,ke=-1;for(a.heap_len=0,a.heap_max=g,F=0;F<xe;F++)ue[2*F]!==0?(a.heap[++a.heap_len]=ke=F,a.depth[F]=0):ue[2*F+1]=0;for(;a.heap_len<2;)ue[2*(P=a.heap[++a.heap_len]=ke<2?++ke:0)]=1,a.depth[P]=0,a.opt_len--,ae&&(a.static_len-=ve[2*P+1]);for(d.max_code=ke,F=a.heap_len>>1;1<=F;F--)D(a,ue,F);for(P=xe;F=a.heap[1],a.heap[1]=a.heap[a.heap_len--],D(a,ue,1),$=a.heap[1],a.heap[--a.heap_max]=F,a.heap[--a.heap_max]=$,ue[2*P]=ue[2*F]+ue[2*$],a.depth[P]=(a.depth[F]>=a.depth[$]?a.depth[F]:a.depth[$])+1,ue[2*F+1]=ue[2*$+1]=P,a.heap[1]=P++,D(a,ue,1),2<=a.heap_len;);a.heap[--a.heap_max]=a.heap[1],function(Ne,ot){var mt,ft,Et,Ge,xt,W,re=ot.dyn_tree,fe=ot.max_code,be=ot.stat_desc.static_tree,Te=ot.stat_desc.has_stree,Ee=ot.stat_desc.extra_bits,Ce=ot.stat_desc.extra_base,Ie=ot.stat_desc.max_length,Ue=0;for(Ge=0;Ge<=x;Ge++)Ne.bl_count[Ge]=0;for(re[2*Ne.heap[Ne.heap_max]+1]=0,mt=Ne.heap_max+1;mt<g;mt++)Ie<(Ge=re[2*re[2*(ft=Ne.heap[mt])+1]+1]+1)&&(Ge=Ie,Ue++),re[2*ft+1]=Ge,fe<ft||(Ne.bl_count[Ge]++,xt=0,Ce<=ft&&(xt=Ee[ft-Ce]),W=re[2*ft],Ne.opt_len+=W*(Ge+xt),Te&&(Ne.static_len+=W*(be[2*ft+1]+xt)));if(Ue!==0){do{for(Ge=Ie-1;Ne.bl_count[Ge]===0;)Ge--;Ne.bl_count[Ge]--,Ne.bl_count[Ge+1]+=2,Ne.bl_count[Ie]--,Ue-=2}while(0<Ue);for(Ge=Ie;Ge!==0;Ge--)for(ft=Ne.bl_count[Ge];ft!==0;)fe<(Et=Ne.heap[--mt])||(re[2*Et+1]!==Ge&&(Ne.opt_len+=(Ge-re[2*Et+1])*re[2*Et],re[2*Et+1]=Ge),ft--)}}(a,d),v(ue,ke,a.bl_count)}function h(a,d,F){var $,P,ue=-1,ve=d[1],ae=0,xe=7,ke=4;for(ve===0&&(xe=138,ke=3),d[2*(F+1)+1]=65535,$=0;$<=F;$++)P=ve,ve=d[2*($+1)+1],++ae<xe&&P===ve||(ae<ke?a.bl_tree[2*P]+=ae:P!==0?(P!==ue&&a.bl_tree[2*P]++,a.bl_tree[2*N]++):ae<=10?a.bl_tree[2*I]++:a.bl_tree[2*X]++,ue=P,ke=(ae=0)===ve?(xe=138,3):P===ve?(xe=6,3):(xe=7,4))}function Q(a,d,F){var $,P,ue=-1,ve=d[1],ae=0,xe=7,ke=4;for(ve===0&&(xe=138,ke=3),$=0;$<=F;$++)if(P=ve,ve=d[2*($+1)+1],!(++ae<xe&&P===ve)){if(ae<ke)for(;ie(a,P,a.bl_tree),--ae!=0;);else P!==0?(P!==ue&&(ie(a,P,a.bl_tree),ae--),ie(a,N,a.bl_tree),q(a,ae-3,2)):ae<=10?(ie(a,I,a.bl_tree),q(a,ae-3,3)):(ie(a,X,a.bl_tree),q(a,ae-11,7));ue=P,ke=(ae=0)===ve?(xe=138,3):P===ve?(xe=6,3):(xe=7,4)}}u(Y);var E=!1;function o(a,d,F,$){q(a,(m<<1)+($?1:0),3),function(P,ue,ve,ae){U(P),K(P,ve),K(P,~ve),i.arraySet(P.pending_buf,P.window,ue,ve,P.pending),P.pending+=ve}(a,d,F)}l._tr_init=function(a){E||(function(){var d,F,$,P,ue,ve=new Array(x+1);for(P=$=0;P<y-1;P++)for(j[P]=$,d=0;d<1<<G[P];d++)A[$++]=P;for(A[$-1]=P,P=ue=0;P<16;P++)for(Y[P]=ue,d=0;d<1<<Z[P];d++)H[ue++]=P;for(ue>>=7;P<p;P++)for(Y[P]=ue<<7,d=0;d<1<<Z[P]-7;d++)H[256+ue++]=P;for(F=0;F<=x;F++)ve[F]=0;for(d=0;d<=143;)ge[2*d+1]=8,d++,ve[8]++;for(;d<=255;)ge[2*d+1]=9,d++,ve[9]++;for(;d<=279;)ge[2*d+1]=7,d++,ve[7]++;for(;d<=287;)ge[2*d+1]=8,d++,ve[8]++;for(v(ge,T+1,ve),d=0;d<p;d++)R[2*d+1]=5,R[2*d]=z(d,5);oe=new ee(ge,G,b+1,T,x),V=new ee(R,Z,0,p,x),we=new ee(new Array(0),C,0,S,_)}(),E=!0),a.l_desc=new M(a.dyn_ltree,oe),a.d_desc=new M(a.dyn_dtree,V),a.bl_desc=new M(a.bl_tree,we),a.bi_buf=0,a.bi_valid=0,w(a)},l._tr_stored_block=o,l._tr_flush_block=function(a,d,F,$){var P,ue,ve=0;0<a.level?(a.strm.data_type===2&&(a.strm.data_type=function(ae){var xe,ke=4093624447;for(xe=0;xe<=31;xe++,ke>>>=1)if(1&ke&&ae.dyn_ltree[2*xe]!==0)return c;if(ae.dyn_ltree[18]!==0||ae.dyn_ltree[20]!==0||ae.dyn_ltree[26]!==0)return n;for(xe=32;xe<b;xe++)if(ae.dyn_ltree[2*xe]!==0)return n;return c}(a)),se(a,a.l_desc),se(a,a.d_desc),ve=function(ae){var xe;for(h(ae,ae.dyn_ltree,ae.l_desc.max_code),h(ae,ae.dyn_dtree,ae.d_desc.max_code),se(ae,ae.bl_desc),xe=S-1;3<=xe&&ae.bl_tree[2*ce[xe]+1]===0;xe--);return ae.opt_len+=3*(xe+1)+5+5+4,xe}(a),P=a.opt_len+3+7>>>3,(ue=a.static_len+3+7>>>3)<=P&&(P=ue)):P=ue=F+5,F+4<=P&&d!==-1?o(a,d,F,$):a.strategy===4||ue===P?(q(a,2+($?1:0),3),B(a,ge,R)):(q(a,4+($?1:0),3),function(ae,xe,ke,Ne){var ot;for(q(ae,xe-257,5),q(ae,ke-1,5),q(ae,Ne-4,4),ot=0;ot<Ne;ot++)q(ae,ae.bl_tree[2*ce[ot]+1],3);Q(ae,ae.dyn_ltree,xe-1),Q(ae,ae.dyn_dtree,ke-1)}(a,a.l_desc.max_code+1,a.d_desc.max_code+1,ve+1),B(a,a.dyn_ltree,a.dyn_dtree)),w(a),$&&U(a)},l._tr_tally=function(a,d,F){return a.pending_buf[a.d_buf+2*a.last_lit]=d>>>8&255,a.pending_buf[a.d_buf+2*a.last_lit+1]=255&d,a.pending_buf[a.l_buf+a.last_lit]=255&F,a.last_lit++,d===0?a.dyn_ltree[2*F]++:(a.matches++,d--,a.dyn_ltree[2*(A[F]+b+1)]++,a.dyn_dtree[2*O(d)]++),a.last_lit===a.lit_bufsize-1},l._tr_align=function(a){q(a,2,3),ie(a,k,ge),function(d){d.bi_valid===16?(K(d,d.bi_buf),d.bi_buf=0,d.bi_valid=0):8<=d.bi_valid&&(d.pending_buf[d.pending++]=255&d.bi_buf,d.bi_buf>>=8,d.bi_valid-=8)}(a)}},{"../utils/common":41}],53:[function(t,s,l){s.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,s,l){(function(i){(function(c,n){if(!c.setImmediate){var u,m,y,b,T=1,p={},S=!1,g=c.document,x=Object.getPrototypeOf&&Object.getPrototypeOf(c);x=x&&x.setTimeout?x:c,u={}.toString.call(c.process)==="[object process]"?function(N){Me.nextTick(function(){_(N)})}:function(){if(c.postMessage&&!c.importScripts){var N=!0,I=c.onmessage;return c.onmessage=function(){N=!1},c.postMessage("","*"),c.onmessage=I,N}}()?(b="setImmediate$"+Math.random()+"$",c.addEventListener?c.addEventListener("message",k,!1):c.attachEvent("onmessage",k),function(N){c.postMessage(b+N,"*")}):c.MessageChannel?((y=new MessageChannel).port1.onmessage=function(N){_(N.data)},function(N){y.port2.postMessage(N)}):g&&"onreadystatechange"in g.createElement("script")?(m=g.documentElement,function(N){var I=g.createElement("script");I.onreadystatechange=function(){_(N),I.onreadystatechange=null,m.removeChild(I),I=null},m.appendChild(I)}):function(N){setTimeout(_,0,N)},x.setImmediate=function(N){typeof N!="function"&&(N=new Function(""+N));for(var I=new Array(arguments.length-1),X=0;X<I.length;X++)I[X]=arguments[X+1];var G={callback:N,args:I};return p[T]=G,u(T),T++},x.clearImmediate=f}function f(N){delete p[N]}function _(N){if(S)setTimeout(_,0,N);else{var I=p[N];if(I){S=!0;try{(function(X){var G=X.callback,Z=X.args;switch(Z.length){case 0:G();break;case 1:G(Z[0]);break;case 2:G(Z[0],Z[1]);break;case 3:G(Z[0],Z[1],Z[2]);break;default:G.apply(n,Z)}})(I)}finally{f(N),S=!1}}}}function k(N){N.source===c&&typeof N.data=="string"&&N.data.indexOf(b)===0&&_(+N.data.slice(b.length))}})(typeof self>"u"?i===void 0?this:i:self)}).call(this,typeof Rt<"u"?Rt:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(na);var Wf=na.exports;const Gf=as(Wf);var Vr={exports:{}},$f={"&":"&amp;",'"':"&quot;","'":"&apos;","<":"&lt;",">":"&gt;"};function Vf(r){return r&&r.replace?r.replace(/([&"<>'])/g,function(e,t){return $f[t]}):r}var Kf=Vf,ci=Kf,Mo=yi.Stream,qf="    ";function Xf(r,e){typeof e!="object"&&(e={indent:e});var t=e.stream?new Mo:null,s="",l=!1,i=e.indent?e.indent===!0?qf:e.indent:"",c=!0;function n(T){c?Me.nextTick(T):T()}function u(T,p){if(p!==void 0&&(s+=p),T&&!l&&(t=t||new Mo,l=!0),T&&l){var S=s;n(function(){t.emit("data",S)}),s=""}}function m(T,p){Ii(u,Kr(T,i,i?1:0),p)}function y(){if(t){var T=s;n(function(){t.emit("data",T),t.emit("end"),t.readable=!1,t.emit("close")})}}function b(T){var p=T.encoding||"UTF-8",S={version:"1.0",encoding:p};T.standalone&&(S.standalone=T.standalone),m({"?xml":{_attr:S}}),s=s.replace("/>","?>")}return n(function(){c=!1}),e.declaration&&b(e.declaration),r&&r.forEach?r.forEach(function(T,p){var S;p+1===r.length&&(S=y),m(T,S)}):m(r,y),t?(t.readable=!0,t):s}function Zf(){var r=Array.prototype.slice.call(arguments),e={_elem:Kr(r)};return e.push=function(t){if(!this.append)throw new Error("not assigned to a parent!");var s=this,l=this._elem.indent;Ii(this.append,Kr(t,l,this._elem.icount+(l?1:0)),function(){s.append(!0)})},e.close=function(t){t!==void 0&&this.push(t),this.end&&this.end()},e}function Yf(r,e){return new Array(e||0).join(r||"")}function Kr(r,e,t){t=t||0;var s=Yf(e,t),l,i=r,c=!1;if(typeof r=="object"){var n=Object.keys(r);if(l=n[0],i=r[l],i&&i._elem)return i._elem.name=l,i._elem.icount=t,i._elem.indent=e,i._elem.indents=s,i._elem.interrupt=i,i._elem}var u=[],m=[],y;function b(T){var p=Object.keys(T);p.forEach(function(S){u.push(Jf(S,T[S]))})}switch(typeof i){case"object":if(i===null)break;i._attr&&b(i._attr),i._cdata&&m.push(("<![CDATA["+i._cdata).replace(/\]\]>/g,"]]]]><![CDATA[>")+"]]>"),i.forEach&&(y=!1,m.push(""),i.forEach(function(T){if(typeof T=="object"){var p=Object.keys(T)[0];p=="_attr"?b(T._attr):m.push(Kr(T,e,t+1))}else m.pop(),y=!0,m.push(ci(T))}),y||m.push(""));break;default:m.push(ci(i))}return{name:l,interrupt:c,attributes:u,content:m,icount:t,indents:s,indent:e}}function Ii(r,e,t){if(typeof e!="object")return r(!1,e);var s=e.interrupt?1:e.content.length;function l(){for(;e.content.length;){var c=e.content.shift();if(c!==void 0){if(i(c))return;Ii(r,c)}}r(!1,(s>1?e.indents:"")+(e.name?"</"+e.name+">":"")+(e.indent&&!t?`
`:"")),t&&t()}function i(c){return c.interrupt?(c.interrupt.append=r,c.interrupt.end=l,c.interrupt=!1,r(!0),!0):!1}if(r(!1,e.indents+(e.name?"<"+e.name:"")+(e.attributes.length?" "+e.attributes.join(" "):"")+(s?e.name?">":"":e.name?"/>":"")+(e.indent&&s>1?`
`:"")),!s)return r(!1,e.indent?`
`:"");i(e)||l()}function Jf(r,e){return r+'="'+ci(e)+'"'}Vr.exports=Xf;Vr.exports.element=Vr.exports.Element=Zf;var Qf=Vr.exports;const tt=as(Qf),jo=0,zo=32,eh=32,th=(r,e)=>{const t=e.replace(/-/g,"");if(t.length!==eh)throw new Error(`Error: Cannot extract GUID from font filename: ${e}`);const l=t.replace(/(..)/g,"$1 ").trim().split(" ").map(u=>parseInt(u,16));l.reverse();const c=r.slice(jo,zo).map((u,m)=>u^l[m%l.length]);return Buffer.concat([r.slice(0,jo),c,r.slice(zo)])};class rh{format(e,t={stack:[]}){const s=e.prepForXml(t);if(s)return s;throw Error("XMLComponent did not format correctly")}}class nh{replace(e,t,s){let l=e;return t.forEach((i,c)=>{l=l.replace(new RegExp(`{${i.fileName}}`,"g"),(s+c).toString())}),l}getMediaData(e,t){return t.Array.filter(s=>e.search(`{${s.fileName}}`)>0)}}class ih{replace(e,t){let s=e;for(const l of t)s=s.replace(new RegExp(`{${l.reference}-${l.instance}}`,"g"),l.numId.toString());return s}}class oh{constructor(){me(this,"formatter"),me(this,"imageReplacer"),me(this,"numberingReplacer"),this.formatter=new rh,this.imageReplacer=new nh,this.numberingReplacer=new ih}compile(e,t){const s=new Gf,l=this.xmlifyFile(e,t),i=new Map(Object.entries(l));for(const[,c]of i)if(Array.isArray(c))for(const n of c)s.file(n.path,n.data);else s.file(c.path,c.data);for(const{stream:c,fileName:n}of e.Media.Array)s.file(`word/media/${n}`,c);for(const{data:c,name:n,fontKey:u}of e.FontTable.fontOptionsWithKey){const[m]=n.split(".");s.file(`word/fonts/${m}.odttf`,th(c,u))}return s}xmlifyFile(e,t){const s=e.Document.Relationships.RelationshipCount+1,l=tt(this.formatter.format(e.Document.View,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),i=this.imageReplacer.getMediaData(l,e.Media);return{Relationships:{data:(i.forEach((c,n)=>{e.Document.Relationships.createRelationship(s+n,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${c.fileName}`)}),tt(this.formatter.format(e.Document.Relationships,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}})),path:"word/_rels/document.xml.rels"},Document:{data:(()=>{const c=this.imageReplacer.replace(l,i,s);return this.numberingReplacer.replace(c,e.Numbering.ConcreteNumbering)})(),path:"word/document.xml"},Styles:{data:(()=>{const c=tt(this.formatter.format(e.Styles,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}});return this.numberingReplacer.replace(c,e.Numbering.ConcreteNumbering)})(),path:"word/styles.xml"},Properties:{data:tt(this.formatter.format(e.CoreProperties,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/core.xml"},Numbering:{data:tt(this.formatter.format(e.Numbering,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/numbering.xml"},FileRelationships:{data:tt(this.formatter.format(e.FileRelationships,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),path:"_rels/.rels"},HeaderRelationships:e.Headers.map((c,n)=>{const u=tt(this.formatter.format(c.View,{viewWrapper:c,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}});return this.imageReplacer.getMediaData(u,e.Media).forEach((y,b)=>{c.Relationships.createRelationship(b,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${y.fileName}`)}),{data:tt(this.formatter.format(c.Relationships,{viewWrapper:c,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),path:`word/_rels/header${n+1}.xml.rels`}}),FooterRelationships:e.Footers.map((c,n)=>{const u=tt(this.formatter.format(c.View,{viewWrapper:c,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}});return this.imageReplacer.getMediaData(u,e.Media).forEach((y,b)=>{c.Relationships.createRelationship(b,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${y.fileName}`)}),{data:tt(this.formatter.format(c.Relationships,{viewWrapper:c,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),path:`word/_rels/footer${n+1}.xml.rels`}}),Headers:e.Headers.map((c,n)=>{const u=tt(this.formatter.format(c.View,{viewWrapper:c,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),m=this.imageReplacer.getMediaData(u,e.Media),y=this.imageReplacer.replace(u,m,0);return{data:this.numberingReplacer.replace(y,e.Numbering.ConcreteNumbering),path:`word/header${n+1}.xml`}}),Footers:e.Footers.map((c,n)=>{const u=tt(this.formatter.format(c.View,{viewWrapper:c,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),m=this.imageReplacer.getMediaData(u,e.Media),y=this.imageReplacer.replace(u,m,0);return{data:this.numberingReplacer.replace(y,e.Numbering.ConcreteNumbering),path:`word/footer${n+1}.xml`}}),ContentTypes:{data:tt(this.formatter.format(e.ContentTypes,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),path:"[Content_Types].xml"},CustomProperties:{data:tt(this.formatter.format(e.CustomProperties,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/custom.xml"},AppProperties:{data:tt(this.formatter.format(e.AppProperties,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/app.xml"},FootNotes:{data:tt(this.formatter.format(e.FootNotes.View,{viewWrapper:e.FootNotes,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),path:"word/footnotes.xml"},FootNotesRelationships:{data:tt(this.formatter.format(e.FootNotes.Relationships,{viewWrapper:e.FootNotes,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),path:"word/_rels/footnotes.xml.rels"},Settings:{data:tt(this.formatter.format(e.Settings,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/settings.xml"},Comments:{data:tt(this.formatter.format(e.Comments,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/comments.xml"},FontTable:{data:tt(this.formatter.format(e.FontTable.View,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/fontTable.xml"},FontTableRelationships:{data:tt(this.formatter.format(e.FontTable.Relationships,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),path:"word/_rels/fontTable.xml.rels"}}}}const sh={NONE:"",WITH_2_BLANKS:"  ",WITH_4_BLANKS:"    ",WITH_TAB:"	"},xr=r=>r===!0?sh.WITH_2_BLANKS:r===!1?void 0:r;class ia{static toString(e,t){return Nr(this,null,function*(){return yield this.compiler.compile(e,xr(t)).generateAsync({type:"string",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"})})}static toBuffer(e,t){return Nr(this,null,function*(){return yield this.compiler.compile(e,xr(t)).generateAsync({type:"nodebuffer",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"})})}static toBase64String(e,t){return Nr(this,null,function*(){return yield this.compiler.compile(e,xr(t)).generateAsync({type:"base64",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"})})}static toBlob(e,t){return Nr(this,null,function*(){return yield this.compiler.compile(e,xr(t)).generateAsync({type:"blob",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"})})}static toStream(e,t){const s=new yi.Stream;return this.compiler.compile(e,xr(t)).generateAsync({type:"nodebuffer",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"}).then(i=>{s.emit("data",i),s.emit("end")}),s}}me(ia,"compiler",new oh);async function ah(r,e){console.log("[DOCX DEBUG] Creating minimal document");try{console.log("[DOCX DEBUG] Using Docxtemplater for simple document");const t=`
      <w:document xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main">
        <w:body>
          <w:p>
            <w:pPr>
              <w:pStyle w:val="Heading1"/>
              <w:jc w:val="center"/>
            </w:pPr>
            <w:r>
              <w:t>{title}</w:t>
            </w:r>
          </w:p>
          
          <w:p><w:r><w:t>{content}</w:t></w:r></w:p>
        </w:body>
      </w:document>
    `,s=new ba(t),l=new _a(s,{paragraphLoop:!0,linebreaks:!0}),i=e?String(e).trim():"Analysis Report",c=r?String(r).trim():"";l.setData({title:i,content:c}),l.render();const n=l.getZip().generate({type:"blob",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"});return console.log("[DOCX DEBUG] Document created successfully with size:",n.size),n}catch(t){console.error("[DOCX DEBUG] Docxtemplater failed, falling back to original method:",t);try{const s=e?String(e).trim():"Analysis Report",c=(r?String(r).trim():"").split(`
`).map(y=>new Ar({children:[new $r({text:y||" ",size:24})]})),n=new Ar({children:[new $r({text:s,bold:!0,size:32})],spacing:{after:400}}),u=new Hf({sections:[{children:[n,...c]}]});console.log("[DOCX DEBUG] Document created, generating blob");const m=await ia.toBlob(u);return console.log("[DOCX DEBUG] Blob generated, size:",m.size),m}catch(s){console.error("[DOCX DEBUG] Error creating document:",s);const l=`${e||"Analysis Report"}

${r||""}`,i=new Blob([l],{type:"text/plain"});return console.log("[DOCX DEBUG] Created fallback text blob"),i}}}function lh(r,e){try{console.log("[DOCX DEBUG] Downloading document, blob size:",r.size),Ta.saveAs(r,e),console.log("[DOCX DEBUG] Download initiated")}catch(t){throw console.error("[DOCX DEBUG] Download error:",t),t}}const{document:Ho}=wa;function Wo(r,e,t){const s=r.slice();return s[72]=e[t],s}function Qn(r){const e=r.slice(),t=[...new Set(e[9].map(i=>i.document))];e[75]=t;const s=e[9].reduce((i,c)=>i+(c.debit||0),0);e[76]=s;const l=e[9].reduce((i,c)=>i+(c.credit||0),0);return e[77]=l,e}function Go(r,e,t){const s=r.slice();return s[69]=e[t],s}function $o(r,e,t){const s=r.slice();return s[78]=e[t],s}function Vo(r){let e,t,s,l,i=r[15].title+"",c,n,u,m='<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg>',y,b,T,p,S,g;const x=[fh,uh,ch],f=[];function _(k,N){return k[15].isLoading?0:k[15].isEditing?1:2}return b=_(r),T=f[b]=x[b](r),{c(){e=de("div"),t=de("div"),s=de("div"),l=de("h2"),c=De(i),n=Ae(),u=de("button"),u.innerHTML=m,y=Ae(),T.c(),this.h()},l(k){e=pe(k,"DIV",{class:!0});var N=he(e);t=pe(N,"DIV",{class:!0});var I=he(t);s=pe(I,"DIV",{class:!0});var X=he(s);l=pe(X,"H2",{class:!0});var G=he(l);c=Oe(G,i),G.forEach(ne),n=Se(X),u=pe(X,"BUTTON",{class:!0,"data-svelte-h":!0}),Vt(u)!=="svelte-1xal31m"&&(u.innerHTML=m),X.forEach(ne),y=Se(I),T.l(I),I.forEach(ne),N.forEach(ne),this.h()},h(){te(l,"class","text-xl font-bold"),te(u,"class","p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full"),te(s,"class","flex justify-between items-center mb-4"),te(t,"class","w-full max-w-2xl bg-white dark:bg-gray-900 rounded-xl p-6 max-h-[80vh] overflow-auto"),te(e,"class","fixed inset-0 z-50 flex items-center justify-center bg-black/60")},m(k,N){Pe(k,e,N),J(e,t),J(t,s),J(s,l),J(l,c),J(s,n),J(s,u),J(t,y),f[b].m(t,null),p=!0,S||(g=[rt(u,"click",r[18]),rt(e,"click",ha(r[18]))],S=!0)},p(k,N){(!p||N[0]&32768)&&i!==(i=k[15].title+"")&&Be(c,i);let I=b;b=_(k),b===I?f[b].p(k,N):($t(),st(f[I],1,1,()=>{f[I]=null}),Gt(),T=f[b],T?T.p(k,N):(T=f[b]=x[b](k),T.c()),Qe(T,1),T.m(t,null))},i(k){p||(Qe(T),p=!0)},o(k){st(T),p=!1},d(k){k&&ne(e),f[b].d(),S=!1,lr(g)}}}function ch(r){let e,t,s,l,i,c,n,u=r[14].t("Download Report")+"",m,y,b,T=r[14].t("Edit Analysis")+"",p,S,g,x=rr((r[15].content||"").split("<br>")),f=[];for(let _=0;_<x.length;_+=1)f[_]=Ko($o(r,x,_));return{c(){e=de("div");for(let _=0;_<f.length;_+=1)f[_].c();t=Ae(),s=de("div"),l=de("button"),i=kt("svg"),c=kt("path"),n=Ae(),m=De(u),y=Ae(),b=de("button"),p=De(T),this.h()},l(_){e=pe(_,"DIV",{class:!0});var k=he(e);for(let Z=0;Z<f.length;Z+=1)f[Z].l(k);k.forEach(ne),t=Se(_),s=pe(_,"DIV",{class:!0});var N=he(s);l=pe(N,"BUTTON",{class:!0});var I=he(l);i=Ct(I,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var X=he(i);c=Ct(X,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),he(c).forEach(ne),X.forEach(ne),n=Se(I),m=Oe(I,u),I.forEach(ne),y=Se(N),b=pe(N,"BUTTON",{class:!0});var G=he(b);p=Oe(G,T),G.forEach(ne),N.forEach(ne),this.h()},h(){te(e,"class","analysis-content prose dark:prose-invert max-w-none"),te(c,"stroke-linecap","round"),te(c,"stroke-linejoin","round"),te(c,"stroke-width","2"),te(c,"d","M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l2.414 2.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"),te(i,"xmlns","http://www.w3.org/2000/svg"),te(i,"class","h-5 w-5 mr-2"),te(i,"fill","none"),te(i,"viewBox","0 0 24 24"),te(i,"stroke","currentColor"),te(l,"class","px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition flex items-center"),te(b,"class","px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition"),te(s,"class","mt-4 flex justify-end space-x-3")},m(_,k){Pe(_,e,k);for(let N=0;N<f.length;N+=1)f[N]&&f[N].m(e,null);Pe(_,t,k),Pe(_,s,k),J(s,l),J(l,i),J(i,c),J(l,n),J(l,m),J(s,y),J(s,b),J(b,p),S||(g=[rt(l,"click",r[38]),rt(b,"click",r[19])],S=!0)},p(_,k){if(k[0]&32768){x=rr((_[15].content||"").split("<br>"));let N;for(N=0;N<x.length;N+=1){const I=$o(_,x,N);f[N]?f[N].p(I,k):(f[N]=Ko(I),f[N].c(),f[N].m(e,null))}for(;N<f.length;N+=1)f[N].d(1);f.length=x.length}k[0]&16384&&u!==(u=_[14].t("Download Report")+"")&&Be(m,u),k[0]&16384&&T!==(T=_[14].t("Edit Analysis")+"")&&Be(p,T)},i:dt,o:dt,d(_){_&&(ne(e),ne(t),ne(s)),fi(f,_),S=!1,lr(g)}}}function uh(r){let e,t,s,l,i,c,n=r[14].t("Cancel")+"",u,m,y,b=r[14].t("Save")+"",T,p,S;return{c(){e=de("div"),t=de("textarea"),l=Ae(),i=de("div"),c=de("button"),u=De(n),m=Ae(),y=de("button"),T=De(b),this.h()},l(g){e=pe(g,"DIV",{class:!0});var x=he(e);t=pe(x,"TEXTAREA",{class:!0,placeholder:!0}),he(t).forEach(ne),x.forEach(ne),l=Se(g),i=pe(g,"DIV",{class:!0});var f=he(i);c=pe(f,"BUTTON",{class:!0});var _=he(c);u=Oe(_,n),_.forEach(ne),m=Se(f),y=pe(f,"BUTTON",{class:!0});var k=he(y);T=Oe(k,b),k.forEach(ne),f.forEach(ne),this.h()},h(){te(t,"class","w-full h-64 px-3 py-2 text-sm rounded border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800"),te(t,"placeholder",s=r[14].t("Enter your analysis here...")),te(e,"class","mb-4"),te(c,"class","px-4 py-2 rounded-lg bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 transition"),te(y,"class","px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 transition"),te(i,"class","flex justify-end space-x-3")},m(g,x){Pe(g,e,x),J(e,t),Lt(t,r[15].editText),Pe(g,l,x),Pe(g,i,x),J(i,c),J(c,u),J(i,m),J(i,y),J(y,T),p||(S=[rt(t,"input",r[37]),rt(c,"click",r[19]),rt(y,"click",r[20])],p=!0)},p(g,x){x[0]&16384&&s!==(s=g[14].t("Enter your analysis here..."))&&te(t,"placeholder",s),x[0]&32768&&Lt(t,g[15].editText),x[0]&16384&&n!==(n=g[14].t("Cancel")+"")&&Be(u,n),x[0]&16384&&b!==(b=g[14].t("Save")+"")&&Be(T,b)},i:dt,o:dt,d(g){g&&(ne(e),ne(l),ne(i)),p=!1,lr(S)}}}function fh(r){let e,t,s,l,i=r[14].t("Generating analysis...")+"",c,n;return t=new dr({props:{className:"size-8"}}),{c(){e=de("div"),cr(t.$$.fragment),s=Ae(),l=de("p"),c=De(i),this.h()},l(u){e=pe(u,"DIV",{class:!0});var m=he(e);ur(t.$$.fragment,m),s=Se(m),l=pe(m,"P",{class:!0});var y=he(l);c=Oe(y,i),y.forEach(ne),m.forEach(ne),this.h()},h(){te(l,"class","ml-3 text-gray-600 dark:text-gray-400"),te(e,"class","flex justify-center items-center py-8")},m(u,m){Pe(u,e,m),fr(t,e,null),J(e,s),J(e,l),J(l,c),n=!0},p(u,m){(!n||m[0]&16384)&&i!==(i=u[14].t("Generating analysis...")+"")&&Be(c,i)},i(u){n||(Qe(t.$$.fragment,u),n=!0)},o(u){st(t.$$.fragment,u),n=!1},d(u){u&&ne(e),hr(t)}}}function Ko(r){let e,t,s=r[78]+"";return{c(){e=de("p"),t=new qr(!1),this.h()},l(l){e=pe(l,"P",{class:!0});var i=he(e);t=Xr(i,!1),i.forEach(ne),this.h()},h(){t.a=null,te(e,"class","mb-1")},m(l,i){Pe(l,e,i),t.m(s,e)},p(l,i){i[0]&32768&&s!==(s=l[78]+"")&&t.p(s)},d(l){l&&ne(e)}}}function hh(r){let e,t,s,l,i='<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path></svg>',c,n,u=r[14].t("Edit Analysis")+"",m,y,b,T,p,S,g,x,f,_=r[14].t("Cancel")+"",k,N,I,X,G,Z,C=r[14].t("Download")+"",ce,ge,R,H,A=r[14].t("Save")+"",j,oe,V,we,Y=r[12]&&qo(r);return{c(){e=de("div"),t=de("div"),s=de("div"),l=de("button"),l.innerHTML=i,c=Ae(),n=de("h2"),m=De(u),y=Ae(),b=de("div"),T=de("textarea"),S=Ae(),Y&&Y.c(),g=Ae(),x=de("div"),f=de("button"),k=De(_),N=Ae(),I=de("button"),X=kt("svg"),G=kt("path"),Z=Ae(),ce=De(C),R=Ae(),H=de("button"),j=De(A),this.h()},l(ee){e=pe(ee,"DIV",{class:!0});var M=he(e);t=pe(M,"DIV",{class:!0});var O=he(t);s=pe(O,"DIV",{class:!0});var K=he(s);l=pe(K,"BUTTON",{class:!0,"data-svelte-h":!0}),Vt(l)!=="svelte-1hnzekv"&&(l.innerHTML=i),c=Se(K),n=pe(K,"H2",{class:!0});var q=he(n);m=Oe(q,u),q.forEach(ne),K.forEach(ne),O.forEach(ne),y=Se(M),b=pe(M,"DIV",{class:!0});var ie=he(b);T=pe(ie,"TEXTAREA",{class:!0,placeholder:!0}),he(T).forEach(ne),S=Se(ie),Y&&Y.l(ie),ie.forEach(ne),g=Se(M),x=pe(M,"DIV",{class:!0});var z=he(x);f=pe(z,"BUTTON",{class:!0});var v=he(f);k=Oe(v,_),v.forEach(ne),N=Se(z),I=pe(z,"BUTTON",{class:!0});var w=he(I);X=Ct(w,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var U=he(X);G=Ct(U,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),he(G).forEach(ne),U.forEach(ne),Z=Se(w),ce=Oe(w,C),w.forEach(ne),R=Se(z),H=pe(z,"BUTTON",{class:!0});var L=he(H);j=Oe(L,A),L.forEach(ne),z.forEach(ne),M.forEach(ne),this.h()},h(){te(l,"class","mr-2 p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full"),te(n,"class","text-xl font-bold"),te(s,"class","flex items-center"),te(t,"class","flex justify-between items-center mb-4"),te(T,"class","w-full h-64 px-3 py-2 text-sm rounded border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800"),te(T,"placeholder",p=r[14].t("Enter your analysis here...")),T.disabled=r[12],te(b,"class","mb-4 relative"),te(f,"class","px-4 py-2 rounded-lg bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 transition"),te(G,"stroke-linecap","round"),te(G,"stroke-linejoin","round"),te(G,"stroke-width","2"),te(G,"d","M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l2.414 2.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"),te(X,"xmlns","http://www.w3.org/2000/svg"),te(X,"class","h-5 w-5 mr-2"),te(X,"fill","none"),te(X,"viewBox","0 0 24 24"),te(X,"stroke","currentColor"),te(I,"class","px-4 py-2 rounded-lg bg-green-600 text-white hover:bg-green-700 transition flex items-center"),I.disabled=ge=!r[11]||r[12],te(H,"class","px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 transition"),H.disabled=r[12],te(x,"class","flex justify-end space-x-3"),te(e,"class","bg-white dark:bg-gray-800 p-6 rounded-lg shadow")},m(ee,M){Pe(ee,e,M),J(e,t),J(t,s),J(s,l),J(s,c),J(s,n),J(n,m),J(e,y),J(e,b),J(b,T),Lt(T,r[11]),J(b,S),Y&&Y.m(b,null),J(e,g),J(e,x),J(x,f),J(f,k),J(x,N),J(x,I),J(I,X),J(X,G),J(I,Z),J(I,ce),J(x,R),J(x,H),J(H,j),oe=!0,V||(we=[rt(l,"click",r[30]),rt(T,"input",r[42]),rt(f,"click",r[30]),rt(I,"click",r[43]),rt(H,"click",r[25])],V=!0)},p(ee,M){(!oe||M[0]&16384)&&u!==(u=ee[14].t("Edit Analysis")+"")&&Be(m,u),(!oe||M[0]&16384&&p!==(p=ee[14].t("Enter your analysis here...")))&&te(T,"placeholder",p),(!oe||M[0]&4096)&&(T.disabled=ee[12]),M[0]&2048&&Lt(T,ee[11]),ee[12]?Y?(Y.p(ee,M),M[0]&4096&&Qe(Y,1)):(Y=qo(ee),Y.c(),Qe(Y,1),Y.m(b,null)):Y&&($t(),st(Y,1,1,()=>{Y=null}),Gt()),(!oe||M[0]&16384)&&_!==(_=ee[14].t("Cancel")+"")&&Be(k,_),(!oe||M[0]&16384)&&C!==(C=ee[14].t("Download")+"")&&Be(ce,C),(!oe||M[0]&6144&&ge!==(ge=!ee[11]||ee[12]))&&(I.disabled=ge),(!oe||M[0]&16384)&&A!==(A=ee[14].t("Save")+"")&&Be(j,A),(!oe||M[0]&4096)&&(H.disabled=ee[12])},i(ee){oe||(Qe(Y),oe=!0)},o(ee){st(Y),oe=!1},d(ee){ee&&ne(e),Y&&Y.d(),V=!1,lr(we)}}}function dh(r){let e,t,s,l,i='<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path></svg>',c,n,u,m,y,b,T,p,S;const g=[wh,gh],x=[];function f(_,k){return _[3]?0:1}return y=f(r),b=x[y]=g[y](r),{c(){e=de("div"),t=de("div"),s=de("div"),l=de("button"),l.innerHTML=i,c=Ae(),n=de("h2"),u=De(r[4]),m=Ae(),b.c(),this.h()},l(_){e=pe(_,"DIV",{class:!0});var k=he(e);t=pe(k,"DIV",{class:!0});var N=he(t);s=pe(N,"DIV",{class:!0});var I=he(s);l=pe(I,"BUTTON",{class:!0,"data-svelte-h":!0}),Vt(l)!=="svelte-1hnzekv"&&(l.innerHTML=i),c=Se(I),n=pe(I,"H2",{class:!0});var X=he(n);u=Oe(X,r[4]),X.forEach(ne),I.forEach(ne),N.forEach(ne),m=Se(k),b.l(k),k.forEach(ne),this.h()},h(){te(l,"class","mr-2 p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full"),te(n,"class","text-xl font-bold"),te(s,"class","flex items-center"),te(t,"class","flex justify-between items-center mb-6"),te(e,"class","bg-white dark:bg-gray-800 p-6 rounded-lg shadow")},m(_,k){Pe(_,e,k),J(e,t),J(t,s),J(s,l),J(s,c),J(s,n),J(n,u),J(e,m),x[y].m(e,null),T=!0,p||(S=rt(l,"click",r[30]),p=!0)},p(_,k){(!T||k[0]&16)&&Be(u,_[4]);let N=y;y=f(_),y===N?x[y].p(_,k):($t(),st(x[N],1,1,()=>{x[N]=null}),Gt(),b=x[y],b?b.p(_,k):(b=x[y]=g[y](_),b.c()),Qe(b,1),b.m(e,null))},i(_){T||(Qe(b),T=!0)},o(_){st(b),T=!1},d(_){_&&ne(e),x[y].d(),p=!1,S()}}}function ph(r){let e,t,s,l,i='<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path></svg>',c,n,u,m,y,b,T,p,S,g,x,f=r[14].t("Date")+"",_,k,N,I=r[14].t("Journal Entry")+"",X,G,Z,C=r[14].t("Account")+"",ce,ge,R,H=r[14].t("Note")+"",A,j,oe,V=r[14].t("Debit")+"",we,Y,ee,M=r[14].t("Credit")+"",O,K,q,ie=r[14].t("Flags")+"",z,v,w,U,L,D,B=r[9].length>0&&Xo(Qn(r)),se=rr(r[9]),h=[];for(let E=0;E<se.length;E+=1)h[E]=ts(Wo(r,se,E));let Q=r[9].length===0&&rs(r);return{c(){e=de("div"),t=de("div"),s=de("div"),l=de("button"),l.innerHTML=i,c=Ae(),n=de("h2"),u=De(r[10]),m=Ae(),y=de("div"),B&&B.c(),b=Ae(),T=de("div"),p=de("table"),S=de("thead"),g=de("tr"),x=de("th"),_=De(f),k=Ae(),N=de("th"),X=De(I),G=Ae(),Z=de("th"),ce=De(C),ge=Ae(),R=de("th"),A=De(H),j=Ae(),oe=de("th"),we=De(V),Y=Ae(),ee=de("th"),O=De(M),K=Ae(),q=de("th"),z=De(ie),v=Ae(),w=de("tbody");for(let E=0;E<h.length;E+=1)h[E].c();U=Ae(),Q&&Q.c(),this.h()},l(E){e=pe(E,"DIV",{class:!0});var o=he(e);t=pe(o,"DIV",{class:!0});var a=he(t);s=pe(a,"DIV",{class:!0});var d=he(s);l=pe(d,"BUTTON",{class:!0,"data-svelte-h":!0}),Vt(l)!=="svelte-1hnzekv"&&(l.innerHTML=i),c=Se(d),n=pe(d,"H2",{class:!0});var F=he(n);u=Oe(F,r[10]),F.forEach(ne),d.forEach(ne),a.forEach(ne),m=Se(o),y=pe(o,"DIV",{class:!0});var $=he(y);B&&B.l($),$.forEach(ne),b=Se(o),T=pe(o,"DIV",{class:!0});var P=he(T);p=pe(P,"TABLE",{class:!0});var ue=he(p);S=pe(ue,"THEAD",{class:!0});var ve=he(S);g=pe(ve,"TR",{});var ae=he(g);x=pe(ae,"TH",{class:!0});var xe=he(x);_=Oe(xe,f),xe.forEach(ne),k=Se(ae),N=pe(ae,"TH",{class:!0});var ke=he(N);X=Oe(ke,I),ke.forEach(ne),G=Se(ae),Z=pe(ae,"TH",{class:!0});var Ne=he(Z);ce=Oe(Ne,C),Ne.forEach(ne),ge=Se(ae),R=pe(ae,"TH",{class:!0});var ot=he(R);A=Oe(ot,H),ot.forEach(ne),j=Se(ae),oe=pe(ae,"TH",{class:!0});var mt=he(oe);we=Oe(mt,V),mt.forEach(ne),Y=Se(ae),ee=pe(ae,"TH",{class:!0});var ft=he(ee);O=Oe(ft,M),ft.forEach(ne),K=Se(ae),q=pe(ae,"TH",{class:!0});var Et=he(q);z=Oe(Et,ie),Et.forEach(ne),ae.forEach(ne),ve.forEach(ne),v=Se(ue),w=pe(ue,"TBODY",{});var Ge=he(w);for(let xt=0;xt<h.length;xt+=1)h[xt].l(Ge);U=Se(Ge),Q&&Q.l(Ge),Ge.forEach(ne),ue.forEach(ne),P.forEach(ne),o.forEach(ne),this.h()},h(){te(l,"class","mr-2 p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full"),te(n,"class","text-xl font-bold"),te(s,"class","flex items-center"),te(t,"class","flex justify-between items-center mb-6"),te(y,"class","transaction-summary mb-6 grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3"),te(x,"class","px-4 py-2 text-left"),te(N,"class","px-4 py-2 text-left"),te(Z,"class","px-4 py-2 text-left"),te(R,"class","px-4 py-2 text-left"),te(oe,"class","px-4 py-2 text-right"),te(ee,"class","px-4 py-2 text-right"),te(q,"class","px-4 py-2 text-center"),te(S,"class","bg-gray-50 dark:bg-gray-700 text-gray-500 dark:text-gray-300"),te(p,"class","w-full text-sm"),te(T,"class","overflow-x-auto"),te(e,"class","bg-white dark:bg-gray-800 p-6 rounded-lg shadow")},m(E,o){Pe(E,e,o),J(e,t),J(t,s),J(s,l),J(s,c),J(s,n),J(n,u),J(e,m),J(e,y),B&&B.m(y,null),J(e,b),J(e,T),J(T,p),J(p,S),J(S,g),J(g,x),J(x,_),J(g,k),J(g,N),J(N,X),J(g,G),J(g,Z),J(Z,ce),J(g,ge),J(g,R),J(R,A),J(g,j),J(g,oe),J(oe,we),J(g,Y),J(g,ee),J(ee,O),J(g,K),J(g,q),J(q,z),J(p,v),J(p,w);for(let a=0;a<h.length;a+=1)h[a]&&h[a].m(w,null);J(w,U),Q&&Q.m(w,null),L||(D=rt(l,"click",r[30]),L=!0)},p(E,o){if(o[0]&1024&&Be(u,E[10]),E[9].length>0?B?B.p(Qn(E),o):(B=Xo(Qn(E)),B.c(),B.m(y,null)):B&&(B.d(1),B=null),o[0]&16384&&f!==(f=E[14].t("Date")+"")&&Be(_,f),o[0]&16384&&I!==(I=E[14].t("Journal Entry")+"")&&Be(X,I),o[0]&16384&&C!==(C=E[14].t("Account")+"")&&Be(ce,C),o[0]&16384&&H!==(H=E[14].t("Note")+"")&&Be(A,H),o[0]&16384&&V!==(V=E[14].t("Debit")+"")&&Be(we,V),o[0]&16384&&M!==(M=E[14].t("Credit")+"")&&Be(O,M),o[0]&16384&&ie!==(ie=E[14].t("Flags")+"")&&Be(z,ie),o[0]&134234624){se=rr(E[9]);let a;for(a=0;a<se.length;a+=1){const d=Wo(E,se,a);h[a]?h[a].p(d,o):(h[a]=ts(d),h[a].c(),h[a].m(w,U))}for(;a<h.length;a+=1)h[a].d(1);h.length=se.length}E[9].length===0?Q?Q.p(E,o):(Q=rs(E),Q.c(),Q.m(w,null)):Q&&(Q.d(1),Q=null)},i:dt,o:dt,d(E){E&&ne(e),B&&B.d(),fi(h,E),Q&&Q.d(),L=!1,D()}}}function mh(r){let e,t,s=r[14].t("Account Analysis")+"",l,i,c,n="",u,m,y,b,T;const p=[_h,bh,vh,yh],S=[];function g(x,f){return x[5]?0:x[6]?x[0]?2:3:1}return m=g(r),y=S[m]=p[m](r),{c(){e=de("div"),t=de("h1"),l=De(s),i=Ae(),c=de("div"),c.innerHTML=n,u=Ae(),y.c(),b=Ni(),this.h()},l(x){e=pe(x,"DIV",{class:!0});var f=he(e);t=pe(f,"H1",{class:!0});var _=he(t);l=Oe(_,s),_.forEach(ne),i=Se(f),c=pe(f,"DIV",{class:!0,"data-svelte-h":!0}),Vt(c)!=="svelte-prv37y"&&(c.innerHTML=n),f.forEach(ne),u=Se(x),y.l(x),b=Ni(),this.h()},h(){te(t,"class","text-2xl font-bold text-blue-800 dark:text-blue-300"),te(c,"class","flex items-center space-x-2"),te(e,"class","flex justify-between items-center mb-6")},m(x,f){Pe(x,e,f),J(e,t),J(t,l),J(e,i),J(e,c),Pe(x,u,f),S[m].m(x,f),Pe(x,b,f),T=!0},p(x,f){(!T||f[0]&16384)&&s!==(s=x[14].t("Account Analysis")+"")&&Be(l,s);let _=m;m=g(x),m===_?S[m].p(x,f):($t(),st(S[_],1,1,()=>{S[_]=null}),Gt(),y=S[m],y?y.p(x,f):(y=S[m]=p[m](x),y.c()),Qe(y,1),y.m(b.parentNode,b))},i(x){T||(Qe(y),T=!0)},o(x){st(y),T=!1},d(x){x&&(ne(e),ne(u),ne(b)),S[m].d(x)}}}function qo(r){let e,t,s,l,i,c=r[14].t("Generating analysis...")+"",n,u;return s=new dr({props:{className:"size-8 mb-2"}}),{c(){e=de("div"),t=de("div"),cr(s.$$.fragment),l=Ae(),i=de("div"),n=De(c),this.h()},l(m){e=pe(m,"DIV",{class:!0});var y=he(e);t=pe(y,"DIV",{class:!0});var b=he(t);ur(s.$$.fragment,b),l=Se(b),i=pe(b,"DIV",{class:!0});var T=he(i);n=Oe(T,c),T.forEach(ne),b.forEach(ne),y.forEach(ne),this.h()},h(){te(i,"class","text-sm font-medium"),te(t,"class","flex flex-col items-center"),te(e,"class","absolute inset-0 bg-black/10 flex items-center justify-center")},m(m,y){Pe(m,e,y),J(e,t),fr(s,t,null),J(t,l),J(t,i),J(i,n),u=!0},p(m,y){(!u||y[0]&16384)&&c!==(c=m[14].t("Generating analysis...")+"")&&Be(n,c)},i(m){u||(Qe(s.$$.fragment,m),u=!0)},o(m){st(s.$$.fragment,m),u=!1},d(m){m&&ne(e),hr(s)}}}function gh(r){let e,t,s;return t=new dr({props:{className:"size-8"}}),{c(){e=de("div"),cr(t.$$.fragment),this.h()},l(l){e=pe(l,"DIV",{class:!0});var i=he(e);ur(t.$$.fragment,i),i.forEach(ne),this.h()},h(){te(e,"class","flex justify-center items-center h-64")},m(l,i){Pe(l,e,i),fr(t,e,null),s=!0},p:dt,i(l){s||(Qe(t.$$.fragment,l),s=!0)},o(l){st(t.$$.fragment,l),s=!1},d(l){l&&ne(e),hr(t)}}}function wh(r){let e,t,s,l=r[31]()+"";return{c(){e=de("div"),t=de("div"),s=new qr(!1),this.h()},l(i){e=pe(i,"DIV",{class:!0});var c=he(e);t=pe(c,"DIV",{class:!0});var n=he(t);s=Xr(n,!1),n.forEach(ne),c.forEach(ne),this.h()},h(){s.a=null,te(t,"class","timeline-section mb-6"),te(e,"class","chart-content svelte-126e3bb")},m(i,c){Pe(i,e,c),J(e,t),s.m(l,t)},p:dt,i:dt,o:dt,d(i){i&&ne(e)}}}function Xo(r){let e,t,s=r[14].t("Total Transactions")+"",l,i,c,n=r[75].length+"",u,m,y,b,T=r[14].t("Total Debits")+"",p,S,g,x=lt(r[76])+"",f,_,k,N,I=r[14].t("Total Credits")+"",X,G,Z,C=lt(r[77])+"",ce,ge,R,H,A=r[14].t("Net Amount")+"",j,oe,V,we=lt(r[76]-r[77])+"",Y;return{c(){e=de("div"),t=de("div"),l=De(s),i=Ae(),c=de("div"),u=De(n),m=Ae(),y=de("div"),b=de("div"),p=De(T),S=Ae(),g=de("div"),f=De(x),_=Ae(),k=de("div"),N=de("div"),X=De(I),G=Ae(),Z=de("div"),ce=De(C),ge=Ae(),R=de("div"),H=de("div"),j=De(A),oe=Ae(),V=de("div"),Y=De(we),this.h()},l(ee){e=pe(ee,"DIV",{class:!0});var M=he(e);t=pe(M,"DIV",{class:!0});var O=he(t);l=Oe(O,s),O.forEach(ne),i=Se(M),c=pe(M,"DIV",{class:!0});var K=he(c);u=Oe(K,n),K.forEach(ne),M.forEach(ne),m=Se(ee),y=pe(ee,"DIV",{class:!0});var q=he(y);b=pe(q,"DIV",{class:!0});var ie=he(b);p=Oe(ie,T),ie.forEach(ne),S=Se(q),g=pe(q,"DIV",{class:!0});var z=he(g);f=Oe(z,x),z.forEach(ne),q.forEach(ne),_=Se(ee),k=pe(ee,"DIV",{class:!0});var v=he(k);N=pe(v,"DIV",{class:!0});var w=he(N);X=Oe(w,I),w.forEach(ne),G=Se(v),Z=pe(v,"DIV",{class:!0});var U=he(Z);ce=Oe(U,C),U.forEach(ne),v.forEach(ne),ge=Se(ee),R=pe(ee,"DIV",{class:!0});var L=he(R);H=pe(L,"DIV",{class:!0});var D=he(H);j=Oe(D,A),D.forEach(ne),oe=Se(L),V=pe(L,"DIV",{class:!0});var B=he(V);Y=Oe(B,we),B.forEach(ne),L.forEach(ne),this.h()},h(){te(t,"class","text-xs text-blue-600 dark:text-blue-400"),te(c,"class","text-xl font-bold"),te(e,"class","p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg"),te(b,"class","text-xs text-green-600 dark:text-green-400"),te(g,"class","text-xl font-bold"),te(y,"class","p-3 bg-green-50 dark:bg-green-900/20 rounded-lg"),te(N,"class","text-xs text-red-600 dark:text-red-400"),te(Z,"class","text-xl font-bold"),te(k,"class","p-3 bg-red-50 dark:bg-red-900/20 rounded-lg"),te(H,"class","text-xs text-purple-600 dark:text-purple-400"),te(V,"class","text-xl font-bold"),te(R,"class","p-3 bg-purple-50 dark:bg-purple-900/20 rounded-lg")},m(ee,M){Pe(ee,e,M),J(e,t),J(t,l),J(e,i),J(e,c),J(c,u),Pe(ee,m,M),Pe(ee,y,M),J(y,b),J(b,p),J(y,S),J(y,g),J(g,f),Pe(ee,_,M),Pe(ee,k,M),J(k,N),J(N,X),J(k,G),J(k,Z),J(Z,ce),Pe(ee,ge,M),Pe(ee,R,M),J(R,H),J(H,j),J(R,oe),J(R,V),J(V,Y)},p(ee,M){M[0]&16384&&s!==(s=ee[14].t("Total Transactions")+"")&&Be(l,s),M[0]&512&&n!==(n=ee[75].length+"")&&Be(u,n),M[0]&16384&&T!==(T=ee[14].t("Total Debits")+"")&&Be(p,T),M[0]&512&&x!==(x=lt(ee[76])+"")&&Be(f,x),M[0]&16384&&I!==(I=ee[14].t("Total Credits")+"")&&Be(X,I),M[0]&512&&C!==(C=lt(ee[77])+"")&&Be(ce,C),M[0]&16384&&A!==(A=ee[14].t("Net Amount")+"")&&Be(j,A),M[0]&512&&we!==(we=lt(ee[76]-ee[77])+"")&&Be(Y,we)},d(ee){ee&&(ne(e),ne(m),ne(y),ne(_),ne(k),ne(ge),ne(R))}}}function Zo(r){let e,t=lt(r[72].debit)+"",s;return{c(){e=de("span"),s=De(t),this.h()},l(l){e=pe(l,"SPAN",{class:!0});var i=he(e);s=Oe(i,t),i.forEach(ne),this.h()},h(){te(e,"class","font-medium")},m(l,i){Pe(l,e,i),J(e,s)},p(l,i){i[0]&512&&t!==(t=lt(l[72].debit)+"")&&Be(s,t)},d(l){l&&ne(e)}}}function Yo(r){let e,t=lt(r[72].credit)+"",s;return{c(){e=de("span"),s=De(t),this.h()},l(l){e=pe(l,"SPAN",{class:!0});var i=he(e);s=Oe(i,t),i.forEach(ne),this.h()},h(){te(e,"class","font-medium")},m(l,i){Pe(l,e,i),J(e,s)},p(l,i){i[0]&512&&t!==(t=lt(l[72].credit)+"")&&Be(s,t)},d(l){l&&ne(e)}}}function Jo(r){let e,t=r[14].t("Recurring")+"",s;return{c(){e=de("span"),s=De(t),this.h()},l(l){e=pe(l,"SPAN",{class:!0});var i=he(e);s=Oe(i,t),i.forEach(ne),this.h()},h(){te(e,"class","inline-flex items-center px-1.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300")},m(l,i){Pe(l,e,i),J(e,s)},p(l,i){i[0]&16384&&t!==(t=l[14].t("Recurring")+"")&&Be(s,t)},d(l){l&&ne(e)}}}function Qo(r){let e,t=r[14].t("Unusual")+"",s;return{c(){e=de("span"),s=De(t),this.h()},l(l){e=pe(l,"SPAN",{class:!0});var i=he(e);s=Oe(i,t),i.forEach(ne),this.h()},h(){te(e,"class","inline-flex items-center px-1.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300")},m(l,i){Pe(l,e,i),J(e,s)},p(l,i){i[0]&16384&&t!==(t=l[14].t("Unusual")+"")&&Be(s,t)},d(l){l&&ne(e)}}}function es(r){let e,t,s=r[27](r[72].iqr_flag)+"";return{c(){e=de("span"),t=new qr(!1),this.h()},l(l){e=pe(l,"SPAN",{class:!0});var i=he(e);t=Xr(i,!1),i.forEach(ne),this.h()},h(){t.a=null,te(e,"class","ml-1")},m(l,i){Pe(l,e,i),t.m(s,e)},p(l,i){i[0]&512&&s!==(s=l[27](l[72].iqr_flag)+"")&&t.p(s)},d(l){l&&ne(e)}}}function ts(r){let e,t,s=r[72].postingDate+"",l,i,c,n=r[72].document+"",u,m,y,b,T=r[72].account+"",p,S,g,x=r[72].accountName+"",f,_,k,N=r[72].text+"",I,X,G,Z,C,ce,ge,R,H,A=r[72].debit&&Zo(r),j=r[72].credit&&Yo(r),oe=r[72].isRecurring&&Jo(r),V=r[72].isUnusual&&Qo(r),we=r[72].iqr_flag!==void 0&&es(r);return{c(){e=de("tr"),t=de("td"),l=De(s),i=Ae(),c=de("td"),u=De(n),m=Ae(),y=de("td"),b=de("div"),p=De(T),S=Ae(),g=de("div"),f=De(x),_=Ae(),k=de("td"),I=De(N),X=Ae(),G=de("td"),A&&A.c(),Z=Ae(),C=de("td"),j&&j.c(),ce=Ae(),ge=de("td"),oe&&oe.c(),R=Ae(),V&&V.c(),H=Ae(),we&&we.c(),this.h()},l(Y){e=pe(Y,"TR",{class:!0});var ee=he(e);t=pe(ee,"TD",{class:!0});var M=he(t);l=Oe(M,s),M.forEach(ne),i=Se(ee),c=pe(ee,"TD",{class:!0});var O=he(c);u=Oe(O,n),O.forEach(ne),m=Se(ee),y=pe(ee,"TD",{class:!0});var K=he(y);b=pe(K,"DIV",{class:!0});var q=he(b);p=Oe(q,T),q.forEach(ne),S=Se(K),g=pe(K,"DIV",{});var ie=he(g);f=Oe(ie,x),ie.forEach(ne),K.forEach(ne),_=Se(ee),k=pe(ee,"TD",{class:!0});var z=he(k);I=Oe(z,N),z.forEach(ne),X=Se(ee),G=pe(ee,"TD",{class:!0});var v=he(G);A&&A.l(v),v.forEach(ne),Z=Se(ee),C=pe(ee,"TD",{class:!0});var w=he(C);j&&j.l(w),w.forEach(ne),ce=Se(ee),ge=pe(ee,"TD",{class:!0});var U=he(ge);oe&&oe.l(U),R=Se(U),V&&V.l(U),H=Se(U),we&&we.l(U),U.forEach(ne),ee.forEach(ne),this.h()},h(){te(t,"class","px-4 py-2"),te(c,"class","px-4 py-2 font-medium"),te(b,"class","font-mono text-xs"),te(y,"class","px-4 py-2"),te(k,"class","px-4 py-2"),te(G,"class","px-4 py-2 text-right"),te(C,"class","px-4 py-2 text-right"),te(ge,"class","px-4 py-2 text-center"),te(e,"class","border-t border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800/50")},m(Y,ee){Pe(Y,e,ee),J(e,t),J(t,l),J(e,i),J(e,c),J(c,u),J(e,m),J(e,y),J(y,b),J(b,p),J(y,S),J(y,g),J(g,f),J(e,_),J(e,k),J(k,I),J(e,X),J(e,G),A&&A.m(G,null),J(e,Z),J(e,C),j&&j.m(C,null),J(e,ce),J(e,ge),oe&&oe.m(ge,null),J(ge,R),V&&V.m(ge,null),J(ge,H),we&&we.m(ge,null)},p(Y,ee){ee[0]&512&&s!==(s=Y[72].postingDate+"")&&Be(l,s),ee[0]&512&&n!==(n=Y[72].document+"")&&Be(u,n),ee[0]&512&&T!==(T=Y[72].account+"")&&Be(p,T),ee[0]&512&&x!==(x=Y[72].accountName+"")&&Be(f,x),ee[0]&512&&N!==(N=Y[72].text+"")&&Be(I,N),Y[72].debit?A?A.p(Y,ee):(A=Zo(Y),A.c(),A.m(G,null)):A&&(A.d(1),A=null),Y[72].credit?j?j.p(Y,ee):(j=Yo(Y),j.c(),j.m(C,null)):j&&(j.d(1),j=null),Y[72].isRecurring?oe?oe.p(Y,ee):(oe=Jo(Y),oe.c(),oe.m(ge,R)):oe&&(oe.d(1),oe=null),Y[72].isUnusual?V?V.p(Y,ee):(V=Qo(Y),V.c(),V.m(ge,H)):V&&(V.d(1),V=null),Y[72].iqr_flag!==void 0?we?we.p(Y,ee):(we=es(Y),we.c(),we.m(ge,null)):we&&(we.d(1),we=null)},d(Y){Y&&ne(e),A&&A.d(),j&&j.d(),oe&&oe.d(),V&&V.d(),we&&we.d()}}}function rs(r){let e,t,s=r[14].t("No transactions found for this period")+"",l;return{c(){e=de("tr"),t=de("td"),l=De(s),this.h()},l(i){e=pe(i,"TR",{});var c=he(e);t=pe(c,"TD",{colspan:!0,class:!0});var n=he(t);l=Oe(n,s),n.forEach(ne),c.forEach(ne),this.h()},h(){te(t,"colspan","7"),te(t,"class","px-4 py-8 text-center text-gray-500")},m(i,c){Pe(i,e,c),J(e,t),J(t,l)},p(i,c){c[0]&16384&&s!==(s=i[14].t("No transactions found for this period")+"")&&Be(l,s)},d(i){i&&ne(e)}}}function yh(r){let e,t,s,l,i="Loading account data...",c;return t=new dr({props:{className:"size-8"}}),{c(){e=de("div"),cr(t.$$.fragment),s=Ae(),l=de("div"),l.textContent=i,this.h()},l(n){e=pe(n,"DIV",{class:!0});var u=he(e);ur(t.$$.fragment,u),s=Se(u),l=pe(u,"DIV",{class:!0,"data-svelte-h":!0}),Vt(l)!=="svelte-1xgbd6n"&&(l.textContent=i),u.forEach(ne),this.h()},h(){te(l,"class","ml-3"),te(e,"class","flex justify-center items-center h-64")},m(n,u){Pe(n,e,u),fr(t,e,null),J(e,s),J(e,l),c=!0},p:dt,i(n){c||(Qe(t.$$.fragment,n),c=!0)},o(n){st(t.$$.fragment,n),c=!1},d(n){n&&ne(e),hr(t)}}}function vh(r){let e,t,s,l,i,c=r[14].t("Significance Threshold")+"",n,u,m,y,b,T,p="%",S,g,x,f,_,k,N,I,X,G,Z=r[28]()+"",C,ce,ge,R=rr(r[7]),H=[];for(let j=0;j<R.length;j+=1)H[j]=ns(Go(r,R,j));let A=r[5]&&is(r);return{c(){e=de("div"),t=de("div"),s=de("div"),l=de("div"),i=de("span"),n=De(c),u=De(":"),m=Ae(),y=de("input"),b=Ae(),T=de("span"),T.textContent=p,S=Ae(),g=de("div"),x=de("select");for(let j=0;j<H.length;j+=1)H[j].c();f=Ae(),_=de("div"),k=De(r[13]),N=Ae(),I=de("div"),A&&A.c(),X=Ae(),G=new qr(!1),this.h()},l(j){e=pe(j,"DIV",{class:!0});var oe=he(e);t=pe(oe,"DIV",{class:!0});var V=he(t);s=pe(V,"DIV",{class:!0});var we=he(s);l=pe(we,"DIV",{class:!0});var Y=he(l);i=pe(Y,"SPAN",{class:!0});var ee=he(i);n=Oe(ee,c),u=Oe(ee,":"),ee.forEach(ne),m=Se(Y),y=pe(Y,"INPUT",{type:!0,min:!0,max:!0,class:!0}),b=Se(Y),T=pe(Y,"SPAN",{class:!0,"data-svelte-h":!0}),Vt(T)!=="svelte-opx6g7"&&(T.textContent=p),Y.forEach(ne),S=Se(we),g=pe(we,"DIV",{class:!0});var M=he(g);x=pe(M,"SELECT",{id:!0,class:!0});var O=he(x);for(let ie=0;ie<H.length;ie+=1)H[ie].l(O);O.forEach(ne),M.forEach(ne),we.forEach(ne),V.forEach(ne),f=Se(oe),_=pe(oe,"DIV",{class:!0});var K=he(_);k=Oe(K,r[13]),K.forEach(ne),N=Se(oe),I=pe(oe,"DIV",{class:!0,"data-tree-container":!0});var q=he(I);A&&A.l(q),X=Se(q),G=Xr(q,!1),q.forEach(ne),oe.forEach(ne),this.h()},h(){te(i,"class","mr-2 text-sm font-medium text-gray-700 dark:text-gray-300"),te(y,"type","number"),te(y,"min","0"),te(y,"max","100"),te(y,"class","w-16 h-8 px-3 py-1 text-sm border border-blue-200 dark:border-blue-800 rounded-md bg-white dark:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"),te(T,"class","ml-1 text-sm text-gray-700 dark:text-gray-300"),te(l,"class","flex items-center"),te(x,"id","monthSelector"),te(x,"class","h-8 px-3 py-1 min-w-[130px] border border-blue-200 dark:border-blue-800 rounded-md bg-white dark:bg-gray-800 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"),r[1]===void 0&&pa(()=>r[41].call(x)),te(g,"class","ml-auto"),te(s,"class","flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3"),te(t,"class","controls-section mb-6 p-4 rounded-lg bg-blue-50 dark:bg-blue-950/30 border border-blue-200 dark:border-blue-900/50 shadow-sm"),te(_,"class","hidden"),G.a=null,te(I,"class","analysis-content rounded-lg border border-blue-200 dark:border-blue-800 overflow-hidden bg-white dark:bg-gray-800 shadow-md shadow-blue-100 dark:shadow-none relative"),te(I,"data-tree-container","true"),te(e,"class","mb-6")},m(j,oe){Pe(j,e,oe),J(e,t),J(t,s),J(s,l),J(l,i),J(i,n),J(i,u),J(l,m),J(l,y),Lt(y,r[8]),J(l,b),J(l,T),J(s,S),J(s,g),J(g,x);for(let V=0;V<H.length;V+=1)H[V]&&H[V].m(x,null);Di(x,r[1],!0),J(e,f),J(e,_),J(_,k),J(e,N),J(e,I),A&&A.m(I,null),J(I,X),G.m(Z,I),C=!0,ce||(ge=[rt(y,"input",r[40]),rt(y,"change",r[23]),rt(x,"change",r[41]),rt(x,"change",r[24]),rt(I,"click",r[29])],ce=!0)},p(j,oe){if((!C||oe[0]&16384)&&c!==(c=j[14].t("Significance Threshold")+"")&&Be(n,c),oe[0]&256&&ss(y.value)!==j[8]&&Lt(y,j[8]),oe[0]&128){R=rr(j[7]);let V;for(V=0;V<R.length;V+=1){const we=Go(j,R,V);H[V]?H[V].p(we,oe):(H[V]=ns(we),H[V].c(),H[V].m(x,null))}for(;V<H.length;V+=1)H[V].d(1);H.length=R.length}oe[0]&130&&Di(x,j[1]),(!C||oe[0]&8192)&&Be(k,j[13]),j[5]?A?(A.p(j,oe),oe[0]&32&&Qe(A,1)):(A=is(j),A.c(),Qe(A,1),A.m(I,X)):A&&($t(),st(A,1,1,()=>{A=null}),Gt())},i(j){C||(Qe(A),C=!0)},o(j){st(A),C=!1},d(j){j&&ne(e),fi(H,j),A&&A.d(),ce=!1,lr(ge)}}}function bh(r){let e,t,s,l,i,c=r[14].t("Account Tree Missing")+"",n,u,m,y=r[14].t("To use the Account Analysis feature, you need to upload an account tree file first.")+"",b,T,p,S,g,x,f,_=r[14].t("Download Template")+"",k,N,I,X,G,Z,C=r[14].t("Upload Account Tree")+"",ce,ge,R,H,A;return{c(){e=de("div"),t=kt("svg"),s=kt("path"),l=Ae(),i=de("p"),n=De(c),u=Ae(),m=de("p"),b=De(y),T=Ae(),p=de("div"),S=de("button"),g=kt("svg"),x=kt("path"),f=Ae(),k=De(_),N=Ae(),I=de("label"),X=kt("svg"),G=kt("path"),Z=Ae(),ce=De(C),ge=Ae(),R=de("input"),this.h()},l(j){e=pe(j,"DIV",{class:!0});var oe=he(e);t=Ct(oe,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var V=he(t);s=Ct(V,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),he(s).forEach(ne),V.forEach(ne),l=Se(oe),i=pe(oe,"P",{class:!0});var we=he(i);n=Oe(we,c),we.forEach(ne),u=Se(oe),m=pe(oe,"P",{class:!0});var Y=he(m);b=Oe(Y,y),Y.forEach(ne),T=Se(oe),p=pe(oe,"DIV",{class:!0});var ee=he(p);S=pe(ee,"BUTTON",{class:!0});var M=he(S);g=Ct(M,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var O=he(g);x=Ct(O,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),he(x).forEach(ne),O.forEach(ne),f=Se(M),k=Oe(M,_),M.forEach(ne),N=Se(ee),I=pe(ee,"LABEL",{class:!0});var K=he(I);X=Ct(K,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var q=he(X);G=Ct(q,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),he(G).forEach(ne),q.forEach(ne),Z=Se(K),ce=Oe(K,C),ge=Se(K),R=pe(K,"INPUT",{type:!0,class:!0,accept:!0}),K.forEach(ne),ee.forEach(ne),oe.forEach(ne),this.h()},h(){te(s,"stroke-linecap","round"),te(s,"stroke-linejoin","round"),te(s,"stroke-width","2"),te(s,"d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"),te(t,"xmlns","http://www.w3.org/2000/svg"),te(t,"class","h-12 w-12 mx-auto mb-4 text-gray-400"),te(t,"fill","none"),te(t,"viewBox","0 0 24 24"),te(t,"stroke","currentColor"),te(i,"class","text-lg font-medium"),te(m,"class","text-sm mt-1 mb-4"),te(x,"stroke-linecap","round"),te(x,"stroke-linejoin","round"),te(x,"stroke-width","2"),te(x,"d","M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l2.414 2.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"),te(g,"xmlns","http://www.w3.org/2000/svg"),te(g,"class","h-5 w-5 mr-2"),te(g,"fill","none"),te(g,"viewBox","0 0 24 24"),te(g,"stroke","currentColor"),te(S,"class","px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition flex items-center"),te(G,"stroke-linecap","round"),te(G,"stroke-linejoin","round"),te(G,"stroke-width","2"),te(G,"d","M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"),te(X,"xmlns","http://www.w3.org/2000/svg"),te(X,"class","h-5 w-5 mr-2"),te(X,"fill","none"),te(X,"viewBox","0 0 24 24"),te(X,"stroke","currentColor"),te(R,"type","file"),te(R,"class","hidden"),te(R,"accept",".xlsx,.xls,.csv"),te(I,"class","px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition cursor-pointer flex items-center"),te(p,"class","flex justify-center space-x-3"),te(e,"class","text-center py-12 bg-white dark:bg-gray-800 rounded-lg shadow")},m(j,oe){Pe(j,e,oe),J(e,t),J(t,s),J(e,l),J(e,i),J(i,n),J(e,u),J(e,m),J(m,b),J(e,T),J(e,p),J(p,S),J(S,g),J(g,x),J(S,f),J(S,k),J(p,N),J(p,I),J(I,X),J(X,G),J(I,Z),J(I,ce),J(I,ge),J(I,R),H||(A=[rt(S,"click",r[26]),rt(R,"change",r[39])],H=!0)},p(j,oe){oe[0]&16384&&c!==(c=j[14].t("Account Tree Missing")+"")&&Be(n,c),oe[0]&16384&&y!==(y=j[14].t("To use the Account Analysis feature, you need to upload an account tree file first.")+"")&&Be(b,y),oe[0]&16384&&_!==(_=j[14].t("Download Template")+"")&&Be(k,_),oe[0]&16384&&C!==(C=j[14].t("Upload Account Tree")+"")&&Be(ce,C)},i:dt,o:dt,d(j){j&&ne(e),H=!1,lr(A)}}}function _h(r){let e,t,s;return t=new dr({props:{className:"size-8"}}),{c(){e=de("div"),cr(t.$$.fragment),this.h()},l(l){e=pe(l,"DIV",{class:!0});var i=he(e);ur(t.$$.fragment,i),i.forEach(ne),this.h()},h(){te(e,"class","flex justify-center items-center h-64")},m(l,i){Pe(l,e,i),fr(t,e,null),s=!0},p:dt,i(l){s||(Qe(t.$$.fragment,l),s=!0)},o(l){st(t.$$.fragment,l),s=!1},d(l){l&&ne(e),hr(t)}}}function ns(r){let e,t=r[69]+"",s,l;return{c(){e=de("option"),s=De(t),this.h()},l(i){e=pe(i,"OPTION",{});var c=he(e);s=Oe(c,t),c.forEach(ne),this.h()},h(){e.__value=l=r[69],Lt(e,e.__value)},m(i,c){Pe(i,e,c),J(e,s)},p(i,c){c[0]&128&&t!==(t=i[69]+"")&&Be(s,t),c[0]&128&&l!==(l=i[69])&&(e.__value=l,Lt(e,e.__value))},d(i){i&&ne(e)}}}function is(r){let e,t,s,l,i,c=r[14].t("Loading...")+"",n,u;return s=new dr({props:{className:"size-10"}}),{c(){e=de("div"),t=de("div"),cr(s.$$.fragment),l=Ae(),i=de("p"),n=De(c),this.h()},l(m){e=pe(m,"DIV",{class:!0});var y=he(e);t=pe(y,"DIV",{class:!0});var b=he(t);ur(s.$$.fragment,b),l=Se(b),i=pe(b,"P",{class:!0});var T=he(i);n=Oe(T,c),T.forEach(ne),b.forEach(ne),y.forEach(ne),this.h()},h(){te(i,"class","mt-2 text-gray-600 dark:text-gray-400"),te(t,"class","flex flex-col items-center"),te(e,"class","absolute inset-0 bg-white/60 dark:bg-gray-900/60 flex items-center justify-center z-10")},m(m,y){Pe(m,e,y),J(e,t),fr(s,t,null),J(t,l),J(t,i),J(i,n),u=!0},p(m,y){(!u||y[0]&16384)&&c!==(c=m[14].t("Loading...")+"")&&Be(n,c)},i(m){u||(Qe(s.$$.fragment,m),u=!0)},o(m){st(s.$$.fragment,m),u=!1},d(m){m&&ne(e),hr(s)}}}function Eh(r){let e,t,s,l,i,c,n=r[15].isOpen&&Vo(r);const u=[mh,ph,dh,hh],m=[];function y(b,T){return b[2]==="main"?0:b[2]==="transactions"?1:b[2]==="chart"?2:b[2]==="analysis"?3:-1}return~(l=y(r))&&(i=m[l]=u[l](r)),{c(){n&&n.c(),e=Ae(),t=Ae(),s=de("div"),i&&i.c(),this.h()},l(b){n&&n.l(b),e=Se(b),ca("svelte-ktehck",Ho.head).forEach(ne),t=Se(b),s=pe(b,"DIV",{class:!0});var p=he(s);i&&i.l(p),p.forEach(ne),this.h()},h(){Ho.title="Account Analysis",te(s,"class","page-container w-full max-w-7xl mx-auto px-4 py-6 svelte-126e3bb")},m(b,T){n&&n.m(b,T),Pe(b,e,T),Pe(b,t,T),Pe(b,s,T),~l&&m[l].m(s,null),c=!0},p(b,T){b[15].isOpen?n?(n.p(b,T),T[0]&32768&&Qe(n,1)):(n=Vo(b),n.c(),Qe(n,1),n.m(e.parentNode,e)):n&&($t(),st(n,1,1,()=>{n=null}),Gt());let p=l;l=y(b),l===p?~l&&m[l].p(b,T):(i&&($t(),st(m[p],1,1,()=>{m[p]=null}),Gt()),~l?(i=m[l],i?i.p(b,T):(i=m[l]=u[l](b),i.c()),Qe(i,1),i.m(s,null)):i=null)},i(b){c||(Qe(n),Qe(i),c=!0)},o(b){st(n),st(i),c=!1},d(b){b&&(ne(e),ne(t),ne(s)),n&&n.d(b),~l&&m[l].d()}}}const yt="token_59b8b43a_aiurmmm0_upload_long_demo";function ei(r){if(!r||!r.name)return!1;const e=r.name;return/^\d/.test(e)||/\(A\d+\)/.test(e)||/\[A\d+\]/.test(e)||r.accounts&&Array.isArray(r.accounts)&&r.accounts.length>0?!0:r.level>=2&&(!r.children||Object.keys(r.children).length===0)?["account","acct","a/c","",""].some(s=>e.toLowerCase().includes(s)):!1}function oa(r){if(!r)return console.error("Invalid node provided to structureAccountTree"),{name:"Unknown",level:1,currentTotal:0,previousTotal:0,children:{}};const e={name:r.name||"Unknown",level:r.level||1,currentTotal:0,previousTotal:0,children:{}};return r.children&&Object.entries(r.children).forEach(([t,s])=>{e.children[t]=oa(s)}),e}function ui(r,e,t,s=[]){if(!t)return null;const l=t.name||"",c=l.split(" ")[0];if(console.log("Searching for account in tree:",{searchingFor:{account:r,accountName:e},currentNode:{nodeName:l,nodeAccountNumber:c,level:t.level},currentPath:s}),c===r||l===r){const n=[...s,l];return console.log("Found exact account match:",{account:r,foundPath:n}),n}if(l.includes(r)||e&&l.includes(e)){const n=[...s,l];return console.log("Found account number/name in node name:",{account:r,nodeName:l,foundPath:n}),n}if(t.accounts&&Array.isArray(t.accounts)&&t.accounts.some(u=>u===r||u.startsWith(r+" ")||e&&u.includes(e))){const u=[...s,l];return console.log("Found account in accounts array:",{account:r,foundPath:u}),u}if(t.children)for(const[n,u]of Object.entries(t.children)){const m=s.length===0&&t.level===0?[]:[...s,l],y=ui(r,e,u,m);if(y)return console.log("Found account in child node:",{account:r,childKey:n,childLevel:u.level,foundPath:y}),y}return null}function sa(r){r&&(r.currentTotal=0,r.previousTotal=0,r.children&&Object.values(r.children).forEach(e=>{sa(e)}))}function xh(r,e,t,s){let l=r,i=1;if(console.log("Updating category totals:",{path:e,currentAmount:t,previousAmount:s,rootNodeName:r==null?void 0:r.name}),!e||e.length===0){console.log("Empty path provided to updateCategoryTotals");return}let c=0;e[0]===(r==null?void 0:r.name)&&(console.log("First path element matches root node name, skipping:",{rootNodeName:r.name,firstPathElement:e[0]}),c=1);for(let n=c;n<e.length;n++){const u=e[n];if(!u){console.log("Undefined category in path",{index:n,path:e});continue}u.startsWith("-")&&(i*=-1,console.log("Negating values for category:",{category:u,multiplier:i}));const m=(u.startsWith("-"),u);if(l.children&&(l.children[u]||l.children[m])){const y=l.children[u]||l.children[m];n===e.length-1&&(y.currentTotal+=t*i,y.previousTotal+=s*i,console.log("Updated leaf node totals:",{category:u,newTotals:{currentTotal:y.currentTotal,previousTotal:y.previousTotal},addedAmount:{current:t*i,previous:s*i}})),l=y}else{console.log("Category not found in children",{category:u,pathIndex:n,availableChildren:l.children?Object.keys(l.children):"none"});return}}}function aa(r){if(!r)return console.log("Null category in rollUpCategoryTotals"),{current:0,previous:0};let e=0,t=0;return!r.children||Object.keys(r.children).length===0?(e=r.currentTotal,t=r.previousTotal,{current:e,previous:t}):(Object.entries(r.children).forEach(([s,l])=>{const i=aa(l),c=s.startsWith("-")||l.name&&l.name.startsWith("-")?-1:1;e+=i.current*c,t+=i.previous*c}),r.currentTotal=e,r.previousTotal=t,{current:e,previous:t})}function lt(r){return r==null?"-":new Intl.NumberFormat("en-US",{minimumFractionDigits:0,maximumFractionDigits:0}).format(r)}function os(r){return r==null?"-":`${r>0?"+":""}${r.toFixed(1)}%`}function zr(r){return r?String(r).replace(/\n/g,"<br>"):""}function Th(r,e,t){let s,l,i,c,n;sn(r,va,W=>t(49,n=W));const u=ua("i18n");sn(r,u,W=>t(14,i=W));const m=ya({isOpen:!1,title:"",content:"",isLoading:!1,company:"",account:"",isEditing:!1,editText:""});sn(r,m,W=>t(15,c=W));function y(W,re,fe){m.update(be=>({...be,isOpen:!0,title:W,isLoading:!0,company:re,account:fe,isEditing:!1,editText:""}))}function b(){m.update(W=>({...W,isOpen:!1}))}function T(){m.update(W=>{const re=W.isEditing?W.editText:W.content.replace(/<br>/g,`
`);return{...W,isEditing:!W.isEditing,editText:re}})}function p(){m.update(W=>{if(!W.isEditing)return W;const re=zr(W.editText);if(W.company&&W.account&&I){const fe=`${W.company}-${W.account}-${I}`,be=`${W.company}-${W.account}`;t(35,Z={...Z,[fe]:W.editText,[be]:W.editText}),h(W.company,W.account,W.editText).then(()=>{Je.success(i.t("Analysis saved"))}).catch(Te=>{console.error("Error saving analysis:",Te),Je.error(i.t("Failed to save analysis"))})}return{...W,content:re,isEditing:!1}})}let S="en";localStorage.getItem("locale")==="zh-CN"?S="zh-cn":S="en";const g=Aa;let x=!1,f=null,_=null,k={},N={},I=null,X=[],G=10,Z={},C="main",ce=[],ge="",R=null,H="",A=null,j="",oe=!1,V=!1,we={month:null,company:null,account:null,timestamp:0},Y=!1;fa(()=>{if(console.log("Current user language:",i.language),console.log("Current user API key:",n),console.log("Component mounted, loading account tree..."),ee(),document.addEventListener("select-month",re=>{if(console.log("Custom select-month event received:",re.detail),Y){console.log("Already processing an event, skipping new event");return}if(re.detail){const{month:fe,company:be,account:Te}=re.detail;console.log("Extracted values from event:",{month:fe,company:be||"null/undefined",account:Te||"null/undefined",typeofCompany:typeof be,typeofAccount:typeof Te});const Ee=Date.now();if(we.month===fe&&we.company===be&&we.account===Te&&Ee-we.timestamp<500){console.log("Ignoring duplicate event within debounce period");return}Y=!0,we={month:fe,company:be,account:Te,timestamp:Ee},fe?(console.log("Setting selected month to:",fe),t(1,I=fe),t(12,oe=!0),setTimeout(async()=>{try{if(be&&Te&&be!=="undefined"&&Te!=="undefined"){console.log("Using company/account from event:",be,Te);const Ie=`${be}-${Te}-${fe}`,Ue=`${be}-${Te}`;console.log("Analysis keys to check:",{analysisKey:Ie,generalKey:Ue,hasMonthSpecificAnalysis:!!Z[Ie],hasGeneralAnalysis:!!Z[Ue]}),await D(be,Te)}else if(R&&R.company&&R.account){console.log("Using company/account from chartData:",R.company,R.account);const Ie=`${R.company}-${R.account}-${fe}`,Ue=`${R.company}-${R.account}`;console.log("Analysis keys to check:",{analysisKey:Ie,generalKey:Ue,hasMonthSpecificAnalysis:!!Z[Ie],hasGeneralAnalysis:!!Z[Ue]}),await D(R.company,R.account)}else console.error("Cannot fetch analysis: missing company or account information",{fromEvent:{company:be,account:Te},fromChartData:R?{company:R.company,account:R.account}:"chartData is null",chartData:R}),t(12,oe=!1)}finally{console.log("Finished processing select-month event"),Y=!1}},50)):Y=!1}else Y=!1}),setTimeout(()=>{const re=document.getElementById("monthSelector");re&&(console.log("Adding event listener to month selector"),re.addEventListener("change",fe=>{C==="chart"&&R&&(console.log("Month selector changed, updating chart"),setTimeout(()=>ae(),50))}))},500),typeof window<"u"&&!window.hasOwnProperty("Chart")){const re=document.createElement("script");re.src="https://cdn.jsdelivr.net/npm/chart.js",re.async=!0,document.head.appendChild(re)}const W=new MutationObserver(re=>{re.forEach(fe=>{if(fe.type==="attributes"&&fe.attributeName==="data-ready"){const be=document.getElementById("trendChart");be&&be.getAttribute("data-ready")==="true"&&ae()}})});setTimeout(()=>{const re=document.getElementById("trendChart");re&&(W.observe(re,{attributes:!0}),re.getAttribute("data-ready")==="true"&&ae())},200)});async function ee(){try{t(5,x=!0),console.log("=== REQUEST ==="),console.log(`URL: ${g}/proxy/api/account_tree`),console.log("Method: GET"),console.log("Headers:",{"Content-Type":"application/json","Accept-Language":S,Authorization:`Bearer ${yt}`}),console.log(`
`);const W=await fetch(`${g}/proxy/api/account_tree`,{method:"GET",headers:{"Content-Type":"application/json","Accept-Language":S,Authorization:`Bearer ${yt}`}});console.log("=== RESPONSE ==="),console.log("Status:",W.status),console.log("Headers:",Object.fromEntries([...W.headers.entries()]));const re=await W.json();console.log("Body:",re),console.log(`
`),re.success&&re.data?(console.log("Account tree loaded successfully"),t(6,_=re.data),M(_),await O()):(console.error("Account tree response indicates failure:",re.error||"Unknown error"),t(6,_=null))}catch(W){console.error("Error loading account tree:",W),Je.error(i.t("Failed to load account tree")),t(6,_=null)}finally{t(5,x=!1)}}function M(W){if(!W)return;const re=Object.keys(W);t(33,k={}),t(34,N={}),re.length>0&&(re.forEach(fe=>{t(33,k[fe]=!0,k),Object.keys(W).forEach(Te=>{const Ee=W[Te];if(Ee&&typeof Ee=="object"){const Ce=`${fe}/${Te}`;t(34,N[Ce]=!0,N),Ee.children&&Object.entries(Ee.children).forEach(([Ie,Ue])=>{const je=(Ue==null?void 0:Ue.name)||Ie;if(je.includes("Operating")||je.includes("Profit")||je.includes("Revenue")||je.includes("Sales")||je.includes("Costs")||je.includes("Expenses")){const Re=`${fe}/${Te}/${Ie}`;t(34,N[Re]=!0,N),console.log(`Auto-expanded category: ${je}, Path: ${Re}`)}})}})}),console.log("Initialized expanded states:",{companies:Object.keys(k),categories:Object.keys(N).length}))}async function O(){if(!_)return console.log("fetchData: No account tree available, returning early"),Promise.resolve();try{const W=I?`${g}/proxy/api/is_analysis?month=${I}`:`${g}/proxy/api/is_analysis`;console.log("=== REQUEST ==="),console.log(`URL: ${W}`),console.log("Method: GET"),console.log("Headers:",{"Content-Type":"application/json","Accept-Language":S,Authorization:`Bearer ${yt}`}),console.log(`
`);const re=await fetch(W,{method:"GET",headers:{"Content-Type":"application/json","Accept-Language":S,Authorization:`Bearer ${yt}`}});console.log("=== RESPONSE ==="),console.log("Status:",re.status),console.log("Headers:",Object.fromEntries([...re.headers.entries()]));const fe=await re.json();if(console.log("Body:",fe),console.log(`
`),fe.success&&fe.data)return console.log("IS analysis data loaded successfully"),t(0,f=K(fe.data)),t(7,X=fe.data.monthOptions||[]),I||t(1,I=fe.data.selectedMonth),console.log("Selected month:",I),console.log("Available months:",X),console.log("Processed data:",f),Promise.resolve();throw console.error("IS analysis response indicates failure:",fe.error||"Unknown error"),new Error(fe.error||"Invalid data structure received")}catch(W){return console.error("Error loading IS analysis data:",W),Je.error(i.t("Failed to load analysis data")),Promise.reject(W)}}function K(W){if(!_)return{companies:{}};try{const re={companies:{}};return console.log("Processing data with account tree:",{companiesCount:Object.keys(W.companies||{}).length,hasAccountTree:!!_}),Object.entries(W.companies||{}).forEach(([fe,be])=>{re.companies[fe]={accounts:{},categories:oa(q()),currentTotal:0,previousTotal:0},console.log("Processing company data:",{company:fe,accountsCount:Object.keys(be.accounts||{}).length}),Object.entries(be.accounts||{}).forEach(([Ee,Ce])=>{const Ie=ui(Ee,Ce.name,q());console.log("Account category path found:",{account:Ee,accountName:Ce.name,categoryPath:Ie||"Not found"}),Ie?re.companies[fe].accounts[Ee]={...Ce,categoryPath:Ie}:console.log("No category path found for account",{account:Ee,accountName:Ce.name})}),sa(re.companies[fe].categories);const Te=[];Object.entries(be.accounts||{}).forEach(([Ee,Ce])=>{const Ie=ui(Ee,Ce.name,q());Ie&&Te.push({account:Ee,accountName:Ce.name,categoryPath:Ie,currentTotal:Ce.currentTotal||0,previousTotal:Ce.previousTotal||0})}),Te.sort((Ee,Ce)=>Ce.categoryPath.length-Ee.categoryPath.length),Te.forEach(({account:Ee,accountName:Ce,categoryPath:Ie,currentTotal:Ue,previousTotal:je})=>{xh(re.companies[fe].categories,Ie,Ue,je)}),aa(re.companies[fe].categories)}),console.log("Processed data structure:",re),re}catch(re){return console.error("Error processing data with tree:",re),{companies:{}}}}function q(){if(!_||typeof _!="object")return console.error("Invalid account tree structure",{tree:_}),null;const W=Object.keys(_);if(W.length===0)return console.error("Account tree has no root nodes",{tree:_}),null;const re={name:"Root",level:0,children:{}};return W.forEach(fe=>{_[fe]&&(re.children[fe]=_[fe])}),console.log("Using merged root node for account tree:",{rootKeys:W,childrenCount:Object.keys(re.children).length,childrenNames:Object.keys(re.children).join(", ")}),re}function ie(W){if(!W){console.error("Invalid company name in toggleCompany");return}console.log("Toggling company:",W,"Current state:",k[W]);const re={...k};re[W]=!k[W],t(33,k=re),console.log("New expanded state for company:",W,k[W]),t(13,s=Date.now().toString()),setTimeout(()=>{const fe=document.querySelector('[data-tree-container="true"]');fe?fe.innerHTML=P():console.error("Analysis content container not found")},10)}function z(W){if(!W||W==="Unknown"||W==="undefined"){console.error("Invalid category path in toggleCategory:",W);return}console.log("Toggling category:",W,"Current state:",N[W]);const re={...N};re[W]=!N[W],t(34,N=re),console.log("New expanded state for category:",W,N[W]),t(13,s=Date.now().toString()),setTimeout(()=>{const fe=document.querySelector('[data-tree-container="true"]');fe?fe.innerHTML=P():console.error("Analysis content container not found")},10)}function v(W){const re=W.target.value.replace(/^0+/,"")||"0";t(8,G=Number(re))}function w(W){t(1,I=W.target.value),console.log("Month changed to:",I),t(5,x=!0),O().then(()=>{console.log("Data fetched for new month, updating UI"),t(13,s=Date.now().toString()),C==="chart"&&R&&(console.log("Updating chart with new month:",I),setTimeout(()=>ae(),50)),t(5,x=!1)})}async function U(W,re,fe,be=!1){try{const Te=`${g}/proxy/api/transactions?company=${encodeURIComponent(W)}&account=${encodeURIComponent(re)}&month=${encodeURIComponent(fe)}`;console.log("=== REQUEST ==="),console.log(`URL: ${Te}`),console.log("Method: GET"),console.log("Headers:",{"Content-Type":"application/json","Accept-Language":S,Authorization:`Bearer ${yt}`}),console.log(`
`);const Ee=await fetch(Te,{method:"GET",headers:{"Content-Type":"application/json","Accept-Language":S,Authorization:`Bearer ${yt}`}});console.log("=== RESPONSE ==="),console.log("Status:",Ee.status),console.log("Headers:",Object.fromEntries([...Ee.headers.entries()]));const Ce=await Ee.json();if(console.log("Body:",Ce),console.log(`
`),Ce.success&&Ce.data)t(9,ce=Ce.data.transactions),t(10,ge=`${W} - ${re} - ${fe} ${be?"(Previous)":"(Current)"}`),t(2,C="transactions");else throw console.error("Transactions response indicates failure:",Ce.error||"Unknown error"),new Error(Ce.error||"Failed to load transactions")}catch(Te){console.error("Error loading transactions:",Te),Je.error(i.t("Failed to load transactions"))}}async function L(W,re,fe){console.log("handleAccountClick called with:",{company:W,account:re,accountName:fe});try{const be=`${g}/proxy/api/account_trend?company=${encodeURIComponent(W)}&account=${encodeURIComponent(re)}`;console.log("=== REQUEST ==="),console.log(`URL: ${be}`),console.log("Method: GET"),console.log("Headers:",{"Content-Type":"application/json","Accept-Language":S,Authorization:`Bearer ${yt}`}),console.log(`
`);const Te=await fetch(be,{method:"GET",headers:{"Content-Type":"application/json","Accept-Language":S,Authorization:`Bearer ${yt}`}});console.log("=== RESPONSE ==="),console.log("Status:",Te.status),console.log("Headers:",Object.fromEntries([...Te.headers.entries()]));const Ee=await Te.json();if(console.log("Body:",Ee),console.log(`
`),Ee.success&&Ee.data)t(3,R={...Ee.data,company:W,account:re}),console.log("ChartData set with explicit company/account:",R),t(4,H=`${W} - ${re} - ${fe}`),t(2,C="chart"),Z[`${W}-${re}`]||D(W,re);else throw console.error("Account trend response indicates failure:",Ee.error||"Unknown error"),new Error(Ee.error||"Failed to load trend data")}catch(be){console.error("Error loading trend data:",be),Je.error(i.t("Failed to load trend data"))}}async function D(W,re){var be,Te,Ee,Ce;if(console.log("Fetching auto analysis for:",W,re,"with selected month:",I),!W||!re||W==="undefined"||re==="undefined"){console.error("Invalid company or account for auto analysis:",{company:W,account:re}),Je.error(i.t("Missing company or account information")),m.update(Ie=>({...Ie,isLoading:!1,content:`<p class="text-red-500">${i.t("Missing company or account information")}</p>`}));return}if(!I){console.error("Missing selected month for analysis"),Je.error(i.t("Missing month information")),m.update(Ie=>({...Ie,isLoading:!1,content:`<p class="text-red-500">${i.t("Missing month information")}</p>`}));return}if(!((Ee=(Te=(be=f==null?void 0:f.companies)==null?void 0:be[W])==null?void 0:Te.accounts)!=null&&Ee[re])){console.debug("Data for auto analysis not available yet:",{company:W,account:re,dataAvailable:!!f,companiesAvailable:f?Object.keys(f.companies||{}):[],accountsAvailable:(Ce=f==null?void 0:f.companies)!=null&&Ce[W]?Object.keys(f.companies[W].accounts||{}):[]});const Ie=re;y(`${W} - ${re} - ${Ie}`,W,re);const Ue={name:Ie,currentTotal:0,previousTotal:0,months:[{previousMonth:""}]};try{await B(W,re,Ue)}catch(je){console.debug("Error in analysis with fallback data:",je),m.update($e=>({...$e,isLoading:!1,content:`<p>${i.t("Analysis data not available for this account yet. Please try again later.")}</p>`}))}return}const fe=f.companies[W].accounts[re];y(`${W} - ${re} - ${fe.name}`,W,re),await B(W,re,fe)}async function B(W,re,fe){var Te,Ee;const be=setTimeout(()=>{m.update(Ce=>Ce.isLoading?(console.log("Analysis request timed out after 15 seconds"),Je.error(i.t("Analysis request timed out. Please try again.")),{...Ce,isLoading:!1,content:`<p class="text-red-500">${i.t("Analysis request timed out. Please try again.")}</p>`}):Ce)},15e3);try{console.log("Account data for analysis:",fe);const Ce={company:W,account:re,accountName:fe.name,currentMonth:I,previousMonth:(Ee=(Te=fe.months)==null?void 0:Te[0])==null?void 0:Ee.previousMonth,changePercentage:(fe.currentTotal-fe.previousTotal)/Math.abs(fe.previousTotal||1)*100};console.log("Auto analysis request data:",Ce);const Ie=new AbortController,Ue=setTimeout(()=>Ie.abort(),1e4);let je,$e;try{if(je=await fetch(`${g}/proxy/api/auto_analysis`,{method:"POST",headers:{"Content-Type":"application/json","Accept-Language":S,Authorization:`Bearer ${yt}`},body:JSON.stringify(Ce),signal:Ie.signal}),clearTimeout(Ue),console.log("Auto analysis response status:",je.status),!je.ok)throw new Error(`Server responded with ${je.status}: ${je.statusText}`);$e=await je.json(),console.log("Auto analysis response data:",$e)}catch(Re){Re.name==="AbortError"?(console.error("Analysis request aborted due to timeout"),Je.error(i.t("Analysis request timed out")),m.update(He=>({...He,isLoading:!1,content:`<p class="text-red-500">${i.t("Analysis request timed out")}</p>`}))):(console.error("Error during fetch:",Re),Je.error(i.t("Error communicating with server")),m.update(He=>({...He,isLoading:!1,content:`<p class="text-red-500">${i.t("Error communicating with server")}</p>`}))),clearTimeout(be);return}if($e&&$e.success){console.log("Auto analysis generated successfully");const Re=typeof $e.analysis=="string"?$e.analysis:String($e.analysis||""),He=`${W}-${re}-${I}`;t(35,Z={...Z,[He]:Re,[`${W}-${re}`]:Re}),console.log("Analysis stored with keys:",{monthSpecificKey:He,generalKey:`${W}-${re}`}),m.update(at=>({...at,isLoading:!1,content:zr(Re),editText:Re})),t(11,j=Re),A=He}else{console.error("Auto analysis response indicates failure:",($e==null?void 0:$e.error)||"Unknown error"),Je.error(i.t("Failed to generate analysis")),m.update(at=>({...at,isLoading:!1,content:`<p class="text-red-500">${i.t("Failed to generate analysis")}</p>`}));const Re=`${W}-${re}-${I}`,He=`${W}-${re}`;t(11,j=Z[Re]||Z[He]||""),A=Re}}catch(Ce){console.error("Error generating analysis:",Ce),Je.error(i.t("Error generating analysis")),m.update(je=>({...je,isLoading:!1,content:`<p class="text-red-500">${i.t("Error generating analysis")}</p>`}));const Ie=`${W}-${re}-${I}`,Ue=`${W}-${re}`;t(11,j=Z[Ie]||Z[Ue]||""),A=Ie}finally{clearTimeout(be)}}async function se(){if(!A)return;const W=A.split("-"),re=W[0],fe=W[1],be=W.length>2?W.slice(2).join("-"):I;try{const Te=`${re}-${fe}-${be}`,Ee=`${re}-${fe}`;t(35,Z={...Z,[Te]:j,[Ee]:j}),await h(re,fe,j),t(2,C="main"),Je.success(i.t("Analysis saved"))}catch(Te){console.error("Error saving analysis:",Te),Je.error(i.t("Failed to save analysis"))}}async function h(W,re,fe){try{const be=f.companies[W].accounts[re],Ee=await(await fetch(`${g}/proxy/api/update_graph_analysis`,{method:"POST",headers:{"Content-Type":"application/json","Accept-Language":S,Authorization:`Bearer ${yt}`},body:JSON.stringify({company:W,account:re,accountName:be.name,currentMonth:I,llm_analysis:fe})})).json();if(!Ee.success)throw new Error(Ee.error||"Failed to update graph analysis")}catch(be){throw console.error("Error updating graph node analysis:",be),be}}async function Q(){try{const W=await fetch(`${g}/proxy/api/download_account_tree_template`,{method:"GET",headers:{"Content-Type":"application/json","Accept-Language":S,Authorization:`Bearer ${yt}`}});if(!W.ok)throw new Error("Failed to download template");const re=await W.blob(),fe=window.URL.createObjectURL(re),be=document.createElement("a");be.style.display="none",be.href=fe,be.download="account_tree_template.xlsx",document.body.appendChild(be),be.click(),setTimeout(()=>{window.URL.revokeObjectURL(fe),document.body.removeChild(be)},100),Je.success(i.t("Template downloaded"))}catch(W){console.error("Error downloading template:",W),Je.error(i.t("Failed to download template"))}}function E(W){return W?Math.abs(W)>=G:!1}function o(W){return W===1?`<span title="${i.t("Above normal range")}"> +</span>`:W===-1?`<span title="${i.t("Below normal range")}"> -</span>`:W===0?`<span title="${i.t("Within normal range")}"></span>`:"-"}function a(){return`
      <div class="table-header w-full grid grid-cols-5 text-sm font-semibold py-2 px-3 bg-blue-100 dark:bg-blue-900/30 border-b border-blue-200 dark:border-blue-900/50 rounded-t-lg">
        <div class="col-span-1">${i.t("Account")}</div>
        <div class="text-right pr-4">${i.t("Current")}</div>
        <div class="text-right pr-4">${i.t("Previous")}</div>
        <div class="text-right pr-4">${i.t("Variance")}</div>
        <div class="text-right pr-4">${i.t("Change %")}</div>
      </div>
    `}function d(W,re,fe,be){var Ce,Ie;const Te=be.previousTotal!==0?(be.currentTotal-be.previousTotal)/Math.abs(be.previousTotal)*100:0,Ee=E(Te);return`
      <div class="account-row w-full grid grid-cols-5 text-sm py-2 px-3 border-b border-blue-100 dark:border-blue-900/20 hover:bg-blue-50 dark:hover:bg-blue-900/10 ${Ee?"bg-yellow-50 dark:bg-yellow-900/10":""}">
        <div class="flex items-center" style="padding-left: 16px;">
          <span class="font-mono text-xs mr-2 text-gray-500 dark:text-gray-400">${re}</span>
          <span class="cursor-pointer hover:text-blue-600 dark:hover:text-blue-400" 
             data-action="account-click" 
             data-company="${W}" 
             data-account="${re}" 
             data-name="${fe}">
            ${fe}
          </span>
        </div>
        <div class="text-right pr-4 cursor-pointer hover:text-blue-600 dark:hover:text-blue-400" 
           data-action="transactions" 
           data-company="${W}" 
           data-account="${re}" 
           data-month="${I}">
          ${lt(be.currentTotal)}
        </div>
        <div class="text-right pr-4 cursor-pointer hover:text-blue-600 dark:hover:text-blue-400" 
           data-action="transactions-prev" 
           data-company="${W}" 
           data-account="${re}" 
           data-month="${((Ie=(Ce=be.months)==null?void 0:Ce[0])==null?void 0:Ie.previousMonth)||""}">
          ${lt(be.previousTotal)}
        </div>
        <div class="text-right pr-4">
          ${lt(be.currentTotal-be.previousTotal)}
        </div>
        <div class="text-right pr-4 ${Ee?"text-red-600 dark:text-red-400 font-semibold":""}">
          ${os(Te)}
          <i class="edit-icon ml-2 cursor-pointer" 
             data-action="show-analysis" 
             data-company="${W}" 
             data-account="${re}"
             data-name="${fe}"
             title="${i.t("View Analysis")}">
            
          </i>
        </div>
      </div>
    `}function F(W,re,fe,be){var He,at,Xe;if(!re)return"";let Te="";const Ee=re.name||"";if(!Ee)return console.error("Category has no name:",re),"";if(fe===0&&Ee==="Root")return console.log("Rendering root node children as categories:",Ee),re.children&&Object.entries(re.children).sort((Ve,Ke)=>{const gt=Ve[1].name||Ve[0],ht=Ke[1].name||Ke[0];return gt.includes("Operating Profit")||gt.includes("Profit")?-1:ht.includes("Operating Profit")||ht.includes("Profit")||gt.includes("Operating Costs")||gt.includes("Costs")?1:ht.includes("Operating Costs")||ht.includes("Costs")?-1:String(gt).localeCompare(String(ht))}).forEach(([Ve,Ke])=>{console.log(`Rendering top-level category: ${Ve}`),Te+=F(W,Ke,fe+1,[...be,Ee])}),Te;if(fe!==0&&(Ee===""||Ee.toLowerCase()==="profit"))return console.log("Bypassing profit/loss node:",Ee),re.children&&Object.entries(re.children).forEach(([Ze,Ve])=>{Te+=F(W,Ve,fe+1,[...be,Ee])}),Te;if(ei(re)){console.log("Rendering account node:",Ee);const Ze=Ee.split(" ")[0],Ve=Ee.substring(Ze.length+1).trim(),Ke=((Xe=(at=(He=f==null?void 0:f.companies)==null?void 0:He[W])==null?void 0:at.accounts)==null?void 0:Xe[Ze])||{currentTotal:re.currentTotal||0,previousTotal:re.previousTotal||0};return d(W,Ze,Ve,Ke)}const Ce=[...be,Ee].join("/"),Ie=!!N[Ce],Ue=Ee.startsWith("-")?Ee.substring(1):Ee;console.log(`Rendering category: ${Ee}, Path: ${Ce}, Level: ${fe}`);const je=re.currentTotal||0,$e=re.previousTotal||0,Re=$e!==0&&$e!=null?(je-$e)/Math.abs($e)*100:0;if(Te+=`
      <div class="category-section">
        <div 
          class="category-header w-full grid grid-cols-5 text-sm py-2 px-3 
          ${fe>0?"bg-blue-50/70 dark:bg-blue-900/20":"bg-blue-100 dark:bg-blue-900/30"} 
          cursor-pointer hover:bg-blue-100 dark:hover:bg-blue-900/40 border-b border-blue-200 dark:border-blue-900/30"
          data-action="toggle-category" 
          data-path="${Ce}"
          style="padding-left: ${fe*20+12}px">
          <div class="flex items-center">
            <div class="toggle-icon mr-2 text-blue-600 dark:text-blue-400">${Ie?"":""}</div>
            <div class="font-medium text-blue-800 dark:text-blue-300">${Ue}</div>
          </div>
          <div class="text-right pr-4">${lt(je)}</div>
          <div class="text-right pr-4">${lt($e)}</div>
          <div class="text-right pr-4">${lt(je-$e)}</div>
          <div class="text-right pr-4 ${E(Re)?"text-red-600 dark:text-red-400 font-semibold":""}">
            ${os(Re)}
          </div>
        </div>
    `,Ie&&re.children){Te+='<div class="category-content">';try{Object.entries(re.children).sort((Ve,Ke)=>{const gt=ei(Ve[1]),ht=ei(Ke[1]);if(gt&&!ht)return 1;if(!gt&&ht)return-1;const Nt=Ve[1].name||Ve[0],Mt=Ke[1].name||Ke[0];return String(Nt).localeCompare(String(Mt))}).forEach(([Ve,Ke])=>{Ke&&(Te+=F(W,Ke,fe+1,[...be,Ee]))})}catch(Ze){console.error("Error rendering category children:",Ze),Te+=`<div class="error p-2 text-red-500">Error rendering children: ${Ze.message||"Unknown error"}</div>`}Te+="</div>"}return Te+="</div>",Te}function $(W,re){if(!re)return console.error("Invalid company data:",W),"";console.log("Rendering company:",W,re);const fe=!!k[W];let be=`
      <div class="company-section mb-4">
        <div class="company-header flex items-center justify-between p-3 bg-blue-50 dark:bg-blue-950/30 border border-blue-200 dark:border-blue-900/50 rounded-t-lg cursor-pointer transition duration-150 hover:bg-blue-100 dark:hover:bg-blue-900/50"
             data-action="toggle-company" 
             data-company="${W}">
          <div class="flex items-center">
            <div class="toggle-icon mr-2 text-blue-600 dark:text-blue-400">${fe?"":""}</div>
            <div class="font-bold text-blue-800 dark:text-blue-300">${W}</div>
          </div>
        </div>
    `;return fe&&(be+=`
        <div class="company-content">
          <div class="company-data border border-blue-200 dark:border-blue-900/50 rounded-b-lg bg-white dark:bg-gray-800">
            ${a()}
    `,re.categories&&(be+=F(W,re.categories,0,[])),be+=`
        </div>
      </div>
    `),be+="</div>",be}function P(){if(!_||!f)return console.log("Cannot render tree: missing accountTree or data"),"";let W="";return console.log("Rendering tree structure with data:",f),Object.entries(f.companies||{}).forEach(([re,fe])=>{W+=$(re,fe)}),W}function ue(W){const fe=W.target.closest("[data-action]");if(!fe)return;const be=fe.dataset.action;switch(console.log("Modal action clicked:",be,fe.dataset),be){case"toggle-company":const Te=fe.dataset.company;if(!Te){console.error("No company key provided in toggle-company action");return}console.log("Toggle company clicked for:",Te),ie(Te);break;case"toggle-category":const Ee=fe.dataset.path;if(!Ee){console.error("No path provided in toggle-category action");return}console.log("Toggle category path:",Ee),z(Ee);break;case"select-month":const Ce=fe.dataset.month;if(Ce&&R){console.log("Month selected:",Ce),t(1,I=Ce);const wr=`${R.company}-${R.account}-${Ce}`,yr=`${R.company}-${R.account}`;!Z[wr]&&!Z[yr]&&D(R.company,R.account)}break;case"close-popup":t(1,I=null);break;case"account-click":const Ie=fe.dataset.company,Ue=fe.dataset.account,je=fe.dataset.name;if(console.log("Account click action with data:",{company:Ie,account:Ue,name:je}),!Ie||!Ue){console.error("Missing company or account data for account-click action");return}L(Ie,Ue,je);break;case"transactions":const $e=fe.dataset.company,Re=fe.dataset.account,He=fe.dataset.month;U($e,Re,He);break;case"transactions-prev":const at=fe.dataset.company,Xe=fe.dataset.account;let Ze=fe.dataset.month;if(!Ze)if(I){const[wr,yr]=I.split("-").map(Number);let vr=yr-1,Ri=wr;vr===0&&(vr=12,Ri--),Ze=`${Ri}-${vr.toString().padStart(2,"0")}`,console.log("Calculated previous month:",Ze)}else Ze=I;Ze&&U(at,Xe,Ze,!0);break;case"show-analysis":const Ve=fe.dataset.company,Ke=fe.dataset.account,gt=fe.dataset.name;console.log("Show analysis for:",Ve,Ke,gt);const ht=`${Ve} - ${Ke} - ${gt}`,Nt=`${Ve}-${Ke}-${I}`,Mt=`${Ve}-${Ke}`;if(Z[Nt]||Z[Mt]){const wr=zr(Z[Nt]||Z[Mt]),yr=Z[Nt]||Z[Mt]||"";m.update(vr=>({...vr,isOpen:!0,title:ht,content:wr,isLoading:!1,company:Ve||"",account:Ke||"",isEditing:!1,editText:yr}))}else D(Ve,Ke);break;case"generate-analysis":const Ir=fe.dataset.company,Rr=fe.dataset.account,on=fe.dataset.month;A=`${Ir}-${Rr}-${on}`,D(Ir,Rr);break}}function ve(){console.log("Navigating back from view:",C),t(2,C="main")}function ae(){if(typeof window>"u")return;const W=document.getElementById("trendChart");if(!W||!R)return;const re=W.getAttribute("data-company"),fe=W.getAttribute("data-account");if(console.log("Chart initialization with data attributes:",{company:re,account:fe,hasChartData:!!R,dataReady:W.getAttribute("data-ready"),selectedMonth:I}),typeof Chart>"u"){console.log("Chart.js not loaded yet, trying again in 100ms"),setTimeout(ae,100);return}try{const be=W.getContext("2d");if(!be)return;window.trendChartInstance&&(console.log("Destroying previous chart instance"),window.trendChartInstance.destroy());const Te=R.months.map((Re,He)=>({month:Re,value:R.values[He]||0,dateValue:Re.split("-").map(Number).reduce((at,Xe)=>at*100+Xe,0),originalIndex:He})).sort((Re,He)=>Re.dateValue-He.dateValue),Ee=Te.map(Re=>Re.month),Ce=Te.map(Re=>Re.value),Ie=Ee.map((Re,He)=>{if(I===Re)return"#8b5cf6";if(!I&&He===Ee.length-1)return"#3b82f6";const at=`${R.company}-${R.account}-${Re}`,Xe=`${R.company}-${R.account}`;return Z[at]||Z[Xe]?"#60a5fa":"#94a3b8"}),Ue=be.createLinearGradient(0,0,800,0);Ue.addColorStop(0,"rgba(59, 130, 246, 0.8)"),Ue.addColorStop(1,"rgba(139, 92, 246, 0.8)"),console.log("Creating chart with following configuration:",{labels:Ee,company:re,account:fe,selectedMonth:I,canvasDataAttributes:{company:W.getAttribute("data-company"),account:W.getAttribute("data-account")},pointColors:Ie});const je=Ee.map(Re=>Re===I?8:6),$e=Ee.map(Re=>Re===I?10:8);window.trendChartInstance=new Chart(be,{type:"line",data:{labels:Ee,datasets:[{label:"Monthly Values",data:Ce,borderColor:Ue,backgroundColor:Ue,pointBackgroundColor:Ie,pointBorderColor:Ee.map(Re=>"#ffffff"),pointBorderWidth:Ee.map(Re=>Re===I?2:1.5),pointRadius:je,pointHoverRadius:$e,borderWidth:3,tension:.1,fill:!1}]},options:{responsive:!0,maintainAspectRatio:!1,animation:{duration:500},plugins:{legend:{display:!1},tooltip:{callbacks:{label(Re){return new Intl.NumberFormat().format(Re.parsed.y)},title(Re){return Re[0].label}},backgroundColor:"rgba(0, 0, 0, 0.7)",titleFont:{size:14,weight:"bold"},bodyFont:{size:13},padding:10,displayColors:!1}},scales:{x:{ticks:{callback(Re,He){return Ee[He].split("-")[1]||""},maxRotation:0,color(Re){return Ee[Re.index]===I?"#8b5cf6":void 0},font:{size:10,weight(Re){return Ee[Re.index]===I?"bold":"normal"}}},grid:{display:!1}},y:{beginAtZero:!0,ticks:{callback(Re){return new Intl.NumberFormat().format(Re)},font:{size:10}},grid:{color:"rgba(0, 0, 0, 0.05)"}}},onClick(Re,He){if(He.length===0){console.log("Chart background clicked, clearing selected month"),t(1,I=null),setTimeout(()=>ae(),50);return}const at=He[0].index,Xe=Ee[at];console.log("Chart point clicked:",{month:Xe,index:at,chartDataCompany:R==null?void 0:R.company,chartDataAccount:R==null?void 0:R.account}),t(1,I=Xe),setTimeout(()=>ae(),50);const Ze=document.getElementById("trendChart"),Ve=Ze?Ze.getAttribute("data-company"):null,Ke=Ze?Ze.getAttribute("data-account"):null,gt=H+` - ${Xe}`,ht=`${Ve}-${Ke}-${Xe}`,Nt=`${Ve}-${Ke}`;if(Z[ht]||Z[Nt]){const Ir=zr(Z[ht]||Z[Nt]),Rr=Z[ht]||Z[Nt]||"";m.update(on=>({...on,isOpen:!0,title:gt,content:Ir,isLoading:!1,company:Ve||"",account:Ke||"",isEditing:!1,editText:Rr}))}else Ve&&Ke&&D(Ve,Ke);const Mt=new CustomEvent("select-month",{detail:{month:Xe,company:Ve,account:Ke}});console.log("Dispatching select-month event with:",{month:Xe,company:Ve,account:Ke}),document.dispatchEvent(Mt)}}}),console.log("Chart initialized successfully")}catch(be){console.error("Error initializing chart:",be)}}function xe(){if(!R||!R.months||R.months.length===0)return console.log("No chart data available"),"";const W=l;console.log("Rendering timeline with data:",{company:R.company,account:R.account,months:R.months.length,refreshTimestamp:W,selectedMonth:I,isGeneratingAnalysis:oe});const re=R.company||"",fe=R.account||"";console.log("Setting chart data attributes:",{company:re,account:fe});let be='<div class="chart-visualization relative bg-gradient-to-b from-blue-100/50 to-purple-100/30 dark:from-blue-900/20 dark:to-purple-900/10 p-6 pt-8 pb-12 rounded-xl shadow-sm border border-blue-100 dark:border-blue-900/30 mb-6">';if(be+=`<h3 class="text-lg font-medium mb-4 text-gray-700 dark:text-gray-300">${i.t("Monthly Trend")}</h3>`,be+='<div class="chart-container h-64 relative">',be+=`<canvas id="trendChart" width="800" height="250" data-company="${re}" data-account="${fe}" data-ready="true"></canvas>`,be+="</div>",I){const Te=R.months.findIndex(Xe=>Xe===I),Ee=Te!==-1?R.values[Te]:null;let Ce=null,Ie=null,Ue=null;const je=[...R.months].map((Xe,Ze)=>({month:Xe,value:R.values[Ze],date:new Date(Xe.split("-")[0],parseInt(Xe.split("-")[1])-1)})).sort((Xe,Ze)=>Xe.date.getTime()-Ze.date.getTime()),$e=je.findIndex(Xe=>Xe.month===I);$e>0&&(Ce=je[$e-1].month,Ie=je[$e-1].value,Ie&&Ie!==0&&(Ue=(Ee-Ie)/Math.abs(Ie)*100));const[Re,He]=I.split("-"),at=`${He}/${Re}`;if(be+='<div class="selected-month-indicator flex flex-col md:flex-row justify-between items-start md:items-center mt-4 p-4 bg-white dark:bg-gray-800 rounded-lg border border-blue-100 dark:border-blue-900/30 shadow-sm animate-fade-in">',be+='<div class="flex items-center mb-3 md:mb-0">',be+='<div class="w-3 h-3 rounded-full bg-purple-500 mr-2"></div>',be+=`<span class="font-medium text-gray-700 dark:text-gray-300">${at}</span>`,be+="</div>",be+='<div class="flex flex-col items-end">',be+=`<div class="text-xl font-bold">${lt(Ee)}</div>`,Ue!==null){const Xe=Ue>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400";be+=`<div class="text-sm ${Xe}">`,be+=`${Ue>=0?"+":""}${Ue.toFixed(1)}% vs ${Ce.split("-")[1]}/${Ce.split("-")[0]}`,be+="</div>"}be+="</div>",be+="</div>"}return be+="</div>",be}async function ke(){try{console.log("[DEBUG] Starting Word document download");let W="",re="";if(c.isOpen?(console.log("[DEBUG] Getting content from modal"),W=c.editText||"",re=c.title||"Analysis Report",!W&&c.content&&(W=c.content.replace(/<br>/g,`
`).replace(/<[^>]*>/g,""))):j&&(console.log("[DEBUG] Using input text"),W=j,re=A||"Analysis Report"),!W){console.error("[DEBUG] No analysis content available"),Je.error(i.t("No analysis content to download"));return}console.log("[DEBUG] Creating document with Docxtemplater"),console.log("[DEBUG] Content length:",W.length),console.log("[DEBUG] Title:",re);const Te=`${(re||"analysis").replace(/[^a-z0-9]/gi,"_").toLowerCase()}_${new Date().toISOString().replace(/[-:.]/g,"").substring(0,14)}.docx`;try{const Ee=await Ea(W,re);xa(Ee,Te)}catch(Ee){console.error("[DEBUG] Docxtemplater failed, falling back to simple document:",Ee);const Ce=await ah(W,re);lh(Ce,Te)}console.log("[DEBUG] Download complete"),Je.success(i.t("Report downloaded successfully"))}catch(W){console.error("[DEBUG] Error downloading Word report:",W),Je.error(i.t("Failed to download report: ")+(W.message||"Unknown error"))}}function Ne(){c.editText=this.value,m.set(c)}const ot=async()=>{try{const W=event.currentTarget;W.classList.add("opacity-50","pointer-events-none"),W.innerHTML=`<svg class="animate-spin -ml-1 mr-2 h-4 w-4 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"></path></svg> ${i.t("Downloading...")}`,await ke(),setTimeout(()=>{W.classList.remove("opacity-50","pointer-events-none"),W.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l2.414 2.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg> ${i.t("Download Report")}`},1e3)}catch(W){console.error("Error in download button click handler:",W),Je.error(i.t("Download failed: ")+(W.message||""));const re=event.currentTarget;re.classList.remove("opacity-50","pointer-events-none"),re.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l2.414 2.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg> ${i.t("Download Report")}`}},mt=W=>{if(W.target.files&&W.target.files.length>0){const re=new FormData;re.append("file",W.target.files[0]),fetch(`${g}/proxy/api/upload_account_tree`,{method:"POST",headers:{Authorization:`Bearer ${yt}`},body:re}).then(fe=>fe.json()).then(fe=>{fe.success?(Je.success(i.t("Account tree uploaded successfully")),ee()):Je.error(fe.error||i.t("Upload failed"))}).catch(fe=>{console.error("Error uploading account tree:",fe),Je.error(i.t("Upload failed"))})}};function ft(){G=ss(this.value),t(8,G)}function Et(){I=da(this),t(1,I),t(7,X)}function Ge(){j=this.value,t(11,j)}const xt=async()=>{try{const W=event.currentTarget;W.classList.add("opacity-50","pointer-events-none"),W.innerHTML=`<svg class="animate-spin -ml-1 mr-2 h-4 w-4 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"></path></svg> ${i.t("Downloading...")}`,await ke(),setTimeout(()=>{W.classList.remove("opacity-50","pointer-events-none"),W.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l2.414 2.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg> ${i.t("Download Report")}`},1e3)}catch(W){console.error("Error in download button click handler:",W),Je.error(i.t("Download failed: ")+(W.message||""));const re=event.currentTarget;re.classList.remove("opacity-50","pointer-events-none"),re.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l2.414 2.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg> ${i.t("Download Report")}`}};return r.$$.update=()=>{if(r.$$.dirty[0]&1|r.$$.dirty[1]&36&&f&&f.companies&&!V){console.log("Initializing expanded states (one-time)"),t(36,V=!0);const W=Object.keys(f.companies)[0];if(W){console.log("Automatically expanding first company:",W);const re={...k};re[W]=!0,t(33,k=re)}}if(r.$$.dirty[1]&4&&console.log("expandedCompanies changed:",k),r.$$.dirty[1]&8&&console.log("expandedCategories changed:",Object.keys(N).length,"categories"),r.$$.dirty[0]&28&&R&&C==="chart"){if(console.log("chartData changed, scheduling chart initialization"),(!R.company||!R.account)&&(console.warn("chartData missing company or account:",R),H)){const W=H.split(" - ");W.length>=2&&(t(3,R={...R,company:W[0],account:W[1]}),console.log("Fixed chartData by extracting from title:",R))}setTimeout(()=>{ae()},200)}r.$$.dirty[0]&14&&I&&R&&(console.log("Reactive update triggered for analysis UI with selected month:",I),l=Date.now(),C==="chart"&&(console.log("Updating chart for new selected month:",I),setTimeout(()=>ae(),50))),r.$$.dirty[1]&16&&Object.keys(Z).length>0&&(console.log("Analysis data updated, refreshing UI"),l=Date.now()),r.$$.dirty[0]&6&&I&&C==="chart"&&(console.log("Selected month changed to:",I),setTimeout(()=>{document.getElementById("trendChart")&&(console.log("Re-initializing chart with new month:",I),ae())},50))},t(13,s=Date.now().toString()),l=Date.now(),[f,I,C,R,H,x,_,X,G,ce,ge,j,oe,s,i,c,u,m,b,T,p,g,ee,v,w,se,Q,o,P,ue,ve,xe,ke,k,N,Z,V,Ne,ot,mt,ft,Et,Ge,xt]}class Wh extends ma{constructor(e){super(),ga(this,e,Th,Eh,la,{},null,[-1,-1,-1])}}export{Wh as component};
//# sourceMappingURL=15.DBFg01jD.js.map
