import{s as ct,e as _,k as P,t as F,D as ee,l as Oe,c as g,a as h,M as me,o as N,b as O,d as c,E as te,f as a,i as Y,g as r,u as de,h as z,p as ut,j as dt,q as ft,H as Be,G as st,B as Ue,n as ve,P as Se,U as ht}from"../chunks/Dc4_ziGv.js";import{S as vt,i as _t,a as ge,c as Le,t as pe,g as Ce,b as at,d as rt,m as ot,e as nt}from"../chunks/CAZSMy3J.js";import{e as _e,u as gt,d as pt}from"../chunks/C6kX8Nm-.js";import{t as ie}from"../chunks/gLvYLTeg.js";import"../chunks/DhUbH0v9.js";import{S as it}from"../chunks/7Z-YgjJE.js";import{g as bt}from"../chunks/zeQX5z4A.js";import{b as mt}from"../chunks/CisIfe-u.js";function Re(o,e,t){const l=o.slice();return l[46]=e[t],l[48]=t,l}function qe(o,e,t){const l=o.slice();return l[49]=e[t],l}function ze(o,e,t){const l=o.slice();return l[49]=e[t],l}function Je(o,e,t){const l=o.slice();return l[43]=e[t],l}function We(o,e,t){const l=o.slice();return l[40]=e[t],l}function kt(o){let e,t,l,s,i,d,n=o[6]?"Back to Tables":"Back to Files",u,v,w,T=o[3].name+"",b,m,S,k,E,Q,B;const I=[yt,wt],C=[];function D(L,p){return L[6]?1:0}return S=D(o),k=C[S]=I[S](o),{c(){e=_("div"),t=_("div"),l=_("button"),s=ee("svg"),i=ee("path"),d=P(),u=F(n),v=P(),w=_("h3"),b=F(T),m=P(),k.c(),this.h()},l(L){e=g(L,"DIV",{class:!0});var p=h(e);t=g(p,"DIV",{class:!0});var f=h(t);l=g(f,"BUTTON",{class:!0});var A=h(l);s=te(A,"svg",{xmlns:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0,class:!0});var x=h(s);i=te(x,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),h(i).forEach(c),x.forEach(c),d=N(A),u=O(A,n),A.forEach(c),v=N(f),w=g(f,"H3",{class:!0});var R=h(w);b=O(R,T),R.forEach(c),f.forEach(c),m=N(p),k.l(p),p.forEach(c),this.h()},h(){a(i,"stroke-linecap","round"),a(i,"stroke-linejoin","round"),a(i,"d","M15.75 19.5L8.25 12l7.5-7.5"),a(s,"xmlns","http://www.w3.org/2000/svg"),a(s,"viewBox","0 0 24 24"),a(s,"fill","none"),a(s,"stroke","currentColor"),a(s,"stroke-width","2"),a(s,"class","w-5 h-5"),a(l,"class","back-to-files-button svelte-1310t73"),a(w,"class","text-lg font-semibold text-gray-800 dark:text-gray-200"),a(t,"class","file-detail-header dark:border-gray-700 svelte-1310t73"),a(e,"class","file-detail-container svelte-1310t73")},m(L,p){Y(L,e,p),r(e,t),r(t,l),r(l,s),r(s,i),r(l,d),r(l,u),r(t,v),r(t,w),r(w,b),r(e,m),C[S].m(e,null),E=!0,Q||(B=de(l,"click",o[26]),Q=!0)},p(L,p){(!E||p[0]&64)&&n!==(n=L[6]?"Back to Tables":"Back to Files")&&z(u,n),(!E||p[0]&8)&&T!==(T=L[3].name+"")&&z(b,T);let f=S;S=D(L),S===f?C[S].p(L,p):(Ce(),ge(C[f],1,1,()=>{C[f]=null}),Le(),k=C[S],k?k.p(L,p):(k=C[S]=I[S](L),k.c()),pe(k,1),k.m(e,null))},i(L){E||(pe(k),E=!0)},o(L){ge(k),E=!1},d(L){L&&c(e),C[S].d(),Q=!1,B()}}}function Et(o){let e,t,l,s,i=o[13].t("Excel Data Sources")+"",d,n,u,v,w,T,b,m,S,k,E,Q,B,I;const C=[At,Vt,Qt,It],D=[];function L(p,f){return p[2]?0:p[0].length===0?1:p[12].length===0?2:3}return k=L(o),E=D[k]=C[k](o),{c(){e=_("div"),t=_("div"),l=_("div"),s=_("h3"),d=F(i),n=P(),u=_("div"),v=_("div"),w=ee("svg"),T=ee("path"),b=P(),m=_("input"),S=P(),E.c(),this.h()},l(p){e=g(p,"DIV",{class:!0});var f=h(e);t=g(f,"DIV",{class:!0});var A=h(t);l=g(A,"DIV",{class:!0});var x=h(l);s=g(x,"H3",{class:!0});var R=h(s);d=O(R,i),R.forEach(c),n=N(x),u=g(x,"DIV",{class:!0});var j=h(u);v=g(j,"DIV",{class:!0});var M=h(v);w=te(M,"svg",{xmlns:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0,class:!0});var G=h(w);T=te(G,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),h(T).forEach(c),G.forEach(c),b=N(M),m=g(M,"INPUT",{type:!0,placeholder:!0,class:!0}),M.forEach(c),j.forEach(c),x.forEach(c),A.forEach(c),S=N(f),E.l(f),f.forEach(c),this.h()},h(){a(s,"class","text-lg font-semibold text-gray-800 dark:text-gray-200"),a(T,"stroke-linecap","round"),a(T,"stroke-linejoin","round"),a(T,"d","M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"),a(w,"xmlns","http://www.w3.org/2000/svg"),a(w,"viewBox","0 0 24 24"),a(w,"fill","none"),a(w,"stroke","currentColor"),a(w,"stroke-width","2"),a(w,"class","w-5 h-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"),a(m,"type","text"),a(m,"placeholder","Search files..."),a(m,"class","pl-10 pr-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 w-full"),a(v,"class","relative"),a(u,"class","search-box"),a(l,"class","flex justify-between items-center"),a(t,"class","file-list-header dark:border-gray-700 svelte-1310t73"),a(e,"class","file-list-container svelte-1310t73")},m(p,f){Y(p,e,f),r(e,t),r(t,l),r(l,s),r(s,d),r(l,n),r(l,u),r(u,v),r(v,w),r(w,T),r(v,b),r(v,m),Ue(m,o[1]),r(e,S),D[k].m(e,null),Q=!0,B||(I=de(m,"input",o[23]),B=!0)},p(p,f){(!Q||f[0]&8192)&&i!==(i=p[13].t("Excel Data Sources")+"")&&z(d,i),f[0]&2&&m.value!==p[1]&&Ue(m,p[1]);let A=k;k=L(p),k===A?D[k].p(p,f):(Ce(),ge(D[A],1,1,()=>{D[A]=null}),Le(),E=D[k],E?E.p(p,f):(E=D[k]=C[k](p),E.c()),pe(E,1),E.m(e,null))},i(p){Q||(pe(E),Q=!0)},o(p){ge(E),Q=!1},d(p){p&&c(e),D[k].d(),B=!1,I()}}}function wt(o){let e,t,l,s,i=o[13].t("Table")+"",d,n,u=o[6].table_name+"",v,w,T,b,m='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"></path></svg> <span>Delete Table</span>',S,k,E,Q,B,I;const C=[Dt,Tt],D=[];function L(p,f){return p[5][p[6].table_name]?0:p[4][p[6].table_name]?1:-1}return~(k=L(o))&&(E=D[k]=C[k](o)),{c(){e=_("div"),t=_("div"),l=_("div"),s=_("h4"),d=F(i),n=F(": "),v=F(u),w=P(),T=_("div"),b=_("button"),b.innerHTML=m,S=P(),E&&E.c(),this.h()},l(p){e=g(p,"DIV",{class:!0});var f=h(e);t=g(f,"DIV",{class:!0});var A=h(t);l=g(A,"DIV",{class:!0});var x=h(l);s=g(x,"H4",{class:!0});var R=h(s);d=O(R,i),n=O(R,": "),v=O(R,u),R.forEach(c),w=N(x),T=g(x,"DIV",{class:!0});var j=h(T);b=g(j,"BUTTON",{class:!0,"data-svelte-h":!0}),me(b)!=="svelte-1yetmxg"&&(b.innerHTML=m),j.forEach(c),x.forEach(c),A.forEach(c),S=N(f),E&&E.l(f),f.forEach(c),this.h()},h(){a(s,"class","text-lg font-semibold text-gray-800 dark:text-gray-200"),a(b,"class","px-3 py-2 rounded-lg bg-red-600 hover:bg-red-700 text-white transition flex items-center space-x-2"),a(T,"class","flex space-x-2"),a(l,"class","flex justify-between items-center"),a(t,"class","mb-4"),a(e,"class","table-view-section svelte-1310t73")},m(p,f){Y(p,e,f),r(e,t),r(t,l),r(l,s),r(s,d),r(s,n),r(s,v),r(l,w),r(l,T),r(T,b),r(e,S),~k&&D[k].m(e,null),Q=!0,B||(I=de(b,"click",o[28]),B=!0)},p(p,f){(!Q||f[0]&8192)&&i!==(i=p[13].t("Table")+"")&&z(d,i),(!Q||f[0]&64)&&u!==(u=p[6].table_name+"")&&z(v,u);let A=k;k=L(p),k===A?~k&&D[k].p(p,f):(E&&(Ce(),ge(D[A],1,1,()=>{D[A]=null}),Le()),~k?(E=D[k],E?E.p(p,f):(E=D[k]=C[k](p),E.c()),pe(E,1),E.m(e,null)):E=null)},i(p){Q||(pe(E),Q=!0)},o(p){ge(E),Q=!1},d(p){p&&c(e),~k&&D[k].d(),B=!1,I()}}}function yt(o){let e,t,l,s=o[13].t("Filename")+"",i,d,n,u,v=o[3].name+"",w,T,b,m,S=o[13].t("Upload Date")+"",k,E,Q,B,I=o[3].dateUploaded+"",C,D,L,p,f=o[13].t("Tables")+"",A,x,R,j,M=o[3].tableCount+"",G,q,H,U,X=o[13].t("Path")+"",J,ae,re,$,ne=o[3].savedPath+"",ce,oe,y,V,W,se=o[13].t("Excel Sheets")+"",be,ue,fe,le=o[3].tables&&o[3].tables.length>0&&Ze(o);function Pe(K,Z){return!K[3].tables||K[3].tables.length===0?Ct:Lt}let ke=Pe(o),he=ke(o);return{c(){e=_("div"),t=_("div"),l=_("span"),i=F(s),d=F(":"),n=P(),u=_("span"),w=F(v),T=P(),b=_("div"),m=_("span"),k=F(S),E=F(":"),Q=P(),B=_("span"),C=F(I),D=P(),L=_("div"),p=_("span"),A=F(f),x=F(":"),R=P(),j=_("span"),G=F(M),q=P(),H=_("div"),U=_("span"),J=F(X),ae=F(":"),re=P(),$=_("span"),ce=F(ne),oe=P(),y=_("div"),V=_("div"),W=_("h4"),be=F(se),ue=P(),le&&le.c(),fe=P(),he.c(),this.h()},l(K){e=g(K,"DIV",{class:!0});var Z=h(e);t=g(Z,"DIV",{class:!0});var Ee=h(t);l=g(Ee,"SPAN",{class:!0});var Ie=h(l);i=O(Ie,s),d=O(Ie,":"),Ie.forEach(c),n=N(Ee),u=g(Ee,"SPAN",{class:!0});var Ne=h(u);w=O(Ne,v),Ne.forEach(c),Ee.forEach(c),T=N(Z),b=g(Z,"DIV",{class:!0});var we=h(b);m=g(we,"SPAN",{class:!0});var Qe=h(m);k=O(Qe,S),E=O(Qe,":"),Qe.forEach(c),Q=N(we),B=g(we,"SPAN",{class:!0});var He=h(B);C=O(He,I),He.forEach(c),we.forEach(c),D=N(Z),L=g(Z,"DIV",{class:!0});var ye=h(L);p=g(ye,"SPAN",{class:!0});var Ve=h(p);A=O(Ve,f),x=O(Ve,":"),Ve.forEach(c),R=N(ye),j=g(ye,"SPAN",{class:!0});var je=h(j);G=O(je,M),je.forEach(c),ye.forEach(c),q=N(Z),H=g(Z,"DIV",{class:!0});var Te=h(H);U=g(Te,"SPAN",{class:!0});var Ae=h(U);J=O(Ae,X),ae=O(Ae,":"),Ae.forEach(c),re=N(Te),$=g(Te,"SPAN",{class:!0});var Me=h($);ce=O(Me,ne),Me.forEach(c),Te.forEach(c),Z.forEach(c),oe=N(K),y=g(K,"DIV",{class:!0});var De=h(y);V=g(De,"DIV",{class:!0});var xe=h(V);W=g(xe,"H4",{class:!0});var Fe=h(W);be=O(Fe,se),Fe.forEach(c),ue=N(xe),le&&le.l(xe),xe.forEach(c),fe=N(De),he.l(De),De.forEach(c),this.h()},h(){a(l,"class","info-label svelte-1310t73"),a(u,"class","info-value svelte-1310t73"),a(t,"class","file-info-item svelte-1310t73"),a(m,"class","info-label svelte-1310t73"),a(B,"class","info-value svelte-1310t73"),a(b,"class","file-info-item svelte-1310t73"),a(p,"class","info-label svelte-1310t73"),a(j,"class","info-value svelte-1310t73"),a(L,"class","file-info-item svelte-1310t73"),a(U,"class","info-label svelte-1310t73"),a($,"class","info-value text-xs opacity-80 svelte-1310t73"),a(H,"class","file-info-item svelte-1310t73"),a(e,"class","file-info-section dark:border-gray-700 svelte-1310t73"),a(W,"class","section-title svelte-1310t73"),a(V,"class","flex justify-between items-center mb-4"),a(y,"class","tables-section svelte-1310t73")},m(K,Z){Y(K,e,Z),r(e,t),r(t,l),r(l,i),r(l,d),r(t,n),r(t,u),r(u,w),r(e,T),r(e,b),r(b,m),r(m,k),r(m,E),r(b,Q),r(b,B),r(B,C),r(e,D),r(e,L),r(L,p),r(p,A),r(p,x),r(L,R),r(L,j),r(j,G),r(e,q),r(e,H),r(H,U),r(U,J),r(U,ae),r(H,re),r(H,$),r($,ce),Y(K,oe,Z),Y(K,y,Z),r(y,V),r(V,W),r(W,be),r(V,ue),le&&le.m(V,null),r(y,fe),he.m(y,null)},p(K,Z){Z[0]&8192&&s!==(s=K[13].t("Filename")+"")&&z(i,s),Z[0]&8&&v!==(v=K[3].name+"")&&z(w,v),Z[0]&8192&&S!==(S=K[13].t("Upload Date")+"")&&z(k,S),Z[0]&8&&I!==(I=K[3].dateUploaded+"")&&z(C,I),Z[0]&8192&&f!==(f=K[13].t("Tables")+"")&&z(A,f),Z[0]&8&&M!==(M=K[3].tableCount+"")&&z(G,M),Z[0]&8192&&X!==(X=K[13].t("Path")+"")&&z(J,X),Z[0]&8&&ne!==(ne=K[3].savedPath+"")&&z(ce,ne),Z[0]&8192&&se!==(se=K[13].t("Excel Sheets")+"")&&z(be,se),K[3].tables&&K[3].tables.length>0?le?le.p(K,Z):(le=Ze(K),le.c(),le.m(V,null)):le&&(le.d(1),le=null),ke===(ke=Pe(K))&&he?he.p(K,Z):(he.d(1),he=ke(K),he&&(he.c(),he.m(y,null)))},i:ve,o:ve,d(K){K&&(c(e),c(oe),c(y)),le&&le.d(),he.d()}}}function Tt(o){let e,t,l,s,i,d,n,u,v,w,T,b,m,S,k;function E(f,A){return f[9]?St:xt}let Q=E(o),B=Q(o),I=o[9]&&Ye(o),C=_e(o[4][o[6].table_name].columns.filter(o[31])),D=[];for(let f=0;f<C.length;f+=1)D[f]=Ge(ze(o,C,f));let L=_e(o[4][o[6].table_name].rows),p=[];for(let f=0;f<L.length;f+=1)p[f]=Xe(Re(o,L,f));return{c(){e=_("div"),t=_("div"),l=_("button"),B.c(),d=P(),I&&I.c(),n=P(),u=_("div"),v=_("table"),w=_("thead"),T=_("tr");for(let f=0;f<D.length;f+=1)D[f].c();b=P(),m=_("tbody");for(let f=0;f<p.length;f+=1)p[f].c();this.h()},l(f){e=g(f,"DIV",{class:!0});var A=h(e);t=g(A,"DIV",{class:!0});var x=h(t);l=g(x,"BUTTON",{class:!0});var R=h(l);B.l(R),R.forEach(c),d=N(x),I&&I.l(x),x.forEach(c),A.forEach(c),n=N(f),u=g(f,"DIV",{class:!0});var j=h(u);v=g(j,"TABLE",{class:!0});var M=h(v);w=g(M,"THEAD",{});var G=h(w);T=g(G,"TR",{class:!0});var q=h(T);for(let U=0;U<D.length;U+=1)D[U].l(q);q.forEach(c),G.forEach(c),b=N(M),m=g(M,"TBODY",{});var H=h(m);for(let U=0;U<p.length;U+=1)p[U].l(H);H.forEach(c),M.forEach(c),j.forEach(c),this.h()},h(){a(l,"class",s="px-3 py-2 rounded-lg "+(o[9]?"bg-green-600 hover:bg-green-700":"bg-blue-600 hover:bg-blue-700")+" text-white transition flex items-center space-x-2"),l.disabled=i=o[9]&&!o[8],a(t,"class","flex space-x-4"),a(e,"class","table-controls mb-4"),a(T,"class","svelte-1310t73"),a(v,"class","excel-table w-full svelte-1310t73"),a(u,"class","excel-table-wrapper svelte-1310t73")},m(f,A){Y(f,e,A),r(e,t),r(t,l),B.m(l,null),r(t,d),I&&I.m(t,null),Y(f,n,A),Y(f,u,A),r(u,v),r(v,w),r(w,T);for(let x=0;x<D.length;x+=1)D[x]&&D[x].m(T,null);r(v,b),r(v,m);for(let x=0;x<p.length;x+=1)p[x]&&p[x].m(m,null);S||(k=de(l,"click",function(){Be(o[9]?o[21]:o[29])&&(o[9]?o[21]:o[29]).apply(this,arguments)}),S=!0)},p(f,A){if(o=f,Q!==(Q=E(o))&&(B.d(1),B=Q(o),B&&(B.c(),B.m(l,null))),A[0]&512&&s!==(s="px-3 py-2 rounded-lg "+(o[9]?"bg-green-600 hover:bg-green-700":"bg-blue-600 hover:bg-blue-700")+" text-white transition flex items-center space-x-2")&&a(l,"class",s),A[0]&768&&i!==(i=o[9]&&!o[8])&&(l.disabled=i),o[9]?I?I.p(o,A):(I=Ye(o),I.c(),I.m(t,null)):I&&(I.d(1),I=null),A[0]&208){C=_e(o[4][o[6].table_name].columns.filter(o[31]));let x;for(x=0;x<C.length;x+=1){const R=ze(o,C,x);D[x]?D[x].p(R,A):(D[x]=Ge(R),D[x].c(),D[x].m(T,null))}for(;x<D.length;x+=1)D[x].d(1);D.length=C.length}if(A[0]&1049296){L=_e(o[4][o[6].table_name].rows);let x;for(x=0;x<L.length;x+=1){const R=Re(o,L,x);p[x]?p[x].p(R,A):(p[x]=Xe(R),p[x].c(),p[x].m(m,null))}for(;x<p.length;x+=1)p[x].d(1);p.length=L.length}},i:ve,o:ve,d(f){f&&(c(e),c(n),c(u)),B.d(),I&&I.d(),Se(D,f),Se(p,f),S=!1,k()}}}function Dt(o){let e,t,l,s,i=o[13].t("Loading table data...")+"",d,n;return t=new it({props:{className:"w-10 h-10"}}),{c(){e=_("div"),at(t.$$.fragment),l=P(),s=_("span"),d=F(i),this.h()},l(u){e=g(u,"DIV",{class:!0});var v=h(e);rt(t.$$.fragment,v),l=N(v),s=g(v,"SPAN",{class:!0});var w=h(s);d=O(w,i),w.forEach(c),v.forEach(c),this.h()},h(){a(s,"class","ml-4 text-gray-600 dark:text-gray-400"),a(e,"class","flex justify-center items-center h-64")},m(u,v){Y(u,e,v),ot(t,e,null),r(e,l),r(e,s),r(s,d),n=!0},p(u,v){(!n||v[0]&8192)&&i!==(i=u[13].t("Loading table data...")+"")&&z(d,i)},i(u){n||(pe(t.$$.fragment,u),n=!0)},o(u){ge(t.$$.fragment,u),n=!1},d(u){u&&c(e),nt(t)}}}function xt(o){let e,t,l,s,i="Edit Data";return{c(){e=ee("svg"),t=ee("path"),l=P(),s=_("span"),s.textContent=i,this.h()},l(d){e=te(d,"svg",{xmlns:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0,class:!0});var n=h(e);t=te(n,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),h(t).forEach(c),n.forEach(c),l=N(d),s=g(d,"SPAN",{"data-svelte-h":!0}),me(s)!=="svelte-19wbzee"&&(s.textContent=i),this.h()},h(){a(t,"stroke-linecap","round"),a(t,"stroke-linejoin","round"),a(t,"d","M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"),a(e,"xmlns","http://www.w3.org/2000/svg"),a(e,"viewBox","0 0 24 24"),a(e,"fill","none"),a(e,"stroke","currentColor"),a(e,"stroke-width","2"),a(e,"class","w-5 h-5")},m(d,n){Y(d,e,n),r(e,t),Y(d,l,n),Y(d,s,n)},d(d){d&&(c(e),c(l),c(s))}}}function St(o){let e,t,l,s,i="Save Changes";return{c(){e=ee("svg"),t=ee("path"),l=P(),s=_("span"),s.textContent=i,this.h()},l(d){e=te(d,"svg",{xmlns:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0,class:!0});var n=h(e);t=te(n,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),h(t).forEach(c),n.forEach(c),l=N(d),s=g(d,"SPAN",{"data-svelte-h":!0}),me(s)!=="svelte-1mlnvx6"&&(s.textContent=i),this.h()},h(){a(t,"stroke-linecap","round"),a(t,"stroke-linejoin","round"),a(t,"d","M17.593 3.322c1.1.128 1.907 1.077 1.907 2.185V21L12 17.25 4.5 21V5.507c0-1.108.806-2.057 1.907-2.185a48.507 48.507 0 0111.186 0z"),a(e,"xmlns","http://www.w3.org/2000/svg"),a(e,"viewBox","0 0 24 24"),a(e,"fill","none"),a(e,"stroke","currentColor"),a(e,"stroke-width","2"),a(e,"class","w-5 h-5")},m(d,n){Y(d,e,n),r(e,t),Y(d,l,n),Y(d,s,n)},d(d){d&&(c(e),c(l),c(s))}}}function Ye(o){let e,t='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path></svg> <span>Cancel</span>',l,s;return{c(){e=_("button"),e.innerHTML=t,this.h()},l(i){e=g(i,"BUTTON",{class:!0,"data-svelte-h":!0}),me(e)!=="svelte-mt124r"&&(e.innerHTML=t),this.h()},h(){a(e,"class","px-3 py-2 rounded-lg bg-gray-600 hover:bg-gray-700 text-white transition flex items-center space-x-2")},m(i,d){Y(i,e,d),l||(s=de(e,"click",o[30]),l=!0)},p:ve,d(i){i&&c(e),l=!1,s()}}}function Ge(o){let e,t,l,s=o[49].name+"",i,d;return{c(){e=_("th"),t=_("div"),l=_("span"),i=F(s),d=P(),this.h()},l(n){e=g(n,"TH",{class:!0});var u=h(e);t=g(u,"DIV",{class:!0});var v=h(t);l=g(v,"SPAN",{});var w=h(l);i=O(w,s),w.forEach(c),v.forEach(c),d=N(u),u.forEach(c),this.h()},h(){a(t,"class","flex justify-between items-center"),a(e,"class","svelte-1310t73")},m(n,u){Y(n,e,u),r(e,t),r(t,l),r(l,i),r(e,d)},p(n,u){u[0]&208&&s!==(s=n[49].name+"")&&z(i,s)},d(n){n&&c(e)}}}function Ke(o){let e,t=(o[46][o[49].name]!==void 0?o[46][o[49].name]:"")+"",l,s,i;function d(...n){return o[33](o[48],o[49],...n)}return{c(){e=_("td"),l=F(t),this.h()},l(n){e=g(n,"TD",{contenteditable:!0,class:!0});var u=h(e);l=O(u,t),u.forEach(c),this.h()},h(){a(e,"contenteditable",o[9]),a(e,"class","svelte-1310t73")},m(n,u){Y(n,e,u),r(e,l),s||(i=de(e,"blur",d),s=!0)},p(n,u){o=n,u[0]&208&&t!==(t=(o[46][o[49].name]!==void 0?o[46][o[49].name]:"")+"")&&ht(l,t,o[9]),u[0]&512&&a(e,"contenteditable",o[9])},d(n){n&&c(e),s=!1,i()}}}function Xe(o){let e,t,l=_e(o[4][o[6].table_name].columns.filter(o[32])),s=[];for(let i=0;i<l.length;i+=1)s[i]=Ke(qe(o,l,i));return{c(){e=_("tr");for(let i=0;i<s.length;i+=1)s[i].c();t=P(),this.h()},l(i){e=g(i,"TR",{class:!0});var d=h(e);for(let n=0;n<s.length;n+=1)s[n].l(d);t=N(d),d.forEach(c),this.h()},h(){a(e,"class","svelte-1310t73")},m(i,d){Y(i,e,d);for(let n=0;n<s.length;n+=1)s[n]&&s[n].m(e,null);r(e,t)},p(i,d){if(d[0]&1049296){l=_e(i[4][i[6].table_name].columns.filter(i[32]));let n;for(n=0;n<l.length;n+=1){const u=qe(i,l,n);s[n]?s[n].p(u,d):(s[n]=Ke(u),s[n].c(),s[n].m(e,t))}for(;n<s.length;n+=1)s[n].d(1);s.length=l.length}},d(i){i&&c(e),Se(s,i)}}}function Ze(o){let e,t=o[3].tables.length+"",l,s,i=o[3].tables.length===1?"sheet":"sheets",d,n;return{c(){e=_("span"),l=F(t),s=P(),d=F(i),n=F(" available"),this.h()},l(u){e=g(u,"SPAN",{class:!0});var v=h(e);l=O(v,t),s=N(v),d=O(v,i),n=O(v," available"),v.forEach(c),this.h()},h(){a(e,"class","text-gray-500 dark:text-gray-400 text-sm")},m(u,v){Y(u,e,v),r(e,l),r(e,s),r(e,d),r(e,n)},p(u,v){v[0]&8&&t!==(t=u[3].tables.length+"")&&z(l,t),v[0]&8&&i!==(i=u[3].tables.length===1?"sheet":"sheets")&&z(d,i)},d(u){u&&c(e)}}}function Lt(o){let e,t,l=_e(o[3].tables),s=[];for(let i=0;i<l.length;i+=1)s[i]=$e(Je(o,l,i));return{c(){e=_("div"),t=_("div");for(let i=0;i<s.length;i+=1)s[i].c();this.h()},l(i){e=g(i,"DIV",{class:!0});var d=h(e);t=g(d,"DIV",{class:!0});var n=h(t);for(let u=0;u<s.length;u+=1)s[u].l(n);n.forEach(c),d.forEach(c),this.h()},h(){a(t,"class","space-y-2"),a(e,"class","tables-list")},m(i,d){Y(i,e,d),r(e,t);for(let n=0;n<s.length;n+=1)s[n]&&s[n].m(t,null)},p(i,d){if(d[0]&524360){l=_e(i[3].tables);let n;for(n=0;n<l.length;n+=1){const u=Je(i,l,n);s[n]?s[n].p(u,d):(s[n]=$e(u),s[n].c(),s[n].m(t,null))}for(;n<s.length;n+=1)s[n].d(1);s.length=l.length}},d(i){i&&c(e),Se(s,i)}}}function Ct(o){let e,t,l=o[13].t("No tables found in this file")+"",s;return{c(){e=_("div"),t=_("p"),s=F(l),this.h()},l(i){e=g(i,"DIV",{class:!0});var d=h(e);t=g(d,"P",{class:!0});var n=h(t);s=O(n,l),n.forEach(c),d.forEach(c),this.h()},h(){a(t,"class","text-gray-500 dark:text-gray-400"),a(e,"class","no-content-message")},m(i,d){Y(i,e,d),r(e,t),r(t,s)},p(i,d){d[0]&8192&&l!==(l=i[13].t("No tables found in this file")+"")&&z(s,l)},d(i){i&&c(e)}}}function $e(o){let e,t,l,s=o[43].table_name+"",i,d,n,u=o[43].row_count+"",v,w,T,b,m,S;function k(){return o[27](o[43])}return{c(){e=_("div"),t=_("div"),l=_("span"),i=F(s),d=P(),n=_("span"),v=F(u),w=F(" rows"),T=P(),this.h()},l(E){e=g(E,"DIV",{class:!0});var Q=h(e);t=g(Q,"DIV",{class:!0});var B=h(t);l=g(B,"SPAN",{class:!0});var I=h(l);i=O(I,s),I.forEach(c),d=N(B),n=g(B,"SPAN",{class:!0});var C=h(n);v=O(C,u),w=O(C," rows"),C.forEach(c),B.forEach(c),T=N(Q),Q.forEach(c),this.h()},h(){a(l,"class","text-md text-gray-800 dark:text-gray-200"),a(n,"class","text-sm text-gray-500 dark:text-gray-400"),a(t,"class","flex justify-between items-center w-full"),a(e,"class",b="table-item "+(o[6]&&o[6].table_name===o[43].table_name?"selected":"")+" svelte-1310t73")},m(E,Q){Y(E,e,Q),r(e,t),r(t,l),r(l,i),r(t,d),r(t,n),r(n,v),r(n,w),r(e,T),m||(S=de(e,"click",k),m=!0)},p(E,Q){o=E,Q[0]&8&&s!==(s=o[43].table_name+"")&&z(i,s),Q[0]&8&&u!==(u=o[43].row_count+"")&&z(v,u),Q[0]&72&&b!==(b="table-item "+(o[6]&&o[6].table_name===o[43].table_name?"selected":"")+" svelte-1310t73")&&a(e,"class",b)},d(E){E&&c(e),m=!1,S()}}}function It(o){let e,t,l,s,i,d,n,u=o[13].t("Filename")+"",v,w,T,b=o[13].t("Upload Date")+"",m,S,k,E=o[13].t("Tables")+"",Q,B,I,C=o[13].t("Actions")+"",D,L,p,f=[],A=new Map,x=_e(o[12]);const R=j=>j[40].id;for(let j=0;j<x.length;j+=1){let M=We(o,x,j),G=R(M);A.set(G,f[j]=et(G,M))}return{c(){e=_("div"),t=_("table"),l=_("thead"),s=_("tr"),i=_("th"),d=P(),n=_("th"),v=F(u),w=P(),T=_("th"),m=F(b),S=P(),k=_("th"),Q=F(E),B=P(),I=_("th"),D=F(C),L=P(),p=_("tbody");for(let j=0;j<f.length;j+=1)f[j].c();this.h()},l(j){e=g(j,"DIV",{class:!0});var M=h(e);t=g(M,"TABLE",{class:!0});var G=h(t);l=g(G,"THEAD",{});var q=h(l);s=g(q,"TR",{class:!0});var H=h(s);i=g(H,"TH",{class:!0}),h(i).forEach(c),d=N(H),n=g(H,"TH",{class:!0});var U=h(n);v=O(U,u),U.forEach(c),w=N(H),T=g(H,"TH",{class:!0});var X=h(T);m=O(X,b),X.forEach(c),S=N(H),k=g(H,"TH",{class:!0});var J=h(k);Q=O(J,E),J.forEach(c),B=N(H),I=g(H,"TH",{class:!0});var ae=h(I);D=O(ae,C),ae.forEach(c),H.forEach(c),q.forEach(c),L=N(G),p=g(G,"TBODY",{class:!0});var re=h(p);for(let $=0;$<f.length;$+=1)f[$].l(re);re.forEach(c),G.forEach(c),M.forEach(c),this.h()},h(){a(i,"class","py-3 px-4 text-left"),a(n,"class","py-3 px-4 text-left"),a(T,"class","py-3 px-4 text-left"),a(k,"class","py-3 px-4 text-left"),a(I,"class","py-3 px-4 text-left"),a(s,"class","border-b border-gray-200 dark:border-gray-700"),a(p,"class","svelte-1310t73"),a(t,"class","w-full"),a(e,"class","file-list")},m(j,M){Y(j,e,M),r(e,t),r(t,l),r(l,s),r(s,i),r(s,d),r(s,n),r(n,v),r(s,w),r(s,T),r(T,m),r(s,S),r(s,k),r(k,Q),r(s,B),r(s,I),r(I,D),r(t,L),r(t,p);for(let G=0;G<f.length;G+=1)f[G]&&f[G].m(p,null)},p(j,M){M[0]&8192&&u!==(u=j[13].t("Filename")+"")&&z(v,u),M[0]&8192&&b!==(b=j[13].t("Upload Date")+"")&&z(m,b),M[0]&8192&&E!==(E=j[13].t("Tables")+"")&&z(Q,E),M[0]&8192&&C!==(C=j[13].t("Actions")+"")&&z(D,C),M[0]&397312&&(x=_e(j[12]),f=gt(f,M,R,1,j,x,A,p,pt,et,null,We))},i:ve,o:ve,d(j){j&&c(e);for(let M=0;M<f.length;M+=1)f[M].d()}}}function Qt(o){let e,t,l,s,i,d=o[13].t("No files match your search")+"",n,u,v,w=o[13].t("Try a different search term or clear your search")+"",T;return{c(){e=_("div"),t=ee("svg"),l=ee("path"),s=P(),i=_("h3"),n=F(d),u=P(),v=_("p"),T=F(w),this.h()},l(b){e=g(b,"DIV",{class:!0});var m=h(e);t=te(m,"svg",{xmlns:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0,class:!0});var S=h(t);l=te(S,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),h(l).forEach(c),S.forEach(c),s=N(m),i=g(m,"H3",{class:!0});var k=h(i);n=O(k,d),k.forEach(c),u=N(m),v=g(m,"P",{class:!0});var E=h(v);T=O(E,w),E.forEach(c),m.forEach(c),this.h()},h(){a(l,"stroke-linecap","round"),a(l,"stroke-linejoin","round"),a(l,"d","M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"),a(t,"xmlns","http://www.w3.org/2000/svg"),a(t,"viewBox","0 0 24 24"),a(t,"fill","none"),a(t,"stroke","currentColor"),a(t,"stroke-width","2"),a(t,"class","w-16 h-16 mx-auto mb-4 text-gray-400"),a(i,"class","text-xl font-medium text-gray-700 dark:text-gray-300 mb-2"),a(v,"class","text-gray-500 dark:text-gray-400"),a(e,"class","empty-state svelte-1310t73")},m(b,m){Y(b,e,m),r(e,t),r(t,l),r(e,s),r(e,i),r(i,n),r(e,u),r(e,v),r(v,T)},p(b,m){m[0]&8192&&d!==(d=b[13].t("No files match your search")+"")&&z(n,d),m[0]&8192&&w!==(w=b[13].t("Try a different search term or clear your search")+"")&&z(T,w)},i:ve,o:ve,d(b){b&&c(e)}}}function Vt(o){let e,t,l,s,i,d=o[13].t("No Excel files have been uploaded yet")+"",n,u,v,w=o[13].t("Upload Excel files using the Excel File Handler to see them here")+"",T;return{c(){e=_("div"),t=ee("svg"),l=ee("path"),s=P(),i=_("h3"),n=F(d),u=P(),v=_("p"),T=F(w),this.h()},l(b){e=g(b,"DIV",{class:!0});var m=h(e);t=te(m,"svg",{xmlns:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0,class:!0});var S=h(t);l=te(S,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),h(l).forEach(c),S.forEach(c),s=N(m),i=g(m,"H3",{class:!0});var k=h(i);n=O(k,d),k.forEach(c),u=N(m),v=g(m,"P",{class:!0});var E=h(v);T=O(E,w),E.forEach(c),m.forEach(c),this.h()},h(){a(l,"stroke-linecap","round"),a(l,"stroke-linejoin","round"),a(l,"d","M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"),a(t,"xmlns","http://www.w3.org/2000/svg"),a(t,"viewBox","0 0 24 24"),a(t,"fill","none"),a(t,"stroke","currentColor"),a(t,"stroke-width","2"),a(t,"class","w-16 h-16 mx-auto mb-4 text-gray-400"),a(i,"class","text-xl font-medium text-gray-700 dark:text-gray-300 mb-2"),a(v,"class","text-gray-500 dark:text-gray-400"),a(e,"class","empty-state svelte-1310t73")},m(b,m){Y(b,e,m),r(e,t),r(t,l),r(e,s),r(e,i),r(i,n),r(e,u),r(e,v),r(v,T)},p(b,m){m[0]&8192&&d!==(d=b[13].t("No Excel files have been uploaded yet")+"")&&z(n,d),m[0]&8192&&w!==(w=b[13].t("Upload Excel files using the Excel File Handler to see them here")+"")&&z(T,w)},i:ve,o:ve,d(b){b&&c(e)}}}function At(o){let e,t,l,s,i=o[13].t("Loading files...")+"",d,n;return t=new it({props:{className:"w-10 h-10"}}),{c(){e=_("div"),at(t.$$.fragment),l=P(),s=_("span"),d=F(i),this.h()},l(u){e=g(u,"DIV",{class:!0});var v=h(e);rt(t.$$.fragment,v),l=N(v),s=g(v,"SPAN",{class:!0});var w=h(s);d=O(w,i),w.forEach(c),v.forEach(c),this.h()},h(){a(s,"class","ml-4 text-gray-600 dark:text-gray-400"),a(e,"class","flex justify-center items-center h-64")},m(u,v){Y(u,e,v),ot(t,e,null),r(e,l),r(e,s),r(s,d),n=!0},p(u,v){(!n||v[0]&8192)&&i!==(i=u[13].t("Loading files...")+"")&&z(d,i)},i(u){n||(pe(t.$$.fragment,u),n=!0)},o(u){ge(t.$$.fragment,u),n=!1},d(u){u&&c(e),nt(t)}}}function Bt(o){let e,t;return{c(){e=ee("svg"),t=ee("path"),this.h()},l(l){e=te(l,"svg",{xmlns:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0,class:!0});var s=h(e);t=te(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),h(t).forEach(c),s.forEach(c),this.h()},h(){a(t,"stroke-linecap","round"),a(t,"stroke-linejoin","round"),a(t,"d","M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"),a(e,"xmlns","http://www.w3.org/2000/svg"),a(e,"viewBox","0 0 24 24"),a(e,"fill","none"),a(e,"stroke","currentColor"),a(e,"stroke-width","2"),a(e,"class","w-6 h-6 text-gray-500")},m(l,s){Y(l,e,s),r(e,t)},d(l){l&&c(e)}}}function Pt(o){let e,t;return{c(){e=ee("svg"),t=ee("path"),this.h()},l(l){e=te(l,"svg",{xmlns:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0,class:!0});var s=h(e);t=te(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),h(t).forEach(c),s.forEach(c),this.h()},h(){a(t,"stroke-linecap","round"),a(t,"stroke-linejoin","round"),a(t,"d","M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"),a(e,"xmlns","http://www.w3.org/2000/svg"),a(e,"viewBox","0 0 24 24"),a(e,"fill","none"),a(e,"stroke","currentColor"),a(e,"stroke-width","2"),a(e,"class","w-6 h-6 text-blue-600")},m(l,s){Y(l,e,s),r(e,t)},d(l){l&&c(e)}}}function Nt(o){let e,t;return{c(){e=ee("svg"),t=ee("path"),this.h()},l(l){e=te(l,"svg",{xmlns:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0,class:!0});var s=h(e);t=te(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),h(t).forEach(c),s.forEach(c),this.h()},h(){a(t,"stroke-linecap","round"),a(t,"stroke-linejoin","round"),a(t,"d","M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"),a(e,"xmlns","http://www.w3.org/2000/svg"),a(e,"viewBox","0 0 24 24"),a(e,"fill","none"),a(e,"stroke","currentColor"),a(e,"stroke-width","2"),a(e,"class","w-6 h-6 text-green-600")},m(l,s){Y(l,e,s),r(e,t)},d(l){l&&c(e)}}}function et(o,e){let t,l,s,i,d,n,u=e[40].name+"",v,w,T,b=e[40].dateUploaded+"",m,S,k,E=e[40].tableCount+"",Q,B,I,C,D,L='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z"></path><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>',p,f,A='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"></path></svg>',x,R,j;function M(X,J){return J[0]&4096&&(s=null),J[0]&4096&&(i=null),s==null&&(s=lt(X[40].name)==="SpreadsheetDocument"),s?Nt:(i==null&&(i=lt(X[40].name)==="TextDocument"),i?Pt:Bt)}let G=M(e,[-1,-1]),q=G(e);function H(){return e[24](e[40])}function U(){return e[25](e[40])}return{key:o,first:null,c(){t=_("tr"),l=_("td"),q.c(),d=P(),n=_("td"),v=F(u),w=P(),T=_("td"),m=F(b),S=P(),k=_("td"),Q=F(E),B=P(),I=_("td"),C=_("div"),D=_("button"),D.innerHTML=L,p=P(),f=_("button"),f.innerHTML=A,x=P(),this.h()},l(X){t=g(X,"TR",{class:!0});var J=h(t);l=g(J,"TD",{class:!0});var ae=h(l);q.l(ae),ae.forEach(c),d=N(J),n=g(J,"TD",{class:!0});var re=h(n);v=O(re,u),re.forEach(c),w=N(J),T=g(J,"TD",{class:!0});var $=h(T);m=O($,b),$.forEach(c),S=N(J),k=g(J,"TD",{class:!0});var ne=h(k);Q=O(ne,E),ne.forEach(c),B=N(J),I=g(J,"TD",{class:!0});var ce=h(I);C=g(ce,"DIV",{class:!0});var oe=h(C);D=g(oe,"BUTTON",{class:!0,"data-svelte-h":!0}),me(D)!=="svelte-f80i9f"&&(D.innerHTML=L),p=N(oe),f=g(oe,"BUTTON",{class:!0,"data-svelte-h":!0}),me(f)!=="svelte-17mkl9c"&&(f.innerHTML=A),oe.forEach(c),ce.forEach(c),x=N(J),J.forEach(c),this.h()},h(){a(l,"class","py-3 px-4"),a(n,"class","py-3 px-4 font-medium text-blue-600 dark:text-blue-400"),a(T,"class","py-3 px-4"),a(k,"class","py-3 px-4"),a(D,"class","p-2 rounded-lg text-blue-600 hover:bg-blue-50 dark:hover:bg-gray-700"),a(f,"class","p-2 rounded-lg text-red-600 hover:bg-red-50 dark:hover:bg-gray-700"),a(C,"class","flex space-x-2"),a(I,"class","py-3 px-4"),a(t,"class","border-b border-gray-200 dark:border-gray-800 hover:bg-gray-50 dark:hover:bg-gray-800 svelte-1310t73"),this.first=t},m(X,J){Y(X,t,J),r(t,l),q.m(l,null),r(t,d),r(t,n),r(n,v),r(t,w),r(t,T),r(T,m),r(t,S),r(t,k),r(k,Q),r(t,B),r(t,I),r(I,C),r(C,D),r(C,p),r(C,f),r(t,x),R||(j=[de(D,"click",H),de(f,"click",U)],R=!0)},p(X,J){e=X,G!==(G=M(e,J))&&(q.d(1),q=G(e),q&&(q.c(),q.m(l,null))),J[0]&4096&&u!==(u=e[40].name+"")&&z(v,u),J[0]&4096&&b!==(b=e[40].dateUploaded+"")&&z(m,b),J[0]&4096&&E!==(E=e[40].tableCount+"")&&z(Q,E)},d(X){X&&c(t),q.d(),R=!1,st(j)}}}function tt(o){let e,t,l,s=o[11].title+"",i,d,n,u=o[11].message+"",v,w,T,b,m="No",S,k,E="Yes",Q,B;return{c(){e=_("div"),t=_("div"),l=_("h3"),i=F(s),d=P(),n=_("p"),v=F(u),w=P(),T=_("div"),b=_("button"),b.textContent=m,S=P(),k=_("button"),k.textContent=E,this.h()},l(I){e=g(I,"DIV",{class:!0});var C=h(e);t=g(C,"DIV",{class:!0});var D=h(t);l=g(D,"H3",{class:!0});var L=h(l);i=O(L,s),L.forEach(c),d=N(D),n=g(D,"P",{class:!0});var p=h(n);v=O(p,u),p.forEach(c),w=N(D),T=g(D,"DIV",{class:!0});var f=h(T);b=g(f,"BUTTON",{class:!0,"data-svelte-h":!0}),me(b)!=="svelte-1qxmt94"&&(b.textContent=m),S=N(f),k=g(f,"BUTTON",{class:!0,"data-svelte-h":!0}),me(k)!=="svelte-1rmf90w"&&(k.textContent=E),f.forEach(c),D.forEach(c),C.forEach(c),this.h()},h(){a(l,"class","text-xl font-semibold text-gray-900 dark:text-gray-100 mb-4"),a(n,"class","text-gray-700 dark:text-gray-300 mb-6"),a(b,"class","px-4 py-2 rounded-md bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-600 transition"),a(k,"class","px-4 py-2 rounded-md bg-blue-600 text-white hover:bg-blue-700 transition"),a(T,"class","flex justify-end space-x-4"),a(t,"class","bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full p-6"),a(e,"class","fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50")},m(I,C){Y(I,e,C),r(e,t),r(t,l),r(l,i),r(t,d),r(t,n),r(n,v),r(t,w),r(t,T),r(T,b),r(T,S),r(T,k),Q||(B=[de(b,"click",function(){Be(o[11].onCancel)&&o[11].onCancel.apply(this,arguments)}),de(k,"click",function(){Be(o[11].onConfirm)&&o[11].onConfirm.apply(this,arguments)})],Q=!0)},p(I,C){o=I,C[0]&2048&&s!==(s=o[11].title+"")&&z(i,s),C[0]&2048&&u!==(u=o[11].message+"")&&z(v,u)},d(I){I&&c(e),Q=!1,st(B)}}}function Ht(o){let e,t,l,s,i,d=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5L8.25 12l7.5-7.5"></path></svg>
          Back`,n,u,v=o[13].t("Excel To SQL Management")+"",w,T,b,m,S,k,E,Q=o[13].t("Refresh")+"",B,I,C,D,L,p,f,A,x,R;const j=[Et,kt],M=[];function G(H,U){return H[3]?1:0}D=G(o),L=M[D]=j[D](o);let q=o[10]&&tt(o);return{c(){e=_("div"),t=_("div"),l=_("div"),s=_("div"),i=_("a"),i.innerHTML=d,n=P(),u=_("h2"),w=F(v),T=P(),b=_("button"),m=ee("svg"),S=ee("path"),k=P(),E=_("span"),B=F(Q),I=P(),C=_("div"),L.c(),p=P(),q&&q.c(),f=Oe(),this.h()},l(H){e=g(H,"DIV",{class:!0});var U=h(e);t=g(U,"DIV",{class:!0});var X=h(t);l=g(X,"DIV",{class:!0});var J=h(l);s=g(J,"DIV",{class:!0});var ae=h(s);i=g(ae,"A",{href:!0,class:!0,"data-svelte-h":!0}),me(i)!=="svelte-bddq2y"&&(i.innerHTML=d),n=N(ae),u=g(ae,"H2",{class:!0});var re=h(u);w=O(re,v),re.forEach(c),ae.forEach(c),T=N(J),b=g(J,"BUTTON",{class:!0});var $=h(b);m=te($,"svg",{xmlns:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0,class:!0});var ne=h(m);S=te(ne,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),h(S).forEach(c),ne.forEach(c),k=N($),E=g($,"SPAN",{});var ce=h(E);B=O(ce,Q),ce.forEach(c),$.forEach(c),J.forEach(c),X.forEach(c),I=N(U),C=g(U,"DIV",{class:!0});var oe=h(C);L.l(oe),oe.forEach(c),U.forEach(c),p=N(H),q&&q.l(H),f=Oe(),this.h()},h(){a(i,"href","/"),a(i,"class","back-button svelte-1310t73"),a(u,"class","header-title svelte-1310t73"),a(s,"class","header-left svelte-1310t73"),a(S,"stroke-linecap","round"),a(S,"stroke-linejoin","round"),a(S,"d","M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"),a(m,"xmlns","http://www.w3.org/2000/svg"),a(m,"viewBox","0 0 24 24"),a(m,"fill","none"),a(m,"stroke","currentColor"),a(m,"stroke-width","2"),a(m,"class","w-5 h-5"),a(b,"class","flex items-center space-x-2 px-3 py-2 rounded-lg bg-blue-600 hover:bg-blue-700 transition"),a(l,"class","header-title-row svelte-1310t73"),a(t,"class","management-header bg-gray-900 dark:bg-gray-950 text-white svelte-1310t73"),a(C,"class","management-content bg-white dark:bg-gray-900 svelte-1310t73"),a(e,"class","excel-management-container svelte-1310t73")},m(H,U){Y(H,e,U),r(e,t),r(t,l),r(l,s),r(s,i),r(s,n),r(s,u),r(u,w),r(l,T),r(l,b),r(b,m),r(m,S),r(b,k),r(b,E),r(E,B),r(e,I),r(e,C),M[D].m(C,null),Y(H,p,U),q&&q.m(H,U),Y(H,f,U),A=!0,x||(R=de(b,"click",o[15]),x=!0)},p(H,U){(!A||U[0]&8192)&&v!==(v=H[13].t("Excel To SQL Management")+"")&&z(w,v),(!A||U[0]&8192)&&Q!==(Q=H[13].t("Refresh")+"")&&z(B,Q);let X=D;D=G(H),D===X?M[D].p(H,U):(Ce(),ge(M[X],1,1,()=>{M[X]=null}),Le(),L=M[D],L?L.p(H,U):(L=M[D]=j[D](H),L.c()),pe(L,1),L.m(C,null)),H[10]?q?q.p(H,U):(q=tt(H),q.c(),q.m(f.parentNode,f)):q&&(q.d(1),q=null)},i(H){A||(pe(L),A=!0)},o(H){ge(L),A=!1},d(H){H&&(c(e),c(p),c(f)),M[D].d(),q&&q.d(H),x=!1,R()}}}function lt(o){return o.endsWith(".xlsx")||o.endsWith(".xls")?"SpreadsheetDocument":o.endsWith(".csv")?"TextDocument":"Page"}function jt(o,e,t){let l,s;const i=ut("i18n");dt(o,i,y=>t(13,s=y));let d=!0,n=[],u=null,v={},w={},T="",b=null,m={},S=[],k=!1,E=!1,Q=mt,B="token_59b8b43a_aiurmmm0",I="en",C=!1,D={title:"",message:"",onConfirm:()=>{},onCancel:()=>{}};ft(async()=>{try{console.log("Loading API configuration...");const y=await bt(i);Q=Q,B=y.userToken||B,I=y.languageLocal||I,console.log("Excel-to-SQL page - API Config loaded:",{base_url:Q,language_local:I,user_token:B})}catch(y){console.error("Error loading API configuration:",y)}await p()});async function L(y,V={}){const W=`${Q}/proxy/api${y}`;console.log(`[ExcelToSQL Debug] Sending request to ${W}`);const se={method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${B}`,"Accept-Language":I}},be={...se,...V,headers:{...se.headers,...V.headers||{}}};console.log("[ExcelToSQL Debug] Full request options:",be);try{const ue=await fetch(W,be);console.log(`[ExcelToSQL Debug] Response status: ${ue.status}`);try{const fe=await ue.json();if(console.log("[ExcelToSQL Debug] RAW API RESPONSE:",JSON.stringify(fe,null,2)),!ue.ok)throw console.error(`[ExcelToSQL Debug] Request failed with status ${ue.status}:`,fe),new Error(fe.error||fe.detail||"An error occurred");return fe}catch(fe){console.error("[ExcelToSQL Debug] Failed to parse JSON response:",fe);const le=await ue.text();throw console.error("[ExcelToSQL Debug] Text response:",le),new Error("Invalid JSON response from server")}}catch(ue){throw console.error("[ExcelToSQL Debug] API request failed:",ue),ue}}async function p(){console.log("[ExcelToSQL Debug] Loading files list"),t(2,d=!0);try{const y=await L("/excel_to_sql/list_files",{method:"GET"});if(console.log("[ExcelToSQL Debug] Files loaded:",y),y.success&&y.files){console.log("[ExcelToSQL Debug] LIST_FILES SUCCESS - File count:",y.files.length),console.log("[ExcelToSQL Debug] LIST_FILES DETAILED:",JSON.stringify(y.files,null,2));const V=y.files.map((W,se)=>({key:se.toString(),id:W.id||se.toString(),name:W.original_filename,savedPath:W.saved_path,dateUploaded:new Date(W.created_at||Date.now()).toLocaleString(),tableCount:(W.tables||[]).length,tables:W.tables||[],mappingId:W.mapping_id}));console.log("[ExcelToSQL Debug] Formatted files:",V),t(0,n=V)}else console.error("[ExcelToSQL Debug] Failed to load files:",y),ie.error("Failed to load Excel files")}catch(y){console.error("[ExcelToSQL Debug] Error loading Excel files:",y),ie.error(`Error loading Excel files: ${y.message}`),t(0,n=[])}finally{t(2,d=!1)}}function f(y,V,W){t(11,D={title:y,message:V,onConfirm:()=>{W(),t(10,C=!1)},onCancel:()=>{t(10,C=!1)}}),t(10,C=!0)}async function A(y){console.log("[ExcelToSQL Debug] Attempting to delete file:",y),f("Delete File",`Are you sure you want to delete the file "${y.name}"?`,async()=>{t(2,d=!0);try{console.log("[ExcelToSQL Debug] Confirmed file deletion for:",y.savedPath);const V=await L("/excel_to_sql/delete_file",{method:"POST",body:JSON.stringify({file_path:y.savedPath})});console.log("[ExcelToSQL Debug] Delete file response:",V),V.success?(ie.success(`File "${y.name}" deleted successfully`),console.log("[ExcelToSQL Debug] File deleted successfully, reloading file list"),await p(),u&&u.id===y.id&&(console.log("[ExcelToSQL Debug] Clearing selected file as it was deleted"),t(3,u=null))):(console.error("[ExcelToSQL Debug] Failed to delete file:",V.error),ie.error(`Failed to delete file: ${V.error}`))}catch(V){console.error("[ExcelToSQL Debug] Error deleting file:",V),ie.error(`Error deleting file: ${V.message}`)}finally{t(2,d=!1)}})}function x(y){console.log("[ExcelToSQL Debug] Viewing file details:",y),t(3,u=y),t(4,v={}),t(5,w={}),t(6,b=null),m={},t(9,E=!1),t(8,k=!1)}async function R(y){console.log("[ExcelToSQL Debug] Loading table data for:",y.table_name),t(6,b=y),t(5,w[y.table_name]=!0,w),t(9,E=!1),t(8,k=!1);try{const V=await L("/excel_to_sql/get_table_data",{method:"POST",body:JSON.stringify({table_name:y.table_name})});if(console.log("[ExcelToSQL Debug] Table data response:",V),V.success){console.log("[ExcelToSQL Debug] Table data loaded successfully:",V.data),t(4,v[y.table_name]=V.data||{},v);const W={};V.data&&V.data.rows&&V.data.rows.forEach((se,be)=>{W[be]={...se}}),m=W,V.data&&V.data.columns&&(t(7,S=V.data.columns.map(se=>se.name)),console.log("[ExcelToSQL Debug] Selected columns:",S))}else console.error("[ExcelToSQL Debug] Failed to load table data:",V.error),ie.error(`Failed to load table data: ${V.error}`)}catch(V){console.error("[ExcelToSQL Debug] Error loading table data:",V),ie.error(`Error loading table data: ${V.message}`)}finally{t(5,w[y.table_name]=!1,w)}}function j(y,V,W){console.log(`[ExcelToSQL Debug] Editing cell: row ${y}, column ${V}, value:`,W),m[y]={...m[y],[V]:W},t(8,k=!0)}async function M(){if(b){console.log("[ExcelToSQL Debug] Saving edited data for table:",b.table_name);try{t(2,d=!0);const y=Object.values(m);console.log("[ExcelToSQL Debug] Rows to save:",y),console.log("[ExcelToSQL Debug] Columns to include:",S);const V={table_name:b.table_name,rows:y,columns:S};console.log("[ExcelToSQL Debug] Save request payload:",V);const W=await L("/update_table_data",{method:"POST",body:JSON.stringify(V)});console.log("[ExcelToSQL Debug] Save response:",W),W.success?(console.log("[ExcelToSQL Debug] Data saved successfully"),ie.success(`Successfully saved changes to ${b.table_name}`),t(8,k=!1),console.log("[ExcelToSQL Debug] Reloading table data after save"),await R(b),t(9,E=!1)):(console.error("[ExcelToSQL Debug] Failed to save changes:",W.error),ie.error(`Failed to save changes: ${W.error}`))}catch(y){console.error("[ExcelToSQL Debug] Error saving data:",y),ie.error(`Error saving data: ${y.message}`)}finally{t(2,d=!1)}}}async function G(y){console.log("[ExcelToSQL Debug] Requesting to delete table:",y.table_name),f("Delete Table",`Are you sure you want to delete the table "${y.table_name}"?`,async()=>{try{console.log("[ExcelToSQL Debug] Confirmed table deletion for:",y.table_name);const V=await L("/delete_table",{method:"POST",body:JSON.stringify({table_name:y.table_name})});if(console.log("[ExcelToSQL Debug] Delete table response:",V),V.success){if(console.log("[ExcelToSQL Debug] Table deleted successfully"),ie.success(`Table "${y.table_name}" deleted successfully`),u){const W=u.tables.filter(se=>se.table_name!==y.table_name);console.log("[ExcelToSQL Debug] Updated tables list after deletion:",W),t(3,u={...u,tables:W,tableCount:W.length}),b&&b.table_name===y.table_name&&(console.log("[ExcelToSQL Debug] Clearing selected table as it was deleted"),t(6,b=null))}}else console.error("[ExcelToSQL Debug] Failed to delete table:",V.error),ie.error(`Failed to delete table: ${V.error}`)}catch(V){console.error("[ExcelToSQL Debug] Error deleting table:",V),ie.error(`Error deleting table: ${V.message}`)}})}function q(){T=this.value,t(1,T)}const H=y=>x(y),U=y=>A(y),X=()=>{b?(t(6,b=null),t(9,E=!1)):t(3,u=null)},J=y=>R(y),ae=()=>G(b),re=()=>t(9,E=!0),$=()=>{f("Cancel Editing","Are you sure you want to cancel? All unsaved changes will be lost.",()=>{t(9,E=!1),R(b)})},ne=y=>S.includes(y.name),ce=y=>S.includes(y.name),oe=(y,V,W)=>{E&&j(y,V.name,W.target.innerText)};return o.$$.update=()=>{o.$$.dirty[0]&3&&t(12,l=n.filter(y=>T===""||y.name.toLowerCase().includes(T.toLowerCase())))},[n,T,d,u,v,w,b,S,k,E,C,D,l,s,i,p,f,A,x,R,j,M,G,q,H,U,X,J,ae,re,$,ne,ce,oe]}class Wt extends vt{constructor(e){super(),_t(this,e,jt,Ht,ct,{},null,[-1,-1])}}export{Wt as component};
//# sourceMappingURL=19.3Icc-6zM.js.map
