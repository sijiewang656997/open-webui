import{s as ct,e as v,k as P,t as F,D as te,l as Oe,c as g,a as h,M as be,o as H,b as O,d as c,E as le,f as a,i as W,g as r,u as ue,h as z,p as ut,j as dt,q as ft,H as Be,G as st,B as Ue,n as he,P as Se,U as ht}from"../chunks/Dc4_ziGv.js";import{S as _t,i as vt,a as ve,c as Le,t as ge,g as Ce,b as at,d as rt,m as ot,e as nt}from"../chunks/CAZSMy3J.js";import{e as _e,u as gt,d as pt}from"../chunks/C6kX8Nm-.js";import{t as ie}from"../chunks/gLvYLTeg.js";import"../chunks/DhUbH0v9.js";import{S as it}from"../chunks/7Z-YgjJE.js";import{g as bt}from"../chunks/D1bLSBaZ.js";function qe(o,e,t){const l=o.slice();return l[46]=e[t],l[48]=t,l}function Re(o,e,t){const l=o.slice();return l[49]=e[t],l}function ze(o,e,t){const l=o.slice();return l[49]=e[t],l}function Je(o,e,t){const l=o.slice();return l[43]=e[t],l}function We(o,e,t){const l=o.slice();return l[40]=e[t],l}function mt(o){let e,t,l,s,i,d,n=o[6]?"Back to Tables":"Back to Files",u,_,w,T=o[3].name+"",b,m,S,k,E,V,B;const I=[wt,Et],C=[];function D(L,p){return L[6]?1:0}return S=D(o),k=C[S]=I[S](o),{c(){e=v("div"),t=v("div"),l=v("button"),s=te("svg"),i=te("path"),d=P(),u=F(n),_=P(),w=v("h3"),b=F(T),m=P(),k.c(),this.h()},l(L){e=g(L,"DIV",{class:!0});var p=h(e);t=g(p,"DIV",{class:!0});var f=h(t);l=g(f,"BUTTON",{class:!0});var A=h(l);s=le(A,"svg",{xmlns:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0,class:!0});var x=h(s);i=le(x,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),h(i).forEach(c),x.forEach(c),d=H(A),u=O(A,n),A.forEach(c),_=H(f),w=g(f,"H3",{class:!0});var q=h(w);b=O(q,T),q.forEach(c),f.forEach(c),m=H(p),k.l(p),p.forEach(c),this.h()},h(){a(i,"stroke-linecap","round"),a(i,"stroke-linejoin","round"),a(i,"d","M15.75 19.5L8.25 12l7.5-7.5"),a(s,"xmlns","http://www.w3.org/2000/svg"),a(s,"viewBox","0 0 24 24"),a(s,"fill","none"),a(s,"stroke","currentColor"),a(s,"stroke-width","2"),a(s,"class","w-5 h-5"),a(l,"class","back-to-files-button svelte-1310t73"),a(w,"class","text-lg font-semibold text-gray-800 dark:text-gray-200"),a(t,"class","file-detail-header dark:border-gray-700 svelte-1310t73"),a(e,"class","file-detail-container svelte-1310t73")},m(L,p){W(L,e,p),r(e,t),r(t,l),r(l,s),r(s,i),r(l,d),r(l,u),r(t,_),r(t,w),r(w,b),r(e,m),C[S].m(e,null),E=!0,V||(B=ue(l,"click",o[26]),V=!0)},p(L,p){(!E||p[0]&64)&&n!==(n=L[6]?"Back to Tables":"Back to Files")&&z(u,n),(!E||p[0]&8)&&T!==(T=L[3].name+"")&&z(b,T);let f=S;S=D(L),S===f?C[S].p(L,p):(Ce(),ve(C[f],1,1,()=>{C[f]=null}),Le(),k=C[S],k?k.p(L,p):(k=C[S]=I[S](L),k.c()),ge(k,1),k.m(e,null))},i(L){E||(ge(k),E=!0)},o(L){ve(k),E=!1},d(L){L&&c(e),C[S].d(),V=!1,B()}}}function kt(o){let e,t,l,s,i=o[13].t("Excel Data Sources")+"",d,n,u,_,w,T,b,m,S,k,E,V,B,I;const C=[Qt,Vt,It,Ct],D=[];function L(p,f){return p[2]?0:p[0].length===0?1:p[12].length===0?2:3}return k=L(o),E=D[k]=C[k](o),{c(){e=v("div"),t=v("div"),l=v("div"),s=v("h3"),d=F(i),n=P(),u=v("div"),_=v("div"),w=te("svg"),T=te("path"),b=P(),m=v("input"),S=P(),E.c(),this.h()},l(p){e=g(p,"DIV",{class:!0});var f=h(e);t=g(f,"DIV",{class:!0});var A=h(t);l=g(A,"DIV",{class:!0});var x=h(l);s=g(x,"H3",{class:!0});var q=h(s);d=O(q,i),q.forEach(c),n=H(x),u=g(x,"DIV",{class:!0});var j=h(u);_=g(j,"DIV",{class:!0});var M=h(_);w=le(M,"svg",{xmlns:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0,class:!0});var Y=h(w);T=le(Y,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),h(T).forEach(c),Y.forEach(c),b=H(M),m=g(M,"INPUT",{type:!0,placeholder:!0,class:!0}),M.forEach(c),j.forEach(c),x.forEach(c),A.forEach(c),S=H(f),E.l(f),f.forEach(c),this.h()},h(){a(s,"class","text-lg font-semibold text-gray-800 dark:text-gray-200"),a(T,"stroke-linecap","round"),a(T,"stroke-linejoin","round"),a(T,"d","M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"),a(w,"xmlns","http://www.w3.org/2000/svg"),a(w,"viewBox","0 0 24 24"),a(w,"fill","none"),a(w,"stroke","currentColor"),a(w,"stroke-width","2"),a(w,"class","w-5 h-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"),a(m,"type","text"),a(m,"placeholder","Search files..."),a(m,"class","pl-10 pr-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 w-full"),a(_,"class","relative"),a(u,"class","search-box"),a(l,"class","flex justify-between items-center"),a(t,"class","file-list-header dark:border-gray-700 svelte-1310t73"),a(e,"class","file-list-container svelte-1310t73")},m(p,f){W(p,e,f),r(e,t),r(t,l),r(l,s),r(s,d),r(l,n),r(l,u),r(u,_),r(_,w),r(w,T),r(_,b),r(_,m),Ue(m,o[1]),r(e,S),D[k].m(e,null),V=!0,B||(I=ue(m,"input",o[23]),B=!0)},p(p,f){(!V||f[0]&8192)&&i!==(i=p[13].t("Excel Data Sources")+"")&&z(d,i),f[0]&2&&m.value!==p[1]&&Ue(m,p[1]);let A=k;k=L(p),k===A?D[k].p(p,f):(Ce(),ve(D[A],1,1,()=>{D[A]=null}),Le(),E=D[k],E?E.p(p,f):(E=D[k]=C[k](p),E.c()),ge(E,1),E.m(e,null))},i(p){V||(ge(E),V=!0)},o(p){ve(E),V=!1},d(p){p&&c(e),D[k].d(),B=!1,I()}}}function Et(o){let e,t,l,s,i=o[13].t("Table")+"",d,n,u=o[6].table_name+"",_,w,T,b,m='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"></path></svg> <span>Delete Table</span>',S,k,E,V,B,I;const C=[Tt,yt],D=[];function L(p,f){return p[5][p[6].table_name]?0:p[4][p[6].table_name]?1:-1}return~(k=L(o))&&(E=D[k]=C[k](o)),{c(){e=v("div"),t=v("div"),l=v("div"),s=v("h4"),d=F(i),n=F(": "),_=F(u),w=P(),T=v("div"),b=v("button"),b.innerHTML=m,S=P(),E&&E.c(),this.h()},l(p){e=g(p,"DIV",{class:!0});var f=h(e);t=g(f,"DIV",{class:!0});var A=h(t);l=g(A,"DIV",{class:!0});var x=h(l);s=g(x,"H4",{class:!0});var q=h(s);d=O(q,i),n=O(q,": "),_=O(q,u),q.forEach(c),w=H(x),T=g(x,"DIV",{class:!0});var j=h(T);b=g(j,"BUTTON",{class:!0,"data-svelte-h":!0}),be(b)!=="svelte-1yetmxg"&&(b.innerHTML=m),j.forEach(c),x.forEach(c),A.forEach(c),S=H(f),E&&E.l(f),f.forEach(c),this.h()},h(){a(s,"class","text-lg font-semibold text-gray-800 dark:text-gray-200"),a(b,"class","px-3 py-2 rounded-lg bg-red-600 hover:bg-red-700 text-white transition flex items-center space-x-2"),a(T,"class","flex space-x-2"),a(l,"class","flex justify-between items-center"),a(t,"class","mb-4"),a(e,"class","table-view-section svelte-1310t73")},m(p,f){W(p,e,f),r(e,t),r(t,l),r(l,s),r(s,d),r(s,n),r(s,_),r(l,w),r(l,T),r(T,b),r(e,S),~k&&D[k].m(e,null),V=!0,B||(I=ue(b,"click",o[28]),B=!0)},p(p,f){(!V||f[0]&8192)&&i!==(i=p[13].t("Table")+"")&&z(d,i),(!V||f[0]&64)&&u!==(u=p[6].table_name+"")&&z(_,u);let A=k;k=L(p),k===A?~k&&D[k].p(p,f):(E&&(Ce(),ve(D[A],1,1,()=>{D[A]=null}),Le()),~k?(E=D[k],E?E.p(p,f):(E=D[k]=C[k](p),E.c()),ge(E,1),E.m(e,null)):E=null)},i(p){V||(ge(E),V=!0)},o(p){ve(E),V=!1},d(p){p&&c(e),~k&&D[k].d(),B=!1,I()}}}function wt(o){let e,t,l,s=o[13].t("Filename")+"",i,d,n,u,_=o[3].name+"",w,T,b,m,S=o[13].t("Upload Date")+"",k,E,V,B,I=o[3].dateUploaded+"",C,D,L,p,f=o[13].t("Tables")+"",A,x,q,j,M=o[3].tableCount+"",Y,R,N,U,X=o[13].t("Path")+"",J,ae,re,ee,ne=o[3].savedPath+"",ce,oe,y,Q,G,se=o[13].t("Excel Sheets")+"",pe,me,de,$=o[3].tables&&o[3].tables.length>0&&Ze(o);function Pe(K,Z){return!K[3].tables||K[3].tables.length===0?Lt:St}let ke=Pe(o),fe=ke(o);return{c(){e=v("div"),t=v("div"),l=v("span"),i=F(s),d=F(":"),n=P(),u=v("span"),w=F(_),T=P(),b=v("div"),m=v("span"),k=F(S),E=F(":"),V=P(),B=v("span"),C=F(I),D=P(),L=v("div"),p=v("span"),A=F(f),x=F(":"),q=P(),j=v("span"),Y=F(M),R=P(),N=v("div"),U=v("span"),J=F(X),ae=F(":"),re=P(),ee=v("span"),ce=F(ne),oe=P(),y=v("div"),Q=v("div"),G=v("h4"),pe=F(se),me=P(),$&&$.c(),de=P(),fe.c(),this.h()},l(K){e=g(K,"DIV",{class:!0});var Z=h(e);t=g(Z,"DIV",{class:!0});var Ee=h(t);l=g(Ee,"SPAN",{class:!0});var Ie=h(l);i=O(Ie,s),d=O(Ie,":"),Ie.forEach(c),n=H(Ee),u=g(Ee,"SPAN",{class:!0});var He=h(u);w=O(He,_),He.forEach(c),Ee.forEach(c),T=H(Z),b=g(Z,"DIV",{class:!0});var we=h(b);m=g(we,"SPAN",{class:!0});var Ve=h(m);k=O(Ve,S),E=O(Ve,":"),Ve.forEach(c),V=H(we),B=g(we,"SPAN",{class:!0});var Ne=h(B);C=O(Ne,I),Ne.forEach(c),we.forEach(c),D=H(Z),L=g(Z,"DIV",{class:!0});var ye=h(L);p=g(ye,"SPAN",{class:!0});var Qe=h(p);A=O(Qe,f),x=O(Qe,":"),Qe.forEach(c),q=H(ye),j=g(ye,"SPAN",{class:!0});var je=h(j);Y=O(je,M),je.forEach(c),ye.forEach(c),R=H(Z),N=g(Z,"DIV",{class:!0});var Te=h(N);U=g(Te,"SPAN",{class:!0});var Ae=h(U);J=O(Ae,X),ae=O(Ae,":"),Ae.forEach(c),re=H(Te),ee=g(Te,"SPAN",{class:!0});var Me=h(ee);ce=O(Me,ne),Me.forEach(c),Te.forEach(c),Z.forEach(c),oe=H(K),y=g(K,"DIV",{class:!0});var De=h(y);Q=g(De,"DIV",{class:!0});var xe=h(Q);G=g(xe,"H4",{class:!0});var Fe=h(G);pe=O(Fe,se),Fe.forEach(c),me=H(xe),$&&$.l(xe),xe.forEach(c),de=H(De),fe.l(De),De.forEach(c),this.h()},h(){a(l,"class","info-label svelte-1310t73"),a(u,"class","info-value svelte-1310t73"),a(t,"class","file-info-item svelte-1310t73"),a(m,"class","info-label svelte-1310t73"),a(B,"class","info-value svelte-1310t73"),a(b,"class","file-info-item svelte-1310t73"),a(p,"class","info-label svelte-1310t73"),a(j,"class","info-value svelte-1310t73"),a(L,"class","file-info-item svelte-1310t73"),a(U,"class","info-label svelte-1310t73"),a(ee,"class","info-value text-xs opacity-80 svelte-1310t73"),a(N,"class","file-info-item svelte-1310t73"),a(e,"class","file-info-section dark:border-gray-700 svelte-1310t73"),a(G,"class","section-title svelte-1310t73"),a(Q,"class","flex justify-between items-center mb-4"),a(y,"class","tables-section svelte-1310t73")},m(K,Z){W(K,e,Z),r(e,t),r(t,l),r(l,i),r(l,d),r(t,n),r(t,u),r(u,w),r(e,T),r(e,b),r(b,m),r(m,k),r(m,E),r(b,V),r(b,B),r(B,C),r(e,D),r(e,L),r(L,p),r(p,A),r(p,x),r(L,q),r(L,j),r(j,Y),r(e,R),r(e,N),r(N,U),r(U,J),r(U,ae),r(N,re),r(N,ee),r(ee,ce),W(K,oe,Z),W(K,y,Z),r(y,Q),r(Q,G),r(G,pe),r(Q,me),$&&$.m(Q,null),r(y,de),fe.m(y,null)},p(K,Z){Z[0]&8192&&s!==(s=K[13].t("Filename")+"")&&z(i,s),Z[0]&8&&_!==(_=K[3].name+"")&&z(w,_),Z[0]&8192&&S!==(S=K[13].t("Upload Date")+"")&&z(k,S),Z[0]&8&&I!==(I=K[3].dateUploaded+"")&&z(C,I),Z[0]&8192&&f!==(f=K[13].t("Tables")+"")&&z(A,f),Z[0]&8&&M!==(M=K[3].tableCount+"")&&z(Y,M),Z[0]&8192&&X!==(X=K[13].t("Path")+"")&&z(J,X),Z[0]&8&&ne!==(ne=K[3].savedPath+"")&&z(ce,ne),Z[0]&8192&&se!==(se=K[13].t("Excel Sheets")+"")&&z(pe,se),K[3].tables&&K[3].tables.length>0?$?$.p(K,Z):($=Ze(K),$.c(),$.m(Q,null)):$&&($.d(1),$=null),ke===(ke=Pe(K))&&fe?fe.p(K,Z):(fe.d(1),fe=ke(K),fe&&(fe.c(),fe.m(y,null)))},i:he,o:he,d(K){K&&(c(e),c(oe),c(y)),$&&$.d(),fe.d()}}}function yt(o){let e,t,l,s,i,d,n,u,_,w,T,b,m,S,k;function E(f,A){return f[9]?xt:Dt}let V=E(o),B=V(o),I=o[9]&&Ye(o),C=_e(o[4][o[6].table_name].columns.filter(o[31])),D=[];for(let f=0;f<C.length;f+=1)D[f]=Ge(ze(o,C,f));let L=_e(o[4][o[6].table_name].rows),p=[];for(let f=0;f<L.length;f+=1)p[f]=Xe(qe(o,L,f));return{c(){e=v("div"),t=v("div"),l=v("button"),B.c(),d=P(),I&&I.c(),n=P(),u=v("div"),_=v("table"),w=v("thead"),T=v("tr");for(let f=0;f<D.length;f+=1)D[f].c();b=P(),m=v("tbody");for(let f=0;f<p.length;f+=1)p[f].c();this.h()},l(f){e=g(f,"DIV",{class:!0});var A=h(e);t=g(A,"DIV",{class:!0});var x=h(t);l=g(x,"BUTTON",{class:!0});var q=h(l);B.l(q),q.forEach(c),d=H(x),I&&I.l(x),x.forEach(c),A.forEach(c),n=H(f),u=g(f,"DIV",{class:!0});var j=h(u);_=g(j,"TABLE",{class:!0});var M=h(_);w=g(M,"THEAD",{});var Y=h(w);T=g(Y,"TR",{class:!0});var R=h(T);for(let U=0;U<D.length;U+=1)D[U].l(R);R.forEach(c),Y.forEach(c),b=H(M),m=g(M,"TBODY",{});var N=h(m);for(let U=0;U<p.length;U+=1)p[U].l(N);N.forEach(c),M.forEach(c),j.forEach(c),this.h()},h(){a(l,"class",s="px-3 py-2 rounded-lg "+(o[9]?"bg-green-600 hover:bg-green-700":"bg-blue-600 hover:bg-blue-700")+" text-white transition flex items-center space-x-2"),l.disabled=i=o[9]&&!o[8],a(t,"class","flex space-x-4"),a(e,"class","table-controls mb-4"),a(T,"class","svelte-1310t73"),a(_,"class","excel-table w-full svelte-1310t73"),a(u,"class","excel-table-wrapper svelte-1310t73")},m(f,A){W(f,e,A),r(e,t),r(t,l),B.m(l,null),r(t,d),I&&I.m(t,null),W(f,n,A),W(f,u,A),r(u,_),r(_,w),r(w,T);for(let x=0;x<D.length;x+=1)D[x]&&D[x].m(T,null);r(_,b),r(_,m);for(let x=0;x<p.length;x+=1)p[x]&&p[x].m(m,null);S||(k=ue(l,"click",function(){Be(o[9]?o[21]:o[29])&&(o[9]?o[21]:o[29]).apply(this,arguments)}),S=!0)},p(f,A){if(o=f,V!==(V=E(o))&&(B.d(1),B=V(o),B&&(B.c(),B.m(l,null))),A[0]&512&&s!==(s="px-3 py-2 rounded-lg "+(o[9]?"bg-green-600 hover:bg-green-700":"bg-blue-600 hover:bg-blue-700")+" text-white transition flex items-center space-x-2")&&a(l,"class",s),A[0]&768&&i!==(i=o[9]&&!o[8])&&(l.disabled=i),o[9]?I?I.p(o,A):(I=Ye(o),I.c(),I.m(t,null)):I&&(I.d(1),I=null),A[0]&208){C=_e(o[4][o[6].table_name].columns.filter(o[31]));let x;for(x=0;x<C.length;x+=1){const q=ze(o,C,x);D[x]?D[x].p(q,A):(D[x]=Ge(q),D[x].c(),D[x].m(T,null))}for(;x<D.length;x+=1)D[x].d(1);D.length=C.length}if(A[0]&1049296){L=_e(o[4][o[6].table_name].rows);let x;for(x=0;x<L.length;x+=1){const q=qe(o,L,x);p[x]?p[x].p(q,A):(p[x]=Xe(q),p[x].c(),p[x].m(m,null))}for(;x<p.length;x+=1)p[x].d(1);p.length=L.length}},i:he,o:he,d(f){f&&(c(e),c(n),c(u)),B.d(),I&&I.d(),Se(D,f),Se(p,f),S=!1,k()}}}function Tt(o){let e,t,l,s,i=o[13].t("Loading table data...")+"",d,n;return t=new it({props:{className:"w-10 h-10"}}),{c(){e=v("div"),at(t.$$.fragment),l=P(),s=v("span"),d=F(i),this.h()},l(u){e=g(u,"DIV",{class:!0});var _=h(e);rt(t.$$.fragment,_),l=H(_),s=g(_,"SPAN",{class:!0});var w=h(s);d=O(w,i),w.forEach(c),_.forEach(c),this.h()},h(){a(s,"class","ml-4 text-gray-600 dark:text-gray-400"),a(e,"class","flex justify-center items-center h-64")},m(u,_){W(u,e,_),ot(t,e,null),r(e,l),r(e,s),r(s,d),n=!0},p(u,_){(!n||_[0]&8192)&&i!==(i=u[13].t("Loading table data...")+"")&&z(d,i)},i(u){n||(ge(t.$$.fragment,u),n=!0)},o(u){ve(t.$$.fragment,u),n=!1},d(u){u&&c(e),nt(t)}}}function Dt(o){let e,t,l,s,i="Edit Data";return{c(){e=te("svg"),t=te("path"),l=P(),s=v("span"),s.textContent=i,this.h()},l(d){e=le(d,"svg",{xmlns:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0,class:!0});var n=h(e);t=le(n,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),h(t).forEach(c),n.forEach(c),l=H(d),s=g(d,"SPAN",{"data-svelte-h":!0}),be(s)!=="svelte-19wbzee"&&(s.textContent=i),this.h()},h(){a(t,"stroke-linecap","round"),a(t,"stroke-linejoin","round"),a(t,"d","M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"),a(e,"xmlns","http://www.w3.org/2000/svg"),a(e,"viewBox","0 0 24 24"),a(e,"fill","none"),a(e,"stroke","currentColor"),a(e,"stroke-width","2"),a(e,"class","w-5 h-5")},m(d,n){W(d,e,n),r(e,t),W(d,l,n),W(d,s,n)},d(d){d&&(c(e),c(l),c(s))}}}function xt(o){let e,t,l,s,i="Save Changes";return{c(){e=te("svg"),t=te("path"),l=P(),s=v("span"),s.textContent=i,this.h()},l(d){e=le(d,"svg",{xmlns:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0,class:!0});var n=h(e);t=le(n,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),h(t).forEach(c),n.forEach(c),l=H(d),s=g(d,"SPAN",{"data-svelte-h":!0}),be(s)!=="svelte-1mlnvx6"&&(s.textContent=i),this.h()},h(){a(t,"stroke-linecap","round"),a(t,"stroke-linejoin","round"),a(t,"d","M17.593 3.322c1.1.128 1.907 1.077 1.907 2.185V21L12 17.25 4.5 21V5.507c0-1.108.806-2.057 1.907-2.185a48.507 48.507 0 0111.186 0z"),a(e,"xmlns","http://www.w3.org/2000/svg"),a(e,"viewBox","0 0 24 24"),a(e,"fill","none"),a(e,"stroke","currentColor"),a(e,"stroke-width","2"),a(e,"class","w-5 h-5")},m(d,n){W(d,e,n),r(e,t),W(d,l,n),W(d,s,n)},d(d){d&&(c(e),c(l),c(s))}}}function Ye(o){let e,t='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path></svg> <span>Cancel</span>',l,s;return{c(){e=v("button"),e.innerHTML=t,this.h()},l(i){e=g(i,"BUTTON",{class:!0,"data-svelte-h":!0}),be(e)!=="svelte-mt124r"&&(e.innerHTML=t),this.h()},h(){a(e,"class","px-3 py-2 rounded-lg bg-gray-600 hover:bg-gray-700 text-white transition flex items-center space-x-2")},m(i,d){W(i,e,d),l||(s=ue(e,"click",o[30]),l=!0)},p:he,d(i){i&&c(e),l=!1,s()}}}function Ge(o){let e,t,l,s=o[49].name+"",i,d;return{c(){e=v("th"),t=v("div"),l=v("span"),i=F(s),d=P(),this.h()},l(n){e=g(n,"TH",{class:!0});var u=h(e);t=g(u,"DIV",{class:!0});var _=h(t);l=g(_,"SPAN",{});var w=h(l);i=O(w,s),w.forEach(c),_.forEach(c),d=H(u),u.forEach(c),this.h()},h(){a(t,"class","flex justify-between items-center"),a(e,"class","svelte-1310t73")},m(n,u){W(n,e,u),r(e,t),r(t,l),r(l,i),r(e,d)},p(n,u){u[0]&208&&s!==(s=n[49].name+"")&&z(i,s)},d(n){n&&c(e)}}}function Ke(o){let e,t=(o[46][o[49].name]!==void 0?o[46][o[49].name]:"")+"",l,s,i;function d(...n){return o[33](o[48],o[49],...n)}return{c(){e=v("td"),l=F(t),this.h()},l(n){e=g(n,"TD",{contenteditable:!0,class:!0});var u=h(e);l=O(u,t),u.forEach(c),this.h()},h(){a(e,"contenteditable",o[9]),a(e,"class","svelte-1310t73")},m(n,u){W(n,e,u),r(e,l),s||(i=ue(e,"blur",d),s=!0)},p(n,u){o=n,u[0]&208&&t!==(t=(o[46][o[49].name]!==void 0?o[46][o[49].name]:"")+"")&&ht(l,t,o[9]),u[0]&512&&a(e,"contenteditable",o[9])},d(n){n&&c(e),s=!1,i()}}}function Xe(o){let e,t,l=_e(o[4][o[6].table_name].columns.filter(o[32])),s=[];for(let i=0;i<l.length;i+=1)s[i]=Ke(Re(o,l,i));return{c(){e=v("tr");for(let i=0;i<s.length;i+=1)s[i].c();t=P(),this.h()},l(i){e=g(i,"TR",{class:!0});var d=h(e);for(let n=0;n<s.length;n+=1)s[n].l(d);t=H(d),d.forEach(c),this.h()},h(){a(e,"class","svelte-1310t73")},m(i,d){W(i,e,d);for(let n=0;n<s.length;n+=1)s[n]&&s[n].m(e,null);r(e,t)},p(i,d){if(d[0]&1049296){l=_e(i[4][i[6].table_name].columns.filter(i[32]));let n;for(n=0;n<l.length;n+=1){const u=Re(i,l,n);s[n]?s[n].p(u,d):(s[n]=Ke(u),s[n].c(),s[n].m(e,t))}for(;n<s.length;n+=1)s[n].d(1);s.length=l.length}},d(i){i&&c(e),Se(s,i)}}}function Ze(o){let e,t=o[3].tables.length+"",l,s,i=o[3].tables.length===1?"sheet":"sheets",d,n;return{c(){e=v("span"),l=F(t),s=P(),d=F(i),n=F(" available"),this.h()},l(u){e=g(u,"SPAN",{class:!0});var _=h(e);l=O(_,t),s=H(_),d=O(_,i),n=O(_," available"),_.forEach(c),this.h()},h(){a(e,"class","text-gray-500 dark:text-gray-400 text-sm")},m(u,_){W(u,e,_),r(e,l),r(e,s),r(e,d),r(e,n)},p(u,_){_[0]&8&&t!==(t=u[3].tables.length+"")&&z(l,t),_[0]&8&&i!==(i=u[3].tables.length===1?"sheet":"sheets")&&z(d,i)},d(u){u&&c(e)}}}function St(o){let e,t,l=_e(o[3].tables),s=[];for(let i=0;i<l.length;i+=1)s[i]=$e(Je(o,l,i));return{c(){e=v("div"),t=v("div");for(let i=0;i<s.length;i+=1)s[i].c();this.h()},l(i){e=g(i,"DIV",{class:!0});var d=h(e);t=g(d,"DIV",{class:!0});var n=h(t);for(let u=0;u<s.length;u+=1)s[u].l(n);n.forEach(c),d.forEach(c),this.h()},h(){a(t,"class","space-y-2"),a(e,"class","tables-list")},m(i,d){W(i,e,d),r(e,t);for(let n=0;n<s.length;n+=1)s[n]&&s[n].m(t,null)},p(i,d){if(d[0]&524360){l=_e(i[3].tables);let n;for(n=0;n<l.length;n+=1){const u=Je(i,l,n);s[n]?s[n].p(u,d):(s[n]=$e(u),s[n].c(),s[n].m(t,null))}for(;n<s.length;n+=1)s[n].d(1);s.length=l.length}},d(i){i&&c(e),Se(s,i)}}}function Lt(o){let e,t,l=o[13].t("No tables found in this file")+"",s;return{c(){e=v("div"),t=v("p"),s=F(l),this.h()},l(i){e=g(i,"DIV",{class:!0});var d=h(e);t=g(d,"P",{class:!0});var n=h(t);s=O(n,l),n.forEach(c),d.forEach(c),this.h()},h(){a(t,"class","text-gray-500 dark:text-gray-400"),a(e,"class","no-content-message")},m(i,d){W(i,e,d),r(e,t),r(t,s)},p(i,d){d[0]&8192&&l!==(l=i[13].t("No tables found in this file")+"")&&z(s,l)},d(i){i&&c(e)}}}function $e(o){let e,t,l,s=o[43].table_name+"",i,d,n,u=o[43].row_count+"",_,w,T,b,m,S;function k(){return o[27](o[43])}return{c(){e=v("div"),t=v("div"),l=v("span"),i=F(s),d=P(),n=v("span"),_=F(u),w=F(" rows"),T=P(),this.h()},l(E){e=g(E,"DIV",{class:!0});var V=h(e);t=g(V,"DIV",{class:!0});var B=h(t);l=g(B,"SPAN",{class:!0});var I=h(l);i=O(I,s),I.forEach(c),d=H(B),n=g(B,"SPAN",{class:!0});var C=h(n);_=O(C,u),w=O(C," rows"),C.forEach(c),B.forEach(c),T=H(V),V.forEach(c),this.h()},h(){a(l,"class","text-md text-gray-800 dark:text-gray-200"),a(n,"class","text-sm text-gray-500 dark:text-gray-400"),a(t,"class","flex justify-between items-center w-full"),a(e,"class",b="table-item "+(o[6]&&o[6].table_name===o[43].table_name?"selected":"")+" svelte-1310t73")},m(E,V){W(E,e,V),r(e,t),r(t,l),r(l,i),r(t,d),r(t,n),r(n,_),r(n,w),r(e,T),m||(S=ue(e,"click",k),m=!0)},p(E,V){o=E,V[0]&8&&s!==(s=o[43].table_name+"")&&z(i,s),V[0]&8&&u!==(u=o[43].row_count+"")&&z(_,u),V[0]&72&&b!==(b="table-item "+(o[6]&&o[6].table_name===o[43].table_name?"selected":"")+" svelte-1310t73")&&a(e,"class",b)},d(E){E&&c(e),m=!1,S()}}}function Ct(o){let e,t,l,s,i,d,n,u=o[13].t("Filename")+"",_,w,T,b=o[13].t("Upload Date")+"",m,S,k,E=o[13].t("Tables")+"",V,B,I,C=o[13].t("Actions")+"",D,L,p,f=[],A=new Map,x=_e(o[12]);const q=j=>j[40].id;for(let j=0;j<x.length;j+=1){let M=We(o,x,j),Y=q(M);A.set(Y,f[j]=et(Y,M))}return{c(){e=v("div"),t=v("table"),l=v("thead"),s=v("tr"),i=v("th"),d=P(),n=v("th"),_=F(u),w=P(),T=v("th"),m=F(b),S=P(),k=v("th"),V=F(E),B=P(),I=v("th"),D=F(C),L=P(),p=v("tbody");for(let j=0;j<f.length;j+=1)f[j].c();this.h()},l(j){e=g(j,"DIV",{class:!0});var M=h(e);t=g(M,"TABLE",{class:!0});var Y=h(t);l=g(Y,"THEAD",{});var R=h(l);s=g(R,"TR",{class:!0});var N=h(s);i=g(N,"TH",{class:!0}),h(i).forEach(c),d=H(N),n=g(N,"TH",{class:!0});var U=h(n);_=O(U,u),U.forEach(c),w=H(N),T=g(N,"TH",{class:!0});var X=h(T);m=O(X,b),X.forEach(c),S=H(N),k=g(N,"TH",{class:!0});var J=h(k);V=O(J,E),J.forEach(c),B=H(N),I=g(N,"TH",{class:!0});var ae=h(I);D=O(ae,C),ae.forEach(c),N.forEach(c),R.forEach(c),L=H(Y),p=g(Y,"TBODY",{class:!0});var re=h(p);for(let ee=0;ee<f.length;ee+=1)f[ee].l(re);re.forEach(c),Y.forEach(c),M.forEach(c),this.h()},h(){a(i,"class","py-3 px-4 text-left"),a(n,"class","py-3 px-4 text-left"),a(T,"class","py-3 px-4 text-left"),a(k,"class","py-3 px-4 text-left"),a(I,"class","py-3 px-4 text-left"),a(s,"class","border-b border-gray-200 dark:border-gray-700"),a(p,"class","svelte-1310t73"),a(t,"class","w-full"),a(e,"class","file-list")},m(j,M){W(j,e,M),r(e,t),r(t,l),r(l,s),r(s,i),r(s,d),r(s,n),r(n,_),r(s,w),r(s,T),r(T,m),r(s,S),r(s,k),r(k,V),r(s,B),r(s,I),r(I,D),r(t,L),r(t,p);for(let Y=0;Y<f.length;Y+=1)f[Y]&&f[Y].m(p,null)},p(j,M){M[0]&8192&&u!==(u=j[13].t("Filename")+"")&&z(_,u),M[0]&8192&&b!==(b=j[13].t("Upload Date")+"")&&z(m,b),M[0]&8192&&E!==(E=j[13].t("Tables")+"")&&z(V,E),M[0]&8192&&C!==(C=j[13].t("Actions")+"")&&z(D,C),M[0]&397312&&(x=_e(j[12]),f=gt(f,M,q,1,j,x,A,p,pt,et,null,We))},i:he,o:he,d(j){j&&c(e);for(let M=0;M<f.length;M+=1)f[M].d()}}}function It(o){let e,t,l,s,i,d=o[13].t("No files match your search")+"",n,u,_,w=o[13].t("Try a different search term or clear your search")+"",T;return{c(){e=v("div"),t=te("svg"),l=te("path"),s=P(),i=v("h3"),n=F(d),u=P(),_=v("p"),T=F(w),this.h()},l(b){e=g(b,"DIV",{class:!0});var m=h(e);t=le(m,"svg",{xmlns:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0,class:!0});var S=h(t);l=le(S,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),h(l).forEach(c),S.forEach(c),s=H(m),i=g(m,"H3",{class:!0});var k=h(i);n=O(k,d),k.forEach(c),u=H(m),_=g(m,"P",{class:!0});var E=h(_);T=O(E,w),E.forEach(c),m.forEach(c),this.h()},h(){a(l,"stroke-linecap","round"),a(l,"stroke-linejoin","round"),a(l,"d","M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"),a(t,"xmlns","http://www.w3.org/2000/svg"),a(t,"viewBox","0 0 24 24"),a(t,"fill","none"),a(t,"stroke","currentColor"),a(t,"stroke-width","2"),a(t,"class","w-16 h-16 mx-auto mb-4 text-gray-400"),a(i,"class","text-xl font-medium text-gray-700 dark:text-gray-300 mb-2"),a(_,"class","text-gray-500 dark:text-gray-400"),a(e,"class","empty-state svelte-1310t73")},m(b,m){W(b,e,m),r(e,t),r(t,l),r(e,s),r(e,i),r(i,n),r(e,u),r(e,_),r(_,T)},p(b,m){m[0]&8192&&d!==(d=b[13].t("No files match your search")+"")&&z(n,d),m[0]&8192&&w!==(w=b[13].t("Try a different search term or clear your search")+"")&&z(T,w)},i:he,o:he,d(b){b&&c(e)}}}function Vt(o){let e,t,l,s,i,d=o[13].t("No Excel files have been uploaded yet")+"",n,u,_,w=o[13].t("Upload Excel files using the Excel File Handler to see them here")+"",T;return{c(){e=v("div"),t=te("svg"),l=te("path"),s=P(),i=v("h3"),n=F(d),u=P(),_=v("p"),T=F(w),this.h()},l(b){e=g(b,"DIV",{class:!0});var m=h(e);t=le(m,"svg",{xmlns:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0,class:!0});var S=h(t);l=le(S,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),h(l).forEach(c),S.forEach(c),s=H(m),i=g(m,"H3",{class:!0});var k=h(i);n=O(k,d),k.forEach(c),u=H(m),_=g(m,"P",{class:!0});var E=h(_);T=O(E,w),E.forEach(c),m.forEach(c),this.h()},h(){a(l,"stroke-linecap","round"),a(l,"stroke-linejoin","round"),a(l,"d","M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"),a(t,"xmlns","http://www.w3.org/2000/svg"),a(t,"viewBox","0 0 24 24"),a(t,"fill","none"),a(t,"stroke","currentColor"),a(t,"stroke-width","2"),a(t,"class","w-16 h-16 mx-auto mb-4 text-gray-400"),a(i,"class","text-xl font-medium text-gray-700 dark:text-gray-300 mb-2"),a(_,"class","text-gray-500 dark:text-gray-400"),a(e,"class","empty-state svelte-1310t73")},m(b,m){W(b,e,m),r(e,t),r(t,l),r(e,s),r(e,i),r(i,n),r(e,u),r(e,_),r(_,T)},p(b,m){m[0]&8192&&d!==(d=b[13].t("No Excel files have been uploaded yet")+"")&&z(n,d),m[0]&8192&&w!==(w=b[13].t("Upload Excel files using the Excel File Handler to see them here")+"")&&z(T,w)},i:he,o:he,d(b){b&&c(e)}}}function Qt(o){let e,t,l,s,i=o[13].t("Loading files...")+"",d,n;return t=new it({props:{className:"w-10 h-10"}}),{c(){e=v("div"),at(t.$$.fragment),l=P(),s=v("span"),d=F(i),this.h()},l(u){e=g(u,"DIV",{class:!0});var _=h(e);rt(t.$$.fragment,_),l=H(_),s=g(_,"SPAN",{class:!0});var w=h(s);d=O(w,i),w.forEach(c),_.forEach(c),this.h()},h(){a(s,"class","ml-4 text-gray-600 dark:text-gray-400"),a(e,"class","flex justify-center items-center h-64")},m(u,_){W(u,e,_),ot(t,e,null),r(e,l),r(e,s),r(s,d),n=!0},p(u,_){(!n||_[0]&8192)&&i!==(i=u[13].t("Loading files...")+"")&&z(d,i)},i(u){n||(ge(t.$$.fragment,u),n=!0)},o(u){ve(t.$$.fragment,u),n=!1},d(u){u&&c(e),nt(t)}}}function At(o){let e,t;return{c(){e=te("svg"),t=te("path"),this.h()},l(l){e=le(l,"svg",{xmlns:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0,class:!0});var s=h(e);t=le(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),h(t).forEach(c),s.forEach(c),this.h()},h(){a(t,"stroke-linecap","round"),a(t,"stroke-linejoin","round"),a(t,"d","M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"),a(e,"xmlns","http://www.w3.org/2000/svg"),a(e,"viewBox","0 0 24 24"),a(e,"fill","none"),a(e,"stroke","currentColor"),a(e,"stroke-width","2"),a(e,"class","w-6 h-6 text-gray-500")},m(l,s){W(l,e,s),r(e,t)},d(l){l&&c(e)}}}function Bt(o){let e,t;return{c(){e=te("svg"),t=te("path"),this.h()},l(l){e=le(l,"svg",{xmlns:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0,class:!0});var s=h(e);t=le(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),h(t).forEach(c),s.forEach(c),this.h()},h(){a(t,"stroke-linecap","round"),a(t,"stroke-linejoin","round"),a(t,"d","M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"),a(e,"xmlns","http://www.w3.org/2000/svg"),a(e,"viewBox","0 0 24 24"),a(e,"fill","none"),a(e,"stroke","currentColor"),a(e,"stroke-width","2"),a(e,"class","w-6 h-6 text-blue-600")},m(l,s){W(l,e,s),r(e,t)},d(l){l&&c(e)}}}function Pt(o){let e,t;return{c(){e=te("svg"),t=te("path"),this.h()},l(l){e=le(l,"svg",{xmlns:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0,class:!0});var s=h(e);t=le(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),h(t).forEach(c),s.forEach(c),this.h()},h(){a(t,"stroke-linecap","round"),a(t,"stroke-linejoin","round"),a(t,"d","M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"),a(e,"xmlns","http://www.w3.org/2000/svg"),a(e,"viewBox","0 0 24 24"),a(e,"fill","none"),a(e,"stroke","currentColor"),a(e,"stroke-width","2"),a(e,"class","w-6 h-6 text-green-600")},m(l,s){W(l,e,s),r(e,t)},d(l){l&&c(e)}}}function et(o,e){let t,l,s,i,d,n,u=e[40].name+"",_,w,T,b=e[40].dateUploaded+"",m,S,k,E=e[40].tableCount+"",V,B,I,C,D,L='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z"></path><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>',p,f,A='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"></path></svg>',x,q,j;function M(X,J){return J[0]&4096&&(s=null),J[0]&4096&&(i=null),s==null&&(s=lt(X[40].name)==="SpreadsheetDocument"),s?Pt:(i==null&&(i=lt(X[40].name)==="TextDocument"),i?Bt:At)}let Y=M(e,[-1,-1]),R=Y(e);function N(){return e[24](e[40])}function U(){return e[25](e[40])}return{key:o,first:null,c(){t=v("tr"),l=v("td"),R.c(),d=P(),n=v("td"),_=F(u),w=P(),T=v("td"),m=F(b),S=P(),k=v("td"),V=F(E),B=P(),I=v("td"),C=v("div"),D=v("button"),D.innerHTML=L,p=P(),f=v("button"),f.innerHTML=A,x=P(),this.h()},l(X){t=g(X,"TR",{class:!0});var J=h(t);l=g(J,"TD",{class:!0});var ae=h(l);R.l(ae),ae.forEach(c),d=H(J),n=g(J,"TD",{class:!0});var re=h(n);_=O(re,u),re.forEach(c),w=H(J),T=g(J,"TD",{class:!0});var ee=h(T);m=O(ee,b),ee.forEach(c),S=H(J),k=g(J,"TD",{class:!0});var ne=h(k);V=O(ne,E),ne.forEach(c),B=H(J),I=g(J,"TD",{class:!0});var ce=h(I);C=g(ce,"DIV",{class:!0});var oe=h(C);D=g(oe,"BUTTON",{class:!0,"data-svelte-h":!0}),be(D)!=="svelte-f80i9f"&&(D.innerHTML=L),p=H(oe),f=g(oe,"BUTTON",{class:!0,"data-svelte-h":!0}),be(f)!=="svelte-17mkl9c"&&(f.innerHTML=A),oe.forEach(c),ce.forEach(c),x=H(J),J.forEach(c),this.h()},h(){a(l,"class","py-3 px-4"),a(n,"class","py-3 px-4 font-medium text-blue-600 dark:text-blue-400"),a(T,"class","py-3 px-4"),a(k,"class","py-3 px-4"),a(D,"class","p-2 rounded-lg text-blue-600 hover:bg-blue-50 dark:hover:bg-gray-700"),a(f,"class","p-2 rounded-lg text-red-600 hover:bg-red-50 dark:hover:bg-gray-700"),a(C,"class","flex space-x-2"),a(I,"class","py-3 px-4"),a(t,"class","border-b border-gray-200 dark:border-gray-800 hover:bg-gray-50 dark:hover:bg-gray-800 svelte-1310t73"),this.first=t},m(X,J){W(X,t,J),r(t,l),R.m(l,null),r(t,d),r(t,n),r(n,_),r(t,w),r(t,T),r(T,m),r(t,S),r(t,k),r(k,V),r(t,B),r(t,I),r(I,C),r(C,D),r(C,p),r(C,f),r(t,x),q||(j=[ue(D,"click",N),ue(f,"click",U)],q=!0)},p(X,J){e=X,Y!==(Y=M(e,J))&&(R.d(1),R=Y(e),R&&(R.c(),R.m(l,null))),J[0]&4096&&u!==(u=e[40].name+"")&&z(_,u),J[0]&4096&&b!==(b=e[40].dateUploaded+"")&&z(m,b),J[0]&4096&&E!==(E=e[40].tableCount+"")&&z(V,E)},d(X){X&&c(t),R.d(),q=!1,st(j)}}}function tt(o){let e,t,l,s=o[11].title+"",i,d,n,u=o[11].message+"",_,w,T,b,m="No",S,k,E="Yes",V,B;return{c(){e=v("div"),t=v("div"),l=v("h3"),i=F(s),d=P(),n=v("p"),_=F(u),w=P(),T=v("div"),b=v("button"),b.textContent=m,S=P(),k=v("button"),k.textContent=E,this.h()},l(I){e=g(I,"DIV",{class:!0});var C=h(e);t=g(C,"DIV",{class:!0});var D=h(t);l=g(D,"H3",{class:!0});var L=h(l);i=O(L,s),L.forEach(c),d=H(D),n=g(D,"P",{class:!0});var p=h(n);_=O(p,u),p.forEach(c),w=H(D),T=g(D,"DIV",{class:!0});var f=h(T);b=g(f,"BUTTON",{class:!0,"data-svelte-h":!0}),be(b)!=="svelte-1qxmt94"&&(b.textContent=m),S=H(f),k=g(f,"BUTTON",{class:!0,"data-svelte-h":!0}),be(k)!=="svelte-1rmf90w"&&(k.textContent=E),f.forEach(c),D.forEach(c),C.forEach(c),this.h()},h(){a(l,"class","text-xl font-semibold text-gray-900 dark:text-gray-100 mb-4"),a(n,"class","text-gray-700 dark:text-gray-300 mb-6"),a(b,"class","px-4 py-2 rounded-md bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-600 transition"),a(k,"class","px-4 py-2 rounded-md bg-blue-600 text-white hover:bg-blue-700 transition"),a(T,"class","flex justify-end space-x-4"),a(t,"class","bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full p-6"),a(e,"class","fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50")},m(I,C){W(I,e,C),r(e,t),r(t,l),r(l,i),r(t,d),r(t,n),r(n,_),r(t,w),r(t,T),r(T,b),r(T,S),r(T,k),V||(B=[ue(b,"click",function(){Be(o[11].onCancel)&&o[11].onCancel.apply(this,arguments)}),ue(k,"click",function(){Be(o[11].onConfirm)&&o[11].onConfirm.apply(this,arguments)})],V=!0)},p(I,C){o=I,C[0]&2048&&s!==(s=o[11].title+"")&&z(i,s),C[0]&2048&&u!==(u=o[11].message+"")&&z(_,u)},d(I){I&&c(e),V=!1,st(B)}}}function Ht(o){let e,t,l,s,i,d=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5L8.25 12l7.5-7.5"></path></svg>
          Back`,n,u,_=o[13].t("Excel To SQL Management")+"",w,T,b,m,S,k,E,V=o[13].t("Refresh")+"",B,I,C,D,L,p,f,A,x,q;const j=[kt,mt],M=[];function Y(N,U){return N[3]?1:0}D=Y(o),L=M[D]=j[D](o);let R=o[10]&&tt(o);return{c(){e=v("div"),t=v("div"),l=v("div"),s=v("div"),i=v("a"),i.innerHTML=d,n=P(),u=v("h2"),w=F(_),T=P(),b=v("button"),m=te("svg"),S=te("path"),k=P(),E=v("span"),B=F(V),I=P(),C=v("div"),L.c(),p=P(),R&&R.c(),f=Oe(),this.h()},l(N){e=g(N,"DIV",{class:!0});var U=h(e);t=g(U,"DIV",{class:!0});var X=h(t);l=g(X,"DIV",{class:!0});var J=h(l);s=g(J,"DIV",{class:!0});var ae=h(s);i=g(ae,"A",{href:!0,class:!0,"data-svelte-h":!0}),be(i)!=="svelte-bddq2y"&&(i.innerHTML=d),n=H(ae),u=g(ae,"H2",{class:!0});var re=h(u);w=O(re,_),re.forEach(c),ae.forEach(c),T=H(J),b=g(J,"BUTTON",{class:!0});var ee=h(b);m=le(ee,"svg",{xmlns:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0,class:!0});var ne=h(m);S=le(ne,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),h(S).forEach(c),ne.forEach(c),k=H(ee),E=g(ee,"SPAN",{});var ce=h(E);B=O(ce,V),ce.forEach(c),ee.forEach(c),J.forEach(c),X.forEach(c),I=H(U),C=g(U,"DIV",{class:!0});var oe=h(C);L.l(oe),oe.forEach(c),U.forEach(c),p=H(N),R&&R.l(N),f=Oe(),this.h()},h(){a(i,"href","/"),a(i,"class","back-button svelte-1310t73"),a(u,"class","header-title svelte-1310t73"),a(s,"class","header-left svelte-1310t73"),a(S,"stroke-linecap","round"),a(S,"stroke-linejoin","round"),a(S,"d","M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"),a(m,"xmlns","http://www.w3.org/2000/svg"),a(m,"viewBox","0 0 24 24"),a(m,"fill","none"),a(m,"stroke","currentColor"),a(m,"stroke-width","2"),a(m,"class","w-5 h-5"),a(b,"class","flex items-center space-x-2 px-3 py-2 rounded-lg bg-blue-600 hover:bg-blue-700 transition"),a(l,"class","header-title-row svelte-1310t73"),a(t,"class","management-header bg-gray-900 dark:bg-gray-950 text-white svelte-1310t73"),a(C,"class","management-content bg-white dark:bg-gray-900 svelte-1310t73"),a(e,"class","excel-management-container svelte-1310t73")},m(N,U){W(N,e,U),r(e,t),r(t,l),r(l,s),r(s,i),r(s,n),r(s,u),r(u,w),r(l,T),r(l,b),r(b,m),r(m,S),r(b,k),r(b,E),r(E,B),r(e,I),r(e,C),M[D].m(C,null),W(N,p,U),R&&R.m(N,U),W(N,f,U),A=!0,x||(q=ue(b,"click",o[15]),x=!0)},p(N,U){(!A||U[0]&8192)&&_!==(_=N[13].t("Excel To SQL Management")+"")&&z(w,_),(!A||U[0]&8192)&&V!==(V=N[13].t("Refresh")+"")&&z(B,V);let X=D;D=Y(N),D===X?M[D].p(N,U):(Ce(),ve(M[X],1,1,()=>{M[X]=null}),Le(),L=M[D],L?L.p(N,U):(L=M[D]=j[D](N),L.c()),ge(L,1),L.m(C,null)),N[10]?R?R.p(N,U):(R=tt(N),R.c(),R.m(f.parentNode,f)):R&&(R.d(1),R=null)},i(N){A||(ge(L),A=!0)},o(N){ve(L),A=!1},d(N){N&&(c(e),c(p),c(f)),M[D].d(),R&&R.d(N),x=!1,q()}}}function lt(o){return o.endsWith(".xlsx")||o.endsWith(".xls")?"SpreadsheetDocument":o.endsWith(".csv")?"TextDocument":"Page"}function Nt(o,e,t){let l,s;const i=ut("i18n");dt(o,i,y=>t(13,s=y));let d=!0,n=[],u=null,_={},w={},T="",b=null,m={},S=[],k=!1,E=!1,V="http://localhost:5002",B="token_59b8b43a_aiurmmm0",I="en",C=!1,D={title:"",message:"",onConfirm:()=>{},onCancel:()=>{}};ft(async()=>{try{console.log("Loading API configuration...");const y=await bt(i);V=V,B=y.userToken||B,I=y.languageLocal||I,console.log("Excel-to-SQL page - API Config loaded:",{base_url:V,language_local:I,user_token:B})}catch(y){console.error("Error loading API configuration:",y)}await p()});async function L(y,Q={}){const se=`http://localhost:5002${y}`;console.log(`[ExcelToSQL Debug] Request to: ${y}`,{options:Q});const pe={method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${B}`,"Accept-Language":I}},me={...pe,...Q,headers:{...pe.headers,...Q.headers||{}}};console.log("[ExcelToSQL Debug] Full request options:",me);try{console.log(`[ExcelToSQL Debug] Sending request to ${se}`);const de=await fetch(se,me),$=await de.json();if(console.log("[ExcelToSQL Debug] RAW API RESPONSE:",JSON.stringify($,null,2)),console.log(`[ExcelToSQL Debug] Response status: ${de.status}`,$),!de.ok)throw console.error(`[ExcelToSQL Debug] Request failed with status ${de.status}:`,$),new Error($.error||"An error occurred");return $}catch(de){throw console.error("[ExcelToSQL Debug] API request failed:",de),de}}async function p(){console.log("[ExcelToSQL Debug] Loading files list"),t(2,d=!0);try{const y=await L("/api/excel_to_sql/list_files");if(console.log("[ExcelToSQL Debug] Files loaded:",y),y.success&&y.files){console.log("[ExcelToSQL Debug] LIST_FILES SUCCESS - File count:",y.files.length),console.log("[ExcelToSQL Debug] LIST_FILES DETAILED:",JSON.stringify(y.files,null,2));const Q=y.files.map((G,se)=>({key:se.toString(),id:G.id||se.toString(),name:G.original_filename,savedPath:G.saved_path,dateUploaded:new Date(G.created_at||Date.now()).toLocaleString(),tableCount:(G.tables||[]).length,tables:G.tables||[],mappingId:G.mapping_id}));console.log("[ExcelToSQL Debug] Formatted files:",Q),t(0,n=Q)}else console.error("[ExcelToSQL Debug] Failed to load files:",y),ie.error("Failed to load Excel files")}catch(y){console.error("[ExcelToSQL Debug] Error loading Excel files:",y),ie.error(`Error loading Excel files: ${y.message}`),t(0,n=[])}finally{t(2,d=!1)}}function f(y,Q,G){t(11,D={title:y,message:Q,onConfirm:()=>{G(),t(10,C=!1)},onCancel:()=>{t(10,C=!1)}}),t(10,C=!0)}async function A(y){console.log("[ExcelToSQL Debug] Attempting to delete file:",y),f("Delete File",`Are you sure you want to delete the file "${y.name}"?`,async()=>{t(2,d=!0);try{console.log("[ExcelToSQL Debug] Confirmed file deletion for:",y.savedPath);const Q=await L("/api/excel_to_sql/delete_file",{method:"POST",body:JSON.stringify({file_path:y.savedPath})});console.log("[ExcelToSQL Debug] Delete file response:",Q),Q.success?(ie.success(`File "${y.name}" deleted successfully`),console.log("[ExcelToSQL Debug] File deleted successfully, reloading file list"),await p(),u&&u.id===y.id&&(console.log("[ExcelToSQL Debug] Clearing selected file as it was deleted"),t(3,u=null))):(console.error("[ExcelToSQL Debug] Failed to delete file:",Q.error),ie.error(`Failed to delete file: ${Q.error}`))}catch(Q){console.error("[ExcelToSQL Debug] Error deleting file:",Q),ie.error(`Error deleting file: ${Q.message}`)}finally{t(2,d=!1)}})}function x(y){console.log("[ExcelToSQL Debug] Viewing file details:",y),t(3,u=y),t(4,_={}),t(5,w={}),t(6,b=null),m={},t(9,E=!1),t(8,k=!1)}async function q(y){console.log("[ExcelToSQL Debug] Loading table data for:",y.table_name),t(6,b=y),t(5,w[y.table_name]=!0,w),t(9,E=!1),t(8,k=!1);try{const Q=await L("/api/excel_to_sql/get_table_data",{method:"POST",body:JSON.stringify({table_name:y.table_name})});if(console.log("[ExcelToSQL Debug] Table data response:",Q),Q.success){console.log("[ExcelToSQL Debug] Table data loaded successfully:",Q.data),t(4,_[y.table_name]=Q.data||{},_);const G={};Q.data&&Q.data.rows&&Q.data.rows.forEach((se,pe)=>{G[pe]={...se}}),m=G,Q.data&&Q.data.columns&&(t(7,S=Q.data.columns.map(se=>se.name)),console.log("[ExcelToSQL Debug] Selected columns:",S))}else console.error("[ExcelToSQL Debug] Failed to load table data:",Q.error),ie.error(`Failed to load table data: ${Q.error}`)}catch(Q){console.error("[ExcelToSQL Debug] Error loading table data:",Q),ie.error(`Error loading table data: ${Q.message}`)}finally{t(5,w[y.table_name]=!1,w)}}function j(y,Q,G){console.log(`[ExcelToSQL Debug] Editing cell: row ${y}, column ${Q}, value:`,G),m[y]={...m[y],[Q]:G},t(8,k=!0)}async function M(){if(b){console.log("[ExcelToSQL Debug] Saving edited data for table:",b.table_name);try{t(2,d=!0);const y=Object.values(m);console.log("[ExcelToSQL Debug] Rows to save:",y),console.log("[ExcelToSQL Debug] Columns to include:",S);const Q={table_name:b.table_name,rows:y,columns:S};console.log("[ExcelToSQL Debug] Save request payload:",Q);const G=await L("/api/excel_to_sql/update_table_data",{method:"POST",body:JSON.stringify(Q)});console.log("[ExcelToSQL Debug] Save response:",G),G.success?(console.log("[ExcelToSQL Debug] Data saved successfully"),ie.success(`Successfully saved changes to ${b.table_name}`),t(8,k=!1),console.log("[ExcelToSQL Debug] Reloading table data after save"),await q(b),t(9,E=!1)):(console.error("[ExcelToSQL Debug] Failed to save changes:",G.error),ie.error(`Failed to save changes: ${G.error}`))}catch(y){console.error("[ExcelToSQL Debug] Error saving data:",y),ie.error(`Error saving data: ${y.message}`)}finally{t(2,d=!1)}}}async function Y(y){console.log("[ExcelToSQL Debug] Requesting to delete table:",y.table_name),f("Delete Table",`Are you sure you want to delete the table "${y.table_name}"?`,async()=>{try{console.log("[ExcelToSQL Debug] Confirmed table deletion for:",y.table_name);const Q=await L("/api/excel_to_sql/delete_table",{method:"POST",body:JSON.stringify({table_name:y.table_name})});if(console.log("[ExcelToSQL Debug] Delete table response:",Q),Q.success){if(console.log("[ExcelToSQL Debug] Table deleted successfully"),ie.success(`Table "${y.table_name}" deleted successfully`),u){const G=u.tables.filter(se=>se.table_name!==y.table_name);console.log("[ExcelToSQL Debug] Updated tables list after deletion:",G),t(3,u={...u,tables:G,tableCount:G.length}),b&&b.table_name===y.table_name&&(console.log("[ExcelToSQL Debug] Clearing selected table as it was deleted"),t(6,b=null))}}else console.error("[ExcelToSQL Debug] Failed to delete table:",Q.error),ie.error(`Failed to delete table: ${Q.error}`)}catch(Q){console.error("[ExcelToSQL Debug] Error deleting table:",Q),ie.error(`Error deleting table: ${Q.message}`)}})}function R(){T=this.value,t(1,T)}const N=y=>x(y),U=y=>A(y),X=()=>{b?(t(6,b=null),t(9,E=!1)):t(3,u=null)},J=y=>q(y),ae=()=>Y(b),re=()=>t(9,E=!0),ee=()=>{f("Cancel Editing","Are you sure you want to cancel? All unsaved changes will be lost.",()=>{t(9,E=!1),q(b)})},ne=y=>S.includes(y.name),ce=y=>S.includes(y.name),oe=(y,Q,G)=>{E&&j(y,Q.name,G.target.innerText)};return o.$$.update=()=>{o.$$.dirty[0]&3&&t(12,l=n.filter(y=>T===""||y.name.toLowerCase().includes(T.toLowerCase())))},[n,T,d,u,_,w,b,S,k,E,C,D,l,s,i,p,f,A,x,q,j,M,Y,R,N,U,X,J,ae,re,ee,ne,ce,oe]}class zt extends _t{constructor(e){super(),vt(this,e,Nt,Ht,ct,{},null,[-1,-1])}}export{zt as component};
//# sourceMappingURL=19.BKBn4df4.js.map
