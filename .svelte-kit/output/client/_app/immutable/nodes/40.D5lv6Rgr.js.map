{"version":3,"file":"40.D5lv6Rgr.js","sources":["../../../../../../src/routes/excel-viewer/+page.svelte"],"sourcesContent":["<script lang=\"ts\">\n    import { onMount } from 'svelte';\n    import { WEBUI_API_BASE_URL } from '$lib/constants';\n    import ExcelViewer from '$lib/components/common/ExcelViewer.svelte';\n    \n    let fileId: string;\n    let fileName: string;\n    let loading = true;\n    let error = null;\n\n    onMount(() => {\n        const urlParams = new URLSearchParams(window.location.search);\n        fileId = urlParams.get('fileId');\n        fileName = urlParams.get('fileName');\n        \n        loading = false;\n        \n        if (!fileId) {\n            error = 'No file ID provided';\n        }\n        \n        // 设置页面标题\n        if (fileName) {\n            document.title = `${fileName} - Excel Viewer`;\n        } else {\n            document.title = 'Excel Viewer';\n        }\n    });\n</script>\n\n<div class=\"flex flex-col h-screen bg-gray-50 dark:bg-gray-900\">\n    <header class=\"p-4 border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800\">\n        <div class=\"flex items-center justify-between\">\n            <h1 class=\"text-xl font-semibold text-gray-900 dark:text-white\">\n                {fileName || 'Excel Viewer'}\n            </h1>\n            \n        </div>\n    </header>\n    \n    <main class=\"flex-1 p-4 overflow-auto\">\n        {#if loading}\n            <div class=\"flex items-center justify-center h-full\">\n                <div class=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500\"></div>\n            </div>\n        {:else if error}\n            <div class=\"flex items-center justify-center h-full\">\n                <div class=\"text-red-500\">{error}</div>\n            </div>\n        {:else if fileId}\n            <ExcelViewer \n                src={`${WEBUI_API_BASE_URL}/files/${fileId}/content`}\n                fileName={fileName || ''}\n                editable={true}\n            />\n        {/if}\n    </main>\n</div>"],"names":["WEBUI_API_BASE_URL","ctx","dirty","excelviewer_changes","insert_hydration","target","div1","anchor","append_hydration","div0","t0_value","header","h1","main","current","set_data","t0","fileId","fileName","loading","error","onMount","urlParams"],"mappings":"wXAmDwB,IAAA,GAAAA,CAAkB,UAAUC,EAAM,CAAA,CAAA,WAChC,SAAAA,MAAY,YACZ,8FAFFC,EAAA,IAAAC,EAAA,IAAA,GAAAH,CAAkB,UAAUC,EAAM,CAAA,CAAA,YAChCC,EAAA,IAAAC,EAAA,SAAAF,MAAY,2JALKA,EAAK,CAAA,CAAA,6FAALA,EAAK,CAAA,CAAA,qIADpCG,EAEKC,EAAAC,EAAAC,CAAA,EADDC,EAAsCF,EAAAG,CAAA,0BAAXR,EAAK,CAAA,CAAA,mWALpCG,EAEKC,EAAAC,EAAAC,CAAA,wDAVAG,GAAAT,MAAY,gBAAc,2DAO9BA,EAAO,CAAA,EAAA,EAIFA,EAAK,CAAA,EAAA,EAILA,EAAM,CAAA,EAAA,uuBAnBxBG,EA2BKC,EAAAC,EAAAC,CAAA,EA1BDC,EAOQF,EAAAK,CAAA,EANJH,EAKKG,EAAAF,CAAA,EAJDD,EAEIC,EAAAG,CAAA,gBAKZJ,EAgBMF,EAAAO,CAAA,qCAtBO,CAAAC,GAAAZ,EAAA,IAAAQ,KAAAA,GAAAT,MAAY,gBAAc,KAAAc,EAAAC,EAAAN,CAAA,8OA7BnC,IAAAO,EACAC,EACAC,EAAU,GACVC,EAAQ,KAEZ,OAAAC,EAAA,IAAA,OACUC,EAAgB,IAAA,gBAAgB,OAAO,SAAS,MAAM,MAC5DL,EAASK,EAAU,IAAI,QAAQ,CAAA,MAC/BJ,EAAWI,EAAU,IAAI,UAAU,CAAA,MAEnCH,EAAU,EAAA,EAELF,OACDG,EAAQ,qBAAA,EAIRF,EACA,SAAS,SAAWA,CAAQ,kBAE5B,SAAS,MAAQ"}