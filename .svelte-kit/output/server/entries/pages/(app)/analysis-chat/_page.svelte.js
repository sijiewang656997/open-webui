import { o as onDestroy, c as create_ssr_component, i as spread, a as add_attribute, k as escape_object, e as each, f as escape, v as validate_component, q as is_promise, n as noop } from "../../../../chunks/ssr.js";
import "../../../../chunks/client.js";
import "../../../../chunks/index3.js";
import "../../../../chunks/index4.js";
import { Chart as Chart$1, LineController, LineElement, PointElement, LinearScale, Title, CategoryScale, Tooltip, Legend } from "chart.js";
import { T as Table } from "../../../../chunks/Table.js";
import "pizzip";
import "docxtemplater";
import "file-saver";
const eventPrefix = /^on/;
const events = [];
Object.keys(globalThis).forEach((key) => {
  if (eventPrefix.test(key)) {
    events.push(key.replace(eventPrefix, ""));
  }
});
function useForwardEvents(getRef) {
  const destructors = [];
  onDestroy(() => {
    while (destructors.length) {
      destructors.pop()();
    }
  });
}
function clean(props2) {
  let { data: data2, type: type2, options: options2, plugins: plugins2, children, $$scope, $$slots, ...rest } = props2;
  return rest;
}
const Chart = create_ssr_component(($$result, $$props, $$bindings, slots) => {
  let { type } = $$props;
  let { data = { datasets: [] } } = $$props;
  let { options = {} } = $$props;
  let { plugins = [] } = $$props;
  let { updateMode = void 0 } = $$props;
  let { chart = null } = $$props;
  let canvasRef;
  let props = clean($$props);
  onDestroy(() => {
    if (chart) chart.destroy();
    chart = null;
  });
  useForwardEvents();
  if ($$props.type === void 0 && $$bindings.type && type !== void 0) $$bindings.type(type);
  if ($$props.data === void 0 && $$bindings.data && data !== void 0) $$bindings.data(data);
  if ($$props.options === void 0 && $$bindings.options && options !== void 0) $$bindings.options(options);
  if ($$props.plugins === void 0 && $$bindings.plugins && plugins !== void 0) $$bindings.plugins(plugins);
  if ($$props.updateMode === void 0 && $$bindings.updateMode && updateMode !== void 0) $$bindings.updateMode(updateMode);
  if ($$props.chart === void 0 && $$bindings.chart && chart !== void 0) $$bindings.chart(chart);
  return `<canvas${spread([escape_object(props)], {})}${add_attribute("this", canvasRef, 0)}></canvas>`;
});
const css = {
  code: ".table-improved{width:calc(100% + 1rem) !important;max-width:none !important;margin-left:-0.5rem;margin-right:-0.5rem}.table-improved thead{background-color:#e8f4ff !important}.dark .table-improved thead{background-color:#1e3a5f !important}.table-improved th{font-weight:600;padding:0.75rem 1rem !important}.table-improved td{padding:0.625rem 1rem !important}",
  map: `{"version":3,"file":"+page.svelte","sources":["+page.svelte"],"sourcesContent":["<script lang=\\"ts\\">import { onMount } from \\"svelte\\";\\nimport { goto } from \\"$app/navigation\\";\\nimport { get, writable } from \\"svelte/store\\";\\nimport { user, showSidebar } from \\"$lib/stores\\";\\nimport i18n from \\"$lib/i18n\\";\\nimport { Chart } from \\"svelte-chartjs\\";\\nimport {\\n  Chart as ChartJS,\\n  LineController,\\n  LineElement,\\n  PointElement,\\n  LinearScale,\\n  Title,\\n  CategoryScale,\\n  Tooltip,\\n  Legend\\n} from \\"chart.js\\";\\nimport Table from \\"$lib/components/common/Table.svelte\\";\\nimport { createDocxTemplateReport, downloadDocxDocument } from \\"$lib/utils/docxTemplateUtils\\";\\nimport { WEBUI_BASE_URL } from \\"$lib/constants\\";\\nimport { getApiConfig } from \\"$lib/utils/api-config\\";\\nlet apiConfig = {\\n  baseUrl: WEBUI_BASE_URL,\\n  userToken: \\"\\",\\n  languageLocal: \\"en\\"\\n};\\nChartJS.register(\\n  LineController,\\n  LineElement,\\n  PointElement,\\n  LinearScale,\\n  Title,\\n  CategoryScale,\\n  Tooltip,\\n  Legend\\n);\\nlet messages = [];\\nlet input = \\"\\";\\nlet isLoading = false;\\nlet error = \\"\\";\\nlet isDownloading = false;\\nonMount(async () => {\\n  try {\\n    apiConfig = await getApiConfig(i18n);\\n    console.log(\\"API config initialized:\\", apiConfig);\\n  } catch (error2) {\\n    console.error(\\"Failed to initialize API config:\\", error2);\\n  }\\n});\\nasync function handleSubmit() {\\n  if (!input.trim()) return;\\n  if (!input.startsWith(\\"@analysis\\")) {\\n    error = \\"Please start your message with @analysis\\";\\n    return;\\n  }\\n  console.log(\\"[DEBUG] Submitting input:\\", input);\\n  isLoading = true;\\n  error = \\"\\";\\n  messages = [];\\n  try {\\n    const token = localStorage.getItem(\\"token\\");\\n    if (!token) {\\n      throw new Error(\\"No authentication token found\\");\\n    }\\n    const requestBody = {\\n      conversation_id: \\"analysis_stream\\",\\n      message: input\\n    };\\n    const requestHeaders = {\\n      \\"Content-Type\\": \\"application/json\\",\\n      \\"Authorization\\": \`Bearer \${apiConfig.userToken}\`,\\n      \\"Accept-Language\\": apiConfig.languageLocal\\n    };\\n    console.log(\\"[DEBUG] Sending fetch to proxy/api/analysis/stream\\", requestBody, requestHeaders);\\n    const response = await fetch(\`\${WEBUI_BASE_URL}/proxy/api/analysis/stream\`, {\\n      method: \\"POST\\",\\n      headers: requestHeaders,\\n      body: JSON.stringify(requestBody)\\n    });\\n    console.log(\\"[DEBUG] Response status:\\", response.status);\\n    if (!response.ok) {\\n      throw new Error(\\"Failed to fetch analysis\\");\\n    }\\n    const reader = response.body?.getReader();\\n    if (!reader) throw new Error(\\"No reader available\\");\\n    const decoder = new TextDecoder();\\n    let buffer = \\"\\";\\n    while (true) {\\n      const { done, value } = await reader.read();\\n      if (done) break;\\n      buffer += decoder.decode(value, { stream: true });\\n      const lines = buffer.split(\\"\\\\n\\");\\n      buffer = lines.pop() || \\"\\";\\n      for (const line of lines) {\\n        if (!line.trim()) continue;\\n        console.log(\\"[DEBUG] Received line:\\", line);\\n        try {\\n          const data = JSON.parse(line);\\n          if (data.type === \\"node\\") {\\n            const newMessage = {\\n              role: \\"assistant\\",\\n              content: data.content,\\n              metadata: data.metadata,\\n              results: data.results\\n            };\\n            console.log(\\"[DEBUG] Adding message:\\", newMessage);\\n            messages = [...messages, newMessage];\\n          }\\n        } catch (e) {\\n          console.error(\\"[DEBUG] Error parsing line:\\", e, line);\\n        }\\n      }\\n    }\\n  } catch (e) {\\n    console.error(\\"[DEBUG] Error in handleSubmit:\\", e);\\n    error = e instanceof Error ? e.message : \\"An error occurred\\";\\n  } finally {\\n    isLoading = false;\\n    input = \\"\\";\\n  }\\n}\\nfunction formatChartData(results) {\\n  if (!results || !results.records) return null;\\n  const chartData = {\\n    labels: results.records.map((r) => r[0]),\\n    datasets: [{\\n      label: \\"Value\\",\\n      data: results.records.map((r) => r[1]),\\n      borderColor: \\"rgb(75, 192, 192)\\",\\n      tension: 0.1\\n    }]\\n  };\\n  return chartData;\\n}\\nfunction toTableObjects(columns, records) {\\n  return records.map((row) => {\\n    const obj = {};\\n    columns.forEach((col, i) => {\\n      obj[col] = row[i];\\n    });\\n    return obj;\\n  });\\n}\\nasync function downloadWordReport() {\\n  try {\\n    console.log(\\"[DOCX DEBUG] Starting Word document download with Docxtemplater\\");\\n    isDownloading = true;\\n    const combinedContent = messages.map((message) => {\\n      return message.content.replace(/<[^>]+>/g, \\"\\");\\n    }).join(\\"\\\\n\\\\n\\");\\n    const tableData = messages.find((msg) => msg.results?.columns && msg.results.records)?.results;\\n    const blob = await createDocxTemplateReport(\\n      combinedContent,\\n      \\"Analysis Report\\",\\n      tableData\\n    );\\n    const timestamp = (/* @__PURE__ */ new Date()).toISOString().replace(/[-:.]/g, \\"\\").substring(0, 14);\\n    const filename = \`analysis_report_\${timestamp}.docx\`;\\n    downloadDocxDocument(blob, filename);\\n    console.log(\\"[DOCX DEBUG] Download complete\\");\\n  } catch (error2) {\\n    console.error(\\"[DOCX DEBUG] Error in downloadWordReport:\\", error2);\\n    alert(\\"Failed to download report. Please try again.\\");\\n  } finally {\\n    isDownloading = false;\\n  }\\n}\\nfunction toggleSidebar() {\\n  showSidebar.update((value) => !value);\\n}\\n<\/script>\\n\\n<div class=\\"flex flex-row w-full h-full max-h-[100dvh]\\">\\n\\t<div class=\\"flex-1 flex flex-col h-full\\">\\n\\t\\t<div class=\\"flex items-center justify-between px-4 pt-4 pb-2\\">\\n\\t\\t\\t<div class=\\"flex items-center gap-4\\">\\n\\t\\t\\t\\t<!-- Sidebar Toggle Button -->\\n\\t\\t\\t\\t\\t<button\\n\\t\\t\\t\\t\\t\\tclass=\\"cursor-pointer p-[7px] flex rounded-xl hover:bg-gray-100 dark:hover:bg-gray-900 transition\\"\\n\\t\\t\\t\\t\\t\\ton:click={toggleSidebar}\\n\\t\\t\\t\\t\\t\\taria-label=\\"Toggle Sidebar\\"\\n\\t\\t\\t\\t\\t>\\n\\t\\t\\t\\t\\t\\t<div class=\\"m-auto self-center\\">\\n\\t\\t\\t\\t\\t\\t\\t<svg\\n\\t\\t\\t\\t\\t\\t\\t\\txmlns=\\"http://www.w3.org/2000/svg\\"\\n\\t\\t\\t\\t\\t\\t\\t\\tfill=\\"none\\"\\n\\t\\t\\t\\t\\t\\t\\t\\tviewBox=\\"0 0 24 24\\"\\n\\t\\t\\t\\t\\t\\t\\t\\tstroke-width=\\"2\\"\\n\\t\\t\\t\\t\\t\\t\\t\\tstroke=\\"currentColor\\"\\n\\t\\t\\t\\t\\t\\t\\t\\tclass=\\"size-5\\"\\n\\t\\t\\t\\t\\t\\t\\t>\\n\\t\\t\\t\\t\\t\\t\\t\\t<path\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tstroke-linecap=\\"round\\"\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tstroke-linejoin=\\"round\\"\\n\\t\\t\\t\\t\\t\\t\\t\\t\\td=\\"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25H12\\"\\n\\t\\t\\t\\t\\t\\t\\t\\t/>\\n\\t\\t\\t\\t\\t\\t\\t</svg>\\n\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t</button>\\n\\t\\t\\t\\t<h1 class=\\"text-2xl font-bold\\">Analysis Report</h1>\\n\\t\\t\\t</div>\\n\\n\\t\\t\\t<button \\n\\t\\t\\t\\ton:click={downloadWordReport} \\n\\t\\t\\t\\tclass=\\"px-4 py-2 bg-blue-100 text-blue-700 border border-blue-200 rounded-lg hover:bg-blue-200 dark:bg-blue-800/30 dark:text-blue-300 dark:border-blue-700 dark:hover:bg-blue-700/50 transition flex items-center\\"\\n\\t\\t\\t\\tdisabled={isDownloading || messages.length === 0}\\n\\t\\t\\t>\\n\\t\\t\\t\\t{#if isDownloading}\\n\\t\\t\\t\\t\\t<svg class=\\"animate-spin h-5 w-5 mr-2 text-blue-600 dark:text-blue-400\\" xmlns=\\"http://www.w3.org/2000/svg\\" fill=\\"none\\" viewBox=\\"0 0 24 24\\">\\n\\t\\t\\t\\t\\t\\t<circle class=\\"opacity-25\\" cx=\\"12\\" cy=\\"12\\" r=\\"10\\" stroke=\\"currentColor\\" stroke-width=\\"4\\"></circle>\\n\\t\\t\\t\\t\\t\\t<path class=\\"opacity-75\\" fill=\\"currentColor\\" d=\\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z\\"></path>\\n\\t\\t\\t\\t\\t</svg>\\n\\t\\t\\t\\t\\t<span>Downloading...</span>\\n\\t\\t\\t\\t{:else}\\n\\t\\t\\t\\t\\t<svg xmlns=\\"http://www.w3.org/2000/svg\\" class=\\"h-5 w-5 mr-2 text-blue-600 dark:text-blue-400\\" fill=\\"none\\" viewBox=\\"0 0 24 24\\" stroke=\\"currentColor\\">\\n\\t\\t\\t\\t\\t\\t<path stroke-linecap=\\"round\\" stroke-linejoin=\\"round\\" stroke-width=\\"2\\" d=\\"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4\\" />\\n\\t\\t\\t\\t\\t</svg>\\n\\t\\t\\t\\t\\t<span>Download as Word</span>\\n\\t\\t\\t\\t{/if}\\n\\t\\t\\t</button>\\n\\t\\t</div>\\n\\n\\t\\t<!-- 下面内容保持不变 -->\\n\\t\\t<div class=\\"flex-1 overflow-y-auto p-4 space-y-4\\">\\n\\t\\t\\t{#each messages as message}\\n\\t\\t\\t\\t<div class=\\"bg-white dark:bg-gray-800 rounded-xl p-0 shadow-md overflow-hidden border border-gray-100 dark:border-gray-700 mb-6\\">\\n\\t\\t\\t\\t\\t<!-- 提取并显示标题 -->\\n\\t\\t\\t\\t\\t{#if message.content.match(/\\\\*\\\\*Analysis for - (.*?)\\\\*\\\\*/)}\\n\\t\\t\\t\\t\\t\\t<div class=\\"bg-gray-50 dark:bg-gray-700 px-5 py-3 border-b border-gray-200 dark:border-gray-700\\">\\n\\t\\t\\t\\t\\t\\t\\t<h2 class=\\"text-xl font-bold text-gray-800 dark:text-gray-200\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t{message.content.match(/\\\\*\\\\*Analysis for - (.*?)\\\\*\\\\*/)[1]}\\n\\t\\t\\t\\t\\t\\t\\t</h2>\\n\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t{/if}\\n\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\t<!-- 内容区域 -->\\n\\t\\t\\t\\t\\t<div class=\\"p-0\\">\\n\\t\\t\\t\\t\\t\\t<!-- Summary 部分 -->\\n\\t\\t\\t\\t\\t\\t{#if message.content.includes('**Summary')}\\n\\t\\t\\t\\t\\t\\t\\t<div class=\\"px-4 py-4 border-b border-gray-100 dark:border-gray-700\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t<div class=\\"flex items-start\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t<div class=\\"bg-blue-100 dark:bg-blue-800/30 p-2 rounded-lg mr-3\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t<svg xmlns=\\"http://www.w3.org/2000/svg\\" class=\\"h-5 w-5 text-blue-600 dark:text-blue-400\\" viewBox=\\"0 0 20 20\\" fill=\\"currentColor\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t<path d=\\"M9 2a1 1 0 000 2h2a1 1 0 100-2H9z\\" />\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t<path fill-rule=\\"evenodd\\" d=\\"M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3zm-3 4a1 1 0 100 2h.01a1 1 0 100-2H7zm3 0a1 1 0 100 2h3a1 1 0 100-2h-3z\\" clip-rule=\\"evenodd\\" />\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t</svg>\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t<div class=\\"flex-1\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t<h3 class=\\"font-semibold text-blue-800 dark:text-blue-300 mb-2\\">Summary</h3>\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t<div class=\\"text-gray-700 dark:text-gray-300\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t{#if message.content.match(/\\\\*\\\\*Summary\\\\*\\\\*:?\\\\s*(.*?)(?:\\\\n\\\\n\\\\*\\\\*Trends And Insights|\\\\*\\\\*Trends And Insights)/s)}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t{@html message.content\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t.match(/\\\\*\\\\*Summary\\\\*\\\\*:?\\\\s*(.*?)(?:\\\\n\\\\n\\\\*\\\\*Trends And Insights|\\\\*\\\\*Trends And Insights)/s)[1]\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t.replace(/\\\\*\\\\*(.*?)\\\\*\\\\*/g, '<strong>\\\\$1</strong>')\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t.split(';')\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t.map(line => line.trim())\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t.join('<br>')}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t{/if}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t\\t{/if}\\n\\t\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\t\\t<!-- Trends And Insights 部分 -->\\n\\t\\t\\t\\t\\t\\t{#if message.content.includes('**Trends And Insights')}\\n\\t\\t\\t\\t\\t\\t\\t<div class=\\"bg-purple-50 dark:bg-purple-900/10 px-4 py-4 border-b border-gray-100 dark:border-gray-700\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t<div class=\\"flex items-start\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t<div class=\\"bg-purple-100 dark:bg-purple-800/30 p-2 rounded-lg mr-3\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t<svg xmlns=\\"http://www.w3.org/2000/svg\\" class=\\"h-5 w-5 text-purple-600 dark:text-purple-400\\" viewBox=\\"0 0 20 20\\" fill=\\"currentColor\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t<path fill-rule=\\"evenodd\\" d=\\"M3 3a1 1 0 000 2v8a2 2 0 002 2h2.586l-1.293 1.293a1 1 0 101.414 1.414L10 15.414l2.293 2.293a1 1 0 001.414-1.414L12.414 15H15a2 2 0 002-2V5a1 1 0 100-2H3zm11.707 4.707a1 1 0 00-1.414-1.414L10 9.586 8.707 8.293a1 1 0 00-1.414 0l-2 2a1 1 0 101.414 1.414L8 10.414l1.293 1.293a1 1 0 001.414 0l4-4z\\" clip-rule=\\"evenodd\\" />\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t</svg>\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t<div class=\\"flex-1\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t<h3 class=\\"font-semibold text-purple-800 dark:text-purple-300 mb-2\\">Trends And Insights</h3>\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t<div class=\\"text-gray-700 dark:text-gray-300\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t{#if message.content.match(/\\\\*\\\\*Trends And Insights\\\\*\\\\*:?\\\\s*(.*?)(?:\\\\n\\\\n\\\\*\\\\*Journal Entries|\\\\*\\\\*Journal Entries)/s)}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t<ul class=\\"list-disc pl-5 space-y-2\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t{#each message.content\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t.match(/\\\\*\\\\*Trends And Insights\\\\*\\\\*:?\\\\s*(.*?)(?:\\\\n\\\\n\\\\*\\\\*Journal Entries|\\\\*\\\\*Journal Entries)/s)[1]\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t.replace(/^\\\\*\\\\s*/, '')\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t.split(/;\\\\s*|\\\\n\\\\*\\\\s*/)\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t.filter(item => item.trim()) as item}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t<li>{@html item.replace(/\\\\*\\\\*(.*?)\\\\*\\\\*/g, '<strong>\\\\$1</strong>')}</li>\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t{/each}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t</ul>\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t{/if}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t\\t{/if}\\n\\t\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\t\\t<!-- Journal Entries Analysis 部分 -->\\n\\t\\t\\t\\t\\t\\t{#if message.content.includes('**Journal Entries Analysis')}\\n\\t\\t\\t\\t\\t\\t\\t<div class=\\"bg-green-50 dark:bg-green-900/10 px-4 py-4 border-b border-gray-100 dark:border-gray-700\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t<div class=\\"flex items-start\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t<div class=\\"bg-green-100 dark:bg-green-800/30 p-2 rounded-lg mr-3\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t<svg xmlns=\\"http://www.w3.org/2000/svg\\" class=\\"h-5 w-5 text-green-600 dark:text-green-400\\" viewBox=\\"0 0 20 20\\" fill=\\"currentColor\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t<path fill-rule=\\"evenodd\\" d=\\"M6 2a2 2 0 00-2 2v12a2 2 0 002 2h8a2 2 0 002-2V7.414A2 2 0 0015.414 6L12 2.586A2 2 0 0010.586 2H6zm2 10a1 1 0 10-2 0v3a1 1 0 102 0v-3zm2-3a1 1 0 011 1v5a1 1 0 11-2 0v-5a1 1 0 011-1zm4-1a1 1 0 10-2 0v7a1 1 0 102 0V8z\\" clip-rule=\\"evenodd\\" />\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t</svg>\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t<div class=\\"flex-1\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t<h3 class=\\"font-semibold text-green-800 dark:text-green-300 mb-2\\">Journal Entries</h3>\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t<div class=\\"text-gray-700 dark:text-gray-300\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t{#if message.content.match(/\\\\*\\\\*Journal Entries Analysis\\\\*\\\\*:?\\\\s*(.*?)(?:\\\\n\\\\n\\\\*\\\\*Recommendations|\\\\*\\\\*Recommendations)/s)}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t<ul class=\\"list-disc pl-5 space-y-2\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t{#each message.content\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t.match(/\\\\*\\\\*Journal Entries Analysis\\\\*\\\\*:?\\\\s*(.*?)(?:\\\\n\\\\n\\\\*\\\\*Recommendations|\\\\*\\\\*Recommendations)/s)[1]\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t.replace(/^\\\\*\\\\s*/, '')\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t.split(/;\\\\s*|\\\\n\\\\*\\\\s*/)\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t.filter(item => item.trim()) as item}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t<li>{@html item.replace(/\\\\*\\\\*(.*?)\\\\*\\\\*/g, '<strong>\\\\$1</strong>')}</li>\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t{/each}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t</ul>\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t{/if}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t\\t{/if}\\n\\t\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\t\\t<!-- Recommendations 部分 -->\\n\\t\\t\\t\\t\\t\\t{#if message.content.includes('**Recommendations')}\\n\\t\\t\\t\\t\\t\\t<div class=\\"bg-amber-50 dark:bg-amber-900/10 px-4 py-4\\">\\n\\t\\t\\t\\t\\t\\t\\t<div class=\\"flex items-start\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t<div class=\\"bg-amber-100 dark:bg-amber-800/30 p-2 rounded-lg mr-3\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t<svg xmlns=\\"http://www.w3.org/2000/svg\\" class=\\"h-5 w-5 text-amber-600 dark:text-amber-400\\" viewBox=\\"0 0 20 20\\" fill=\\"currentColor\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t<path d=\\"M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z\\" />\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t</svg>\\n\\t\\t\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t\\t\\t\\t<div class=\\"flex-1\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t<h3 class=\\"font-semibold text-amber-800 dark:text-amber-300 mb-2\\">Recommendations</h3>\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t<div class=\\"text-gray-700 dark:text-gray-300\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t{#if message.content.match(/\\\\*\\\\*Recommendations\\\\*\\\\*:?\\\\s*(.*?)$/s)}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t<ul class=\\"list-disc pl-5 space-y-2\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t{#each message.content\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t.match(/\\\\*\\\\*Recommendations\\\\*\\\\*:?\\\\s*(.*?)$/s)[1]\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t.split(/;\\\\s*|\\\\n\\\\*\\\\s*/)\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t.filter(rec => rec.trim()) as recommendation}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t<li>{@html recommendation.replace(/\\\\*\\\\*(.*?)\\\\*\\\\*/g, '<strong>\\\\$1</strong>')}</li>\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t{/each}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t</ul>\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t{/if}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t\\t{/if}\\n\\t\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\t\\t{#if !message.content.includes('**Summary') && !message.content.includes('**Trends And Insights') && \\n\\t\\t\\t\\t\\t\\t\\t!message.content.includes('**Journal Entries Analysis') && !message.content.includes('**Recommendations')}\\n\\t\\t\\t\\t\\t\\t\\t<div class=\\"px-5 py-4\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t<div class=\\"prose dark:prose-invert max-w-none\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t{@html message.content.replace(/;/g, '<br>').replace(/\\\\*\\\\*(.*?)\\\\*\\\\*/g, '<strong>\\\\$1</strong>')}\\n\\t\\t\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t\\t{/if}\\n\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t{#if message.results}\\n\\t\\t\\t\\t\\t\\t<div class=\\"mt-4\\">\\n\\t\\t\\t\\t\\t\\t\\t{#if message.results.records}\\n\\t\\t\\t\\t\\t\\t\\t\\t<div class=\\"flex items-center gap-2 font-medium text-gray-700 dark:text-gray-300 mb-2\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t<svg xmlns=\\"http://www.w3.org/2000/svg\\" fill=\\"none\\" viewBox=\\"0 0 24 24\\" stroke-width=\\"2\\" stroke=\\"currentColor\\" class=\\"w-4 h-4\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t<path stroke-linecap=\\"round\\" stroke-linejoin=\\"round\\" d=\\"M3.375 19.5h17.25m-17.25 0a1.125 1.125 0 0 1-1.125-1.125M3.375 19.5h7.5c.621 0 1.125-.504 1.125-1.125m-9.75 0V5.625m0 12.75v-1.5c0-.621.504-1.125 1.125-1.125m18.375 2.625V5.625m0 12.75c0 .621-.504 1.125-1.125 1.125m1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125m0 3.75h-7.5A1.125 1.125 0 0 1 12 18.375m9.75-12.75c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125m19.5 0v1.5c0 .621-.504 1.125-1.125 1.125M2.25 5.625v1.5c0 .621.504 1.125 1.125 1.125m0 0h17.25m-17.25 0h7.5c.621 0 1.125.504 1.125 1.125M3.375 8.25c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125m1.125-3.75h7.5c.621 0 1.125.504 1.125 1.125m-9.75 0h9.75\\" />\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t</svg>\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tData Table\\n\\t\\t\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t\\t\\t\\t<div class=\\"overflow-x-auto\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t<Table \\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\tdata={toTableObjects(message.results.columns, message.results.records)}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\tcolumns={message.results.columns}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\tclassName=\\"border w-full table-improved\\"\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t/>\\n\\t\\t\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t\\t\\t\\t<div class=\\"mt-4 h-64\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t{#if message.results}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t{#await Promise.resolve(formatChartData(message.results)) then chartData}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t{#if chartData}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t<Chart\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\ttype=\\"line\\"\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\tdata={chartData}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\toptions={{\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\tresponsive: true,\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\tmaintainAspectRatio: false\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t}}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t/>\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t{/if}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t{/await}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t{/if}\\n\\t\\t\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t\\t\\t{/if}\\n\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t{/if}\\n\\t\\t\\t\\t</div>\\n\\t\\t\\t{/each}\\n\\t\\t</div>\\n\\n\\t\\t<div class=\\"bg-white dark:bg-gray-900\\">\\n\\t\\t\\t<div class=\\"max-w-6xl px-2.5 mx-auto inset-x-0\\">\\n\\t\\t\\t  <form on:submit|preventDefault={handleSubmit} class=\\"w-full flex gap-1.5\\">\\n\\t\\t\\t\\t<div class=\\"flex-1 flex flex-col relative w-full rounded-3xl px-1 bg-gray-600/5 dark:bg-gray-400/5 dark:text-gray-100\\">\\n\\t\\t\\t\\t  <div class=\\"px-2.5\\">\\n\\t\\t\\t\\t\\t<input\\n\\t\\t\\t\\t\\t  type=\\"text\\"\\n\\t\\t\\t\\t\\t  bind:value={input}\\n\\t\\t\\t\\t\\t  placeholder=\\"Send a message starting with @analysis\\"\\n\\t\\t\\t\\t\\t  class=\\"scrollbar-hidden bg-transparent dark:text-gray-100 outline-hidden w-full pt-3 px-1 resize-none h-fit\\"\\n\\t\\t\\t\\t\\t  disabled={isLoading}\\n\\t\\t\\t\\t\\t/>\\n\\t\\t\\t\\t  </div>\\n\\t\\t\\t\\t  \\n\\t\\t\\t\\t  <div class=\\"flex justify-between mt-1.5 mb-2.5 mx-0.5 max-w-full\\">\\n\\t\\t\\t\\t\\t<div class=\\"ml-1 self-end gap-0.5 flex items-center flex-1 max-w-[80%]\\">\\n\\t\\t\\t\\t\\t  <!-- This space can remain empty to match the layout -->\\n\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\t<div class=\\"self-end flex space-x-1 mr-1 shrink-0\\">\\n\\t\\t\\t\\t\\t  <div class=\\"flex items-center\\">\\n\\t\\t\\t\\t\\t\\t<button\\n\\t\\t\\t\\t\\t\\t  type=\\"submit\\"\\n\\t\\t\\t\\t\\t\\t  class=\\"{!isLoading \\n\\t\\t\\t\\t\\t\\t\\t? 'bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100' \\n\\t\\t\\t\\t\\t\\t\\t: 'text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700'} \\n\\t\\t\\t\\t\\t\\t\\ttransition rounded-full p-1.5 self-center\\"\\n\\t\\t\\t\\t\\t\\t  disabled={isLoading}\\n\\t\\t\\t\\t\\t\\t>\\n\\t\\t\\t\\t\\t\\t  {#if isLoading}\\n\\t\\t\\t\\t\\t\\t\\t<div class=\\"flex items-center\\">\\n\\t\\t\\t\\t\\t\\t\\t  <svg class=\\"animate-spin h-5 w-5 mr-2\\" xmlns=\\"http://www.w3.org/2000/svg\\" fill=\\"none\\" viewBox=\\"0 0 24 24\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t<circle class=\\"opacity-25\\" cx=\\"12\\" cy=\\"12\\" r=\\"10\\" stroke=\\"currentColor\\" stroke-width=\\"4\\"></circle>\\n\\t\\t\\t\\t\\t\\t\\t\\t<path class=\\"opacity-75\\" fill=\\"currentColor\\" d=\\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z\\"></path>\\n\\t\\t\\t\\t\\t\\t\\t  </svg>\\n\\t\\t\\t\\t\\t\\t\\t  <span>Processing...</span>\\n\\t\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t\\t  {:else}\\n\\t\\t\\t\\t\\t\\t\\t<svg xmlns=\\"http://www.w3.org/2000/svg\\" viewBox=\\"0 0 16 16\\" fill=\\"currentColor\\" class=\\"size-5\\">\\n\\t\\t\\t\\t\\t\\t\\t  <path fill-rule=\\"evenodd\\" d=\\"M8 14a.75.75 0 0 1-.75-.75V4.56L4.03 7.78a.75.75 0 0 1-1.06-1.06l4.5-4.5a.75.75 0 0 1 1.06 0l4.5 4.5a.75.75 0 0 1-1.06 1.06L8.75 4.56v8.69A.75.75 0 0 1 8 14Z\\" clip-rule=\\"evenodd\\"/>\\n\\t\\t\\t\\t\\t\\t\\t</svg>\\n\\t\\t\\t\\t\\t\\t  {/if}\\n\\t\\t\\t\\t\\t\\t</button>\\n\\t\\t\\t\\t\\t  </div>\\n\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t  </div>\\n\\t\\t\\t\\t</div>\\n\\t\\t\\t  </form>\\n\\t\\t\\t  \\n\\t\\t\\t  {#if error}\\n\\t\\t\\t\\t<p class=\\"mt-2 text-red-500 text-sm\\">{error}</p>\\n\\t\\t\\t  {/if}\\n\\t\\t\\t</div>\\n\\t\\t  </div>\\n\\t</div>\\n</div>\\n\\n\\n<style>\\n:global(.table-improved) {\\n\\twidth: calc(100% + 1rem) !important;\\n\\tmax-width: none !important;\\n\\tmargin-left: -0.5rem;\\n\\tmargin-right: -0.5rem;\\n}\\n:global(.table-improved thead) {\\n\\tbackground-color: #e8f4ff !important;\\n}\\n:global(.dark .table-improved thead) {\\n\\tbackground-color: #1e3a5f !important;\\n}\\n:global(.table-improved th) {\\n\\tfont-weight: 600;\\n\\tpadding: 0.75rem 1rem !important;\\n}\\n:global(.table-improved td) {\\n\\tpadding: 0.625rem 1rem !important;\\n}\\n</style> "],"names":[],"mappings":"AAycQ,eAAiB,CACxB,KAAK,CAAE,KAAK,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,UAAU,CACnC,SAAS,CAAE,IAAI,CAAC,UAAU,CAC1B,WAAW,CAAE,OAAO,CACpB,YAAY,CAAE,OACf,CACQ,qBAAuB,CAC9B,gBAAgB,CAAE,OAAO,CAAC,UAC3B,CACQ,2BAA6B,CACpC,gBAAgB,CAAE,OAAO,CAAC,UAC3B,CACQ,kBAAoB,CAC3B,WAAW,CAAE,GAAG,CAChB,OAAO,CAAE,OAAO,CAAC,IAAI,CAAC,UACvB,CACQ,kBAAoB,CAC3B,OAAO,CAAE,QAAQ,CAAC,IAAI,CAAC,UACxB"}`
};
function formatChartData(results) {
  if (!results || !results.records) return null;
  const chartData = {
    labels: results.records.map((r) => r[0]),
    datasets: [
      {
        label: "Value",
        data: results.records.map((r) => r[1]),
        borderColor: "rgb(75, 192, 192)",
        tension: 0.1
      }
    ]
  };
  return chartData;
}
function toTableObjects(columns, records) {
  return records.map((row) => {
    const obj = {};
    columns.forEach((col, i) => {
      obj[col] = row[i];
    });
    return obj;
  });
}
const Page = create_ssr_component(($$result, $$props, $$bindings, slots) => {
  Chart$1.register(LineController, LineElement, PointElement, LinearScale, Title, CategoryScale, Tooltip, Legend);
  let messages = [];
  let input = "";
  $$result.css.add(css);
  return `<div class="flex flex-row w-full h-full max-h-[100dvh]"><div class="flex-1 flex flex-col h-full"><div class="flex items-center justify-between px-4 pt-4 pb-2"><div class="flex items-center gap-4"> <button class="cursor-pointer p-[7px] flex rounded-xl hover:bg-gray-100 dark:hover:bg-gray-900 transition" aria-label="Toggle Sidebar" data-svelte-h="svelte-rquafd"><div class="m-auto self-center"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="size-5"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25H12"></path></svg></div></button> <h1 class="text-2xl font-bold" data-svelte-h="svelte-ct5dbq">Analysis Report</h1></div> <button class="px-4 py-2 bg-blue-100 text-blue-700 border border-blue-200 rounded-lg hover:bg-blue-200 dark:bg-blue-800/30 dark:text-blue-300 dark:border-blue-700 dark:hover:bg-blue-700/50 transition flex items-center" ${messages.length === 0 ? "disabled" : ""}>${`<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-blue-600 dark:text-blue-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg> <span data-svelte-h="svelte-10vfy6y">Download as Word</span>`}</button></div>  <div class="flex-1 overflow-y-auto p-4 space-y-4">${each(messages, (message) => {
    return `<div class="bg-white dark:bg-gray-800 rounded-xl p-0 shadow-md overflow-hidden border border-gray-100 dark:border-gray-700 mb-6"> ${message.content.match(/\*\*Analysis for - (.*?)\*\*/) ? `<div class="bg-gray-50 dark:bg-gray-700 px-5 py-3 border-b border-gray-200 dark:border-gray-700"><h2 class="text-xl font-bold text-gray-800 dark:text-gray-200">${escape(message.content.match(/\*\*Analysis for - (.*?)\*\*/)[1])}</h2> </div>` : ``}  <div class="p-0"> ${message.content.includes("**Summary") ? `<div class="px-4 py-4 border-b border-gray-100 dark:border-gray-700"><div class="flex items-start"><div class="bg-blue-100 dark:bg-blue-800/30 p-2 rounded-lg mr-3" data-svelte-h="svelte-17qpwoj"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-blue-600 dark:text-blue-400" viewBox="0 0 20 20" fill="currentColor"><path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"></path><path fill-rule="evenodd" d="M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3zm-3 4a1 1 0 100 2h.01a1 1 0 100-2H7zm3 0a1 1 0 100 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"></path></svg></div> <div class="flex-1"><h3 class="font-semibold text-blue-800 dark:text-blue-300 mb-2" data-svelte-h="svelte-1hhxjen">Summary</h3> <div class="text-gray-700 dark:text-gray-300">${message.content.match(/\*\*Summary\*\*:?\s*(.*?)(?:\n\n\*\*Trends And Insights|\*\*Trends And Insights)/s) ? `<!-- HTML_TAG_START -->${message.content.match(/\*\*Summary\*\*:?\s*(.*?)(?:\n\n\*\*Trends And Insights|\*\*Trends And Insights)/s)[1].replace(/\*\*(.*?)\*\*/g, "<strong>$1</strong>").split(";").map((line) => line.trim()).join("<br>")}<!-- HTML_TAG_END -->` : ``}</div> </div></div> </div>` : ``}  ${message.content.includes("**Trends And Insights") ? `<div class="bg-purple-50 dark:bg-purple-900/10 px-4 py-4 border-b border-gray-100 dark:border-gray-700"><div class="flex items-start"><div class="bg-purple-100 dark:bg-purple-800/30 p-2 rounded-lg mr-3" data-svelte-h="svelte-dj3j79"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-purple-600 dark:text-purple-400" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3 3a1 1 0 000 2v8a2 2 0 002 2h2.586l-1.293 1.293a1 1 0 101.414 1.414L10 15.414l2.293 2.293a1 1 0 001.414-1.414L12.414 15H15a2 2 0 002-2V5a1 1 0 100-2H3zm11.707 4.707a1 1 0 00-1.414-1.414L10 9.586 8.707 8.293a1 1 0 00-1.414 0l-2 2a1 1 0 101.414 1.414L8 10.414l1.293 1.293a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg></div> <div class="flex-1"><h3 class="font-semibold text-purple-800 dark:text-purple-300 mb-2" data-svelte-h="svelte-uvwifl">Trends And Insights</h3> <div class="text-gray-700 dark:text-gray-300">${message.content.match(/\*\*Trends And Insights\*\*:?\s*(.*?)(?:\n\n\*\*Journal Entries|\*\*Journal Entries)/s) ? `<ul class="list-disc pl-5 space-y-2">${each(message.content.match(/\*\*Trends And Insights\*\*:?\s*(.*?)(?:\n\n\*\*Journal Entries|\*\*Journal Entries)/s)[1].replace(/^\*\s*/, "").split(/;\s*|\n\*\s*/).filter((item) => item.trim()), (item) => {
      return `<li><!-- HTML_TAG_START -->${item.replace(/\*\*(.*?)\*\*/g, "<strong>$1</strong>")}<!-- HTML_TAG_END --></li>`;
    })} </ul>` : ``}</div> </div></div> </div>` : ``}  ${message.content.includes("**Journal Entries Analysis") ? `<div class="bg-green-50 dark:bg-green-900/10 px-4 py-4 border-b border-gray-100 dark:border-gray-700"><div class="flex items-start"><div class="bg-green-100 dark:bg-green-800/30 p-2 rounded-lg mr-3" data-svelte-h="svelte-o8l9st"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-green-600 dark:text-green-400" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M6 2a2 2 0 00-2 2v12a2 2 0 002 2h8a2 2 0 002-2V7.414A2 2 0 0015.414 6L12 2.586A2 2 0 0010.586 2H6zm2 10a1 1 0 10-2 0v3a1 1 0 102 0v-3zm2-3a1 1 0 011 1v5a1 1 0 11-2 0v-5a1 1 0 011-1zm4-1a1 1 0 10-2 0v7a1 1 0 102 0V8z" clip-rule="evenodd"></path></svg></div> <div class="flex-1"><h3 class="font-semibold text-green-800 dark:text-green-300 mb-2" data-svelte-h="svelte-19kpf7w">Journal Entries</h3> <div class="text-gray-700 dark:text-gray-300">${message.content.match(/\*\*Journal Entries Analysis\*\*:?\s*(.*?)(?:\n\n\*\*Recommendations|\*\*Recommendations)/s) ? `<ul class="list-disc pl-5 space-y-2">${each(message.content.match(/\*\*Journal Entries Analysis\*\*:?\s*(.*?)(?:\n\n\*\*Recommendations|\*\*Recommendations)/s)[1].replace(/^\*\s*/, "").split(/;\s*|\n\*\s*/).filter((item) => item.trim()), (item) => {
      return `<li><!-- HTML_TAG_START -->${item.replace(/\*\*(.*?)\*\*/g, "<strong>$1</strong>")}<!-- HTML_TAG_END --></li>`;
    })} </ul>` : ``}</div> </div></div> </div>` : ``}  ${message.content.includes("**Recommendations") ? `<div class="bg-amber-50 dark:bg-amber-900/10 px-4 py-4"><div class="flex items-start"><div class="bg-amber-100 dark:bg-amber-800/30 p-2 rounded-lg mr-3" data-svelte-h="svelte-t4cooq"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-amber-600 dark:text-amber-400" viewBox="0 0 20 20" fill="currentColor"><path d="M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z"></path></svg></div> <div class="flex-1"><h3 class="font-semibold text-amber-800 dark:text-amber-300 mb-2" data-svelte-h="svelte-1xcp0h5">Recommendations</h3> <div class="text-gray-700 dark:text-gray-300">${message.content.match(/\*\*Recommendations\*\*:?\s*(.*?)$/s) ? `<ul class="list-disc pl-5 space-y-2">${each(message.content.match(/\*\*Recommendations\*\*:?\s*(.*?)$/s)[1].split(/;\s*|\n\*\s*/).filter((rec) => rec.trim()), (recommendation) => {
      return `<li><!-- HTML_TAG_START -->${recommendation.replace(/\*\*(.*?)\*\*/g, "<strong>$1</strong>")}<!-- HTML_TAG_END --></li>`;
    })} </ul>` : ``}</div> </div></div> </div>` : ``} ${!message.content.includes("**Summary") && !message.content.includes("**Trends And Insights") && !message.content.includes("**Journal Entries Analysis") && !message.content.includes("**Recommendations") ? `<div class="px-5 py-4"><div class="prose dark:prose-invert max-w-none"><!-- HTML_TAG_START -->${message.content.replace(/;/g, "<br>").replace(/\*\*(.*?)\*\*/g, "<strong>$1</strong>")}<!-- HTML_TAG_END --></div> </div>` : ``}</div> ${message.results ? `<div class="mt-4">${message.results.records ? `<div class="flex items-center gap-2 font-medium text-gray-700 dark:text-gray-300 mb-2" data-svelte-h="svelte-qt30ac"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M3.375 19.5h17.25m-17.25 0a1.125 1.125 0 0 1-1.125-1.125M3.375 19.5h7.5c.621 0 1.125-.504 1.125-1.125m-9.75 0V5.625m0 12.75v-1.5c0-.621.504-1.125 1.125-1.125m18.375 2.625V5.625m0 12.75c0 .621-.504 1.125-1.125 1.125m1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125m0 3.75h-7.5A1.125 1.125 0 0 1 12 18.375m9.75-12.75c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125m19.5 0v1.5c0 .621-.504 1.125-1.125 1.125M2.25 5.625v1.5c0 .621.504 1.125 1.125 1.125m0 0h17.25m-17.25 0h7.5c.621 0 1.125.504 1.125 1.125M3.375 8.25c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125m1.125-3.75h7.5c.621 0 1.125.504 1.125 1.125m-9.75 0h9.75"></path></svg>
									Data Table</div> <div class="overflow-x-auto">${validate_component(Table, "Table").$$render(
      $$result,
      {
        data: toTableObjects(message.results.columns, message.results.records),
        columns: message.results.columns,
        className: "border w-full table-improved"
      },
      {},
      {}
    )}</div> <div class="mt-4 h-64">${message.results ? `${function(__value) {
      if (is_promise(__value)) {
        __value.then(null, noop);
        return ``;
      }
      return function(chartData) {
        return ` ${chartData ? `${validate_component(Chart, "Chart").$$render(
          $$result,
          {
            type: "line",
            data: chartData,
            options: {
              responsive: true,
              maintainAspectRatio: false
            }
          },
          {},
          {}
        )}` : ``} `;
      }(__value);
    }(Promise.resolve(formatChartData(message.results)))}` : ``} </div>` : ``} </div>` : ``} </div>`;
  })}</div> <div class="bg-white dark:bg-gray-900"><div class="max-w-6xl px-2.5 mx-auto inset-x-0"><form class="w-full flex gap-1.5"><div class="flex-1 flex flex-col relative w-full rounded-3xl px-1 bg-gray-600/5 dark:bg-gray-400/5 dark:text-gray-100"><div class="px-2.5"><input type="text" placeholder="Send a message starting with @analysis" class="scrollbar-hidden bg-transparent dark:text-gray-100 outline-hidden w-full pt-3 px-1 resize-none h-fit" ${""}${add_attribute("value", input, 0)}></div> <div class="flex justify-between mt-1.5 mb-2.5 mx-0.5 max-w-full"><div class="ml-1 self-end gap-0.5 flex items-center flex-1 max-w-[80%]" data-svelte-h="svelte-1pxvznt"></div> <div class="self-end flex space-x-1 mr-1 shrink-0"><div class="flex items-center"><button type="submit" class="${escape(
    "bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100",
    true
  ) + " transition rounded-full p-1.5 self-center"}" ${""}>${`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-5"><path fill-rule="evenodd" d="M8 14a.75.75 0 0 1-.75-.75V4.56L4.03 7.78a.75.75 0 0 1-1.06-1.06l4.5-4.5a.75.75 0 0 1 1.06 0l4.5 4.5a.75.75 0 0 1-1.06 1.06L8.75 4.56v8.69A.75.75 0 0 1 8 14Z" clip-rule="evenodd"></path></svg>`}</button></div></div></div></div></form> ${``}</div></div></div> </div>`;
});
export {
  Page as default
};
//# sourceMappingURL=_page.svelte.js.map
