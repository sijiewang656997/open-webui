{"version":3,"file":"_page.svelte.js","sources":["../../../../../../../../../src/lib/apis/models/index.ts","../../../../../../../../../src/lib/components/workspace/Models/ModelEditor.svelte","../../../../../../../../../src/routes/(app)/workspace/models/create/+page.svelte"],"sourcesContent":["import { WEBUI_API_BASE_URL } from '$lib/constants';\n\nexport const getModels = async (token: string = '') => {\n\tlet error = null;\n\n\tconst res = await fetch(`${WEBUI_API_BASE_URL}/models/`, {\n\t\tmethod: 'GET',\n\t\theaders: {\n\t\t\tAccept: 'application/json',\n\t\t\t'Content-Type': 'application/json',\n\t\t\tauthorization: `Bearer ${token}`\n\t\t}\n\t})\n\t\t.then(async (res) => {\n\t\t\tif (!res.ok) throw await res.json();\n\t\t\treturn res.json();\n\t\t})\n\t\t.then((json) => {\n\t\t\treturn json;\n\t\t})\n\t\t.catch((err) => {\n\t\t\terror = err;\n\t\t\tconsole.log(err);\n\t\t\treturn null;\n\t\t});\n\n\tif (error) {\n\t\tthrow error;\n\t}\n\n\treturn res;\n};\n\nexport const getBaseModels = async (token: string = '') => {\n\tlet error = null;\n\n\tconst res = await fetch(`${WEBUI_API_BASE_URL}/models/base`, {\n\t\tmethod: 'GET',\n\t\theaders: {\n\t\t\tAccept: 'application/json',\n\t\t\t'Content-Type': 'application/json',\n\t\t\tauthorization: `Bearer ${token}`\n\t\t}\n\t})\n\t\t.then(async (res) => {\n\t\t\tif (!res.ok) throw await res.json();\n\t\t\treturn res.json();\n\t\t})\n\t\t.then((json) => {\n\t\t\treturn json;\n\t\t})\n\t\t.catch((err) => {\n\t\t\terror = err;\n\t\t\tconsole.log(err);\n\t\t\treturn null;\n\t\t});\n\n\tif (error) {\n\t\tthrow error;\n\t}\n\n\treturn res;\n};\n\nexport const createNewModel = async (token: string, model: object) => {\n\tlet error = null;\n\n\tconst res = await fetch(`${WEBUI_API_BASE_URL}/models/create`, {\n\t\tmethod: 'POST',\n\t\theaders: {\n\t\t\tAccept: 'application/json',\n\t\t\t'Content-Type': 'application/json',\n\t\t\tauthorization: `Bearer ${token}`\n\t\t},\n\t\tbody: JSON.stringify(model)\n\t})\n\t\t.then(async (res) => {\n\t\t\tif (!res.ok) throw await res.json();\n\t\t\treturn res.json();\n\t\t})\n\t\t.catch((err) => {\n\t\t\terror = err.detail;\n\t\t\tconsole.log(err);\n\t\t\treturn null;\n\t\t});\n\n\tif (error) {\n\t\tthrow error;\n\t}\n\n\treturn res;\n};\n\nexport const getModelById = async (token: string, id: string) => {\n\tlet error = null;\n\n\tconst searchParams = new URLSearchParams();\n\tsearchParams.append('id', id);\n\n\tconst res = await fetch(`${WEBUI_API_BASE_URL}/models/model?${searchParams.toString()}`, {\n\t\tmethod: 'GET',\n\t\theaders: {\n\t\t\tAccept: 'application/json',\n\t\t\t'Content-Type': 'application/json',\n\t\t\tauthorization: `Bearer ${token}`\n\t\t}\n\t})\n\t\t.then(async (res) => {\n\t\t\tif (!res.ok) throw await res.json();\n\t\t\treturn res.json();\n\t\t})\n\t\t.then((json) => {\n\t\t\treturn json;\n\t\t})\n\t\t.catch((err) => {\n\t\t\terror = err;\n\n\t\t\tconsole.log(err);\n\t\t\treturn null;\n\t\t});\n\n\tif (error) {\n\t\tthrow error;\n\t}\n\n\treturn res;\n};\n\nexport const toggleModelById = async (token: string, id: string) => {\n\tlet error = null;\n\n\tconst searchParams = new URLSearchParams();\n\tsearchParams.append('id', id);\n\n\tconst res = await fetch(`${WEBUI_API_BASE_URL}/models/model/toggle?${searchParams.toString()}`, {\n\t\tmethod: 'POST',\n\t\theaders: {\n\t\t\tAccept: 'application/json',\n\t\t\t'Content-Type': 'application/json',\n\t\t\tauthorization: `Bearer ${token}`\n\t\t}\n\t})\n\t\t.then(async (res) => {\n\t\t\tif (!res.ok) throw await res.json();\n\t\t\treturn res.json();\n\t\t})\n\t\t.then((json) => {\n\t\t\treturn json;\n\t\t})\n\t\t.catch((err) => {\n\t\t\terror = err;\n\n\t\t\tconsole.log(err);\n\t\t\treturn null;\n\t\t});\n\n\tif (error) {\n\t\tthrow error;\n\t}\n\n\treturn res;\n};\n\nexport const updateModelById = async (token: string, id: string, model: object) => {\n\tlet error = null;\n\n\tconst searchParams = new URLSearchParams();\n\tsearchParams.append('id', id);\n\n\tconst res = await fetch(`${WEBUI_API_BASE_URL}/models/model/update?${searchParams.toString()}`, {\n\t\tmethod: 'POST',\n\t\theaders: {\n\t\t\tAccept: 'application/json',\n\t\t\t'Content-Type': 'application/json',\n\t\t\tauthorization: `Bearer ${token}`\n\t\t},\n\t\tbody: JSON.stringify(model)\n\t})\n\t\t.then(async (res) => {\n\t\t\tif (!res.ok) throw await res.json();\n\t\t\treturn res.json();\n\t\t})\n\t\t.then((json) => {\n\t\t\treturn json;\n\t\t})\n\t\t.catch((err) => {\n\t\t\terror = err;\n\n\t\t\tconsole.log(err);\n\t\t\treturn null;\n\t\t});\n\n\tif (error) {\n\t\tthrow error;\n\t}\n\n\treturn res;\n};\n\nexport const deleteModelById = async (token: string, id: string) => {\n\tlet error = null;\n\n\tconst searchParams = new URLSearchParams();\n\tsearchParams.append('id', id);\n\n\tconst res = await fetch(`${WEBUI_API_BASE_URL}/models/model/delete?${searchParams.toString()}`, {\n\t\tmethod: 'DELETE',\n\t\theaders: {\n\t\t\tAccept: 'application/json',\n\t\t\t'Content-Type': 'application/json',\n\t\t\tauthorization: `Bearer ${token}`\n\t\t}\n\t})\n\t\t.then(async (res) => {\n\t\t\tif (!res.ok) throw await res.json();\n\t\t\treturn res.json();\n\t\t})\n\t\t.then((json) => {\n\t\t\treturn json;\n\t\t})\n\t\t.catch((err) => {\n\t\t\terror = err.detail;\n\n\t\t\tconsole.log(err);\n\t\t\treturn null;\n\t\t});\n\n\tif (error) {\n\t\tthrow error;\n\t}\n\n\treturn res;\n};\n\nexport const deleteAllModels = async (token: string) => {\n\tlet error = null;\n\n\tconst res = await fetch(`${WEBUI_API_BASE_URL}/models/delete/all`, {\n\t\tmethod: 'DELETE',\n\t\theaders: {\n\t\t\tAccept: 'application/json',\n\t\t\t'Content-Type': 'application/json',\n\t\t\tauthorization: `Bearer ${token}`\n\t\t}\n\t})\n\t\t.then(async (res) => {\n\t\t\tif (!res.ok) throw await res.json();\n\t\t\treturn res.json();\n\t\t})\n\t\t.then((json) => {\n\t\t\treturn json;\n\t\t})\n\t\t.catch((err) => {\n\t\t\terror = err;\n\n\t\t\tconsole.log(err);\n\t\t\treturn null;\n\t\t});\n\n\tif (error) {\n\t\tthrow error;\n\t}\n\n\treturn res;\n};\n","<script lang=\"ts\">\n\timport { onMount, getContext, tick } from 'svelte';\n\timport { models, tools, functions, knowledge as knowledgeCollections, user } from '$lib/stores';\n\n\timport AdvancedParams from '$lib/components/chat/Settings/Advanced/AdvancedParams.svelte';\n\timport Tags from '$lib/components/common/Tags.svelte';\n\timport Knowledge from '$lib/components/workspace/Models/Knowledge.svelte';\n\timport ToolsSelector from '$lib/components/workspace/Models/ToolsSelector.svelte';\n\timport FiltersSelector from '$lib/components/workspace/Models/FiltersSelector.svelte';\n\timport ActionsSelector from '$lib/components/workspace/Models/ActionsSelector.svelte';\n\timport Capabilities from '$lib/components/workspace/Models/Capabilities.svelte';\n\timport Textarea from '$lib/components/common/Textarea.svelte';\n\timport { getTools } from '$lib/apis/tools';\n\timport { getFunctions } from '$lib/apis/functions';\n\timport { getKnowledgeBases } from '$lib/apis/knowledge';\n\timport AccessControl from '../common/AccessControl.svelte';\n\timport { stringify } from 'postcss';\n\timport { toast } from 'svelte-sonner';\n\n\tconst i18n = getContext('i18n');\n\n\texport let onSubmit: Function;\n\texport let onBack: null | Function = null;\n\n\texport let model = null;\n\texport let edit = false;\n\n\texport let preset = true;\n\n\tlet loading = false;\n\tlet success = false;\n\n\tlet filesInputElement;\n\tlet inputFiles;\n\n\tlet showAdvanced = false;\n\tlet showPreview = false;\n\n\tlet loaded = false;\n\n\t// ///////////\n\t// model\n\t// ///////////\n\n\tlet id = '';\n\tlet name = '';\n\n\tlet enableDescription = true;\n\n\t$: if (!edit) {\n\t\tif (name) {\n\t\t\tid = name\n\t\t\t\t.replace(/\\s+/g, '-')\n\t\t\t\t.replace(/[^a-zA-Z0-9-]/g, '')\n\t\t\t\t.toLowerCase();\n\t\t}\n\t}\n\n\tlet info = {\n\t\tid: '',\n\t\tbase_model_id: null,\n\t\tname: '',\n\t\tmeta: {\n\t\t\tprofile_image_url: '/static/favicon.png',\n\t\t\tdescription: '',\n\t\t\tsuggestion_prompts: null,\n\t\t\ttags: []\n\t\t},\n\t\tparams: {\n\t\t\tsystem: ''\n\t\t}\n\t};\n\n\tlet params = {\n\t\tsystem: ''\n\t};\n\tlet capabilities = {\n\t\tvision: true,\n\t\tusage: undefined,\n\t\tcitations: true\n\t};\n\n\tlet knowledge = [];\n\tlet toolIds = [];\n\tlet filterIds = [];\n\tlet actionIds = [];\n\n\tlet accessControl = {};\n\n\tconst addUsage = (base_model_id) => {\n\t\tconst baseModel = $models.find((m) => m.id === base_model_id);\n\n\t\tif (baseModel) {\n\t\t\tif (baseModel.owned_by === 'openai') {\n\t\t\t\tcapabilities.usage = baseModel?.meta?.capabilities?.usage ?? false;\n\t\t\t} else {\n\t\t\t\tdelete capabilities.usage;\n\t\t\t}\n\t\t\tcapabilities = capabilities;\n\t\t}\n\t};\n\n\tconst submitHandler = async () => {\n\t\tloading = true;\n\n\t\tinfo.id = id;\n\t\tinfo.name = name;\n\n\t\tif (id === '') {\n\t\t\ttoast.error('Model ID is required.');\n\t\t}\n\n\t\tif (name === '') {\n\t\t\ttoast.error('Model Name is required.');\n\t\t}\n\n\t\tinfo.access_control = accessControl;\n\t\tinfo.meta.capabilities = capabilities;\n\n\t\tif (enableDescription) {\n\t\t\tinfo.meta.description = info.meta.description.trim() === '' ? null : info.meta.description;\n\t\t} else {\n\t\t\tinfo.meta.description = null;\n\t\t}\n\n\t\tif (knowledge.length > 0) {\n\t\t\tinfo.meta.knowledge = knowledge;\n\t\t} else {\n\t\t\tif (info.meta.knowledge) {\n\t\t\t\tdelete info.meta.knowledge;\n\t\t\t}\n\t\t}\n\n\t\tif (toolIds.length > 0) {\n\t\t\tinfo.meta.toolIds = toolIds;\n\t\t} else {\n\t\t\tif (info.meta.toolIds) {\n\t\t\t\tdelete info.meta.toolIds;\n\t\t\t}\n\t\t}\n\n\t\tif (filterIds.length > 0) {\n\t\t\tinfo.meta.filterIds = filterIds;\n\t\t} else {\n\t\t\tif (info.meta.filterIds) {\n\t\t\t\tdelete info.meta.filterIds;\n\t\t\t}\n\t\t}\n\n\t\tif (actionIds.length > 0) {\n\t\t\tinfo.meta.actionIds = actionIds;\n\t\t} else {\n\t\t\tif (info.meta.actionIds) {\n\t\t\t\tdelete info.meta.actionIds;\n\t\t\t}\n\t\t}\n\n\t\tinfo.params.stop = params.stop ? params.stop.split(',').filter((s) => s.trim()) : null;\n\t\tObject.keys(info.params).forEach((key) => {\n\t\t\tif (info.params[key] === '' || info.params[key] === null) {\n\t\t\t\tdelete info.params[key];\n\t\t\t}\n\t\t});\n\n\t\tawait onSubmit(info);\n\n\t\tloading = false;\n\t\tsuccess = false;\n\t};\n\n\tonMount(async () => {\n\t\tawait tools.set(await getTools(localStorage.token));\n\t\tawait functions.set(await getFunctions(localStorage.token));\n\t\tawait knowledgeCollections.set(await getKnowledgeBases(localStorage.token));\n\n\t\t// Scroll to top 'workspace-container' element\n\t\tconst workspaceContainer = document.getElementById('workspace-container');\n\t\tif (workspaceContainer) {\n\t\t\tworkspaceContainer.scrollTop = 0;\n\t\t}\n\n\t\tif (model) {\n\t\t\tname = model.name;\n\t\t\tawait tick();\n\n\t\t\tid = model.id;\n\n\t\t\tenableDescription = model?.meta?.description !== null;\n\n\t\t\tif (model.base_model_id) {\n\t\t\t\tconst base_model = $models\n\t\t\t\t\t.filter((m) => !m?.preset && !(m?.arena ?? false))\n\t\t\t\t\t.find((m) => [model.base_model_id, `${model.base_model_id}:latest`].includes(m.id));\n\n\t\t\t\tconsole.log('base_model', base_model);\n\n\t\t\t\tif (base_model) {\n\t\t\t\t\tmodel.base_model_id = base_model.id;\n\t\t\t\t} else {\n\t\t\t\t\tmodel.base_model_id = null;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tparams = { ...params, ...model?.params };\n\t\t\tparams.stop = params?.stop\n\t\t\t\t? (typeof params.stop === 'string' ? params.stop.split(',') : (params?.stop ?? [])).join(\n\t\t\t\t\t\t','\n\t\t\t\t\t)\n\t\t\t\t: null;\n\n\t\t\ttoolIds = model?.meta?.toolIds ?? [];\n\t\t\tfilterIds = model?.meta?.filterIds ?? [];\n\t\t\tactionIds = model?.meta?.actionIds ?? [];\n\t\t\tknowledge = (model?.meta?.knowledge ?? []).map((item) => {\n\t\t\t\tif (item?.collection_name) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tid: item.collection_name,\n\t\t\t\t\t\tname: item.name,\n\t\t\t\t\t\tlegacy: true\n\t\t\t\t\t};\n\t\t\t\t} else if (item?.collection_names) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tname: item.name,\n\t\t\t\t\t\ttype: 'collection',\n\t\t\t\t\t\tcollection_names: item.collection_names,\n\t\t\t\t\t\tlegacy: true\n\t\t\t\t\t};\n\t\t\t\t} else {\n\t\t\t\t\treturn item;\n\t\t\t\t}\n\t\t\t});\n\t\t\tcapabilities = { ...capabilities, ...(model?.meta?.capabilities ?? {}) };\n\n\t\t\tif ('access_control' in model) {\n\t\t\t\taccessControl = model.access_control;\n\t\t\t} else {\n\t\t\t\taccessControl = {};\n\t\t\t}\n\n\t\t\tconsole.log(model?.access_control);\n\t\t\tconsole.log(accessControl);\n\n\t\t\tinfo = {\n\t\t\t\t...info,\n\t\t\t\t...JSON.parse(\n\t\t\t\t\tJSON.stringify(\n\t\t\t\t\t\tmodel\n\t\t\t\t\t\t\t? model\n\t\t\t\t\t\t\t: {\n\t\t\t\t\t\t\t\t\tid: model.id,\n\t\t\t\t\t\t\t\t\tname: model.name\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t};\n\n\t\t\tconsole.log(model);\n\t\t}\n\n\t\tloaded = true;\n\t});\n</script>\n\n{#if loaded}\n\t{#if onBack}\n\t\t<button\n\t\t\tclass=\"flex space-x-1\"\n\t\t\ton:click={() => {\n\t\t\t\tonBack();\n\t\t\t}}\n\t\t>\n\t\t\t<div class=\" self-center\">\n\t\t\t\t<svg\n\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\tviewBox=\"0 0 20 20\"\n\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\tclass=\"h-4 w-4\"\n\t\t\t\t>\n\t\t\t\t\t<path\n\t\t\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\t\t\td=\"M17 10a.75.75 0 01-.75.75H5.612l4.158 3.96a.75.75 0 11-1.04 1.08l-5.5-5.25a.75.75 0 010-1.08l5.5-5.25a.75.75 0 111.04 1.08L5.612 9.25H16.25A.75.75 0 0117 10z\"\n\t\t\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\t\t/>\n\t\t\t\t</svg>\n\t\t\t</div>\n\t\t\t<div class=\" self-center text-sm font-medium\">{'Back'}</div>\n\t\t</button>\n\t{/if}\n\n\t<div class=\"w-full max-h-full flex justify-center\">\n\t\t<input\n\t\t\tbind:this={filesInputElement}\n\t\t\tbind:files={inputFiles}\n\t\t\ttype=\"file\"\n\t\t\thidden\n\t\t\taccept=\"image/*\"\n\t\t\ton:change={() => {\n\t\t\t\tlet reader = new FileReader();\n\t\t\t\treader.onload = (event) => {\n\t\t\t\t\tlet originalImageUrl = `${event.target.result}`;\n\n\t\t\t\t\tconst img = new Image();\n\t\t\t\t\timg.src = originalImageUrl;\n\n\t\t\t\t\timg.onload = function () {\n\t\t\t\t\t\tconst canvas = document.createElement('canvas');\n\t\t\t\t\t\tconst ctx = canvas.getContext('2d');\n\n\t\t\t\t\t\t// Calculate the aspect ratio of the image\n\t\t\t\t\t\tconst aspectRatio = img.width / img.height;\n\n\t\t\t\t\t\t// Calculate the new width and height to fit within 100x100\n\t\t\t\t\t\tlet newWidth, newHeight;\n\t\t\t\t\t\tif (aspectRatio > 1) {\n\t\t\t\t\t\t\tnewWidth = 250 * aspectRatio;\n\t\t\t\t\t\t\tnewHeight = 250;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tnewWidth = 250;\n\t\t\t\t\t\t\tnewHeight = 250 / aspectRatio;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Set the canvas size\n\t\t\t\t\t\tcanvas.width = 250;\n\t\t\t\t\t\tcanvas.height = 250;\n\n\t\t\t\t\t\t// Calculate the position to center the image\n\t\t\t\t\t\tconst offsetX = (250 - newWidth) / 2;\n\t\t\t\t\t\tconst offsetY = (250 - newHeight) / 2;\n\n\t\t\t\t\t\t// Draw the image on the canvas\n\t\t\t\t\t\tctx.drawImage(img, offsetX, offsetY, newWidth, newHeight);\n\n\t\t\t\t\t\t// Get the base64 representation of the compressed image\n\t\t\t\t\t\tconst compressedSrc = canvas.toDataURL();\n\n\t\t\t\t\t\t// Display the compressed image\n\t\t\t\t\t\tinfo.meta.profile_image_url = compressedSrc;\n\n\t\t\t\t\t\tinputFiles = null;\n\t\t\t\t\t\tfilesInputElement.value = '';\n\t\t\t\t\t};\n\t\t\t\t};\n\n\t\t\t\tif (\n\t\t\t\t\tinputFiles &&\n\t\t\t\t\tinputFiles.length > 0 &&\n\t\t\t\t\t['image/gif', 'image/webp', 'image/jpeg', 'image/png', 'image/svg+xml'].includes(\n\t\t\t\t\t\tinputFiles[0]['type']\n\t\t\t\t\t)\n\t\t\t\t) {\n\t\t\t\t\treader.readAsDataURL(inputFiles[0]);\n\t\t\t\t} else {\n\t\t\t\t\tconsole.log(`Unsupported File Type '${inputFiles[0]['type']}'.`);\n\t\t\t\t\tinputFiles = null;\n\t\t\t\t}\n\t\t\t}}\n\t\t/>\n\n\t\t{#if !edit || (edit && model)}\n\t\t\t<form\n\t\t\t\tclass=\"flex flex-col md:flex-row w-full gap-3 md:gap-6\"\n\t\t\t\ton:submit|preventDefault={() => {\n\t\t\t\t\tsubmitHandler();\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<div class=\"self-center md:self-start flex justify-center my-2 shrink-0\">\n\t\t\t\t\t<div class=\"self-center\">\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\"rounded-xl flex shrink-0 items-center {info.meta.profile_image_url !==\n\t\t\t\t\t\t\t'/static/favicon.png'\n\t\t\t\t\t\t\t\t? 'bg-transparent'\n\t\t\t\t\t\t\t\t: 'bg-white'} shadow-xl group relative\"\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\tfilesInputElement.click();\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{#if info.meta.profile_image_url}\n\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\tsrc={info.meta.profile_image_url}\n\t\t\t\t\t\t\t\t\talt=\"model profile\"\n\t\t\t\t\t\t\t\t\tclass=\"rounded-xl size-72 md:size-60 object-cover shrink-0\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\tsrc=\"/static/favicon.png\"\n\t\t\t\t\t\t\t\t\talt=\"model profile\"\n\t\t\t\t\t\t\t\t\tclass=\" rounded-xl size-72 md:size-60 object-cover shrink-0\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t{/if}\n\n\t\t\t\t\t\t\t<div class=\"absolute bottom-0 right-0 z-10\">\n\t\t\t\t\t\t\t\t<div class=\"m-1.5\">\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tclass=\"shadow-xl p-1 rounded-full border-2 border-white bg-gray-800 text-white group-hover:bg-gray-600 transition dark:border-black dark:bg-white dark:group-hover:bg-gray-200 dark:text-black\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 16 16\"\n\t\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\t\t\t\t\tclass=\"size-5\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t\t\t\t\td=\"M2 4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V4Zm10.5 5.707a.5.5 0 0 0-.146-.353l-1-1a.5.5 0 0 0-.708 0L9.354 9.646a.5.5 0 0 1-.708 0L6.354 7.354a.5.5 0 0 0-.708 0l-2 2a.5.5 0 0 0-.146.353V12a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5V9.707ZM12 5a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z\"\n\t\t\t\t\t\t\t\t\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\"absolute top-0 bottom-0 left-0 right-0 bg-white dark:bg-black rounded-lg opacity-0 group-hover:opacity-20 transition\"\n\t\t\t\t\t\t\t></div>\n\t\t\t\t\t\t</button>\n\n\t\t\t\t\t\t<div class=\"flex w-full mt-1 justify-end\">\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclass=\"px-2 py-1 text-gray-500 rounded-lg text-xs\"\n\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\tinfo.meta.profile_image_url = '/static/favicon.png';\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tReset Image</button\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"w-full\">\n\t\t\t\t\t<div class=\"mt-2 my-2 flex flex-col\">\n\t\t\t\t\t\t<div class=\"flex-1\">\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\tclass=\"text-3xl font-semibold w-full bg-transparent outline-hidden\"\n\t\t\t\t\t\t\t\t\tplaceholder={$i18n.t('Model Name')}\n\t\t\t\t\t\t\t\t\tbind:value={name}\n\t\t\t\t\t\t\t\t\trequired\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class=\"flex-1\">\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\tclass=\"text-xs w-full bg-transparent text-gray-500 outline-hidden\"\n\t\t\t\t\t\t\t\t\tplaceholder={$i18n.t('Model ID')}\n\t\t\t\t\t\t\t\t\tbind:value={id}\n\t\t\t\t\t\t\t\t\tdisabled={edit}\n\t\t\t\t\t\t\t\t\trequired\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{#if preset}\n\t\t\t\t\t\t<div class=\"my-1\">\n\t\t\t\t\t\t\t<div class=\" text-sm font-semibold mb-1\">{$i18n.t('Base Model (From)')}</div>\n\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<select\n\t\t\t\t\t\t\t\t\tclass=\"text-sm w-full bg-transparent outline-hidden\"\n\t\t\t\t\t\t\t\t\tplaceholder=\"Select a base model (e.g. llama3, gpt-4o)\"\n\t\t\t\t\t\t\t\t\tbind:value={info.base_model_id}\n\t\t\t\t\t\t\t\t\ton:change={(e) => {\n\t\t\t\t\t\t\t\t\t\taddUsage(e.target.value);\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\trequired\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<option value={null} class=\" text-gray-900\"\n\t\t\t\t\t\t\t\t\t\t>{$i18n.t('Select a base model')}</option\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{#each $models.filter((m) => (model ? m.id !== model.id : true) && !m?.preset && m?.owned_by !== 'arena') as model}\n\t\t\t\t\t\t\t\t\t\t<option value={model.id} class=\" text-gray-900\">{model.name}</option>\n\t\t\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n\n\t\t\t\t\t<div class=\"my-1\">\n\t\t\t\t\t\t<div class=\"mb-1 flex w-full justify-between items-center\">\n\t\t\t\t\t\t\t<div class=\" self-center text-sm font-semibold\">{$i18n.t('Description')}</div>\n\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclass=\"p-1 text-xs flex rounded-sm transition\"\n\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\tenableDescription = !enableDescription;\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{#if !enableDescription}\n\t\t\t\t\t\t\t\t\t<span class=\"ml-2 self-center\">{$i18n.t('Default')}</span>\n\t\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t\t<span class=\"ml-2 self-center\">{$i18n.t('Custom')}</span>\n\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t{#if enableDescription}\n\t\t\t\t\t\t\t<Textarea\n\t\t\t\t\t\t\t\tclassName=\" text-sm w-full bg-transparent outline-hidden resize-none overflow-y-hidden \"\n\t\t\t\t\t\t\t\tplaceholder={$i18n.t('Add a short description about what this model does')}\n\t\t\t\t\t\t\t\tbind:value={info.meta.description}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\" mt-2 my-1\">\n\t\t\t\t\t\t<div class=\"\">\n\t\t\t\t\t\t\t<Tags\n\t\t\t\t\t\t\t\ttags={info?.meta?.tags ?? []}\n\t\t\t\t\t\t\t\ton:delete={(e) => {\n\t\t\t\t\t\t\t\t\tconst tagName = e.detail;\n\t\t\t\t\t\t\t\t\tinfo.meta.tags = info.meta.tags.filter((tag) => tag.name !== tagName);\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\ton:add={(e) => {\n\t\t\t\t\t\t\t\t\tconst tagName = e.detail;\n\t\t\t\t\t\t\t\t\tif (!(info?.meta?.tags ?? null)) {\n\t\t\t\t\t\t\t\t\t\tinfo.meta.tags = [{ name: tagName }];\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tinfo.meta.tags = [...info.meta.tags, { name: tagName }];\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"my-2\">\n\t\t\t\t\t\t<div class=\"px-3 py-2 bg-gray-50 dark:bg-gray-950 rounded-lg\">\n\t\t\t\t\t\t\t<AccessControl bind:accessControl accessRoles={['read', 'write']} />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<hr class=\" border-gray-100 dark:border-gray-850 my-1.5\" />\n\n\t\t\t\t\t<div class=\"my-2\">\n\t\t\t\t\t\t<div class=\"flex w-full justify-between\">\n\t\t\t\t\t\t\t<div class=\" self-center text-sm font-semibold\">{$i18n.t('Model Params')}</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class=\"mt-2\">\n\t\t\t\t\t\t\t<div class=\"my-1\">\n\t\t\t\t\t\t\t\t<div class=\" text-xs font-semibold mb-2\">{$i18n.t('System Prompt')}</div>\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<Textarea\n\t\t\t\t\t\t\t\t\t\tclassName=\" text-sm w-full bg-transparent outline-hidden resize-none overflow-y-hidden \"\n\t\t\t\t\t\t\t\t\t\tplaceholder={`Write your model system prompt content here\\ne.g.) You are Mario from Super Mario Bros, acting as an assistant.`}\n\t\t\t\t\t\t\t\t\t\trows={4}\n\t\t\t\t\t\t\t\t\t\tbind:value={info.params.system}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div class=\"flex w-full justify-between\">\n\t\t\t\t\t\t\t\t<div class=\" self-center text-xs font-semibold\">\n\t\t\t\t\t\t\t\t\t{$i18n.t('Advanced Params')}\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tclass=\"p-1 px-3 text-xs flex rounded-sm transition\"\n\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\t\tshowAdvanced = !showAdvanced;\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{#if showAdvanced}\n\t\t\t\t\t\t\t\t\t\t<span class=\"ml-2 self-center\">{$i18n.t('Hide')}</span>\n\t\t\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t\t\t<span class=\"ml-2 self-center\">{$i18n.t('Show')}</span>\n\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t{#if showAdvanced}\n\t\t\t\t\t\t\t\t<div class=\"my-2\">\n\t\t\t\t\t\t\t\t\t<AdvancedParams\n\t\t\t\t\t\t\t\t\t\tadmin={true}\n\t\t\t\t\t\t\t\t\t\tbind:params\n\t\t\t\t\t\t\t\t\t\ton:change={(e) => {\n\t\t\t\t\t\t\t\t\t\t\tinfo.params = { ...info.params, ...params };\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<hr class=\" border-gray-100 dark:border-gray-850 my-1\" />\n\n\t\t\t\t\t<div class=\"my-2\">\n\t\t\t\t\t\t<div class=\"flex w-full justify-between items-center\">\n\t\t\t\t\t\t\t<div class=\"flex w-full justify-between items-center\">\n\t\t\t\t\t\t\t\t<div class=\" self-center text-sm font-semibold\">\n\t\t\t\t\t\t\t\t\t{$i18n.t('Prompt suggestions')}\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tclass=\"p-1 text-xs flex rounded-sm transition\"\n\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\t\tif ((info?.meta?.suggestion_prompts ?? null) === null) {\n\t\t\t\t\t\t\t\t\t\t\tinfo.meta.suggestion_prompts = [{ content: '' }];\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\tinfo.meta.suggestion_prompts = null;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{#if (info?.meta?.suggestion_prompts ?? null) === null}\n\t\t\t\t\t\t\t\t\t\t<span class=\"ml-2 self-center\">{$i18n.t('Default')}</span>\n\t\t\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t\t\t<span class=\"ml-2 self-center\">{$i18n.t('Custom')}</span>\n\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t{#if (info?.meta?.suggestion_prompts ?? null) !== null}\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tclass=\"p-1 px-2 text-xs flex rounded-sm transition\"\n\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t\t\tinfo.meta.suggestion_prompts.length === 0 ||\n\t\t\t\t\t\t\t\t\t\t\tinfo.meta.suggestion_prompts.at(-1).content !== ''\n\t\t\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\t\t\tinfo.meta.suggestion_prompts = [\n\t\t\t\t\t\t\t\t\t\t\t\t...info.meta.suggestion_prompts,\n\t\t\t\t\t\t\t\t\t\t\t\t{ content: '' }\n\t\t\t\t\t\t\t\t\t\t\t];\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 20 20\"\n\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\td=\"M10.75 4.75a.75.75 0 00-1.5 0v4.5h-4.5a.75.75 0 000 1.5h4.5v4.5a.75.75 0 001.5 0v-4.5h4.5a.75.75 0 000-1.5h-4.5v-4.5z\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t{#if info?.meta?.suggestion_prompts}\n\t\t\t\t\t\t\t<div class=\"flex flex-col space-y-1 mt-1 mb-3\">\n\t\t\t\t\t\t\t\t{#if info.meta.suggestion_prompts.length > 0}\n\t\t\t\t\t\t\t\t\t{#each info.meta.suggestion_prompts as prompt, promptIdx}\n\t\t\t\t\t\t\t\t\t\t<div class=\" flex rounded-lg\">\n\t\t\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\" text-sm w-full bg-transparent outline-hidden border-r border-gray-100 dark:border-gray-850\"\n\t\t\t\t\t\t\t\t\t\t\t\tplaceholder={$i18n.t('Write a prompt suggestion (e.g. Who are you?)')}\n\t\t\t\t\t\t\t\t\t\t\t\tbind:value={prompt.content}\n\t\t\t\t\t\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"px-2\"\n\t\t\t\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\t\t\t\t\tinfo.meta.suggestion_prompts.splice(promptIdx, 1);\n\t\t\t\t\t\t\t\t\t\t\t\t\tinfo.meta.suggestion_prompts = info.meta.suggestion_prompts;\n\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 20 20\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t\t<div class=\"text-xs text-center\">No suggestion prompts</div>\n\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<hr class=\" border-gray-100 dark:border-gray-850 my-1.5\" />\n\n\t\t\t\t\t<div class=\"my-2\">\n\t\t\t\t\t\t<Knowledge bind:selectedKnowledge={knowledge} collections={$knowledgeCollections} />\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"my-2\">\n\t\t\t\t\t\t<ToolsSelector bind:selectedToolIds={toolIds} tools={$tools} />\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"my-2\">\n\t\t\t\t\t\t<FiltersSelector\n\t\t\t\t\t\t\tbind:selectedFilterIds={filterIds}\n\t\t\t\t\t\t\tfilters={$functions.filter((func) => func.type === 'filter')}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"my-2\">\n\t\t\t\t\t\t<ActionsSelector\n\t\t\t\t\t\t\tbind:selectedActionIds={actionIds}\n\t\t\t\t\t\t\tactions={$functions.filter((func) => func.type === 'action')}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"my-2\">\n\t\t\t\t\t\t<Capabilities bind:capabilities />\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"my-2 text-gray-300 dark:text-gray-700\">\n\t\t\t\t\t\t<div class=\"flex w-full justify-between mb-2\">\n\t\t\t\t\t\t\t<div class=\" self-center text-sm font-semibold\">{$i18n.t('JSON Preview')}</div>\n\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclass=\"p-1 px-3 text-xs flex rounded-sm transition\"\n\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\tshowPreview = !showPreview;\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{#if showPreview}\n\t\t\t\t\t\t\t\t\t<span class=\"ml-2 self-center\">{$i18n.t('Hide')}</span>\n\t\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t\t<span class=\"ml-2 self-center\">{$i18n.t('Show')}</span>\n\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t{#if showPreview}\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\t\tclass=\"text-sm w-full bg-transparent outline-hidden resize-none\"\n\t\t\t\t\t\t\t\t\trows=\"10\"\n\t\t\t\t\t\t\t\t\tvalue={JSON.stringify(info, null, 2)}\n\t\t\t\t\t\t\t\t\tdisabled\n\t\t\t\t\t\t\t\t\treadonly\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"my-2 flex justify-end pb-20\">\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\" text-sm px-3 py-2 transition rounded-lg {loading\n\t\t\t\t\t\t\t\t? ' cursor-not-allowed bg-black hover:bg-gray-900 text-white dark:bg-white dark:hover:bg-gray-100 dark:text-black'\n\t\t\t\t\t\t\t\t: 'bg-black hover:bg-gray-900 text-white dark:bg-white dark:hover:bg-gray-100 dark:text-black'} flex w-full justify-center\"\n\t\t\t\t\t\t\ttype=\"submit\"\n\t\t\t\t\t\t\tdisabled={loading}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div class=\" self-center font-medium\">\n\t\t\t\t\t\t\t\t{#if edit}\n\t\t\t\t\t\t\t\t\t{$i18n.t('Save & Update')}\n\t\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t\t{$i18n.t('Save & Create')}\n\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t{#if loading}\n\t\t\t\t\t\t\t\t<div class=\"ml-1.5 self-center\">\n\t\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\t\tclass=\" w-4 h-4\"\n\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\t\t\t><style>\n\t\t\t\t\t\t\t\t\t\t\t.spinner_ajPY {\n\t\t\t\t\t\t\t\t\t\t\t\ttransform-origin: center;\n\t\t\t\t\t\t\t\t\t\t\t\tanimation: spinner_AtaB 0.75s infinite linear;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t@keyframes spinner_AtaB {\n\t\t\t\t\t\t\t\t\t\t\t\t100% {\n\t\t\t\t\t\t\t\t\t\t\t\t\ttransform: rotate(360deg);\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t</style><path\n\t\t\t\t\t\t\t\t\t\t\td=\"M12,1A11,11,0,1,0,23,12,11,11,0,0,0,12,1Zm0,19a8,8,0,1,1,8-8A8,8,0,0,1,12,20Z\"\n\t\t\t\t\t\t\t\t\t\t\topacity=\".25\"\n\t\t\t\t\t\t\t\t\t\t/><path\n\t\t\t\t\t\t\t\t\t\t\td=\"M10.14,1.16a11,11,0,0,0-9,8.92A1.59,1.59,0,0,0,2.46,12,1.52,1.52,0,0,0,4.11,10.7a8,8,0,0,1,6.66-6.61A1.42,1.42,0,0,0,12,2.69h0A1.57,1.57,0,0,0,10.14,1.16Z\"\n\t\t\t\t\t\t\t\t\t\t\tclass=\"spinner_ajPY\"\n\t\t\t\t\t\t\t\t\t\t/></svg\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</form>\n\t\t{/if}\n\t</div>\n{/if}\n","<script>\n\timport { v4 as uuidv4 } from 'uuid';\n\timport { toast } from 'svelte-sonner';\n\timport { goto } from '$app/navigation';\n\timport { config, models, settings } from '$lib/stores';\n\n\timport { onMount, tick, getContext } from 'svelte';\n\timport { createNewModel, getModelById } from '$lib/apis/models';\n\timport { getModels } from '$lib/apis';\n\n\timport ModelEditor from '$lib/components/workspace/Models/ModelEditor.svelte';\n\n\tconst i18n = getContext('i18n');\n\n\tconst onSubmit = async (modelInfo) => {\n\t\tif ($models.find((m) => m.id === modelInfo.id)) {\n\t\t\ttoast.error(\n\t\t\t\t`Error: A model with the ID '${modelInfo.id}' already exists. Please select a different ID to proceed.`\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\n\t\tif (modelInfo.id === '') {\n\t\t\ttoast.error('Error: Model ID cannot be empty. Please enter a valid ID to proceed.');\n\t\t\treturn;\n\t\t}\n\n\t\tif (modelInfo) {\n\t\t\tconst res = await createNewModel(localStorage.token, {\n\t\t\t\t...modelInfo,\n\t\t\t\tmeta: {\n\t\t\t\t\t...modelInfo.meta,\n\t\t\t\t\tprofile_image_url: modelInfo.meta.profile_image_url ?? '/static/favicon.png',\n\t\t\t\t\tsuggestion_prompts: modelInfo.meta.suggestion_prompts\n\t\t\t\t\t\t? modelInfo.meta.suggestion_prompts.filter((prompt) => prompt.content !== '')\n\t\t\t\t\t\t: null\n\t\t\t\t},\n\t\t\t\tparams: { ...modelInfo.params }\n\t\t\t}).catch((error) => {\n\t\t\t\ttoast.error(`${error}`);\n\t\t\t\treturn null;\n\t\t\t});\n\n\t\t\tif (res) {\n\t\t\t\tawait models.set(\n\t\t\t\t\tawait getModels(\n\t\t\t\t\t\tlocalStorage.token,\n\t\t\t\t\t\t$config?.features?.enable_direct_connections && ($settings?.directConnections ?? null)\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t\ttoast.success($i18n.t('Model created successfully!'));\n\t\t\t\tawait goto('/workspace/models');\n\t\t\t}\n\t\t}\n\t};\n\n\tlet model = null;\n\n\tonMount(async () => {\n\t\twindow.addEventListener('message', async (event) => {\n\t\t\tif (\n\t\t\t\t!['https://openwebui.com', 'https://www.openwebui.com', 'http://localhost:5173'].includes(\n\t\t\t\t\tevent.origin\n\t\t\t\t)\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet data = JSON.parse(event.data);\n\n\t\t\tif (data?.info) {\n\t\t\t\tdata = data.info;\n\t\t\t}\n\n\t\t\tmodel = data;\n\t\t});\n\n\t\tif (window.opener ?? false) {\n\t\t\twindow.opener.postMessage('loaded', '*');\n\t\t}\n\n\t\tif (sessionStorage.model) {\n\t\t\tmodel = JSON.parse(sessionStorage.model);\n\t\t\tsessionStorage.removeItem('model');\n\t\t}\n\t});\n</script>\n\n{#key model}\n\t<ModelEditor {model} {onSubmit} />\n{/key}\n"],"names":["res"],"mappings":";;;;;;;;;;;;;;AAgEa,MAAA,iBAAiB,OAAO,OAAe,UAAkB;AACrE,MAAI,QAAQ;AAEZ,QAAM,MAAM,MAAM,MAAM,GAAG,kBAAkB,kBAAkB;AAAA,IAC9D,QAAQ;AAAA,IACR,SAAS;AAAA,MACR,QAAQ;AAAA,MACR,gBAAgB;AAAA,MAChB,eAAe,UAAU,KAAK;AAAA,IAC/B;AAAA,IACA,MAAM,KAAK,UAAU,KAAK;AAAA,EAAA,CAC1B,EACC,KAAK,OAAOA,SAAQ;AACpB,QAAI,CAACA,KAAI,GAAU,OAAA,MAAMA,KAAI,KAAK;AAClC,WAAOA,KAAI,KAAK;AAAA,EAAA,CAChB,EACA,MAAM,CAAC,QAAQ;AACf,YAAQ,IAAI;AACZ,YAAQ,IAAI,GAAG;AACR,WAAA;AAAA,EAAA,CACP;AAEF,MAAI,OAAO;AACJ,UAAA;AAAA,EAAA;AAGA,SAAA;AACR;;;;;;;;;;;ACxEO,QAAA,OAAO,WAAW,MAAM;;AAEnB,MAAA,EAAA,SAAA,IAAA;QACA,SAA0B,KAAA,IAAA;QAE1B,QAAQ,KAAA,IAAA;QACR,OAAO,MAAA,IAAA;QAEP,SAAS,KAAA,IAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;QCfd,OAAO,WAAW,MAAM;;AAExB,QAAA,kBAAkB,cAAS;QAC5B,QAAQ,KAAM,OAAM,EAAE,OAAO,UAAU,EAAE,GAAA;AAC5C,YAAM,MAC0B,+BAAA,UAAU,EAAE,4DAAA;;;QAKzC,UAAU,OAAO,IAAE;AACtB,YAAM,MAAM,sEAAsE;;;QAI/E,WAAS;AACN,YAAA,MAAY,MAAA,eAAe,aAAa,OAAK;AAAA,WAC/C;AAAA,QACH,MAAI;AAAA,UACA,GAAA,UAAU;AAAA,UACb,mBAAmB,UAAU,KAAK,qBAAqB;AAAA,UACvD,oBAAoB,UAAU,KAAK,qBAChC,UAAU,KAAK,mBAAmB,OAAQ,YAAW,OAAO,YAAY,EAAE,IAC1E;AAAA;QAEJ,QAAM,EAAA,GAAO,UAAU,OAAM;AAAA,MAC3B,CAAA,EAAA,MAAO,WAAK;AACd,cAAM,MAAK,GAAI,KAAK,EAAA;eACb;AAAA;UAGJ,KAAG;AACA,cAAA,OAAO,IAAG,MACT,UACL,aAAa,OACb,SAAS,UAAU,8BAA8B,WAAW,qBAAqB,KAAI,CAAA;AAGvF,cAAM,QAAQ,MAAM,EAAE,6BAA6B,CAAA;AAC7C,cAAA,KAAwB;AAAA;;;AAK7B,MAAA,QAAQ;;;;;;;"}