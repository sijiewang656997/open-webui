{"version":3,"file":"BPycZvN5.js","sources":["../../../../../../node_modules/d3-selection/src/sourceEvent.js","../../../../../../node_modules/d3-selection/src/pointer.js","../../../../../../node_modules/d3-drag/src/noevent.js","../../../../../../node_modules/d3-drag/src/nodrag.js","../../../../../../node_modules/d3-drag/src/constant.js","../../../../../../node_modules/d3-drag/src/event.js","../../../../../../node_modules/d3-drag/src/drag.js","../../../../../../node_modules/d3-interpolate/src/zoom.js","../../../../../../node_modules/d3-zoom/src/constant.js","../../../../../../node_modules/d3-zoom/src/event.js","../../../../../../node_modules/d3-zoom/src/noevent.js","../../../../../../node_modules/d3-zoom/src/zoom.js","../../../../../../node_modules/eventsource-parser/dist/index.js","../../../../../../node_modules/eventsource-parser/dist/stream.js","../../../../../../src/lib/apis/streaming/index.ts","../../../../../../src/lib/components/common/Banner.svelte","../../../../../../src/lib/utils/google-drive-picker.ts","../../../../../../src/lib/utils/onedrive-file-picker.ts","../../../../../../src/lib/components/chat/MessageInput/InputMenu.svelte","../../../../../../src/lib/components/chat/MessageInput/Commands/Prompts.svelte","../../../../../../src/lib/components/chat/MessageInput/Commands/Knowledge.svelte","../../../../../../src/lib/components/chat/MessageInput/Commands/Models.svelte","../../../../../../src/lib/components/chat/MessageInput/Commands/DatabaseReferences.svelte","../../../../../../src/lib/components/chat/MessageInput/Commands.svelte","../../../../../../src/lib/components/icons/Photo.svelte","../../../../../../src/lib/components/chat/MessageInput.svelte","../../../../../../src/lib/components/chat/ModelSelector.svelte","../../../../../../src/lib/components/icons/Map.svelte","../../../../../../src/lib/components/icons/AdjustmentsHorizontal.svelte","../../../../../../src/lib/components/icons/Cube.svelte","../../../../../../src/lib/components/layout/Navbar/Menu.svelte","../../../../../../src/lib/components/chat/Navbar.svelte","../../../../../../node_modules/classcat/index.js","../../../../../../node_modules/@xyflow/system/dist/esm/index.js","../../../../../../node_modules/@xyflow/svelte/dist/lib/components/Handle/Handle.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/components/nodes/DefaultNode.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/components/nodes/InputNode.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/components/nodes/OutputNode.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/actions/portal/index.js","../../../../../../node_modules/@xyflow/svelte/dist/lib/components/EdgeLabelRenderer/EdgeLabelRenderer.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/hooks/useHandleEdgeSelect.js","../../../../../../node_modules/@xyflow/svelte/dist/lib/components/EdgeLabel/EdgeLabel.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/components/BaseEdge/BaseEdge.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/components/edges/BezierEdgeInternal.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/components/edges/SmoothStepEdgeInternal.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/components/edges/StraightEdgeInternal.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/components/edges/StepEdgeInternal.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/store/utils.js","../../../../../../node_modules/@xyflow/svelte/dist/lib/store/initial-store.js","../../../../../../node_modules/@xyflow/svelte/dist/lib/store/visible-edges.js","../../../../../../node_modules/@xyflow/svelte/dist/lib/store/visible-nodes.js","../../../../../../node_modules/@xyflow/svelte/dist/lib/store/index.js","../../../../../../node_modules/@xyflow/svelte/dist/lib/actions/zoom/index.js","../../../../../../node_modules/@xyflow/svelte/dist/lib/container/Zoom/Zoom.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/container/Pane/Pane.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/container/Viewport/Viewport.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/actions/drag/index.js","../../../../../../node_modules/@xyflow/svelte/dist/lib/components/NodeWrapper/utils.js","../../../../../../node_modules/@xyflow/svelte/dist/lib/components/NodeWrapper/NodeWrapper.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/container/NodeRenderer/NodeRenderer.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/components/EdgeWrapper/EdgeWrapper.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/components/CallOnMount/CallOnMount.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/container/EdgeRenderer/MarkerDefinition/MarkerDefinition.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/container/EdgeRenderer/MarkerDefinition/Marker.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/container/EdgeRenderer/EdgeRenderer.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/components/Selection/Selection.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/components/UserSelection/UserSelection.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/components/NodeSelection/NodeSelection.svelte","../../../../../../node_modules/@svelte-put/shortcut/src/shortcut.js","../../../../../../node_modules/@xyflow/svelte/dist/lib/components/KeyHandler/KeyHandler.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/components/ConnectionLine/ConnectionLine.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/container/Panel/Panel.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/components/Attribution/Attribution.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/container/SvelteFlow/utils.js","../../../../../../node_modules/@xyflow/svelte/dist/lib/hooks/useColorModeClass.js","../../../../../../node_modules/@xyflow/svelte/dist/lib/container/SvelteFlow/SvelteFlow.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/components/SvelteFlowProvider/SvelteFlowProvider.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/plugins/Controls/ControlButton.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/plugins/Controls/Icons/Plus.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/plugins/Controls/Icons/Minus.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/plugins/Controls/Icons/Fit.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/plugins/Controls/Icons/Lock.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/plugins/Controls/Icons/Unlock.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/plugins/Controls/Controls.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/plugins/Background/types.js","../../../../../../node_modules/@xyflow/svelte/dist/lib/plugins/Background/DotPattern.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/plugins/Background/LinePattern.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/plugins/Background/Background.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/utils/index.js","../../../../../../node_modules/@xyflow/svelte/dist/lib/hooks/useSvelteFlow.js","../../../../../../node_modules/@xyflow/svelte/dist/lib/hooks/useInitialized.js","../../../../../../src/lib/components/chat/Controls/Valves.svelte","../../../../../../src/lib/components/chat/Controls/Controls.svelte","../../../../../../src/lib/components/chat/MessageInput/CallOverlay/VideoInputMenu.svelte","../../../../../../src/lib/components/chat/MessageInput/CallOverlay.svelte","../../../../../../src/lib/components/chat/Overview/Node.svelte","../../../../../../src/lib/components/chat/Overview/Flow.svelte","../../../../../../src/lib/components/icons/ArrowLeft.svelte","../../../../../../src/lib/components/chat/Overview.svelte","../../../../../../src/lib/components/icons/ArrowsPointingOut.svelte","../../../../../../src/lib/components/chat/Artifacts.svelte","../../../../../../src/lib/components/chat/ChatControls.svelte","../../../../../../src/lib/components/chat/Placeholder.svelte","../../../../../../src/lib/components/chat/Chat.svelte","../../../../../../src/lib/components/chat/ShortcutsModal.svelte","../../../../../../src/lib/components/icons/QuestionMarkCircle.svelte","../../../../../../src/lib/components/icons/Keyboard.svelte","../../../../../../src/lib/components/layout/Help/HelpMenu.svelte","../../../../../../src/lib/components/layout/Help.svelte"],"sourcesContent":["export default function(event) {\n  let sourceEvent;\n  while (sourceEvent = event.sourceEvent) event = sourceEvent;\n  return event;\n}\n","import sourceEvent from \"./sourceEvent.js\";\n\nexport default function(event, node) {\n  event = sourceEvent(event);\n  if (node === undefined) node = event.currentTarget;\n  if (node) {\n    var svg = node.ownerSVGElement || node;\n    if (svg.createSVGPoint) {\n      var point = svg.createSVGPoint();\n      point.x = event.clientX, point.y = event.clientY;\n      point = point.matrixTransform(node.getScreenCTM().inverse());\n      return [point.x, point.y];\n    }\n    if (node.getBoundingClientRect) {\n      var rect = node.getBoundingClientRect();\n      return [event.clientX - rect.left - node.clientLeft, event.clientY - rect.top - node.clientTop];\n    }\n  }\n  return [event.pageX, event.pageY];\n}\n","// These are typically used in conjunction with noevent to ensure that we can\n// preventDefault on the event.\nexport const nonpassive = {passive: false};\nexport const nonpassivecapture = {capture: true, passive: false};\n\nexport function nopropagation(event) {\n  event.stopImmediatePropagation();\n}\n\nexport default function(event) {\n  event.preventDefault();\n  event.stopImmediatePropagation();\n}\n","import {select} from \"d3-selection\";\nimport noevent, {nonpassivecapture} from \"./noevent.js\";\n\nexport default function(view) {\n  var root = view.document.documentElement,\n      selection = select(view).on(\"dragstart.drag\", noevent, nonpassivecapture);\n  if (\"onselectstart\" in root) {\n    selection.on(\"selectstart.drag\", noevent, nonpassivecapture);\n  } else {\n    root.__noselect = root.style.MozUserSelect;\n    root.style.MozUserSelect = \"none\";\n  }\n}\n\nexport function yesdrag(view, noclick) {\n  var root = view.document.documentElement,\n      selection = select(view).on(\"dragstart.drag\", null);\n  if (noclick) {\n    selection.on(\"click.drag\", noevent, nonpassivecapture);\n    setTimeout(function() { selection.on(\"click.drag\", null); }, 0);\n  }\n  if (\"onselectstart\" in root) {\n    selection.on(\"selectstart.drag\", null);\n  } else {\n    root.style.MozUserSelect = root.__noselect;\n    delete root.__noselect;\n  }\n}\n","export default x => () => x;\n","export default function DragEvent(type, {\n  sourceEvent,\n  subject,\n  target,\n  identifier,\n  active,\n  x, y, dx, dy,\n  dispatch\n}) {\n  Object.defineProperties(this, {\n    type: {value: type, enumerable: true, configurable: true},\n    sourceEvent: {value: sourceEvent, enumerable: true, configurable: true},\n    subject: {value: subject, enumerable: true, configurable: true},\n    target: {value: target, enumerable: true, configurable: true},\n    identifier: {value: identifier, enumerable: true, configurable: true},\n    active: {value: active, enumerable: true, configurable: true},\n    x: {value: x, enumerable: true, configurable: true},\n    y: {value: y, enumerable: true, configurable: true},\n    dx: {value: dx, enumerable: true, configurable: true},\n    dy: {value: dy, enumerable: true, configurable: true},\n    _: {value: dispatch}\n  });\n}\n\nDragEvent.prototype.on = function() {\n  var value = this._.on.apply(this._, arguments);\n  return value === this._ ? this : value;\n};\n","import {dispatch} from \"d3-dispatch\";\nimport {select, pointer} from \"d3-selection\";\nimport nodrag, {yesdrag} from \"./nodrag.js\";\nimport noevent, {nonpassive, nonpassivecapture, nopropagation} from \"./noevent.js\";\nimport constant from \"./constant.js\";\nimport DragEvent from \"./event.js\";\n\n// Ignore right-click, since that should open the context menu.\nfunction defaultFilter(event) {\n  return !event.ctrlKey && !event.button;\n}\n\nfunction defaultContainer() {\n  return this.parentNode;\n}\n\nfunction defaultSubject(event, d) {\n  return d == null ? {x: event.x, y: event.y} : d;\n}\n\nfunction defaultTouchable() {\n  return navigator.maxTouchPoints || (\"ontouchstart\" in this);\n}\n\nexport default function() {\n  var filter = defaultFilter,\n      container = defaultContainer,\n      subject = defaultSubject,\n      touchable = defaultTouchable,\n      gestures = {},\n      listeners = dispatch(\"start\", \"drag\", \"end\"),\n      active = 0,\n      mousedownx,\n      mousedowny,\n      mousemoving,\n      touchending,\n      clickDistance2 = 0;\n\n  function drag(selection) {\n    selection\n        .on(\"mousedown.drag\", mousedowned)\n      .filter(touchable)\n        .on(\"touchstart.drag\", touchstarted)\n        .on(\"touchmove.drag\", touchmoved, nonpassive)\n        .on(\"touchend.drag touchcancel.drag\", touchended)\n        .style(\"touch-action\", \"none\")\n        .style(\"-webkit-tap-highlight-color\", \"rgba(0,0,0,0)\");\n  }\n\n  function mousedowned(event, d) {\n    if (touchending || !filter.call(this, event, d)) return;\n    var gesture = beforestart(this, container.call(this, event, d), event, d, \"mouse\");\n    if (!gesture) return;\n    select(event.view)\n      .on(\"mousemove.drag\", mousemoved, nonpassivecapture)\n      .on(\"mouseup.drag\", mouseupped, nonpassivecapture);\n    nodrag(event.view);\n    nopropagation(event);\n    mousemoving = false;\n    mousedownx = event.clientX;\n    mousedowny = event.clientY;\n    gesture(\"start\", event);\n  }\n\n  function mousemoved(event) {\n    noevent(event);\n    if (!mousemoving) {\n      var dx = event.clientX - mousedownx, dy = event.clientY - mousedowny;\n      mousemoving = dx * dx + dy * dy > clickDistance2;\n    }\n    gestures.mouse(\"drag\", event);\n  }\n\n  function mouseupped(event) {\n    select(event.view).on(\"mousemove.drag mouseup.drag\", null);\n    yesdrag(event.view, mousemoving);\n    noevent(event);\n    gestures.mouse(\"end\", event);\n  }\n\n  function touchstarted(event, d) {\n    if (!filter.call(this, event, d)) return;\n    var touches = event.changedTouches,\n        c = container.call(this, event, d),\n        n = touches.length, i, gesture;\n\n    for (i = 0; i < n; ++i) {\n      if (gesture = beforestart(this, c, event, d, touches[i].identifier, touches[i])) {\n        nopropagation(event);\n        gesture(\"start\", event, touches[i]);\n      }\n    }\n  }\n\n  function touchmoved(event) {\n    var touches = event.changedTouches,\n        n = touches.length, i, gesture;\n\n    for (i = 0; i < n; ++i) {\n      if (gesture = gestures[touches[i].identifier]) {\n        noevent(event);\n        gesture(\"drag\", event, touches[i]);\n      }\n    }\n  }\n\n  function touchended(event) {\n    var touches = event.changedTouches,\n        n = touches.length, i, gesture;\n\n    if (touchending) clearTimeout(touchending);\n    touchending = setTimeout(function() { touchending = null; }, 500); // Ghost clicks are delayed!\n    for (i = 0; i < n; ++i) {\n      if (gesture = gestures[touches[i].identifier]) {\n        nopropagation(event);\n        gesture(\"end\", event, touches[i]);\n      }\n    }\n  }\n\n  function beforestart(that, container, event, d, identifier, touch) {\n    var dispatch = listeners.copy(),\n        p = pointer(touch || event, container), dx, dy,\n        s;\n\n    if ((s = subject.call(that, new DragEvent(\"beforestart\", {\n        sourceEvent: event,\n        target: drag,\n        identifier,\n        active,\n        x: p[0],\n        y: p[1],\n        dx: 0,\n        dy: 0,\n        dispatch\n      }), d)) == null) return;\n\n    dx = s.x - p[0] || 0;\n    dy = s.y - p[1] || 0;\n\n    return function gesture(type, event, touch) {\n      var p0 = p, n;\n      switch (type) {\n        case \"start\": gestures[identifier] = gesture, n = active++; break;\n        case \"end\": delete gestures[identifier], --active; // falls through\n        case \"drag\": p = pointer(touch || event, container), n = active; break;\n      }\n      dispatch.call(\n        type,\n        that,\n        new DragEvent(type, {\n          sourceEvent: event,\n          subject: s,\n          target: drag,\n          identifier,\n          active: n,\n          x: p[0] + dx,\n          y: p[1] + dy,\n          dx: p[0] - p0[0],\n          dy: p[1] - p0[1],\n          dispatch\n        }),\n        d\n      );\n    };\n  }\n\n  drag.filter = function(_) {\n    return arguments.length ? (filter = typeof _ === \"function\" ? _ : constant(!!_), drag) : filter;\n  };\n\n  drag.container = function(_) {\n    return arguments.length ? (container = typeof _ === \"function\" ? _ : constant(_), drag) : container;\n  };\n\n  drag.subject = function(_) {\n    return arguments.length ? (subject = typeof _ === \"function\" ? _ : constant(_), drag) : subject;\n  };\n\n  drag.touchable = function(_) {\n    return arguments.length ? (touchable = typeof _ === \"function\" ? _ : constant(!!_), drag) : touchable;\n  };\n\n  drag.on = function() {\n    var value = listeners.on.apply(listeners, arguments);\n    return value === listeners ? drag : value;\n  };\n\n  drag.clickDistance = function(_) {\n    return arguments.length ? (clickDistance2 = (_ = +_) * _, drag) : Math.sqrt(clickDistance2);\n  };\n\n  return drag;\n}\n","var epsilon2 = 1e-12;\n\nfunction cosh(x) {\n  return ((x = Math.exp(x)) + 1 / x) / 2;\n}\n\nfunction sinh(x) {\n  return ((x = Math.exp(x)) - 1 / x) / 2;\n}\n\nfunction tanh(x) {\n  return ((x = Math.exp(2 * x)) - 1) / (x + 1);\n}\n\nexport default (function zoomRho(rho, rho2, rho4) {\n\n  // p0 = [ux0, uy0, w0]\n  // p1 = [ux1, uy1, w1]\n  function zoom(p0, p1) {\n    var ux0 = p0[0], uy0 = p0[1], w0 = p0[2],\n        ux1 = p1[0], uy1 = p1[1], w1 = p1[2],\n        dx = ux1 - ux0,\n        dy = uy1 - uy0,\n        d2 = dx * dx + dy * dy,\n        i,\n        S;\n\n    // Special case for u0 ≅ u1.\n    if (d2 < epsilon2) {\n      S = Math.log(w1 / w0) / rho;\n      i = function(t) {\n        return [\n          ux0 + t * dx,\n          uy0 + t * dy,\n          w0 * Math.exp(rho * t * S)\n        ];\n      }\n    }\n\n    // General case.\n    else {\n      var d1 = Math.sqrt(d2),\n          b0 = (w1 * w1 - w0 * w0 + rho4 * d2) / (2 * w0 * rho2 * d1),\n          b1 = (w1 * w1 - w0 * w0 - rho4 * d2) / (2 * w1 * rho2 * d1),\n          r0 = Math.log(Math.sqrt(b0 * b0 + 1) - b0),\n          r1 = Math.log(Math.sqrt(b1 * b1 + 1) - b1);\n      S = (r1 - r0) / rho;\n      i = function(t) {\n        var s = t * S,\n            coshr0 = cosh(r0),\n            u = w0 / (rho2 * d1) * (coshr0 * tanh(rho * s + r0) - sinh(r0));\n        return [\n          ux0 + u * dx,\n          uy0 + u * dy,\n          w0 * coshr0 / cosh(rho * s + r0)\n        ];\n      }\n    }\n\n    i.duration = S * 1000 * rho / Math.SQRT2;\n\n    return i;\n  }\n\n  zoom.rho = function(_) {\n    var _1 = Math.max(1e-3, +_), _2 = _1 * _1, _4 = _2 * _2;\n    return zoomRho(_1, _2, _4);\n  };\n\n  return zoom;\n})(Math.SQRT2, 2, 4);\n","export default x => () => x;\n","export default function ZoomEvent(type, {\n  sourceEvent,\n  target,\n  transform,\n  dispatch\n}) {\n  Object.defineProperties(this, {\n    type: {value: type, enumerable: true, configurable: true},\n    sourceEvent: {value: sourceEvent, enumerable: true, configurable: true},\n    target: {value: target, enumerable: true, configurable: true},\n    transform: {value: transform, enumerable: true, configurable: true},\n    _: {value: dispatch}\n  });\n}\n","export function nopropagation(event) {\n  event.stopImmediatePropagation();\n}\n\nexport default function(event) {\n  event.preventDefault();\n  event.stopImmediatePropagation();\n}\n","import {dispatch} from \"d3-dispatch\";\nimport {dragDisable, dragEnable} from \"d3-drag\";\nimport {interpolateZoom} from \"d3-interpolate\";\nimport {select, pointer} from \"d3-selection\";\nimport {interrupt} from \"d3-transition\";\nimport constant from \"./constant.js\";\nimport ZoomEvent from \"./event.js\";\nimport {Transform, identity} from \"./transform.js\";\nimport noevent, {nopropagation} from \"./noevent.js\";\n\n// Ignore right-click, since that should open the context menu.\n// except for pinch-to-zoom, which is sent as a wheel+ctrlKey event\nfunction defaultFilter(event) {\n  return (!event.ctrlKey || event.type === 'wheel') && !event.button;\n}\n\nfunction defaultExtent() {\n  var e = this;\n  if (e instanceof SVGElement) {\n    e = e.ownerSVGElement || e;\n    if (e.hasAttribute(\"viewBox\")) {\n      e = e.viewBox.baseVal;\n      return [[e.x, e.y], [e.x + e.width, e.y + e.height]];\n    }\n    return [[0, 0], [e.width.baseVal.value, e.height.baseVal.value]];\n  }\n  return [[0, 0], [e.clientWidth, e.clientHeight]];\n}\n\nfunction defaultTransform() {\n  return this.__zoom || identity;\n}\n\nfunction defaultWheelDelta(event) {\n  return -event.deltaY * (event.deltaMode === 1 ? 0.05 : event.deltaMode ? 1 : 0.002) * (event.ctrlKey ? 10 : 1);\n}\n\nfunction defaultTouchable() {\n  return navigator.maxTouchPoints || (\"ontouchstart\" in this);\n}\n\nfunction defaultConstrain(transform, extent, translateExtent) {\n  var dx0 = transform.invertX(extent[0][0]) - translateExtent[0][0],\n      dx1 = transform.invertX(extent[1][0]) - translateExtent[1][0],\n      dy0 = transform.invertY(extent[0][1]) - translateExtent[0][1],\n      dy1 = transform.invertY(extent[1][1]) - translateExtent[1][1];\n  return transform.translate(\n    dx1 > dx0 ? (dx0 + dx1) / 2 : Math.min(0, dx0) || Math.max(0, dx1),\n    dy1 > dy0 ? (dy0 + dy1) / 2 : Math.min(0, dy0) || Math.max(0, dy1)\n  );\n}\n\nexport default function() {\n  var filter = defaultFilter,\n      extent = defaultExtent,\n      constrain = defaultConstrain,\n      wheelDelta = defaultWheelDelta,\n      touchable = defaultTouchable,\n      scaleExtent = [0, Infinity],\n      translateExtent = [[-Infinity, -Infinity], [Infinity, Infinity]],\n      duration = 250,\n      interpolate = interpolateZoom,\n      listeners = dispatch(\"start\", \"zoom\", \"end\"),\n      touchstarting,\n      touchfirst,\n      touchending,\n      touchDelay = 500,\n      wheelDelay = 150,\n      clickDistance2 = 0,\n      tapDistance = 10;\n\n  function zoom(selection) {\n    selection\n        .property(\"__zoom\", defaultTransform)\n        .on(\"wheel.zoom\", wheeled, {passive: false})\n        .on(\"mousedown.zoom\", mousedowned)\n        .on(\"dblclick.zoom\", dblclicked)\n      .filter(touchable)\n        .on(\"touchstart.zoom\", touchstarted)\n        .on(\"touchmove.zoom\", touchmoved)\n        .on(\"touchend.zoom touchcancel.zoom\", touchended)\n        .style(\"-webkit-tap-highlight-color\", \"rgba(0,0,0,0)\");\n  }\n\n  zoom.transform = function(collection, transform, point, event) {\n    var selection = collection.selection ? collection.selection() : collection;\n    selection.property(\"__zoom\", defaultTransform);\n    if (collection !== selection) {\n      schedule(collection, transform, point, event);\n    } else {\n      selection.interrupt().each(function() {\n        gesture(this, arguments)\n          .event(event)\n          .start()\n          .zoom(null, typeof transform === \"function\" ? transform.apply(this, arguments) : transform)\n          .end();\n      });\n    }\n  };\n\n  zoom.scaleBy = function(selection, k, p, event) {\n    zoom.scaleTo(selection, function() {\n      var k0 = this.__zoom.k,\n          k1 = typeof k === \"function\" ? k.apply(this, arguments) : k;\n      return k0 * k1;\n    }, p, event);\n  };\n\n  zoom.scaleTo = function(selection, k, p, event) {\n    zoom.transform(selection, function() {\n      var e = extent.apply(this, arguments),\n          t0 = this.__zoom,\n          p0 = p == null ? centroid(e) : typeof p === \"function\" ? p.apply(this, arguments) : p,\n          p1 = t0.invert(p0),\n          k1 = typeof k === \"function\" ? k.apply(this, arguments) : k;\n      return constrain(translate(scale(t0, k1), p0, p1), e, translateExtent);\n    }, p, event);\n  };\n\n  zoom.translateBy = function(selection, x, y, event) {\n    zoom.transform(selection, function() {\n      return constrain(this.__zoom.translate(\n        typeof x === \"function\" ? x.apply(this, arguments) : x,\n        typeof y === \"function\" ? y.apply(this, arguments) : y\n      ), extent.apply(this, arguments), translateExtent);\n    }, null, event);\n  };\n\n  zoom.translateTo = function(selection, x, y, p, event) {\n    zoom.transform(selection, function() {\n      var e = extent.apply(this, arguments),\n          t = this.__zoom,\n          p0 = p == null ? centroid(e) : typeof p === \"function\" ? p.apply(this, arguments) : p;\n      return constrain(identity.translate(p0[0], p0[1]).scale(t.k).translate(\n        typeof x === \"function\" ? -x.apply(this, arguments) : -x,\n        typeof y === \"function\" ? -y.apply(this, arguments) : -y\n      ), e, translateExtent);\n    }, p, event);\n  };\n\n  function scale(transform, k) {\n    k = Math.max(scaleExtent[0], Math.min(scaleExtent[1], k));\n    return k === transform.k ? transform : new Transform(k, transform.x, transform.y);\n  }\n\n  function translate(transform, p0, p1) {\n    var x = p0[0] - p1[0] * transform.k, y = p0[1] - p1[1] * transform.k;\n    return x === transform.x && y === transform.y ? transform : new Transform(transform.k, x, y);\n  }\n\n  function centroid(extent) {\n    return [(+extent[0][0] + +extent[1][0]) / 2, (+extent[0][1] + +extent[1][1]) / 2];\n  }\n\n  function schedule(transition, transform, point, event) {\n    transition\n        .on(\"start.zoom\", function() { gesture(this, arguments).event(event).start(); })\n        .on(\"interrupt.zoom end.zoom\", function() { gesture(this, arguments).event(event).end(); })\n        .tween(\"zoom\", function() {\n          var that = this,\n              args = arguments,\n              g = gesture(that, args).event(event),\n              e = extent.apply(that, args),\n              p = point == null ? centroid(e) : typeof point === \"function\" ? point.apply(that, args) : point,\n              w = Math.max(e[1][0] - e[0][0], e[1][1] - e[0][1]),\n              a = that.__zoom,\n              b = typeof transform === \"function\" ? transform.apply(that, args) : transform,\n              i = interpolate(a.invert(p).concat(w / a.k), b.invert(p).concat(w / b.k));\n          return function(t) {\n            if (t === 1) t = b; // Avoid rounding error on end.\n            else { var l = i(t), k = w / l[2]; t = new Transform(k, p[0] - l[0] * k, p[1] - l[1] * k); }\n            g.zoom(null, t);\n          };\n        });\n  }\n\n  function gesture(that, args, clean) {\n    return (!clean && that.__zooming) || new Gesture(that, args);\n  }\n\n  function Gesture(that, args) {\n    this.that = that;\n    this.args = args;\n    this.active = 0;\n    this.sourceEvent = null;\n    this.extent = extent.apply(that, args);\n    this.taps = 0;\n  }\n\n  Gesture.prototype = {\n    event: function(event) {\n      if (event) this.sourceEvent = event;\n      return this;\n    },\n    start: function() {\n      if (++this.active === 1) {\n        this.that.__zooming = this;\n        this.emit(\"start\");\n      }\n      return this;\n    },\n    zoom: function(key, transform) {\n      if (this.mouse && key !== \"mouse\") this.mouse[1] = transform.invert(this.mouse[0]);\n      if (this.touch0 && key !== \"touch\") this.touch0[1] = transform.invert(this.touch0[0]);\n      if (this.touch1 && key !== \"touch\") this.touch1[1] = transform.invert(this.touch1[0]);\n      this.that.__zoom = transform;\n      this.emit(\"zoom\");\n      return this;\n    },\n    end: function() {\n      if (--this.active === 0) {\n        delete this.that.__zooming;\n        this.emit(\"end\");\n      }\n      return this;\n    },\n    emit: function(type) {\n      var d = select(this.that).datum();\n      listeners.call(\n        type,\n        this.that,\n        new ZoomEvent(type, {\n          sourceEvent: this.sourceEvent,\n          target: zoom,\n          type,\n          transform: this.that.__zoom,\n          dispatch: listeners\n        }),\n        d\n      );\n    }\n  };\n\n  function wheeled(event, ...args) {\n    if (!filter.apply(this, arguments)) return;\n    var g = gesture(this, args).event(event),\n        t = this.__zoom,\n        k = Math.max(scaleExtent[0], Math.min(scaleExtent[1], t.k * Math.pow(2, wheelDelta.apply(this, arguments)))),\n        p = pointer(event);\n\n    // If the mouse is in the same location as before, reuse it.\n    // If there were recent wheel events, reset the wheel idle timeout.\n    if (g.wheel) {\n      if (g.mouse[0][0] !== p[0] || g.mouse[0][1] !== p[1]) {\n        g.mouse[1] = t.invert(g.mouse[0] = p);\n      }\n      clearTimeout(g.wheel);\n    }\n\n    // If this wheel event won’t trigger a transform change, ignore it.\n    else if (t.k === k) return;\n\n    // Otherwise, capture the mouse point and location at the start.\n    else {\n      g.mouse = [p, t.invert(p)];\n      interrupt(this);\n      g.start();\n    }\n\n    noevent(event);\n    g.wheel = setTimeout(wheelidled, wheelDelay);\n    g.zoom(\"mouse\", constrain(translate(scale(t, k), g.mouse[0], g.mouse[1]), g.extent, translateExtent));\n\n    function wheelidled() {\n      g.wheel = null;\n      g.end();\n    }\n  }\n\n  function mousedowned(event, ...args) {\n    if (touchending || !filter.apply(this, arguments)) return;\n    var currentTarget = event.currentTarget,\n        g = gesture(this, args, true).event(event),\n        v = select(event.view).on(\"mousemove.zoom\", mousemoved, true).on(\"mouseup.zoom\", mouseupped, true),\n        p = pointer(event, currentTarget),\n        x0 = event.clientX,\n        y0 = event.clientY;\n\n    dragDisable(event.view);\n    nopropagation(event);\n    g.mouse = [p, this.__zoom.invert(p)];\n    interrupt(this);\n    g.start();\n\n    function mousemoved(event) {\n      noevent(event);\n      if (!g.moved) {\n        var dx = event.clientX - x0, dy = event.clientY - y0;\n        g.moved = dx * dx + dy * dy > clickDistance2;\n      }\n      g.event(event)\n       .zoom(\"mouse\", constrain(translate(g.that.__zoom, g.mouse[0] = pointer(event, currentTarget), g.mouse[1]), g.extent, translateExtent));\n    }\n\n    function mouseupped(event) {\n      v.on(\"mousemove.zoom mouseup.zoom\", null);\n      dragEnable(event.view, g.moved);\n      noevent(event);\n      g.event(event).end();\n    }\n  }\n\n  function dblclicked(event, ...args) {\n    if (!filter.apply(this, arguments)) return;\n    var t0 = this.__zoom,\n        p0 = pointer(event.changedTouches ? event.changedTouches[0] : event, this),\n        p1 = t0.invert(p0),\n        k1 = t0.k * (event.shiftKey ? 0.5 : 2),\n        t1 = constrain(translate(scale(t0, k1), p0, p1), extent.apply(this, args), translateExtent);\n\n    noevent(event);\n    if (duration > 0) select(this).transition().duration(duration).call(schedule, t1, p0, event);\n    else select(this).call(zoom.transform, t1, p0, event);\n  }\n\n  function touchstarted(event, ...args) {\n    if (!filter.apply(this, arguments)) return;\n    var touches = event.touches,\n        n = touches.length,\n        g = gesture(this, args, event.changedTouches.length === n).event(event),\n        started, i, t, p;\n\n    nopropagation(event);\n    for (i = 0; i < n; ++i) {\n      t = touches[i], p = pointer(t, this);\n      p = [p, this.__zoom.invert(p), t.identifier];\n      if (!g.touch0) g.touch0 = p, started = true, g.taps = 1 + !!touchstarting;\n      else if (!g.touch1 && g.touch0[2] !== p[2]) g.touch1 = p, g.taps = 0;\n    }\n\n    if (touchstarting) touchstarting = clearTimeout(touchstarting);\n\n    if (started) {\n      if (g.taps < 2) touchfirst = p[0], touchstarting = setTimeout(function() { touchstarting = null; }, touchDelay);\n      interrupt(this);\n      g.start();\n    }\n  }\n\n  function touchmoved(event, ...args) {\n    if (!this.__zooming) return;\n    var g = gesture(this, args).event(event),\n        touches = event.changedTouches,\n        n = touches.length, i, t, p, l;\n\n    noevent(event);\n    for (i = 0; i < n; ++i) {\n      t = touches[i], p = pointer(t, this);\n      if (g.touch0 && g.touch0[2] === t.identifier) g.touch0[0] = p;\n      else if (g.touch1 && g.touch1[2] === t.identifier) g.touch1[0] = p;\n    }\n    t = g.that.__zoom;\n    if (g.touch1) {\n      var p0 = g.touch0[0], l0 = g.touch0[1],\n          p1 = g.touch1[0], l1 = g.touch1[1],\n          dp = (dp = p1[0] - p0[0]) * dp + (dp = p1[1] - p0[1]) * dp,\n          dl = (dl = l1[0] - l0[0]) * dl + (dl = l1[1] - l0[1]) * dl;\n      t = scale(t, Math.sqrt(dp / dl));\n      p = [(p0[0] + p1[0]) / 2, (p0[1] + p1[1]) / 2];\n      l = [(l0[0] + l1[0]) / 2, (l0[1] + l1[1]) / 2];\n    }\n    else if (g.touch0) p = g.touch0[0], l = g.touch0[1];\n    else return;\n\n    g.zoom(\"touch\", constrain(translate(t, p, l), g.extent, translateExtent));\n  }\n\n  function touchended(event, ...args) {\n    if (!this.__zooming) return;\n    var g = gesture(this, args).event(event),\n        touches = event.changedTouches,\n        n = touches.length, i, t;\n\n    nopropagation(event);\n    if (touchending) clearTimeout(touchending);\n    touchending = setTimeout(function() { touchending = null; }, touchDelay);\n    for (i = 0; i < n; ++i) {\n      t = touches[i];\n      if (g.touch0 && g.touch0[2] === t.identifier) delete g.touch0;\n      else if (g.touch1 && g.touch1[2] === t.identifier) delete g.touch1;\n    }\n    if (g.touch1 && !g.touch0) g.touch0 = g.touch1, delete g.touch1;\n    if (g.touch0) g.touch0[1] = this.__zoom.invert(g.touch0[0]);\n    else {\n      g.end();\n      // If this was a dbltap, reroute to the (optional) dblclick.zoom handler.\n      if (g.taps === 2) {\n        t = pointer(t, this);\n        if (Math.hypot(touchfirst[0] - t[0], touchfirst[1] - t[1]) < tapDistance) {\n          var p = select(this).on(\"dblclick.zoom\");\n          if (p) p.apply(this, arguments);\n        }\n      }\n    }\n  }\n\n  zoom.wheelDelta = function(_) {\n    return arguments.length ? (wheelDelta = typeof _ === \"function\" ? _ : constant(+_), zoom) : wheelDelta;\n  };\n\n  zoom.filter = function(_) {\n    return arguments.length ? (filter = typeof _ === \"function\" ? _ : constant(!!_), zoom) : filter;\n  };\n\n  zoom.touchable = function(_) {\n    return arguments.length ? (touchable = typeof _ === \"function\" ? _ : constant(!!_), zoom) : touchable;\n  };\n\n  zoom.extent = function(_) {\n    return arguments.length ? (extent = typeof _ === \"function\" ? _ : constant([[+_[0][0], +_[0][1]], [+_[1][0], +_[1][1]]]), zoom) : extent;\n  };\n\n  zoom.scaleExtent = function(_) {\n    return arguments.length ? (scaleExtent[0] = +_[0], scaleExtent[1] = +_[1], zoom) : [scaleExtent[0], scaleExtent[1]];\n  };\n\n  zoom.translateExtent = function(_) {\n    return arguments.length ? (translateExtent[0][0] = +_[0][0], translateExtent[1][0] = +_[1][0], translateExtent[0][1] = +_[0][1], translateExtent[1][1] = +_[1][1], zoom) : [[translateExtent[0][0], translateExtent[0][1]], [translateExtent[1][0], translateExtent[1][1]]];\n  };\n\n  zoom.constrain = function(_) {\n    return arguments.length ? (constrain = _, zoom) : constrain;\n  };\n\n  zoom.duration = function(_) {\n    return arguments.length ? (duration = +_, zoom) : duration;\n  };\n\n  zoom.interpolate = function(_) {\n    return arguments.length ? (interpolate = _, zoom) : interpolate;\n  };\n\n  zoom.on = function() {\n    var value = listeners.on.apply(listeners, arguments);\n    return value === listeners ? zoom : value;\n  };\n\n  zoom.clickDistance = function(_) {\n    return arguments.length ? (clickDistance2 = (_ = +_) * _, zoom) : Math.sqrt(clickDistance2);\n  };\n\n  zoom.tapDistance = function(_) {\n    return arguments.length ? (tapDistance = +_, zoom) : tapDistance;\n  };\n\n  return zoom;\n}\n","function createParser(onParse) {\n  let isFirstChunk;\n  let buffer;\n  let startingPosition;\n  let startingFieldLength;\n  let eventId;\n  let eventName;\n  let data;\n  reset();\n  return {\n    feed,\n    reset\n  };\n  function reset() {\n    isFirstChunk = true;\n    buffer = \"\";\n    startingPosition = 0;\n    startingFieldLength = -1;\n    eventId = void 0;\n    eventName = void 0;\n    data = \"\";\n  }\n  function feed(chunk) {\n    buffer = buffer ? buffer + chunk : chunk;\n    if (isFirstChunk && hasBom(buffer)) {\n      buffer = buffer.slice(BOM.length);\n    }\n    isFirstChunk = false;\n    const length = buffer.length;\n    let position = 0;\n    let discardTrailingNewline = false;\n    while (position < length) {\n      if (discardTrailingNewline) {\n        if (buffer[position] === \"\\n\") {\n          ++position;\n        }\n        discardTrailingNewline = false;\n      }\n      let lineLength = -1;\n      let fieldLength = startingFieldLength;\n      let character;\n      for (let index = startingPosition; lineLength < 0 && index < length; ++index) {\n        character = buffer[index];\n        if (character === \":\" && fieldLength < 0) {\n          fieldLength = index - position;\n        } else if (character === \"\\r\") {\n          discardTrailingNewline = true;\n          lineLength = index - position;\n        } else if (character === \"\\n\") {\n          lineLength = index - position;\n        }\n      }\n      if (lineLength < 0) {\n        startingPosition = length - position;\n        startingFieldLength = fieldLength;\n        break;\n      } else {\n        startingPosition = 0;\n        startingFieldLength = -1;\n      }\n      parseEventStreamLine(buffer, position, fieldLength, lineLength);\n      position += lineLength + 1;\n    }\n    if (position === length) {\n      buffer = \"\";\n    } else if (position > 0) {\n      buffer = buffer.slice(position);\n    }\n  }\n  function parseEventStreamLine(lineBuffer, index, fieldLength, lineLength) {\n    if (lineLength === 0) {\n      if (data.length > 0) {\n        onParse({\n          type: \"event\",\n          id: eventId,\n          event: eventName || void 0,\n          data: data.slice(0, -1)\n          // remove trailing newline\n        });\n\n        data = \"\";\n        eventId = void 0;\n      }\n      eventName = void 0;\n      return;\n    }\n    const noValue = fieldLength < 0;\n    const field = lineBuffer.slice(index, index + (noValue ? lineLength : fieldLength));\n    let step = 0;\n    if (noValue) {\n      step = lineLength;\n    } else if (lineBuffer[index + fieldLength + 1] === \" \") {\n      step = fieldLength + 2;\n    } else {\n      step = fieldLength + 1;\n    }\n    const position = index + step;\n    const valueLength = lineLength - step;\n    const value = lineBuffer.slice(position, position + valueLength).toString();\n    if (field === \"data\") {\n      data += value ? \"\".concat(value, \"\\n\") : \"\\n\";\n    } else if (field === \"event\") {\n      eventName = value;\n    } else if (field === \"id\" && !value.includes(\"\\0\")) {\n      eventId = value;\n    } else if (field === \"retry\") {\n      const retry = parseInt(value, 10);\n      if (!Number.isNaN(retry)) {\n        onParse({\n          type: \"reconnect-interval\",\n          value: retry\n        });\n      }\n    }\n  }\n}\nconst BOM = [239, 187, 191];\nfunction hasBom(buffer) {\n  return BOM.every((charCode, index) => buffer.charCodeAt(index) === charCode);\n}\nexport { createParser };\n//# sourceMappingURL=index.js.map\n","import { createParser } from './index.js';\nclass EventSourceParserStream extends TransformStream {\n  constructor() {\n    let parser;\n    super({\n      start(controller) {\n        parser = createParser(event => {\n          if (event.type === \"event\") {\n            controller.enqueue(event);\n          }\n        });\n      },\n      transform(chunk) {\n        parser.feed(chunk);\n      }\n    });\n  }\n}\nexport { EventSourceParserStream };\n//# sourceMappingURL=stream.js.map\n","import { EventSourceParserStream } from 'eventsource-parser/stream';\nimport type { ParsedEvent } from 'eventsource-parser';\n\ntype TextStreamUpdate = {\n\tdone: boolean;\n\tvalue: string;\n\t// eslint-disable-next-line @typescript-eslint/no-explicit-any\n\tsources?: any;\n\t// eslint-disable-next-line @typescript-eslint/no-explicit-any\n\tselectedModelId?: any;\n\terror?: any;\n\tusage?: ResponseUsage;\n};\n\ntype ResponseUsage = {\n\t/** Including images and tools if any */\n\tprompt_tokens: number;\n\t/** The tokens generated */\n\tcompletion_tokens: number;\n\t/** Sum of the above two fields */\n\ttotal_tokens: number;\n\t/** Any other fields that aren't part of the base OpenAI spec */\n\t[other: string]: unknown;\n};\n\n// createOpenAITextStream takes a responseBody with a SSE response,\n// and returns an async generator that emits delta updates with large deltas chunked into random sized chunks\nexport async function createOpenAITextStream(\n\tresponseBody: ReadableStream<Uint8Array>,\n\tsplitLargeDeltas: boolean\n): Promise<AsyncGenerator<TextStreamUpdate>> {\n\tconst eventStream = responseBody\n\t\t.pipeThrough(new TextDecoderStream())\n\t\t.pipeThrough(new EventSourceParserStream())\n\t\t.getReader();\n\tlet iterator = openAIStreamToIterator(eventStream);\n\tif (splitLargeDeltas) {\n\t\titerator = streamLargeDeltasAsRandomChunks(iterator);\n\t}\n\treturn iterator;\n}\n\nasync function* openAIStreamToIterator(\n\treader: ReadableStreamDefaultReader<ParsedEvent>\n): AsyncGenerator<TextStreamUpdate> {\n\twhile (true) {\n\t\tconst { value, done } = await reader.read();\n\t\tif (done) {\n\t\t\tyield { done: true, value: '' };\n\t\t\tbreak;\n\t\t}\n\t\tif (!value) {\n\t\t\tcontinue;\n\t\t}\n\t\tconst data = value.data;\n\t\tif (data.startsWith('[DONE]')) {\n\t\t\tyield { done: true, value: '' };\n\t\t\tbreak;\n\t\t}\n\n\t\ttry {\n\t\t\tconst parsedData = JSON.parse(data);\n\t\t\tconsole.log(parsedData);\n\n\t\t\tif (parsedData.error) {\n\t\t\t\tyield { done: true, value: '', error: parsedData.error };\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif (parsedData.sources) {\n\t\t\t\tyield { done: false, value: '', sources: parsedData.sources };\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (parsedData.selected_model_id) {\n\t\t\t\tyield { done: false, value: '', selectedModelId: parsedData.selected_model_id };\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (parsedData.usage) {\n\t\t\t\tyield { done: false, value: '', usage: parsedData.usage };\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tyield {\n\t\t\t\tdone: false,\n\t\t\t\tvalue: parsedData.choices?.[0]?.delta?.content ?? ''\n\t\t\t};\n\t\t} catch (e) {\n\t\t\tconsole.error('Error extracting delta from SSE event:', e);\n\t\t}\n\t}\n}\n\n// streamLargeDeltasAsRandomChunks will chunk large deltas (length > 5) into random sized chunks between 1-3 characters\n// This is to simulate a more fluid streaming, even though some providers may send large chunks of text at once\nasync function* streamLargeDeltasAsRandomChunks(\n\titerator: AsyncGenerator<TextStreamUpdate>\n): AsyncGenerator<TextStreamUpdate> {\n\tfor await (const textStreamUpdate of iterator) {\n\t\tif (textStreamUpdate.done) {\n\t\t\tyield textStreamUpdate;\n\t\t\treturn;\n\t\t}\n\n\t\tif (textStreamUpdate.error) {\n\t\t\tyield textStreamUpdate;\n\t\t\tcontinue;\n\t\t}\n\t\tif (textStreamUpdate.sources) {\n\t\t\tyield textStreamUpdate;\n\t\t\tcontinue;\n\t\t}\n\t\tif (textStreamUpdate.selectedModelId) {\n\t\t\tyield textStreamUpdate;\n\t\t\tcontinue;\n\t\t}\n\t\tif (textStreamUpdate.usage) {\n\t\t\tyield textStreamUpdate;\n\t\t\tcontinue;\n\t\t}\n\n\t\tlet content = textStreamUpdate.value;\n\t\tif (content.length < 5) {\n\t\t\tyield { done: false, value: content };\n\t\t\tcontinue;\n\t\t}\n\t\twhile (content != '') {\n\t\t\tconst chunkSize = Math.min(Math.floor(Math.random() * 3) + 1, content.length);\n\t\t\tconst chunk = content.slice(0, chunkSize);\n\t\t\tyield { done: false, value: chunk };\n\t\t\t// Do not sleep if the tab is hidden\n\t\t\t// Timers are throttled to 1s in hidden tabs\n\t\t\tif (document?.visibilityState !== 'hidden') {\n\t\t\t\tawait sleep(5);\n\t\t\t}\n\t\t\tcontent = content.slice(chunkSize);\n\t\t}\n\t}\n}\n\nconst sleep = (ms: number) => new Promise((resolve) => setTimeout(resolve, ms));\n","<script lang=\"ts\">\n\timport type { Banner } from '$lib/types';\n\timport { onMount, createEventDispatcher } from 'svelte';\n\timport { fade } from 'svelte/transition';\n\timport DOMPurify from 'dompurify';\n\timport { marked } from 'marked';\n\n\tconst dispatch = createEventDispatcher();\n\n\texport let banner: Banner = {\n\t\tid: '',\n\t\ttype: 'info',\n\t\ttitle: '',\n\t\tcontent: '',\n\t\turl: '',\n\t\tdismissable: true,\n\t\ttimestamp: Math.floor(Date.now() / 1000)\n\t};\n\n\texport let dismissed = false;\n\n\tlet mounted = false;\n\n\tconst classNames: Record<string, string> = {\n\t\tinfo: 'bg-blue-500/20 text-blue-700 dark:text-blue-200 ',\n\t\tsuccess: 'bg-green-500/20 text-green-700 dark:text-green-200',\n\t\twarning: 'bg-yellow-500/20 text-yellow-700 dark:text-yellow-200',\n\t\terror: 'bg-red-500/20 text-red-700 dark:text-red-200'\n\t};\n\n\tconst dismiss = (id) => {\n\t\tdismissed = true;\n\t\tdispatch('dismiss', id);\n\t};\n\n\tonMount(() => {\n\t\tmounted = true;\n\t});\n</script>\n\n{#if !dismissed}\n\t{#if mounted}\n\t\t<div\n\t\t\tclass=\" top-0 left-0 right-0 p-2 mx-4 px-3 flex justify-center items-center relative rounded-xl border border-gray-100 dark:border-gray-850 text-gray-800 dark:text-gary-100 bg-white dark:bg-gray-900 backdrop-blur-xl z-30\"\n\t\t\ttransition:fade={{ delay: 100, duration: 300 }}\n\t\t>\n\t\t\t<div class=\" flex flex-col md:flex-row md:items-center flex-1 text-sm w-fit gap-1.5\">\n\t\t\t\t<div class=\"flex justify-between self-start\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\" text-xs font-bold {classNames[banner.type] ??\n\t\t\t\t\t\t\tclassNames['info']}  w-fit px-2 rounded-sm uppercase line-clamp-1 mr-0.5\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{banner.type}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{#if banner.url}\n\t\t\t\t\t\t<div class=\"flex md:hidden group w-fit md:items-center\">\n\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\tclass=\"text-gray-700 dark:text-white text-xs font-semibold underline\"\n\t\t\t\t\t\t\t\thref=\"/assets/files/whitepaper.pdf\"\n\t\t\t\t\t\t\t\ttarget=\"_blank\">Learn More</a\n\t\t\t\t\t\t\t>\n\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\" ml-1 text-gray-400 group-hover:text-gray-600 dark:group-hover:text-white\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<!--  -->\n\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\t\tviewBox=\"0 0 16 16\"\n\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t\t\td=\"M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z\"\n\t\t\t\t\t\t\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"flex-1 text-xs text-gray-700 dark:text-white\">\n\t\t\t\t\t{@html marked.parse(DOMPurify.sanitize(banner.content))}\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t{#if banner.url}\n\t\t\t\t<div class=\"hidden md:flex group w-fit md:items-center\">\n\t\t\t\t\t<a\n\t\t\t\t\t\tclass=\"text-gray-700 dark:text-white text-xs font-semibold underline\"\n\t\t\t\t\t\thref=\"/\"\n\t\t\t\t\t\ttarget=\"_blank\">Learn More</a\n\t\t\t\t\t>\n\n\t\t\t\t\t<div class=\" ml-1 text-gray-400 group-hover:text-gray-600 dark:group-hover:text-white\">\n\t\t\t\t\t\t<!--  -->\n\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\tviewBox=\"0 0 16 16\"\n\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\tclass=\"size-4\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\t\t\t\t\td=\"M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z\"\n\t\t\t\t\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t{/if}\n\t\t\t<div class=\"flex self-start\">\n\t\t\t\t{#if banner.dismissible}\n\t\t\t\t\t<button\n\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\tdismiss(banner.id);\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tclass=\"  -mt-1 -mb-2 -translate-y-[1px] ml-1.5 mr-1 text-gray-400 dark:hover:text-white\"\n\t\t\t\t\t\t>&times;</button\n\t\t\t\t\t>\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t</div>\n\t{/if}\n{/if}\n","// Google Drive Picker API configuration\nlet API_KEY = '';\nlet CLIENT_ID = '';\n\n// Function to fetch credentials from backend config\nasync function getCredentials() {\n\tconst response = await fetch('/api/config');\n\tif (!response.ok) {\n\t\tthrow new Error('Failed to fetch Google Drive credentials');\n\t}\n\tconst config = await response.json();\n\tAPI_KEY = config.google_drive?.api_key;\n\tCLIENT_ID = config.google_drive?.client_id;\n\n\tif (!API_KEY || !CLIENT_ID) {\n\t\tthrow new Error('Google Drive API credentials not configured');\n\t}\n}\nconst SCOPE = [\n\t'https://www.googleapis.com/auth/drive.readonly',\n\t'https://www.googleapis.com/auth/drive.file'\n];\n\n// Validate required credentials\nconst validateCredentials = () => {\n\tif (!API_KEY || !CLIENT_ID) {\n\t\tthrow new Error('Google Drive API credentials not configured');\n\t}\n\tif (API_KEY === '' || CLIENT_ID === '') {\n\t\tthrow new Error('Please configure valid Google Drive API credentials');\n\t}\n};\n\nlet pickerApiLoaded = false;\nlet oauthToken: string | null = null;\nlet initialized = false;\n\nexport const loadGoogleDriveApi = () => {\n\treturn new Promise((resolve, reject) => {\n\t\tif (typeof gapi === 'undefined') {\n\t\t\tconst script = document.createElement('script');\n\t\t\tscript.src = 'https://apis.google.com/js/api.js';\n\t\t\tscript.onload = () => {\n\t\t\t\tgapi.load('picker', () => {\n\t\t\t\t\tpickerApiLoaded = true;\n\t\t\t\t\tresolve(true);\n\t\t\t\t});\n\t\t\t};\n\t\t\tscript.onerror = reject;\n\t\t\tdocument.body.appendChild(script);\n\t\t} else {\n\t\t\tgapi.load('picker', () => {\n\t\t\t\tpickerApiLoaded = true;\n\t\t\t\tresolve(true);\n\t\t\t});\n\t\t}\n\t});\n};\n\nexport const loadGoogleAuthApi = () => {\n\treturn new Promise((resolve, reject) => {\n\t\tif (typeof google === 'undefined') {\n\t\t\tconst script = document.createElement('script');\n\t\t\tscript.src = 'https://accounts.google.com/gsi/client';\n\t\t\tscript.onload = resolve;\n\t\t\tscript.onerror = reject;\n\t\t\tdocument.body.appendChild(script);\n\t\t} else {\n\t\t\tresolve(true);\n\t\t}\n\t});\n};\n\nexport const getAuthToken = async () => {\n\tif (!oauthToken) {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst tokenClient = google.accounts.oauth2.initTokenClient({\n\t\t\t\tclient_id: CLIENT_ID,\n\t\t\t\tscope: SCOPE.join(' '),\n\t\t\t\tcallback: (response: any) => {\n\t\t\t\t\tif (response.access_token) {\n\t\t\t\t\t\toauthToken = response.access_token;\n\t\t\t\t\t\tresolve(oauthToken);\n\t\t\t\t\t} else {\n\t\t\t\t\t\treject(new Error('Failed to get access token'));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\terror_callback: (error: any) => {\n\t\t\t\t\treject(new Error(error.message || 'OAuth error occurred'));\n\t\t\t\t}\n\t\t\t});\n\t\t\ttokenClient.requestAccessToken();\n\t\t});\n\t}\n\treturn oauthToken;\n};\n\nconst initialize = async () => {\n\tif (!initialized) {\n\t\tawait getCredentials();\n\t\tvalidateCredentials();\n\t\tawait Promise.all([loadGoogleDriveApi(), loadGoogleAuthApi()]);\n\t\tinitialized = true;\n\t}\n};\n\nexport const createPicker = () => {\n\treturn new Promise(async (resolve, reject) => {\n\t\ttry {\n\t\t\tconsole.log('Initializing Google Drive Picker...');\n\t\t\tawait initialize();\n\t\t\tconsole.log('Getting auth token...');\n\t\t\tconst token = await getAuthToken();\n\t\t\tif (!token) {\n\t\t\t\tconsole.error('Failed to get OAuth token');\n\t\t\t\tthrow new Error('Unable to get OAuth token');\n\t\t\t}\n\t\t\tconsole.log('Auth token obtained successfully');\n\n\t\t\tconst picker = new google.picker.PickerBuilder()\n\t\t\t\t.enableFeature(google.picker.Feature.NAV_HIDDEN)\n\t\t\t\t.enableFeature(google.picker.Feature.MULTISELECT_ENABLED)\n\t\t\t\t.addView(\n\t\t\t\t\tnew google.picker.DocsView()\n\t\t\t\t\t\t.setIncludeFolders(false)\n\t\t\t\t\t\t.setSelectFolderEnabled(false)\n\t\t\t\t\t\t.setMimeTypes(\n\t\t\t\t\t\t\t'application/pdf,text/plain,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.google-apps.document,application/vnd.google-apps.spreadsheet,application/vnd.google-apps.presentation'\n\t\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t\t.setOAuthToken(token)\n\t\t\t\t.setDeveloperKey(API_KEY)\n\t\t\t\t// Remove app ID setting as it's not needed and can cause 404 errors\n\t\t\t\t.setCallback(async (data: any) => {\n\t\t\t\t\tif (data[google.picker.Response.ACTION] === google.picker.Action.PICKED) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tconst doc = data[google.picker.Response.DOCUMENTS][0];\n\t\t\t\t\t\t\tconst fileId = doc[google.picker.Document.ID];\n\t\t\t\t\t\t\tconst fileName = doc[google.picker.Document.NAME];\n\t\t\t\t\t\t\tconst fileUrl = doc[google.picker.Document.URL];\n\n\t\t\t\t\t\t\tif (!fileId || !fileName) {\n\t\t\t\t\t\t\t\tthrow new Error('Required file details missing');\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// Construct download URL based on MIME type\n\t\t\t\t\t\t\tconst mimeType = doc[google.picker.Document.MIME_TYPE];\n\n\t\t\t\t\t\t\tlet downloadUrl;\n\t\t\t\t\t\t\tlet exportFormat;\n\n\t\t\t\t\t\t\tif (mimeType.includes('google-apps')) {\n\t\t\t\t\t\t\t\t// Handle Google Workspace files\n\t\t\t\t\t\t\t\tif (mimeType.includes('document')) {\n\t\t\t\t\t\t\t\t\texportFormat = 'text/plain';\n\t\t\t\t\t\t\t\t} else if (mimeType.includes('spreadsheet')) {\n\t\t\t\t\t\t\t\t\texportFormat = 'text/csv';\n\t\t\t\t\t\t\t\t} else if (mimeType.includes('presentation')) {\n\t\t\t\t\t\t\t\t\texportFormat = 'text/plain';\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\texportFormat = 'application/pdf';\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tdownloadUrl = `https://www.googleapis.com/drive/v3/files/${fileId}/export?mimeType=${encodeURIComponent(exportFormat)}`;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t// Regular files use direct download URL\n\t\t\t\t\t\t\t\tdownloadUrl = `https://www.googleapis.com/drive/v3/files/${fileId}?alt=media`;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t// Create a Blob from the file download\n\t\t\t\t\t\t\tconst response = await fetch(downloadUrl, {\n\t\t\t\t\t\t\t\theaders: {\n\t\t\t\t\t\t\t\t\tAuthorization: `Bearer ${token}`,\n\t\t\t\t\t\t\t\t\tAccept: '*/*'\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tif (!response.ok) {\n\t\t\t\t\t\t\t\tconst errorText = await response.text();\n\t\t\t\t\t\t\t\tconsole.error('Download failed:', {\n\t\t\t\t\t\t\t\t\tstatus: response.status,\n\t\t\t\t\t\t\t\t\tstatusText: response.statusText,\n\t\t\t\t\t\t\t\t\terror: errorText\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tthrow new Error(`Failed to download file (${response.status}): ${errorText}`);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tconst blob = await response.blob();\n\t\t\t\t\t\t\tconst result = {\n\t\t\t\t\t\t\t\tid: fileId,\n\t\t\t\t\t\t\t\tname: fileName,\n\t\t\t\t\t\t\t\turl: downloadUrl,\n\t\t\t\t\t\t\t\tblob: blob,\n\t\t\t\t\t\t\t\theaders: {\n\t\t\t\t\t\t\t\t\tAuthorization: `Bearer ${token}`,\n\t\t\t\t\t\t\t\t\tAccept: '*/*'\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tresolve(result);\n\t\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t\treject(error);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (data[google.picker.Response.ACTION] === google.picker.Action.CANCEL) {\n\t\t\t\t\t\tresolve(null);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.build();\n\t\t\tpicker.setVisible(true);\n\t\t} catch (error) {\n\t\t\tconsole.error('Google Drive Picker error:', error);\n\t\t\treject(error);\n\t\t}\n\t});\n};\n","import { v4 as uuidv4 } from 'uuid';\n\nlet CLIENT_ID = '';\n\nasync function getCredentials() {\n\tif (CLIENT_ID) return;\n\tconst response = await fetch('/api/config');\n\tif (!response.ok) {\n\t\tthrow new Error('Failed to fetch OneDrive credentials');\n\t}\n\tconst config = await response.json();\n\tCLIENT_ID = config.onedrive?.client_id;\n\tif (!CLIENT_ID) {\n\t\tthrow new Error('OneDrive client ID not configured');\n\t}\n}\n\nfunction loadMsalScript(): Promise<void> {\n\treturn new Promise((resolve, reject) => {\n\t\tconst win = window;\n\t\tif (win.msal) {\n\t\t\tresolve();\n\t\t\treturn;\n\t\t}\n\t\tconst script = document.createElement('script');\n\t\tscript.src = 'https://alcdn.msauth.net/browser/2.19.0/js/msal-browser.min.js';\n\t\tscript.async = true;\n\t\tscript.onload = () => resolve();\n\t\tscript.onerror = () => reject(new Error('Failed to load MSAL script'));\n\t\tdocument.head.appendChild(script);\n\t});\n}\n\nlet msalInstance: any;\n\n// Initialize MSAL authentication\nasync function initializeMsal() {\n\tif (!CLIENT_ID) {\n\t\tawait getCredentials();\n\t}\n\tconst msalParams = {\n\t\tauth: {\n\t\t\tauthority: 'https://login.microsoftonline.com/consumers',\n\t\t\tclientId: CLIENT_ID\n\t\t}\n\t};\n\ttry {\n\t\tawait loadMsalScript();\n\t\tconst win = window;\n\t\tmsalInstance = new win.msal.PublicClientApplication(msalParams);\n\t\tif (msalInstance.initialize) {\n\t\t\tawait msalInstance.initialize();\n\t\t}\n\t} catch (error) {\n\t\tconsole.error('MSAL initialization error:', error);\n\t}\n}\n\n// Retrieve OneDrive access token\nasync function getToken(): Promise<string> {\n\tconst authParams = { scopes: ['OneDrive.ReadWrite'] };\n\tlet accessToken = '';\n\ttry {\n\t\tawait initializeMsal();\n\t\tconst resp = await msalInstance.acquireTokenSilent(authParams);\n\t\taccessToken = resp.accessToken;\n\t} catch (err) {\n\t\tconst resp = await msalInstance.loginPopup(authParams);\n\t\tmsalInstance.setActiveAccount(resp.account);\n\t\tif (resp.idToken) {\n\t\t\tconst resp2 = await msalInstance.acquireTokenSilent(authParams);\n\t\t\taccessToken = resp2.accessToken;\n\t\t}\n\t}\n\treturn accessToken;\n}\n\nconst baseUrl = 'https://onedrive.live.com/picker';\nconst params = {\n\tsdk: '8.0',\n\tentry: {\n\t\toneDrive: {\n\t\t\tfiles: {}\n\t\t}\n\t},\n\tauthentication: {},\n\tmessaging: {\n\t\torigin: window?.location?.origin,\n\t\tchannelId: uuidv4()\n\t},\n\ttypesAndSources: {\n\t\tmode: 'files',\n\t\tpivots: {\n\t\t\toneDrive: true,\n\t\t\trecent: true\n\t\t}\n\t}\n};\n\n// Download file from OneDrive\nasync function downloadOneDriveFile(fileInfo: any): Promise<Blob> {\n\tconst accessToken = await getToken();\n\tif (!accessToken) {\n\t\tthrow new Error('Unable to retrieve OneDrive access token.');\n\t}\n\tconst fileInfoUrl = `${fileInfo['@sharePoint.endpoint']}/drives/${fileInfo.parentReference.driveId}/items/${fileInfo.id}`;\n\tconst response = await fetch(fileInfoUrl, {\n\t\theaders: {\n\t\t\tAuthorization: `Bearer ${accessToken}`\n\t\t}\n\t});\n\tif (!response.ok) {\n\t\tthrow new Error('Failed to fetch file information.');\n\t}\n\tconst fileData = await response.json();\n\tconst downloadUrl = fileData['@content.downloadUrl'];\n\tconst downloadResponse = await fetch(downloadUrl);\n\tif (!downloadResponse.ok) {\n\t\tthrow new Error('Failed to download file.');\n\t}\n\treturn await downloadResponse.blob();\n}\n\n// Open OneDrive file picker and return selected file metadata\nexport async function openOneDrivePicker(): Promise<any | null> {\n\tif (typeof window === 'undefined') {\n\t\tthrow new Error('Not in browser environment');\n\t}\n\treturn new Promise((resolve, reject) => {\n\t\tlet pickerWindow: Window | null = null;\n\t\tlet channelPort: MessagePort | null = null;\n\n\t\tconst handleWindowMessage = (event: MessageEvent) => {\n\t\t\tif (event.source !== pickerWindow) return;\n\t\t\tconst message = event.data;\n\t\t\tif (message?.type === 'initialize' && message?.channelId === params.messaging.channelId) {\n\t\t\t\tchannelPort = event.ports?.[0];\n\t\t\t\tif (!channelPort) return;\n\t\t\t\tchannelPort.addEventListener('message', handlePortMessage);\n\t\t\t\tchannelPort.start();\n\t\t\t\tchannelPort.postMessage({ type: 'activate' });\n\t\t\t}\n\t\t};\n\n\t\tconst handlePortMessage = async (portEvent: MessageEvent) => {\n\t\t\tconst portData = portEvent.data;\n\t\t\tswitch (portData.type) {\n\t\t\t\tcase 'notification':\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'command': {\n\t\t\t\t\tchannelPort?.postMessage({ type: 'acknowledge', id: portData.id });\n\t\t\t\t\tconst command = portData.data;\n\t\t\t\t\tswitch (command.command) {\n\t\t\t\t\t\tcase 'authenticate': {\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tconst newToken = await getToken();\n\t\t\t\t\t\t\t\tif (newToken) {\n\t\t\t\t\t\t\t\t\tchannelPort?.postMessage({\n\t\t\t\t\t\t\t\t\t\ttype: 'result',\n\t\t\t\t\t\t\t\t\t\tid: portData.id,\n\t\t\t\t\t\t\t\t\t\tdata: { result: 'token', token: newToken }\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tthrow new Error('Could not retrieve auth token');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} catch (err) {\n\t\t\t\t\t\t\t\tconsole.error(err);\n\t\t\t\t\t\t\t\tchannelPort?.postMessage({\n\t\t\t\t\t\t\t\t\tresult: 'error',\n\t\t\t\t\t\t\t\t\terror: { code: 'tokenError', message: 'Failed to get token' },\n\t\t\t\t\t\t\t\t\tisExpected: true\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcase 'close': {\n\t\t\t\t\t\t\tcleanup();\n\t\t\t\t\t\t\tresolve(null);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcase 'pick': {\n\t\t\t\t\t\t\tchannelPort?.postMessage({\n\t\t\t\t\t\t\t\ttype: 'result',\n\t\t\t\t\t\t\t\tid: portData.id,\n\t\t\t\t\t\t\t\tdata: { result: 'success' }\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tcleanup();\n\t\t\t\t\t\t\tresolve(command);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdefault: {\n\t\t\t\t\t\t\tconsole.warn('Unsupported command:', command);\n\t\t\t\t\t\t\tchannelPort?.postMessage({\n\t\t\t\t\t\t\t\tresult: 'error',\n\t\t\t\t\t\t\t\terror: { code: 'unsupportedCommand', message: command.command },\n\t\t\t\t\t\t\t\tisExpected: true\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tfunction cleanup() {\n\t\t\twindow.removeEventListener('message', handleWindowMessage);\n\t\t\tif (channelPort) {\n\t\t\t\tchannelPort.removeEventListener('message', handlePortMessage);\n\t\t\t}\n\t\t\tif (pickerWindow) {\n\t\t\t\tpickerWindow.close();\n\t\t\t\tpickerWindow = null;\n\t\t\t}\n\t\t}\n\n\t\tconst initializePicker = async () => {\n\t\t\ttry {\n\t\t\t\tconst authToken = await getToken();\n\t\t\t\tif (!authToken) {\n\t\t\t\t\treturn reject(new Error('Failed to acquire access token'));\n\t\t\t\t}\n\t\t\t\tpickerWindow = window.open('', 'OneDrivePicker', 'width=800,height=600');\n\t\t\t\tif (!pickerWindow) {\n\t\t\t\t\treturn reject(new Error('Failed to open OneDrive picker window'));\n\t\t\t\t}\n\t\t\t\tconst queryString = new URLSearchParams({\n\t\t\t\t\tfilePicker: JSON.stringify(params)\n\t\t\t\t});\n\t\t\t\tconst url = `${baseUrl}?${queryString.toString()}`;\n\t\t\t\tconst form = pickerWindow.document.createElement('form');\n\t\t\t\tform.setAttribute('action', url);\n\t\t\t\tform.setAttribute('method', 'POST');\n\t\t\t\tconst input = pickerWindow.document.createElement('input');\n\t\t\t\tinput.setAttribute('type', 'hidden');\n\t\t\t\tinput.setAttribute('name', 'access_token');\n\t\t\t\tinput.setAttribute('value', authToken);\n\t\t\t\tform.appendChild(input);\n\t\t\t\tpickerWindow.document.body.appendChild(form);\n\t\t\t\tform.submit();\n\t\t\t\twindow.addEventListener('message', handleWindowMessage);\n\t\t\t} catch (err) {\n\t\t\t\tif (pickerWindow) pickerWindow.close();\n\t\t\t\treject(err);\n\t\t\t}\n\t\t};\n\n\t\tinitializePicker();\n\t});\n}\n\n// Pick and download file from OneDrive\nexport async function pickAndDownloadFile(): Promise<{ blob: Blob; name: string } | null> {\n\ttry {\n\t\tconst pickerResult = await openOneDrivePicker();\n\t\tif (!pickerResult || !pickerResult.items || pickerResult.items.length === 0) {\n\t\t\treturn null;\n\t\t}\n\t\tconst selectedFile = pickerResult.items[0];\n\t\tconst blob = await downloadOneDriveFile(selectedFile);\n\t\treturn { blob, name: selectedFile.name };\n\t} catch (error) {\n\t\tconsole.error('Error occurred during OneDrive file pick/download:', error);\n\t\tthrow error;\n\t}\n}\n\nexport { downloadOneDriveFile };\n","<script lang=\"ts\">\n\timport { DropdownMenu } from 'bits-ui';\n\timport { flyAndScale } from '$lib/utils/transitions';\n\timport { getContext, onMount, tick } from 'svelte';\n\n\timport { config, user, tools as _tools, mobile } from '$lib/stores';\n\timport { createPicker } from '$lib/utils/google-drive-picker';\n\n\timport { getTools } from '$lib/apis/tools';\n\n\timport Dropdown from '$lib/components/common/Dropdown.svelte';\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\n\timport DocumentArrowUpSolid from '$lib/components/icons/DocumentArrowUpSolid.svelte';\n\timport Switch from '$lib/components/common/Switch.svelte';\n\timport GlobeAltSolid from '$lib/components/icons/GlobeAltSolid.svelte';\n\timport WrenchSolid from '$lib/components/icons/WrenchSolid.svelte';\n\timport CameraSolid from '$lib/components/icons/CameraSolid.svelte';\n\timport PhotoSolid from '$lib/components/icons/PhotoSolid.svelte';\n\timport CommandLineSolid from '$lib/components/icons/CommandLineSolid.svelte';\n\n\tconst i18n = getContext('i18n');\n\n\texport let screenCaptureHandler: Function;\n\texport let uploadFilesHandler: Function;\n\texport let inputFilesHandler: Function;\n\n\texport let uploadGoogleDriveHandler: Function;\n\texport let uploadOneDriveHandler: Function;\n\n\texport let selectedToolIds: string[] = [];\n\n\texport let onClose: Function;\n\n\tlet tools = {};\n\tlet show = false;\n\n\t$: if (show) {\n\t\tinit();\n\t}\n\n\tlet fileUploadEnabled = true;\n\t$: fileUploadEnabled = $user.role === 'admin' || $user?.permissions?.chat?.file_upload;\n\n\tconst init = async () => {\n\t\tif ($_tools === null) {\n\t\t\tawait _tools.set(await getTools(localStorage.token));\n\t\t}\n\n\t\ttools = $_tools.reduce((a, tool, i, arr) => {\n\t\t\ta[tool.id] = {\n\t\t\t\tname: tool.name,\n\t\t\t\tdescription: tool.meta.description,\n\t\t\t\tenabled: selectedToolIds.includes(tool.id)\n\t\t\t};\n\t\t\treturn a;\n\t\t}, {});\n\t};\n\n\tconst detectMobile = () => {\n\t\tconst userAgent = navigator.userAgent || navigator.vendor || window.opera;\n\t\treturn /android|iphone|ipad|ipod|windows phone/i.test(userAgent);\n\t};\n\n\tfunction handleFileChange(event) {\n\t\tconst inputFiles = Array.from(event.target?.files);\n\t\tif (inputFiles && inputFiles.length > 0) {\n\t\t\tconsole.log(inputFiles);\n\t\t\tinputFilesHandler(inputFiles);\n\t\t}\n\t}\n</script>\n\n<!-- Hidden file input used to open the camera on mobile -->\n<input\n\tid=\"camera-input\"\n\ttype=\"file\"\n\taccept=\"image/*\"\n\tcapture=\"environment\"\n\ton:change={handleFileChange}\n\tstyle=\"display: none;\"\n/>\n\n<Dropdown\n\tbind:show\n\ton:change={(e) => {\n\t\tif (e.detail === false) {\n\t\t\tonClose();\n\t\t}\n\t}}\n>\n\t<Tooltip content={$i18n.t('More')}>\n\t\t<slot />\n\t</Tooltip>\n\n\t<div slot=\"content\">\n\t\t<DropdownMenu.Content\n\t\t\tclass=\"w-full max-w-[220px] rounded-xl px-1 py-1  border-gray-300/30 dark:border-gray-700/50 z-50 bg-white dark:bg-gray-850 dark:text-white shadow-sm\"\n\t\t\tsideOffset={15}\n\t\t\talignOffset={-8}\n\t\t\tside=\"top\"\n\t\t\talign=\"start\"\n\t\t\ttransition={flyAndScale}\n\t\t>\n\t\t\t{#if Object.keys(tools).length > 0}\n\t\t\t\t<div class=\"  max-h-28 overflow-y-auto scrollbar-hidden\">\n\t\t\t\t\t{#each Object.keys(tools) as toolId}\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\"flex w-full justify-between gap-2 items-center px-3 py-2 text-sm font-medium cursor-pointer rounded-xl\"\n\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\ttools[toolId].enabled = !tools[toolId].enabled;\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div class=\"flex-1 truncate\">\n\t\t\t\t\t\t\t\t<Tooltip\n\t\t\t\t\t\t\t\t\tcontent={tools[toolId]?.description ?? ''}\n\t\t\t\t\t\t\t\t\tplacement=\"top-start\"\n\t\t\t\t\t\t\t\t\tclassName=\"flex flex-1 gap-2 items-center\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<div class=\"shrink-0\">\n\t\t\t\t\t\t\t\t\t\t<WrenchSolid />\n\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t<div class=\" truncate\">{tools[toolId].name}</div>\n\t\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div class=\" shrink-0\">\n\t\t\t\t\t\t\t\t<Switch\n\t\t\t\t\t\t\t\t\tstate={tools[toolId].enabled}\n\t\t\t\t\t\t\t\t\ton:change={async (e) => {\n\t\t\t\t\t\t\t\t\t\tconst state = e.detail;\n\t\t\t\t\t\t\t\t\t\tawait tick();\n\t\t\t\t\t\t\t\t\t\tif (state) {\n\t\t\t\t\t\t\t\t\t\t\tselectedToolIds = [...selectedToolIds, toolId];\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\tselectedToolIds = selectedToolIds.filter((id) => id !== toolId);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t{/each}\n\t\t\t\t</div>\n\n\t\t\t\t<hr class=\"border-black/5 dark:border-white/5 my-1\" />\n\t\t\t{/if}\n\n\t\t\t<Tooltip\n\t\t\t\tcontent={!fileUploadEnabled ? $i18n.t('You do not have permission to upload files') : ''}\n\t\t\t\tclassName=\"w-full\"\n\t\t\t>\n\t\t\t\t<DropdownMenu.Item\n\t\t\t\t\tclass=\"flex gap-2 items-center px-3 py-2 text-sm  font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800  rounded-xl {!fileUploadEnabled\n\t\t\t\t\t\t? 'opacity-50'\n\t\t\t\t\t\t: ''}\"\n\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\tif (fileUploadEnabled) {\n\t\t\t\t\t\t\tif (!detectMobile()) {\n\t\t\t\t\t\t\t\tscreenCaptureHandler();\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tconst cameraInputElement = document.getElementById('camera-input');\n\n\t\t\t\t\t\t\t\tif (cameraInputElement) {\n\t\t\t\t\t\t\t\t\tcameraInputElement.click();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<CameraSolid />\n\t\t\t\t\t<div class=\" line-clamp-1\">{$i18n.t('Capture')}</div>\n\t\t\t\t</DropdownMenu.Item>\n\t\t\t</Tooltip>\n\n\t\t\t<Tooltip\n\t\t\t\tcontent={!fileUploadEnabled ? $i18n.t('You do not have permission to upload files') : ''}\n\t\t\t\tclassName=\"w-full\"\n\t\t\t>\n\t\t\t\t<DropdownMenu.Item\n\t\t\t\t\tclass=\"flex gap-2 items-center px-3 py-2 text-sm font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl {!fileUploadEnabled\n\t\t\t\t\t\t? 'opacity-50'\n\t\t\t\t\t\t: ''}\"\n\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\tif (fileUploadEnabled) {\n\t\t\t\t\t\t\tuploadFilesHandler();\n\t\t\t\t\t\t}\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<DocumentArrowUpSolid />\n\t\t\t\t\t<div class=\"line-clamp-1\">{$i18n.t('Upload Files')}</div>\n\t\t\t\t</DropdownMenu.Item>\n\t\t\t</Tooltip>\n\n\t\t\t{#if $config?.features?.enable_google_drive_integration}\n\t\t\t\t<DropdownMenu.Item\n\t\t\t\t\tclass=\"flex gap-2 items-center px-3 py-2 text-sm font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl\"\n\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\tuploadGoogleDriveHandler();\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 87.3 78\" class=\"w-5 h-5\">\n\t\t\t\t\t\t<path\n\t\t\t\t\t\t\td=\"m6.6 66.85 3.85 6.65c.8 1.4 1.95 2.5 3.3 3.3l13.75-23.8h-27.5c0 1.55.4 3.1 1.2 4.5z\"\n\t\t\t\t\t\t\tfill=\"#0066da\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<path\n\t\t\t\t\t\t\td=\"m43.65 25-13.75-23.8c-1.35.8-2.5 1.9-3.3 3.3l-25.4 44a9.06 9.06 0 0 0 -1.2 4.5h27.5z\"\n\t\t\t\t\t\t\tfill=\"#00ac47\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<path\n\t\t\t\t\t\t\td=\"m73.55 76.8c1.35-.8 2.5-1.9 3.3-3.3l1.6-2.75 7.65-13.25c.8-1.4 1.2-2.95 1.2-4.5h-27.502l5.852 11.5z\"\n\t\t\t\t\t\t\tfill=\"#ea4335\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<path\n\t\t\t\t\t\t\td=\"m43.65 25 13.75-23.8c-1.35-.8-2.9-1.2-4.5-1.2h-18.5c-1.6 0-3.15.45-4.5 1.2z\"\n\t\t\t\t\t\t\tfill=\"#00832d\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<path\n\t\t\t\t\t\t\td=\"m59.8 53h-32.3l-13.75 23.8c1.35.8 2.9 1.2 4.5 1.2h50.8c1.6 0 3.15-.45 4.5-1.2z\"\n\t\t\t\t\t\t\tfill=\"#2684fc\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<path\n\t\t\t\t\t\t\td=\"m73.4 26.5-12.7-22c-.8-1.4-1.95-2.5-3.3-3.3l-13.75 23.8 16.15 28h27.45c0-1.55-.4-3.1-1.2-4.5z\"\n\t\t\t\t\t\t\tfill=\"#ffba00\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</svg>\n\t\t\t\t\t<div class=\"line-clamp-1\">{$i18n.t('Google Drive')}</div>\n\t\t\t\t</DropdownMenu.Item>\n\t\t\t{/if}\n\n\t\t\t{#if $config?.features?.enable_onedrive_integration}\n\t\t\t\t<DropdownMenu.Item\n\t\t\t\t\tclass=\"flex gap-2 items-center px-3 py-2 text-sm font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-xl\"\n\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\tuploadOneDriveHandler();\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 32 32\" class=\"w-5 h-5\" fill=\"none\">\n\t\t\t\t\t\t<mask\n\t\t\t\t\t\t\tid=\"mask0_87_7796\"\n\t\t\t\t\t\t\tstyle=\"mask-type:alpha\"\n\t\t\t\t\t\t\tmaskUnits=\"userSpaceOnUse\"\n\t\t\t\t\t\t\tx=\"0\"\n\t\t\t\t\t\t\ty=\"6\"\n\t\t\t\t\t\t\twidth=\"32\"\n\t\t\t\t\t\t\theight=\"20\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\td=\"M7.82979 26C3.50549 26 0 22.5675 0 18.3333C0 14.1921 3.35322 10.8179 7.54613 10.6716C9.27535 7.87166 12.4144 6 16 6C20.6308 6 24.5169 9.12183 25.5829 13.3335C29.1316 13.3603 32 16.1855 32 19.6667C32 23.0527 29 26 25.8723 25.9914L7.82979 26Z\"\n\t\t\t\t\t\t\t\tfill=\"#C4C4C4\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</mask>\n\t\t\t\t\t\t<g mask=\"url(#mask0_87_7796)\">\n\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\td=\"M7.83017 26.0001C5.37824 26.0001 3.18957 24.8966 1.75391 23.1691L18.0429 16.3335L30.7089 23.4647C29.5926 24.9211 27.9066 26.0001 26.0004 25.9915C23.1254 26.0001 12.0629 26.0001 7.83017 26.0001Z\"\n\t\t\t\t\t\t\t\tfill=\"url(#paint0_linear_87_7796)\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\td=\"M25.5785 13.3149L18.043 16.3334L30.709 23.4647C31.5199 22.4065 32.0004 21.0916 32.0004 19.6669C32.0004 16.1857 29.1321 13.3605 25.5833 13.3337C25.5817 13.3274 25.5801 13.3212 25.5785 13.3149Z\"\n\t\t\t\t\t\t\t\tfill=\"url(#paint1_linear_87_7796)\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\td=\"M7.06445 10.7028L18.0423 16.3333L25.5779 13.3148C24.5051 9.11261 20.6237 6 15.9997 6C12.4141 6 9.27508 7.87166 7.54586 10.6716C7.3841 10.6773 7.22358 10.6877 7.06445 10.7028Z\"\n\t\t\t\t\t\t\t\tfill=\"url(#paint2_linear_87_7796)\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\td=\"M1.7535 23.1687L18.0425 16.3331L7.06471 10.7026C3.09947 11.0792 0 14.3517 0 18.3331C0 20.1665 0.657197 21.8495 1.7535 23.1687Z\"\n\t\t\t\t\t\t\t\tfill=\"url(#paint3_linear_87_7796)\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</g>\n\t\t\t\t\t\t<defs>\n\t\t\t\t\t\t\t<linearGradient\n\t\t\t\t\t\t\t\tid=\"paint0_linear_87_7796\"\n\t\t\t\t\t\t\t\tx1=\"4.42591\"\n\t\t\t\t\t\t\t\ty1=\"24.6668\"\n\t\t\t\t\t\t\t\tx2=\"27.2309\"\n\t\t\t\t\t\t\t\ty2=\"23.2764\"\n\t\t\t\t\t\t\t\tgradientUnits=\"userSpaceOnUse\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<stop stop-color=\"#2086B8\" />\n\t\t\t\t\t\t\t\t<stop offset=\"1\" stop-color=\"#46D3F6\" />\n\t\t\t\t\t\t\t</linearGradient>\n\t\t\t\t\t\t\t<linearGradient\n\t\t\t\t\t\t\t\tid=\"paint1_linear_87_7796\"\n\t\t\t\t\t\t\t\tx1=\"23.8302\"\n\t\t\t\t\t\t\t\ty1=\"19.6668\"\n\t\t\t\t\t\t\t\tx2=\"30.2108\"\n\t\t\t\t\t\t\t\ty2=\"15.2082\"\n\t\t\t\t\t\t\t\tgradientUnits=\"userSpaceOnUse\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<stop stop-color=\"#1694DB\" />\n\t\t\t\t\t\t\t\t<stop offset=\"1\" stop-color=\"#62C3FE\" />\n\t\t\t\t\t\t\t</linearGradient>\n\t\t\t\t\t\t\t<linearGradient\n\t\t\t\t\t\t\t\tid=\"paint2_linear_87_7796\"\n\t\t\t\t\t\t\t\tx1=\"8.51037\"\n\t\t\t\t\t\t\t\ty1=\"7.33333\"\n\t\t\t\t\t\t\t\tx2=\"23.3335\"\n\t\t\t\t\t\t\t\ty2=\"15.9348\"\n\t\t\t\t\t\t\t\tgradientUnits=\"userSpaceOnUse\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<stop stop-color=\"#0D3D78\" />\n\t\t\t\t\t\t\t\t<stop offset=\"1\" stop-color=\"#063B83\" />\n\t\t\t\t\t\t\t</linearGradient>\n\t\t\t\t\t\t\t<linearGradient\n\t\t\t\t\t\t\t\tid=\"paint3_linear_87_7796\"\n\t\t\t\t\t\t\t\tx1=\"-0.340429\"\n\t\t\t\t\t\t\t\ty1=\"19.9998\"\n\t\t\t\t\t\t\t\tx2=\"14.5634\"\n\t\t\t\t\t\t\t\ty2=\"14.4649\"\n\t\t\t\t\t\t\t\tgradientUnits=\"userSpaceOnUse\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<stop stop-color=\"#16589B\" />\n\t\t\t\t\t\t\t\t<stop offset=\"1\" stop-color=\"#1464B7\" />\n\t\t\t\t\t\t\t</linearGradient>\n\t\t\t\t\t\t</defs>\n\t\t\t\t\t</svg>\n\t\t\t\t\t<div class=\"line-clamp-1\">{$i18n.t('OneDrive')}</div>\n\t\t\t\t</DropdownMenu.Item>\n\t\t\t{/if}\n\t\t</DropdownMenu.Content>\n\t</div>\n</Dropdown>\n","<script lang=\"ts\">\n\timport { prompts, user, userAPIKey } from '$lib/stores';\n\timport {\n\t\tfindWordIndices,\n\t\tgetUserPosition,\n\t\tgetFormattedDate,\n\t\tgetFormattedTime,\n\t\tgetCurrentDateTime,\n\t\tgetUserTimezone,\n\t\tgetWeekday\n\t} from '$lib/utils';\n\timport { tick, getContext } from 'svelte';\n\timport { toast } from 'svelte-sonner';\n\n\tconst i18n = getContext('i18n');\n\n\texport let files;\n\n\texport let prompt = '';\n\texport let command = '';\n\n\tlet selectedPromptIdx = 0;\n\tlet filteredPrompts = [];\n\n\t$: filteredPrompts = $prompts\n\t\t.filter((p) => p.command.toLowerCase().includes(command.toLowerCase()))\n\t\t.sort((a, b) => a.title.localeCompare(b.title));\n\n\t$: if (command) {\n\t\tselectedPromptIdx = 0;\n\t}\n\n\texport const selectUp = () => {\n\t\tselectedPromptIdx = Math.max(0, selectedPromptIdx - 1);\n\t};\n\n\texport const selectDown = () => {\n\t\tselectedPromptIdx = Math.min(selectedPromptIdx + 1, filteredPrompts.length - 1);\n\t};\n\n\tconst confirmPrompt = async (command) => {\n\t\tlet text = command.content;\n\n\t\tif (command.content.includes('{{CLIPBOARD}}')) {\n\t\t\tconst clipboardText = await navigator.clipboard.readText().catch((err) => {\n\t\t\t\ttoast.error($i18n.t('Failed to read clipboard contents'));\n\t\t\t\treturn '{{CLIPBOARD}}';\n\t\t\t});\n\n\t\t\tconst clipboardItems = await navigator.clipboard.read();\n\n\t\t\tlet imageUrl = null;\n\t\t\tfor (const item of clipboardItems) {\n\t\t\t\t// Check for known image types\n\t\t\t\tfor (const type of item.types) {\n\t\t\t\t\tif (type.startsWith('image/')) {\n\t\t\t\t\t\tconst blob = await item.getType(type);\n\t\t\t\t\t\timageUrl = URL.createObjectURL(blob);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (imageUrl) {\n\t\t\t\tfiles = [\n\t\t\t\t\t...files,\n\t\t\t\t\t{\n\t\t\t\t\t\ttype: 'image',\n\t\t\t\t\t\turl: imageUrl\n\t\t\t\t\t}\n\t\t\t\t];\n\t\t\t}\n\n\t\t\ttext = text.replaceAll('{{CLIPBOARD}}', clipboardText);\n\t\t}\n\n\t\tif (command.content.includes('{{USER_LOCATION}}')) {\n\t\t\tlet location;\n\t\t\ttry {\n\t\t\t\tlocation = await getUserPosition();\n\t\t\t} catch (error) {\n\t\t\t\ttoast.error($i18n.t('Location access not allowed'));\n\t\t\t\tlocation = 'LOCATION_UNKNOWN';\n\t\t\t}\n\t\t\ttext = text.replaceAll('{{USER_LOCATION}}', String(location));\n\t\t}\n\n\t\tif (command.content.includes('{{USER_NAME}}')) {\n\t\t\tconsole.log($user);\n\t\t\tconst name = $user.name || 'User';\n\t\t\ttext = text.replaceAll('{{USER_NAME}}', name);\n\t\t}\n\n\t\tif (command.content.includes('{{USER_LANGUAGE}}')) {\n\t\t\tconst language = localStorage.getItem('locale') || 'en-US';\n\t\t\ttext = text.replaceAll('{{USER_LANGUAGE}}', language);\n\t\t}\n\n\t\tif (command.content.includes('{{USER_API_KEY}}')) {\n\t\t\tconsole.log(\"$userAPIKey in prompts\", $userAPIKey);\n\t\t\tconst apiKey = $userAPIKey || '';\n\t\t\ttext = text.replace(/{{USER_API_KEY}}/g, apiKey);\n\t\t}\n\n\t\tif (command.content.includes('{{CURRENT_DATE}}')) {\n\t\t\tconst date = getFormattedDate();\n\t\t\ttext = text.replaceAll('{{CURRENT_DATE}}', date);\n\t\t}\n\n\t\tif (command.content.includes('{{CURRENT_TIME}}')) {\n\t\t\tconst time = getFormattedTime();\n\t\t\ttext = text.replaceAll('{{CURRENT_TIME}}', time);\n\t\t}\n\n\t\tif (command.content.includes('{{CURRENT_DATETIME}}')) {\n\t\t\tconst dateTime = getCurrentDateTime();\n\t\t\ttext = text.replaceAll('{{CURRENT_DATETIME}}', dateTime);\n\t\t}\n\n\t\tif (command.content.includes('{{CURRENT_TIMEZONE}}')) {\n\t\t\tconst timezone = getUserTimezone();\n\t\t\ttext = text.replaceAll('{{CURRENT_TIMEZONE}}', timezone);\n\t\t}\n\n\t\tif (command.content.includes('{{CURRENT_WEEKDAY}}')) {\n\t\t\tconst weekday = getWeekday();\n\t\t\ttext = text.replaceAll('{{CURRENT_WEEKDAY}}', weekday);\n\t\t}\n\n\t\tprompt = text;\n\n\t\tconst chatInputContainerElement = document.getElementById('chat-input-container');\n\t\tconst chatInputElement = document.getElementById('chat-input');\n\n\t\tawait tick();\n\t\tif (chatInputContainerElement) {\n\t\t\tchatInputContainerElement.style.height = '';\n\t\t\tchatInputContainerElement.style.height =\n\t\t\t\tMath.min(chatInputContainerElement.scrollHeight, 200) + 'px';\n\t\t}\n\n\t\tawait tick();\n\t\tif (chatInputElement) {\n\t\t\tchatInputElement.focus();\n\t\t\tchatInputElement.dispatchEvent(new Event('input'));\n\t\t}\n\t};\n</script>\n\n{#if filteredPrompts.length > 0}\n\t<div\n\t\tid=\"commands-container\"\n\t\tclass=\"px-2 mb-2 text-left w-full absolute bottom-0 left-0 right-0 z-10\"\n\t>\n\t\t<div class=\"flex w-full rounded-xl border border-gray-100 dark:border-gray-850\">\n\t\t\t<div\n\t\t\t\tclass=\"max-h-60 flex flex-col w-full rounded-xl bg-white dark:bg-gray-900 dark:text-gray-100\"\n\t\t\t>\n\t\t\t\t<div class=\"m-1 overflow-y-auto p-1 space-y-0.5 scrollbar-hidden\">\n\t\t\t\t\t{#each filteredPrompts as prompt, promptIdx}\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\" px-3 py-1.5 rounded-xl w-full text-left {promptIdx === selectedPromptIdx\n\t\t\t\t\t\t\t\t? '  bg-gray-50 dark:bg-gray-850 selected-command-option-button'\n\t\t\t\t\t\t\t\t: ''}\"\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\tconfirmPrompt(prompt);\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\ton:mousemove={() => {\n\t\t\t\t\t\t\t\tselectedPromptIdx = promptIdx;\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\ton:focus={() => {}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div class=\" font-medium text-black dark:text-gray-100\">\n\t\t\t\t\t\t\t\t{prompt.command}\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div class=\" text-xs text-gray-600 dark:text-gray-100\">\n\t\t\t\t\t\t\t\t{prompt.title}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t{/each}\n\t\t\t\t</div>\n\n\t\t\t\t<div\n\t\t\t\t\tclass=\" px-2 pt-0.5 pb-1 text-xs text-gray-600 dark:text-gray-100 bg-white dark:bg-gray-900 rounded-b-xl flex items-center space-x-1\"\n\t\t\t\t>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\tstroke-width=\"1.5\"\n\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\tclass=\"w-3 h-3\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t\td=\"m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"line-clamp-1\">\n\t\t\t\t\t\t{$i18n.t(\n\t\t\t\t\t\t\t'Tip: Update multiple variable slots consecutively by pressing the tab key in the chat input after each replacement.'\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n{/if}\n","<script lang=\"ts\">\n\timport { toast } from 'svelte-sonner';\n\timport Fuse from 'fuse.js';\n\n\timport dayjs from 'dayjs';\n\timport relativeTime from 'dayjs/plugin/relativeTime';\n\tdayjs.extend(relativeTime);\n\n\timport { createEventDispatcher, tick, getContext, onMount } from 'svelte';\n\timport { removeLastWordFromString, isValidHttpUrl } from '$lib/utils';\n\timport { knowledge } from '$lib/stores';\n\n\tconst i18n = getContext('i18n');\n\n\texport let prompt = '';\n\texport let command = '';\n\n\tconst dispatch = createEventDispatcher();\n\tlet selectedIdx = 0;\n\n\tlet items = [];\n\tlet fuse = null;\n\n\tlet filteredItems = [];\n\t$: if (fuse) {\n\t\tfilteredItems = command.slice(1)\n\t\t\t? fuse.search(command).map((e) => {\n\t\t\t\t\treturn e.item;\n\t\t\t\t})\n\t\t\t: items;\n\t}\n\n\t$: if (command) {\n\t\tselectedIdx = 0;\n\t}\n\n\texport const selectUp = () => {\n\t\tselectedIdx = Math.max(0, selectedIdx - 1);\n\t};\n\n\texport const selectDown = () => {\n\t\tselectedIdx = Math.min(selectedIdx + 1, filteredItems.length - 1);\n\t};\n\n\tconst confirmSelect = async (item) => {\n\t\tdispatch('select', item);\n\n\t\tprompt = removeLastWordFromString(prompt, command);\n\t\tconst chatInputElement = document.getElementById('chat-input');\n\n\t\tawait tick();\n\t\tchatInputElement?.focus();\n\t\tawait tick();\n\t};\n\n\tconst confirmSelectWeb = async (url) => {\n\t\tdispatch('url', url);\n\n\t\tprompt = removeLastWordFromString(prompt, command);\n\t\tconst chatInputElement = document.getElementById('chat-input');\n\n\t\tawait tick();\n\t\tchatInputElement?.focus();\n\t\tawait tick();\n\t};\n\n\tconst confirmSelectYoutube = async (url) => {\n\t\tdispatch('youtube', url);\n\n\t\tprompt = removeLastWordFromString(prompt, command);\n\t\tconst chatInputElement = document.getElementById('chat-input');\n\n\t\tawait tick();\n\t\tchatInputElement?.focus();\n\t\tawait tick();\n\t};\n\n\tonMount(() => {\n\t\tlet legacy_documents = $knowledge\n\t\t\t.filter((item) => item?.meta?.document)\n\t\t\t.map((item) => ({\n\t\t\t\t...item,\n\t\t\t\ttype: 'file'\n\t\t\t}));\n\n\t\tlet legacy_collections =\n\t\t\tlegacy_documents.length > 0\n\t\t\t\t? [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: 'All Documents',\n\t\t\t\t\t\t\tlegacy: true,\n\t\t\t\t\t\t\ttype: 'collection',\n\t\t\t\t\t\t\tdescription: 'Deprecated (legacy collection), please create a new knowledge base.',\n\t\t\t\t\t\t\ttitle: $i18n.t('All Documents'),\n\t\t\t\t\t\t\tcollection_names: legacy_documents.map((item) => item.id)\n\t\t\t\t\t\t},\n\n\t\t\t\t\t\t...legacy_documents\n\t\t\t\t\t\t\t.reduce((a, item) => {\n\t\t\t\t\t\t\t\treturn [...new Set([...a, ...(item?.meta?.tags ?? []).map((tag) => tag.name)])];\n\t\t\t\t\t\t\t}, [])\n\t\t\t\t\t\t\t.map((tag) => ({\n\t\t\t\t\t\t\t\tname: tag,\n\t\t\t\t\t\t\t\tlegacy: true,\n\t\t\t\t\t\t\t\ttype: 'collection',\n\t\t\t\t\t\t\t\tdescription: 'Deprecated (legacy collection), please create a new knowledge base.',\n\t\t\t\t\t\t\t\tcollection_names: legacy_documents\n\t\t\t\t\t\t\t\t\t.filter((item) => (item?.meta?.tags ?? []).map((tag) => tag.name).includes(tag))\n\t\t\t\t\t\t\t\t\t.map((item) => item.id)\n\t\t\t\t\t\t\t}))\n\t\t\t\t\t]\n\t\t\t\t: [];\n\n\t\tlet collections = $knowledge\n\t\t\t.filter((item) => !item?.meta?.document)\n\t\t\t.map((item) => ({\n\t\t\t\t...item,\n\t\t\t\ttype: 'collection'\n\t\t\t}));\n\t\tlet collection_files =\n\t\t\t$knowledge.length > 0\n\t\t\t\t? [\n\t\t\t\t\t\t...$knowledge\n\t\t\t\t\t\t\t.reduce((a, item) => {\n\t\t\t\t\t\t\t\treturn [\n\t\t\t\t\t\t\t\t\t...new Set([\n\t\t\t\t\t\t\t\t\t\t...a,\n\t\t\t\t\t\t\t\t\t\t...(item?.files ?? []).map((file) => ({\n\t\t\t\t\t\t\t\t\t\t\t...file,\n\t\t\t\t\t\t\t\t\t\t\tcollection: { name: item.name, description: item.description } // DO NOT REMOVE, USED IN FILE DESCRIPTION/ATTACHMENT\n\t\t\t\t\t\t\t\t\t\t}))\n\t\t\t\t\t\t\t\t\t])\n\t\t\t\t\t\t\t\t];\n\t\t\t\t\t\t\t}, [])\n\t\t\t\t\t\t\t.map((file) => ({\n\t\t\t\t\t\t\t\t...file,\n\t\t\t\t\t\t\t\tname: file?.meta?.name,\n\t\t\t\t\t\t\t\tdescription: `${file?.collection?.name} - ${file?.collection?.description}`,\n\t\t\t\t\t\t\t\ttype: 'file'\n\t\t\t\t\t\t\t}))\n\t\t\t\t\t]\n\t\t\t\t: [];\n\n\t\titems = [...collections, ...collection_files, ...legacy_collections, ...legacy_documents].map(\n\t\t\t(item) => {\n\t\t\t\treturn {\n\t\t\t\t\t...item,\n\t\t\t\t\t...(item?.legacy || item?.meta?.legacy || item?.meta?.document ? { legacy: true } : {})\n\t\t\t\t};\n\t\t\t}\n\t\t);\n\n\t\tfuse = new Fuse(items, {\n\t\t\tkeys: ['name', 'description']\n\t\t});\n\t});\n</script>\n\n{#if filteredItems.length > 0 || prompt.split(' ')?.at(0)?.substring(1).startsWith('http')}\n\t<div\n\t\tid=\"commands-container\"\n\t\tclass=\"px-2 mb-2 text-left w-full absolute bottom-0 left-0 right-0 z-10\"\n\t>\n\t\t<div class=\"flex w-full rounded-xl border border-gray-100 dark:border-gray-850\">\n\t\t\t<div\n\t\t\t\tclass=\"max-h-60 flex flex-col w-full rounded-xl bg-white dark:bg-gray-900 dark:text-gray-100\"\n\t\t\t>\n\t\t\t\t<div class=\"m-1 overflow-y-auto p-1 rounded-r-xl space-y-0.5 scrollbar-hidden\">\n\t\t\t\t\t{#each filteredItems as item, idx}\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\" px-3 py-1.5 rounded-xl w-full text-left flex justify-between items-center {idx ===\n\t\t\t\t\t\t\tselectedIdx\n\t\t\t\t\t\t\t\t? ' bg-gray-50 dark:bg-gray-850 dark:text-gray-100 selected-command-option-button'\n\t\t\t\t\t\t\t\t: ''}\"\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\tconsole.log(item);\n\t\t\t\t\t\t\t\tconfirmSelect(item);\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\ton:mousemove={() => {\n\t\t\t\t\t\t\t\tselectedIdx = idx;\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<div class=\" font-medium text-black dark:text-gray-100 flex items-center gap-1\">\n\t\t\t\t\t\t\t\t\t{#if item.legacy}\n\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\tclass=\"bg-gray-500/20 text-gray-700 dark:text-gray-200 rounded-sm uppercase text-xs font-bold px-1 shrink-0\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\tLegacy\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t{:else if item?.meta?.document}\n\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\tclass=\"bg-gray-500/20 text-gray-700 dark:text-gray-200 rounded-sm uppercase text-xs font-bold px-1 shrink-0\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\tDocument\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t{:else if item?.type === 'file'}\n\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\tclass=\"bg-gray-500/20 text-gray-700 dark:text-gray-200 rounded-sm uppercase text-xs font-bold px-1 shrink-0\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\tFile\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\tclass=\"bg-green-500/20 text-green-700 dark:text-green-200 rounded-sm uppercase text-xs font-bold px-1 shrink-0\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\tCollection\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t{/if}\n\n\t\t\t\t\t\t\t\t\t<div class=\"line-clamp-1\">\n\t\t\t\t\t\t\t\t\t\t{item?.name}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t<div class=\" text-xs text-gray-600 dark:text-gray-100 line-clamp-1\">\n\t\t\t\t\t\t\t\t\t{item?.description}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</button>\n\n\t\t\t\t\t\t<!-- <div slot=\"content\" class=\" pl-2 pt-1 flex flex-col gap-0.5\">\n\t\t\t\t\t\t\t\t{#if !item.legacy && (item?.files ?? []).length > 0}\n\t\t\t\t\t\t\t\t\t{#each item?.files ?? [] as file, fileIdx}\n\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\tclass=\" px-3 py-1.5 rounded-xl w-full text-left flex justify-between items-center hover:bg-gray-50 dark:hover:bg-gray-850 dark:hover:text-gray-100 selected-command-option-button\"\n\t\t\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(file);\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\ton:mousemove={() => {\n\t\t\t\t\t\t\t\t\t\t\t\tselectedIdx = idx;\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\" font-medium text-black dark:text-gray-100 flex items-center gap-1\"\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"bg-gray-500/20 text-gray-700 dark:text-gray-200 rounded-sm uppercase text-xs font-bold px-1 shrink-0\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tFile\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"line-clamp-1\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{file?.meta?.name}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\" text-xs text-gray-600 dark:text-gray-100 line-clamp-1\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t{$i18n.t('Updated')}\n\t\t\t\t\t\t\t\t\t\t\t\t\t{dayjs(file.updated_at * 1000).fromNow()}\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t\t<div class=\" text-gray-500 text-xs mt-1 mb-2\">\n\t\t\t\t\t\t\t\t\t\t{$i18n.t('No files found.')}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t</div> -->\n\t\t\t\t\t{/each}\n\n\t\t\t\t\t{#if prompt\n\t\t\t\t\t\t.split(' ')\n\t\t\t\t\t\t.some((s) => s.substring(1).startsWith('https://www.youtube.com') || s\n\t\t\t\t\t\t\t\t\t.substring(1)\n\t\t\t\t\t\t\t\t\t.startsWith('https://youtu.be'))}\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\"px-3 py-1.5 rounded-xl w-full text-left bg-gray-50 dark:bg-gray-850 dark:text-gray-100 selected-command-option-button\"\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\tconst url = prompt.split(' ')?.at(0)?.substring(1);\n\t\t\t\t\t\t\t\tif (isValidHttpUrl(url)) {\n\t\t\t\t\t\t\t\t\tconfirmSelectYoutube(url);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\ttoast.error(\n\t\t\t\t\t\t\t\t\t\t$i18n.t(\n\t\t\t\t\t\t\t\t\t\t\t'Oops! Looks like the URL is invalid. Please double-check and try again.'\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div class=\" font-medium text-black dark:text-gray-100 line-clamp-1\">\n\t\t\t\t\t\t\t\t{prompt.split(' ')?.at(0)?.substring(1)}\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div class=\" text-xs text-gray-600 line-clamp-1\">{$i18n.t('Youtube')}</div>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t{:else if prompt.split(' ')?.at(0)?.substring(1).startsWith('http')}\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\"px-3 py-1.5 rounded-xl w-full text-left bg-gray-50 dark:bg-gray-850 dark:text-gray-100 selected-command-option-button\"\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\tconst url = prompt.split(' ')?.at(0)?.substring(1);\n\t\t\t\t\t\t\t\tif (isValidHttpUrl(url)) {\n\t\t\t\t\t\t\t\t\tconfirmSelectWeb(url);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\ttoast.error(\n\t\t\t\t\t\t\t\t\t\t$i18n.t(\n\t\t\t\t\t\t\t\t\t\t\t'Oops! Looks like the URL is invalid. Please double-check and try again.'\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div class=\" font-medium text-black dark:text-gray-100 line-clamp-1\">\n\t\t\t\t\t\t\t\t{prompt.split(' ')?.at(0)?.substring(1)}\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div class=\" text-xs text-gray-600 line-clamp-1\">{$i18n.t('Web')}</div>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n{/if}\n","<script lang=\"ts\">\n\timport Fuse from 'fuse.js';\n\n\timport { createEventDispatcher, onMount } from 'svelte';\n\timport { tick, getContext } from 'svelte';\n\n\timport { models } from '$lib/stores';\n\n\tconst i18n = getContext('i18n');\n\n\tconst dispatch = createEventDispatcher();\n\n\texport let command = '';\n\n\tlet selectedIdx = 0;\n\tlet filteredItems = [];\n\n\tlet fuse = new Fuse(\n\t\t$models\n\t\t\t.filter((model) => !model?.info?.meta?.hidden)\n\t\t\t.map((model) => {\n\t\t\t\tconst _item = {\n\t\t\t\t\t...model,\n\t\t\t\t\tmodelName: model?.name,\n\t\t\t\t\ttags: model?.info?.meta?.tags?.map((tag) => tag.name).join(' '),\n\t\t\t\t\tdesc: model?.info?.meta?.description\n\t\t\t\t};\n\t\t\t\treturn _item;\n\t\t\t}),\n\t\t{\n\t\t\tkeys: ['value', 'tags', 'modelName'],\n\t\t\tthreshold: 0.3\n\t\t}\n\t);\n\n\t$: filteredItems = command.slice(1)\n\t\t? fuse.search(command).map((e) => {\n\t\t\t\treturn e.item;\n\t\t\t})\n\t\t: $models.filter((model) => !model?.info?.meta?.hidden);\n\n\t$: if (command) {\n\t\tselectedIdx = 0;\n\t}\n\n\texport const selectUp = () => {\n\t\tselectedIdx = Math.max(0, selectedIdx - 1);\n\t};\n\n\texport const selectDown = () => {\n\t\tselectedIdx = Math.min(selectedIdx + 1, filteredItems.length - 1);\n\t};\n\n\tconst confirmSelect = async (model) => {\n\t\tcommand = '';\n\t\tdispatch('select', model);\n\t};\n\n\tonMount(async () => {\n\t\tawait tick();\n\t\tconst chatInputElement = document.getElementById('chat-input');\n\t\tawait tick();\n\t\tchatInputElement?.focus();\n\t\tawait tick();\n\t});\n</script>\n\n{#if filteredItems.length > 0}\n\t<div\n\t\tid=\"commands-container\"\n\t\tclass=\"px-2 mb-2 text-left w-full absolute bottom-0 left-0 right-0 z-10\"\n\t>\n\t\t<div class=\"flex w-full rounded-xl border border-gray-100 dark:border-gray-850\">\n\t\t\t<div\n\t\t\t\tclass=\"max-h-60 flex flex-col w-full rounded-xl bg-white dark:bg-gray-900 dark:text-gray-100\"\n\t\t\t>\n\t\t\t\t<div class=\"m-1 overflow-y-auto p-1 rounded-r-lg space-y-0.5 scrollbar-hidden\">\n\t\t\t\t\t{#each filteredItems as model, modelIdx}\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\"px-3 py-1.5 rounded-xl w-full text-left {modelIdx === selectedIdx\n\t\t\t\t\t\t\t\t? 'bg-gray-50 dark:bg-gray-850 selected-command-option-button'\n\t\t\t\t\t\t\t\t: ''}\"\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\tconfirmSelect(model);\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\ton:mousemove={() => {\n\t\t\t\t\t\t\t\tselectedIdx = modelIdx;\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\ton:focus={() => {}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div class=\"flex font-medium text-black dark:text-gray-100 line-clamp-1\">\n\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\tsrc={model?.info?.meta?.profile_image_url ?? '/static/favicon.png'}\n\t\t\t\t\t\t\t\t\talt={model?.name ?? model.id}\n\t\t\t\t\t\t\t\t\tclass=\"rounded-full size-6 items-center mr-2\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t{model.name}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t{/each}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n{/if}\n","<script lang=\"ts\">\n\timport { createEventDispatcher, onMount } from 'svelte';\n\timport { tick, getContext } from 'svelte';\n\n\tconst i18n = getContext('i18n');\n\tconst dispatch = createEventDispatcher();\n\n\texport let command = '';\n\texport let dbReferences = ['T0']; // Default to T0 if nothing is provided\n\n\tlet selectedIdx = 0;\n\tlet filteredReferences = [];\n\n\t// Filter references based on what's typed after @\n\t$: {\n\t\tconst query = command.slice(1).toLowerCase();\n\t\tif (query) {\n\t\t\tfilteredReferences = dbReferences.filter(ref => \n\t\t\t\tref.toLowerCase().includes(query)\n\t\t\t);\n\t\t} else {\n\t\t\tfilteredReferences = [...dbReferences];\n\t\t}\n\t\t\n\t\t// If we have no results but typed something, show the input as an option\n\t\tif (filteredReferences.length === 0 && query) {\n\t\t\t// Add T followed by the number if query is numeric\n\t\t\tif (/^\\d+$/.test(query)) {\n\t\t\t\tfilteredReferences = [`T${query}`];\n\t\t\t}\n\t\t}\n\t\t\n\t\t// Always reset selection to first item when filtering\n\t\tselectedIdx = 0;\n\t}\n\n\texport const selectUp = () => {\n\t\tselectedIdx = Math.max(0, selectedIdx - 1);\n\t};\n\n\texport const selectDown = () => {\n\t\tselectedIdx = Math.min(selectedIdx + 1, filteredReferences.length - 1);\n\t};\n\n\tconst confirmSelect = async (reference) => {\n\t\tdispatch('select', reference);\n\t};\n\n\tonMount(async () => {\n\t\tawait tick();\n\t\tconst chatInputElement = document.getElementById('chat-input');\n\t\tif (chatInputElement) {\n\t\t\tawait tick();\n\t\t\tchatInputElement?.focus();\n\t\t}\n\t});\n</script>\n\n{#if filteredReferences.length > 0}\n\t<div\n\t\tid=\"commands-container\"\n\t\tclass=\"px-2 mb-2 text-left w-full absolute bottom-0 left-0 right-0 z-10\"\n\t>\n\t\t<div class=\"flex w-full rounded-xl border border-gray-100 dark:border-gray-850\">\n\t\t\t<div\n\t\t\t\tclass=\"max-h-60 flex flex-col w-full rounded-xl bg-white dark:bg-gray-900 dark:text-gray-100\"\n\t\t\t>\n\t\t\t\t<div class=\"m-1 overflow-y-auto p-1 rounded-r-lg space-y-0.5 scrollbar-hidden\">\n\t\t\t\t\t{#each filteredReferences as reference, refIdx}\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\"px-3 py-1.5 rounded-xl w-full text-left {refIdx === selectedIdx\n\t\t\t\t\t\t\t\t? 'bg-gray-50 dark:bg-gray-850 selected-command-option-button'\n\t\t\t\t\t\t\t\t: ''}\"\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\tconfirmSelect(reference);\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\ton:mousemove={() => {\n\t\t\t\t\t\t\t\tselectedIdx = refIdx;\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div class=\"flex font-medium text-black dark:text-gray-100 line-clamp-1\">\n\t\t\t\t\t\t\t\t<div class=\"flex items-center mr-2\">\n\t\t\t\t\t\t\t\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\" stroke=\"currentColor\" class=\"w-5 h-5\">\n\t\t\t\t\t\t\t\t\t\t<path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M20.25 6.375c0 2.278-3.694 4.125-8.25 4.125S3.75 8.653 3.75 6.375m16.5 0c0-2.278-3.694-4.125-8.25-4.125S3.75 4.097 3.75 6.375m16.5 0v11.25c0 2.278-3.694 4.125-8.25 4.125s-8.25-1.847-8.25-4.125V6.375m16.5 0v3.75m-16.5-3.75v3.75m16.5 0v3.75C20.25 16.153 16.556 18 12 18s-8.25-1.847-8.25-4.125v-3.75m16.5 0c0 2.278-3.694 4.125-8.25 4.125s-8.25-1.847-8.25-4.125\" />\n\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t@{reference}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"text-xs text-gray-500 ml-7\">\n\t\t\t\t\t\t\t\t{$i18n.t('Reference database table')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t{/each}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n{/if} ","<script>\n\timport { createEventDispatcher, onMount, onDestroy } from 'svelte';\n\timport { toast } from 'svelte-sonner';\n\n\tconst dispatch = createEventDispatcher();\n\n\timport { knowledge, prompts } from '$lib/stores';\n\n\timport { removeLastWordFromString } from '$lib/utils';\n\timport { getPrompts } from '$lib/apis/prompts';\n\timport { getKnowledgeBases } from '$lib/apis/knowledge';\n\n\timport Prompts from './Commands/Prompts.svelte';\n\timport Knowledge from './Commands/Knowledge.svelte';\n\timport Models from './Commands/Models.svelte';\n\timport DatabaseReferences from './Commands/DatabaseReferences.svelte';\n\timport Spinner from '$lib/components/common/Spinner.svelte';\n\n\texport let prompt = '';\n\texport let files = [];\n\texport let history = null; // Add history prop to access message data\n\n\tlet loading = false;\n\tlet commandElement = null;\n\tlet useDbReferences = false; // Flag to determine if we should show DB references or models\n\tlet dbReferencesList = []; // List of database references found in messages\n\n\t// Extract database references from message content\n\tconst extractDbReferences = () => {\n\t\tif (!history || !history.messages) return [];\n\t\t\n\t\tconst references = [];\n\t\tlet highestGeneratedTable = -1; // Track highest actually generated table\n\t\t\n\t\t// Look through all assistant messages to find database references\n\t\tObject.values(history.messages).forEach(message => {\n\t\t\tif (message.role === 'assistant' && message.content) {\n\t\t\t\ttry {\n\t\t\t\t\t// First look for \"Generated Table Tn\" pattern that confirms table creation\n\t\t\t\t\tconst generatedMatch = message.content.match(/Generated Table T(\\d+)/i);\n\t\t\t\t\tif (generatedMatch) {\n\t\t\t\t\t\tconst tableNumber = parseInt(generatedMatch[1]);\n\t\t\t\t\t\tif (tableNumber > highestGeneratedTable) {\n\t\t\t\t\t\t\thighestGeneratedTable = tableNumber;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} catch (error) {\n\t\t\t\t\tconsole.log(\"Error parsing message content:\", error);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\t\n\t\tif (highestGeneratedTable >= 0) {\n\t\t\t// Show only tables that have actually been generated\n\t\t\t// Add generated tables (T1 to highestGeneratedTable)\n\t\t\tfor (let i = 0; i <= highestGeneratedTable; i++) {\n\t\t\t\treferences.push(`T${i}`);\n\t\t\t}\n\t\t\t// Add the next table in sequence\n\t\t\t//references.push(`T${highestGeneratedTable + 1}`);\n\t\t} else {\n\t\t\t// If no tables found, show T0 for new conversations\n\t\t\treferences.push(\"T0\");\n\t\t}\n\t\t\n\t\treturn references;\n\t};\n\n\texport const selectUp = () => {\n\t\tcommandElement?.selectUp();\n\t};\n\n\texport const selectDown = () => {\n\t\tcommandElement?.selectDown();\n\t};\n\n\tlet command = '';\n\t$: command = prompt?.split('\\n').pop()?.split(' ')?.pop() ?? '';\n\n\tlet show = false;\n\t$: show = ['/', '#', '@'].includes(command?.charAt(0)) || '\\\\#' === command.slice(0, 2);\n\n\t$: if (show) {\n\t\tinit();\n\t}\n\t\n\t// Update database references whenever command is shown\n\t$: if (show && command?.charAt(0) === '@') {\n\t\tdbReferencesList = extractDbReferences();\n\t\tuseDbReferences = dbReferencesList.length > 0;\n\t}\n\n\tconst init = async () => {\n\t\tloading = true;\n\t\tawait Promise.all([\n\t\t\t(async () => {\n\t\t\t\tprompts.set(await getPrompts(localStorage.token));\n\t\t\t})(),\n\t\t\t(async () => {\n\t\t\t\tknowledge.set(await getKnowledgeBases(localStorage.token));\n\t\t\t})()\n\t\t]);\n\t\tloading = false;\n\t};\n</script>\n\n{#if show}\n\t{#if !loading}\n\t\t{#if command?.charAt(0) === '/'}\n\t\t\t<Prompts bind:this={commandElement} bind:prompt bind:files {command} />\n\t\t{:else if (command?.charAt(0) === '#' && command.startsWith('#') && !command.includes('# ')) || ('\\\\#' === command.slice(0, 2) && command.startsWith('#') && !command.includes('# '))}\n\t\t\t<Knowledge\n\t\t\t\tbind:this={commandElement}\n\t\t\t\tbind:prompt\n\t\t\t\tcommand={command.includes('\\\\#') ? command.slice(2) : command}\n\t\t\t\ton:youtube={(e) => {\n\t\t\t\t\tconsole.log(e);\n\t\t\t\t\tdispatch('upload', {\n\t\t\t\t\t\ttype: 'youtube',\n\t\t\t\t\t\tdata: e.detail\n\t\t\t\t\t});\n\t\t\t\t}}\n\t\t\t\ton:url={(e) => {\n\t\t\t\t\tconsole.log(e);\n\t\t\t\t\tdispatch('upload', {\n\t\t\t\t\t\ttype: 'web',\n\t\t\t\t\t\tdata: e.detail\n\t\t\t\t\t});\n\t\t\t\t}}\n\t\t\t\ton:select={(e) => {\n\t\t\t\t\tconsole.log(e);\n\t\t\t\t\tif (files.find((f) => f.id === e.detail.id)) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tfiles = [\n\t\t\t\t\t\t...files,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t...e.detail,\n\t\t\t\t\t\t\tstatus: 'processed'\n\t\t\t\t\t\t}\n\t\t\t\t\t];\n\n\t\t\t\t\tdispatch('select');\n\t\t\t\t}}\n\t\t\t/>\n\t\t{:else if command?.charAt(0) === '@'}\n\t\t\t{#if useDbReferences}\n\t\t\t\t<DatabaseReferences\n\t\t\t\t\tbind:this={commandElement}\n\t\t\t\t\t{command}\n\t\t\t\t\tdbReferences={dbReferencesList}\n\t\t\t\t\ton:select={(e) => {\n\t\t\t\t\t\tprompt = removeLastWordFromString(prompt, command);\n\t\t\t\t\t\tprompt += `@${e.detail}`;\n\t\t\t\t\t\t\n\t\t\t\t\t\tdispatch('select');\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t{:else}\n\t\t\t\t<Models\n\t\t\t\t\tbind:this={commandElement}\n\t\t\t\t\t{command}\n\t\t\t\t\ton:select={(e) => {\n\t\t\t\t\t\tprompt = removeLastWordFromString(prompt, command);\n\n\t\t\t\t\t\tdispatch('select', {\n\t\t\t\t\t\t\ttype: 'model',\n\t\t\t\t\t\t\tdata: e.detail\n\t\t\t\t\t\t});\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t{/if}\n\t\t{/if}\n\t{:else}\n\t\t<div\n\t\t\tid=\"commands-container\"\n\t\t\tclass=\"px-2 mb-2 text-left w-full absolute bottom-0 left-0 right-0 z-10\"\n\t\t>\n\t\t\t<div class=\"flex w-full rounded-xl border border-gray-100 dark:border-gray-850\">\n\t\t\t\t<div\n\t\t\t\t\tclass=\"max-h-60 flex flex-col w-full rounded-xl bg-white dark:bg-gray-900 dark:text-gray-100\"\n\t\t\t\t>\n\t\t\t\t\t<Spinner />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t{/if}\n{/if}\n","<script lang=\"ts\">\n\texport let className = 'size-4';\n\texport let strokeWidth = '1.5';\n</script>\n\n<svg\n\tclass={className}\n\tstroke-width={strokeWidth}\n\taria-hidden=\"true\"\n\txmlns=\"http://www.w3.org/2000/svg\"\n\tfill=\"none\"\n\tviewBox=\"0 0 24 24\"\n>\n\t<path\n\t\tstroke=\"currentColor\"\n\t\tstroke-linecap=\"round\"\n\t\tstroke-linejoin=\"round\"\n\t\tstroke-width=\"2\"\n\t\td=\"m3 16 5-7 6 6.5m6.5 2.5L16 13l-4.286 6M14 10h.01M4 19h16a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1Z\"\n\t/>\n</svg>\n","<script lang=\"ts\">\n\timport { toast } from 'svelte-sonner';\n\timport { v4 as uuidv4 } from 'uuid';\n\timport * as XLSX from 'xlsx';\n\timport { createPicker, getAuthToken } from '$lib/utils/google-drive-picker';\n\timport { pickAndDownloadFile } from '$lib/utils/onedrive-file-picker';\n\n\timport { onMount, tick, getContext, createEventDispatcher, onDestroy } from 'svelte';\n\tconst dispatch = createEventDispatcher();\n\n\timport {\n\t\ttype Model,\n\t\tmobile,\n\t\tsettings,\n\t\tshowSidebar,\n\t\tmodels,\n\t\tconfig,\n\t\tshowCallOverlay,\n\t\ttools,\n\t\tuser as _user,\n\t\tshowControls,\n\t\tTTSWorker\n\t} from '$lib/stores';\n\n\timport { blobToFile, compressImage, createMessagesList, findWordIndices } from '$lib/utils';\n\timport { transcribeAudio } from '$lib/apis/audio';\n\timport { uploadFile } from '$lib/apis/files';\n\timport { generateAutoCompletion } from '$lib/apis';\n\timport { deleteFileById } from '$lib/apis/files';\n\n\timport { WEBUI_BASE_URL, WEBUI_API_BASE_URL, PASTED_TEXT_CHARACTER_LIMIT } from '$lib/constants';\n\n\timport InputMenu from './MessageInput/InputMenu.svelte';\n\timport VoiceRecording from './MessageInput/VoiceRecording.svelte';\n\timport FilesOverlay from './MessageInput/FilesOverlay.svelte';\n\timport Commands from './MessageInput/Commands.svelte';\n\n\timport RichTextInput from '../common/RichTextInput.svelte';\n\timport Tooltip from '../common/Tooltip.svelte';\n\timport FileItem from '../common/FileItem.svelte';\n\timport Image from '../common/Image.svelte';\n\n\timport XMark from '../icons/XMark.svelte';\n\timport Headphone from '../icons/Headphone.svelte';\n\timport GlobeAlt from '../icons/GlobeAlt.svelte';\n\timport PhotoSolid from '../icons/PhotoSolid.svelte';\n\timport Photo from '../icons/Photo.svelte';\n\timport CommandLine from '../icons/CommandLine.svelte';\n\timport { KokoroWorker } from '$lib/workers/KokoroWorker';\n\n\tconst i18n = getContext('i18n');\n\n\t// ADD THE HELPER FUNCTION HERE, right after imports and before component props\n\tfunction isExcelFile(file) {\n\t\tconst excelTypes = [\n\t\t\t'application/vnd.ms-excel',\n\t\t\t'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\n\t\t\t'application/vnd.oasis.opendocument.spreadsheet',\n\t\t\t'text/csv'\n\t\t];\n\t\t\n\t\tconst excelExtensions = ['.xls', '.xlsx', '.csv', '.ods'];\n\t\t\n\t\treturn (\n\t\t\t(file.file && excelTypes.includes(file.file.type)) ||\n\t\t\t(file.name && excelExtensions.some(ext => file.name.toLowerCase().endsWith(ext)))\n\t\t);\n\t}\n\n\texport let transparentBackground = false;\n\n\texport let onChange: Function = () => {};\n\texport let createMessagePair: Function;\n\texport let stopResponse: Function;\n\n\texport let autoScroll = false;\n\n\texport let atSelectedModel: Model | undefined = undefined;\n\texport let selectedModels: [''];\n\n\tlet selectedModelIds = [];\n\t$: selectedModelIds = atSelectedModel !== undefined ? [atSelectedModel.id] : selectedModels;\n\n\texport let history;\n\n\texport let prompt = '';\n\texport let files = [];\n\n\texport let selectedToolIds = [];\n\n\texport let imageGenerationEnabled = false;\n\texport let webSearchEnabled = false;\n\texport let codeInterpreterEnabled = false;\n\n\t$: onChange({\n\t\tprompt,\n\t\tfiles,\n\t\tselectedToolIds,\n\t\timageGenerationEnabled,\n\t\twebSearchEnabled\n\t});\n\n\tlet loaded = false;\n\tlet recording = false;\n\n\tlet chatInputContainerElement;\n\tlet chatInputElement;\n\n\tlet filesInputElement;\n\tlet commandsElement;\n\n\tlet inputFiles;\n\tlet dragged = false;\n\n\tlet user = null;\n\texport let placeholder = '';\n\n\tlet visionCapableModels = [];\n\t$: visionCapableModels = [...(atSelectedModel ? [atSelectedModel] : selectedModels)].filter(\n\t\t(model) => $models.find((m) => m.id === model)?.info?.meta?.capabilities?.vision ?? true\n\t);\n\n\tconst scrollToBottom = () => {\n\t\tconst element = document.getElementById('messages-container');\n\t\telement.scrollTo({\n\t\t\ttop: element.scrollHeight,\n\t\t\tbehavior: 'smooth'\n\t\t});\n\t};\n\n\tconst screenCaptureHandler = async () => {\n\t\ttry {\n\t\t\t// Request screen media\n\t\t\tconst mediaStream = await navigator.mediaDevices.getDisplayMedia({\n\t\t\t\tvideo: { cursor: 'never' },\n\t\t\t\taudio: false\n\t\t\t});\n\t\t\t// Once the user selects a screen, temporarily create a video element\n\t\t\tconst video = document.createElement('video');\n\t\t\tvideo.srcObject = mediaStream;\n\t\t\t// Ensure the video loads without affecting user experience or tab switching\n\t\t\tawait video.play();\n\t\t\t// Set up the canvas to match the video dimensions\n\t\t\tconst canvas = document.createElement('canvas');\n\t\t\tcanvas.width = video.videoWidth;\n\t\t\tcanvas.height = video.videoHeight;\n\t\t\t// Grab a single frame from the video stream using the canvas\n\t\t\tconst context = canvas.getContext('2d');\n\t\t\tcontext.drawImage(video, 0, 0, canvas.width, canvas.height);\n\t\t\t// Stop all video tracks (stop screen sharing) after capturing the image\n\t\t\tmediaStream.getTracks().forEach((track) => track.stop());\n\n\t\t\t// bring back focus to this current tab, so that the user can see the screen capture\n\t\t\twindow.focus();\n\n\t\t\t// Convert the canvas to a Base64 image URL\n\t\t\tconst imageUrl = canvas.toDataURL('image/png');\n\t\t\t// Add the captured image to the files array to render it\n\t\t\tfiles = [...files, { type: 'image', url: imageUrl }];\n\t\t\t// Clean memory: Clear video srcObject\n\t\t\tvideo.srcObject = null;\n\t\t} catch (error) {\n\t\t\t// Handle any errors (e.g., user cancels screen sharing)\n\t\t\tconsole.error('Error capturing screen:', error);\n\t\t}\n\t};\n\n\t// Modified code for uploadFileHandler\n\tconst uploadFileHandler = async (file, fullContext = false) => {\n\t\t// Permission check remains the same\n\t\t\n\t\t// Determine if file is Excel\n\t\tconst fileExtension = '.' + file.name.split('.').pop().toLowerCase();\n\t\tconst isExcel = (\n\t\t\tfile.type.startsWith('application/vnd.ms-excel') || \n\t\t\tfile.type === 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' ||\n\t\t\tfileExtension === '.xlsx' || \n\t\t\tfileExtension === '.xls' || \n\t\t\tfileExtension === '.csv'\n\t\t);\n\t\t\n\t\t// Create file item\n\t\tconst tempItemId = uuidv4();\n\t\tconst fileItem = {\n\t\t\ttype: isExcel ? 'excel' : 'file',\n\t\t\tfile: '',\n\t\t\tid: null,\n\t\t\turl: '',\n\t\t\tname: file.name,\n\t\t\tcollection_name: '',\n\t\t\tstatus: 'uploading',\n\t\t\tsize: file.size,\n\t\t\terror: '',\n\t\t\titemId: tempItemId,\n\t\t\tconversionResult: null, \n\t\t\t...(fullContext ? { context: 'full' } : {})\n\t\t};\n\n\t\tif (fileItem.size == 0) {\n\t\t\ttoast.error($i18n.t('You cannot upload an empty file.'));\n\t\t\treturn null;\n\t\t}\n\n\t\tfiles = [...files, fileItem];\n\n\t\ttry {\n\t\t\tconst formData = new FormData();\n\t\t\tformData.append('file', file);\n\t\t\t\n\t\t\t// Process Excel files\n\t\t\tif (isExcel) {\n\t\t\t\tconsole.log('Processing Excel file:', file.name, 'Size:', file.size);\n\t\t\t\t// Extract Excel metadata first\n\t\t\t\tlet excelMetadata = null;\n\t\t\t\ttry {\n\t\t\t\t\texcelMetadata = await extractExcelMetadata(file);\n\t\t\t\t\tformData.append('metadata', JSON.stringify({\n\t\t\t\t\t\tsheetNames: excelMetadata.sheetNames,\n\t\t\t\t\t\trowCount: excelMetadata.rowCount,\n\t\t\t\t\t\tcolumnCount: excelMetadata.columnCount,\n\t\t\t\t\t\theaders: excelMetadata.headers,\n\t\t\t\t\t\tpreviewData: excelMetadata.previewData\n\t\t\t\t\t}));\n\t\t\t\t\tconsole.log('Excel metadata extracted successfully', excelMetadata);\n\t\t\t\t} catch (metadataError) {\n\t\t\t\t\tconsole.error('Failed to extract Excel metadata:', metadataError);\n\t\t\t\t}\n\n\t\t\t\tconsole.log('FormData 内容:', Array.from(formData.entries()).map(([k, v]) => ({\n\t\t\t\t\t\tkey: k,\n\t\t\t\t\t\tvalue: v instanceof File ? v.name : v\n\t\t\t\t\t})));\n\n\t\t\t\tconst conversionResponse = await fetch('http://localhost:8080/proxy/excel-to-sql', {\n\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t'Authorization': 'Bearer token_59b8b43a_aiurmmm0',\n\t\t\t\t\t\t'Accept-Language': 'en'\n\t\t\t\t\t},\n\t\t\t\t\tbody: formData\n\t\t\t\t});\n\n\t\t\t\tif (!conversionResponse.ok) {\n\t\t\t\t\tconst error = await conversionResponse.json();\n\t\t\t\t\tthrow new Error(error.detail || 'Excel conversion failed');\n\t\t\t\t}\n\n\t\t\t\t// Store conversion result\n\t\t\t\tconst conversionResult = await conversionResponse.json();\n\t\t\t\tfileItem.conversionResult = conversionResult;\n\t\t\t\t\n\t\t\t\t// IMPORTANT: Also upload the original Excel file\n\t\t\t\tconst uploadedFile = await uploadFile(localStorage.token, file, formData);\n\t\t\t\tif (uploadedFile) {\n\t\t\t\t\tfileItem.file = uploadedFile;\n\t\t\t\t\tfileItem.id = uploadedFile.id;\n\t\t\t\t\tfileItem.url = `${WEBUI_API_BASE_URL}/files/${uploadedFile.id}`;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Process non-Excel files\n\t\t\t\tconst uploadedFile = await uploadFile(localStorage.token, file, formData);\n\t\t\t\tif (uploadedFile) {\n\t\t\t\t\tfileItem.file = uploadedFile;\n\t\t\t\t\tfileItem.id = uploadedFile.id;\n\t\t\t\t\tfileItem.url = `${WEBUI_API_BASE_URL}/files/${uploadedFile.id}`;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Update status\n\t\t\tfiles = files.map(item => \n\t\t\t\titem.itemId === tempItemId ? {...fileItem, status: 'processed'} : item\n\t\t\t);\n\n\t\t} catch (e) {\n\t\t\tfiles = files.map(item => \n\t\t\t\titem.itemId === tempItemId ? {\n\t\t\t\t\t...item, \n\t\t\t\t\tstatus: 'error',\n\t\t\t\t\terror: e.message\n\t\t\t\t} : item\n\t\t\t);\n\t\t\ttoast.error($i18n.t('File processing failed: {{error}}', { error: e.message }));\n\t\t}\n\t}\n\n\t// Add this function to extract Excel metadata\n\tconst extractExcelMetadata = async (file) => {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst reader = new FileReader();\n\t\t\treader.onload = async (event) => {\n\t\t\ttry {\n\t\t\t\t// You'll need to include a library like SheetJS/xlsx\n\t\t\t\tconst workbook = XLSX.read(event.target.result, { type: 'array' });\n\t\t\t\tconst firstSheetName = workbook.SheetNames[0];\n\t\t\t\tconst worksheet = workbook.Sheets[firstSheetName];\n\t\t\t\t\n\t\t\t\t// Get column names (assuming first row contains headers)\n\t\t\t\tconst headers = XLSX.utils.sheet_to_json(worksheet, { header: 1 })[0];\n\t\t\t\t\n\t\t\t\t// Get total row count\n\t\t\t\tconst jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });\n\t\t\t\tconst rowCount = jsonData.length - 1; // Subtract header row\n\t\t\t\t\n\t\t\t\t// Get 3 sample rows (excluding header)\n\t\t\t\tconst sampleRows = jsonData.slice(1, 4);\n\t\t\t\t\n\t\t\t\tresolve({\n\t\t\t\tcolumnNames: headers,\n\t\t\t\trowCount: rowCount,\n\t\t\t\tsampleRows: sampleRows\n\t\t\t\t});\n\t\t\t} catch (error) {\n\t\t\t\treject(error);\n\t\t\t}\n\t\t\t};\n\t\t\treader.onerror = (error) => reject(error);\n\t\t\treader.readAsArrayBuffer(file);\n\t\t});\n\t};\n\n\tconst inputFilesHandler = async (inputFiles) => {\n\t\tconsole.log('Input files handler called with:', inputFiles);\n\t\tinputFiles.forEach((file) => {\n\t\t\tconsole.log('Processing file:', {\n\t\t\t\tname: file.name,\n\t\t\t\ttype: file.type,\n\t\t\t\tsize: file.size,\n\t\t\t\textension: file.name.split('.').at(-1)\n\t\t\t});\n\n\t\t\tif (\n\t\t\t\t($config?.file?.max_size ?? null) !== null &&\n\t\t\t\tfile.size > ($config?.file?.max_size ?? 0) * 1024 * 1024\n\t\t\t) {\n\t\t\t\tconsole.log('File exceeds max size limit:', {\n\t\t\t\t\tfileSize: file.size,\n\t\t\t\t\tmaxSize: ($config?.file?.max_size ?? 0) * 1024 * 1024\n\t\t\t\t});\n\t\t\t\ttoast.error(\n\t\t\t\t\t$i18n.t(`File size should not exceed {{maxSize}} MB.`, {\n\t\t\t\t\t\tmaxSize: $config?.file?.max_size\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t\treturn;\n\t\t\t}\n\t\n\t\t\tconst excelExtensions = ['.xls', '.xlsx', '.csv', '.ods'];\n    \t\tconst fileExtension = '.' + file.name.split('.').pop().toLowerCase();\n\t\t\t// Add Excel file type detection\n\t\t\tconst isExcel = \n\t\t\t\t['application/vnd.ms-excel', \n\t\t\t\t'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\n\t\t\t\t'application/vnd.oasis.opendocument.spreadsheet',\n\t\t\t\t'text/csv'].includes(file.type) || \n\t\t\t\t['.xls', '.xlsx', '.csv', '.ods'].includes('.' + file.name.split('.').pop().toLowerCase());\n\n\t\t\tif (\n\t\t\t\t['image/gif', 'image/webp', 'image/jpeg', 'image/png', 'image/avif'].includes(file['type'])\n\t\t\t) {\n\t\t\t\tif (visionCapableModels.length === 0) {\n\t\t\t\t\ttoast.error($i18n.t('Selected model(s) do not support image inputs'));\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tlet reader = new FileReader();\n\t\t\t\treader.onload = async (event) => {\n\t\t\t\t\tlet imageUrl = event.target.result;\n\n\t\t\t\t\tif ($settings?.imageCompression ?? false) {\n\t\t\t\t\t\tconst width = $settings?.imageCompressionSize?.width ?? null;\n\t\t\t\t\t\tconst height = $settings?.imageCompressionSize?.height ?? null;\n\n\t\t\t\t\t\tif (width || height) {\n\t\t\t\t\t\t\timageUrl = await compressImage(imageUrl, width, height);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tfiles = [\n\t\t\t\t\t\t...files,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttype: 'image',\n\t\t\t\t\t\t\turl: `${imageUrl}`\n\t\t\t\t\t\t}\n\t\t\t\t\t];\n\t\t\t\t};\n\t\t\t\treader.readAsDataURL(file);\n\t\t\t} else if (isExcel) {\n\t\t\t\t// Handle Excel files with custom preview if needed\n\t\t\t\tconsole.log('Excel file detected:', file.name);\n\t\t\t\t(async () => {\n\t\t\t\t\ttry {\n\t\t\t\t\t\t// Extract metadata before uploading\n\t\t\t\t\t\tconst excelMetadata = await extractExcelMetadata(file);\n\t\t\t\t\t\tconsole.log('Excel metadata:', excelMetadata);\n\n\t\t\t\t\t\t// Create a file object with the metadata\n\t\t\t\t\t\tconst fileWithMetadata = new File(\n\t\t\t\t\t\t\t[file], \n\t\t\t\t\t\t\tfile.name, \n\t\t\t\t\t\t\t{ type: file.type }\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\t// Add the metadata and SQL to the file object\n\t\t\t\t\t\tfileWithMetadata.excelMetadata = excelMetadata;\n\n\t\t\t\t\t\tuploadFileHandler(file, true); // Set fullContext to true for Excel files\n\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\tconsole.error('Error extracting Excel metadata:', error);\n\t\t\t\t\t\ttoast.error($i18n.t('Error processing Excel file: {{error}}', {\n\t\t\t\t\t\t\terror: error.message\n\t\t\t\t\t\t}));\n\t\t\t\t\t}\n\t\t\t\t})();\n\t\t\t} else {\n\t\t\t\tuploadFileHandler(file);\n\t\t\t}\n\t\t});\n\t};\n\n\tconst handleKeyDown = (event: KeyboardEvent) => {\n\t\tif (event.key === 'Escape') {\n\t\t\tconsole.log('Escape');\n\t\t\tdragged = false;\n\t\t}\n\t};\n\n\tconst onDragOver = (e) => {\n\t\te.preventDefault();\n\n\t\t// Check if a file is being dragged.\n\t\tif (e.dataTransfer?.types?.includes('Files')) {\n\t\t\tdragged = true;\n\t\t} else {\n\t\t\tdragged = false;\n\t\t}\n\t};\n\n\tconst onDragLeave = () => {\n\t\tdragged = false;\n\t};\n\n\tconst onDrop = async (e) => {\n\t\te.preventDefault();\n\t\tconsole.log(e);\n\n\t\tif (e.dataTransfer?.files) {\n\t\t\tconst inputFiles = Array.from(e.dataTransfer?.files);\n\t\t\tif (inputFiles && inputFiles.length > 0) {\n\t\t\t\tconsole.log(inputFiles);\n\t\t\t\tinputFilesHandler(inputFiles);\n\t\t\t}\n\t\t}\n\n\t\tdragged = false;\n\t};\n\n\tonMount(async () => {\n\t\tloaded = true;\n\n\t\twindow.setTimeout(() => {\n\t\t\tconst chatInput = document.getElementById('chat-input');\n\t\t\tchatInput?.focus();\n\t\t}, 0);\n\n\t\twindow.addEventListener('keydown', handleKeyDown);\n\n\t\tawait tick();\n\n\t\tconst dropzoneElement = document.getElementById('chat-container');\n\n\t\tdropzoneElement?.addEventListener('dragover', onDragOver);\n\t\tdropzoneElement?.addEventListener('drop', onDrop);\n\t\tdropzoneElement?.addEventListener('dragleave', onDragLeave);\n\t});\n\n\tonDestroy(() => {\n\t\tconsole.log('destroy');\n\t\twindow.removeEventListener('keydown', handleKeyDown);\n\n\t\tconst dropzoneElement = document.getElementById('chat-container');\n\n\t\tif (dropzoneElement) {\n\t\t\tdropzoneElement?.removeEventListener('dragover', onDragOver);\n\t\t\tdropzoneElement?.removeEventListener('drop', onDrop);\n\t\t\tdropzoneElement?.removeEventListener('dragleave', onDragLeave);\n\t\t}\n\t});\n</script>\n\n<FilesOverlay show={dragged} />\n\n{#if loaded}\n\t<div class=\"w-full font-primary\">\n\t\t<div class=\" mx-auto inset-x-0 bg-transparent flex justify-center\">\n\t\t\t<div\n\t\t\t\tclass=\"flex flex-col px-3 {($settings?.widescreenMode ?? null)\n\t\t\t\t\t? 'max-w-full'\n\t\t\t\t\t: 'max-w-6xl'} w-full\"\n\t\t\t>\n\t\t\t\t<div class=\"relative\">\n\t\t\t\t\t{#if autoScroll === false && history?.currentId}\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclass=\" absolute -top-12 left-0 right-0 flex justify-center z-30 pointer-events-none\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclass=\" bg-white border border-gray-100 dark:border-none dark:bg-white/20 p-1.5 rounded-full pointer-events-auto\"\n\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\tautoScroll = true;\n\t\t\t\t\t\t\t\t\tscrollToBottom();\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\t\tviewBox=\"0 0 20 20\"\n\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\t\t\tclass=\"w-5 h-5\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t\t\td=\"M10 3a.75.75 0 01.75.75v10.638l3.96-4.158a.75.75 0 111.08 1.04l-5.25 5.5a.75.75 0 01-1.08 0l-5.25-5.5a.75.75 0 111.08-1.04l3.96 4.158V3.75A.75.75 0 0110 3z\"\n\t\t\t\t\t\t\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"w-full relative\">\n\t\t\t\t\t{#if atSelectedModel !== undefined || selectedToolIds.length > 0 || webSearchEnabled || ($settings?.webSearch ?? false) === 'always' || imageGenerationEnabled || codeInterpreterEnabled}\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclass=\"px-3 pb-0.5 pt-1.5 text-left w-full flex flex-col absolute bottom-0 left-0 right-0 bg-linear-to-t from-white dark:from-gray-900 z-10\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{#if selectedToolIds.length > 0}\n\t\t\t\t\t\t\t\t<div class=\"flex items-center justify-between w-full\">\n\t\t\t\t\t\t\t\t\t<div class=\"flex items-center gap-2.5 text-sm dark:text-gray-500\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"pl-1\">\n\t\t\t\t\t\t\t\t\t\t\t<span class=\"relative flex size-2\">\n\t\t\t\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"animate-ping absolute inline-flex h-full w-full rounded-full bg-yellow-400 opacity-75\"\n\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"relative inline-flex rounded-full size-2 bg-yellow-500\" />\n\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class=\"  text-ellipsis line-clamp-1 flex\">\n\t\t\t\t\t\t\t\t\t\t\t{#each selectedToolIds.map((id) => {\n\t\t\t\t\t\t\t\t\t\t\t\treturn $tools ? $tools.find((t) => t.id === id) : { id: id, name: id };\n\t\t\t\t\t\t\t\t\t\t\t}) as tool, toolIdx (toolIdx)}\n\t\t\t\t\t\t\t\t\t\t\t\t<Tooltip\n\t\t\t\t\t\t\t\t\t\t\t\t\tcontent={tool?.meta?.description ?? ''}\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\" {toolIdx !== 0 ? 'pl-0.5' : ''} shrink-0\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tplacement=\"top\"\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{tool.name}\n\t\t\t\t\t\t\t\t\t\t\t\t</Tooltip>\n\n\t\t\t\t\t\t\t\t\t\t\t\t{#if toolIdx !== selectedToolIds.length - 1}\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span>, </span>\n\t\t\t\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{/if}\n\n\t\t\t\t\t\t\t{#if webSearchEnabled || ($config?.features?.enable_web_search && ($settings?.webSearch ?? false)) === 'always'}\n\t\t\t\t\t\t\t\t<div class=\"flex items-center justify-between w-full\">\n\t\t\t\t\t\t\t\t\t<div class=\"flex items-center gap-2.5 text-sm dark:text-gray-500\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"pl-1\">\n\t\t\t\t\t\t\t\t\t\t\t<span class=\"relative flex size-2\">\n\t\t\t\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"animate-ping absolute inline-flex h-full w-full rounded-full bg-blue-400 opacity-75\"\n\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"relative inline-flex rounded-full size-2 bg-blue-500\" />\n\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class=\" translate-y-[0.5px]\">{$i18n.t('Search the internet')}</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{/if}\n\n\t\t\t\t\t\t\t{#if imageGenerationEnabled}\n\t\t\t\t\t\t\t\t<div class=\"flex items-center justify-between w-full\">\n\t\t\t\t\t\t\t\t\t<div class=\"flex items-center gap-2.5 text-sm dark:text-gray-500\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"pl-1\">\n\t\t\t\t\t\t\t\t\t\t\t<span class=\"relative flex size-2\">\n\t\t\t\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"animate-ping absolute inline-flex h-full w-full rounded-full bg-teal-400 opacity-75\"\n\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"relative inline-flex rounded-full size-2 bg-teal-500\" />\n\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class=\" translate-y-[0.5px]\">{$i18n.t('Generate an image')}</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{/if}\n\n\t\t\t\t\t\t\t{#if codeInterpreterEnabled}\n\t\t\t\t\t\t\t\t<div class=\"flex items-center justify-between w-full\">\n\t\t\t\t\t\t\t\t\t<div class=\"flex items-center gap-2.5 text-sm dark:text-gray-500\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"pl-1\">\n\t\t\t\t\t\t\t\t\t\t\t<span class=\"relative flex size-2\">\n\t\t\t\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75\"\n\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"relative inline-flex rounded-full size-2 bg-green-500\" />\n\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class=\" translate-y-[0.5px]\">{$i18n.t('Execute code for analysis')}</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{/if}\n\n\t\t\t\t\t\t\t{#if atSelectedModel !== undefined}\n\t\t\t\t\t\t\t\t<div class=\"flex items-center justify-between w-full\">\n\t\t\t\t\t\t\t\t\t<div class=\"pl-[1px] flex items-center gap-2 text-sm dark:text-gray-500\">\n\t\t\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\t\t\tcrossorigin=\"anonymous\"\n\t\t\t\t\t\t\t\t\t\t\talt=\"model profile\"\n\t\t\t\t\t\t\t\t\t\t\tclass=\"size-3.5 max-w-[28px] object-cover rounded-full\"\n\t\t\t\t\t\t\t\t\t\t\tsrc={$models.find((model) => model.id === atSelectedModel.id)?.info?.meta\n\t\t\t\t\t\t\t\t\t\t\t\t?.profile_image_url ??\n\t\t\t\t\t\t\t\t\t\t\t\t($i18n.language === 'dg-DG'\n\t\t\t\t\t\t\t\t\t\t\t\t\t? `/doge.png`\n\t\t\t\t\t\t\t\t\t\t\t\t\t: `static/favicon.png`)}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t<div class=\"translate-y-[0.5px]\">\n\t\t\t\t\t\t\t\t\t\t\tTalking to <span class=\" font-medium\">{atSelectedModel.name}</span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\tclass=\"flex items-center dark:text-gray-500\"\n\t\t\t\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\t\t\t\tatSelectedModel = undefined;\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<XMark />\n\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n\n\t\t\t\t\t<Commands\n\t\t\t\t\t\tbind:this={commandsElement}\n\t\t\t\t\t\tbind:prompt\n\t\t\t\t\t\tbind:files\n\t\t\t\t\t\thistory={history}\n\t\t\t\t\t\ton:upload={(e) => {\n\t\t\t\t\t\t\tdispatch('upload', e.detail);\n\t\t\t\t\t\t}}\n\t\t\t\t\t\ton:select={(e) => {\n\t\t\t\t\t\t\tconst data = e.detail;\n\n\t\t\t\t\t\t\tif (data?.type === 'model') {\n\t\t\t\t\t\t\t\tatSelectedModel = data.data;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tconst chatInputElement = document.getElementById('chat-input');\n\t\t\t\t\t\t\tchatInputElement?.focus();\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class=\"{transparentBackground ? 'bg-transparent' : 'bg-white dark:bg-gray-900'} \">\n\t\t\t<div\n\t\t\t\tclass=\"{($settings?.widescreenMode ?? null)\n\t\t\t\t\t? 'max-w-full'\n\t\t\t\t\t: 'max-w-6xl'} px-2.5 mx-auto inset-x-0\"\n\t\t\t>\n\t\t\t\t<div class=\"\">\n\t\t\t\t\t<input\n\t\t\t\t\t\tbind:this={filesInputElement}\n\t\t\t\t\t\tbind:files={inputFiles}\n\t\t\t\t\t\ttype=\"file\"\n\t\t\t\t\t\thidden\n\t\t\t\t\t\tmultiple\n\t\t\t\t\t\ton:change={async () => {\n\t\t\t\t\t\t\tif (inputFiles && inputFiles.length > 0) {\n\t\t\t\t\t\t\t\tconst _inputFiles = Array.from(inputFiles);\n\t\t\t\t\t\t\t\tinputFilesHandler(_inputFiles);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\ttoast.error($i18n.t(`File not found.`));\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tfilesInputElement.value = '';\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\n\t\t\t\t\t{#if recording}\n\t\t\t\t\t\t<VoiceRecording\n\t\t\t\t\t\t\tbind:recording\n\t\t\t\t\t\t\ton:cancel={async () => {\n\t\t\t\t\t\t\t\trecording = false;\n\n\t\t\t\t\t\t\t\tawait tick();\n\t\t\t\t\t\t\t\tdocument.getElementById('chat-input')?.focus();\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\ton:confirm={async (e) => {\n\t\t\t\t\t\t\t\tconst { text, filename } = e.detail;\n\t\t\t\t\t\t\t\tprompt = `${prompt}${text} `;\n\n\t\t\t\t\t\t\t\trecording = false;\n\n\t\t\t\t\t\t\t\tawait tick();\n\t\t\t\t\t\t\t\tdocument.getElementById('chat-input')?.focus();\n\n\t\t\t\t\t\t\t\tif ($settings?.speechAutoSend ?? false) {\n\t\t\t\t\t\t\t\t\tdispatch('submit', prompt);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t{:else}\n\t\t\t\t\t\t<form\n\t\t\t\t\t\t\tclass=\"w-full flex gap-1.5\"\n\t\t\t\t\t\t\ton:submit|preventDefault={() => {\n\t\t\t\t\t\t\t\t// check if selectedModels support image input\n\t\t\t\t\t\t\t\tdispatch('submit', prompt);\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\"flex-1 flex flex-col relative w-full rounded-3xl px-1 bg-gray-600/5 dark:bg-gray-400/5 dark:text-gray-100\"\n\t\t\t\t\t\t\t\tdir={$settings?.chatDirection ?? 'LTR'}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{#if files.length > 0}\n\t\t\t\t\t\t\t\t\t<div class=\"mx-2 mt-2.5 -mb-1 flex items-center flex-wrap gap-2\">\n\t\t\t\t\t\t\t\t\t\t{#each files as file, fileIdx}\n\t\t\t\t\t\t\t\t\t\t\t{#if file.type === 'image'}\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\" relative group\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"relative flex items-center\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Image\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsrc={file.url}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\talt=\"input\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\timageClassName=\" size-14 rounded-xl object-cover\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{#if atSelectedModel ? visionCapableModels.length === 0 : selectedModels.length !== visionCapableModels.length}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Tooltip\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\" absolute top-1 left-1\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontent={$i18n.t('{{ models }}', {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmodels: [\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t...(atSelectedModel ? [atSelectedModel] : selectedModels)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.filter((id) => !visionCapableModels.includes(id))\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.join(', ')\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"size-4 fill-yellow-300\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003ZM12 8.25a.75.75 0 0 1 .75.75v3.75a.75.75 0 0 1-1.5 0V9a.75.75 0 0 1 .75-.75Zm0 8.25a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class=\" absolute -top-1 -right-1\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\" bg-white text-black border border-white rounded-full group-hover:visible invisible transition\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfiles.splice(fileIdx, 1);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfiles = files;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 20 20\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"size-4\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t{:else if isExcelFile(file)}\n\t\t\t\t\t\t\t\t\t\t\t\t<FileItem\n\t\t\t\t\t\t\t\t\t\t\t\t\titem={file}\n\t\t\t\t\t\t\t\t\t\t\t\t\tname={file.name}\n\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"excel\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tsize={file?.size}\n\t\t\t\t\t\t\t\t\t\t\t\t\tloading={file.status === 'uploading'}\n\t\t\t\t\t\t\t\t\t\t\t\t\tdismissible={true}\n\t\t\t\t\t\t\t\t\t\t\t\t\tedit={true}\n\t\t\t\t\t\t\t\t\t\t\t\t\ton:dismiss={async () => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (file.id) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tawait deleteFileById(localStorage.token, file.id);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfiles.splice(fileIdx, 1);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfiles = files;\n\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t\t\t\t\t<FileItem\n\t\t\t\t\t\t\t\t\t\t\t\t\titem={file}\n\t\t\t\t\t\t\t\t\t\t\t\t\tname={file.name}\n\t\t\t\t\t\t\t\t\t\t\t\t\ttype={file.type}\n\t\t\t\t\t\t\t\t\t\t\t\t\tsize={file?.size}\n\t\t\t\t\t\t\t\t\t\t\t\t\tloading={file.status === 'uploading'}\n\t\t\t\t\t\t\t\t\t\t\t\t\tdismissible={true}\n\t\t\t\t\t\t\t\t\t\t\t\t\tedit={true}\n\t\t\t\t\t\t\t\t\t\t\t\t\ton:dismiss={async () => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (file.type !== 'collection' && !file?.collection) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (file.id) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// This will handle both file deletion and Chroma cleanup\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tawait deleteFileById(localStorage.token, file.id);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t// Remove from UI state\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfiles.splice(fileIdx, 1);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfiles = files;\n\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(file);\n\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t{/if}\n\n\t\t\t\t\t\t\t\t<div class=\"px-2.5\">\n\t\t\t\t\t\t\t\t\t{#if $settings?.richTextInput ?? true}\n\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\tclass=\"scrollbar-hidden text-left bg-transparent dark:text-gray-100 outline-hidden w-full pt-3 px-1 resize-none h-fit max-h-80 overflow-auto\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<RichTextInput\n\t\t\t\t\t\t\t\t\t\t\t\tbind:this={chatInputElement}\n\t\t\t\t\t\t\t\t\t\t\t\tbind:value={prompt}\n\t\t\t\t\t\t\t\t\t\t\t\tid=\"chat-input\"\n\t\t\t\t\t\t\t\t\t\t\t\tmessageInput={true}\n\t\t\t\t\t\t\t\t\t\t\t\tshiftEnter={!$mobile ||\n\t\t\t\t\t\t\t\t\t\t\t\t\t!(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'ontouchstart' in window ||\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tnavigator.maxTouchPoints > 0 ||\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tnavigator.msMaxTouchPoints > 0\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\tplaceholder={placeholder ? placeholder : $i18n.t('Send a Message')}\n\t\t\t\t\t\t\t\t\t\t\t\tlargeTextAsFile={$settings?.largeTextAsFile ?? false}\n\t\t\t\t\t\t\t\t\t\t\t\tautocomplete={$config?.features.enable_autocomplete_generation}\n\t\t\t\t\t\t\t\t\t\t\t\tgenerateAutoCompletion={async (text) => {\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (selectedModelIds.length === 0 || !selectedModelIds.at(0)) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttoast.error($i18n.t('Please select a model first.'));\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst res = await generateAutoCompletion(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlocalStorage.token,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tselectedModelIds.at(0),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttext,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\thistory?.currentId\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? createMessagesList(history, history.currentId)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: null\n\t\t\t\t\t\t\t\t\t\t\t\t\t).catch((error) => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(error);\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(res);\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn res;\n\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\ton:keydown={async (e) => {\n\t\t\t\t\t\t\t\t\t\t\t\t\te = e.detail.event;\n\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst isCtrlPressed = e.ctrlKey || e.metaKey; // metaKey is for Cmd key on Mac\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst commandsContainerElement =\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdocument.getElementById('commands-container');\n\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (e.key === 'Escape') {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstopResponse();\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t// Command/Ctrl + Shift + Enter to submit a message pair\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (isCtrlPressed && e.key === 'Enter' && e.shiftKey) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcreateMessagePair(prompt);\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t// Check if Ctrl + R is pressed\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (prompt === '' && isCtrlPressed && e.key.toLowerCase() === 'r') {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log('regenerate');\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst regenerateButton = [\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t...document.getElementsByClassName('regenerate-response-button')\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t]?.at(-1);\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tregenerateButton?.click();\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (prompt === '' && e.key == 'ArrowUp') {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst userMessageElement = [\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t...document.getElementsByClassName('user-message')\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t]?.at(-1);\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (userMessageElement) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tuserMessageElement.scrollIntoView({ block: 'center' });\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst editButton = [\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t...document.getElementsByClassName('edit-user-message-button')\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t]?.at(-1);\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\teditButton?.click();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (commandsContainerElement) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (commandsContainerElement && e.key === 'ArrowUp') {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcommandsElement.selectUp();\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst commandOptionButton = [\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t...document.getElementsByClassName('selected-command-option-button')\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t]?.at(-1);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcommandOptionButton.scrollIntoView({ block: 'center' });\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (commandsContainerElement && e.key === 'ArrowDown') {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcommandsElement.selectDown();\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst commandOptionButton = [\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t...document.getElementsByClassName('selected-command-option-button')\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t]?.at(-1);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcommandOptionButton.scrollIntoView({ block: 'center' });\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (commandsContainerElement && e.key === 'Tab') {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst commandOptionButton = [\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t...document.getElementsByClassName('selected-command-option-button')\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t]?.at(-1);\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcommandOptionButton?.click();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (commandsContainerElement && e.key === 'Enter') {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst commandOptionButton = [\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t...document.getElementsByClassName('selected-command-option-button')\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t]?.at(-1);\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (commandOptionButton) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcommandOptionButton?.click();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdocument.getElementById('send-message-button')?.click();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t!$mobile ||\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t!(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'ontouchstart' in window ||\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tnavigator.maxTouchPoints > 0 ||\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tnavigator.msMaxTouchPoints > 0\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// Prevent Enter key from creating a new line\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// Uses keyCode '13' for Enter key for chinese/japanese keyboards\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (e.keyCode === 13 && !e.shiftKey) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// Submit the prompt when Enter key is pressed\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(prompt !== '' || files.length > 0) &&\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.keyCode === 13 &&\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t!e.shiftKey\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdispatch('submit', prompt);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (e.key === 'Escape') {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log('Escape');\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tatSelectedModel = undefined;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tselectedToolIds = [];\n\t\t\t\t\t\t\t\t\t\t\t\t\t\twebSearchEnabled = false;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\timageGenerationEnabled = false;\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\ton:paste={async (e) => {\n\t\t\t\t\t\t\t\t\t\t\t\t\te = e.detail.event;\n\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(e);\n\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst clipboardData = e.clipboardData || window.clipboardData;\n\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (clipboardData && clipboardData.items) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfor (const item of clipboardData.items) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (item.type.indexOf('image') !== -1) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst blob = item.getAsFile();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst reader = new FileReader();\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treader.onload = function (e) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfiles = [\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t...files,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype: 'image',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\turl: `${e.target.result}`\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t];\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treader.readAsDataURL(blob);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t} else if (item.type === 'text/plain') {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif ($settings?.largeTextAsFile ?? false) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst text = clipboardData.getData('text/plain');\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (text.length > PASTED_TEXT_CHARACTER_LIMIT) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst blob = new Blob([text], { type: 'text/plain' });\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst file = new File([blob], `Pasted_Text_${Date.now()}.txt`, {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype: 'text/plain'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tawait uploadFileHandler(file, true);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\t\t\t\tid=\"chat-input\"\n\t\t\t\t\t\t\t\t\t\t\tbind:this={chatInputElement}\n\t\t\t\t\t\t\t\t\t\t\tclass=\"scrollbar-hidden bg-transparent dark:text-gray-100 outline-hidden w-full pt-3 px-1 resize-none\"\n\t\t\t\t\t\t\t\t\t\t\tplaceholder={placeholder ? placeholder : $i18n.t('Send a Message')}\n\t\t\t\t\t\t\t\t\t\t\tbind:value={prompt}\n\t\t\t\t\t\t\t\t\t\t\ton:keypress={(e) => {\n\t\t\t\t\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t\t\t\t\t!$mobile ||\n\t\t\t\t\t\t\t\t\t\t\t\t\t!(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'ontouchstart' in window ||\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tnavigator.maxTouchPoints > 0 ||\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tnavigator.msMaxTouchPoints > 0\n\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t// Prevent Enter key from creating a new line\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (e.key === 'Enter' && !e.shiftKey) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t// Submit the prompt when Enter key is pressed\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t(prompt !== '' || files.length > 0) &&\n\t\t\t\t\t\t\t\t\t\t\t\t\t\te.key === 'Enter' &&\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t!e.shiftKey\n\t\t\t\t\t\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdispatch('submit', prompt);\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\ton:keydown={async (e) => {\n\t\t\t\t\t\t\t\t\t\t\t\tconst isCtrlPressed = e.ctrlKey || e.metaKey; // metaKey is for Cmd key on Mac\n\t\t\t\t\t\t\t\t\t\t\t\tconst commandsContainerElement =\n\t\t\t\t\t\t\t\t\t\t\t\t\tdocument.getElementById('commands-container');\n\n\t\t\t\t\t\t\t\t\t\t\t\tif (e.key === 'Escape') {\n\t\t\t\t\t\t\t\t\t\t\t\t\tstopResponse();\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t// Command/Ctrl + Shift + Enter to submit a message pair\n\t\t\t\t\t\t\t\t\t\t\t\tif (isCtrlPressed && e.key === 'Enter' && e.shiftKey) {\n\t\t\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\t\t\t\t\t\tcreateMessagePair(prompt);\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\t// Check if Ctrl + R is pressed\n\t\t\t\t\t\t\t\t\t\t\t\tif (prompt === '' && isCtrlPressed && e.key.toLowerCase() === 'r') {\n\t\t\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log('regenerate');\n\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst regenerateButton = [\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t...document.getElementsByClassName('regenerate-response-button')\n\t\t\t\t\t\t\t\t\t\t\t\t\t]?.at(-1);\n\n\t\t\t\t\t\t\t\t\t\t\t\t\tregenerateButton?.click();\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\tif (prompt === '' && e.key == 'ArrowUp') {\n\t\t\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst userMessageElement = [\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t...document.getElementsByClassName('user-message')\n\t\t\t\t\t\t\t\t\t\t\t\t\t]?.at(-1);\n\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst editButton = [\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t...document.getElementsByClassName('edit-user-message-button')\n\t\t\t\t\t\t\t\t\t\t\t\t\t]?.at(-1);\n\n\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(userMessageElement);\n\n\t\t\t\t\t\t\t\t\t\t\t\t\tuserMessageElement.scrollIntoView({ block: 'center' });\n\t\t\t\t\t\t\t\t\t\t\t\t\teditButton?.click();\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\tif (commandsContainerElement && e.key === 'ArrowUp') {\n\t\t\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\t\t\t\t\t\tcommandsElement.selectUp();\n\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst commandOptionButton = [\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t...document.getElementsByClassName('selected-command-option-button')\n\t\t\t\t\t\t\t\t\t\t\t\t\t]?.at(-1);\n\t\t\t\t\t\t\t\t\t\t\t\t\tcommandOptionButton.scrollIntoView({ block: 'center' });\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\tif (commandsContainerElement && e.key === 'ArrowDown') {\n\t\t\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\t\t\t\t\t\tcommandsElement.selectDown();\n\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst commandOptionButton = [\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t...document.getElementsByClassName('selected-command-option-button')\n\t\t\t\t\t\t\t\t\t\t\t\t\t]?.at(-1);\n\t\t\t\t\t\t\t\t\t\t\t\t\tcommandOptionButton.scrollIntoView({ block: 'center' });\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\tif (commandsContainerElement && e.key === 'Enter') {\n\t\t\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst commandOptionButton = [\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t...document.getElementsByClassName('selected-command-option-button')\n\t\t\t\t\t\t\t\t\t\t\t\t\t]?.at(-1);\n\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (e.shiftKey) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tprompt = `${prompt}\\n`;\n\t\t\t\t\t\t\t\t\t\t\t\t\t} else if (commandOptionButton) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcommandOptionButton?.click();\n\t\t\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdocument.getElementById('send-message-button')?.click();\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\tif (commandsContainerElement && e.key === 'Tab') {\n\t\t\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst commandOptionButton = [\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t...document.getElementsByClassName('selected-command-option-button')\n\t\t\t\t\t\t\t\t\t\t\t\t\t]?.at(-1);\n\n\t\t\t\t\t\t\t\t\t\t\t\t\tcommandOptionButton?.click();\n\t\t\t\t\t\t\t\t\t\t\t\t} else if (e.key === 'Tab') {\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst words = findWordIndices(prompt);\n\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (words.length > 0) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst word = words.at(0);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst fullPrompt = prompt;\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tprompt = prompt.substring(0, word?.endIndex + 1);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tawait tick();\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\te.target.scrollTop = e.target.scrollHeight;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tprompt = fullPrompt;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tawait tick();\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\te.target.setSelectionRange(word?.startIndex, word.endIndex + 1);\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\t\te.target.style.height = '';\n\t\t\t\t\t\t\t\t\t\t\t\t\te.target.style.height = Math.min(e.target.scrollHeight, 320) + 'px';\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\tif (e.key === 'Escape') {\n\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log('Escape');\n\t\t\t\t\t\t\t\t\t\t\t\t\tatSelectedModel = undefined;\n\t\t\t\t\t\t\t\t\t\t\t\t\tselectedToolIds = [];\n\t\t\t\t\t\t\t\t\t\t\t\t\twebSearchEnabled = false;\n\t\t\t\t\t\t\t\t\t\t\t\t\timageGenerationEnabled = false;\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\t\t\t\t\ton:input={async (e) => {\n\t\t\t\t\t\t\t\t\t\t\t\te.target.style.height = '';\n\t\t\t\t\t\t\t\t\t\t\t\te.target.style.height = Math.min(e.target.scrollHeight, 320) + 'px';\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\ton:focus={async (e) => {\n\t\t\t\t\t\t\t\t\t\t\t\te.target.style.height = '';\n\t\t\t\t\t\t\t\t\t\t\t\te.target.style.height = Math.min(e.target.scrollHeight, 320) + 'px';\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\ton:paste={async (e) => {\n\t\t\t\t\t\t\t\t\t\t\t\tconst clipboardData = e.clipboardData || window.clipboardData;\n\n\t\t\t\t\t\t\t\t\t\t\t\tif (clipboardData && clipboardData.items) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tfor (const item of clipboardData.items) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (item.type.indexOf('image') !== -1) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst blob = item.getAsFile();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst reader = new FileReader();\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treader.onload = function (e) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfiles = [\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t...files,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype: 'image',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\turl: `${e.target.result}`\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t];\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treader.readAsDataURL(blob);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t} else if (item.type === 'text/plain') {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif ($settings?.largeTextAsFile ?? false) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst text = clipboardData.getData('text/plain');\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (text.length > PASTED_TEXT_CHARACTER_LIMIT) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst blob = new Blob([text], { type: 'text/plain' });\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst file = new File([blob], `Pasted_Text_${Date.now()}.txt`, {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype: 'text/plain'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tawait uploadFileHandler(file, true);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t<div class=\" flex justify-between mt-1.5 mb-2.5 mx-0.5 max-w-full\">\n\t\t\t\t\t\t\t\t\t<div class=\"ml-1 self-end gap-0.5 flex items-center flex-1 max-w-[80%]\">\n\t\t\t\t\t\t\t\t\t\t<InputMenu\n\t\t\t\t\t\t\t\t\t\t\tbind:selectedToolIds\n\t\t\t\t\t\t\t\t\t\t\t{screenCaptureHandler}\n\t\t\t\t\t\t\t\t\t\t\t{inputFilesHandler}\n\t\t\t\t\t\t\t\t\t\t\tuploadFilesHandler={() => {\n\t\t\t\t\t\t\t\t\t\t\t\tfilesInputElement.click();\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\tuploadGoogleDriveHandler={async () => {\n\t\t\t\t\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst fileData = await createPicker();\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (fileData) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst file = new File([fileData.blob], fileData.name, {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype: fileData.blob.type\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tawait uploadFileHandler(file);\n\t\t\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log('No file was selected from Google Drive');\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.error('Google Drive Error:', error);\n\t\t\t\t\t\t\t\t\t\t\t\t\ttoast.error(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t$i18n.t('Error accessing Google Drive: {{error}}', {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\terror: error.message\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\tuploadOneDriveHandler={async () => {\n\t\t\t\t\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst fileData = await pickAndDownloadFile();\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (fileData) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst file = new File([fileData.blob], fileData.name, {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype: fileData.blob.type || 'application/octet-stream'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tawait uploadFileHandler(file);\n\t\t\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log('No file was selected from OneDrive');\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.error('OneDrive Error:', error);\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\tonClose={async () => {\n\t\t\t\t\t\t\t\t\t\t\t\tawait tick();\n\n\t\t\t\t\t\t\t\t\t\t\t\tconst chatInput = document.getElementById('chat-input');\n\t\t\t\t\t\t\t\t\t\t\t\tchatInput?.focus();\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<!--\n\t\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"bg-transparent hover:bg-gray-100 text-gray-800 dark:text-white dark:hover:bg-gray-800 transition rounded-full p-1.5 outline-hidden focus:outline-hidden\"\n\t\t\t\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\t\t\t\taria-label=\"More\"\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 20 20\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"size-5\"\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M10.75 4.75a.75.75 0 0 0-1.5 0v4.5h-4.5a.75.75 0 0 0 0 1.5h4.5v4.5a.75.75 0 0 0 1.5 0v-4.5h4.5a.75.75 0 0 0 0-1.5h-4.5v-4.5Z\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t\t-->\n\t\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"bg-transparent text-gray-400 dark:text-gray-600 rounded-full p-1.5 outline-hidden focus:outline-hidden cursor-not-allowed opacity-50\"\n\t\t\t\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\t\t\t\taria-label=\"More\"\n\t\t\t\t\t\t\t\t\t\t\t\tdisabled\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 20 20\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"size-5\"\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M10.75 4.75a.75.75 0 0 0-1.5 0v4.5h-4.5a.75.75 0 0 0 0 1.5h4.5v4.5a.75.75 0 0 0 1.5 0v-4.5h4.5a.75.75 0 0 0 0-1.5h-4.5v-4.5Z\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t</InputMenu>\n\n\t\t\t\t\t\t\t\t\t\t<div class=\"flex gap-0.5 items-center overflow-x-auto scrollbar-none flex-1\">\n\t\t\t\t\t\t\t\t\t\t\t{#if $_user}\n\t\t\t\t\t\t\t\t\t\t\t\t{#if $config?.features?.enable_web_search && ($_user.role === 'admin' || $_user?.permissions?.features?.web_search)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Search the internet')} placement=\"top\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ton:click|preventDefault={() => (webSearchEnabled = !webSearchEnabled)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"px-1.5 @sm:px-2.5 py-1.5 flex gap-1.5 items-center text-sm rounded-full font-medium transition-colors duration-300 focus:outline-hidden max-w-full overflow-hidden {webSearchEnabled ||\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t($settings?.webSearch ?? false) === 'always'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? 'bg-blue-100 dark:bg-blue-500/20 text-blue-500 dark:text-blue-400'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: 'bg-transparent text-gray-600 dark:text-gray-300 border-gray-200 hover:bg-gray-100 dark:hover:bg-gray-800'}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<GlobeAlt className=\"size-5\" strokeWidth=\"1.75\" />\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"hidden @sm:block whitespace-nowrap overflow-hidden text-ellipsis translate-y-[0.5px] mr-0.5\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>{$i18n.t('Web Search')}</span\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t\t\t\t\t\t\t{/if}\n\n\t\t\t\t\t\t\t\t\t\t\t\t{#if $config?.features?.enable_image_generation && ($_user.role === 'admin' || $_user?.permissions?.features?.image_generation)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Generate an image')} placement=\"top\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ton:click|preventDefault={() =>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(imageGenerationEnabled = !imageGenerationEnabled)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"px-1.5 @sm:px-2.5 py-1.5 flex gap-1.5 items-center text-sm rounded-full font-medium transition-colors duration-300 focus:outline-hidden max-w-full overflow-hidden {imageGenerationEnabled\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? 'bg-gray-100 dark:bg-gray-500/20 text-gray-600 dark:text-gray-400'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: 'bg-transparent text-gray-600 dark:text-gray-300 border-gray-200 hover:bg-gray-100 dark:hover:bg-gray-800 '}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Photo className=\"size-5\" strokeWidth=\"1.75\" />\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"hidden @sm:block whitespace-nowrap overflow-hidden text-ellipsis translate-y-[0.5px] mr-0.5\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>{$i18n.t('Image')}</span\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t\t\t\t\t\t\t{/if}\n\n\t\t\t\t\t\t\t\t\t\t\t\t{#if false && $config?.features?.enable_code_interpreter && ($_user.role === 'admin' || $_user?.permissions?.features?.code_interpreter)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Execute code for analysis')} placement=\"top\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ton:click|preventDefault={() =>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(codeInterpreterEnabled = !codeInterpreterEnabled)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"px-1.5 @sm:px-2.5 py-1.5 flex gap-1.5 items-center text-sm rounded-full font-medium transition-colors duration-300 focus:outline-hidden max-w-full overflow-hidden {codeInterpreterEnabled\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? 'bg-gray-100 dark:bg-gray-500/20 text-gray-600 dark:text-gray-400'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: 'bg-transparent text-gray-600 dark:text-gray-300 border-gray-200 hover:bg-gray-100 dark:hover:bg-gray-800 '}\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<CommandLine className=\"size-5\" strokeWidth=\"1.75\" />\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"hidden @sm:block whitespace-nowrap overflow-hidden text-ellipsis translate-y-[0.5px] mr-0.5\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>{$i18n.t('Code Interpreter')}</span\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t<div class=\"self-end flex space-x-1 mr-1 shrink-0\">\n\t\t\t\t\t\t\t\t\t\t<!--\n\t\t\t\t\t\t\t\t\t\t{#if !history?.currentId || history.messages[history.currentId]?.done == true}\n\t\t\t\t\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Record voice')}>\n\t\t\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\t\t\tid=\"voice-input-button\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\" text-gray-600 dark:text-gray-300 hover:text-gray-700 dark:hover:text-gray-200 transition rounded-full p-1.5 mr-0.5 self-center\"\n\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\t\t\t\t\ton:click={async () => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlet stream = await navigator.mediaDevices\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.getUserMedia({ audio: true })\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.catch(function (err) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttoast.error(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t$i18n.t(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t`Permission denied when accessing microphone: {{error}}`,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\terror: err\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (stream) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trecording = true;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst tracks = stream.getTracks();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttracks.forEach((track) => track.stop());\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstream = null;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t} catch {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttoast.error($i18n.t('Permission denied when accessing microphone'));\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\taria-label=\"Voice Input\"\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 20 20\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"w-5 h-5 translate-y-[0.5px]\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<path d=\"M7 4a3 3 0 016 0v6a3 3 0 11-6 0V4z\" />\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M5.5 9.643a.75.75 0 00-1.5 0V10c0 3.06 2.29 5.585 5.25 5.954V17.5h-1.5a.75.75 0 000 1.5h4.5a.75.75 0 000-1.5h-1.5v-1.546A6.001 6.001 0 0016 10v-.357a.75.75 0 00-1.5 0V10a4.5 4.5 0 01-9 0v-.357z\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t\t\t-->\n\n\t\t\t\t\t\t\t\t\t\t{#if !history.currentId || history.messages[history.currentId]?.done == true}\n\t\t\t\t\t\t\t\t\t\t\t{#if prompt === '' && files.length === 0}\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\" flex items-center\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<!--\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Call')}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\" {webSearchEnabled ||\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t($settings?.webSearch ?? false) === 'always'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? 'bg-blue-500 text-white hover:bg-blue-400 '\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: 'bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100'} transition rounded-full p-1.5 self-center\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ton:click={async () => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (selectedModels.length > 1) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttoast.error($i18n.t('Select only one model to call'));\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif ($config.audio.stt.engine === 'web') {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttoast.error(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t$i18n.t(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'Call feature is not supported when using Web STT engine'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// check if user has access to getUserMedia\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlet stream = await navigator.mediaDevices.getUserMedia({\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\taudio: true\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// If the user grants the permission, proceed to show the call overlay\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (stream) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst tracks = stream.getTracks();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttracks.forEach((track) => track.stop());\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstream = null;\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif ($settings.audio?.tts?.engine === 'browser-kokoro') {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// If the user has not initialized the TTS worker, initialize it\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (!$TTSWorker) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tawait TTSWorker.set(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tnew KokoroWorker({\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdtype: $settings.audio?.tts?.engineConfig?.dtype ?? 'fp32'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tawait $TTSWorker.init();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tshowCallOverlay.set(true);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tshowControls.set(true);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t} catch (err) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// If the user denies the permission or an error occurs, show an error message\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttoast.error(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t$i18n.t('Permission denied when accessing media devices')\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\taria-label=\"Call\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Headphone className=\"size-5\" />\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t\t\t\t\t\t\t\t-->\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\" flex items-center\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Send message')}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tid=\"send-message-button\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"{!(prompt === '' && files.length === 0)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? webSearchEnabled || ($settings?.webSearch ?? false) === 'always'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? 'bg-blue-500 text-white hover:bg-blue-400 '\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: 'bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 '\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: 'text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled'} transition rounded-full p-1.5 self-center\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"submit\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdisabled={prompt === '' && files.length === 0}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 16 16\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"size-5\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M8 14a.75.75 0 0 1-.75-.75V4.56L4.03 7.78a.75.75 0 0 1-1.06-1.06l4.5-4.5a.75.75 0 0 1 1.06 0l4.5 4.5a.75.75 0 0 1-1.06 1.06L8.75 4.56v8.69A.75.75 0 0 1 8 14Z\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t\t\t\t<div class=\" flex items-center\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Stop')}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"bg-white hover:bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-white dark:hover:bg-gray-800 transition rounded-full p-1.5\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstopResponse();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"size-5\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm6-2.438c0-.724.588-1.312 1.313-1.312h4.874c.725 0 1.313.588 1.313 1.313v4.874c0 .725-.588 1.313-1.313 1.313H9.564a1.312 1.312 0 01-1.313-1.313V9.564z\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</form>\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n{/if}","<script lang=\"ts\">\n\timport { models, showSettings, settings, user, mobile, config } from '$lib/stores';\n\timport { onMount, tick, getContext } from 'svelte';\n\timport { toast } from 'svelte-sonner';\n\timport Selector from './ModelSelector/Selector.svelte';\n\timport Tooltip from '../common/Tooltip.svelte';\n\n\timport { updateUserSettings } from '$lib/apis/users';\n\tconst i18n = getContext('i18n');\n\n\texport let selectedModels = [''];\n\texport let disabled = false;\n\n\texport let showSetDefault = true;\n\n\tconst saveDefaultModel = async () => {\n\t\tconst hasEmptyModel = selectedModels.filter((it) => it === '');\n\t\tif (hasEmptyModel.length) {\n\t\t\ttoast.error($i18n.t('Choose a model before saving...'));\n\t\t\treturn;\n\t\t}\n\t\tsettings.set({ ...$settings, models: selectedModels });\n\t\tawait updateUserSettings(localStorage.token, { ui: $settings });\n\n\t\ttoast.success($i18n.t('Default model updated'));\n\t};\n\n\t$: if (selectedModels.length > 0 && $models.length > 0) {\n\t\tselectedModels = selectedModels.map((model) =>\n\t\t\t$models.map((m) => m.id).includes(model) ? model : ''\n\t\t);\n\t}\n</script>\n\n<div class=\"flex flex-col w-full items-start\">\n\t{#each selectedModels as selectedModel, selectedModelIdx}\n\t\t<div class=\"flex w-full max-w-fit\">\n\t\t\t<div class=\"overflow-hidden w-full\">\n\t\t\t\t<div class=\"mr-1 max-w-full\">\n\t\t\t\t\t<Selector\n\t\t\t\t\t\tid={`${selectedModelIdx}`}\n\t\t\t\t\t\tplaceholder={$i18n.t('Select a model')}\n\t\t\t\t\t\titems={$models.map((model) => ({\n\t\t\t\t\t\t\tvalue: model.id,\n\t\t\t\t\t\t\tlabel: model.name,\n\t\t\t\t\t\t\tmodel: model\n\t\t\t\t\t\t}))}\n\t\t\t\t\t\tshowTemporaryChatControl={$user.role === 'user'\n\t\t\t\t\t\t\t? ($user?.permissions?.chat?.temporary ?? true)\n\t\t\t\t\t\t\t: true}\n\t\t\t\t\t\tbind:value={selectedModel}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t{#if selectedModelIdx === 0}\n\t\t\t\t<div\n\t\t\t\t\tclass=\"  self-center mx-1 disabled:text-gray-600 disabled:hover:text-gray-600 -translate-y-[0.5px]\"\n\t\t\t\t>\n\t\t\t\t\t<Tooltip content={$i18n.t('Add Model')}>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\" \"\n\t\t\t\t\t\t\t{disabled}\n\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\tselectedModels = [...selectedModels, ''];\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\taria-label=\"Add Model\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\tclass=\"size-3.5\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M12 6v12m6-6H6\" />\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</Tooltip>\n\t\t\t\t</div>\n\t\t\t{:else}\n\t\t\t\t<div\n\t\t\t\t\tclass=\"  self-center mx-1 disabled:text-gray-600 disabled:hover:text-gray-600 -translate-y-[0.5px]\"\n\t\t\t\t>\n\t\t\t\t\t<Tooltip content={$i18n.t('Remove Model')}>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t{disabled}\n\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\tselectedModels.splice(selectedModelIdx, 1);\n\t\t\t\t\t\t\t\tselectedModels = selectedModels;\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\taria-label=\"Remove Model\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\tclass=\"size-3\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M19.5 12h-15\" />\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</Tooltip>\n\t\t\t\t</div>\n\t\t\t{/if}\n\t\t</div>\n\t{/each}\n</div>\n\n{#if showSetDefault}\n\t<div class=\" absolute text-left mt-[1px] ml-1 text-[0.7rem] text-gray-500 font-primary\">\n\t\t<button on:click={saveDefaultModel}> {$i18n.t('Set as default')}</button>\n\t</div>\n{/if}\n","<script lang=\"ts\">\n\texport let className = 'size-4';\n\texport let strokeWidth = '2';\n</script>\n\n<svg\n\txmlns=\"http://www.w3.org/2000/svg\"\n\tfill=\"none\"\n\tviewBox=\"0 0 24 24\"\n\tstroke-width={strokeWidth}\n\tstroke=\"currentColor\"\n\tclass={className}\n>\n\t<path\n\t\tstroke-linecap=\"round\"\n\t\tstroke-linejoin=\"round\"\n\t\td=\"M9 6.75V15m6-6v8.25m.503 3.498 4.875-2.437c.381-.19.622-.58.622-1.006V4.82c0-.836-.88-1.38-1.628-1.006l-3.869 1.934c-.317.159-.69.159-1.006 0L9.503 3.252a1.125 1.125 0 0 0-1.006 0L3.622 5.689C3.24 5.88 3 6.27 3 6.695V19.18c0 .836.88 1.38 1.628 1.006l3.869-1.934c.317-.159.69-.159 1.006 0l4.994 2.497c.317.158.69.158 1.006 0Z\"\n\t/>\n</svg>\n","<script lang=\"ts\">\n\texport let className = 'w-4 h-4';\n\texport let strokeWidth = '1.5';\n</script>\n\n<svg\n\txmlns=\"http://www.w3.org/2000/svg\"\n\tviewBox=\"0 0 24 24\"\n\tstroke=\"currentColor\"\n\tfill=\"currentColor\"\n\tclass={className}\n\tstroke-width={strokeWidth}\n>\n\t<path\n\t\td=\"M18.75 12.75h1.5a.75.75 0 0 0 0-1.5h-1.5a.75.75 0 0 0 0 1.5ZM12 6a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 12 6ZM12 18a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 12 18ZM3.75 6.75h1.5a.75.75 0 1 0 0-1.5h-1.5a.75.75 0 0 0 0 1.5ZM5.25 18.75h-1.5a.75.75 0 0 1 0-1.5h1.5a.75.75 0 0 1 0 1.5ZM3 12a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 3 12ZM9 3.75a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5ZM12.75 12a2.25 2.25 0 1 1 4.5 0 2.25 2.25 0 0 1-4.5 0ZM9 15.75a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5Z\"\n\t/>\n</svg>\n","<script lang=\"ts\">\n\texport let className = 'size-4';\n\texport let strokeWidth = '2';\n</script>\n\n<svg\n\txmlns=\"http://www.w3.org/2000/svg\"\n\tfill=\"none\"\n\tviewBox=\"0 0 24 24\"\n\tstroke-width={strokeWidth}\n\tstroke=\"currentColor\"\n\tclass={className}\n>\n\t<path\n\t\tstroke-linecap=\"round\"\n\t\tstroke-linejoin=\"round\"\n\t\td=\"m21 7.5-9-5.25L3 7.5m18 0-9 5.25m9-5.25v9l-9 5.25M3 7.5l9 5.25M3 7.5v9l9 5.25m0-9v9\"\n\t/>\n</svg>\n","<script lang=\"ts\">\n\timport { toast } from 'svelte-sonner';\n\timport { DropdownMenu } from 'bits-ui';\n\timport { getContext } from 'svelte';\n\n\timport fileSaver from 'file-saver';\n\tconst { saveAs } = fileSaver;\n\n\timport { downloadChatAsPDF } from '$lib/apis/utils';\n\timport { copyToClipboard, createMessagesList } from '$lib/utils';\n\n\timport {\n\t\tshowOverview,\n\t\tshowControls,\n\t\tshowArtifacts,\n\t\tmobile,\n\t\ttemporaryChatEnabled\n\t} from '$lib/stores';\n\timport { flyAndScale } from '$lib/utils/transitions';\n\n\timport Dropdown from '$lib/components/common/Dropdown.svelte';\n\timport Tags from '$lib/components/chat/Tags.svelte';\n\timport Map from '$lib/components/icons/Map.svelte';\n\timport Clipboard from '$lib/components/icons/Clipboard.svelte';\n\timport AdjustmentsHorizontal from '$lib/components/icons/AdjustmentsHorizontal.svelte';\n\timport Cube from '$lib/components/icons/Cube.svelte';\n\timport { getChatById } from '$lib/apis/chats';\n\n\tconst i18n = getContext('i18n');\n\n\texport let shareEnabled: boolean = false;\n\texport let shareHandler: Function;\n\texport let downloadHandler: Function;\n\n\t// export let tagHandler: Function;\n\n\texport let chat;\n\texport let onClose: Function = () => {};\n\n\tconst getChatAsText = async () => {\n\t\tconst history = chat.chat.history;\n\t\tconst messages = createMessagesList(history, history.currentId);\n\t\tconst chatText = messages.reduce((a, message, i, arr) => {\n\t\t\treturn `${a}### ${message.role.toUpperCase()}\\n${message.content}\\n\\n`;\n\t\t}, '');\n\n\t\treturn chatText.trim();\n\t};\n\n\tconst downloadTxt = async () => {\n\t\tconst chatText = await getChatAsText();\n\n\t\tlet blob = new Blob([chatText], {\n\t\t\ttype: 'text/plain'\n\t\t});\n\n\t\tsaveAs(blob, `chat-${chat.chat.title}.txt`);\n\t};\n\n\tconst downloadPdf = async () => {\n\t\tconst history = chat.chat.history;\n\t\tconst messages = createMessagesList(history, history.currentId);\n\t\tconst blob = await downloadChatAsPDF(localStorage.token, chat.chat.title, messages);\n\n\t\t// Create a URL for the blob\n\t\tconst url = window.URL.createObjectURL(blob);\n\n\t\t// Create a link element to trigger the download\n\t\tconst a = document.createElement('a');\n\t\ta.href = url;\n\t\ta.download = `chat-${chat.chat.title}.pdf`;\n\n\t\t// Append the link to the body and click it programmatically\n\t\tdocument.body.appendChild(a);\n\t\ta.click();\n\n\t\t// Remove the link from the body\n\t\tdocument.body.removeChild(a);\n\n\t\t// Revoke the URL to release memory\n\t\twindow.URL.revokeObjectURL(url);\n\t};\n\n\tconst downloadJSONExport = async () => {\n\t\tif (chat.id) {\n\t\t\tlet chatObj = null;\n\n\t\t\tif (chat.id === 'local' || $temporaryChatEnabled) {\n\t\t\t\tchatObj = chat;\n\t\t\t} else {\n\t\t\t\tchatObj = await getChatById(localStorage.token, chat.id);\n\t\t\t}\n\n\t\t\tlet blob = new Blob([JSON.stringify([chatObj])], {\n\t\t\t\ttype: 'application/json'\n\t\t\t});\n\t\t\tsaveAs(blob, `chat-export-${Date.now()}.json`);\n\t\t}\n\t};\n</script>\n\n<Dropdown\n\ton:change={(e) => {\n\t\tif (e.detail === false) {\n\t\t\tonClose();\n\t\t}\n\t}}\n>\n\t<slot />\n\n\t<div slot=\"content\">\n\t\t<DropdownMenu.Content\n\t\t\tclass=\"w-full max-w-[200px] rounded-xl px-1 py-1.5  z-50 bg-white dark:bg-gray-850 dark:text-white shadow-lg\"\n\t\t\tsideOffset={8}\n\t\t\tside=\"bottom\"\n\t\t\talign=\"end\"\n\t\t\ttransition={flyAndScale}\n\t\t>\n\t\t\t<!-- <DropdownMenu.Item\n\t\t\t\tclass=\"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer dark:hover:bg-gray-800 rounded-md\"\n\t\t\t\ton:click={async () => {\n\t\t\t\t\tawait showSettings.set(!$showSettings);\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<svg\n\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\tfill=\"none\"\n\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\tstroke-width=\"1.5\"\n\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\tclass=\"size-4\"\n\t\t\t\t>\n\t\t\t\t\t<path\n\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\td=\"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.325.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 0 1 1.37.49l1.296 2.247a1.125 1.125 0 0 1-.26 1.431l-1.003.827c-.293.241-.438.613-.43.992a7.723 7.723 0 0 1 0 .255c-.008.378.137.75.43.991l1.004.827c.424.35.534.955.26 1.43l-1.298 2.247a1.125 1.125 0 0 1-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.47 6.47 0 0 1-.22.128c-.331.183-.581.495-.644.869l-.213 1.281c-.09.543-.56.94-1.11.94h-2.594c-.55 0-1.019-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 0 1-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 0 1-1.369-.49l-1.297-2.247a1.125 1.125 0 0 1 .26-1.431l1.004-.827c.292-.24.437-.613.43-.991a6.932 6.932 0 0 1 0-.255c.007-.38-.138-.751-.43-.992l-1.004-.827a1.125 1.125 0 0 1-.26-1.43l1.297-2.247a1.125 1.125 0 0 1 1.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.086.22-.128.332-.183.582-.495.644-.869l.214-1.28Z\"\n\t\t\t\t\t/>\n\t\t\t\t\t<path\n\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\td=\"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z\"\n\t\t\t\t\t/>\n\t\t\t\t</svg>\n\t\t\t\t<div class=\"flex items-center\">{$i18n.t('Settings')}</div>\n\t\t\t</DropdownMenu.Item> -->\n\n\t\t\t{#if $mobile}\n\t\t\t\t<DropdownMenu.Item\n\t\t\t\t\tclass=\"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md\"\n\t\t\t\t\tid=\"chat-controls-button\"\n\t\t\t\t\ton:click={async () => {\n\t\t\t\t\t\tawait showControls.set(true);\n\t\t\t\t\t\tawait showOverview.set(false);\n\t\t\t\t\t\tawait showArtifacts.set(false);\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<AdjustmentsHorizontal className=\" size-4\" strokeWidth=\"0.5\" />\n\t\t\t\t\t<div class=\"flex items-center\">{$i18n.t('Controls')}</div>\n\t\t\t\t</DropdownMenu.Item>\n\t\t\t{/if}\n\n\t\t\t{#if !$temporaryChatEnabled}\n\t\t\t\t<DropdownMenu.Item\n\t\t\t\t\tclass=\"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md\"\n\t\t\t\t\tid=\"chat-share-button\"\n\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\tshareHandler();\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<svg\n\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\tclass=\"size-4\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<path\n\t\t\t\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\t\t\t\td=\"M15.75 4.5a3 3 0 1 1 .825 2.066l-8.421 4.679a3.002 3.002 0 0 1 0 1.51l8.421 4.679a3 3 0 1 1-.729 1.31l-8.421-4.678a3 3 0 1 1 0-4.132l8.421-4.679a3 3 0 0 1-.096-.755Z\"\n\t\t\t\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</svg>\n\t\t\t\t\t<div class=\"flex items-center\">{$i18n.t('Share')}</div>\n\t\t\t\t</DropdownMenu.Item>\n\t\t\t{/if}\n\n\t\t\t<DropdownMenu.Item\n\t\t\t\tclass=\"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md\"\n\t\t\t\tid=\"chat-overview-button\"\n\t\t\t\ton:click={async () => {\n\t\t\t\t\tawait showControls.set(true);\n\t\t\t\t\tawait showOverview.set(true);\n\t\t\t\t\tawait showArtifacts.set(false);\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<Map className=\" size-4\" strokeWidth=\"1.5\" />\n\t\t\t\t<div class=\"flex items-center\">{$i18n.t('Overview')}</div>\n\t\t\t</DropdownMenu.Item>\n\n\t\t\t<DropdownMenu.Item\n\t\t\t\tclass=\"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md\"\n\t\t\t\tid=\"chat-overview-button\"\n\t\t\t\ton:click={async () => {\n\t\t\t\t\tawait showControls.set(true);\n\t\t\t\t\tawait showArtifacts.set(true);\n\t\t\t\t\tawait showOverview.set(false);\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<Cube className=\" size-4\" strokeWidth=\"1.5\" />\n\t\t\t\t<div class=\"flex items-center\">{$i18n.t('Artifacts')}</div>\n\t\t\t</DropdownMenu.Item>\n\n\t\t\t<DropdownMenu.Sub>\n\t\t\t\t<DropdownMenu.SubTrigger\n\t\t\t\t\tclass=\"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md\"\n\t\t\t\t>\n\t\t\t\t\t<svg\n\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\tstroke-width=\"1.5\"\n\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\tclass=\"size-4\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<path\n\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\td=\"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</svg>\n\n\t\t\t\t\t<div class=\"flex items-center\">{$i18n.t('Download')}</div>\n\t\t\t\t</DropdownMenu.SubTrigger>\n\t\t\t\t<DropdownMenu.SubContent\n\t\t\t\t\tclass=\"w-full rounded-xl px-1 py-1.5 z-50 bg-white dark:bg-gray-850 dark:text-white shadow-lg\"\n\t\t\t\t\ttransition={flyAndScale}\n\t\t\t\t\tsideOffset={8}\n\t\t\t\t>\n\t\t\t\t\t<DropdownMenu.Item\n\t\t\t\t\t\tclass=\"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md\"\n\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\tdownloadJSONExport();\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\"flex items-center line-clamp-1\">{$i18n.t('Export chat (.json)')}</div>\n\t\t\t\t\t</DropdownMenu.Item>\n\t\t\t\t\t<DropdownMenu.Item\n\t\t\t\t\t\tclass=\"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md\"\n\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\tdownloadTxt();\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\"flex items-center line-clamp-1\">{$i18n.t('Plain text (.txt)')}</div>\n\t\t\t\t\t</DropdownMenu.Item>\n\n\t\t\t\t\t<DropdownMenu.Item\n\t\t\t\t\t\tclass=\"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md\"\n\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\tdownloadPdf();\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\"flex items-center line-clamp-1\">{$i18n.t('PDF document (.pdf)')}</div>\n\t\t\t\t\t</DropdownMenu.Item>\n\t\t\t\t</DropdownMenu.SubContent>\n\t\t\t</DropdownMenu.Sub>\n\n\t\t\t<DropdownMenu.Item\n\t\t\t\tclass=\"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md\"\n\t\t\t\tid=\"chat-copy-button\"\n\t\t\t\ton:click={async () => {\n\t\t\t\t\tconst res = await copyToClipboard(await getChatAsText()).catch((e) => {\n\t\t\t\t\t\tconsole.error(e);\n\t\t\t\t\t});\n\n\t\t\t\t\tif (res) {\n\t\t\t\t\t\ttoast.success($i18n.t('Copied to clipboard'));\n\t\t\t\t\t}\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<Clipboard className=\" size-4\" strokeWidth=\"1.5\" />\n\t\t\t\t<div class=\"flex items-center\">{$i18n.t('Copy')}</div>\n\t\t\t</DropdownMenu.Item>\n\n\t\t\t{#if !$temporaryChatEnabled}\n\t\t\t\t<hr class=\"border-gray-100 dark:border-gray-850 my-0.5\" />\n\n\t\t\t\t<div class=\"flex p-1\">\n\t\t\t\t\t<Tags chatId={chat.id} />\n\t\t\t\t</div>\n\t\t\t{/if}\n\t\t</DropdownMenu.Content>\n\t</div>\n</Dropdown>\n","<script lang=\"ts\">\n\timport { getContext } from 'svelte';\n\timport { toast } from 'svelte-sonner';\n\n\timport {\n\t\tWEBUI_NAME,\n\t\tchatId,\n\t\tmobile,\n\t\tsettings,\n\t\tshowArchivedChats,\n\t\tshowControls,\n\t\tshowSidebar,\n\t\ttemporaryChatEnabled,\n\t\tuser\n\t} from '$lib/stores';\n\n\timport { slide } from 'svelte/transition';\n\timport { page } from '$app/stores';\n\n\timport ShareChatModal from '../chat/ShareChatModal.svelte';\n\timport ModelSelector from '../chat/ModelSelector.svelte';\n\timport Tooltip from '../common/Tooltip.svelte';\n\timport Menu from '$lib/components/layout/Navbar/Menu.svelte';\n\timport UserMenu from '$lib/components/layout/Sidebar/UserMenu.svelte';\n\timport MenuLines from '../icons/MenuLines.svelte';\n\timport AdjustmentsHorizontal from '../icons/AdjustmentsHorizontal.svelte';\n\n\timport PencilSquare from '../icons/PencilSquare.svelte';\n\n\tconst i18n = getContext('i18n');\n\n\texport let initNewChat: Function;\n\texport let title: string = $WEBUI_NAME;\n\texport let shareEnabled: boolean = false;\n\n\texport let chat;\n\texport let selectedModels;\n\texport let showModelSelector = true;\n\n\tlet showShareChatModal = false;\n\tlet showDownloadChatModal = false;\n</script>\n\n<ShareChatModal bind:show={showShareChatModal} chatId={$chatId} />\n\n<nav class=\"sticky top-0 z-30 w-full px-1.5 py-1.5 -mb-8 flex items-center drag-region\">\n\t<div\n\t\tclass=\" bg-linear-to-b via-50% from-white via-white to-transparent dark:from-gray-900 dark:via-gray-900 dark:to-transparent pointer-events-none absolute inset-0 -bottom-7 z-[-1]\"\n\t></div>\n\n\t<div class=\" flex max-w-full w-full mx-auto px-1 pt-0.5 bg-transparent\">\n\t\t<div class=\"flex items-center w-full max-w-full\">\n\t\t\t<div\n\t\t\t\tclass=\"{$showSidebar\n\t\t\t\t\t? 'md:hidden'\n\t\t\t\t\t: ''} mr-1 self-start flex flex-none items-center text-gray-600 dark:text-gray-400\"\n\t\t\t>\n\t\t\t\t<button\n\t\t\t\t\tid=\"sidebar-toggle-button\"\n\t\t\t\t\tclass=\"cursor-pointer px-2 py-2 flex rounded-xl hover:bg-gray-50 dark:hover:bg-gray-850 transition\"\n\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\tshowSidebar.set(!$showSidebar);\n\t\t\t\t\t}}\n\t\t\t\t\taria-label=\"Toggle Sidebar\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\" m-auto self-center\">\n\t\t\t\t\t\t<MenuLines />\n\t\t\t\t\t</div>\n\t\t\t\t</button>\n\t\t\t</div>\n\n\t\t\t<div\n\t\t\t\tclass=\"flex-1 overflow-hidden max-w-full py-0.5\n\t\t\t{$showSidebar ? 'ml-1' : ''}\n\t\t\t\"\n\t\t\t>\n\t\t\t\t{#if showModelSelector}\n\t\t\t\t\t<ModelSelector bind:selectedModels showSetDefault={!shareEnabled} />\n\t\t\t\t{/if}\n\t\t\t</div>\n\n\t\t\t<div class=\"self-start flex flex-none items-center text-gray-600 dark:text-gray-400\">\n\t\t\t\t<!-- <div class=\"md:hidden flex self-center w-[1px] h-5 mx-2 bg-gray-300 dark:bg-stone-700\" /> -->\n\t\t\t\t{#if shareEnabled && chat && (chat.id || $temporaryChatEnabled)}\n\t\t\t\t\t<Menu\n\t\t\t\t\t\t{chat}\n\t\t\t\t\t\t{shareEnabled}\n\t\t\t\t\t\tshareHandler={() => {\n\t\t\t\t\t\t\tshowShareChatModal = !showShareChatModal;\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tdownloadHandler={() => {\n\t\t\t\t\t\t\tshowDownloadChatModal = !showDownloadChatModal;\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\"flex cursor-pointer px-2 py-2 rounded-xl hover:bg-gray-50 dark:hover:bg-gray-850 transition\"\n\t\t\t\t\t\t\tid=\"chat-context-menu-button\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div class=\" m-auto self-center\">\n\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\t\t\tstroke-width=\"1.5\"\n\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\t\tclass=\"size-5\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t\t\t\td=\"M6.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM12.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM18.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</Menu>\n\t\t\t\t<!-- {:else if $mobile && ($user.role === 'admin' || $user?.permissions?.chat?.controls)}\n\t\t\t\t\t<Tooltip content={$i18n.t('Controls')}>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\" flex cursor-pointer px-2 py-2 rounded-xl hover:bg-gray-50 dark:hover:bg-gray-850 transition\"\n\t\t\t\t\t\t\ton:click={async () => {\n\t\t\t\t\t\t\t\tawait showControls.set(!$showControls);\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\taria-label=\"Controls\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div class=\" m-auto self-center\">\n\t\t\t\t\t\t\t\t<AdjustmentsHorizontal className=\" size-5\" strokeWidth=\"0.5\" />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</Tooltip> -->\n\t\t\t\t{/if}\n\n\t\t\t\t<!-- {#if !$mobile && ($user.role === 'admin' || $user?.permissions?.chat?.controls)}\n\t\t\t\t\t<Tooltip content={$i18n.t('Controls')}>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\" flex cursor-pointer px-2 py-2 rounded-xl hover:bg-gray-50 dark:hover:bg-gray-850 transition\"\n\t\t\t\t\t\t\ton:click={async () => {\n\t\t\t\t\t\t\t\tawait showControls.set(!$showControls);\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\taria-label=\"Controls\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div class=\" m-auto self-center\">\n\t\t\t\t\t\t\t\t<AdjustmentsHorizontal className=\" size-5\" strokeWidth=\"0.5\" />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</Tooltip>\n\t\t\t\t{/if} -->\n\n\t\t\t\t<Tooltip content={$i18n.t('New Chat')}>\n\t\t\t\t\t<button\n\t\t\t\t\t\tid=\"new-chat-button\"\n\t\t\t\t\t\tclass=\" flex {$showSidebar\n\t\t\t\t\t\t\t? 'md:hidden'\n\t\t\t\t\t\t\t: ''} cursor-pointer px-2 py-2 rounded-xl text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-850 transition\"\n\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\tinitNewChat();\n\t\t\t\t\t\t}}\n\t\t\t\t\t\taria-label=\"New Chat\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\" m-auto self-center\">\n\t\t\t\t\t\t\t<PencilSquare className=\" size-5\" strokeWidth=\"2\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</button>\n\t\t\t\t</Tooltip>\n\n\t\t\t\t{#if $user !== undefined}\n\t\t\t\t\t<UserMenu\n\t\t\t\t\t\tclassName=\"max-w-[200px]\"\n\t\t\t\t\t\trole={$user.role}\n\t\t\t\t\t\ton:show={(e) => {\n\t\t\t\t\t\t\tif (e.detail === 'archived-chat') {\n\t\t\t\t\t\t\t\tshowArchivedChats.set(true);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\"select-none flex rounded-xl p-1.5 w-full hover:bg-gray-50 dark:hover:bg-gray-850 transition\"\n\t\t\t\t\t\t\taria-label=\"User Menu\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div class=\" self-center\">\n\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\tsrc={$user.profile_image_url}\n\t\t\t\t\t\t\t\t\tclass=\"size-6 object-cover rounded-full\"\n\t\t\t\t\t\t\t\t\talt=\"User profile\"\n\t\t\t\t\t\t\t\t\tdraggable=\"false\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</UserMenu>\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</nav>\n","export default function cc(names) {\n  if (typeof names === \"string\" || typeof names === \"number\") return \"\" + names\n\n  let out = \"\"\n\n  if (Array.isArray(names)) {\n    for (let i = 0, tmp; i < names.length; i++) {\n      if ((tmp = cc(names[i])) !== \"\") {\n        out += (out && \" \") + tmp\n      }\n    }\n  } else {\n    for (let k in names) {\n      if (names[k]) out += (out && \" \") + k\n    }\n  }\n\n  return out\n}\n","import { drag } from 'd3-drag';\nimport { select, pointer } from 'd3-selection';\nimport { zoom, zoomIdentity, zoomTransform } from 'd3-zoom';\n\nconst errorMessages = {\n    error001: () => '[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001',\n    error002: () => \"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.\",\n    error003: (nodeType) => `Node type \"${nodeType}\" not found. Using fallback type \"default\".`,\n    error004: () => 'The React Flow parent container needs a width and a height to render the graph.',\n    error005: () => 'Only child nodes can use a parent extent.',\n    error006: () => \"Can't create edge. An edge needs a source and a target.\",\n    error007: (id) => `The old edge with id=${id} does not exist.`,\n    error009: (type) => `Marker type \"${type}\" doesn't exist.`,\n    error008: (handleType, { id, sourceHandle, targetHandle }) => `Couldn't create edge for ${handleType} handle id: \"${handleType === 'source' ? sourceHandle : targetHandle}\", edge id: ${id}.`,\n    error010: () => 'Handle: No node id found. Make sure to only use a Handle inside a custom Node.',\n    error011: (edgeType) => `Edge type \"${edgeType}\" not found. Using fallback type \"default\".`,\n    error012: (id) => `Node with id \"${id}\" does not exist, it may have been removed. This can happen when a node is deleted before the \"onNodeClick\" handler is called.`,\n    error013: (lib = 'react') => `It seems that you haven't loaded the styles. Please import '@xyflow/${lib}/dist/style.css' or base.css to make sure everything is working properly.`,\n    error014: () => 'useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.',\n    error015: () => 'It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs.',\n};\nconst infiniteExtent = [\n    [Number.NEGATIVE_INFINITY, Number.NEGATIVE_INFINITY],\n    [Number.POSITIVE_INFINITY, Number.POSITIVE_INFINITY],\n];\nconst elementSelectionKeys = ['Enter', ' ', 'Escape'];\n\n/**\n * The `ConnectionMode` is used to set the mode of connection between nodes.\n * The `Strict` mode is the default one and only allows source to target edges.\n * `Loose` mode allows source to source and target to target edges as well.\n *\n * @public\n */\nvar ConnectionMode;\n(function (ConnectionMode) {\n    ConnectionMode[\"Strict\"] = \"strict\";\n    ConnectionMode[\"Loose\"] = \"loose\";\n})(ConnectionMode || (ConnectionMode = {}));\n/**\n * This enum is used to set the different modes of panning the viewport when the\n * user scrolls. The `Free` mode allows the user to pan in any direction by scrolling\n * with a device like a trackpad. The `Vertical` and `Horizontal` modes restrict\n * scroll panning to only the vertical or horizontal axis, respectively.\n *\n * @public\n */\nvar PanOnScrollMode;\n(function (PanOnScrollMode) {\n    PanOnScrollMode[\"Free\"] = \"free\";\n    PanOnScrollMode[\"Vertical\"] = \"vertical\";\n    PanOnScrollMode[\"Horizontal\"] = \"horizontal\";\n})(PanOnScrollMode || (PanOnScrollMode = {}));\nvar SelectionMode;\n(function (SelectionMode) {\n    SelectionMode[\"Partial\"] = \"partial\";\n    SelectionMode[\"Full\"] = \"full\";\n})(SelectionMode || (SelectionMode = {}));\nconst initialConnection = {\n    inProgress: false,\n    isValid: null,\n    from: null,\n    fromHandle: null,\n    fromPosition: null,\n    fromNode: null,\n    to: null,\n    toHandle: null,\n    toPosition: null,\n    toNode: null,\n};\n\n/**\n * If you set the `connectionLineType` prop on your [`<ReactFlow />`](/api-reference/react-flow#connection-connectionLineType)\n *component, it will dictate the style of connection line rendered when creating\n *new edges.\n *\n * @public\n *\n * @remarks If you choose to render a custom connection line component, this value will be\n *passed to your component as part of its [`ConnectionLineComponentProps`](/api-reference/types/connection-line-component-props).\n */\nvar ConnectionLineType;\n(function (ConnectionLineType) {\n    ConnectionLineType[\"Bezier\"] = \"default\";\n    ConnectionLineType[\"Straight\"] = \"straight\";\n    ConnectionLineType[\"Step\"] = \"step\";\n    ConnectionLineType[\"SmoothStep\"] = \"smoothstep\";\n    ConnectionLineType[\"SimpleBezier\"] = \"simplebezier\";\n})(ConnectionLineType || (ConnectionLineType = {}));\n/**\n * Edges may optionally have a marker on either end. The MarkerType type enumerates\n * the options available to you when configuring a given marker.\n *\n * @public\n */\nvar MarkerType;\n(function (MarkerType) {\n    MarkerType[\"Arrow\"] = \"arrow\";\n    MarkerType[\"ArrowClosed\"] = \"arrowclosed\";\n})(MarkerType || (MarkerType = {}));\n\n/**\n * While [`PanelPosition`](/api-reference/types/panel-position) can be used to place a\n * component in the corners of a container, the `Position` enum is less precise and used\n * primarily in relation to edges and handles.\n *\n * @public\n */\nvar Position;\n(function (Position) {\n    Position[\"Left\"] = \"left\";\n    Position[\"Top\"] = \"top\";\n    Position[\"Right\"] = \"right\";\n    Position[\"Bottom\"] = \"bottom\";\n})(Position || (Position = {}));\nconst oppositePosition = {\n    [Position.Left]: Position.Right,\n    [Position.Right]: Position.Left,\n    [Position.Top]: Position.Bottom,\n    [Position.Bottom]: Position.Top,\n};\n\n/**\n * @internal\n */\nfunction areConnectionMapsEqual(a, b) {\n    if (!a && !b) {\n        return true;\n    }\n    if (!a || !b || a.size !== b.size) {\n        return false;\n    }\n    if (!a.size && !b.size) {\n        return true;\n    }\n    for (const key of a.keys()) {\n        if (!b.has(key)) {\n            return false;\n        }\n    }\n    return true;\n}\n/**\n * We call the callback for all connections in a that are not in b\n *\n * @internal\n */\nfunction handleConnectionChange(a, b, cb) {\n    if (!cb) {\n        return;\n    }\n    const diff = [];\n    a.forEach((connection, key) => {\n        if (!b?.has(key)) {\n            diff.push(connection);\n        }\n    });\n    if (diff.length) {\n        cb(diff);\n    }\n}\nfunction getConnectionStatus(isValid) {\n    return isValid === null ? null : isValid ? 'valid' : 'invalid';\n}\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\n/**\n * Test whether an object is usable as an Edge\n * @public\n * @remarks In TypeScript this is a type guard that will narrow the type of whatever you pass in to Edge if it returns true\n * @param element - The element to test\n * @returns A boolean indicating whether the element is an Edge\n */\nconst isEdgeBase = (element) => 'id' in element && 'source' in element && 'target' in element;\n/**\n * Test whether an object is usable as a Node\n * @public\n * @remarks In TypeScript this is a type guard that will narrow the type of whatever you pass in to Node if it returns true\n * @param element - The element to test\n * @returns A boolean indicating whether the element is an Node\n */\nconst isNodeBase = (element) => 'id' in element && 'position' in element && !('source' in element) && !('target' in element);\nconst isInternalNodeBase = (element) => 'id' in element && 'internals' in element && !('source' in element) && !('target' in element);\n/**\n * This util is used to tell you what nodes, if any, are connected to the given node\n * as the _target_ of an edge.\n * @public\n * @param node - The node to get the connected nodes from.\n * @param nodes - The array of all nodes.\n * @param edges - The array of all edges.\n * @returns An array of nodes that are connected over edges where the source is the given node.\n *\n * @example\n * ```ts\n *import { getOutgoers } from '@xyflow/react';\n *\n *const nodes = [];\n *const edges = [];\n *\n *const outgoers = getOutgoers(\n *  { id: '1', position: { x: 0, y: 0 }, data: { label: 'node' } },\n *  nodes,\n *  edges,\n *);\n *```\n */\nconst getOutgoers = (node, nodes, edges) => {\n    if (!node.id) {\n        return [];\n    }\n    const outgoerIds = new Set();\n    edges.forEach((edge) => {\n        if (edge.source === node.id) {\n            outgoerIds.add(edge.target);\n        }\n    });\n    return nodes.filter((n) => outgoerIds.has(n.id));\n};\n/**\n * This util is used to tell you what nodes, if any, are connected to the given node\n * as the _source_ of an edge.\n * @public\n * @param node - The node to get the connected nodes from.\n * @param nodes - The array of all nodes.\n * @param edges - The array of all edges.\n * @returns An array of nodes that are connected over edges where the target is the given node.\n *\n * @example\n * ```ts\n *import { getIncomers } from '@xyflow/react';\n *\n *const nodes = [];\n *const edges = [];\n *\n *const incomers = getIncomers(\n *  { id: '1', position: { x: 0, y: 0 }, data: { label: 'node' } },\n *  nodes,\n *  edges,\n *);\n *```\n */\nconst getIncomers = (node, nodes, edges) => {\n    if (!node.id) {\n        return [];\n    }\n    const incomersIds = new Set();\n    edges.forEach((edge) => {\n        if (edge.target === node.id) {\n            incomersIds.add(edge.source);\n        }\n    });\n    return nodes.filter((n) => incomersIds.has(n.id));\n};\nconst getNodePositionWithOrigin = (node, nodeOrigin = [0, 0]) => {\n    const { width, height } = getNodeDimensions(node);\n    const origin = node.origin ?? nodeOrigin;\n    const offsetX = width * origin[0];\n    const offsetY = height * origin[1];\n    return {\n        x: node.position.x - offsetX,\n        y: node.position.y - offsetY,\n    };\n};\n/**\n * Returns the bounding box that contains all the given nodes in an array. This can\n * be useful when combined with [`getViewportForBounds`](/api-reference/utils/get-viewport-for-bounds)\n * to calculate the correct transform to fit the given nodes in a viewport.\n * @public\n * @remarks Useful when combined with {@link getViewportForBounds} to calculate the correct transform to fit the given nodes in a viewport.\n * @param nodes - Nodes to calculate the bounds for.\n * @returns Bounding box enclosing all nodes.\n *\n * @remarks This function was previously called `getRectOfNodes`\n *\n * @example\n * ```js\n *import { getNodesBounds } from '@xyflow/react';\n *\n *const nodes = [\n *  {\n *    id: 'a',\n *    position: { x: 0, y: 0 },\n *    data: { label: 'a' },\n *    width: 50,\n *    height: 25,\n *  },\n *  {\n *    id: 'b',\n *    position: { x: 100, y: 100 },\n *    data: { label: 'b' },\n *    width: 50,\n *    height: 25,\n *  },\n *];\n *\n *const bounds = getNodesBounds(nodes);\n *```\n */\nconst getNodesBounds = (nodes, params = { nodeOrigin: [0, 0] }) => {\n    if (process.env.NODE_ENV === 'development' && !params.nodeLookup) {\n        console.warn('Please use `getNodesBounds` from `useReactFlow`/`useSvelteFlow` hook to ensure correct values for sub flows. If not possible, you have to provide a nodeLookup to support sub flows.');\n    }\n    if (nodes.length === 0) {\n        return { x: 0, y: 0, width: 0, height: 0 };\n    }\n    const box = nodes.reduce((currBox, nodeOrId) => {\n        const isId = typeof nodeOrId === 'string';\n        let currentNode = !params.nodeLookup && !isId ? nodeOrId : undefined;\n        if (params.nodeLookup) {\n            currentNode = isId\n                ? params.nodeLookup.get(nodeOrId)\n                : !isInternalNodeBase(nodeOrId)\n                    ? params.nodeLookup.get(nodeOrId.id)\n                    : nodeOrId;\n        }\n        const nodeBox = currentNode ? nodeToBox(currentNode, params.nodeOrigin) : { x: 0, y: 0, x2: 0, y2: 0 };\n        return getBoundsOfBoxes(currBox, nodeBox);\n    }, { x: Infinity, y: Infinity, x2: -Infinity, y2: -Infinity });\n    return boxToRect(box);\n};\n/**\n * Determines a bounding box that contains all given nodes in an array\n * @internal\n */\nconst getInternalNodesBounds = (nodeLookup, params = {}) => {\n    if (nodeLookup.size === 0) {\n        return { x: 0, y: 0, width: 0, height: 0 };\n    }\n    let box = { x: Infinity, y: Infinity, x2: -Infinity, y2: -Infinity };\n    nodeLookup.forEach((node) => {\n        if (params.filter === undefined || params.filter(node)) {\n            const nodeBox = nodeToBox(node);\n            box = getBoundsOfBoxes(box, nodeBox);\n        }\n    });\n    return boxToRect(box);\n};\nconst getNodesInside = (nodes, rect, [tx, ty, tScale] = [0, 0, 1], partially = false, \n// set excludeNonSelectableNodes if you want to pay attention to the nodes \"selectable\" attribute\nexcludeNonSelectableNodes = false) => {\n    const paneRect = {\n        ...pointToRendererPoint(rect, [tx, ty, tScale]),\n        width: rect.width / tScale,\n        height: rect.height / tScale,\n    };\n    const visibleNodes = [];\n    for (const node of nodes.values()) {\n        const { measured, selectable = true, hidden = false } = node;\n        if ((excludeNonSelectableNodes && !selectable) || hidden) {\n            continue;\n        }\n        const width = measured.width ?? node.width ?? node.initialWidth ?? null;\n        const height = measured.height ?? node.height ?? node.initialHeight ?? null;\n        const overlappingArea = getOverlappingArea(paneRect, nodeToRect(node));\n        const area = (width ?? 0) * (height ?? 0);\n        const partiallyVisible = partially && overlappingArea > 0;\n        const forceInitialRender = !node.internals.handleBounds;\n        const isVisible = forceInitialRender || partiallyVisible || overlappingArea >= area;\n        if (isVisible || node.dragging) {\n            visibleNodes.push(node);\n        }\n    }\n    return visibleNodes;\n};\n/**\n * This utility filters an array of edges, keeping only those where either the source or target\n * node is present in the given array of nodes.\n * @public\n * @param nodes - Nodes you want to get the connected edges for.\n * @param edges - All edges.\n * @returns Array of edges that connect any of the given nodes with each other.\n *\n * @example\n * ```js\n *import { getConnectedEdges } from '@xyflow/react';\n *\n *const nodes = [\n *  { id: 'a', position: { x: 0, y: 0 } },\n *  { id: 'b', position: { x: 100, y: 0 } },\n *];\n *\n *const edges = [\n *  { id: 'a->c', source: 'a', target: 'c' },\n *  { id: 'c->d', source: 'c', target: 'd' },\n *];\n *\n *const connectedEdges = getConnectedEdges(nodes, edges);\n * // => [{ id: 'a->c', source: 'a', target: 'c' }]\n *```\n */\nconst getConnectedEdges = (nodes, edges) => {\n    const nodeIds = new Set();\n    nodes.forEach((node) => {\n        nodeIds.add(node.id);\n    });\n    return edges.filter((edge) => nodeIds.has(edge.source) || nodeIds.has(edge.target));\n};\nfunction getFitViewNodes(nodeLookup, options) {\n    const fitViewNodes = new Map();\n    const optionNodeIds = options?.nodes ? new Set(options.nodes.map((node) => node.id)) : null;\n    nodeLookup.forEach((n) => {\n        const isVisible = n.measured.width && n.measured.height && (options?.includeHiddenNodes || !n.hidden);\n        if (isVisible && (!optionNodeIds || optionNodeIds.has(n.id))) {\n            fitViewNodes.set(n.id, n);\n        }\n    });\n    return fitViewNodes;\n}\nasync function fitViewport({ nodes, width, height, panZoom, minZoom, maxZoom }, options) {\n    if (nodes.size === 0) {\n        return Promise.resolve(true);\n    }\n    const nodesToFit = getFitViewNodes(nodes, options);\n    const bounds = getInternalNodesBounds(nodesToFit);\n    const viewport = getViewportForBounds(bounds, width, height, options?.minZoom ?? minZoom, options?.maxZoom ?? maxZoom, options?.padding ?? 0.1);\n    await panZoom.setViewport(viewport, { duration: options?.duration });\n    return Promise.resolve(true);\n}\n/**\n * This function calculates the next position of a node, taking into account the node's extent, parent node, and origin.\n *\n * @internal\n * @returns position, positionAbsolute\n */\nfunction calculateNodePosition({ nodeId, nextPosition, nodeLookup, nodeOrigin = [0, 0], nodeExtent, onError, }) {\n    const node = nodeLookup.get(nodeId);\n    const parentNode = node.parentId ? nodeLookup.get(node.parentId) : undefined;\n    const { x: parentX, y: parentY } = parentNode ? parentNode.internals.positionAbsolute : { x: 0, y: 0 };\n    const origin = node.origin ?? nodeOrigin;\n    let extent = nodeExtent;\n    if (node.extent === 'parent' && !node.expandParent) {\n        if (!parentNode) {\n            onError?.('005', errorMessages['error005']());\n        }\n        else {\n            const parentWidth = parentNode.measured.width;\n            const parentHeight = parentNode.measured.height;\n            if (parentWidth && parentHeight) {\n                extent = [\n                    [parentX, parentY],\n                    [parentX + parentWidth, parentY + parentHeight],\n                ];\n            }\n        }\n    }\n    else if (parentNode && isCoordinateExtent(node.extent)) {\n        extent = [\n            [node.extent[0][0] + parentX, node.extent[0][1] + parentY],\n            [node.extent[1][0] + parentX, node.extent[1][1] + parentY],\n        ];\n    }\n    const positionAbsolute = isCoordinateExtent(extent)\n        ? clampPosition(nextPosition, extent, node.measured)\n        : nextPosition;\n    if (node.measured.width === undefined || node.measured.height === undefined) {\n        onError?.('015', errorMessages['error015']());\n    }\n    return {\n        position: {\n            x: positionAbsolute.x - parentX + (node.measured.width ?? 0) * origin[0],\n            y: positionAbsolute.y - parentY + (node.measured.height ?? 0) * origin[1],\n        },\n        positionAbsolute,\n    };\n}\n/**\n * Pass in nodes & edges to delete, get arrays of nodes and edges that actually can be deleted\n * @internal\n * @param param.nodesToRemove - The nodes to remove\n * @param param.edgesToRemove - The edges to remove\n * @param param.nodes - All nodes\n * @param param.edges - All edges\n * @param param.onBeforeDelete - Callback to check which nodes and edges can be deleted\n * @returns nodes: nodes that can be deleted, edges: edges that can be deleted\n */\nasync function getElementsToRemove({ nodesToRemove = [], edgesToRemove = [], nodes, edges, onBeforeDelete, }) {\n    const nodeIds = new Set(nodesToRemove.map((node) => node.id));\n    const matchingNodes = [];\n    for (const node of nodes) {\n        if (node.deletable === false) {\n            continue;\n        }\n        const isIncluded = nodeIds.has(node.id);\n        const parentHit = !isIncluded && node.parentId && matchingNodes.find((n) => n.id === node.parentId);\n        if (isIncluded || parentHit) {\n            matchingNodes.push(node);\n        }\n    }\n    const edgeIds = new Set(edgesToRemove.map((edge) => edge.id));\n    const deletableEdges = edges.filter((edge) => edge.deletable !== false);\n    const connectedEdges = getConnectedEdges(matchingNodes, deletableEdges);\n    const matchingEdges = connectedEdges;\n    for (const edge of deletableEdges) {\n        const isIncluded = edgeIds.has(edge.id);\n        if (isIncluded && !matchingEdges.find((e) => e.id === edge.id)) {\n            matchingEdges.push(edge);\n        }\n    }\n    if (!onBeforeDelete) {\n        return {\n            edges: matchingEdges,\n            nodes: matchingNodes,\n        };\n    }\n    const onBeforeDeleteResult = await onBeforeDelete({\n        nodes: matchingNodes,\n        edges: matchingEdges,\n    });\n    if (typeof onBeforeDeleteResult === 'boolean') {\n        return onBeforeDeleteResult ? { edges: matchingEdges, nodes: matchingNodes } : { edges: [], nodes: [] };\n    }\n    return onBeforeDeleteResult;\n}\n\nconst clamp = (val, min = 0, max = 1) => Math.min(Math.max(val, min), max);\nconst clampPosition = (position = { x: 0, y: 0 }, extent, dimensions) => ({\n    x: clamp(position.x, extent[0][0], extent[1][0] - (dimensions?.width ?? 0)),\n    y: clamp(position.y, extent[0][1], extent[1][1] - (dimensions?.height ?? 0)),\n});\nfunction clampPositionToParent(childPosition, childDimensions, parent) {\n    const { width: parentWidth, height: parentHeight } = getNodeDimensions(parent);\n    const { x: parentX, y: parentY } = parent.internals.positionAbsolute;\n    return clampPosition(childPosition, [\n        [parentX, parentY],\n        [parentX + parentWidth, parentY + parentHeight],\n    ], childDimensions);\n}\n/**\n * Calculates the velocity of panning when the mouse is close to the edge of the canvas\n * @internal\n * @param value - One dimensional poition of the mouse (x or y)\n * @param min - Minimal position on canvas before panning starts\n * @param max - Maximal position on canvas before panning starts\n * @returns - A number between 0 and 1 that represents the velocity of panning\n */\nconst calcAutoPanVelocity = (value, min, max) => {\n    if (value < min) {\n        return clamp(Math.abs(value - min), 1, min) / min;\n    }\n    else if (value > max) {\n        return -clamp(Math.abs(value - max), 1, min) / min;\n    }\n    return 0;\n};\nconst calcAutoPan = (pos, bounds, speed = 15, distance = 40) => {\n    const xMovement = calcAutoPanVelocity(pos.x, distance, bounds.width - distance) * speed;\n    const yMovement = calcAutoPanVelocity(pos.y, distance, bounds.height - distance) * speed;\n    return [xMovement, yMovement];\n};\nconst getBoundsOfBoxes = (box1, box2) => ({\n    x: Math.min(box1.x, box2.x),\n    y: Math.min(box1.y, box2.y),\n    x2: Math.max(box1.x2, box2.x2),\n    y2: Math.max(box1.y2, box2.y2),\n});\nconst rectToBox = ({ x, y, width, height }) => ({\n    x,\n    y,\n    x2: x + width,\n    y2: y + height,\n});\nconst boxToRect = ({ x, y, x2, y2 }) => ({\n    x,\n    y,\n    width: x2 - x,\n    height: y2 - y,\n});\nconst nodeToRect = (node, nodeOrigin = [0, 0]) => {\n    const { x, y } = isInternalNodeBase(node)\n        ? node.internals.positionAbsolute\n        : getNodePositionWithOrigin(node, nodeOrigin);\n    return {\n        x,\n        y,\n        width: node.measured?.width ?? node.width ?? node.initialWidth ?? 0,\n        height: node.measured?.height ?? node.height ?? node.initialHeight ?? 0,\n    };\n};\nconst nodeToBox = (node, nodeOrigin = [0, 0]) => {\n    const { x, y } = isInternalNodeBase(node)\n        ? node.internals.positionAbsolute\n        : getNodePositionWithOrigin(node, nodeOrigin);\n    return {\n        x,\n        y,\n        x2: x + (node.measured?.width ?? node.width ?? node.initialWidth ?? 0),\n        y2: y + (node.measured?.height ?? node.height ?? node.initialHeight ?? 0),\n    };\n};\nconst getBoundsOfRects = (rect1, rect2) => boxToRect(getBoundsOfBoxes(rectToBox(rect1), rectToBox(rect2)));\nconst getOverlappingArea = (rectA, rectB) => {\n    const xOverlap = Math.max(0, Math.min(rectA.x + rectA.width, rectB.x + rectB.width) - Math.max(rectA.x, rectB.x));\n    const yOverlap = Math.max(0, Math.min(rectA.y + rectA.height, rectB.y + rectB.height) - Math.max(rectA.y, rectB.y));\n    return Math.ceil(xOverlap * yOverlap);\n};\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nconst isRectObject = (obj) => isNumeric(obj.width) && isNumeric(obj.height) && isNumeric(obj.x) && isNumeric(obj.y);\n/* eslint-disable-next-line @typescript-eslint/no-explicit-any */\nconst isNumeric = (n) => !isNaN(n) && isFinite(n);\n// used for a11y key board controls for nodes and edges\nconst devWarn = (id, message) => {\n    if (process.env.NODE_ENV === 'development') {\n        console.warn(`[React Flow]: ${message} Help: https://reactflow.dev/error#${id}`);\n    }\n};\nconst snapPosition = (position, snapGrid = [1, 1]) => {\n    return {\n        x: snapGrid[0] * Math.round(position.x / snapGrid[0]),\n        y: snapGrid[1] * Math.round(position.y / snapGrid[1]),\n    };\n};\nconst pointToRendererPoint = ({ x, y }, [tx, ty, tScale], snapToGrid = false, snapGrid = [1, 1]) => {\n    const position = {\n        x: (x - tx) / tScale,\n        y: (y - ty) / tScale,\n    };\n    return snapToGrid ? snapPosition(position, snapGrid) : position;\n};\nconst rendererPointToPoint = ({ x, y }, [tx, ty, tScale]) => {\n    return {\n        x: x * tScale + tx,\n        y: y * tScale + ty,\n    };\n};\n/**\n * Parses a single padding value to a number\n * @internal\n * @param padding - Padding to parse\n * @param viewport - Width or height of the viewport\n * @returns The padding in pixels\n */\nfunction parsePadding(padding, viewport) {\n    if (typeof padding === 'number') {\n        return Math.floor((viewport - viewport / (1 + padding)) * 0.5);\n    }\n    if (typeof padding === 'string' && padding.endsWith('px')) {\n        const paddingValue = parseFloat(padding);\n        if (!Number.isNaN(paddingValue)) {\n            return Math.floor(paddingValue);\n        }\n    }\n    if (typeof padding === 'string' && padding.endsWith('%')) {\n        const paddingValue = parseFloat(padding);\n        if (!Number.isNaN(paddingValue)) {\n            return Math.floor(viewport * paddingValue * 0.01);\n        }\n    }\n    console.error(`[React Flow] The padding value \"${padding}\" is invalid. Please provide a number or a string with a valid unit (px or %).`);\n    return 0;\n}\n/**\n * Parses the paddings to an object with top, right, bottom, left, x and y paddings\n * @internal\n * @param padding - Padding to parse\n * @param width - Width of the viewport\n * @param height - Height of the viewport\n * @returns An object with the paddings in pixels\n */\nfunction parsePaddings(padding, width, height) {\n    if (typeof padding === 'string' || typeof padding === 'number') {\n        const paddingY = parsePadding(padding, height);\n        const paddingX = parsePadding(padding, width);\n        return {\n            top: paddingY,\n            right: paddingX,\n            bottom: paddingY,\n            left: paddingX,\n            x: paddingX * 2,\n            y: paddingY * 2,\n        };\n    }\n    if (typeof padding === 'object') {\n        const top = parsePadding(padding.top ?? padding.y ?? 0, height);\n        const bottom = parsePadding(padding.bottom ?? padding.y ?? 0, height);\n        const left = parsePadding(padding.left ?? padding.x ?? 0, width);\n        const right = parsePadding(padding.right ?? padding.x ?? 0, width);\n        return { top, right, bottom, left, x: left + right, y: top + bottom };\n    }\n    return { top: 0, right: 0, bottom: 0, left: 0, x: 0, y: 0 };\n}\n/**\n * Calculates the resulting paddings if the new viewport is applied\n * @internal\n * @param bounds - Bounds to fit inside viewport\n * @param x - X position of the viewport\n * @param y - Y position of the viewport\n * @param zoom - Zoom level of the viewport\n * @param width - Width of the viewport\n * @param height - Height of the viewport\n * @returns An object with the minimum padding required to fit the bounds inside the viewport\n */\nfunction calculateAppliedPaddings(bounds, x, y, zoom, width, height) {\n    const { x: left, y: top } = rendererPointToPoint(bounds, [x, y, zoom]);\n    const { x: boundRight, y: boundBottom } = rendererPointToPoint({ x: bounds.x + bounds.width, y: bounds.y + bounds.height }, [x, y, zoom]);\n    const right = width - boundRight;\n    const bottom = height - boundBottom;\n    return {\n        left: Math.floor(left),\n        top: Math.floor(top),\n        right: Math.floor(right),\n        bottom: Math.floor(bottom),\n    };\n}\n/**\n * Returns a viewport that encloses the given bounds with padding.\n * @public\n * @remarks You can determine bounds of nodes with {@link getNodesBounds} and {@link getBoundsOfRects}\n * @param bounds - Bounds to fit inside viewport.\n * @param width - Width of the viewport.\n * @param height  - Height of the viewport.\n * @param minZoom - Minimum zoom level of the resulting viewport.\n * @param maxZoom - Maximum zoom level of the resulting viewport.\n * @param padding - Padding around the bounds.\n * @returns A transformed {@link Viewport} that encloses the given bounds which you can pass to e.g. {@link setViewport}.\n * @example\n * const { x, y, zoom } = getViewportForBounds(\n * { x: 0, y: 0, width: 100, height: 100},\n * 1200, 800, 0.5, 2);\n */\nconst getViewportForBounds = (bounds, width, height, minZoom, maxZoom, padding) => {\n    // First we resolve all the paddings to actual pixel values\n    const p = parsePaddings(padding, width, height);\n    const xZoom = (width - p.x) / bounds.width;\n    const yZoom = (height - p.y) / bounds.height;\n    // We calculate the new x, y, zoom for a centered view\n    const zoom = Math.min(xZoom, yZoom);\n    const clampedZoom = clamp(zoom, minZoom, maxZoom);\n    const boundsCenterX = bounds.x + bounds.width / 2;\n    const boundsCenterY = bounds.y + bounds.height / 2;\n    const x = width / 2 - boundsCenterX * clampedZoom;\n    const y = height / 2 - boundsCenterY * clampedZoom;\n    // Then we calculate the minimum padding, to respect asymmetric paddings\n    const newPadding = calculateAppliedPaddings(bounds, x, y, clampedZoom, width, height);\n    // We only want to have an offset if the newPadding is smaller than the required padding\n    const offset = {\n        left: Math.min(newPadding.left - p.left, 0),\n        top: Math.min(newPadding.top - p.top, 0),\n        right: Math.min(newPadding.right - p.right, 0),\n        bottom: Math.min(newPadding.bottom - p.bottom, 0),\n    };\n    return {\n        x: x - offset.left + offset.right,\n        y: y - offset.top + offset.bottom,\n        zoom: clampedZoom,\n    };\n};\nconst isMacOs = () => typeof navigator !== 'undefined' && navigator?.userAgent?.indexOf('Mac') >= 0;\nfunction isCoordinateExtent(extent) {\n    return extent !== undefined && extent !== 'parent';\n}\nfunction getNodeDimensions(node) {\n    return {\n        width: node.measured?.width ?? node.width ?? node.initialWidth ?? 0,\n        height: node.measured?.height ?? node.height ?? node.initialHeight ?? 0,\n    };\n}\nfunction nodeHasDimensions(node) {\n    return ((node.measured?.width ?? node.width ?? node.initialWidth) !== undefined &&\n        (node.measured?.height ?? node.height ?? node.initialHeight) !== undefined);\n}\n/**\n * Convert child position to aboslute position\n *\n * @internal\n * @param position\n * @param parentId\n * @param nodeLookup\n * @param nodeOrigin\n * @returns an internal node with an absolute position\n */\nfunction evaluateAbsolutePosition(position, dimensions = { width: 0, height: 0 }, parentId, nodeLookup, nodeOrigin) {\n    const positionAbsolute = { ...position };\n    const parent = nodeLookup.get(parentId);\n    if (parent) {\n        const origin = parent.origin || nodeOrigin;\n        positionAbsolute.x += parent.internals.positionAbsolute.x - (dimensions.width ?? 0) * origin[0];\n        positionAbsolute.y += parent.internals.positionAbsolute.y - (dimensions.height ?? 0) * origin[1];\n    }\n    return positionAbsolute;\n}\nfunction areSetsEqual(a, b) {\n    if (a.size !== b.size) {\n        return false;\n    }\n    for (const item of a) {\n        if (!b.has(item)) {\n            return false;\n        }\n    }\n    return true;\n}\n/**\n * Polyfill for Promise.withResolvers until we can use it in all browsers\n * @internal\n */\nfunction withResolvers() {\n    let resolve;\n    let reject;\n    const promise = new Promise((res, rej) => {\n        resolve = res;\n        reject = rej;\n    });\n    return { promise, resolve, reject };\n}\n\nfunction getPointerPosition(event, { snapGrid = [0, 0], snapToGrid = false, transform, containerBounds }) {\n    const { x, y } = getEventPosition(event);\n    const pointerPos = pointToRendererPoint({ x: x - (containerBounds?.left ?? 0), y: y - (containerBounds?.top ?? 0) }, transform);\n    const { x: xSnapped, y: ySnapped } = snapToGrid ? snapPosition(pointerPos, snapGrid) : pointerPos;\n    // we need the snapped position in order to be able to skip unnecessary drag events\n    return {\n        xSnapped,\n        ySnapped,\n        ...pointerPos,\n    };\n}\nconst getDimensions = (node) => ({\n    width: node.offsetWidth,\n    height: node.offsetHeight,\n});\nconst getHostForElement = (element) => element?.getRootNode?.() || window?.document;\nconst inputTags = ['INPUT', 'SELECT', 'TEXTAREA'];\nfunction isInputDOMNode(event) {\n    // using composed path for handling shadow dom\n    const target = (event.composedPath?.()?.[0] || event.target);\n    if (target?.nodeType !== 1 /* Node.ELEMENT_NODE */)\n        return false;\n    const isInput = inputTags.includes(target.nodeName) || target.hasAttribute('contenteditable');\n    // when an input field is focused we don't want to trigger deletion or movement of nodes\n    return isInput || !!target.closest('.nokey');\n}\nconst isMouseEvent = (event) => 'clientX' in event;\nconst getEventPosition = (event, bounds) => {\n    const isMouse = isMouseEvent(event);\n    const evtX = isMouse ? event.clientX : event.touches?.[0].clientX;\n    const evtY = isMouse ? event.clientY : event.touches?.[0].clientY;\n    return {\n        x: evtX - (bounds?.left ?? 0),\n        y: evtY - (bounds?.top ?? 0),\n    };\n};\n/*\n * The handle bounds are calculated relative to the node element.\n * We store them in the internals object of the node in order to avoid\n * unnecessary recalculations.\n */\nconst getHandleBounds = (type, nodeElement, nodeBounds, zoom, nodeId) => {\n    const handles = nodeElement.querySelectorAll(`.${type}`);\n    if (!handles || !handles.length) {\n        return null;\n    }\n    return Array.from(handles).map((handle) => {\n        const handleBounds = handle.getBoundingClientRect();\n        return {\n            id: handle.getAttribute('data-handleid'),\n            type,\n            nodeId,\n            position: handle.getAttribute('data-handlepos'),\n            x: (handleBounds.left - nodeBounds.left) / zoom,\n            y: (handleBounds.top - nodeBounds.top) / zoom,\n            ...getDimensions(handle),\n        };\n    });\n};\n\nfunction getBezierEdgeCenter({ sourceX, sourceY, targetX, targetY, sourceControlX, sourceControlY, targetControlX, targetControlY, }) {\n    /*\n     * cubic bezier t=0.5 mid point, not the actual mid point, but easy to calculate\n     * https://stackoverflow.com/questions/67516101/how-to-find-distance-mid-point-of-bezier-curve\n     */\n    const centerX = sourceX * 0.125 + sourceControlX * 0.375 + targetControlX * 0.375 + targetX * 0.125;\n    const centerY = sourceY * 0.125 + sourceControlY * 0.375 + targetControlY * 0.375 + targetY * 0.125;\n    const offsetX = Math.abs(centerX - sourceX);\n    const offsetY = Math.abs(centerY - sourceY);\n    return [centerX, centerY, offsetX, offsetY];\n}\nfunction calculateControlOffset(distance, curvature) {\n    if (distance >= 0) {\n        return 0.5 * distance;\n    }\n    return curvature * 25 * Math.sqrt(-distance);\n}\nfunction getControlWithCurvature({ pos, x1, y1, x2, y2, c }) {\n    switch (pos) {\n        case Position.Left:\n            return [x1 - calculateControlOffset(x1 - x2, c), y1];\n        case Position.Right:\n            return [x1 + calculateControlOffset(x2 - x1, c), y1];\n        case Position.Top:\n            return [x1, y1 - calculateControlOffset(y1 - y2, c)];\n        case Position.Bottom:\n            return [x1, y1 + calculateControlOffset(y2 - y1, c)];\n    }\n}\n/**\n * The `getBezierPath` util returns everything you need to render a bezier edge\n *between two nodes.\n * @public\n * @returns A path string you can use in an SVG, the `labelX` and `labelY` position (center of path)\n * and `offsetX`, `offsetY` between source handle and label.\n * - `path`: the path to use in an SVG `<path>` element.\n * - `labelX`: the `x` position you can use to render a label for this edge.\n * - `labelY`: the `y` position you can use to render a label for this edge.\n * - `offsetX`: the absolute difference between the source `x` position and the `x` position of the\n * middle of this path.\n * - `offsetY`: the absolute difference between the source `y` position and the `y` position of the\n * middle of this path.\n * @example\n * ```js\n *  const source = { x: 0, y: 20 };\n *  const target = { x: 150, y: 100 };\n *\n *  const [path, labelX, labelY, offsetX, offsetY] = getBezierPath({\n *    sourceX: source.x,\n *    sourceY: source.y,\n *    sourcePosition: Position.Right,\n *    targetX: target.x,\n *    targetY: target.y,\n *    targetPosition: Position.Left,\n *});\n *```\n *\n * @remarks This function returns a tuple (aka a fixed-size array) to make it easier to\n *work with multiple edge paths at once.\n */\nfunction getBezierPath({ sourceX, sourceY, sourcePosition = Position.Bottom, targetX, targetY, targetPosition = Position.Top, curvature = 0.25, }) {\n    const [sourceControlX, sourceControlY] = getControlWithCurvature({\n        pos: sourcePosition,\n        x1: sourceX,\n        y1: sourceY,\n        x2: targetX,\n        y2: targetY,\n        c: curvature,\n    });\n    const [targetControlX, targetControlY] = getControlWithCurvature({\n        pos: targetPosition,\n        x1: targetX,\n        y1: targetY,\n        x2: sourceX,\n        y2: sourceY,\n        c: curvature,\n    });\n    const [labelX, labelY, offsetX, offsetY] = getBezierEdgeCenter({\n        sourceX,\n        sourceY,\n        targetX,\n        targetY,\n        sourceControlX,\n        sourceControlY,\n        targetControlX,\n        targetControlY,\n    });\n    return [\n        `M${sourceX},${sourceY} C${sourceControlX},${sourceControlY} ${targetControlX},${targetControlY} ${targetX},${targetY}`,\n        labelX,\n        labelY,\n        offsetX,\n        offsetY,\n    ];\n}\n\n// this is used for straight edges and simple smoothstep edges (LTR, RTL, BTT, TTB)\nfunction getEdgeCenter({ sourceX, sourceY, targetX, targetY, }) {\n    const xOffset = Math.abs(targetX - sourceX) / 2;\n    const centerX = targetX < sourceX ? targetX + xOffset : targetX - xOffset;\n    const yOffset = Math.abs(targetY - sourceY) / 2;\n    const centerY = targetY < sourceY ? targetY + yOffset : targetY - yOffset;\n    return [centerX, centerY, xOffset, yOffset];\n}\nfunction getElevatedEdgeZIndex({ sourceNode, targetNode, selected = false, zIndex = 0, elevateOnSelect = false, }) {\n    if (!elevateOnSelect) {\n        return zIndex;\n    }\n    const edgeOrConnectedNodeSelected = selected || targetNode.selected || sourceNode.selected;\n    const selectedZIndex = Math.max(sourceNode.internals.z || 0, targetNode.internals.z || 0, 1000);\n    return zIndex + (edgeOrConnectedNodeSelected ? selectedZIndex : 0);\n}\nfunction isEdgeVisible({ sourceNode, targetNode, width, height, transform }) {\n    const edgeBox = getBoundsOfBoxes(nodeToBox(sourceNode), nodeToBox(targetNode));\n    if (edgeBox.x === edgeBox.x2) {\n        edgeBox.x2 += 1;\n    }\n    if (edgeBox.y === edgeBox.y2) {\n        edgeBox.y2 += 1;\n    }\n    const viewRect = {\n        x: -transform[0] / transform[2],\n        y: -transform[1] / transform[2],\n        width: width / transform[2],\n        height: height / transform[2],\n    };\n    return getOverlappingArea(viewRect, boxToRect(edgeBox)) > 0;\n}\nconst getEdgeId = ({ source, sourceHandle, target, targetHandle }) => `xy-edge__${source}${sourceHandle || ''}-${target}${targetHandle || ''}`;\nconst connectionExists = (edge, edges) => {\n    return edges.some((el) => el.source === edge.source &&\n        el.target === edge.target &&\n        (el.sourceHandle === edge.sourceHandle || (!el.sourceHandle && !edge.sourceHandle)) &&\n        (el.targetHandle === edge.targetHandle || (!el.targetHandle && !edge.targetHandle)));\n};\n/**\n * This util is a convenience function to add a new Edge to an array of edges. It also performs some validation to make sure you don't add an invalid edge or duplicate an existing one.\n * @public\n * @param edgeParams - Either an `Edge` or a `Connection` you want to add.\n * @param edges - The array of all current edges.\n * @returns A new array of edges with the new edge added.\n *\n * @remarks If an edge with the same `target` and `source` already exists (and the same\n *`targetHandle` and `sourceHandle` if those are set), then this util won't add\n *a new edge even if the `id` property is different.\n *\n */\nconst addEdge = (edgeParams, edges) => {\n    if (!edgeParams.source || !edgeParams.target) {\n        devWarn('006', errorMessages['error006']());\n        return edges;\n    }\n    let edge;\n    if (isEdgeBase(edgeParams)) {\n        edge = { ...edgeParams };\n    }\n    else {\n        edge = {\n            ...edgeParams,\n            id: getEdgeId(edgeParams),\n        };\n    }\n    if (connectionExists(edge, edges)) {\n        return edges;\n    }\n    if (edge.sourceHandle === null) {\n        delete edge.sourceHandle;\n    }\n    if (edge.targetHandle === null) {\n        delete edge.targetHandle;\n    }\n    return edges.concat(edge);\n};\n/**\n * A handy utility to update an existing [`Edge`](/api-reference/types/edge) with new properties.\n *This searches your edge array for an edge with a matching `id` and updates its\n *properties with the connection you provide.\n * @public\n * @param oldEdge - The edge you want to update.\n * @param newConnection - The new connection you want to update the edge with.\n * @param edges - The array of all current edges.\n * @returns The updated edges array.\n *\n * @example\n * ```js\n *const onReconnect = useCallback(\n *  (oldEdge: Edge, newConnection: Connection) => setEdges((els) => reconnectEdge(oldEdge, newConnection, els)),[]);\n *```\n */\nconst reconnectEdge = (oldEdge, newConnection, edges, options = { shouldReplaceId: true }) => {\n    const { id: oldEdgeId, ...rest } = oldEdge;\n    if (!newConnection.source || !newConnection.target) {\n        devWarn('006', errorMessages['error006']());\n        return edges;\n    }\n    const foundEdge = edges.find((e) => e.id === oldEdge.id);\n    if (!foundEdge) {\n        devWarn('007', errorMessages['error007'](oldEdgeId));\n        return edges;\n    }\n    // Remove old edge and create the new edge with parameters of old edge.\n    const edge = {\n        ...rest,\n        id: options.shouldReplaceId ? getEdgeId(newConnection) : oldEdgeId,\n        source: newConnection.source,\n        target: newConnection.target,\n        sourceHandle: newConnection.sourceHandle,\n        targetHandle: newConnection.targetHandle,\n    };\n    return edges.filter((e) => e.id !== oldEdgeId).concat(edge);\n};\n\n/**\n * Calculates the straight line path between two points.\n * @public\n * @returns A path string you can use in an SVG, the `labelX` and `labelY` position (center of path)\n * and `offsetX`, `offsetY` between source handle and label.\n *\n * - `path`: the path to use in an SVG `<path>` element.\n * - `labelX`: the `x` position you can use to render a label for this edge.\n * - `labelY`: the `y` position you can use to render a label for this edge.\n * - `offsetX`: the absolute difference between the source `x` position and the `x` position of the\n * middle of this path.\n * - `offsetY`: the absolute difference between the source `y` position and the `y` position of the\n * middle of this path.\n * @example\n * ```js\n *  const source = { x: 0, y: 20 };\n *  const target = { x: 150, y: 100 };\n *\n *  const [path, labelX, labelY, offsetX, offsetY] = getStraightPath({\n *    sourceX: source.x,\n *    sourceY: source.y,\n *    sourcePosition: Position.Right,\n *    targetX: target.x,\n *    targetY: target.y,\n *    targetPosition: Position.Left,\n *  });\n * ```\n * @remarks This function returns a tuple (aka a fixed-size array) to make it easier to work with multiple edge paths at once.\n */\nfunction getStraightPath({ sourceX, sourceY, targetX, targetY, }) {\n    const [labelX, labelY, offsetX, offsetY] = getEdgeCenter({\n        sourceX,\n        sourceY,\n        targetX,\n        targetY,\n    });\n    return [`M ${sourceX},${sourceY}L ${targetX},${targetY}`, labelX, labelY, offsetX, offsetY];\n}\n\nconst handleDirections = {\n    [Position.Left]: { x: -1, y: 0 },\n    [Position.Right]: { x: 1, y: 0 },\n    [Position.Top]: { x: 0, y: -1 },\n    [Position.Bottom]: { x: 0, y: 1 },\n};\nconst getDirection = ({ source, sourcePosition = Position.Bottom, target, }) => {\n    if (sourcePosition === Position.Left || sourcePosition === Position.Right) {\n        return source.x < target.x ? { x: 1, y: 0 } : { x: -1, y: 0 };\n    }\n    return source.y < target.y ? { x: 0, y: 1 } : { x: 0, y: -1 };\n};\nconst distance = (a, b) => Math.sqrt(Math.pow(b.x - a.x, 2) + Math.pow(b.y - a.y, 2));\n/*\n * With this function we try to mimic an orthogonal edge routing behaviour\n * It's not as good as a real orthogonal edge routing, but it's faster and good enough as a default for step and smooth step edges\n */\nfunction getPoints({ source, sourcePosition = Position.Bottom, target, targetPosition = Position.Top, center, offset, }) {\n    const sourceDir = handleDirections[sourcePosition];\n    const targetDir = handleDirections[targetPosition];\n    const sourceGapped = { x: source.x + sourceDir.x * offset, y: source.y + sourceDir.y * offset };\n    const targetGapped = { x: target.x + targetDir.x * offset, y: target.y + targetDir.y * offset };\n    const dir = getDirection({\n        source: sourceGapped,\n        sourcePosition,\n        target: targetGapped,\n    });\n    const dirAccessor = dir.x !== 0 ? 'x' : 'y';\n    const currDir = dir[dirAccessor];\n    let points = [];\n    let centerX, centerY;\n    const sourceGapOffset = { x: 0, y: 0 };\n    const targetGapOffset = { x: 0, y: 0 };\n    const [defaultCenterX, defaultCenterY, defaultOffsetX, defaultOffsetY] = getEdgeCenter({\n        sourceX: source.x,\n        sourceY: source.y,\n        targetX: target.x,\n        targetY: target.y,\n    });\n    // opposite handle positions, default case\n    if (sourceDir[dirAccessor] * targetDir[dirAccessor] === -1) {\n        centerX = center.x ?? defaultCenterX;\n        centerY = center.y ?? defaultCenterY;\n        /*\n         *    --->\n         *    |\n         * >---\n         */\n        const verticalSplit = [\n            { x: centerX, y: sourceGapped.y },\n            { x: centerX, y: targetGapped.y },\n        ];\n        /*\n         *    |\n         *  ---\n         *  |\n         */\n        const horizontalSplit = [\n            { x: sourceGapped.x, y: centerY },\n            { x: targetGapped.x, y: centerY },\n        ];\n        if (sourceDir[dirAccessor] === currDir) {\n            points = dirAccessor === 'x' ? verticalSplit : horizontalSplit;\n        }\n        else {\n            points = dirAccessor === 'x' ? horizontalSplit : verticalSplit;\n        }\n    }\n    else {\n        // sourceTarget means we take x from source and y from target, targetSource is the opposite\n        const sourceTarget = [{ x: sourceGapped.x, y: targetGapped.y }];\n        const targetSource = [{ x: targetGapped.x, y: sourceGapped.y }];\n        // this handles edges with same handle positions\n        if (dirAccessor === 'x') {\n            points = sourceDir.x === currDir ? targetSource : sourceTarget;\n        }\n        else {\n            points = sourceDir.y === currDir ? sourceTarget : targetSource;\n        }\n        if (sourcePosition === targetPosition) {\n            const diff = Math.abs(source[dirAccessor] - target[dirAccessor]);\n            // if an edge goes from right to right for example (sourcePosition === targetPosition) and the distance between source.x and target.x is less than the offset, the added point and the gapped source/target will overlap. This leads to a weird edge path. To avoid this we add a gapOffset to the source/target\n            if (diff <= offset) {\n                const gapOffset = Math.min(offset - 1, offset - diff);\n                if (sourceDir[dirAccessor] === currDir) {\n                    sourceGapOffset[dirAccessor] = (sourceGapped[dirAccessor] > source[dirAccessor] ? -1 : 1) * gapOffset;\n                }\n                else {\n                    targetGapOffset[dirAccessor] = (targetGapped[dirAccessor] > target[dirAccessor] ? -1 : 1) * gapOffset;\n                }\n            }\n        }\n        // these are conditions for handling mixed handle positions like Right -> Bottom for example\n        if (sourcePosition !== targetPosition) {\n            const dirAccessorOpposite = dirAccessor === 'x' ? 'y' : 'x';\n            const isSameDir = sourceDir[dirAccessor] === targetDir[dirAccessorOpposite];\n            const sourceGtTargetOppo = sourceGapped[dirAccessorOpposite] > targetGapped[dirAccessorOpposite];\n            const sourceLtTargetOppo = sourceGapped[dirAccessorOpposite] < targetGapped[dirAccessorOpposite];\n            const flipSourceTarget = (sourceDir[dirAccessor] === 1 && ((!isSameDir && sourceGtTargetOppo) || (isSameDir && sourceLtTargetOppo))) ||\n                (sourceDir[dirAccessor] !== 1 && ((!isSameDir && sourceLtTargetOppo) || (isSameDir && sourceGtTargetOppo)));\n            if (flipSourceTarget) {\n                points = dirAccessor === 'x' ? sourceTarget : targetSource;\n            }\n        }\n        const sourceGapPoint = { x: sourceGapped.x + sourceGapOffset.x, y: sourceGapped.y + sourceGapOffset.y };\n        const targetGapPoint = { x: targetGapped.x + targetGapOffset.x, y: targetGapped.y + targetGapOffset.y };\n        const maxXDistance = Math.max(Math.abs(sourceGapPoint.x - points[0].x), Math.abs(targetGapPoint.x - points[0].x));\n        const maxYDistance = Math.max(Math.abs(sourceGapPoint.y - points[0].y), Math.abs(targetGapPoint.y - points[0].y));\n        // we want to place the label on the longest segment of the edge\n        if (maxXDistance >= maxYDistance) {\n            centerX = (sourceGapPoint.x + targetGapPoint.x) / 2;\n            centerY = points[0].y;\n        }\n        else {\n            centerX = points[0].x;\n            centerY = (sourceGapPoint.y + targetGapPoint.y) / 2;\n        }\n    }\n    const pathPoints = [\n        source,\n        { x: sourceGapped.x + sourceGapOffset.x, y: sourceGapped.y + sourceGapOffset.y },\n        ...points,\n        { x: targetGapped.x + targetGapOffset.x, y: targetGapped.y + targetGapOffset.y },\n        target,\n    ];\n    return [pathPoints, centerX, centerY, defaultOffsetX, defaultOffsetY];\n}\nfunction getBend(a, b, c, size) {\n    const bendSize = Math.min(distance(a, b) / 2, distance(b, c) / 2, size);\n    const { x, y } = b;\n    // no bend\n    if ((a.x === x && x === c.x) || (a.y === y && y === c.y)) {\n        return `L${x} ${y}`;\n    }\n    // first segment is horizontal\n    if (a.y === y) {\n        const xDir = a.x < c.x ? -1 : 1;\n        const yDir = a.y < c.y ? 1 : -1;\n        return `L ${x + bendSize * xDir},${y}Q ${x},${y} ${x},${y + bendSize * yDir}`;\n    }\n    const xDir = a.x < c.x ? 1 : -1;\n    const yDir = a.y < c.y ? -1 : 1;\n    return `L ${x},${y + bendSize * yDir}Q ${x},${y} ${x + bendSize * xDir},${y}`;\n}\n/**\n * The `getSmoothStepPath` util returns everything you need to render a stepped path\n * between two nodes. The `borderRadius` property can be used to choose how rounded\n * the corners of those steps are.\n * @public\n * @returns A path string you can use in an SVG, the `labelX` and `labelY` position (center of path)\n * and `offsetX`, `offsetY` between source handle and label.\n *\n * - `path`: the path to use in an SVG `<path>` element.\n * - `labelX`: the `x` position you can use to render a label for this edge.\n * - `labelY`: the `y` position you can use to render a label for this edge.\n * - `offsetX`: the absolute difference between the source `x` position and the `x` position of the\n * middle of this path.\n * - `offsetY`: the absolute difference between the source `y` position and the `y` position of the\n * middle of this path.\n * @example\n * ```js\n *  const source = { x: 0, y: 20 };\n *  const target = { x: 150, y: 100 };\n *\n *  const [path, labelX, labelY, offsetX, offsetY] = getSmoothStepPath({\n *    sourceX: source.x,\n *    sourceY: source.y,\n *    sourcePosition: Position.Right,\n *    targetX: target.x,\n *    targetY: target.y,\n *    targetPosition: Position.Left,\n *  });\n * ```\n * @remarks This function returns a tuple (aka a fixed-size array) to make it easier to work with multiple edge paths at once.\n */\nfunction getSmoothStepPath({ sourceX, sourceY, sourcePosition = Position.Bottom, targetX, targetY, targetPosition = Position.Top, borderRadius = 5, centerX, centerY, offset = 20, }) {\n    const [points, labelX, labelY, offsetX, offsetY] = getPoints({\n        source: { x: sourceX, y: sourceY },\n        sourcePosition,\n        target: { x: targetX, y: targetY },\n        targetPosition,\n        center: { x: centerX, y: centerY },\n        offset,\n    });\n    const path = points.reduce((res, p, i) => {\n        let segment = '';\n        if (i > 0 && i < points.length - 1) {\n            segment = getBend(points[i - 1], p, points[i + 1], borderRadius);\n        }\n        else {\n            segment = `${i === 0 ? 'M' : 'L'}${p.x} ${p.y}`;\n        }\n        res += segment;\n        return res;\n    }, '');\n    return [path, labelX, labelY, offsetX, offsetY];\n}\n\nfunction isNodeInitialized(node) {\n    return (node &&\n        !!(node.internals.handleBounds || node.handles?.length) &&\n        !!(node.measured.width || node.width || node.initialWidth));\n}\nfunction getEdgePosition(params) {\n    const { sourceNode, targetNode } = params;\n    if (!isNodeInitialized(sourceNode) || !isNodeInitialized(targetNode)) {\n        return null;\n    }\n    const sourceHandleBounds = sourceNode.internals.handleBounds || toHandleBounds(sourceNode.handles);\n    const targetHandleBounds = targetNode.internals.handleBounds || toHandleBounds(targetNode.handles);\n    const sourceHandle = getHandle$1(sourceHandleBounds?.source ?? [], params.sourceHandle);\n    const targetHandle = getHandle$1(\n    // when connection type is loose we can define all handles as sources and connect source -> source\n    params.connectionMode === ConnectionMode.Strict\n        ? targetHandleBounds?.target ?? []\n        : (targetHandleBounds?.target ?? []).concat(targetHandleBounds?.source ?? []), params.targetHandle);\n    if (!sourceHandle || !targetHandle) {\n        params.onError?.('008', errorMessages['error008'](!sourceHandle ? 'source' : 'target', {\n            id: params.id,\n            sourceHandle: params.sourceHandle,\n            targetHandle: params.targetHandle,\n        }));\n        return null;\n    }\n    const sourcePosition = sourceHandle?.position || Position.Bottom;\n    const targetPosition = targetHandle?.position || Position.Top;\n    const source = getHandlePosition(sourceNode, sourceHandle, sourcePosition);\n    const target = getHandlePosition(targetNode, targetHandle, targetPosition);\n    return {\n        sourceX: source.x,\n        sourceY: source.y,\n        targetX: target.x,\n        targetY: target.y,\n        sourcePosition,\n        targetPosition,\n    };\n}\nfunction toHandleBounds(handles) {\n    if (!handles) {\n        return null;\n    }\n    const source = [];\n    const target = [];\n    for (const handle of handles) {\n        handle.width = handle.width ?? 1;\n        handle.height = handle.height ?? 1;\n        if (handle.type === 'source') {\n            source.push(handle);\n        }\n        else if (handle.type === 'target') {\n            target.push(handle);\n        }\n    }\n    return {\n        source,\n        target,\n    };\n}\nfunction getHandlePosition(node, handle, fallbackPosition = Position.Left, center = false) {\n    const x = (handle?.x ?? 0) + node.internals.positionAbsolute.x;\n    const y = (handle?.y ?? 0) + node.internals.positionAbsolute.y;\n    const { width, height } = handle ?? getNodeDimensions(node);\n    if (center) {\n        return { x: x + width / 2, y: y + height / 2 };\n    }\n    const position = handle?.position ?? fallbackPosition;\n    switch (position) {\n        case Position.Top:\n            return { x: x + width / 2, y };\n        case Position.Right:\n            return { x: x + width, y: y + height / 2 };\n        case Position.Bottom:\n            return { x: x + width / 2, y: y + height };\n        case Position.Left:\n            return { x, y: y + height / 2 };\n    }\n}\nfunction getHandle$1(bounds, handleId) {\n    if (!bounds) {\n        return null;\n    }\n    // if no handleId is given, we use the first handle, otherwise we check for the id\n    return (!handleId ? bounds[0] : bounds.find((d) => d.id === handleId)) || null;\n}\n\nfunction getMarkerId(marker, id) {\n    if (!marker) {\n        return '';\n    }\n    if (typeof marker === 'string') {\n        return marker;\n    }\n    const idPrefix = id ? `${id}__` : '';\n    return `${idPrefix}${Object.keys(marker)\n        .sort()\n        .map((key) => `${key}=${marker[key]}`)\n        .join('&')}`;\n}\nfunction createMarkerIds(edges, { id, defaultColor, defaultMarkerStart, defaultMarkerEnd, }) {\n    const ids = new Set();\n    return edges\n        .reduce((markers, edge) => {\n        [edge.markerStart || defaultMarkerStart, edge.markerEnd || defaultMarkerEnd].forEach((marker) => {\n            if (marker && typeof marker === 'object') {\n                const markerId = getMarkerId(marker, id);\n                if (!ids.has(markerId)) {\n                    markers.push({ id: markerId, color: marker.color || defaultColor, ...marker });\n                    ids.add(markerId);\n                }\n            }\n        });\n        return markers;\n    }, [])\n        .sort((a, b) => a.id.localeCompare(b.id));\n}\n\nfunction getNodeToolbarTransform(nodeRect, viewport, position, offset, align) {\n    let alignmentOffset = 0.5;\n    if (align === 'start') {\n        alignmentOffset = 0;\n    }\n    else if (align === 'end') {\n        alignmentOffset = 1;\n    }\n    /*\n     * position === Position.Top\n     * we set the x any y position of the toolbar based on the nodes position\n     */\n    let pos = [\n        (nodeRect.x + nodeRect.width * alignmentOffset) * viewport.zoom + viewport.x,\n        nodeRect.y * viewport.zoom + viewport.y - offset,\n    ];\n    // and than shift it based on the alignment. The shift values are in %.\n    let shift = [-100 * alignmentOffset, -100];\n    switch (position) {\n        case Position.Right:\n            pos = [\n                (nodeRect.x + nodeRect.width) * viewport.zoom + viewport.x + offset,\n                (nodeRect.y + nodeRect.height * alignmentOffset) * viewport.zoom + viewport.y,\n            ];\n            shift = [0, -100 * alignmentOffset];\n            break;\n        case Position.Bottom:\n            pos[1] = (nodeRect.y + nodeRect.height) * viewport.zoom + viewport.y + offset;\n            shift[1] = 0;\n            break;\n        case Position.Left:\n            pos = [\n                nodeRect.x * viewport.zoom + viewport.x - offset,\n                (nodeRect.y + nodeRect.height * alignmentOffset) * viewport.zoom + viewport.y,\n            ];\n            shift = [-100, -100 * alignmentOffset];\n            break;\n    }\n    return `translate(${pos[0]}px, ${pos[1]}px) translate(${shift[0]}%, ${shift[1]}%)`;\n}\n\nconst defaultOptions = {\n    nodeOrigin: [0, 0],\n    nodeExtent: infiniteExtent,\n    elevateNodesOnSelect: true,\n    defaults: {},\n};\nconst adoptUserNodesDefaultOptions = {\n    ...defaultOptions,\n    checkEquality: true,\n};\nfunction mergeObjects(base, incoming) {\n    const result = { ...base };\n    for (const key in incoming) {\n        if (incoming[key] !== undefined) {\n            // typecast is safe here, because we check for undefined\n            result[key] = incoming[key];\n        }\n    }\n    return result;\n}\nfunction updateAbsolutePositions(nodeLookup, parentLookup, options) {\n    const _options = mergeObjects(defaultOptions, options);\n    for (const node of nodeLookup.values()) {\n        if (node.parentId) {\n            updateChildNode(node, nodeLookup, parentLookup, _options);\n        }\n        else {\n            const positionWithOrigin = getNodePositionWithOrigin(node, _options.nodeOrigin);\n            const extent = isCoordinateExtent(node.extent) ? node.extent : _options.nodeExtent;\n            const clampedPosition = clampPosition(positionWithOrigin, extent, getNodeDimensions(node));\n            node.internals.positionAbsolute = clampedPosition;\n        }\n    }\n}\nfunction adoptUserNodes(nodes, nodeLookup, parentLookup, options) {\n    const _options = mergeObjects(adoptUserNodesDefaultOptions, options);\n    let nodesInitialized = nodes.length > 0;\n    const tmpLookup = new Map(nodeLookup);\n    const selectedNodeZ = _options?.elevateNodesOnSelect ? 1000 : 0;\n    nodeLookup.clear();\n    parentLookup.clear();\n    for (const userNode of nodes) {\n        let internalNode = tmpLookup.get(userNode.id);\n        if (_options.checkEquality && userNode === internalNode?.internals.userNode) {\n            nodeLookup.set(userNode.id, internalNode);\n        }\n        else {\n            const positionWithOrigin = getNodePositionWithOrigin(userNode, _options.nodeOrigin);\n            const extent = isCoordinateExtent(userNode.extent) ? userNode.extent : _options.nodeExtent;\n            const clampedPosition = clampPosition(positionWithOrigin, extent, getNodeDimensions(userNode));\n            internalNode = {\n                ..._options.defaults,\n                ...userNode,\n                measured: {\n                    width: userNode.measured?.width,\n                    height: userNode.measured?.height,\n                },\n                internals: {\n                    positionAbsolute: clampedPosition,\n                    // if user re-initializes the node or removes `measured` for whatever reason, we reset the handleBounds so that the node gets re-measured\n                    handleBounds: !userNode.measured ? undefined : internalNode?.internals.handleBounds,\n                    z: calculateZ(userNode, selectedNodeZ),\n                    userNode,\n                },\n            };\n            nodeLookup.set(userNode.id, internalNode);\n        }\n        if ((internalNode.measured === undefined ||\n            internalNode.measured.width === undefined ||\n            internalNode.measured.height === undefined) &&\n            !internalNode.hidden) {\n            nodesInitialized = false;\n        }\n        if (userNode.parentId) {\n            updateChildNode(internalNode, nodeLookup, parentLookup, options);\n        }\n    }\n    return nodesInitialized;\n}\nfunction updateParentLookup(node, parentLookup) {\n    if (!node.parentId) {\n        return;\n    }\n    const childNodes = parentLookup.get(node.parentId);\n    if (childNodes) {\n        childNodes.set(node.id, node);\n    }\n    else {\n        parentLookup.set(node.parentId, new Map([[node.id, node]]));\n    }\n}\n/**\n * Updates positionAbsolute and zIndex of a child node and the parentLookup.\n */\nfunction updateChildNode(node, nodeLookup, parentLookup, options) {\n    const { elevateNodesOnSelect, nodeOrigin, nodeExtent } = mergeObjects(defaultOptions, options);\n    const parentId = node.parentId;\n    const parentNode = nodeLookup.get(parentId);\n    if (!parentNode) {\n        console.warn(`Parent node ${parentId} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);\n        return;\n    }\n    updateParentLookup(node, parentLookup);\n    const selectedNodeZ = elevateNodesOnSelect ? 1000 : 0;\n    const { x, y, z } = calculateChildXYZ(node, parentNode, nodeOrigin, nodeExtent, selectedNodeZ);\n    const { positionAbsolute } = node.internals;\n    const positionChanged = x !== positionAbsolute.x || y !== positionAbsolute.y;\n    if (positionChanged || z !== node.internals.z) {\n        // we create a new object to mark the node as updated\n        nodeLookup.set(node.id, {\n            ...node,\n            internals: {\n                ...node.internals,\n                positionAbsolute: positionChanged ? { x, y } : positionAbsolute,\n                z,\n            },\n        });\n    }\n}\nfunction calculateZ(node, selectedNodeZ) {\n    return (isNumeric(node.zIndex) ? node.zIndex : 0) + (node.selected ? selectedNodeZ : 0);\n}\nfunction calculateChildXYZ(childNode, parentNode, nodeOrigin, nodeExtent, selectedNodeZ) {\n    const { x: parentX, y: parentY } = parentNode.internals.positionAbsolute;\n    const childDimensions = getNodeDimensions(childNode);\n    const positionWithOrigin = getNodePositionWithOrigin(childNode, nodeOrigin);\n    const clampedPosition = isCoordinateExtent(childNode.extent)\n        ? clampPosition(positionWithOrigin, childNode.extent, childDimensions)\n        : positionWithOrigin;\n    let absolutePosition = clampPosition({ x: parentX + clampedPosition.x, y: parentY + clampedPosition.y }, nodeExtent, childDimensions);\n    if (childNode.extent === 'parent') {\n        absolutePosition = clampPositionToParent(absolutePosition, childDimensions, parentNode);\n    }\n    const childZ = calculateZ(childNode, selectedNodeZ);\n    const parentZ = parentNode.internals.z ?? 0;\n    return {\n        x: absolutePosition.x,\n        y: absolutePosition.y,\n        z: parentZ > childZ ? parentZ : childZ,\n    };\n}\nfunction handleExpandParent(children, nodeLookup, parentLookup, nodeOrigin = [0, 0]) {\n    const changes = [];\n    const parentExpansions = new Map();\n    // determine the expanded rectangle the child nodes would take for each parent\n    for (const child of children) {\n        const parent = nodeLookup.get(child.parentId);\n        if (!parent) {\n            continue;\n        }\n        const parentRect = parentExpansions.get(child.parentId)?.expandedRect ?? nodeToRect(parent);\n        const expandedRect = getBoundsOfRects(parentRect, child.rect);\n        parentExpansions.set(child.parentId, { expandedRect, parent });\n    }\n    if (parentExpansions.size > 0) {\n        parentExpansions.forEach(({ expandedRect, parent }, parentId) => {\n            // determine the position & dimensions of the parent\n            const positionAbsolute = parent.internals.positionAbsolute;\n            const dimensions = getNodeDimensions(parent);\n            const origin = parent.origin ?? nodeOrigin;\n            // determine how much the parent expands in width and position\n            const xChange = expandedRect.x < positionAbsolute.x ? Math.round(Math.abs(positionAbsolute.x - expandedRect.x)) : 0;\n            const yChange = expandedRect.y < positionAbsolute.y ? Math.round(Math.abs(positionAbsolute.y - expandedRect.y)) : 0;\n            const newWidth = Math.max(dimensions.width, Math.round(expandedRect.width));\n            const newHeight = Math.max(dimensions.height, Math.round(expandedRect.height));\n            const widthChange = (newWidth - dimensions.width) * origin[0];\n            const heightChange = (newHeight - dimensions.height) * origin[1];\n            // We need to correct the position of the parent node if the origin is not [0,0]\n            if (xChange > 0 || yChange > 0 || widthChange || heightChange) {\n                changes.push({\n                    id: parentId,\n                    type: 'position',\n                    position: {\n                        x: parent.position.x - xChange + widthChange,\n                        y: parent.position.y - yChange + heightChange,\n                    },\n                });\n                /*\n                 * We move all child nodes in the oppsite direction\n                 * so the x,y changes of the parent do not move the children\n                 */\n                parentLookup.get(parentId)?.forEach((childNode) => {\n                    if (!children.some((child) => child.id === childNode.id)) {\n                        changes.push({\n                            id: childNode.id,\n                            type: 'position',\n                            position: {\n                                x: childNode.position.x + xChange,\n                                y: childNode.position.y + yChange,\n                            },\n                        });\n                    }\n                });\n            }\n            // We need to correct the dimensions of the parent node if the origin is not [0,0]\n            if (dimensions.width < expandedRect.width || dimensions.height < expandedRect.height || xChange || yChange) {\n                changes.push({\n                    id: parentId,\n                    type: 'dimensions',\n                    setAttributes: true,\n                    dimensions: {\n                        width: newWidth + (xChange ? origin[0] * xChange - widthChange : 0),\n                        height: newHeight + (yChange ? origin[1] * yChange - heightChange : 0),\n                    },\n                });\n            }\n        });\n    }\n    return changes;\n}\nfunction updateNodeInternals(updates, nodeLookup, parentLookup, domNode, nodeOrigin, nodeExtent) {\n    const viewportNode = domNode?.querySelector('.xyflow__viewport');\n    let updatedInternals = false;\n    if (!viewportNode) {\n        return { changes: [], updatedInternals };\n    }\n    const changes = [];\n    const style = window.getComputedStyle(viewportNode);\n    const { m22: zoom } = new window.DOMMatrixReadOnly(style.transform);\n    // in this array we collect nodes, that might trigger changes (like expanding parent)\n    const parentExpandChildren = [];\n    for (const update of updates.values()) {\n        const node = nodeLookup.get(update.id);\n        if (!node) {\n            continue;\n        }\n        if (node.hidden) {\n            nodeLookup.set(node.id, {\n                ...node,\n                internals: {\n                    ...node.internals,\n                    handleBounds: undefined,\n                },\n            });\n            updatedInternals = true;\n            continue;\n        }\n        const dimensions = getDimensions(update.nodeElement);\n        const dimensionChanged = node.measured.width !== dimensions.width || node.measured.height !== dimensions.height;\n        const doUpdate = !!(dimensions.width &&\n            dimensions.height &&\n            (dimensionChanged || !node.internals.handleBounds || update.force));\n        if (doUpdate) {\n            const nodeBounds = update.nodeElement.getBoundingClientRect();\n            const extent = isCoordinateExtent(node.extent) ? node.extent : nodeExtent;\n            let { positionAbsolute } = node.internals;\n            if (node.parentId && node.extent === 'parent') {\n                positionAbsolute = clampPositionToParent(positionAbsolute, dimensions, nodeLookup.get(node.parentId));\n            }\n            else if (extent) {\n                positionAbsolute = clampPosition(positionAbsolute, extent, dimensions);\n            }\n            const newNode = {\n                ...node,\n                measured: dimensions,\n                internals: {\n                    ...node.internals,\n                    positionAbsolute,\n                    handleBounds: {\n                        source: getHandleBounds('source', update.nodeElement, nodeBounds, zoom, node.id),\n                        target: getHandleBounds('target', update.nodeElement, nodeBounds, zoom, node.id),\n                    },\n                },\n            };\n            nodeLookup.set(node.id, newNode);\n            if (node.parentId) {\n                updateChildNode(newNode, nodeLookup, parentLookup, { nodeOrigin });\n            }\n            updatedInternals = true;\n            if (dimensionChanged) {\n                changes.push({\n                    id: node.id,\n                    type: 'dimensions',\n                    dimensions,\n                });\n                if (node.expandParent && node.parentId) {\n                    parentExpandChildren.push({\n                        id: node.id,\n                        parentId: node.parentId,\n                        rect: nodeToRect(newNode, nodeOrigin),\n                    });\n                }\n            }\n        }\n    }\n    if (parentExpandChildren.length > 0) {\n        const parentExpandChanges = handleExpandParent(parentExpandChildren, nodeLookup, parentLookup, nodeOrigin);\n        changes.push(...parentExpandChanges);\n    }\n    return { changes, updatedInternals };\n}\nasync function panBy({ delta, panZoom, transform, translateExtent, width, height, }) {\n    if (!panZoom || (!delta.x && !delta.y)) {\n        return Promise.resolve(false);\n    }\n    const nextViewport = await panZoom.setViewportConstrained({\n        x: transform[0] + delta.x,\n        y: transform[1] + delta.y,\n        zoom: transform[2],\n    }, [\n        [0, 0],\n        [width, height],\n    ], translateExtent);\n    const transformChanged = !!nextViewport &&\n        (nextViewport.x !== transform[0] || nextViewport.y !== transform[1] || nextViewport.k !== transform[2]);\n    return Promise.resolve(transformChanged);\n}\n/**\n * this function adds the connection to the connectionLookup\n * at the following keys: nodeId-type-handleId, nodeId-type and nodeId\n * @param type type of the connection\n * @param connection connection that should be added to the lookup\n * @param connectionKey at which key the connection should be added\n * @param connectionLookup reference to the connection lookup\n * @param nodeId nodeId of the connection\n * @param handleId handleId of the conneciton\n */\nfunction addConnectionToLookup(type, connection, connectionKey, connectionLookup, nodeId, handleId) {\n    /*\n     * We add the connection to the connectionLookup at the following keys\n     * 1. nodeId, 2. nodeId-type, 3. nodeId-type-handleId\n     * If the key already exists, we add the connection to the existing map\n     */\n    let key = nodeId;\n    const nodeMap = connectionLookup.get(key) || new Map();\n    connectionLookup.set(key, nodeMap.set(connectionKey, connection));\n    key = `${nodeId}-${type}`;\n    const typeMap = connectionLookup.get(key) || new Map();\n    connectionLookup.set(key, typeMap.set(connectionKey, connection));\n    if (handleId) {\n        key = `${nodeId}-${type}-${handleId}`;\n        const handleMap = connectionLookup.get(key) || new Map();\n        connectionLookup.set(key, handleMap.set(connectionKey, connection));\n    }\n}\nfunction updateConnectionLookup(connectionLookup, edgeLookup, edges) {\n    connectionLookup.clear();\n    edgeLookup.clear();\n    for (const edge of edges) {\n        const { source: sourceNode, target: targetNode, sourceHandle = null, targetHandle = null } = edge;\n        const connection = { edgeId: edge.id, source: sourceNode, target: targetNode, sourceHandle, targetHandle };\n        const sourceKey = `${sourceNode}-${sourceHandle}--${targetNode}-${targetHandle}`;\n        const targetKey = `${targetNode}-${targetHandle}--${sourceNode}-${sourceHandle}`;\n        addConnectionToLookup('source', connection, targetKey, connectionLookup, sourceNode, sourceHandle);\n        addConnectionToLookup('target', connection, sourceKey, connectionLookup, targetNode, targetHandle);\n        edgeLookup.set(edge.id, edge);\n    }\n}\n\nfunction shallowNodeData(a, b) {\n    if (a === null || b === null) {\n        return false;\n    }\n    const _a = Array.isArray(a) ? a : [a];\n    const _b = Array.isArray(b) ? b : [b];\n    if (_a.length !== _b.length) {\n        return false;\n    }\n    for (let i = 0; i < _a.length; i++) {\n        if (_a[i].id !== _b[i].id || _a[i].type !== _b[i].type || !Object.is(_a[i].data, _b[i].data)) {\n            return false;\n        }\n    }\n    return true;\n}\n\nfunction isParentSelected(node, nodeLookup) {\n    if (!node.parentId) {\n        return false;\n    }\n    const parentNode = nodeLookup.get(node.parentId);\n    if (!parentNode) {\n        return false;\n    }\n    if (parentNode.selected) {\n        return true;\n    }\n    return isParentSelected(parentNode, nodeLookup);\n}\nfunction hasSelector(target, selector, domNode) {\n    let current = target;\n    do {\n        if (current?.matches?.(selector))\n            return true;\n        if (current === domNode)\n            return false;\n        current = current?.parentElement;\n    } while (current);\n    return false;\n}\n// looks for all selected nodes and created a NodeDragItem for each of them\nfunction getDragItems(nodeLookup, nodesDraggable, mousePos, nodeId) {\n    const dragItems = new Map();\n    for (const [id, node] of nodeLookup) {\n        if ((node.selected || node.id === nodeId) &&\n            (!node.parentId || !isParentSelected(node, nodeLookup)) &&\n            (node.draggable || (nodesDraggable && typeof node.draggable === 'undefined'))) {\n            const internalNode = nodeLookup.get(id);\n            if (internalNode) {\n                dragItems.set(id, {\n                    id,\n                    position: internalNode.position || { x: 0, y: 0 },\n                    distance: {\n                        x: mousePos.x - internalNode.internals.positionAbsolute.x,\n                        y: mousePos.y - internalNode.internals.positionAbsolute.y,\n                    },\n                    extent: internalNode.extent,\n                    parentId: internalNode.parentId,\n                    origin: internalNode.origin,\n                    expandParent: internalNode.expandParent,\n                    internals: {\n                        positionAbsolute: internalNode.internals.positionAbsolute || { x: 0, y: 0 },\n                    },\n                    measured: {\n                        width: internalNode.measured.width ?? 0,\n                        height: internalNode.measured.height ?? 0,\n                    },\n                });\n            }\n        }\n    }\n    return dragItems;\n}\n/*\n * returns two params:\n * 1. the dragged node (or the first of the list, if we are dragging a node selection)\n * 2. array of selected nodes (for multi selections)\n */\nfunction getEventHandlerParams({ nodeId, dragItems, nodeLookup, dragging = true, }) {\n    const nodesFromDragItems = [];\n    for (const [id, dragItem] of dragItems) {\n        const node = nodeLookup.get(id)?.internals.userNode;\n        if (node) {\n            nodesFromDragItems.push({\n                ...node,\n                position: dragItem.position,\n                dragging,\n            });\n        }\n    }\n    if (!nodeId) {\n        return [nodesFromDragItems[0], nodesFromDragItems];\n    }\n    const node = nodeLookup.get(nodeId)?.internals.userNode;\n    return [\n        !node\n            ? nodesFromDragItems[0]\n            : {\n                ...node,\n                position: dragItems.get(nodeId)?.position || node.position,\n                dragging,\n            },\n        nodesFromDragItems,\n    ];\n}\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nfunction XYDrag({ onNodeMouseDown, getStoreItems, onDragStart, onDrag, onDragStop, }) {\n    let lastPos = { x: null, y: null };\n    let autoPanId = 0;\n    let dragItems = new Map();\n    let autoPanStarted = false;\n    let mousePosition = { x: 0, y: 0 };\n    let containerBounds = null;\n    let dragStarted = false;\n    let d3Selection = null;\n    let abortDrag = false; // prevents unintentional dragging on multitouch\n    // public functions\n    function update({ noDragClassName, handleSelector, domNode, isSelectable, nodeId, nodeClickDistance = 0, }) {\n        d3Selection = select(domNode);\n        function updateNodes({ x, y }, dragEvent) {\n            const { nodeLookup, nodeExtent, snapGrid, snapToGrid, nodeOrigin, onNodeDrag, onSelectionDrag, onError, updateNodePositions, } = getStoreItems();\n            lastPos = { x, y };\n            let hasChange = false;\n            let nodesBox = { x: 0, y: 0, x2: 0, y2: 0 };\n            if (dragItems.size > 1 && nodeExtent) {\n                const rect = getInternalNodesBounds(dragItems);\n                nodesBox = rectToBox(rect);\n            }\n            for (const [id, dragItem] of dragItems) {\n                if (!nodeLookup.has(id)) {\n                    /*\n                     * if the node is not in the nodeLookup anymore, it was probably deleted while dragging\n                     * and we don't need to update it anymore\n                     */\n                    continue;\n                }\n                let nextPosition = { x: x - dragItem.distance.x, y: y - dragItem.distance.y };\n                if (snapToGrid) {\n                    nextPosition = snapPosition(nextPosition, snapGrid);\n                }\n                /*\n                 * if there is selection with multiple nodes and a node extent is set, we need to adjust the node extent for each node\n                 * based on its position so that the node stays at it's position relative to the selection.\n                 */\n                let adjustedNodeExtent = [\n                    [nodeExtent[0][0], nodeExtent[0][1]],\n                    [nodeExtent[1][0], nodeExtent[1][1]],\n                ];\n                if (dragItems.size > 1 && nodeExtent && !dragItem.extent) {\n                    const { positionAbsolute } = dragItem.internals;\n                    const x1 = positionAbsolute.x - nodesBox.x + nodeExtent[0][0];\n                    const x2 = positionAbsolute.x + dragItem.measured.width - nodesBox.x2 + nodeExtent[1][0];\n                    const y1 = positionAbsolute.y - nodesBox.y + nodeExtent[0][1];\n                    const y2 = positionAbsolute.y + dragItem.measured.height - nodesBox.y2 + nodeExtent[1][1];\n                    adjustedNodeExtent = [\n                        [x1, y1],\n                        [x2, y2],\n                    ];\n                }\n                const { position, positionAbsolute } = calculateNodePosition({\n                    nodeId: id,\n                    nextPosition,\n                    nodeLookup,\n                    nodeExtent: adjustedNodeExtent,\n                    nodeOrigin,\n                    onError,\n                });\n                // we want to make sure that we only fire a change event when there is a change\n                hasChange = hasChange || dragItem.position.x !== position.x || dragItem.position.y !== position.y;\n                dragItem.position = position;\n                dragItem.internals.positionAbsolute = positionAbsolute;\n            }\n            if (!hasChange) {\n                return;\n            }\n            updateNodePositions(dragItems, true);\n            if (dragEvent && (onDrag || onNodeDrag || (!nodeId && onSelectionDrag))) {\n                const [currentNode, currentNodes] = getEventHandlerParams({\n                    nodeId,\n                    dragItems,\n                    nodeLookup,\n                });\n                onDrag?.(dragEvent, dragItems, currentNode, currentNodes);\n                onNodeDrag?.(dragEvent, currentNode, currentNodes);\n                if (!nodeId) {\n                    onSelectionDrag?.(dragEvent, currentNodes);\n                }\n            }\n        }\n        async function autoPan() {\n            if (!containerBounds) {\n                return;\n            }\n            const { transform, panBy, autoPanSpeed, autoPanOnNodeDrag } = getStoreItems();\n            if (!autoPanOnNodeDrag) {\n                autoPanStarted = false;\n                cancelAnimationFrame(autoPanId);\n                return;\n            }\n            const [xMovement, yMovement] = calcAutoPan(mousePosition, containerBounds, autoPanSpeed);\n            if (xMovement !== 0 || yMovement !== 0) {\n                lastPos.x = (lastPos.x ?? 0) - xMovement / transform[2];\n                lastPos.y = (lastPos.y ?? 0) - yMovement / transform[2];\n                if (await panBy({ x: xMovement, y: yMovement })) {\n                    updateNodes(lastPos, null);\n                }\n            }\n            autoPanId = requestAnimationFrame(autoPan);\n        }\n        function startDrag(event) {\n            const { nodeLookup, multiSelectionActive, nodesDraggable, transform, snapGrid, snapToGrid, selectNodesOnDrag, onNodeDragStart, onSelectionDragStart, unselectNodesAndEdges, } = getStoreItems();\n            dragStarted = true;\n            if ((!selectNodesOnDrag || !isSelectable) && !multiSelectionActive && nodeId) {\n                if (!nodeLookup.get(nodeId)?.selected) {\n                    // we need to reset selected nodes when selectNodesOnDrag=false\n                    unselectNodesAndEdges();\n                }\n            }\n            if (isSelectable && selectNodesOnDrag && nodeId) {\n                onNodeMouseDown?.(nodeId);\n            }\n            const pointerPos = getPointerPosition(event.sourceEvent, { transform, snapGrid, snapToGrid, containerBounds });\n            lastPos = pointerPos;\n            dragItems = getDragItems(nodeLookup, nodesDraggable, pointerPos, nodeId);\n            if (dragItems.size > 0 && (onDragStart || onNodeDragStart || (!nodeId && onSelectionDragStart))) {\n                const [currentNode, currentNodes] = getEventHandlerParams({\n                    nodeId,\n                    dragItems,\n                    nodeLookup,\n                });\n                onDragStart?.(event.sourceEvent, dragItems, currentNode, currentNodes);\n                onNodeDragStart?.(event.sourceEvent, currentNode, currentNodes);\n                if (!nodeId) {\n                    onSelectionDragStart?.(event.sourceEvent, currentNodes);\n                }\n            }\n        }\n        const d3DragInstance = drag()\n            .clickDistance(nodeClickDistance)\n            .on('start', (event) => {\n            const { domNode, nodeDragThreshold, transform, snapGrid, snapToGrid } = getStoreItems();\n            containerBounds = domNode?.getBoundingClientRect() || null;\n            abortDrag = false;\n            if (nodeDragThreshold === 0) {\n                startDrag(event);\n            }\n            const pointerPos = getPointerPosition(event.sourceEvent, { transform, snapGrid, snapToGrid, containerBounds });\n            lastPos = pointerPos;\n            mousePosition = getEventPosition(event.sourceEvent, containerBounds);\n        })\n            .on('drag', (event) => {\n            const { autoPanOnNodeDrag, transform, snapGrid, snapToGrid, nodeDragThreshold, nodeLookup } = getStoreItems();\n            const pointerPos = getPointerPosition(event.sourceEvent, { transform, snapGrid, snapToGrid, containerBounds });\n            if ((event.sourceEvent.type === 'touchmove' && event.sourceEvent.touches.length > 1) ||\n                // if user deletes a node while dragging, we need to abort the drag to prevent errors\n                (nodeId && !nodeLookup.has(nodeId))) {\n                abortDrag = true;\n            }\n            if (abortDrag) {\n                return;\n            }\n            if (!autoPanStarted && autoPanOnNodeDrag && dragStarted) {\n                autoPanStarted = true;\n                autoPan();\n            }\n            if (!dragStarted) {\n                const x = pointerPos.xSnapped - (lastPos.x ?? 0);\n                const y = pointerPos.ySnapped - (lastPos.y ?? 0);\n                const distance = Math.sqrt(x * x + y * y);\n                if (distance > nodeDragThreshold) {\n                    startDrag(event);\n                }\n            }\n            // skip events without movement\n            if ((lastPos.x !== pointerPos.xSnapped || lastPos.y !== pointerPos.ySnapped) && dragItems && dragStarted) {\n                // dragEvent = event.sourceEvent as MouseEvent;\n                mousePosition = getEventPosition(event.sourceEvent, containerBounds);\n                updateNodes(pointerPos, event.sourceEvent);\n            }\n        })\n            .on('end', (event) => {\n            if (!dragStarted || abortDrag) {\n                return;\n            }\n            autoPanStarted = false;\n            dragStarted = false;\n            cancelAnimationFrame(autoPanId);\n            if (dragItems.size > 0) {\n                const { nodeLookup, updateNodePositions, onNodeDragStop, onSelectionDragStop } = getStoreItems();\n                updateNodePositions(dragItems, false);\n                if (onDragStop || onNodeDragStop || (!nodeId && onSelectionDragStop)) {\n                    const [currentNode, currentNodes] = getEventHandlerParams({\n                        nodeId,\n                        dragItems,\n                        nodeLookup,\n                        dragging: false,\n                    });\n                    onDragStop?.(event.sourceEvent, dragItems, currentNode, currentNodes);\n                    onNodeDragStop?.(event.sourceEvent, currentNode, currentNodes);\n                    if (!nodeId) {\n                        onSelectionDragStop?.(event.sourceEvent, currentNodes);\n                    }\n                }\n            }\n        })\n            .filter((event) => {\n            const target = event.target;\n            const isDraggable = !event.button &&\n                (!noDragClassName || !hasSelector(target, `.${noDragClassName}`, domNode)) &&\n                (!handleSelector || hasSelector(target, handleSelector, domNode));\n            return isDraggable;\n        });\n        d3Selection.call(d3DragInstance);\n    }\n    function destroy() {\n        d3Selection?.on('.drag', null);\n    }\n    return {\n        update,\n        destroy,\n    };\n}\n\nfunction getNodesWithinDistance(position, nodeLookup, distance) {\n    const nodes = [];\n    const rect = {\n        x: position.x - distance,\n        y: position.y - distance,\n        width: distance * 2,\n        height: distance * 2,\n    };\n    for (const node of nodeLookup.values()) {\n        if (getOverlappingArea(rect, nodeToRect(node)) > 0) {\n            nodes.push(node);\n        }\n    }\n    return nodes;\n}\n/*\n * this distance is used for the area around the user pointer\n * while doing a connection for finding the closest nodes\n */\nconst ADDITIONAL_DISTANCE = 250;\nfunction getClosestHandle(position, connectionRadius, nodeLookup, fromHandle) {\n    let closestHandles = [];\n    let minDistance = Infinity;\n    const closeNodes = getNodesWithinDistance(position, nodeLookup, connectionRadius + ADDITIONAL_DISTANCE);\n    for (const node of closeNodes) {\n        const allHandles = [...(node.internals.handleBounds?.source ?? []), ...(node.internals.handleBounds?.target ?? [])];\n        for (const handle of allHandles) {\n            // if the handle is the same as the fromHandle we skip it\n            if (fromHandle.nodeId === handle.nodeId && fromHandle.type === handle.type && fromHandle.id === handle.id) {\n                continue;\n            }\n            // determine absolute position of the handle\n            const { x, y } = getHandlePosition(node, handle, handle.position, true);\n            const distance = Math.sqrt(Math.pow(x - position.x, 2) + Math.pow(y - position.y, 2));\n            if (distance > connectionRadius) {\n                continue;\n            }\n            if (distance < minDistance) {\n                closestHandles = [{ ...handle, x, y }];\n                minDistance = distance;\n            }\n            else if (distance === minDistance) {\n                // when multiple handles are on the same distance we collect all of them\n                closestHandles.push({ ...handle, x, y });\n            }\n        }\n    }\n    if (!closestHandles.length) {\n        return null;\n    }\n    // when multiple handles overlay each other we prefer the opposite handle\n    if (closestHandles.length > 1) {\n        const oppositeHandleType = fromHandle.type === 'source' ? 'target' : 'source';\n        return closestHandles.find((handle) => handle.type === oppositeHandleType) ?? closestHandles[0];\n    }\n    return closestHandles[0];\n}\nfunction getHandle(nodeId, handleType, handleId, nodeLookup, connectionMode, withAbsolutePosition = false) {\n    const node = nodeLookup.get(nodeId);\n    if (!node) {\n        return null;\n    }\n    const handles = connectionMode === 'strict'\n        ? node.internals.handleBounds?.[handleType]\n        : [...(node.internals.handleBounds?.source ?? []), ...(node.internals.handleBounds?.target ?? [])];\n    const handle = (handleId ? handles?.find((h) => h.id === handleId) : handles?.[0]) ?? null;\n    return handle && withAbsolutePosition\n        ? { ...handle, ...getHandlePosition(node, handle, handle.position, true) }\n        : handle;\n}\nfunction getHandleType(edgeUpdaterType, handleDomNode) {\n    if (edgeUpdaterType) {\n        return edgeUpdaterType;\n    }\n    else if (handleDomNode?.classList.contains('target')) {\n        return 'target';\n    }\n    else if (handleDomNode?.classList.contains('source')) {\n        return 'source';\n    }\n    return null;\n}\nfunction isConnectionValid(isInsideConnectionRadius, isHandleValid) {\n    let isValid = null;\n    if (isHandleValid) {\n        isValid = true;\n    }\n    else if (isInsideConnectionRadius && !isHandleValid) {\n        isValid = false;\n    }\n    return isValid;\n}\n\nconst alwaysValid = () => true;\nfunction onPointerDown(event, { connectionMode, connectionRadius, handleId, nodeId, edgeUpdaterType, isTarget, domNode, nodeLookup, lib, autoPanOnConnect, flowId, panBy, cancelConnection, onConnectStart, onConnect, onConnectEnd, isValidConnection = alwaysValid, onReconnectEnd, updateConnection, getTransform, getFromHandle, autoPanSpeed, }) {\n    // when xyflow is used inside a shadow root we can't use document\n    const doc = getHostForElement(event.target);\n    let autoPanId = 0;\n    let closestHandle;\n    const { x, y } = getEventPosition(event);\n    const clickedHandle = doc?.elementFromPoint(x, y);\n    const handleType = getHandleType(edgeUpdaterType, clickedHandle);\n    const containerBounds = domNode?.getBoundingClientRect();\n    if (!containerBounds || !handleType) {\n        return;\n    }\n    const fromHandleInternal = getHandle(nodeId, handleType, handleId, nodeLookup, connectionMode);\n    if (!fromHandleInternal) {\n        return;\n    }\n    let position = getEventPosition(event, containerBounds);\n    let autoPanStarted = false;\n    let connection = null;\n    let isValid = false;\n    let handleDomNode = null;\n    // when the user is moving the mouse close to the edge of the canvas while connecting we move the canvas\n    function autoPan() {\n        if (!autoPanOnConnect || !containerBounds) {\n            return;\n        }\n        const [x, y] = calcAutoPan(position, containerBounds, autoPanSpeed);\n        panBy({ x, y });\n        autoPanId = requestAnimationFrame(autoPan);\n    }\n    // Stays the same for all consecutive pointermove events\n    const fromHandle = {\n        ...fromHandleInternal,\n        nodeId,\n        type: handleType,\n        position: fromHandleInternal.position,\n    };\n    const fromNodeInternal = nodeLookup.get(nodeId);\n    const from = getHandlePosition(fromNodeInternal, fromHandle, Position.Left, true);\n    const newConnection = {\n        inProgress: true,\n        isValid: null,\n        from,\n        fromHandle,\n        fromPosition: fromHandle.position,\n        fromNode: fromNodeInternal,\n        to: position,\n        toHandle: null,\n        toPosition: oppositePosition[fromHandle.position],\n        toNode: null,\n    };\n    updateConnection(newConnection);\n    let previousConnection = newConnection;\n    onConnectStart?.(event, { nodeId, handleId, handleType });\n    function onPointerMove(event) {\n        if (!getFromHandle() || !fromHandle) {\n            onPointerUp(event);\n            return;\n        }\n        const transform = getTransform();\n        position = getEventPosition(event, containerBounds);\n        closestHandle = getClosestHandle(pointToRendererPoint(position, transform, false, [1, 1]), connectionRadius, nodeLookup, fromHandle);\n        if (!autoPanStarted) {\n            autoPan();\n            autoPanStarted = true;\n        }\n        const result = isValidHandle(event, {\n            handle: closestHandle,\n            connectionMode,\n            fromNodeId: nodeId,\n            fromHandleId: handleId,\n            fromType: isTarget ? 'target' : 'source',\n            isValidConnection,\n            doc,\n            lib,\n            flowId,\n            nodeLookup,\n        });\n        handleDomNode = result.handleDomNode;\n        connection = result.connection;\n        isValid = isConnectionValid(!!closestHandle, result.isValid);\n        const newConnection = {\n            // from stays the same\n            ...previousConnection,\n            isValid,\n            to: closestHandle && isValid\n                ? rendererPointToPoint({ x: closestHandle.x, y: closestHandle.y }, transform)\n                : position,\n            toHandle: result.toHandle,\n            toPosition: isValid && result.toHandle ? result.toHandle.position : oppositePosition[fromHandle.position],\n            toNode: result.toHandle ? nodeLookup.get(result.toHandle.nodeId) : null,\n        };\n        /*\n         * we don't want to trigger an update when the connection\n         * is snapped to the same handle as before\n         */\n        if (isValid &&\n            closestHandle &&\n            previousConnection.toHandle &&\n            newConnection.toHandle &&\n            previousConnection.toHandle.type === newConnection.toHandle.type &&\n            previousConnection.toHandle.nodeId === newConnection.toHandle.nodeId &&\n            previousConnection.toHandle.id === newConnection.toHandle.id &&\n            previousConnection.to.x === newConnection.to.x &&\n            previousConnection.to.y === newConnection.to.y) {\n            return;\n        }\n        updateConnection(newConnection);\n        previousConnection = newConnection;\n    }\n    function onPointerUp(event) {\n        if ((closestHandle || handleDomNode) && connection && isValid) {\n            onConnect?.(connection);\n        }\n        /*\n         * it's important to get a fresh reference from the store here\n         * in order to get the latest state of onConnectEnd\n         */\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        const { inProgress, ...connectionState } = previousConnection;\n        const finalConnectionState = {\n            ...connectionState,\n            toPosition: previousConnection.toHandle ? previousConnection.toPosition : null,\n        };\n        onConnectEnd?.(event, finalConnectionState);\n        if (edgeUpdaterType) {\n            onReconnectEnd?.(event, finalConnectionState);\n        }\n        cancelConnection();\n        cancelAnimationFrame(autoPanId);\n        autoPanStarted = false;\n        isValid = false;\n        connection = null;\n        handleDomNode = null;\n        doc.removeEventListener('mousemove', onPointerMove);\n        doc.removeEventListener('mouseup', onPointerUp);\n        doc.removeEventListener('touchmove', onPointerMove);\n        doc.removeEventListener('touchend', onPointerUp);\n    }\n    doc.addEventListener('mousemove', onPointerMove);\n    doc.addEventListener('mouseup', onPointerUp);\n    doc.addEventListener('touchmove', onPointerMove);\n    doc.addEventListener('touchend', onPointerUp);\n}\n// checks if  and returns connection in fom of an object { source: 123, target: 312 }\nfunction isValidHandle(event, { handle, connectionMode, fromNodeId, fromHandleId, fromType, doc, lib, flowId, isValidConnection = alwaysValid, nodeLookup, }) {\n    const isTarget = fromType === 'target';\n    const handleDomNode = handle\n        ? doc.querySelector(`.${lib}-flow__handle[data-id=\"${flowId}-${handle?.nodeId}-${handle?.id}-${handle?.type}\"]`)\n        : null;\n    const { x, y } = getEventPosition(event);\n    const handleBelow = doc.elementFromPoint(x, y);\n    /*\n     * we always want to prioritize the handle below the mouse cursor over the closest distance handle,\n     * because it could be that the center of another handle is closer to the mouse pointer than the handle below the cursor\n     */\n    const handleToCheck = handleBelow?.classList.contains(`${lib}-flow__handle`) ? handleBelow : handleDomNode;\n    const result = {\n        handleDomNode: handleToCheck,\n        isValid: false,\n        connection: null,\n        toHandle: null,\n    };\n    if (handleToCheck) {\n        const handleType = getHandleType(undefined, handleToCheck);\n        const handleNodeId = handleToCheck.getAttribute('data-nodeid');\n        const handleId = handleToCheck.getAttribute('data-handleid');\n        const connectable = handleToCheck.classList.contains('connectable');\n        const connectableEnd = handleToCheck.classList.contains('connectableend');\n        if (!handleNodeId || !handleType) {\n            return result;\n        }\n        const connection = {\n            source: isTarget ? handleNodeId : fromNodeId,\n            sourceHandle: isTarget ? handleId : fromHandleId,\n            target: isTarget ? fromNodeId : handleNodeId,\n            targetHandle: isTarget ? fromHandleId : handleId,\n        };\n        result.connection = connection;\n        const isConnectable = connectable && connectableEnd;\n        // in strict mode we don't allow target to target or source to source connections\n        const isValid = isConnectable &&\n            (connectionMode === ConnectionMode.Strict\n                ? (isTarget && handleType === 'source') || (!isTarget && handleType === 'target')\n                : handleNodeId !== fromNodeId || handleId !== fromHandleId);\n        result.isValid = isValid && isValidConnection(connection);\n        result.toHandle = getHandle(handleNodeId, handleType, handleId, nodeLookup, connectionMode, false);\n    }\n    return result;\n}\nconst XYHandle = {\n    onPointerDown,\n    isValid: isValidHandle,\n};\n\nfunction XYMinimap({ domNode, panZoom, getTransform, getViewScale }) {\n    const selection = select(domNode);\n    function update({ translateExtent, width, height, zoomStep = 10, pannable = true, zoomable = true, inversePan = false, }) {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        const zoomHandler = (event) => {\n            const transform = getTransform();\n            if (event.sourceEvent.type !== 'wheel' || !panZoom) {\n                return;\n            }\n            const pinchDelta = -event.sourceEvent.deltaY *\n                (event.sourceEvent.deltaMode === 1 ? 0.05 : event.sourceEvent.deltaMode ? 1 : 0.002) *\n                zoomStep;\n            const nextZoom = transform[2] * Math.pow(2, pinchDelta);\n            panZoom.scaleTo(nextZoom);\n        };\n        let panStart = [0, 0];\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        const panStartHandler = (event) => {\n            if (event.sourceEvent.type === 'mousedown' || event.sourceEvent.type === 'touchstart') {\n                panStart = [\n                    event.sourceEvent.clientX ?? event.sourceEvent.touches[0].clientX,\n                    event.sourceEvent.clientY ?? event.sourceEvent.touches[0].clientY,\n                ];\n            }\n        };\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        const panHandler = (event) => {\n            const transform = getTransform();\n            if ((event.sourceEvent.type !== 'mousemove' && event.sourceEvent.type !== 'touchmove') || !panZoom) {\n                return;\n            }\n            const panCurrent = [\n                event.sourceEvent.clientX ?? event.sourceEvent.touches[0].clientX,\n                event.sourceEvent.clientY ?? event.sourceEvent.touches[0].clientY,\n            ];\n            const panDelta = [panCurrent[0] - panStart[0], panCurrent[1] - panStart[1]];\n            panStart = panCurrent;\n            const moveScale = getViewScale() * Math.max(transform[2], Math.log(transform[2])) * (inversePan ? -1 : 1);\n            const position = {\n                x: transform[0] - panDelta[0] * moveScale,\n                y: transform[1] - panDelta[1] * moveScale,\n            };\n            const extent = [\n                [0, 0],\n                [width, height],\n            ];\n            panZoom.setViewportConstrained({\n                x: position.x,\n                y: position.y,\n                zoom: transform[2],\n            }, extent, translateExtent);\n        };\n        const zoomAndPanHandler = zoom()\n            .on('start', panStartHandler)\n            // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n            // @ts-ignore\n            .on('zoom', pannable ? panHandler : null)\n            // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n            // @ts-ignore\n            .on('zoom.wheel', zoomable ? zoomHandler : null);\n        selection.call(zoomAndPanHandler, {});\n    }\n    function destroy() {\n        selection.on('zoom', null);\n    }\n    return {\n        update,\n        destroy,\n        pointer,\n    };\n}\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\nconst viewChanged = (prevViewport, eventViewport) => prevViewport.x !== eventViewport.x || prevViewport.y !== eventViewport.y || prevViewport.zoom !== eventViewport.k;\nconst transformToViewport = (transform) => ({\n    x: transform.x,\n    y: transform.y,\n    zoom: transform.k,\n});\nconst viewportToTransform = ({ x, y, zoom }) => zoomIdentity.translate(x, y).scale(zoom);\nconst isWrappedWithClass = (event, className) => event.target.closest(`.${className}`);\nconst isRightClickPan = (panOnDrag, usedButton) => usedButton === 2 && Array.isArray(panOnDrag) && panOnDrag.includes(2);\nconst getD3Transition = (selection, duration = 0, onEnd = () => { }) => {\n    const hasDuration = typeof duration === 'number' && duration > 0;\n    if (!hasDuration) {\n        onEnd();\n    }\n    return hasDuration ? selection.transition().duration(duration).on('end', onEnd) : selection;\n};\nconst wheelDelta = (event) => {\n    const factor = event.ctrlKey && isMacOs() ? 10 : 1;\n    return -event.deltaY * (event.deltaMode === 1 ? 0.05 : event.deltaMode ? 1 : 0.002) * factor;\n};\n\nfunction createPanOnScrollHandler({ zoomPanValues, noWheelClassName, d3Selection, d3Zoom, panOnScrollMode, panOnScrollSpeed, zoomOnPinch, onPanZoomStart, onPanZoom, onPanZoomEnd, }) {\n    return (event) => {\n        if (isWrappedWithClass(event, noWheelClassName)) {\n            return false;\n        }\n        event.preventDefault();\n        event.stopImmediatePropagation();\n        const currentZoom = d3Selection.property('__zoom').k || 1;\n        // macos sets ctrlKey=true for pinch gesture on a trackpad\n        if (event.ctrlKey && zoomOnPinch) {\n            const point = pointer(event);\n            const pinchDelta = wheelDelta(event);\n            const zoom = currentZoom * Math.pow(2, pinchDelta);\n            // @ts-ignore\n            d3Zoom.scaleTo(d3Selection, zoom, point, event);\n            return;\n        }\n        /*\n         * increase scroll speed in firefox\n         * firefox: deltaMode === 1; chrome: deltaMode === 0\n         */\n        const deltaNormalize = event.deltaMode === 1 ? 20 : 1;\n        let deltaX = panOnScrollMode === PanOnScrollMode.Vertical ? 0 : event.deltaX * deltaNormalize;\n        let deltaY = panOnScrollMode === PanOnScrollMode.Horizontal ? 0 : event.deltaY * deltaNormalize;\n        // this enables vertical scrolling with shift + scroll on windows\n        if (!isMacOs() && event.shiftKey && panOnScrollMode !== PanOnScrollMode.Vertical) {\n            deltaX = event.deltaY * deltaNormalize;\n            deltaY = 0;\n        }\n        d3Zoom.translateBy(d3Selection, -(deltaX / currentZoom) * panOnScrollSpeed, -(deltaY / currentZoom) * panOnScrollSpeed, \n        // @ts-ignore\n        { internal: true });\n        const nextViewport = transformToViewport(d3Selection.property('__zoom'));\n        clearTimeout(zoomPanValues.panScrollTimeout);\n        /*\n         * for pan on scroll we need to handle the event calls on our own\n         * we can't use the start, zoom and end events from d3-zoom\n         * because start and move gets called on every scroll event and not once at the beginning\n         */\n        if (!zoomPanValues.isPanScrolling) {\n            zoomPanValues.isPanScrolling = true;\n            onPanZoomStart?.(event, nextViewport);\n        }\n        if (zoomPanValues.isPanScrolling) {\n            onPanZoom?.(event, nextViewport);\n            zoomPanValues.panScrollTimeout = setTimeout(() => {\n                onPanZoomEnd?.(event, nextViewport);\n                zoomPanValues.isPanScrolling = false;\n            }, 150);\n        }\n    };\n}\nfunction createZoomOnScrollHandler({ noWheelClassName, preventScrolling, d3ZoomHandler }) {\n    return function (event, d) {\n        const isWheel = event.type === 'wheel';\n        // we still want to enable pinch zooming even if preventScrolling is set to false\n        const preventZoom = !preventScrolling && isWheel && !event.ctrlKey;\n        const hasNoWheelClass = isWrappedWithClass(event, noWheelClassName);\n        // if user is pinch zooming above a nowheel element, we don't want the browser to zoom\n        if (event.ctrlKey && isWheel && hasNoWheelClass) {\n            event.preventDefault();\n        }\n        if (preventZoom || hasNoWheelClass) {\n            return null;\n        }\n        event.preventDefault();\n        d3ZoomHandler.call(this, event, d);\n    };\n}\nfunction createPanZoomStartHandler({ zoomPanValues, onDraggingChange, onPanZoomStart }) {\n    return (event) => {\n        if (event.sourceEvent?.internal) {\n            return;\n        }\n        const viewport = transformToViewport(event.transform);\n        // we need to remember it here, because it's always 0 in the \"zoom\" event\n        zoomPanValues.mouseButton = event.sourceEvent?.button || 0;\n        zoomPanValues.isZoomingOrPanning = true;\n        zoomPanValues.prevViewport = viewport;\n        if (event.sourceEvent?.type === 'mousedown') {\n            onDraggingChange(true);\n        }\n        if (onPanZoomStart) {\n            onPanZoomStart?.(event.sourceEvent, viewport);\n        }\n    };\n}\nfunction createPanZoomHandler({ zoomPanValues, panOnDrag, onPaneContextMenu, onTransformChange, onPanZoom, }) {\n    return (event) => {\n        zoomPanValues.usedRightMouseButton = !!(onPaneContextMenu && isRightClickPan(panOnDrag, zoomPanValues.mouseButton ?? 0));\n        if (!event.sourceEvent?.sync) {\n            onTransformChange([event.transform.x, event.transform.y, event.transform.k]);\n        }\n        if (onPanZoom && !event.sourceEvent?.internal) {\n            onPanZoom?.(event.sourceEvent, transformToViewport(event.transform));\n        }\n    };\n}\nfunction createPanZoomEndHandler({ zoomPanValues, panOnDrag, panOnScroll, onDraggingChange, onPanZoomEnd, onPaneContextMenu, }) {\n    return (event) => {\n        if (event.sourceEvent?.internal) {\n            return;\n        }\n        zoomPanValues.isZoomingOrPanning = false;\n        if (onPaneContextMenu &&\n            isRightClickPan(panOnDrag, zoomPanValues.mouseButton ?? 0) &&\n            !zoomPanValues.usedRightMouseButton &&\n            event.sourceEvent) {\n            onPaneContextMenu(event.sourceEvent);\n        }\n        zoomPanValues.usedRightMouseButton = false;\n        onDraggingChange(false);\n        if (onPanZoomEnd && viewChanged(zoomPanValues.prevViewport, event.transform)) {\n            const viewport = transformToViewport(event.transform);\n            zoomPanValues.prevViewport = viewport;\n            clearTimeout(zoomPanValues.timerId);\n            zoomPanValues.timerId = setTimeout(() => {\n                onPanZoomEnd?.(event.sourceEvent, viewport);\n            }, \n            // we need a setTimeout for panOnScroll to supress multiple end events fired during scroll\n            panOnScroll ? 150 : 0);\n        }\n    };\n}\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\nfunction createFilter({ zoomActivationKeyPressed, zoomOnScroll, zoomOnPinch, panOnDrag, panOnScroll, zoomOnDoubleClick, userSelectionActive, noWheelClassName, noPanClassName, lib, }) {\n    return (event) => {\n        const zoomScroll = zoomActivationKeyPressed || zoomOnScroll;\n        const pinchZoom = zoomOnPinch && event.ctrlKey;\n        if (event.button === 1 &&\n            event.type === 'mousedown' &&\n            (isWrappedWithClass(event, `${lib}-flow__node`) || isWrappedWithClass(event, `${lib}-flow__edge`))) {\n            return true;\n        }\n        // if all interactions are disabled, we prevent all zoom events\n        if (!panOnDrag && !zoomScroll && !panOnScroll && !zoomOnDoubleClick && !zoomOnPinch) {\n            return false;\n        }\n        // during a selection we prevent all other interactions\n        if (userSelectionActive) {\n            return false;\n        }\n        // if the target element is inside an element with the nowheel class, we prevent zooming\n        if (isWrappedWithClass(event, noWheelClassName) && event.type === 'wheel') {\n            return false;\n        }\n        // if the target element is inside an element with the nopan class, we prevent panning\n        if (isWrappedWithClass(event, noPanClassName) &&\n            (event.type !== 'wheel' || (panOnScroll && event.type === 'wheel' && !zoomActivationKeyPressed))) {\n            return false;\n        }\n        if (!zoomOnPinch && event.ctrlKey && event.type === 'wheel') {\n            return false;\n        }\n        if (!zoomOnPinch && event.type === 'touchstart' && event.touches?.length > 1) {\n            event.preventDefault(); // if you manage to start with 2 touches, we prevent native zoom\n            return false;\n        }\n        // when there is no scroll handling enabled, we prevent all wheel events\n        if (!zoomScroll && !panOnScroll && !pinchZoom && event.type === 'wheel') {\n            return false;\n        }\n        // if the pane is not movable, we prevent dragging it with mousestart or touchstart\n        if (!panOnDrag && (event.type === 'mousedown' || event.type === 'touchstart')) {\n            return false;\n        }\n        // if the pane is only movable using allowed clicks\n        if (Array.isArray(panOnDrag) && !panOnDrag.includes(event.button) && event.type === 'mousedown') {\n            return false;\n        }\n        // We only allow right clicks if pan on drag is set to right click\n        const buttonAllowed = (Array.isArray(panOnDrag) && panOnDrag.includes(event.button)) || !event.button || event.button <= 1;\n        // default filter for d3-zoom\n        return (!event.ctrlKey || event.type === 'wheel') && buttonAllowed;\n    };\n}\n\nfunction XYPanZoom({ domNode, minZoom, maxZoom, paneClickDistance, translateExtent, viewport, onPanZoom, onPanZoomStart, onPanZoomEnd, onDraggingChange, }) {\n    const zoomPanValues = {\n        isZoomingOrPanning: false,\n        usedRightMouseButton: false,\n        prevViewport: { x: 0, y: 0, zoom: 0 },\n        mouseButton: 0,\n        timerId: undefined,\n        panScrollTimeout: undefined,\n        isPanScrolling: false,\n    };\n    const bbox = domNode.getBoundingClientRect();\n    const d3ZoomInstance = zoom()\n        .clickDistance(!isNumeric(paneClickDistance) || paneClickDistance < 0 ? 0 : paneClickDistance)\n        .scaleExtent([minZoom, maxZoom])\n        .translateExtent(translateExtent);\n    const d3Selection = select(domNode).call(d3ZoomInstance);\n    setViewportConstrained({\n        x: viewport.x,\n        y: viewport.y,\n        zoom: clamp(viewport.zoom, minZoom, maxZoom),\n    }, [\n        [0, 0],\n        [bbox.width, bbox.height],\n    ], translateExtent);\n    const d3ZoomHandler = d3Selection.on('wheel.zoom');\n    const d3DblClickZoomHandler = d3Selection.on('dblclick.zoom');\n    d3ZoomInstance.wheelDelta(wheelDelta);\n    function setTransform(transform, options) {\n        if (d3Selection) {\n            return new Promise((resolve) => {\n                d3ZoomInstance?.transform(getD3Transition(d3Selection, options?.duration, () => resolve(true)), transform);\n            });\n        }\n        return Promise.resolve(false);\n    }\n    // public functions\n    function update({ noWheelClassName, noPanClassName, onPaneContextMenu, userSelectionActive, panOnScroll, panOnDrag, panOnScrollMode, panOnScrollSpeed, preventScrolling, zoomOnPinch, zoomOnScroll, zoomOnDoubleClick, zoomActivationKeyPressed, lib, onTransformChange, }) {\n        if (userSelectionActive && !zoomPanValues.isZoomingOrPanning) {\n            destroy();\n        }\n        const isPanOnScroll = panOnScroll && !zoomActivationKeyPressed && !userSelectionActive;\n        const wheelHandler = isPanOnScroll\n            ? createPanOnScrollHandler({\n                zoomPanValues,\n                noWheelClassName,\n                d3Selection,\n                d3Zoom: d3ZoomInstance,\n                panOnScrollMode,\n                panOnScrollSpeed,\n                zoomOnPinch,\n                onPanZoomStart,\n                onPanZoom,\n                onPanZoomEnd,\n            })\n            : createZoomOnScrollHandler({\n                noWheelClassName,\n                preventScrolling,\n                d3ZoomHandler,\n            });\n        d3Selection.on('wheel.zoom', wheelHandler, { passive: false });\n        if (!userSelectionActive) {\n            // pan zoom start\n            const startHandler = createPanZoomStartHandler({\n                zoomPanValues,\n                onDraggingChange,\n                onPanZoomStart,\n            });\n            d3ZoomInstance.on('start', startHandler);\n            // pan zoom\n            const panZoomHandler = createPanZoomHandler({\n                zoomPanValues,\n                panOnDrag,\n                onPaneContextMenu: !!onPaneContextMenu,\n                onPanZoom,\n                onTransformChange,\n            });\n            d3ZoomInstance.on('zoom', panZoomHandler);\n            // pan zoom end\n            const panZoomEndHandler = createPanZoomEndHandler({\n                zoomPanValues,\n                panOnDrag,\n                panOnScroll,\n                onPaneContextMenu,\n                onPanZoomEnd,\n                onDraggingChange,\n            });\n            d3ZoomInstance.on('end', panZoomEndHandler);\n        }\n        const filter = createFilter({\n            zoomActivationKeyPressed,\n            panOnDrag,\n            zoomOnScroll,\n            panOnScroll,\n            zoomOnDoubleClick,\n            zoomOnPinch,\n            userSelectionActive,\n            noPanClassName,\n            noWheelClassName,\n            lib,\n        });\n        d3ZoomInstance.filter(filter);\n        /*\n         * We cannot add zoomOnDoubleClick to the filter above because\n         * double tapping on touch screens circumvents the filter and\n         * dblclick.zoom is fired on the selection directly\n         */\n        if (zoomOnDoubleClick) {\n            d3Selection.on('dblclick.zoom', d3DblClickZoomHandler);\n        }\n        else {\n            d3Selection.on('dblclick.zoom', null);\n        }\n    }\n    function destroy() {\n        d3ZoomInstance.on('zoom', null);\n    }\n    async function setViewportConstrained(viewport, extent, translateExtent) {\n        const nextTransform = viewportToTransform(viewport);\n        const contrainedTransform = d3ZoomInstance?.constrain()(nextTransform, extent, translateExtent);\n        if (contrainedTransform) {\n            await setTransform(contrainedTransform);\n        }\n        return new Promise((resolve) => resolve(contrainedTransform));\n    }\n    async function setViewport(viewport, options) {\n        const nextTransform = viewportToTransform(viewport);\n        await setTransform(nextTransform, options);\n        return new Promise((resolve) => resolve(nextTransform));\n    }\n    function syncViewport(viewport) {\n        if (d3Selection) {\n            const nextTransform = viewportToTransform(viewport);\n            const currentTransform = d3Selection.property('__zoom');\n            if (currentTransform.k !== viewport.zoom ||\n                currentTransform.x !== viewport.x ||\n                currentTransform.y !== viewport.y) {\n                // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n                // @ts-ignore\n                d3ZoomInstance?.transform(d3Selection, nextTransform, null, { sync: true });\n            }\n        }\n    }\n    function getViewport() {\n        const transform = d3Selection ? zoomTransform(d3Selection.node()) : { x: 0, y: 0, k: 1 };\n        return { x: transform.x, y: transform.y, zoom: transform.k };\n    }\n    function scaleTo(zoom, options) {\n        if (d3Selection) {\n            return new Promise((resolve) => {\n                d3ZoomInstance?.scaleTo(getD3Transition(d3Selection, options?.duration, () => resolve(true)), zoom);\n            });\n        }\n        return Promise.resolve(false);\n    }\n    function scaleBy(factor, options) {\n        if (d3Selection) {\n            return new Promise((resolve) => {\n                d3ZoomInstance?.scaleBy(getD3Transition(d3Selection, options?.duration, () => resolve(true)), factor);\n            });\n        }\n        return Promise.resolve(false);\n    }\n    function setScaleExtent(scaleExtent) {\n        d3ZoomInstance?.scaleExtent(scaleExtent);\n    }\n    function setTranslateExtent(translateExtent) {\n        d3ZoomInstance?.translateExtent(translateExtent);\n    }\n    function setClickDistance(distance) {\n        const validDistance = !isNumeric(distance) || distance < 0 ? 0 : distance;\n        d3ZoomInstance?.clickDistance(validDistance);\n    }\n    return {\n        update,\n        destroy,\n        setViewport,\n        setViewportConstrained,\n        getViewport,\n        scaleTo,\n        scaleBy,\n        setScaleExtent,\n        setTranslateExtent,\n        syncViewport,\n        setClickDistance,\n    };\n}\n\n/**\n * Used to determine the variant of the resize control\n *\n * @public\n */\nvar ResizeControlVariant;\n(function (ResizeControlVariant) {\n    ResizeControlVariant[\"Line\"] = \"line\";\n    ResizeControlVariant[\"Handle\"] = \"handle\";\n})(ResizeControlVariant || (ResizeControlVariant = {}));\nconst XY_RESIZER_HANDLE_POSITIONS = ['top-left', 'top-right', 'bottom-left', 'bottom-right'];\nconst XY_RESIZER_LINE_POSITIONS = ['top', 'right', 'bottom', 'left'];\n\n/**\n * Get all connecting edges for a given set of nodes\n * @param width - new width of the node\n * @param prevWidth - previous width of the node\n * @param height - new height of the node\n * @param prevHeight - previous height of the node\n * @param affectsX - whether to invert the resize direction for the x axis\n * @param affectsY - whether to invert the resize direction for the y axis\n * @returns array of two numbers representing the direction of the resize for each axis, 0 = no change, 1 = increase, -1 = decrease\n */\nfunction getResizeDirection({ width, prevWidth, height, prevHeight, affectsX, affectsY, }) {\n    const deltaWidth = width - prevWidth;\n    const deltaHeight = height - prevHeight;\n    const direction = [deltaWidth > 0 ? 1 : deltaWidth < 0 ? -1 : 0, deltaHeight > 0 ? 1 : deltaHeight < 0 ? -1 : 0];\n    if (deltaWidth && affectsX) {\n        direction[0] = direction[0] * -1;\n    }\n    if (deltaHeight && affectsY) {\n        direction[1] = direction[1] * -1;\n    }\n    return direction;\n}\n/**\n * Parses the control position that is being dragged to dimensions that are being resized\n * @param controlPosition - position of the control that is being dragged\n * @returns isHorizontal, isVertical, affectsX, affectsY,\n */\nfunction getControlDirection(controlPosition) {\n    const isHorizontal = controlPosition.includes('right') || controlPosition.includes('left');\n    const isVertical = controlPosition.includes('bottom') || controlPosition.includes('top');\n    const affectsX = controlPosition.includes('left');\n    const affectsY = controlPosition.includes('top');\n    return {\n        isHorizontal,\n        isVertical,\n        affectsX,\n        affectsY,\n    };\n}\nfunction getLowerExtentClamp(lowerExtent, lowerBound) {\n    return Math.max(0, lowerBound - lowerExtent);\n}\nfunction getUpperExtentClamp(upperExtent, upperBound) {\n    return Math.max(0, upperExtent - upperBound);\n}\nfunction getSizeClamp(size, minSize, maxSize) {\n    return Math.max(0, minSize - size, size - maxSize);\n}\nfunction xor(a, b) {\n    return a ? !b : b;\n}\n/**\n * Calculates new width & height and x & y of node after resize based on pointer position\n * @description - Buckle up, this is a chunky one... If you want to determine the new dimensions of a node after a resize,\n * you have to account for all possible restrictions: min/max width/height of the node, the maximum extent the node is allowed\n * to move in (in this case: resize into) determined by the parent node, the minimal extent determined by child nodes\n * with expandParent or extent: 'parent' set and oh yeah, these things also have to work with keepAspectRatio!\n * The way this is done is by determining how much each of these restricting actually restricts the resize and then applying the\n * strongest restriction. Because the resize affects x, y and width, height and width, height of a opposing side with keepAspectRatio,\n * the resize amount is always kept in distX & distY amount (the distance in mouse movement)\n * Instead of clamping each value, we first calculate the biggest 'clamp' (for the lack of a better name) and then apply it to all values.\n * To complicate things nodeOrigin has to be taken into account as well. This is done by offsetting the nodes as if their origin is [0, 0],\n * then calculating the restrictions as usual\n * @param startValues - starting values of resize\n * @param controlDirection - dimensions affected by the resize\n * @param pointerPosition - the current pointer position corrected for snapping\n * @param boundaries - minimum and maximum dimensions of the node\n * @param keepAspectRatio - prevent changes of asprect ratio\n * @returns x, y, width and height of the node after resize\n */\nfunction getDimensionsAfterResize(startValues, controlDirection, pointerPosition, boundaries, keepAspectRatio, nodeOrigin, extent, childExtent) {\n    let { affectsX, affectsY } = controlDirection;\n    const { isHorizontal, isVertical } = controlDirection;\n    const isDiagonal = isHorizontal && isVertical;\n    const { xSnapped, ySnapped } = pointerPosition;\n    const { minWidth, maxWidth, minHeight, maxHeight } = boundaries;\n    const { x: startX, y: startY, width: startWidth, height: startHeight, aspectRatio } = startValues;\n    let distX = Math.floor(isHorizontal ? xSnapped - startValues.pointerX : 0);\n    let distY = Math.floor(isVertical ? ySnapped - startValues.pointerY : 0);\n    const newWidth = startWidth + (affectsX ? -distX : distX);\n    const newHeight = startHeight + (affectsY ? -distY : distY);\n    const originOffsetX = -nodeOrigin[0] * startWidth;\n    const originOffsetY = -nodeOrigin[1] * startHeight;\n    // Check if maxWidth, minWWidth, maxHeight, minHeight are restricting the resize\n    let clampX = getSizeClamp(newWidth, minWidth, maxWidth);\n    let clampY = getSizeClamp(newHeight, minHeight, maxHeight);\n    // Check if extent is restricting the resize\n    if (extent) {\n        let xExtentClamp = 0;\n        let yExtentClamp = 0;\n        if (affectsX && distX < 0) {\n            xExtentClamp = getLowerExtentClamp(startX + distX + originOffsetX, extent[0][0]);\n        }\n        else if (!affectsX && distX > 0) {\n            xExtentClamp = getUpperExtentClamp(startX + newWidth + originOffsetX, extent[1][0]);\n        }\n        if (affectsY && distY < 0) {\n            yExtentClamp = getLowerExtentClamp(startY + distY + originOffsetY, extent[0][1]);\n        }\n        else if (!affectsY && distY > 0) {\n            yExtentClamp = getUpperExtentClamp(startY + newHeight + originOffsetY, extent[1][1]);\n        }\n        clampX = Math.max(clampX, xExtentClamp);\n        clampY = Math.max(clampY, yExtentClamp);\n    }\n    // Check if the child extent is restricting the resize\n    if (childExtent) {\n        let xExtentClamp = 0;\n        let yExtentClamp = 0;\n        if (affectsX && distX > 0) {\n            xExtentClamp = getUpperExtentClamp(startX + distX, childExtent[0][0]);\n        }\n        else if (!affectsX && distX < 0) {\n            xExtentClamp = getLowerExtentClamp(startX + newWidth, childExtent[1][0]);\n        }\n        if (affectsY && distY > 0) {\n            yExtentClamp = getUpperExtentClamp(startY + distY, childExtent[0][1]);\n        }\n        else if (!affectsY && distY < 0) {\n            yExtentClamp = getLowerExtentClamp(startY + newHeight, childExtent[1][1]);\n        }\n        clampX = Math.max(clampX, xExtentClamp);\n        clampY = Math.max(clampY, yExtentClamp);\n    }\n    // Check if the aspect ratio resizing of the other side is restricting the resize\n    if (keepAspectRatio) {\n        if (isHorizontal) {\n            // Check if the max dimensions might be restricting the resize\n            const aspectHeightClamp = getSizeClamp(newWidth / aspectRatio, minHeight, maxHeight) * aspectRatio;\n            clampX = Math.max(clampX, aspectHeightClamp);\n            // Check if the extent is restricting the resize\n            if (extent) {\n                let aspectExtentClamp = 0;\n                if ((!affectsX && !affectsY) || (affectsX && !affectsY && isDiagonal)) {\n                    aspectExtentClamp =\n                        getUpperExtentClamp(startY + originOffsetY + newWidth / aspectRatio, extent[1][1]) * aspectRatio;\n                }\n                else {\n                    aspectExtentClamp =\n                        getLowerExtentClamp(startY + originOffsetY + (affectsX ? distX : -distX) / aspectRatio, extent[0][1]) *\n                            aspectRatio;\n                }\n                clampX = Math.max(clampX, aspectExtentClamp);\n            }\n            // Check if the child extent is restricting the resize\n            if (childExtent) {\n                let aspectExtentClamp = 0;\n                if ((!affectsX && !affectsY) || (affectsX && !affectsY && isDiagonal)) {\n                    aspectExtentClamp = getLowerExtentClamp(startY + newWidth / aspectRatio, childExtent[1][1]) * aspectRatio;\n                }\n                else {\n                    aspectExtentClamp =\n                        getUpperExtentClamp(startY + (affectsX ? distX : -distX) / aspectRatio, childExtent[0][1]) * aspectRatio;\n                }\n                clampX = Math.max(clampX, aspectExtentClamp);\n            }\n        }\n        // Do the same thing for vertical resizing\n        if (isVertical) {\n            const aspectWidthClamp = getSizeClamp(newHeight * aspectRatio, minWidth, maxWidth) / aspectRatio;\n            clampY = Math.max(clampY, aspectWidthClamp);\n            if (extent) {\n                let aspectExtentClamp = 0;\n                if ((!affectsX && !affectsY) || (affectsY && !affectsX && isDiagonal)) {\n                    aspectExtentClamp =\n                        getUpperExtentClamp(startX + newHeight * aspectRatio + originOffsetX, extent[1][0]) / aspectRatio;\n                }\n                else {\n                    aspectExtentClamp =\n                        getLowerExtentClamp(startX + (affectsY ? distY : -distY) * aspectRatio + originOffsetX, extent[0][0]) /\n                            aspectRatio;\n                }\n                clampY = Math.max(clampY, aspectExtentClamp);\n            }\n            if (childExtent) {\n                let aspectExtentClamp = 0;\n                if ((!affectsX && !affectsY) || (affectsY && !affectsX && isDiagonal)) {\n                    aspectExtentClamp = getLowerExtentClamp(startX + newHeight * aspectRatio, childExtent[1][0]) / aspectRatio;\n                }\n                else {\n                    aspectExtentClamp =\n                        getUpperExtentClamp(startX + (affectsY ? distY : -distY) * aspectRatio, childExtent[0][0]) / aspectRatio;\n                }\n                clampY = Math.max(clampY, aspectExtentClamp);\n            }\n        }\n    }\n    distY = distY + (distY < 0 ? clampY : -clampY);\n    distX = distX + (distX < 0 ? clampX : -clampX);\n    if (keepAspectRatio) {\n        if (isDiagonal) {\n            if (newWidth > newHeight * aspectRatio) {\n                distY = (xor(affectsX, affectsY) ? -distX : distX) / aspectRatio;\n            }\n            else {\n                distX = (xor(affectsX, affectsY) ? -distY : distY) * aspectRatio;\n            }\n        }\n        else {\n            if (isHorizontal) {\n                distY = distX / aspectRatio;\n                affectsY = affectsX;\n            }\n            else {\n                distX = distY * aspectRatio;\n                affectsX = affectsY;\n            }\n        }\n    }\n    const x = affectsX ? startX + distX : startX;\n    const y = affectsY ? startY + distY : startY;\n    return {\n        width: startWidth + (affectsX ? -distX : distX),\n        height: startHeight + (affectsY ? -distY : distY),\n        x: nodeOrigin[0] * distX * (!affectsX ? 1 : -1) + x,\n        y: nodeOrigin[1] * distY * (!affectsY ? 1 : -1) + y,\n    };\n}\n\nconst initPrevValues = { width: 0, height: 0, x: 0, y: 0 };\nconst initStartValues = {\n    ...initPrevValues,\n    pointerX: 0,\n    pointerY: 0,\n    aspectRatio: 1,\n};\nfunction nodeToParentExtent(node) {\n    return [\n        [0, 0],\n        [node.measured.width, node.measured.height],\n    ];\n}\nfunction nodeToChildExtent(child, parent, nodeOrigin) {\n    const x = parent.position.x + child.position.x;\n    const y = parent.position.y + child.position.y;\n    const width = child.measured.width ?? 0;\n    const height = child.measured.height ?? 0;\n    const originOffsetX = nodeOrigin[0] * width;\n    const originOffsetY = nodeOrigin[1] * height;\n    return [\n        [x - originOffsetX, y - originOffsetY],\n        [x + width - originOffsetX, y + height - originOffsetY],\n    ];\n}\nfunction XYResizer({ domNode, nodeId, getStoreItems, onChange, onEnd }) {\n    const selection = select(domNode);\n    function update({ controlPosition, boundaries, keepAspectRatio, resizeDirection, onResizeStart, onResize, onResizeEnd, shouldResize, }) {\n        let prevValues = { ...initPrevValues };\n        let startValues = { ...initStartValues };\n        const controlDirection = getControlDirection(controlPosition);\n        let node = undefined;\n        let containerBounds = null;\n        let childNodes = [];\n        let parentNode = undefined; // Needed to fix expandParent\n        let parentExtent = undefined;\n        let childExtent = undefined;\n        const dragHandler = drag()\n            .on('start', (event) => {\n            const { nodeLookup, transform, snapGrid, snapToGrid, nodeOrigin, paneDomNode } = getStoreItems();\n            node = nodeLookup.get(nodeId);\n            if (!node) {\n                return;\n            }\n            containerBounds = paneDomNode?.getBoundingClientRect() ?? null;\n            const { xSnapped, ySnapped } = getPointerPosition(event.sourceEvent, {\n                transform,\n                snapGrid,\n                snapToGrid,\n                containerBounds,\n            });\n            prevValues = {\n                width: node.measured.width ?? 0,\n                height: node.measured.height ?? 0,\n                x: node.position.x ?? 0,\n                y: node.position.y ?? 0,\n            };\n            startValues = {\n                ...prevValues,\n                pointerX: xSnapped,\n                pointerY: ySnapped,\n                aspectRatio: prevValues.width / prevValues.height,\n            };\n            parentNode = undefined;\n            if (node.parentId && (node.extent === 'parent' || node.expandParent)) {\n                parentNode = nodeLookup.get(node.parentId);\n                parentExtent = parentNode && node.extent === 'parent' ? nodeToParentExtent(parentNode) : undefined;\n            }\n            /*\n             * Collect all child nodes to correct their relative positions when top/left changes\n             * Determine largest minimal extent the parent node is allowed to resize to\n             */\n            childNodes = [];\n            childExtent = undefined;\n            for (const [childId, child] of nodeLookup) {\n                if (child.parentId === nodeId) {\n                    childNodes.push({\n                        id: childId,\n                        position: { ...child.position },\n                        extent: child.extent,\n                    });\n                    if (child.extent === 'parent' || child.expandParent) {\n                        const extent = nodeToChildExtent(child, node, child.origin ?? nodeOrigin);\n                        if (childExtent) {\n                            childExtent = [\n                                [Math.min(extent[0][0], childExtent[0][0]), Math.min(extent[0][1], childExtent[0][1])],\n                                [Math.max(extent[1][0], childExtent[1][0]), Math.max(extent[1][1], childExtent[1][1])],\n                            ];\n                        }\n                        else {\n                            childExtent = extent;\n                        }\n                    }\n                }\n            }\n            onResizeStart?.(event, { ...prevValues });\n        })\n            .on('drag', (event) => {\n            const { transform, snapGrid, snapToGrid, nodeOrigin: storeNodeOrigin } = getStoreItems();\n            const pointerPosition = getPointerPosition(event.sourceEvent, {\n                transform,\n                snapGrid,\n                snapToGrid,\n                containerBounds,\n            });\n            const childChanges = [];\n            if (!node) {\n                return;\n            }\n            const { x: prevX, y: prevY, width: prevWidth, height: prevHeight } = prevValues;\n            const change = {};\n            const nodeOrigin = node.origin ?? storeNodeOrigin;\n            const { width, height, x, y } = getDimensionsAfterResize(startValues, controlDirection, pointerPosition, boundaries, keepAspectRatio, nodeOrigin, parentExtent, childExtent);\n            const isWidthChange = width !== prevWidth;\n            const isHeightChange = height !== prevHeight;\n            const isXPosChange = x !== prevX && isWidthChange;\n            const isYPosChange = y !== prevY && isHeightChange;\n            if (!isXPosChange && !isYPosChange && !isWidthChange && !isHeightChange) {\n                return;\n            }\n            if (isXPosChange || isYPosChange || nodeOrigin[0] === 1 || nodeOrigin[1] === 1) {\n                change.x = isXPosChange ? x : prevValues.x;\n                change.y = isYPosChange ? y : prevValues.y;\n                prevValues.x = change.x;\n                prevValues.y = change.y;\n                /*\n                 * when top/left changes, correct the relative positions of child nodes\n                 * so that they stay in the same position\n                 */\n                if (childNodes.length > 0) {\n                    const xChange = x - prevX;\n                    const yChange = y - prevY;\n                    for (const childNode of childNodes) {\n                        childNode.position = {\n                            x: childNode.position.x - xChange + nodeOrigin[0] * (width - prevWidth),\n                            y: childNode.position.y - yChange + nodeOrigin[1] * (height - prevHeight),\n                        };\n                        childChanges.push(childNode);\n                    }\n                }\n            }\n            if (isWidthChange || isHeightChange) {\n                change.width =\n                    isWidthChange && (!resizeDirection || resizeDirection === 'horizontal') ? width : prevValues.width;\n                change.height =\n                    isHeightChange && (!resizeDirection || resizeDirection === 'vertical') ? height : prevValues.height;\n                prevValues.width = change.width;\n                prevValues.height = change.height;\n            }\n            // Fix expandParent when resizing from top/left\n            if (parentNode && node.expandParent) {\n                const xLimit = nodeOrigin[0] * (change.width ?? 0);\n                if (change.x && change.x < xLimit) {\n                    prevValues.x = xLimit;\n                    startValues.x = startValues.x - (change.x - xLimit);\n                }\n                const yLimit = nodeOrigin[1] * (change.height ?? 0);\n                if (change.y && change.y < yLimit) {\n                    prevValues.y = yLimit;\n                    startValues.y = startValues.y - (change.y - yLimit);\n                }\n            }\n            const direction = getResizeDirection({\n                width: prevValues.width,\n                prevWidth,\n                height: prevValues.height,\n                prevHeight,\n                affectsX: controlDirection.affectsX,\n                affectsY: controlDirection.affectsY,\n            });\n            const nextValues = { ...prevValues, direction };\n            const callResize = shouldResize?.(event, nextValues);\n            if (callResize === false) {\n                return;\n            }\n            onResize?.(event, nextValues);\n            onChange(change, childChanges);\n        })\n            .on('end', (event) => {\n            onResizeEnd?.(event, { ...prevValues });\n            onEnd?.({ ...prevValues });\n        });\n        selection.call(dragHandler);\n    }\n    function destroy() {\n        selection.on('.drag', null);\n    }\n    return {\n        update,\n        destroy,\n    };\n}\n\nexport { ConnectionLineType, ConnectionMode, MarkerType, PanOnScrollMode, Position, ResizeControlVariant, SelectionMode, XYDrag, XYHandle, XYMinimap, XYPanZoom, XYResizer, XY_RESIZER_HANDLE_POSITIONS, XY_RESIZER_LINE_POSITIONS, addEdge, adoptUserNodes, areConnectionMapsEqual, areSetsEqual, boxToRect, calcAutoPan, calculateNodePosition, clamp, clampPosition, clampPositionToParent, createMarkerIds, devWarn, elementSelectionKeys, errorMessages, evaluateAbsolutePosition, fitViewport, getBezierEdgeCenter, getBezierPath, getBoundsOfBoxes, getBoundsOfRects, getConnectedEdges, getConnectionStatus, getDimensions, getEdgeCenter, getEdgePosition, getElementsToRemove, getElevatedEdgeZIndex, getEventPosition, getHandleBounds, getHandlePosition, getHostForElement, getIncomers, getInternalNodesBounds, getMarkerId, getNodeDimensions, getNodePositionWithOrigin, getNodeToolbarTransform, getNodesBounds, getNodesInside, getOutgoers, getOverlappingArea, getPointerPosition, getSmoothStepPath, getStraightPath, getViewportForBounds, handleConnectionChange, handleExpandParent, infiniteExtent, initialConnection, isCoordinateExtent, isEdgeBase, isEdgeVisible, isInputDOMNode, isInternalNodeBase, isMacOs, isMouseEvent, isNodeBase, isNumeric, isRectObject, nodeHasDimensions, nodeToBox, nodeToRect, oppositePosition, panBy, pointToRendererPoint, reconnectEdge, rectToBox, rendererPointToPoint, shallowNodeData, snapPosition, updateAbsolutePositions, updateConnectionLookup, updateNodeInternals, withResolvers };\n","<script>import { getContext } from 'svelte';\nimport cc from 'classcat';\nimport { Position, XYHandle, isMouseEvent, areConnectionMapsEqual, handleConnectionChange, ConnectionMode } from '@xyflow/system';\nimport { useStore } from '../../store';\nexport let id = undefined;\nexport let type = 'source';\nexport let position = Position.Top;\nexport let style = undefined;\nexport let isValidConnection = undefined;\nexport let onconnect = undefined;\nexport let ondisconnect = undefined;\n// @todo implement connectablestart, connectableend\n// export let isConnectableStart: $$Props['isConnectableStart'] = undefined;\n// export let isConnectableEnd: $$Props['isConnectableEnd'] = undefined;\nlet isConnectableProp = undefined;\nexport { isConnectableProp as isConnectable };\nlet className = undefined;\nexport { className as class };\n$: isTarget = type === 'target';\nconst nodeId = getContext('svelteflow__node_id');\nconst connectable = getContext('svelteflow__node_connectable');\n$: isConnectable = isConnectableProp !== undefined ? isConnectableProp : $connectable;\n$: handleId = id || null;\nconst store = useStore();\nconst { connectionMode, domNode, nodeLookup, connectionRadius, viewport, isValidConnection: isValidConnectionStore, lib, addEdge, onedgecreate, panBy, cancelConnection, updateConnection, autoPanOnConnect, edges, connectionLookup, onconnect: onConnectAction, onconnectstart: onConnectStartAction, onconnectend: onConnectEndAction, flowId, connection } = store;\nfunction onPointerDown(event) {\n    const isMouseTriggered = isMouseEvent(event);\n    if ((isMouseTriggered && event.button === 0) || !isMouseTriggered) {\n        XYHandle.onPointerDown(event, {\n            handleId,\n            nodeId,\n            isTarget,\n            connectionRadius: $connectionRadius,\n            domNode: $domNode,\n            nodeLookup: $nodeLookup,\n            connectionMode: $connectionMode,\n            lib: $lib,\n            autoPanOnConnect: $autoPanOnConnect,\n            flowId: $flowId,\n            isValidConnection: isValidConnection ?? $isValidConnectionStore,\n            updateConnection,\n            cancelConnection,\n            panBy,\n            onConnect: (connection) => {\n                const edge = $onedgecreate ? $onedgecreate(connection) : connection;\n                if (!edge) {\n                    return;\n                }\n                addEdge(edge);\n                $onConnectAction?.(connection);\n            },\n            onConnectStart: (event, startParams) => {\n                $onConnectStartAction?.(event, {\n                    nodeId: startParams.nodeId,\n                    handleId: startParams.handleId,\n                    handleType: startParams.handleType\n                });\n            },\n            onConnectEnd: (event, connectionState) => {\n                $onConnectEndAction?.(event, connectionState);\n            },\n            getTransform: () => [$viewport.x, $viewport.y, $viewport.zoom],\n            getFromHandle: () => $connection.fromHandle\n        });\n    }\n}\nlet prevConnections = null;\nlet connections;\n$: if (onconnect || ondisconnect) {\n    // connectionLookup is not reactive, so we use edges to get notified about updates\n    $edges;\n    connections = $connectionLookup.get(`${nodeId}-${type}${id ? `-${id}` : ''}`);\n}\n$: {\n    if (prevConnections && !areConnectionMapsEqual(connections, prevConnections)) {\n        const _connections = connections ?? new Map();\n        handleConnectionChange(prevConnections, _connections, ondisconnect);\n        handleConnectionChange(_connections, prevConnections, onconnect);\n    }\n    prevConnections = connections ?? new Map();\n}\n$: connectionInProcess = !!$connection.fromHandle;\n$: connectingFrom =\n    $connection.fromHandle?.nodeId === nodeId &&\n        $connection.fromHandle?.type === type &&\n        $connection.fromHandle?.id === handleId;\n$: connectingTo =\n    $connection.toHandle?.nodeId === nodeId &&\n        $connection.toHandle?.type === type &&\n        $connection.toHandle?.id === handleId;\n$: isPossibleEndHandle =\n    $connectionMode === ConnectionMode.Strict\n        ? $connection.fromHandle?.type !== type\n        : nodeId !== $connection.fromHandle?.nodeId || handleId !== $connection.fromHandle?.id;\n$: valid = connectingTo && $connection.isValid;\n</script>\n\n<!--\n@component\nThe Handle component is the part of a node that can be used to connect nodes.\n-->\n<div\n  data-handleid={handleId}\n  data-nodeid={nodeId}\n  data-handlepos={position}\n  data-id=\"{$flowId}-{nodeId}-{id || null}-{type}\"\n  class={cc([\n    'svelte-flow__handle',\n    `svelte-flow__handle-${position}`,\n    'nodrag',\n    'nopan',\n    position,\n    className\n  ])}\n  class:valid\n  class:connectingto={connectingTo}\n  class:connectingfrom={connectingFrom}\n  class:source={!isTarget}\n  class:target={isTarget}\n  class:connectablestart={isConnectable}\n  class:connectableend={isConnectable}\n  class:connectable={isConnectable}\n  class:connectionindicator={isConnectable && (!connectionInProcess || isPossibleEndHandle)}\n  on:mousedown={onPointerDown}\n  on:touchstart={onPointerDown}\n  {style}\n  role=\"button\"\n  tabindex=\"-1\"\n>\n  <slot />\n</div>\n","<script>import { Position } from '@xyflow/system';\nimport { Handle } from '../Handle';\nexport let data = { label: 'Node' };\nexport let targetPosition = undefined;\nexport let sourcePosition = undefined;\n// this is a workaround for suppressing the warning about unused props\n$$restProps;\n</script>\n\n<Handle type=\"target\" position={targetPosition ?? Position.Top} />\n{data?.label}\n<Handle type=\"source\" position={sourcePosition ?? Position.Bottom} />\n","<script>import { Position } from '@xyflow/system';\nimport { Handle } from '../Handle';\nexport let data = { label: 'Node' };\nexport let sourcePosition = undefined;\n// this is a workaround for suppressing the warning about unused props\n$$restProps;\n</script>\n\n{data?.label}\n<Handle type=\"source\" position={sourcePosition ?? Position.Bottom} />\n","<script>import { Position } from '@xyflow/system';\nimport { Handle } from '../Handle';\nexport let data = { label: 'Node' };\nexport let targetPosition = undefined;\n// this is a workaround for suppressing the warning about unused props\n$$restProps;\n</script>\n\n{data?.label}\n<Handle type=\"target\" position={targetPosition ?? Position.Top} />\n","function tryToMount(node, domNode, target) {\n    if (!domNode) {\n        return;\n    }\n    const targetEl = target ? domNode.querySelector(target) : domNode;\n    if (targetEl) {\n        targetEl.appendChild(node);\n    }\n}\nexport default function (node, { target, domNode }) {\n    tryToMount(node, domNode, target);\n    return {\n        async update({ target, domNode }) {\n            tryToMount(node, domNode, target);\n        },\n        destroy() {\n            if (node.parentNode) {\n                node.parentNode.removeChild(node);\n            }\n        }\n    };\n}\n","<script>import portal from '../../actions/portal';\nimport { useStore } from '../../store';\nconst { domNode } = useStore();\n</script>\n\n<div use:portal={{ target: '.svelte-flow__edgelabel-renderer', domNode: $domNode }}>\n  <slot />\n</div>\n","import { get } from 'svelte/store';\nimport { errorMessages } from '@xyflow/system';\nimport { useStore } from '../store';\nexport function useHandleEdgeSelect() {\n    const { edgeLookup, selectionRect, selectionRectMode, multiselectionKeyPressed, addSelectedEdges, unselectNodesAndEdges, elementsSelectable } = useStore();\n    return (id) => {\n        const edge = get(edgeLookup).get(id);\n        if (!edge) {\n            console.warn('012', errorMessages['error012'](id));\n            return;\n        }\n        const selectable = edge.selectable || (get(elementsSelectable) && typeof edge.selectable === 'undefined');\n        if (selectable) {\n            selectionRect.set(null);\n            selectionRectMode.set(null);\n            if (!edge.selected) {\n                addSelectedEdges([id]);\n            }\n            else if (edge.selected && get(multiselectionKeyPressed)) {\n                unselectNodesAndEdges({ nodes: [], edges: [edge] });\n            }\n        }\n    };\n}\n","<script>import { getContext } from 'svelte';\nimport { EdgeLabelRenderer } from '../EdgeLabelRenderer';\nimport { useHandleEdgeSelect } from '../../hooks/useHandleEdgeSelect';\nexport let style = undefined;\nexport let x = undefined;\nexport let y = undefined;\nconst handleEdgeSelect = useHandleEdgeSelect();\nconst id = getContext('svelteflow__edge_id');\n</script>\n\n<EdgeLabelRenderer>\n  <div\n    class=\"svelte-flow__edge-label\"\n    style:transform=\"translate(-50%, -50%) translate({x}px,{y}px)\"\n    style={'pointer-events: all;' + style}\n    role=\"button\"\n    tabindex=\"-1\"\n    on:keyup={() => {}}\n    on:click={() => {\n      if (id) handleEdgeSelect(id);\n    }}\n  >\n    <slot />\n  </div>\n</EdgeLabelRenderer>\n","<script>import cc from 'classcat';\nimport EdgeLabel from '../EdgeLabel/EdgeLabel.svelte';\nexport let id = undefined;\nexport let path;\nexport let label = undefined;\nexport let labelX = undefined;\nexport let labelY = undefined;\nexport let labelStyle = undefined;\nexport let markerStart = undefined;\nexport let markerEnd = undefined;\nexport let style = undefined;\nexport let interactionWidth = 20;\nlet className = undefined;\nexport { className as class };\nlet interactionWidthValue = interactionWidth === undefined ? 20 : interactionWidth;\n</script>\n\n<path\n  {id}\n  d={path}\n  class={cc(['svelte-flow__edge-path', className])}\n  marker-start={markerStart}\n  marker-end={markerEnd}\n  fill=\"none\"\n  {style}\n/>\n\n{#if interactionWidthValue}\n  <path\n    d={path}\n    stroke-opacity={0}\n    stroke-width={interactionWidthValue}\n    fill=\"none\"\n    class=\"svelte-flow__edge-interaction\"\n  />\n{/if}\n\n{#if label}\n  <EdgeLabel x={labelX} y={labelY} style={labelStyle}>\n    {label}\n  </EdgeLabel>\n{/if}\n","<script>import { getBezierPath } from '@xyflow/system';\nimport { BaseEdge } from '../BaseEdge';\nexport let label = undefined;\nexport let labelStyle = undefined;\nexport let style = undefined;\nexport let markerStart = undefined;\nexport let markerEnd = undefined;\nexport let interactionWidth = undefined;\nexport let sourceX;\nexport let sourceY;\nexport let sourcePosition;\nexport let targetX;\nexport let targetY;\nexport let targetPosition;\n$: [path, labelX, labelY] = getBezierPath({\n    sourceX,\n    sourceY,\n    targetX,\n    targetY,\n    sourcePosition,\n    targetPosition\n});\n// this is a workaround for suppressing the warning about unused props\n$$restProps;\n</script>\n\n<BaseEdge\n  {path}\n  {labelX}\n  {labelY}\n  {label}\n  {labelStyle}\n  {markerStart}\n  {markerEnd}\n  {interactionWidth}\n  {style}\n/>\n","<script>import { getSmoothStepPath } from '@xyflow/system';\nimport { BaseEdge } from '../BaseEdge';\nexport let label = undefined;\nexport let labelStyle = undefined;\nexport let style = undefined;\nexport let markerStart = undefined;\nexport let markerEnd = undefined;\nexport let interactionWidth = undefined;\nexport let sourceX;\nexport let sourceY;\nexport let sourcePosition;\nexport let targetX;\nexport let targetY;\nexport let targetPosition;\n$: [path, labelX, labelY] = getSmoothStepPath({\n    sourceX,\n    sourceY,\n    targetX,\n    targetY,\n    sourcePosition,\n    targetPosition\n});\n// this is a workaround for suppressing the warning about unused props\n$$restProps;\n</script>\n\n<BaseEdge\n  {path}\n  {labelX}\n  {labelY}\n  {label}\n  {labelStyle}\n  {markerStart}\n  {markerEnd}\n  {interactionWidth}\n  {style}\n/>\n","<script>import { getStraightPath } from '@xyflow/system';\nimport { BaseEdge } from '../BaseEdge';\nexport let label = undefined;\nexport let labelStyle = undefined;\nexport let style = undefined;\nexport let markerStart = undefined;\nexport let markerEnd = undefined;\nexport let interactionWidth = undefined;\nexport let sourceX;\nexport let sourceY;\nexport let targetX;\nexport let targetY;\n$: [path, labelX, labelY] = getStraightPath({\n    sourceX,\n    sourceY,\n    targetX,\n    targetY\n});\n// this is a workaround for suppressing the warning about unused props\n$$restProps;\n</script>\n\n<BaseEdge\n  {path}\n  {labelX}\n  {labelY}\n  {label}\n  {labelStyle}\n  {markerStart}\n  {markerEnd}\n  {interactionWidth}\n  {style}\n/>\n","<script>import { getSmoothStepPath } from '@xyflow/system';\nimport { BaseEdge } from '../BaseEdge';\nexport let label = undefined;\nexport let labelStyle = undefined;\nexport let style = undefined;\nexport let markerStart = undefined;\nexport let markerEnd = undefined;\nexport let interactionWidth = undefined;\nexport let sourceX;\nexport let sourceY;\nexport let sourcePosition;\nexport let targetX;\nexport let targetY;\nexport let targetPosition;\n$: [path, labelX, labelY] = getSmoothStepPath({\n    sourceX,\n    sourceY,\n    targetX,\n    targetY,\n    sourcePosition,\n    targetPosition,\n    borderRadius: 0\n});\n// this is a workaround for suppressing the warning about unused props\n$$restProps;\n</script>\n\n<BaseEdge\n  {path}\n  {labelX}\n  {labelY}\n  {label}\n  {labelStyle}\n  {markerStart}\n  {markerEnd}\n  {interactionWidth}\n  {style}\n/>\n","import { writable, get } from 'svelte/store';\nimport { adoptUserNodes, updateConnectionLookup, infiniteExtent, fitViewport, withResolvers } from '@xyflow/system';\n// we need to sync the user nodes and the internal nodes so that the user can receive the updates\n// made by Svelte Flow (like dragging or selecting a node).\nexport function syncNodeStores(nodesStore, userNodesStore) {\n    const nodesStoreSetter = nodesStore.set;\n    const userNodesStoreSetter = userNodesStore.set;\n    const currentNodesStore = get(nodesStore);\n    const currentUserNodesStore = get(userNodesStore);\n    // depending how the user initializes the nodes, we need to decide if we want to use\n    // the user nodes or the internal nodes for initialization. A user can use a SvelteFlowProvider\n    // without providing any nodes, in that case we want to use the nodes passed by the user.\n    // By default we are using the store nodes, because they already have the absolute positions.\n    const initWithUserNodes = currentNodesStore.length === 0 && currentUserNodesStore.length > 0;\n    let val = initWithUserNodes ? currentUserNodesStore : currentNodesStore;\n    nodesStore.set(val);\n    const _set = (nds) => {\n        const updatedNodes = nodesStoreSetter(nds);\n        val = updatedNodes;\n        userNodesStoreSetter(val);\n        return updatedNodes;\n    };\n    nodesStore.set = userNodesStore.set = _set;\n    nodesStore.update = userNodesStore.update = (fn) => _set(fn(val));\n}\n// same for edges\nexport function syncEdgeStores(edgesStore, userEdgesStore) {\n    const nodesStoreSetter = edgesStore.set;\n    const userEdgesStoreSetter = userEdgesStore.set;\n    let val = get(userEdgesStore);\n    edgesStore.set(val);\n    const _set = (eds) => {\n        nodesStoreSetter(eds);\n        userEdgesStoreSetter(eds);\n        val = eds;\n    };\n    edgesStore.set = userEdgesStore.set = _set;\n    edgesStore.update = userEdgesStore.update = (fn) => _set(fn(val));\n}\n// it is possible to pass a viewport store to SvelteFlow for having more control\n// if that's the case we need to sync the internal viewport with the user viewport\nexport const syncViewportStores = (panZoomStore, viewportStore, userViewportStore) => {\n    if (!userViewportStore) {\n        return;\n    }\n    const panZoom = get(panZoomStore);\n    const viewportStoreSetter = viewportStore.set;\n    const userViewportStoreSetter = userViewportStore.set;\n    let val = userViewportStore ? get(userViewportStore) : { x: 0, y: 0, zoom: 1 };\n    viewportStore.set(val);\n    viewportStore.set = (vp) => {\n        viewportStoreSetter(vp);\n        userViewportStoreSetter(vp);\n        val = vp;\n        return vp;\n    };\n    userViewportStore.set = (vp) => {\n        panZoom?.syncViewport(vp);\n        viewportStoreSetter(vp);\n        userViewportStoreSetter(vp);\n        val = vp;\n        return vp;\n    };\n    viewportStore.update = (fn) => {\n        viewportStore.set(fn(val));\n    };\n    userViewportStore.update = (fn) => {\n        userViewportStore.set(fn(val));\n    };\n};\n// we are creating a custom store for the internals nodes in order to update the zIndex and positionAbsolute.\n// The user only passes in relative positions, so we need to calculate the absolute positions based on the parent nodes.\nexport const createNodesStore = (nodes, nodeLookup, parentLookup, nodeOrigin = [0, 0], nodeExtent = infiniteExtent, fitViewQueued, fitViewOptions, fitViewResolver, panZoom, width, height, minZoom, maxZoom) => {\n    const { subscribe, set, update } = writable([]);\n    let value = nodes;\n    let defaults = {};\n    let elevateNodesOnSelect = true;\n    const _set = (nds) => {\n        const nodesInitialized = adoptUserNodes(nds, nodeLookup, parentLookup, {\n            elevateNodesOnSelect,\n            nodeOrigin,\n            nodeExtent,\n            defaults,\n            checkEquality: false\n        });\n        if (get(fitViewQueued) && nodesInitialized && get(panZoom)) {\n            const fitViewPromise = fitViewport({\n                nodes: nodeLookup,\n                width: get(width),\n                height: get(height),\n                panZoom: get(panZoom),\n                minZoom: get(minZoom),\n                maxZoom: get(maxZoom)\n            }, get(fitViewOptions));\n            fitViewPromise.then((value) => {\n                get(fitViewResolver)?.resolve(value);\n                fitViewResolver.set(null);\n            });\n            fitViewQueued.set(false);\n            fitViewOptions.set(undefined);\n        }\n        value = nds;\n        set(value);\n        return value;\n    };\n    const _update = (fn) => _set(fn(value));\n    const setDefaultOptions = (options) => {\n        defaults = options;\n    };\n    const setOptions = (options) => {\n        elevateNodesOnSelect = options.elevateNodesOnSelect ?? elevateNodesOnSelect;\n    };\n    _set(value);\n    return {\n        subscribe,\n        set: _set,\n        update: _update,\n        setDefaultOptions,\n        setOptions\n    };\n};\nexport const createEdgesStore = (edges, connectionLookup, edgeLookup, defaultOptions) => {\n    const { subscribe, set, update } = writable([]);\n    let value = edges;\n    let defaults = defaultOptions || {};\n    const _set = (eds) => {\n        const nextEdges = defaults ? eds.map((edge) => ({ ...defaults, ...edge })) : eds;\n        updateConnectionLookup(connectionLookup, edgeLookup, nextEdges);\n        value = nextEdges;\n        set(value);\n    };\n    const _update = (fn) => _set(fn(value));\n    const setDefaultOptions = (options) => {\n        defaults = options;\n    };\n    _set(value);\n    return {\n        subscribe,\n        set: _set,\n        update: _update,\n        setDefaultOptions\n    };\n};\n","import { readable, writable } from 'svelte/store';\nimport { infiniteExtent, SelectionMode, ConnectionMode, ConnectionLineType, devWarn, adoptUserNodes, getViewportForBounds, updateConnectionLookup, initialConnection, getInternalNodesBounds, withResolvers } from '@xyflow/system';\nimport DefaultNode from '../components/nodes/DefaultNode.svelte';\nimport InputNode from '../components/nodes/InputNode.svelte';\nimport OutputNode from '../components/nodes/OutputNode.svelte';\nimport GroupNode from '../components/nodes/GroupNode.svelte';\nimport { BezierEdgeInternal, SmoothStepEdgeInternal, StraightEdgeInternal, StepEdgeInternal } from '../components/edges';\nimport { createNodesStore, createEdgesStore } from './utils';\nexport const initialNodeTypes = {\n    input: InputNode,\n    output: OutputNode,\n    default: DefaultNode,\n    group: GroupNode\n};\nexport const initialEdgeTypes = {\n    straight: StraightEdgeInternal,\n    smoothstep: SmoothStepEdgeInternal,\n    default: BezierEdgeInternal,\n    step: StepEdgeInternal\n};\nexport const getInitialStore = ({ nodes = [], edges = [], width, height, fitView, nodeOrigin, nodeExtent }) => {\n    const nodeLookup = new Map();\n    const parentLookup = new Map();\n    const connectionLookup = new Map();\n    const edgeLookup = new Map();\n    const storeNodeOrigin = nodeOrigin ?? [0, 0];\n    const storeNodeExtent = nodeExtent ?? infiniteExtent;\n    adoptUserNodes(nodes, nodeLookup, parentLookup, {\n        nodeExtent: storeNodeExtent,\n        nodeOrigin: storeNodeOrigin,\n        elevateNodesOnSelect: false,\n        checkEquality: false\n    });\n    updateConnectionLookup(connectionLookup, edgeLookup, edges);\n    let viewport = { x: 0, y: 0, zoom: 1 };\n    if (fitView && width && height) {\n        const bounds = getInternalNodesBounds(nodeLookup, {\n            filter: (node) => !!((node.width || node.initialWidth) && (node.height || node.initialHeight))\n        });\n        viewport = getViewportForBounds(bounds, width, height, 0.5, 2, 0.1);\n    }\n    const fitViewQueued = writable(false);\n    const fitViewOptions = writable(undefined);\n    const fitViewResolver = writable(null);\n    const panZoom = writable(null);\n    const widthStore = writable(500);\n    const heightStore = writable(500);\n    const minZoom = writable(0.5);\n    const maxZoom = writable(2);\n    return {\n        flowId: writable(null),\n        nodes: createNodesStore(nodes, nodeLookup, parentLookup, storeNodeOrigin, storeNodeExtent, fitViewQueued, fitViewOptions, fitViewResolver, panZoom, widthStore, heightStore, minZoom, maxZoom),\n        nodeLookup: readable(nodeLookup),\n        parentLookup: readable(parentLookup),\n        edgeLookup: readable(edgeLookup),\n        visibleNodes: readable([]),\n        edges: createEdgesStore(edges, connectionLookup, edgeLookup),\n        visibleEdges: readable([]),\n        connectionLookup: readable(connectionLookup),\n        width: widthStore,\n        height: heightStore,\n        minZoom,\n        maxZoom,\n        nodeOrigin: writable(storeNodeOrigin),\n        nodeDragThreshold: writable(1),\n        nodeExtent: writable(storeNodeExtent),\n        translateExtent: writable(infiniteExtent),\n        autoPanOnNodeDrag: writable(true),\n        autoPanOnConnect: writable(true),\n        fitViewQueued,\n        fitViewOptions,\n        fitViewResolver,\n        panZoom,\n        snapGrid: writable(null),\n        dragging: writable(false),\n        selectionRect: writable(null),\n        selectionKeyPressed: writable(false),\n        multiselectionKeyPressed: writable(false),\n        deleteKeyPressed: writable(false),\n        panActivationKeyPressed: writable(false),\n        zoomActivationKeyPressed: writable(false),\n        selectionRectMode: writable(null),\n        selectionMode: writable(SelectionMode.Partial),\n        nodeTypes: writable(initialNodeTypes),\n        edgeTypes: writable(initialEdgeTypes),\n        viewport: writable(viewport),\n        connectionMode: writable(ConnectionMode.Strict),\n        domNode: writable(null),\n        connection: readable(initialConnection),\n        connectionLineType: writable(ConnectionLineType.Bezier),\n        connectionRadius: writable(20),\n        isValidConnection: writable(() => true),\n        nodesDraggable: writable(true),\n        nodesConnectable: writable(true),\n        elementsSelectable: writable(true),\n        selectNodesOnDrag: writable(true),\n        markers: readable([]),\n        defaultMarkerColor: writable('#b1b1b7'),\n        lib: readable('svelte'),\n        onlyRenderVisibleElements: writable(false),\n        onerror: writable(devWarn),\n        ondelete: writable(undefined),\n        onedgecreate: writable(undefined),\n        onconnect: writable(undefined),\n        onconnectstart: writable(undefined),\n        onconnectend: writable(undefined),\n        onbeforedelete: writable(undefined),\n        nodesInitialized: writable(false),\n        edgesInitialized: writable(false),\n        viewportInitialized: writable(false),\n        initialized: readable(false)\n    };\n};\n","import { derived } from 'svelte/store';\nimport { isEdgeVisible, getEdgePosition, getElevatedEdgeZIndex } from '@xyflow/system';\nexport function getVisibleEdges(store) {\n    const visibleEdges = derived([\n        store.edges,\n        store.nodes,\n        store.nodeLookup,\n        store.onlyRenderVisibleElements,\n        store.viewport,\n        store.width,\n        store.height\n    ], ([edges, , nodeLookup, onlyRenderVisibleElements, viewport, width, height]) => {\n        const visibleEdges = onlyRenderVisibleElements && width && height\n            ? edges.filter((edge) => {\n                const sourceNode = nodeLookup.get(edge.source);\n                const targetNode = nodeLookup.get(edge.target);\n                return (sourceNode &&\n                    targetNode &&\n                    isEdgeVisible({\n                        sourceNode,\n                        targetNode,\n                        width,\n                        height,\n                        transform: [viewport.x, viewport.y, viewport.zoom]\n                    }));\n            })\n            : edges;\n        return visibleEdges;\n    });\n    return derived([visibleEdges, store.nodes, store.nodeLookup, store.connectionMode, store.onerror], ([visibleEdges, , nodeLookup, connectionMode, onerror]) => {\n        const layoutedEdges = visibleEdges.reduce((res, edge) => {\n            const sourceNode = nodeLookup.get(edge.source);\n            const targetNode = nodeLookup.get(edge.target);\n            if (!sourceNode || !targetNode) {\n                return res;\n            }\n            const edgePosition = getEdgePosition({\n                id: edge.id,\n                sourceNode,\n                targetNode,\n                sourceHandle: edge.sourceHandle || null,\n                targetHandle: edge.targetHandle || null,\n                connectionMode,\n                onError: onerror\n            });\n            if (edgePosition) {\n                res.push({\n                    ...edge,\n                    zIndex: getElevatedEdgeZIndex({\n                        selected: edge.selected,\n                        zIndex: edge.zIndex,\n                        sourceNode,\n                        targetNode,\n                        elevateOnSelect: false\n                    }),\n                    ...edgePosition\n                });\n            }\n            return res;\n        }, []);\n        return layoutedEdges;\n    });\n}\n","import { derived } from 'svelte/store';\nimport { getNodesInside } from '@xyflow/system';\nexport function getVisibleNodes(store) {\n    return derived([\n        store.nodeLookup,\n        store.onlyRenderVisibleElements,\n        store.width,\n        store.height,\n        store.viewport,\n        store.nodes\n    ], ([nodeLookup, onlyRenderVisibleElements, width, height, viewport]) => {\n        const transform = [viewport.x, viewport.y, viewport.zoom];\n        return onlyRenderVisibleElements\n            ? getNodesInside(nodeLookup, { x: 0, y: 0, width, height }, transform, true)\n            : Array.from(nodeLookup.values());\n    });\n}\n","import { getContext, setContext } from 'svelte';\nimport { derived, get, writable } from 'svelte/store';\nimport { createMarkerIds, getElementsToRemove, panBy as panBySystem, updateNodeInternals as updateNodeInternalsSystem, addEdge as addEdgeUtil, initialConnection, errorMessages, pointToRendererPoint, updateAbsolutePositions, withResolvers } from '@xyflow/system';\nimport { initialEdgeTypes, initialNodeTypes, getInitialStore } from './initial-store';\nimport { syncNodeStores, syncEdgeStores, syncViewportStores } from './utils';\nimport { getVisibleEdges } from './visible-edges';\nimport { getVisibleNodes } from './visible-nodes';\nexport const key = Symbol();\nexport function createStore({ nodes, edges, width, height, fitView: fitViewOnCreate, nodeOrigin, nodeExtent }) {\n    const store = getInitialStore({\n        nodes,\n        edges,\n        width,\n        height,\n        fitView: fitViewOnCreate,\n        nodeOrigin,\n        nodeExtent\n    });\n    function setNodeTypes(nodeTypes) {\n        store.nodeTypes.set({\n            ...initialNodeTypes,\n            ...nodeTypes\n        });\n    }\n    function setEdgeTypes(edgeTypes) {\n        store.edgeTypes.set({\n            ...initialEdgeTypes,\n            ...edgeTypes\n        });\n    }\n    function addEdge(edgeParams) {\n        const edges = get(store.edges);\n        store.edges.set(addEdgeUtil(edgeParams, edges));\n    }\n    const updateNodePositions = (nodeDragItems, dragging = false) => {\n        const nodeLookup = get(store.nodeLookup);\n        for (const [id, dragItem] of nodeDragItems) {\n            const node = nodeLookup.get(id)?.internals.userNode;\n            if (!node) {\n                continue;\n            }\n            node.position = dragItem.position;\n            node.dragging = dragging;\n        }\n        store.nodes.update((nds) => nds);\n    };\n    function updateNodeInternals(updates) {\n        const nodeLookup = get(store.nodeLookup);\n        const parentLookup = get(store.parentLookup);\n        const { changes, updatedInternals } = updateNodeInternalsSystem(updates, nodeLookup, get(store.parentLookup), get(store.domNode), get(store.nodeOrigin));\n        if (!updatedInternals) {\n            return;\n        }\n        updateAbsolutePositions(nodeLookup, parentLookup, { nodeOrigin, nodeExtent });\n        for (const change of changes) {\n            const node = nodeLookup.get(change.id)?.internals.userNode;\n            if (!node) {\n                continue;\n            }\n            switch (change.type) {\n                case 'dimensions': {\n                    const measured = { ...node.measured, ...change.dimensions };\n                    if (change.setAttributes) {\n                        node.width = change.dimensions?.width ?? node.width;\n                        node.height = change.dimensions?.height ?? node.height;\n                    }\n                    node.measured = measured;\n                    break;\n                }\n                case 'position':\n                    node.position = change.position ?? node.position;\n                    break;\n            }\n        }\n        store.nodes.update((nds) => nds);\n        if (!get(store.nodesInitialized)) {\n            store.nodesInitialized.set(true);\n        }\n    }\n    function fitView(options) {\n        // We either create a new Promise or reuse the existing one\n        // Even if fitView is called multiple times in a row, we only end up with a single Promise\n        const fitViewResolver = get(store.fitViewResolver) ?? withResolvers();\n        // We schedule a fitView by setting fitViewQueued and triggering a setNodes\n        store.fitViewQueued.set(true);\n        store.fitViewOptions.set(options);\n        store.fitViewResolver.set(fitViewResolver);\n        store.nodes.set(get(store.nodes));\n        return fitViewResolver.promise;\n    }\n    function zoomBy(factor, options) {\n        const panZoom = get(store.panZoom);\n        if (!panZoom) {\n            return Promise.resolve(false);\n        }\n        return panZoom.scaleBy(factor, options);\n    }\n    function zoomIn(options) {\n        return zoomBy(1.2, options);\n    }\n    function zoomOut(options) {\n        return zoomBy(1 / 1.2, options);\n    }\n    function setMinZoom(minZoom) {\n        const panZoom = get(store.panZoom);\n        if (panZoom) {\n            panZoom.setScaleExtent([minZoom, get(store.maxZoom)]);\n            store.minZoom.set(minZoom);\n        }\n    }\n    function setMaxZoom(maxZoom) {\n        const panZoom = get(store.panZoom);\n        if (panZoom) {\n            panZoom.setScaleExtent([get(store.minZoom), maxZoom]);\n            store.maxZoom.set(maxZoom);\n        }\n    }\n    function setTranslateExtent(extent) {\n        const panZoom = get(store.panZoom);\n        if (panZoom) {\n            panZoom.setTranslateExtent(extent);\n            store.translateExtent.set(extent);\n        }\n    }\n    function resetSelectedElements(elements) {\n        let elementsChanged = false;\n        elements.forEach((element) => {\n            if (element.selected) {\n                element.selected = false;\n                elementsChanged = true;\n            }\n        });\n        return elementsChanged;\n    }\n    function setPaneClickDistance(distance) {\n        get(store.panZoom)?.setClickDistance(distance);\n    }\n    function unselectNodesAndEdges(params) {\n        const resetNodes = resetSelectedElements(params?.nodes || get(store.nodes));\n        if (resetNodes)\n            store.nodes.set(get(store.nodes));\n        const resetEdges = resetSelectedElements(params?.edges || get(store.edges));\n        if (resetEdges)\n            store.edges.set(get(store.edges));\n    }\n    store.deleteKeyPressed.subscribe(async (deleteKeyPressed) => {\n        if (deleteKeyPressed) {\n            const nodes = get(store.nodes);\n            const edges = get(store.edges);\n            const selectedNodes = nodes.filter((node) => node.selected);\n            const selectedEdges = edges.filter((edge) => edge.selected);\n            const { nodes: matchingNodes, edges: matchingEdges } = await getElementsToRemove({\n                nodesToRemove: selectedNodes,\n                edgesToRemove: selectedEdges,\n                nodes,\n                edges,\n                onBeforeDelete: get(store.onbeforedelete)\n            });\n            if (matchingNodes.length || matchingEdges.length) {\n                store.nodes.update((nds) => nds.filter((node) => !matchingNodes.some((mN) => mN.id === node.id)));\n                store.edges.update((eds) => eds.filter((edge) => !matchingEdges.some((mE) => mE.id === edge.id)));\n                get(store.ondelete)?.({\n                    nodes: matchingNodes,\n                    edges: matchingEdges\n                });\n            }\n        }\n    });\n    function addSelectedNodes(ids) {\n        const isMultiSelection = get(store.multiselectionKeyPressed);\n        store.nodes.update((ns) => ns.map((node) => {\n            const nodeWillBeSelected = ids.includes(node.id);\n            const selected = isMultiSelection\n                ? node.selected || nodeWillBeSelected\n                : nodeWillBeSelected;\n            // we need to mutate the node here in order to have the correct selected state in the drag handler\n            node.selected = selected;\n            return node;\n        }));\n        if (!isMultiSelection) {\n            store.edges.update((es) => es.map((edge) => {\n                edge.selected = false;\n                return edge;\n            }));\n        }\n    }\n    function addSelectedEdges(ids) {\n        const isMultiSelection = get(store.multiselectionKeyPressed);\n        store.edges.update((edges) => edges.map((edge) => {\n            const edgeWillBeSelected = ids.includes(edge.id);\n            const selected = isMultiSelection\n                ? edge.selected || edgeWillBeSelected\n                : edgeWillBeSelected;\n            edge.selected = selected;\n            return edge;\n        }));\n        if (!isMultiSelection) {\n            store.nodes.update((ns) => ns.map((node) => {\n                node.selected = false;\n                return node;\n            }));\n        }\n    }\n    function handleNodeSelection(id) {\n        const node = get(store.nodes)?.find((n) => n.id === id);\n        if (!node) {\n            console.warn('012', errorMessages['error012'](id));\n            return;\n        }\n        store.selectionRect.set(null);\n        store.selectionRectMode.set(null);\n        if (!node.selected) {\n            addSelectedNodes([id]);\n        }\n        else if (node.selected && get(store.multiselectionKeyPressed)) {\n            unselectNodesAndEdges({ nodes: [node], edges: [] });\n        }\n    }\n    function panBy(delta) {\n        const viewport = get(store.viewport);\n        return panBySystem({\n            delta,\n            panZoom: get(store.panZoom),\n            transform: [viewport.x, viewport.y, viewport.zoom],\n            translateExtent: get(store.translateExtent),\n            width: get(store.width),\n            height: get(store.height)\n        });\n    }\n    const _connection = writable(initialConnection);\n    const updateConnection = (newConnection) => {\n        _connection.set({ ...newConnection });\n    };\n    function cancelConnection() {\n        _connection.set(initialConnection);\n    }\n    function reset() {\n        store.selectionRect.set(null);\n        store.selectionRectMode.set(null);\n        store.snapGrid.set(null);\n        store.isValidConnection.set(() => true);\n        unselectNodesAndEdges();\n        cancelConnection();\n    }\n    return {\n        // state\n        ...store,\n        // derived state\n        visibleEdges: getVisibleEdges(store),\n        visibleNodes: getVisibleNodes(store),\n        connection: derived([_connection, store.viewport], ([connection, viewport]) => {\n            return connection.inProgress\n                ? {\n                    ...connection,\n                    to: pointToRendererPoint(connection.to, [viewport.x, viewport.y, viewport.zoom])\n                }\n                : { ...connection };\n        }),\n        markers: derived([store.edges, store.defaultMarkerColor, store.flowId], ([edges, defaultColor, id]) => createMarkerIds(edges, { defaultColor, id })),\n        initialized: (() => {\n            let initialized = false;\n            const initialNodesLength = get(store.nodes).length;\n            const initialEdgesLength = get(store.edges).length;\n            return derived([store.nodesInitialized, store.edgesInitialized, store.viewportInitialized], ([nodesInitialized, edgesInitialized, viewportInitialized]) => {\n                // If it was already initialized, return true from then on\n                if (initialized)\n                    return initialized;\n                // if it hasn't been initialised check if it's now\n                if (initialNodesLength === 0) {\n                    initialized = viewportInitialized;\n                }\n                else if (initialEdgesLength === 0) {\n                    initialized = viewportInitialized && nodesInitialized;\n                }\n                else {\n                    initialized = viewportInitialized && nodesInitialized && edgesInitialized;\n                }\n                return initialized;\n            });\n        })(),\n        // actions\n        syncNodeStores: (nodes) => syncNodeStores(store.nodes, nodes),\n        syncEdgeStores: (edges) => syncEdgeStores(store.edges, edges),\n        syncViewport: (viewport) => syncViewportStores(store.panZoom, store.viewport, viewport),\n        setNodeTypes,\n        setEdgeTypes,\n        addEdge,\n        updateNodePositions,\n        updateNodeInternals,\n        zoomIn,\n        zoomOut,\n        fitView: (options) => fitView(options),\n        setMinZoom,\n        setMaxZoom,\n        setTranslateExtent,\n        setPaneClickDistance,\n        unselectNodesAndEdges,\n        addSelectedNodes,\n        addSelectedEdges,\n        handleNodeSelection,\n        panBy,\n        updateConnection,\n        cancelConnection,\n        reset\n    };\n}\nexport function useStore() {\n    const store = getContext(key);\n    if (!store) {\n        throw new Error('In order to use useStore you need to wrap your component in a <SvelteFlowProvider />');\n    }\n    return store.getStore();\n}\nexport function createStoreContext({ nodes, edges, width, height, fitView, nodeOrigin, nodeExtent }) {\n    const store = createStore({ nodes, edges, width, height, fitView, nodeOrigin, nodeExtent });\n    setContext(key, {\n        getStore: () => store\n    });\n    return store;\n}\n","import { PanOnScrollMode, XYPanZoom } from '@xyflow/system';\nexport default function zoom(domNode, params) {\n    const { panZoom, minZoom, maxZoom, initialViewport, viewport, dragging, translateExtent, paneClickDistance } = params;\n    const panZoomInstance = XYPanZoom({\n        domNode,\n        minZoom,\n        maxZoom,\n        translateExtent,\n        viewport: initialViewport,\n        paneClickDistance,\n        onDraggingChange: dragging.set\n    });\n    const currentViewport = panZoomInstance.getViewport();\n    viewport.set(currentViewport);\n    panZoom.set(panZoomInstance);\n    panZoomInstance.update(params);\n    return {\n        update(params) {\n            panZoomInstance.update(params);\n        }\n    };\n}\n","<script>import { onMount } from 'svelte';\nimport { PanOnScrollMode } from '@xyflow/system';\nimport { useStore } from '../../store';\nimport zoom from '../../actions/zoom';\nexport let initialViewport = undefined;\nexport let onMoveStart = undefined;\nexport let onMove = undefined;\nexport let onMoveEnd = undefined;\nexport let panOnScrollMode;\nexport let preventScrolling;\nexport let zoomOnScroll;\nexport let zoomOnDoubleClick;\nexport let zoomOnPinch;\nexport let panOnDrag;\nexport let panOnScroll;\nexport let paneClickDistance;\nconst { viewport, panZoom, selectionRect, minZoom, maxZoom, dragging, translateExtent, lib, panActivationKeyPressed, zoomActivationKeyPressed, viewportInitialized } = useStore();\n$: viewPort = initialViewport || { x: 0, y: 0, zoom: 1 };\n$: _panOnDrag = $panActivationKeyPressed || panOnDrag;\n$: _panOnScroll = $panActivationKeyPressed || panOnScroll;\nconst onTransformChange = (transform) => viewport.set({ x: transform[0], y: transform[1], zoom: transform[2] });\nonMount(() => {\n    $viewportInitialized = true;\n});\n</script>\n\n<div\n  class=\"svelte-flow__zoom\"\n  use:zoom={{\n    viewport,\n    minZoom: $minZoom,\n    maxZoom: $maxZoom,\n    initialViewport: viewPort,\n    dragging,\n    panZoom,\n    onPanZoomStart: onMoveStart,\n    onPanZoom: onMove,\n    onPanZoomEnd: onMoveEnd,\n    zoomOnScroll,\n    zoomOnDoubleClick,\n    zoomOnPinch,\n    panOnScroll: _panOnScroll,\n    panOnDrag: _panOnDrag,\n    panOnScrollSpeed: 0.5,\n    panOnScrollMode: panOnScrollMode || PanOnScrollMode.Free,\n    zoomActivationKeyPressed: $zoomActivationKeyPressed,\n    preventScrolling: typeof preventScrolling === 'boolean' ? preventScrolling : true,\n    noPanClassName: 'nopan',\n    noWheelClassName: 'nowheel',\n    userSelectionActive: !!$selectionRect,\n    translateExtent: $translateExtent,\n    lib: $lib,\n    paneClickDistance,\n    onTransformChange\n  }}\n>\n  <slot />\n</div>\n\n<style>\n  .svelte-flow__zoom {\n    width: 100%;\n    height: 100%;\n    position: absolute;\n    top: 0;\n    left: 0;\n    z-index: 4;\n  }\n</style>\n","<script context=\"module\">export function wrapHandler(handler, container) {\n    return (event) => {\n        if (event.target !== container) {\n            return;\n        }\n        handler?.(event);\n    };\n}\nexport function toggleSelected(ids) {\n    return (item) => {\n        const isSelected = ids.includes(item.id);\n        if (item.selected !== isSelected) {\n            item.selected = isSelected;\n        }\n        return item;\n    };\n}\n</script>\n\n<script>import { createEventDispatcher } from 'svelte';\nimport { SelectionMode, getEventPosition, getNodesInside, getConnectedEdges } from '@xyflow/system';\nimport { useStore } from '../../store';\nexport let panOnDrag = undefined;\nexport let selectionOnDrag = undefined;\nconst dispatch = createEventDispatcher();\nconst { nodes, nodeLookup, edges, viewport, dragging, elementsSelectable, selectionRect, selectionRectMode, selectionKeyPressed, selectionMode, panActivationKeyPressed, unselectNodesAndEdges, connection, } = useStore();\nlet container;\nlet containerBounds = null;\nlet selectedNodes = [];\n$: _panOnDrag = $panActivationKeyPressed || panOnDrag;\n$: isSelecting =\n    $selectionKeyPressed || $selectionRect || (selectionOnDrag && _panOnDrag !== true);\n$: hasActiveSelection = $elementsSelectable && (isSelecting || $selectionRectMode === 'user');\n// Used to prevent click events when the user lets go of the selectionKey during a selection\nlet selectionInProgress = false;\nfunction onClick(event) {\n    // We prevent click events when the user let go of the selectionKey during a selection\n    // We also prevent click events when a connection is in progress\n    if (selectionInProgress || $connection.inProgress) {\n        selectionInProgress = false;\n        return;\n    }\n    dispatch('paneclick', { event });\n    unselectNodesAndEdges();\n    selectionRectMode.set(null);\n}\nfunction onPointerDown(event) {\n    containerBounds = container.getBoundingClientRect();\n    if (!elementsSelectable ||\n        !isSelecting ||\n        event.button !== 0 ||\n        event.target !== container ||\n        !containerBounds) {\n        return;\n    }\n    event.target?.setPointerCapture?.(event.pointerId);\n    const { x, y } = getEventPosition(event, containerBounds);\n    unselectNodesAndEdges();\n    selectionRect.set({\n        width: 0,\n        height: 0,\n        startX: x,\n        startY: y,\n        x,\n        y\n    });\n    // onSelectionStart?.(event);\n}\nfunction onPointerMove(event) {\n    if (!isSelecting || !containerBounds || !$selectionRect) {\n        return;\n    }\n    selectionInProgress = true;\n    const mousePos = getEventPosition(event, containerBounds);\n    const startX = $selectionRect.startX ?? 0;\n    const startY = $selectionRect.startY ?? 0;\n    const nextUserSelectRect = {\n        ...$selectionRect,\n        x: mousePos.x < startX ? mousePos.x : startX,\n        y: mousePos.y < startY ? mousePos.y : startY,\n        width: Math.abs(mousePos.x - startX),\n        height: Math.abs(mousePos.y - startY)\n    };\n    const prevSelectedNodeIds = selectedNodes.map((n) => n.id);\n    const prevSelectedEdgeIds = getConnectedEdges(selectedNodes, $edges).map((e) => e.id);\n    selectedNodes = getNodesInside($nodeLookup, nextUserSelectRect, [$viewport.x, $viewport.y, $viewport.zoom], $selectionMode === SelectionMode.Partial, true);\n    const selectedEdgeIds = getConnectedEdges(selectedNodes, $edges).map((e) => e.id);\n    const selectedNodeIds = selectedNodes.map((n) => n.id);\n    // this prevents unnecessary updates while updating the selection rectangle\n    if (prevSelectedNodeIds.length !== selectedNodeIds.length ||\n        selectedNodeIds.some((id) => !prevSelectedNodeIds.includes(id))) {\n        nodes.update((nodes) => nodes.map(toggleSelected(selectedNodeIds)));\n    }\n    if (prevSelectedEdgeIds.length !== selectedEdgeIds.length ||\n        selectedEdgeIds.some((id) => !prevSelectedEdgeIds.includes(id))) {\n        edges.update((edges) => edges.map(toggleSelected(selectedEdgeIds)));\n    }\n    selectionRectMode.set('user');\n    selectionRect.set(nextUserSelectRect);\n}\nfunction onPointerUp(event) {\n    if (event.button !== 0) {\n        return;\n    }\n    event.target?.releasePointerCapture?.(event.pointerId);\n    // We only want to trigger click functions when in selection mode if\n    // the user did not move the mouse.\n    if (!isSelecting && $selectionRectMode === 'user' && event.target === container) {\n        onClick?.(event);\n    }\n    selectionRect.set(null);\n    if (selectedNodes.length > 0) {\n        $selectionRectMode = 'nodes';\n    }\n    // If the user kept holding the selectionKey during the selection,\n    // we need to reset the selectionInProgress, so the next click event is not prevented\n    if ($selectionKeyPressed) {\n        selectionInProgress = false;\n    }\n    // onSelectionEnd?.(event);\n}\nconst onContextMenu = (event) => {\n    if (Array.isArray(_panOnDrag) && _panOnDrag?.includes(2)) {\n        event.preventDefault();\n        return;\n    }\n    dispatch('panecontextmenu', { event });\n};\n</script>\n\n<!-- svelte-ignore a11y-no-static-element-interactions -->\n<!-- svelte-ignore a11y-click-events-have-key-events -->\n<div\n  bind:this={container}\n  class=\"svelte-flow__pane\"\n  class:draggable={panOnDrag === true || (Array.isArray(panOnDrag) && panOnDrag.includes(0))}\n  class:dragging={$dragging}\n  class:selection={isSelecting}\n  on:click={hasActiveSelection ? undefined : wrapHandler(onClick, container)}\n  on:pointerdown={hasActiveSelection ? onPointerDown : undefined}\n  on:pointermove={hasActiveSelection ? onPointerMove : undefined}\n  on:pointerup={hasActiveSelection ? onPointerUp : undefined}\n  on:contextmenu={wrapHandler(onContextMenu, container)}\n>\n  <slot />\n</div>\n\n<style>\n  .svelte-flow__pane {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n  }\n</style>\n","<script>import { useStore } from '../../store';\nconst { viewport } = useStore();\n</script>\n\n<div\n  class=\"svelte-flow__viewport xyflow__viewport\"\n  style=\"transform: translate({$viewport.x}px, {$viewport.y}px) scale({$viewport.zoom})\"\n>\n  <slot />\n</div>\n\n<style>\n  .svelte-flow__viewport {\n    width: 100%;\n    height: 100%;\n    position: absolute;\n    top: 0;\n    left: 0;\n  }\n</style>\n","import { get } from 'svelte/store';\nimport { XYDrag } from '@xyflow/system';\nexport default function drag(domNode, params) {\n    const { store, onDrag, onDragStart, onDragStop, onNodeMouseDown } = params;\n    const dragInstance = XYDrag({\n        onDrag,\n        onDragStart,\n        onDragStop,\n        onNodeMouseDown,\n        getStoreItems: () => {\n            const snapGrid = get(store.snapGrid);\n            const vp = get(store.viewport);\n            return {\n                nodes: get(store.nodes),\n                nodeLookup: get(store.nodeLookup),\n                edges: get(store.edges),\n                nodeExtent: get(store.nodeExtent),\n                snapGrid: snapGrid ? snapGrid : [0, 0],\n                snapToGrid: !!snapGrid,\n                nodeOrigin: get(store.nodeOrigin),\n                multiSelectionActive: get(store.multiselectionKeyPressed),\n                domNode: get(store.domNode),\n                transform: [vp.x, vp.y, vp.zoom],\n                autoPanOnNodeDrag: get(store.autoPanOnNodeDrag),\n                nodesDraggable: get(store.nodesDraggable),\n                selectNodesOnDrag: get(store.selectNodesOnDrag),\n                nodeDragThreshold: get(store.nodeDragThreshold),\n                unselectNodesAndEdges: store.unselectNodesAndEdges,\n                updateNodePositions: store.updateNodePositions,\n                panBy: store.panBy\n            };\n        }\n    });\n    function updateDrag(domNode, params) {\n        if (params.disabled) {\n            dragInstance.destroy();\n            return;\n        }\n        dragInstance.update({\n            domNode,\n            noDragClassName: params.noDragClass,\n            handleSelector: params.handleSelector,\n            nodeId: params.nodeId,\n            isSelectable: params.isSelectable,\n            nodeClickDistance: params.nodeClickDistance\n        });\n    }\n    updateDrag(domNode, params);\n    return {\n        update(params) {\n            updateDrag(domNode, params);\n        },\n        destroy() {\n            dragInstance.destroy();\n        }\n    };\n}\n","export function getNodeInlineStyleDimensions({ width, height, initialWidth, initialHeight, measuredWidth, measuredHeight }) {\n    if (measuredWidth === undefined && measuredHeight === undefined) {\n        const styleWidth = width ?? initialWidth;\n        const styleHeight = height ?? initialHeight;\n        return {\n            width: styleWidth ? `width:${styleWidth}px;` : '',\n            height: styleHeight ? `height:${styleHeight}px;` : ''\n        };\n    }\n    return {\n        width: width ? `width:${width}px;` : '',\n        height: height ? `height:${height}px;` : ''\n    };\n}\n","<svelte:options immutable />\n\n<script>import { setContext, onDestroy, createEventDispatcher } from 'svelte';\nimport { get, writable } from 'svelte/store';\nimport cc from 'classcat';\nimport { errorMessages, Position } from '@xyflow/system';\nimport drag from '../../actions/drag';\nimport { useStore } from '../../store';\nimport DefaultNode from '../nodes/DefaultNode.svelte';\nimport { getNodeInlineStyleDimensions } from './utils';\nexport let node;\nexport let id;\nexport let data = {};\nexport let selected = false;\nexport let draggable = undefined;\nexport let selectable = undefined;\nexport let connectable = true;\nexport let deletable = true;\nexport let hidden = false;\nexport let dragging = false;\nexport let resizeObserver = null;\nexport let style = undefined;\nexport let type = 'default';\nexport let isParent = false;\nexport let positionX;\nexport let positionY;\nexport let sourcePosition = undefined;\nexport let targetPosition = undefined;\nexport let zIndex;\nexport let measuredWidth = undefined;\nexport let measuredHeight = undefined;\nexport let initialWidth = undefined;\nexport let initialHeight = undefined;\nexport let width = undefined;\nexport let height = undefined;\nexport let dragHandle = undefined;\nexport let initialized = false;\nexport let parentId = undefined;\nexport let nodeClickDistance = undefined;\nlet className = '';\nexport { className as class };\nconst store = useStore();\nconst { nodeTypes, nodeDragThreshold, selectNodesOnDrag, handleNodeSelection, updateNodeInternals, elementsSelectable, nodesDraggable } = store;\nlet nodeRef;\nlet prevNodeRef = null;\nconst dispatchNodeEvent = createEventDispatcher();\nconst connectableStore = writable(connectable);\nlet prevType = undefined;\nlet prevSourcePosition = undefined;\nlet prevTargetPosition = undefined;\n$: nodeType = type || 'default';\n$: nodeTypeValid = !!$nodeTypes[nodeType];\n$: nodeComponent = $nodeTypes[nodeType] || DefaultNode;\n$: {\n    if (!nodeTypeValid) {\n        console.warn('003', errorMessages['error003'](type));\n    }\n}\n$: inlineStyleDimensions = getNodeInlineStyleDimensions({\n    width,\n    height,\n    initialWidth,\n    initialHeight,\n    measuredWidth,\n    measuredHeight\n});\n$: {\n    connectableStore.set(!!connectable);\n}\n$: {\n    // if type, sourcePosition or targetPosition changes,\n    // we need to re-calculate the handle positions\n    const doUpdate = (prevType && nodeType !== prevType) ||\n        (prevSourcePosition && sourcePosition !== prevSourcePosition) ||\n        (prevTargetPosition && targetPosition !== prevTargetPosition);\n    if (doUpdate) {\n        requestAnimationFrame(() => updateNodeInternals(new Map([\n            [\n                id,\n                {\n                    id,\n                    nodeElement: nodeRef,\n                    force: true\n                }\n            ]\n        ])));\n    }\n    prevType = nodeType;\n    prevSourcePosition = sourcePosition;\n    prevTargetPosition = targetPosition;\n}\nsetContext('svelteflow__node_id', id);\nsetContext('svelteflow__node_connectable', connectableStore);\n$: {\n    if (resizeObserver && (nodeRef !== prevNodeRef || !initialized)) {\n        prevNodeRef && resizeObserver.unobserve(prevNodeRef);\n        nodeRef && resizeObserver.observe(nodeRef);\n        prevNodeRef = nodeRef;\n    }\n}\nonDestroy(() => {\n    if (prevNodeRef) {\n        resizeObserver?.unobserve(prevNodeRef);\n    }\n});\nfunction onSelectNodeHandler(event) {\n    if (selectable && (!get(selectNodesOnDrag) || !draggable || get(nodeDragThreshold) > 0)) {\n        // this handler gets called by XYDrag on drag start when selectNodesOnDrag=true\n        // here we only need to call it when selectNodesOnDrag=false\n        handleNodeSelection(id);\n    }\n    dispatchNodeEvent('nodeclick', { node: node.internals.userNode, event });\n}\n</script>\n\n<!-- svelte-ignore a11y-click-events-have-key-events -->\n<!-- svelte-ignore a11y-no-static-element-interactions -->\n{#if !hidden}\n  <div\n    use:drag={{\n      nodeId: id,\n      isSelectable: selectable,\n      disabled: false,\n      handleSelector: dragHandle,\n      noDragClass: 'nodrag',\n      nodeClickDistance,\n      onNodeMouseDown: handleNodeSelection,\n      onDrag: (event, _, targetNode, nodes) => {\n        dispatchNodeEvent('nodedrag', { event, targetNode, nodes });\n      },\n      onDragStart: (event, _, targetNode, nodes) => {\n        dispatchNodeEvent('nodedragstart', { event, targetNode, nodes });\n      },\n      onDragStop: (event, _, targetNode, nodes) => {\n        dispatchNodeEvent('nodedragstop', { event, targetNode, nodes });\n      },\n      store\n    }}\n    bind:this={nodeRef}\n    data-id={id}\n    class={cc(['svelte-flow__node', `svelte-flow__node-${nodeType}`, className])}\n    class:dragging\n    class:selected\n    class:draggable\n    class:connectable\n    class:selectable\n    class:nopan={draggable}\n    class:parent={isParent}\n    style:z-index={zIndex}\n    style:transform=\"translate({positionX}px, {positionY}px)\"\n    style:visibility={initialized ? 'visible' : 'hidden'}\n    style=\"{style ?? ''};{inlineStyleDimensions.width}{inlineStyleDimensions.height}\"\n    on:click={onSelectNodeHandler}\n    on:mouseenter={(event) => dispatchNodeEvent('nodemouseenter', { node, event })}\n    on:mouseleave={(event) => dispatchNodeEvent('nodemouseleave', { node, event })}\n    on:mousemove={(event) => dispatchNodeEvent('nodemousemove', { node, event })}\n    on:contextmenu={(event) => dispatchNodeEvent('nodecontextmenu', { node, event })}\n  >\n    <svelte:component\n      this={nodeComponent}\n      {data}\n      {id}\n      selected={selected ?? false}\n      selectable={selectable ?? $elementsSelectable ?? true}\n      deletable={deletable ?? true}\n      {sourcePosition}\n      {targetPosition}\n      {zIndex}\n      {dragging}\n      draggable={draggable ?? $nodesDraggable ?? true}\n      {dragHandle}\n      {parentId}\n      type={nodeType}\n      isConnectable={$connectableStore}\n      positionAbsoluteX={positionX}\n      positionAbsoluteY={positionY}\n      {width}\n      {height}\n    />\n  </div>\n{/if}\n","<script>import { onDestroy } from 'svelte';\nimport { nodeHasDimensions } from '@xyflow/system';\nimport { NodeWrapper } from '../../components/NodeWrapper';\nimport { useStore } from '../../store';\nexport let nodeClickDistance = 0;\nconst { visibleNodes, nodesDraggable, nodesConnectable, elementsSelectable, updateNodeInternals, parentLookup } = useStore();\nconst resizeObserver = typeof ResizeObserver === 'undefined'\n    ? null\n    : new ResizeObserver((entries) => {\n        const updates = new Map();\n        entries.forEach((entry) => {\n            const id = entry.target.getAttribute('data-id');\n            updates.set(id, {\n                id,\n                nodeElement: entry.target,\n                force: true\n            });\n        });\n        updateNodeInternals(updates);\n    });\nonDestroy(() => {\n    resizeObserver?.disconnect();\n});\n</script>\n\n<div class=\"svelte-flow__nodes\">\n  {#each $visibleNodes as node (node.id)}\n    <NodeWrapper\n      {node}\n      id={node.id}\n      data={node.data}\n      selected={!!node.selected}\n      hidden={!!node.hidden}\n      draggable={!!(node.draggable || ($nodesDraggable && typeof node.draggable === 'undefined'))}\n      selectable={!!(\n        node.selectable ||\n        ($elementsSelectable && typeof node.selectable === 'undefined')\n      )}\n      connectable={!!(\n        node.connectable ||\n        ($nodesConnectable && typeof node.connectable === 'undefined')\n      )}\n      deletable={node.deletable ?? true}\n      positionX={node.internals.positionAbsolute.x}\n      positionY={node.internals.positionAbsolute.y}\n      isParent={$parentLookup.has(node.id)}\n      style={node.style}\n      class={node.class}\n      type={node.type ?? 'default'}\n      sourcePosition={node.sourcePosition}\n      targetPosition={node.targetPosition}\n      dragging={node.dragging}\n      zIndex={node.internals.z ?? 0}\n      dragHandle={node.dragHandle}\n      initialized={nodeHasDimensions(node)}\n      width={node.width}\n      height={node.height}\n      initialWidth={node.initialWidth}\n      initialHeight={node.initialHeight}\n      measuredWidth={node.measured.width}\n      measuredHeight={node.measured.height}\n      parentId={node.parentId}\n      {resizeObserver}\n      {nodeClickDistance}\n      on:nodeclick\n      on:nodemouseenter\n      on:nodemousemove\n      on:nodemouseleave\n      on:nodedrag\n      on:nodedragstart\n      on:nodedragstop\n      on:nodecontextmenu\n    />\n  {/each}\n</div>\n\n<style>\n  .svelte-flow__nodes {\n    width: 100%;\n    height: 100%;\n    position: absolute;\n    left: 0;\n    top: 0;\n  }\n</style>\n","<svelte:options immutable />\n\n<script>import { createEventDispatcher, setContext } from 'svelte';\nimport cc from 'classcat';\nimport { getMarkerId } from '@xyflow/system';\nimport { useStore } from '../../store';\nimport { BezierEdgeInternal } from '../edges';\nimport { useHandleEdgeSelect } from '../../hooks/useHandleEdgeSelect';\nexport let id;\nexport let type = 'default';\nexport let source = '';\nexport let target = '';\nexport let data = {};\nexport let style = undefined;\nexport let zIndex = undefined;\nexport let animated = false;\nexport let selected = false;\nexport let selectable = undefined;\nexport let deletable = undefined;\nexport let hidden = false;\nexport let label = undefined;\nexport let labelStyle = undefined;\nexport let markerStart = undefined;\nexport let markerEnd = undefined;\nexport let sourceHandle = undefined;\nexport let targetHandle = undefined;\nexport let sourceX;\nexport let sourceY;\nexport let targetX;\nexport let targetY;\nexport let sourcePosition;\nexport let targetPosition;\nexport let ariaLabel = undefined;\nexport let interactionWidth = undefined;\n// @ todo: support edge updates\nlet className = '';\nexport { className as class };\nsetContext('svelteflow__edge_id', id);\nconst { edgeLookup, edgeTypes, flowId, elementsSelectable } = useStore();\nconst dispatch = createEventDispatcher();\n$: edgeType = type || 'default';\n$: edgeComponent = $edgeTypes[edgeType] || BezierEdgeInternal;\n$: markerStartUrl = markerStart ? `url('#${getMarkerId(markerStart, $flowId)}')` : undefined;\n$: markerEndUrl = markerEnd ? `url('#${getMarkerId(markerEnd, $flowId)}')` : undefined;\n$: isSelectable = selectable ?? $elementsSelectable;\nconst handleEdgeSelect = useHandleEdgeSelect();\nfunction onClick(event) {\n    const edge = $edgeLookup.get(id);\n    if (edge) {\n        handleEdgeSelect(id);\n        dispatch('edgeclick', { event, edge });\n    }\n}\nfunction onMouseEvent(event, type) {\n    const edge = $edgeLookup.get(id);\n    if (edge) {\n        dispatch(type, { event, edge });\n    }\n}\n</script>\n\n<!-- svelte-ignore a11y-click-events-have-key-events -->\n<!-- svelte-ignore a11y-no-noninteractive-element-interactions -->\n{#if !hidden}\n  <svg style:z-index={zIndex}>\n    <g\n      class={cc(['svelte-flow__edge', className])}\n      class:animated\n      class:selected\n      class:selectable={isSelectable}\n      data-id={id}\n      on:click={onClick}\n      on:contextmenu={(e) => {\n        onMouseEvent(e, 'edgecontextmenu');\n      }}\n      on:mouseenter={(e) => {\n        onMouseEvent(e, 'edgemouseenter');\n      }}\n      on:mouseleave={(e) => {\n        onMouseEvent(e, 'edgemouseleave');\n      }}\n      aria-label={ariaLabel === null\n        ? undefined\n        : ariaLabel\n          ? ariaLabel\n          : `Edge from ${source} to ${target}`}\n      role=\"img\"\n    >\n      <svelte:component\n        this={edgeComponent}\n        {id}\n        {source}\n        {target}\n        {sourceX}\n        {sourceY}\n        {targetX}\n        {targetY}\n        {sourcePosition}\n        {targetPosition}\n        {animated}\n        {selected}\n        {label}\n        {labelStyle}\n        {data}\n        {style}\n        {interactionWidth}\n        selectable={isSelectable}\n        deletable={deletable ?? true}\n        type={edgeType}\n        sourceHandleId={sourceHandle}\n        targetHandleId={targetHandle}\n        markerStart={markerStartUrl}\n        markerEnd={markerEndUrl}\n      />\n    </g>\n  </svg>\n{/if}\n","<script>import { onMount } from 'svelte';\nlet _onMount = undefined;\nexport { _onMount as onMount };\nlet _onDestroy = undefined;\nexport { _onDestroy as onDestroy };\nonMount(() => {\n    _onMount?.();\n    return _onDestroy;\n});\n</script>\n","<script>import { useStore } from '../../../store';\nimport { Marker } from './';\nconst { markers } = useStore();\n</script>\n\n<defs>\n  {#each $markers as marker (marker.id)}\n    <Marker {...marker} />\n  {/each}\n</defs>\n","<script>import { MarkerType } from '@xyflow/system';\nexport let id;\nexport let type;\nexport let width = 12.5;\nexport let height = 12.5;\nexport let markerUnits = 'strokeWidth';\nexport let orient = 'auto-start-reverse';\nexport let color = undefined;\nexport let strokeWidth = undefined;\n</script>\n\n<marker\n  class=\"svelte-flow__arrowhead\"\n  {id}\n  markerWidth={`${width}`}\n  markerHeight={`${height}`}\n  viewBox=\"-10 -10 20 20\"\n  {markerUnits}\n  {orient}\n  refX=\"0\"\n  refY=\"0\"\n>\n  {#if type === MarkerType.Arrow}\n    <polyline\n      stroke={color}\n      stroke-linecap=\"round\"\n      stroke-linejoin=\"round\"\n      stroke-width={strokeWidth}\n      fill=\"none\"\n      points=\"-5,-4 0,0 -5,4\"\n    />\n  {:else if type === MarkerType.ArrowClosed}\n    <polyline\n      stroke={color}\n      stroke-linecap=\"round\"\n      stroke-linejoin=\"round\"\n      stroke-width={strokeWidth}\n      fill={color}\n      points=\"-5,-4 0,0 -5,4 -5,-4\"\n    />\n  {/if}\n</marker>\n","<script>import { onMount } from 'svelte';\nimport { EdgeWrapper } from '../../components/EdgeWrapper';\nimport { CallOnMount } from '../../components/CallOnMount';\nimport { MarkerDefinition } from './MarkerDefinition';\nimport { useStore } from '../../store';\nexport let defaultEdgeOptions;\nconst { visibleEdges, edgesInitialized, edges: { setDefaultOptions }, elementsSelectable } = useStore();\nonMount(() => {\n    if (defaultEdgeOptions)\n        setDefaultOptions(defaultEdgeOptions);\n});\n</script>\n\n<div class=\"svelte-flow__edges\">\n  <svg class=\"svelte-flow__marker\">\n    <MarkerDefinition />\n  </svg>\n\n  {#each $visibleEdges as edge (edge.id)}\n    <EdgeWrapper\n      id={edge.id}\n      source={edge.source}\n      target={edge.target}\n      data={edge.data}\n      style={edge.style}\n      animated={edge.animated}\n      selected={edge.selected}\n      selectable={edge.selectable ?? $elementsSelectable}\n      deletable={edge.deletable}\n      hidden={edge.hidden}\n      label={edge.label}\n      labelStyle={edge.labelStyle}\n      markerStart={edge.markerStart}\n      markerEnd={edge.markerEnd}\n      sourceHandle={edge.sourceHandle}\n      targetHandle={edge.targetHandle}\n      sourceX={edge.sourceX}\n      sourceY={edge.sourceY}\n      targetX={edge.targetX}\n      targetY={edge.targetY}\n      sourcePosition={edge.sourcePosition}\n      targetPosition={edge.targetPosition}\n      ariaLabel={edge.ariaLabel}\n      interactionWidth={edge.interactionWidth}\n      class={edge.class}\n      type={edge.type || 'default'}\n      zIndex={edge.zIndex}\n      on:edgeclick\n      on:edgecontextmenu\n      on:edgemouseenter\n      on:edgemouseleave\n    />\n  {/each}\n\n  {#if $visibleEdges.length > 0}\n    <CallOnMount\n      onMount={() => {\n        $edgesInitialized = true;\n      }}\n      onDestroy={() => {\n        $edgesInitialized = false;\n      }}\n    />\n  {/if}\n</div>\n","<script>export let x = 0;\nexport let y = 0;\nexport let width = 0;\nexport let height = 0;\nexport let isVisible = true;\n</script>\n\n{#if isVisible}\n  <div\n    class=\"svelte-flow__selection\"\n    style:width={typeof width === 'string' ? width : `${width}px`}\n    style:height={typeof height === 'string' ? height : `${height}px`}\n    style:transform={`translate(${x}px, ${y}px)`}\n  />\n{/if}\n\n<style>\n  .svelte-flow__selection {\n    position: absolute;\n    top: 0;\n    left: 0;\n  }\n</style>\n","<script>import { useStore } from '../../store';\nimport { Selection } from '../Selection';\nconst { selectionRect, selectionRectMode } = useStore();\n</script>\n\n<Selection\n  isVisible={!!($selectionRect && $selectionRectMode === 'user')}\n  width={$selectionRect?.width}\n  height={$selectionRect?.height}\n  x={$selectionRect?.x}\n  y={$selectionRect?.y}\n/>\n","<script>import { createEventDispatcher } from 'svelte';\nimport { getInternalNodesBounds, isNumeric } from '@xyflow/system';\nimport { useStore } from '../../store';\nimport { Selection } from '../Selection';\nimport drag from '../../actions/drag';\nconst store = useStore();\nconst { selectionRectMode, nodes, nodeLookup } = store;\nconst dispatch = createEventDispatcher();\nlet bounds = null;\n$: if ($selectionRectMode === 'nodes') {\n    bounds = getInternalNodesBounds($nodeLookup, { filter: (node) => !!node.selected });\n    $nodes;\n}\nfunction onContextMenu(event) {\n    const selectedNodes = $nodes.filter((n) => n.selected);\n    dispatch('selectioncontextmenu', { nodes: selectedNodes, event });\n}\nfunction onClick(event) {\n    const selectedNodes = $nodes.filter((n) => n.selected);\n    dispatch('selectionclick', { nodes: selectedNodes, event });\n}\n</script>\n\n{#if $selectionRectMode === 'nodes' && bounds && isNumeric(bounds.x) && isNumeric(bounds.y)}\n  <div\n    class=\"selection-wrapper nopan\"\n    style=\"width: {bounds.width}px; height: {bounds.height}px; transform: translate({bounds.x}px, {bounds.y}px)\"\n    use:drag={{\n      disabled: false,\n      store,\n      onDrag: (event, _, __, nodes) => {\n        dispatch('nodedrag', { event, targetNode: null, nodes });\n      },\n      onDragStart: (event, _, __, nodes) => {\n        dispatch('nodedragstart', { event, targetNode: null, nodes });\n      },\n      onDragStop: (event, _, __, nodes) => {\n        dispatch('nodedragstop', { event, targetNode: null, nodes });\n      }\n    }}\n    on:contextmenu={onContextMenu}\n    on:click={onClick}\n    role=\"button\"\n    tabindex=\"-1\"\n    on:keyup={() => {}}\n  >\n    <Selection width=\"100%\" height=\"100%\" x={0} y={0} />\n  </div>\n{/if}\n\n<style>\n  .selection-wrapper {\n    position: absolute;\n    top: 0;\n    left: 0;\n    z-index: 7;\n    pointer-events: all;\n  }\n</style>\n","/**\n * Listen for keyboard event and trigger `shortcut` {@link https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent | CustomEvent }\n * @example Typical usage\n *\n * ```svelte\n * <script lang=\"ts\">\n *  import { shortcut, type ShortcutEventDetail } from '@svelte-put/shortcut';\n *\n *  let commandPalette = false;\n *\n *  function onOpenCommandPalette() {\n *    commandPalette = true;\n *  }\n *  function onCloseCommandPalette() {\n *    commandPalette = false;\n *  }\n *\n *  function doSomethingElse(details: ShortcutEventDetail) {\n *    console.log('Action was placed on:', details.node);\n *    console.log('Trigger:', details.trigger);\n *  }\n *\n *  function onShortcut(event: CustomEvent<ShortcutEventDetail>) {\n *    if (event.detail.trigger.id === 'do-something-else') {\n *      console.log('Same as doSomethingElse()');\n *      // be careful here doSomethingElse would have been called too\n *   }\n * }\n * </script>\n *\n * <svelte:window\n *   use:shortcut={{\n *     trigger: [\n *       {\n *         key: 'k',\n *\n *         // trigger if either ctrl or meta is pressed\n *         modifier: ['ctrl', 'meta'],\n *\n *         callback: onOpenCommandPalette,\n *         preventDefault: true,\n *       },\n *       {\n *         key: 'Escape',\n *\n *         // preferably avoid arrow functions here for better performance\n *         // with arrow functions the action has to be updated more frequently\n *         callback: onCloseCommandPalette,\n *\n *         enabled: commandPalette,\n *         preventDefault: true,\n *       },\n *      {\n *         key: 'k',\n *\n *         // trigger if both ctrl & shift are pressed\n *         modifier: [['ctrl', 'shift']],\n *         id: 'do-something-else',\n *         callback: doSomethingElse,\n *      },\n *     ],\n *   }}\n *   on:shortcut={onShortcut}\n * />\n * ```\n *\n *\n *\n * As with any svelte action, `shortcut` should be use with element and not component.\n *\n * ```html\n * <-- correct usage-->\n *  <div use:intersect />\n *\n * <-- incorrect usage-->\n * <Component use:intersect/>\n * ```\n *\n * You can either:\n *\n * - pass multiple callbacks to their associated triggers, or\n *\n * - pass one single handler to the `on:shortcut` event, in which case you should\n * provide an ID to each trigger to be able to distinguish what trigger was activated\n * in the event handler.\n *\n * Either way, only use `callback` or `on:shortcut` and not both to\n * avoid handler duplication.\n * @param {HTMLElement} node - HTMLElement to add event listener to\n * @param {import('./public').ShortcutParameter} param - svelte action parameters\n * @returns {import('./public').ShortcutActionReturn}\n */\nexport function shortcut(node, param) {\n\tlet { enabled = true, trigger, type = 'keydown' } = param;\n\n\t/**\n\t * @param {KeyboardEvent} event\n\t */\n\tfunction handler(event) {\n\t\tconst normalizedTriggers = Array.isArray(trigger) ? trigger : [trigger];\n\t\t/** @type {Record<import('./public').ShortcutModifier, boolean>} */\n\t\tconst modifiedMap = {\n\t\t\talt: event.altKey,\n\t\t\tctrl: event.ctrlKey,\n\t\t\tshift: event.shiftKey,\n\t\t\tmeta: event.metaKey,\n\t\t};\n\t\tfor (const trigger of normalizedTriggers) {\n\t\t\tconst mergedTrigger = {\n\t\t\t\tmodifier: [],\n\t\t\t\tpreventDefault: false,\n\t\t\t\tenabled: true,\n\t\t\t\t...trigger,\n\t\t\t};\n\t\t\tconst { modifier, key, callback, preventDefault, enabled: triggerEnabled } = mergedTrigger;\n\t\t\tif (triggerEnabled) {\n\t\t\t\tif (modifier.length) {\n\t\t\t\t\tconst modifierDefs = (Array.isArray(modifier) ? modifier : [modifier]).map((def) =>\n\t\t\t\t\t\ttypeof def === 'string' ? [def] : def,\n\t\t\t\t\t);\n\t\t\t\t\tconst modified = modifierDefs.some((def) =>\n\t\t\t\t\t\tdef.every((modifier) => modifiedMap[modifier]),\n\t\t\t\t\t);\n\t\t\t\t\tif (!modified) continue;\n\t\t\t\t}\n\t\t\t\tif (event.key === key) {\n\t\t\t\t\tif (preventDefault) event.preventDefault();\n\t\t\t\t\t/** @type {import('./public').ShortcutEventDetail} */\n\t\t\t\t\tconst detail = {\n\t\t\t\t\t\tnode,\n\t\t\t\t\t\ttrigger: mergedTrigger,\n\t\t\t\t\t\toriginalEvent: event,\n\t\t\t\t\t};\n\t\t\t\t\tnode.dispatchEvent(new CustomEvent('shortcut', { detail }));\n\t\t\t\t\tcallback?.(detail);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tif (enabled) node.addEventListener(type, handler);\n\n\treturn {\n\t\tupdate: (update) => {\n\t\t\tconst { enabled: newEnabled = true, type: newType = 'keydown' } = update;\n\n\t\t\tif (enabled && (!newEnabled || type !== newType)) {\n\t\t\t\tnode.removeEventListener(type, handler);\n\t\t\t} else if (!enabled && newEnabled) {\n\t\t\t\tnode.addEventListener(newType, handler);\n\t\t\t}\n\n\t\t\tenabled = newEnabled;\n\t\t\ttype = newType;\n\t\t\ttrigger = update.trigger;\n\t\t},\n\t\tdestroy: () => {\n\t\t\tnode.removeEventListener(type, handler);\n\t\t},\n\t};\n}\n","<script>import { shortcut } from '@svelte-put/shortcut';\nimport { isInputDOMNode, isMacOs } from '@xyflow/system';\nimport { useStore } from '../../store';\nexport let selectionKey = 'Shift';\nexport let multiSelectionKey = isMacOs() ? 'Meta' : 'Control';\nexport let deleteKey = 'Backspace';\nexport let panActivationKey = ' ';\nexport let zoomActivationKey = isMacOs() ? 'Meta' : 'Control';\nconst { selectionKeyPressed, multiselectionKeyPressed, deleteKeyPressed, panActivationKeyPressed, zoomActivationKeyPressed, selectionRect } = useStore();\nfunction isKeyObject(key) {\n    return key !== null && typeof key === 'object';\n}\nfunction getModifier(key) {\n    return isKeyObject(key) ? key.modifier || [] : [];\n}\nfunction getKeyString(key) {\n    if (key === null || key === undefined) {\n        // this is a workaround to check if a key is set\n        // if not we won't call the callback\n        return '';\n    }\n    return isKeyObject(key) ? key.key : key;\n}\nfunction getShortcutTrigger(key, callback) {\n    const keys = Array.isArray(key) ? key : [key];\n    return keys.map((_key) => {\n        const keyString = getKeyString(_key);\n        return {\n            key: keyString,\n            modifier: getModifier(_key),\n            enabled: keyString !== null,\n            callback\n        };\n    });\n}\nfunction resetKeysAndSelection() {\n    selectionRect.set(null);\n    selectionKeyPressed.set(false);\n    multiselectionKeyPressed.set(false);\n    deleteKeyPressed.set(false);\n    panActivationKeyPressed.set(false);\n    zoomActivationKeyPressed.set(false);\n}\n</script>\n\n<svelte:window\n  on:blur={resetKeysAndSelection}\n  on:contextmenu={resetKeysAndSelection}\n  use:shortcut={{\n    trigger: getShortcutTrigger(selectionKey, () => selectionKeyPressed.set(true)),\n    type: 'keydown'\n  }}\n  use:shortcut={{\n    trigger: getShortcutTrigger(selectionKey, () => selectionKeyPressed.set(false)),\n    type: 'keyup'\n  }}\n  use:shortcut={{\n    trigger: getShortcutTrigger(multiSelectionKey, () => multiselectionKeyPressed.set(true)),\n    type: 'keydown'\n  }}\n  use:shortcut={{\n    trigger: getShortcutTrigger(multiSelectionKey, () => multiselectionKeyPressed.set(false)),\n    type: 'keyup'\n  }}\n  use:shortcut={{\n    trigger: getShortcutTrigger(deleteKey, (detail) => {\n      const isModifierKey =\n        detail.originalEvent.ctrlKey ||\n        detail.originalEvent.metaKey ||\n        detail.originalEvent.shiftKey;\n      if (!isModifierKey && !isInputDOMNode(detail.originalEvent)) {\n        deleteKeyPressed.set(true);\n      }\n    }),\n    type: 'keydown'\n  }}\n  use:shortcut={{\n    trigger: getShortcutTrigger(deleteKey, () => deleteKeyPressed.set(false)),\n    type: 'keyup'\n  }}\n  use:shortcut={{\n    trigger: getShortcutTrigger(panActivationKey, () => panActivationKeyPressed.set(true)),\n    type: 'keydown'\n  }}\n  use:shortcut={{\n    trigger: getShortcutTrigger(panActivationKey, () => panActivationKeyPressed.set(false)),\n    type: 'keyup'\n  }}\n  use:shortcut={{\n    trigger: getShortcutTrigger(zoomActivationKey, () => zoomActivationKeyPressed.set(true)),\n    type: 'keydown'\n  }}\n  use:shortcut={{\n    trigger: getShortcutTrigger(zoomActivationKey, () => zoomActivationKeyPressed.set(false)),\n    type: 'keyup'\n  }}\n/>\n","<script>import cc from 'classcat';\nimport { useStore } from '../../store';\nimport { ConnectionLineType, getBezierPath, getConnectionStatus, getSmoothStepPath, getStraightPath } from '@xyflow/system';\nexport let containerStyle = '';\nexport let style = '';\nexport let isCustomComponent = false;\nconst { width, height, connection, connectionLineType } = useStore();\nlet path = null;\n$: if ($connection.inProgress && !isCustomComponent) {\n    const { from, to, fromPosition, toPosition } = $connection;\n    const pathParams = {\n        sourceX: from.x,\n        sourceY: from.y,\n        sourcePosition: fromPosition,\n        targetX: to.x,\n        targetY: to.y,\n        targetPosition: toPosition\n    };\n    switch ($connectionLineType) {\n        case ConnectionLineType.Bezier:\n            [path] = getBezierPath(pathParams);\n            break;\n        case ConnectionLineType.Step:\n            [path] = getSmoothStepPath({\n                ...pathParams,\n                borderRadius: 0\n            });\n            break;\n        case ConnectionLineType.SmoothStep:\n            [path] = getSmoothStepPath(pathParams);\n            break;\n        default:\n            [path] = getStraightPath(pathParams);\n    }\n}\n</script>\n\n{#if $connection.inProgress}\n  <svg width={$width} height={$height} class=\"svelte-flow__connectionline\" style={containerStyle}>\n    <g class={cc(['svelte-flow__connection', getConnectionStatus($connection.isValid)])}>\n      <slot name=\"connectionLine\" />\n      <!-- slot fallbacks do not work if slots are forwarded in parent -->\n      {#if !isCustomComponent}\n        <path d={path} {style} fill=\"none\" class=\"svelte-flow__connection-path\" />\n      {/if}\n    </g>\n  </svg>\n{/if}\n","<script>import cc from 'classcat';\nimport { useStore } from '../../store';\nexport let position = 'top-right';\nexport let style = undefined;\nlet className = undefined;\nexport { className as class };\nconst { selectionRectMode } = useStore();\n$: positionClasses = `${position}`.split('-');\n</script>\n\n<div\n  class={cc(['svelte-flow__panel', className, ...positionClasses])}\n  {style}\n  style:pointer-events={$selectionRectMode ? 'none' : ''}\n  {...$$restProps}\n>\n  <slot />\n</div>\n","<script>import { Panel } from '../../container/Panel';\nexport let proOptions = undefined;\nexport let position = 'bottom-right';\n</script>\n\n{#if !proOptions?.hideAttribution}\n  <Panel\n    {position}\n    class=\"svelte-flow__attribution\"\n    data-message=\"Feel free to remove the attribution or check out how you could support us: https://svelteflow.dev/support-us\"\n  >\n    <a\n      href=\"https://svelteflow.dev\"\n      target=\"_blank\"\n      rel=\"noopener noreferrer\"\n      aria-label=\"Svelte Flow attribution\"\n    >\n      Svelte Flow\n    </a>\n  </Panel>\n{/if}\n","// this is helper function for updating the store\n// for props where we need to call a specific store action\nexport function updateStore(store, { nodeTypes, edgeTypes, minZoom, maxZoom, translateExtent, paneClickDistance }) {\n    if (nodeTypes !== undefined) {\n        store.setNodeTypes(nodeTypes);\n    }\n    if (edgeTypes !== undefined) {\n        store.setEdgeTypes(edgeTypes);\n    }\n    if (minZoom !== undefined) {\n        store.setMinZoom(minZoom);\n    }\n    if (maxZoom !== undefined) {\n        store.setMaxZoom(maxZoom);\n    }\n    if (translateExtent !== undefined) {\n        store.setTranslateExtent(translateExtent);\n    }\n    if (paneClickDistance !== undefined) {\n        store.setPaneClickDistance(paneClickDistance);\n    }\n}\nconst getKeys = (obj) => Object.keys(obj);\nexport function updateStoreByKeys(store, keys) {\n    getKeys(keys).forEach((prop) => {\n        const update = keys[prop];\n        if (update !== undefined) {\n            // @ts-expect-error @todo: how to fix this TS error?\n            store[prop].set(update);\n        }\n    });\n}\n","import { readable } from 'svelte/store';\nfunction getMediaQuery() {\n    if (typeof window === 'undefined' || !window.matchMedia) {\n        return null;\n    }\n    return window.matchMedia('(prefers-color-scheme: dark)');\n}\n/**\n * Hook for receiving the current color mode class 'dark' or 'light'.\n *\n * @internal\n * @param colorMode - The color mode to use ('dark', 'light' or 'system')\n */\nexport function useColorModeClass(colorMode = 'light') {\n    const colorModeClass = readable('light', (set) => {\n        if (colorMode !== 'system') {\n            set(colorMode);\n            return;\n        }\n        const mediaQuery = getMediaQuery();\n        const updateColorModeClass = () => set(mediaQuery?.matches ? 'dark' : 'light');\n        set(mediaQuery?.matches ? 'dark' : 'light');\n        mediaQuery?.addEventListener('change', updateColorModeClass);\n        return () => {\n            mediaQuery?.removeEventListener('change', updateColorModeClass);\n        };\n    });\n    return colorModeClass;\n}\n","<script>import { onMount, hasContext } from 'svelte';\nimport { get } from 'svelte/store';\nimport cc from 'classcat';\nimport { ConnectionMode, PanOnScrollMode } from '@xyflow/system';\nimport { Zoom } from '../Zoom';\nimport { Pane } from '../Pane';\nimport { Viewport as ViewportComponent } from '../Viewport';\nimport { NodeRenderer } from '../NodeRenderer';\nimport { EdgeRenderer } from '../EdgeRenderer';\nimport { UserSelection } from '../../components/UserSelection';\nimport { NodeSelection } from '../../components/NodeSelection';\nimport { KeyHandler } from '../../components/KeyHandler';\nimport { ConnectionLine } from '../../components/ConnectionLine';\nimport { Attribution } from '../../components/Attribution';\nimport { key, useStore, createStoreContext } from '../../store';\nimport { updateStore, updateStoreByKeys } from './utils';\nimport { useColorModeClass } from '../../hooks/useColorModeClass';\nexport let id = '1';\nexport let nodes;\nexport let edges;\nexport let fitView = undefined;\nexport let fitViewOptions = undefined;\nexport let minZoom = undefined;\nexport let maxZoom = undefined;\nexport let initialViewport = undefined;\nexport let viewport = undefined;\nexport let nodeTypes = undefined;\nexport let edgeTypes = undefined;\nexport let selectionKey = undefined;\nexport let selectionMode = undefined;\nexport let panActivationKey = undefined;\nexport let multiSelectionKey = undefined;\nexport let zoomActivationKey = undefined;\nexport let nodesDraggable = undefined;\nexport let nodesConnectable = undefined;\nexport let nodeDragThreshold = undefined;\nexport let elementsSelectable = undefined;\nexport let snapGrid = undefined;\nexport let deleteKey = undefined;\nexport let connectionRadius = undefined;\nexport let connectionLineType = undefined;\nexport let connectionMode = ConnectionMode.Strict;\nexport let connectionLineStyle = '';\nexport let connectionLineContainerStyle = '';\nexport let onMoveStart = undefined;\nexport let onMove = undefined;\nexport let onMoveEnd = undefined;\nexport let isValidConnection = undefined;\nexport let translateExtent = undefined;\nexport let nodeExtent = undefined;\nexport let onlyRenderVisibleElements = undefined;\nexport let panOnScrollMode = PanOnScrollMode.Free;\nexport let preventScrolling = true;\nexport let zoomOnScroll = true;\nexport let zoomOnDoubleClick = true;\nexport let zoomOnPinch = true;\nexport let panOnScroll = false;\nexport let panOnDrag = true;\nexport let selectionOnDrag = undefined;\nexport let autoPanOnConnect = true;\nexport let autoPanOnNodeDrag = true;\nexport let onerror = undefined;\nexport let ondelete = undefined;\nexport let onedgecreate = undefined;\nexport let attributionPosition = undefined;\nexport let proOptions = undefined;\nexport let defaultEdgeOptions = undefined;\nexport let width = undefined;\nexport let height = undefined;\nexport let colorMode = 'light';\nexport let onconnect = undefined;\nexport let onconnectstart = undefined;\nexport let onconnectend = undefined;\nexport let onbeforedelete = undefined;\nexport let oninit = undefined;\nexport let nodeOrigin = undefined;\nexport let paneClickDistance = 0;\nexport let nodeClickDistance = 0;\nexport let defaultMarkerColor = '#b1b1b7';\nexport let style = undefined;\nlet className = undefined;\nexport { className as class };\nlet domNode;\nlet clientWidth;\nlet clientHeight;\nconst initViewport = $viewport || initialViewport;\nconst store = hasContext(key)\n    ? useStore()\n    : createStoreContext({\n        nodes: get(nodes),\n        edges: get(edges),\n        width,\n        height,\n        fitView,\n        nodeOrigin,\n        nodeExtent\n    });\nonMount(() => {\n    store.width.set(clientWidth);\n    store.height.set(clientHeight);\n    store.domNode.set(domNode);\n    store.syncNodeStores(nodes);\n    store.syncEdgeStores(edges);\n    store.syncViewport(viewport);\n    if (fitView !== undefined) {\n        store.fitViewQueued.set(fitView);\n    }\n    if (fitViewOptions) {\n        store.fitViewOptions.set(fitViewOptions);\n    }\n    updateStore(store, {\n        nodeTypes,\n        edgeTypes,\n        minZoom,\n        maxZoom,\n        translateExtent,\n        paneClickDistance\n    });\n    return () => {\n        store.reset();\n    };\n});\n// Update width & height on resize\n$: {\n    if (clientWidth !== undefined && clientHeight !== undefined) {\n        store.width.set(clientWidth);\n        store.height.set(clientHeight);\n    }\n}\n// Call oninit once when flow is intialized\nconst { initialized } = store;\nlet onInitCalled = false;\n$: {\n    if (!onInitCalled && $initialized) {\n        oninit?.();\n        onInitCalled = true;\n    }\n}\n// this updates the store for simple changes\n// where the prop names equals the store name\n$: {\n    const updatableProps = {\n        flowId: id,\n        connectionLineType,\n        connectionRadius,\n        selectionMode,\n        snapGrid,\n        defaultMarkerColor,\n        nodesDraggable,\n        nodesConnectable,\n        elementsSelectable,\n        onlyRenderVisibleElements,\n        isValidConnection,\n        autoPanOnConnect,\n        autoPanOnNodeDrag,\n        onerror,\n        ondelete,\n        onedgecreate,\n        connectionMode,\n        nodeDragThreshold,\n        onconnect,\n        onconnectstart,\n        onconnectend,\n        onbeforedelete,\n        nodeOrigin\n    };\n    updateStoreByKeys(store, updatableProps);\n}\n$: updateStore(store, {\n    nodeTypes,\n    edgeTypes,\n    minZoom,\n    maxZoom,\n    translateExtent,\n    paneClickDistance\n});\n$: colorModeClass = useColorModeClass(colorMode);\n</script>\n\n<div\n  bind:this={domNode}\n  bind:clientWidth\n  bind:clientHeight\n  {style}\n  class={cc(['svelte-flow', className, $colorModeClass])}\n  data-testid=\"svelte-flow__wrapper\"\n  on:dragover\n  on:drop\n  {...$$restProps}\n  role=\"application\"\n>\n  <KeyHandler\n    {selectionKey}\n    {deleteKey}\n    {panActivationKey}\n    {multiSelectionKey}\n    {zoomActivationKey}\n  />\n  <Zoom\n    initialViewport={initViewport}\n    {onMoveStart}\n    {onMove}\n    {onMoveEnd}\n    panOnScrollMode={panOnScrollMode === undefined ? PanOnScrollMode.Free : panOnScrollMode}\n    preventScrolling={preventScrolling === undefined ? true : preventScrolling}\n    zoomOnScroll={zoomOnScroll === undefined ? true : zoomOnScroll}\n    zoomOnDoubleClick={zoomOnDoubleClick === undefined ? true : zoomOnDoubleClick}\n    zoomOnPinch={zoomOnPinch === undefined ? true : zoomOnPinch}\n    panOnScroll={panOnScroll === undefined ? false : panOnScroll}\n    panOnDrag={panOnDrag === undefined ? true : panOnDrag}\n    paneClickDistance={paneClickDistance === undefined ? 0 : paneClickDistance}\n  >\n    <Pane\n      on:paneclick\n      on:panecontextmenu\n      panOnDrag={panOnDrag === undefined ? true : panOnDrag}\n      {selectionOnDrag}\n    >\n      <ViewportComponent>\n        <EdgeRenderer\n          on:edgeclick\n          on:edgecontextmenu\n          on:edgemouseenter\n          on:edgemouseleave\n          {defaultEdgeOptions}\n        />\n        <ConnectionLine\n          containerStyle={connectionLineContainerStyle}\n          style={connectionLineStyle}\n          isCustomComponent={$$slots.connectionLine}\n        >\n          <slot name=\"connectionLine\" slot=\"connectionLine\" />\n        </ConnectionLine>\n        <div class=\"svelte-flow__edgelabel-renderer\" />\n        <div class=\"svelte-flow__viewport-portal\" />\n        <NodeRenderer\n          {nodeClickDistance}\n          on:nodeclick\n          on:nodemouseenter\n          on:nodemousemove\n          on:nodemouseleave\n          on:nodedragstart\n          on:nodedrag\n          on:nodedragstop\n          on:nodecontextmenu\n        />\n        <NodeSelection\n          on:selectionclick\n          on:selectioncontextmenu\n          on:nodedragstart\n          on:nodedrag\n          on:nodedragstop\n        />\n      </ViewportComponent>\n      <UserSelection />\n    </Pane>\n  </Zoom>\n  <Attribution {proOptions} position={attributionPosition} />\n  <slot />\n</div>\n\n<style>\n  .svelte-flow {\n    width: 100%;\n    height: 100%;\n    overflow: hidden;\n    position: relative;\n    z-index: 0;\n\n    background-color: var(--background-color, var(--background-color-default));\n  }\n\n  :root {\n    --background-color-default: #fff;\n    --background-pattern-color-default: #ddd;\n\n    --minimap-mask-color-default: rgba(240, 240, 240, 0.6);\n    --minimap-mask-stroke-color-default: none;\n    --minimap-mask-stroke-width-default: 1;\n\n    --controls-button-background-color-default: #fefefe;\n    --controls-button-background-color-hover-default: #f4f4f4;\n    --controls-button-color-default: inherit;\n    --controls-button-color-hover-default: inherit;\n    --controls-button-border-color-default: #eee;\n  }\n</style>\n","<script>import { onDestroy, setContext } from 'svelte';\nimport { createStore, key } from '../../store';\nexport let initialNodes = undefined;\nexport let initialEdges = undefined;\nexport let initialWidth = undefined;\nexport let initialHeight = undefined;\nexport let fitView = undefined;\nexport let nodeOrigin = undefined;\nconst store = createStore({\n    nodes: initialNodes,\n    edges: initialEdges,\n    width: initialWidth,\n    height: initialHeight,\n    nodeOrigin,\n    fitView\n});\nsetContext(key, {\n    getStore: () => store\n});\nonDestroy(() => {\n    store.reset();\n});\n</script>\n\n<slot />\n","<script>import cc from 'classcat';\nexport let className = undefined;\nexport let bgColor = undefined;\nexport let bgColorHover = undefined;\nexport let color = undefined;\nexport let colorHover = undefined;\nexport let borderColor = undefined;\nexport { className as class };\n</script>\n\n<button\n  type=\"button\"\n  on:click\n  class={cc(['svelte-flow__controls-button', className])}\n  style:--xy-controls-button-background-color-props={bgColor}\n  style:--xy-controls-button-background-color-hover-props={bgColorHover}\n  style:--xy-controls-button-color-props={color}\n  style:--xy-controls-button-color-hover-props={colorHover}\n  style:--xy-controls-button-border-color-props={borderColor}\n  {...$$restProps}\n>\n  <slot class=\"button-svg\" />\n</button>\n","<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 32 32\">\n  <path d=\"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z\" />\n</svg>\n","<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 32 5\">\n  <path d=\"M0 0h32v4.2H0z\" />\n</svg>\n","<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 32 30\">\n  <path\n    d=\"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z\"\n  />\n</svg>\n","<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 25 32\">\n  <path\n    d=\"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z\"\n  />\n</svg>\n","<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 25 32\">\n  <path\n    d=\"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z\"\n  />\n</svg>\n","<script>import cc from 'classcat';\nimport Panel from '../../container/Panel/Panel.svelte';\nimport { useStore } from '../../store';\nimport ControlButton from './ControlButton.svelte';\nimport PlusIcon from './Icons/Plus.svelte';\nimport MinusIcon from './Icons/Minus.svelte';\nimport FitViewIcon from './Icons/Fit.svelte';\nimport LockIcon from './Icons/Lock.svelte';\nimport UnlockIcon from './Icons/Unlock.svelte';\nexport let position = 'bottom-left';\nexport let showZoom = true;\nexport let showFitView = true;\nexport let showLock = true;\nexport let buttonBgColor = undefined;\nexport let buttonBgColorHover = undefined;\nexport let buttonColor = undefined;\nexport let buttonColorHover = undefined;\nexport let buttonBorderColor = undefined;\nexport let ariaLabel = undefined;\nexport let style = undefined;\nexport let orientation = 'vertical';\nexport let fitViewOptions = undefined;\nlet className = '';\nexport { className as class };\nconst { zoomIn, zoomOut, fitView, viewport, minZoom, maxZoom, nodesDraggable, nodesConnectable, elementsSelectable } = useStore();\nconst buttonProps = {\n    bgColor: buttonBgColor,\n    bgColorHover: buttonBgColorHover,\n    color: buttonColor,\n    colorHover: buttonColorHover,\n    borderColor: buttonBorderColor\n};\n$: isInteractive = $nodesDraggable || $nodesConnectable || $elementsSelectable;\n$: minZoomReached = $viewport.zoom <= $minZoom;\n$: maxZoomReached = $viewport.zoom >= $maxZoom;\nconst onZoomInHandler = () => {\n    zoomIn();\n};\nconst onZoomOutHandler = () => {\n    zoomOut();\n};\nconst onFitViewHandler = () => {\n    fitView(fitViewOptions);\n};\nconst onToggleInteractivity = () => {\n    isInteractive = !isInteractive;\n    nodesDraggable.set(isInteractive);\n    nodesConnectable.set(isInteractive);\n    elementsSelectable.set(isInteractive);\n};\n$: orientationClass = orientation === 'horizontal' ? 'horizontal' : 'vertical';\n</script>\n\n<Panel\n  class={cc(['svelte-flow__controls', orientationClass, className])}\n  {position}\n  data-testid=\"svelte-flow__controls\"\n  aria-label={ariaLabel ?? 'Svelte Flow controls'}\n  {style}\n>\n  <slot name=\"before\" />\n  {#if showZoom}\n    <ControlButton\n      on:click={onZoomInHandler}\n      class=\"svelte-flow__controls-zoomin\"\n      title=\"zoom in\"\n      aria-label=\"zoom in\"\n      disabled={maxZoomReached}\n      {...buttonProps}\n    >\n      <PlusIcon />\n    </ControlButton>\n    <ControlButton\n      on:click={onZoomOutHandler}\n      class=\"svelte-flow__controls-zoomout\"\n      title=\"zoom out\"\n      aria-label=\"zoom out\"\n      disabled={minZoomReached}\n      {...buttonProps}\n    >\n      <MinusIcon />\n    </ControlButton>\n  {/if}\n  {#if showFitView}\n    <ControlButton\n      class=\"svelte-flow__controls-fitview\"\n      on:click={onFitViewHandler}\n      title=\"fit view\"\n      aria-label=\"fit view\"\n      {...buttonProps}\n    >\n      <FitViewIcon />\n    </ControlButton>\n  {/if}\n  {#if showLock}\n    <ControlButton\n      class=\"svelte-flow__controls-interactive\"\n      on:click={onToggleInteractivity}\n      title=\"toggle interactivity\"\n      aria-label=\"toggle interactivity\"\n      {...buttonProps}\n    >\n      {#if isInteractive}<UnlockIcon />{:else}<LockIcon />{/if}\n    </ControlButton>\n  {/if}\n  <slot />\n  <slot name=\"after\" />\n</Panel>\n","export var BackgroundVariant;\n(function (BackgroundVariant) {\n    BackgroundVariant[\"Lines\"] = \"lines\";\n    BackgroundVariant[\"Dots\"] = \"dots\";\n    BackgroundVariant[\"Cross\"] = \"cross\";\n})(BackgroundVariant || (BackgroundVariant = {}));\n","<script>import cc from 'classcat';\nexport let radius = 5;\nlet className = '';\nexport { className as class };\n</script>\n\n<circle\n  cx={radius}\n  cy={radius}\n  r={radius}\n  class={cc(['svelte-flow__background-pattern', 'dots', className])}\n/>\n","<script>import cc from 'classcat';\nexport let lineWidth = 1;\nexport let dimensions;\nexport let variant = undefined;\nlet className = '';\nexport { className as class };\n</script>\n\n<path\n  stroke-width={lineWidth}\n  d={`M${dimensions[0] / 2} 0 V${dimensions[1]} M0 ${dimensions[1] / 2} H${dimensions[0]}`}\n  class={cc(['svelte-flow__background-pattern', variant, className])}\n/>\n","<script labg=\"ts\" context=\"module\">\n  const defaultSize = {\n    [BackgroundVariant.Dots]: 1,\n    [BackgroundVariant.Lines]: 1,\n    [BackgroundVariant.Cross]: 6\n  };\n</script>\n\n<script>import cc from 'classcat';\nimport DotPattern from './DotPattern.svelte';\nimport LinePattern from './LinePattern.svelte';\nimport { useStore } from '../../store';\nimport { BackgroundVariant } from './types';\nexport let id = undefined;\nexport let variant = BackgroundVariant.Dots;\nexport let gap = 20;\nexport let size = 1;\nexport let lineWidth = 1;\nexport let bgColor = undefined;\nexport let patternColor = undefined;\nexport let patternClass = undefined;\nlet className = '';\nexport { className as class };\nconst { viewport, flowId } = useStore();\nconst patternSize = size || defaultSize[variant];\nconst isDots = variant === BackgroundVariant.Dots;\nconst isCross = variant === BackgroundVariant.Cross;\nconst gapXY = Array.isArray(gap) ? gap : [gap, gap];\n$: patternId = `background-pattern-${$flowId}-${id ? id : ''}`;\n$: scaledGap = [gapXY[0] * $viewport.zoom || 1, gapXY[1] * $viewport.zoom || 1];\n$: scaledSize = patternSize * $viewport.zoom;\n$: patternDimensions = (isCross ? [scaledSize, scaledSize] : scaledGap);\n$: patternOffset = isDots\n    ? [scaledSize / 2, scaledSize / 2]\n    : [patternDimensions[0] / 2, patternDimensions[1] / 2];\n</script>\n\n<svg\n  class={cc(['svelte-flow__background', className])}\n  data-testid=\"svelte-flow__background\"\n  style:--xy-background-color-props={bgColor}\n  style:--xy-background-pattern-color-props={patternColor}\n>\n  <pattern\n    id={patternId}\n    x={$viewport.x % scaledGap[0]}\n    y={$viewport.y % scaledGap[1]}\n    width={scaledGap[0]}\n    height={scaledGap[1]}\n    patternUnits=\"userSpaceOnUse\"\n    patternTransform={`translate(-${patternOffset[0]},-${patternOffset[1]})`}\n  >\n    {#if isDots}\n      <DotPattern radius={scaledSize / 2} class={patternClass} />\n    {:else}\n      <LinePattern dimensions={patternDimensions} {variant} {lineWidth} class={patternClass} />\n    {/if}\n  </pattern>\n  <rect x=\"0\" y=\"0\" width=\"100%\" height=\"100%\" fill={`url(#${patternId})`} />\n</svg>\n\n<style>\n  .svelte-flow__background {\n    position: absolute;\n    width: 100%;\n    height: 100%;\n    top: 0;\n    left: 0;\n  }\n</style>\n","import { isNodeBase, isEdgeBase } from '@xyflow/system';\n/**\n * Test whether an object is usable as a Node\n * @public\n * @remarks In TypeScript this is a type guard that will narrow the type of whatever you pass in to Node if it returns true\n * @param element - The element to test\n * @returns A boolean indicating whether the element is an Node\n */\nexport const isNode = (element) => isNodeBase(element);\n/**\n * Test whether an object is usable as an Edge\n * @public\n * @remarks In TypeScript this is a type guard that will narrow the type of whatever you pass in to Edge if it returns true\n * @param element - The element to test\n * @returns A boolean indicating whether the element is an Edge\n */\nexport const isEdge = (element) => isEdgeBase(element);\n","import { get } from 'svelte/store';\nimport { getOverlappingArea, isRectObject, nodeToRect, pointToRendererPoint, getViewportForBounds, getElementsToRemove, rendererPointToPoint, evaluateAbsolutePosition, getNodesBounds } from '@xyflow/system';\nimport { useStore } from '../store';\nimport { isNode } from '../utils';\n/**\n * Hook for accessing the ReactFlow instance.\n *\n * @public\n *\n * @returns helper functions\n */\nexport function useSvelteFlow() {\n    const { zoomIn, zoomOut, fitView, onbeforedelete, snapGrid, viewport, width, height, minZoom, maxZoom, panZoom, nodes, edges, domNode, nodeLookup, nodeOrigin, edgeLookup, connectionLookup } = useStore();\n    const getNodeRect = (node) => {\n        const $nodeLookup = get(nodeLookup);\n        const nodeToUse = isNode(node) ? node : $nodeLookup.get(node.id);\n        const position = nodeToUse.parentId\n            ? evaluateAbsolutePosition(nodeToUse.position, nodeToUse.measured, nodeToUse.parentId, $nodeLookup, get(nodeOrigin))\n            : nodeToUse.position;\n        const nodeWithPosition = {\n            ...nodeToUse,\n            position,\n            width: nodeToUse.measured?.width ?? nodeToUse.width,\n            height: nodeToUse.measured?.height ?? nodeToUse.height\n        };\n        return nodeToRect(nodeWithPosition);\n    };\n    const updateNode = (id, nodeUpdate, options = { replace: false }) => {\n        const node = get(nodeLookup).get(id)?.internals.userNode;\n        if (!node) {\n            return;\n        }\n        const nextNode = typeof nodeUpdate === 'function' ? nodeUpdate(node) : nodeUpdate;\n        if (options.replace) {\n            nodes.update((nds) => nds.map((node) => {\n                if (node.id === id) {\n                    return isNode(nextNode) ? nextNode : { ...node, ...nextNode };\n                }\n                return node;\n            }));\n        }\n        else {\n            Object.assign(node, nextNode);\n            nodes.update((nds) => nds);\n        }\n    };\n    const getInternalNode = (id) => get(nodeLookup).get(id);\n    return {\n        zoomIn,\n        zoomOut,\n        getInternalNode,\n        getNode: (id) => getInternalNode(id)?.internals.userNode,\n        getNodes: (ids) => (ids === undefined ? get(nodes) : getElements(get(nodeLookup), ids)),\n        getEdge: (id) => get(edgeLookup).get(id),\n        getEdges: (ids) => (ids === undefined ? get(edges) : getElements(get(edgeLookup), ids)),\n        setZoom: (zoomLevel, options) => {\n            const currentPanZoom = get(panZoom);\n            return currentPanZoom\n                ? currentPanZoom.scaleTo(zoomLevel, { duration: options?.duration })\n                : Promise.resolve(false);\n        },\n        getZoom: () => get(viewport).zoom,\n        setViewport: async (nextViewport, options) => {\n            const currentViewport = get(viewport);\n            const currentPanZoom = get(panZoom);\n            if (!currentPanZoom) {\n                return Promise.resolve(false);\n            }\n            await currentPanZoom.setViewport({\n                x: nextViewport.x ?? currentViewport.x,\n                y: nextViewport.y ?? currentViewport.y,\n                zoom: nextViewport.zoom ?? currentViewport.zoom\n            }, { duration: options?.duration });\n            return Promise.resolve(true);\n        },\n        getViewport: () => get(viewport),\n        setCenter: async (x, y, options) => {\n            const nextZoom = typeof options?.zoom !== 'undefined' ? options.zoom : get(maxZoom);\n            const currentPanZoom = get(panZoom);\n            if (!currentPanZoom) {\n                return Promise.resolve(false);\n            }\n            await currentPanZoom.setViewport({\n                x: get(width) / 2 - x * nextZoom,\n                y: get(height) / 2 - y * nextZoom,\n                zoom: nextZoom\n            }, { duration: options?.duration });\n            return Promise.resolve(true);\n        },\n        fitView,\n        fitBounds: async (bounds, options) => {\n            const currentPanZoom = get(panZoom);\n            if (!currentPanZoom) {\n                return Promise.resolve(false);\n            }\n            const viewport = getViewportForBounds(bounds, get(width), get(height), get(minZoom), get(maxZoom), options?.padding ?? 0.1);\n            await currentPanZoom.setViewport(viewport, { duration: options?.duration });\n            return Promise.resolve(true);\n        },\n        getIntersectingNodes: (nodeOrRect, partially = true, nodesToIntersect) => {\n            const isRect = isRectObject(nodeOrRect);\n            const nodeRect = isRect ? nodeOrRect : getNodeRect(nodeOrRect);\n            if (!nodeRect) {\n                return [];\n            }\n            return (nodesToIntersect || get(nodes)).filter((n) => {\n                const internalNode = get(nodeLookup).get(n.id);\n                if (!internalNode || (!isRect && n.id === nodeOrRect.id)) {\n                    return false;\n                }\n                const currNodeRect = nodeToRect(internalNode);\n                const overlappingArea = getOverlappingArea(currNodeRect, nodeRect);\n                const partiallyVisible = partially && overlappingArea > 0;\n                return partiallyVisible || overlappingArea >= nodeRect.width * nodeRect.height;\n            });\n        },\n        isNodeIntersecting: (nodeOrRect, area, partially = true) => {\n            const isRect = isRectObject(nodeOrRect);\n            const nodeRect = isRect ? nodeOrRect : getNodeRect(nodeOrRect);\n            if (!nodeRect) {\n                return false;\n            }\n            const overlappingArea = getOverlappingArea(nodeRect, area);\n            const partiallyVisible = partially && overlappingArea > 0;\n            return partiallyVisible || overlappingArea >= nodeRect.width * nodeRect.height;\n        },\n        deleteElements: async ({ nodes: nodesToRemove = [], edges: edgesToRemove = [] }) => {\n            const { nodes: matchingNodes, edges: matchingEdges } = await getElementsToRemove({\n                nodesToRemove,\n                edgesToRemove,\n                nodes: get(nodes),\n                edges: get(edges),\n                onBeforeDelete: get(onbeforedelete)\n            });\n            if (matchingNodes) {\n                nodes.update((nds) => nds.filter((node) => !matchingNodes.some(({ id }) => id === node.id)));\n            }\n            if (matchingEdges) {\n                edges.update((eds) => eds.filter((edge) => !matchingEdges.some(({ id }) => id === edge.id)));\n            }\n            return {\n                deletedNodes: matchingNodes,\n                deletedEdges: matchingEdges\n            };\n        },\n        screenToFlowPosition: (position, options = { snapToGrid: true }) => {\n            const _domNode = get(domNode);\n            if (!_domNode) {\n                return position;\n            }\n            const _snapGrid = options.snapToGrid ? get(snapGrid) : false;\n            const { x, y, zoom } = get(viewport);\n            const { x: domX, y: domY } = _domNode.getBoundingClientRect();\n            const correctedPosition = {\n                x: position.x - domX,\n                y: position.y - domY\n            };\n            return pointToRendererPoint(correctedPosition, [x, y, zoom], _snapGrid !== null, _snapGrid || [1, 1]);\n        },\n        /**\n         *\n         * @param position\n         * @returns\n         */\n        flowToScreenPosition: (position) => {\n            const _domNode = get(domNode);\n            if (!_domNode) {\n                return position;\n            }\n            const { x, y, zoom } = get(viewport);\n            const { x: domX, y: domY } = _domNode.getBoundingClientRect();\n            const rendererPosition = rendererPointToPoint(position, [x, y, zoom]);\n            return {\n                x: rendererPosition.x + domX,\n                y: rendererPosition.y + domY\n            };\n        },\n        toObject: () => {\n            return {\n                nodes: get(nodes).map((node) => ({\n                    ...node,\n                    // we want to make sure that changes to the nodes object that gets returned by toObject\n                    // do not affect the nodes object\n                    position: { ...node.position },\n                    data: { ...node.data }\n                })),\n                edges: get(edges).map((edge) => ({ ...edge })),\n                viewport: { ...get(viewport) }\n            };\n        },\n        updateNode,\n        updateNodeData: (id, dataUpdate, options) => {\n            const node = get(nodeLookup).get(id)?.internals.userNode;\n            if (!node) {\n                return;\n            }\n            const nextData = typeof dataUpdate === 'function' ? dataUpdate(node) : dataUpdate;\n            node.data = options?.replace ? nextData : { ...node.data, ...nextData };\n            nodes.update((nds) => nds);\n        },\n        getNodesBounds: (nodes) => {\n            const _nodeLookup = get(nodeLookup);\n            const _nodeOrigin = get(nodeOrigin);\n            return getNodesBounds(nodes, { nodeLookup: _nodeLookup, nodeOrigin: _nodeOrigin });\n        },\n        getHandleConnections: ({ type, id, nodeId }) => Array.from(get(connectionLookup)\n            .get(`${nodeId}-${type}-${id ?? null}`)\n            ?.values() ?? []),\n        viewport\n    };\n}\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nfunction getElements(lookup, ids) {\n    const result = [];\n    for (const id of ids) {\n        const item = lookup.get(id);\n        if (item) {\n            const element = 'internals' in item ? item.internals?.userNode : item;\n            result.push(element);\n        }\n    }\n    return result;\n}\n","import { useStore } from '../store';\n/**\n * Hook for seeing if nodes are initialized\n * @returns - nodesInitialized Writable\n */\nexport function useNodesInitialized() {\n    const { nodesInitialized } = useStore();\n    return {\n        subscribe: nodesInitialized.subscribe\n    };\n}\n/**\n * Hook for seeing if the flow is initialized\n * @returns - initialized Writable\n */\nexport function useInitialized() {\n    const { initialized } = useStore();\n    return {\n        subscribe: initialized.subscribe\n    };\n}\n","<script lang=\"ts\">\n\timport { toast } from 'svelte-sonner';\n\n\timport { config, functions, models, settings, tools, user } from '$lib/stores';\n\timport { createEventDispatcher, onMount, getContext, tick } from 'svelte';\n\n\timport {\n\t\tgetUserValvesSpecById as getToolUserValvesSpecById,\n\t\tgetUserValvesById as getToolUserValvesById,\n\t\tupdateUserValvesById as updateToolUserValvesById,\n\t\tgetTools\n\t} from '$lib/apis/tools';\n\timport {\n\t\tgetUserValvesSpecById as getFunctionUserValvesSpecById,\n\t\tgetUserValvesById as getFunctionUserValvesById,\n\t\tupdateUserValvesById as updateFunctionUserValvesById,\n\t\tgetFunctions\n\t} from '$lib/apis/functions';\n\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\n\timport Spinner from '$lib/components/common/Spinner.svelte';\n\timport Valves from '$lib/components/common/Valves.svelte';\n\n\tconst dispatch = createEventDispatcher();\n\n\tconst i18n = getContext('i18n');\n\n\texport let show = false;\n\n\tlet tab = 'tools';\n\tlet selectedId = '';\n\n\tlet loading = false;\n\n\tlet valvesSpec = null;\n\tlet valves = {};\n\n\tlet debounceTimer;\n\n\tconst debounceSubmitHandler = async () => {\n\t\tif (debounceTimer) {\n\t\t\tclearTimeout(debounceTimer);\n\t\t}\n\n\t\t// Set a new timer\n\t\tdebounceTimer = setTimeout(() => {\n\t\t\tsubmitHandler();\n\t\t}, 500); // 0.5 second debounce\n\t};\n\n\tconst getUserValves = async () => {\n\t\tloading = true;\n\t\tif (tab === 'tools') {\n\t\t\tvalves = await getToolUserValvesById(localStorage.token, selectedId);\n\t\t\tvalvesSpec = await getToolUserValvesSpecById(localStorage.token, selectedId);\n\t\t} else if (tab === 'functions') {\n\t\t\tvalves = await getFunctionUserValvesById(localStorage.token, selectedId);\n\t\t\tvalvesSpec = await getFunctionUserValvesSpecById(localStorage.token, selectedId);\n\t\t}\n\n\t\tif (valvesSpec) {\n\t\t\t// Convert array to string\n\t\t\tfor (const property in valvesSpec.properties) {\n\t\t\t\tif (valvesSpec.properties[property]?.type === 'array') {\n\t\t\t\t\tvalves[property] = (valves[property] ?? []).join(',');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tloading = false;\n\t};\n\n\tconst submitHandler = async () => {\n\t\tif (valvesSpec) {\n\t\t\t// Convert string to array\n\t\t\tfor (const property in valvesSpec.properties) {\n\t\t\t\tif (valvesSpec.properties[property]?.type === 'array') {\n\t\t\t\t\tvalves[property] = (valves[property] ?? '').split(',').map((v) => v.trim());\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (tab === 'tools') {\n\t\t\t\tconst res = await updateToolUserValvesById(localStorage.token, selectedId, valves).catch(\n\t\t\t\t\t(error) => {\n\t\t\t\t\t\ttoast.error(`${error}`);\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\tif (res) {\n\t\t\t\t\ttoast.success($i18n.t('Valves updated'));\n\t\t\t\t\tvalves = res;\n\t\t\t\t}\n\t\t\t} else if (tab === 'functions') {\n\t\t\t\tconst res = await updateFunctionUserValvesById(\n\t\t\t\t\tlocalStorage.token,\n\t\t\t\t\tselectedId,\n\t\t\t\t\tvalves\n\t\t\t\t).catch((error) => {\n\t\t\t\t\ttoast.error(`${error}`);\n\t\t\t\t\treturn null;\n\t\t\t\t});\n\n\t\t\t\tif (res) {\n\t\t\t\t\ttoast.success($i18n.t('Valves updated'));\n\t\t\t\t\tvalves = res;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\t$: if (tab) {\n\t\tselectedId = '';\n\t}\n\n\t$: if (selectedId) {\n\t\tgetUserValves();\n\t}\n\n\t$: if (show) {\n\t\tinit();\n\t}\n\n\tconst init = async () => {\n\t\tloading = true;\n\n\t\tif ($functions === null) {\n\t\t\tfunctions.set(await getFunctions(localStorage.token));\n\t\t}\n\t\tif ($tools === null) {\n\t\t\ttools.set(await getTools(localStorage.token));\n\t\t}\n\n\t\tloading = false;\n\t};\n</script>\n\n{#if show && !loading}\n\t<form\n\t\tclass=\"flex flex-col h-full justify-between space-y-3 text-sm\"\n\t\ton:submit|preventDefault={() => {\n\t\t\tsubmitHandler();\n\t\t\tdispatch('save');\n\t\t}}\n\t>\n\t\t<div class=\"flex flex-col\">\n\t\t\t<div class=\"space-y-1\">\n\t\t\t\t<div class=\"flex gap-2\">\n\t\t\t\t\t<div class=\"flex-1\">\n\t\t\t\t\t\t<select\n\t\t\t\t\t\t\tclass=\"  w-full rounded-sm text-xs py-2 px-1 bg-transparent outline-hidden\"\n\t\t\t\t\t\t\tbind:value={tab}\n\t\t\t\t\t\t\tplaceholder=\"Select\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<option value=\"tools\" class=\"bg-gray-100 dark:bg-gray-800\">{$i18n.t('Tools')}</option>\n\t\t\t\t\t\t\t<option value=\"functions\" class=\"bg-gray-100 dark:bg-gray-800\"\n\t\t\t\t\t\t\t\t>{$i18n.t('Functions')}</option\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"flex-1\">\n\t\t\t\t\t\t<select\n\t\t\t\t\t\t\tclass=\"w-full rounded-sm py-2 px-1 text-xs bg-transparent outline-hidden\"\n\t\t\t\t\t\t\tbind:value={selectedId}\n\t\t\t\t\t\t\ton:change={async () => {\n\t\t\t\t\t\t\t\tawait tick();\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{#if tab === 'tools'}\n\t\t\t\t\t\t\t\t<option value=\"\" selected disabled class=\"bg-gray-100 dark:bg-gray-800\"\n\t\t\t\t\t\t\t\t\t>{$i18n.t('Select a tool')}</option\n\t\t\t\t\t\t\t\t>\n\n\t\t\t\t\t\t\t\t{#each $tools as tool, toolIdx}\n\t\t\t\t\t\t\t\t\t<option value={tool.id} class=\"bg-gray-100 dark:bg-gray-800\">{tool.name}</option>\n\t\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t\t{:else if tab === 'functions'}\n\t\t\t\t\t\t\t\t<option value=\"\" selected disabled class=\"bg-gray-100 dark:bg-gray-800\"\n\t\t\t\t\t\t\t\t\t>{$i18n.t('Select a function')}</option\n\t\t\t\t\t\t\t\t>\n\n\t\t\t\t\t\t\t\t{#each $functions as func, funcIdx}\n\t\t\t\t\t\t\t\t\t<option value={func.id} class=\"bg-gray-100 dark:bg-gray-800\">{func.name}</option>\n\t\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t{#if selectedId}\n\t\t\t\t<hr class=\"dark:border-gray-800 my-1 w-full\" />\n\n\t\t\t\t<div class=\"my-2 text-xs\">\n\t\t\t\t\t{#if !loading}\n\t\t\t\t\t\t<Valves\n\t\t\t\t\t\t\t{valvesSpec}\n\t\t\t\t\t\t\tbind:valves\n\t\t\t\t\t\t\ton:change={() => {\n\t\t\t\t\t\t\t\tdebounceSubmitHandler();\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t{:else}\n\t\t\t\t\t\t<Spinner className=\"size-5\" />\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\t\t\t{/if}\n\t\t</div>\n\t</form>\n{:else}\n\t<Spinner className=\"size-4\" />\n{/if}\n","<script lang=\"ts\">\n\timport { createEventDispatcher, getContext } from 'svelte';\n\tconst dispatch = createEventDispatcher();\n\tconst i18n = getContext('i18n');\n\n\timport XMark from '$lib/components/icons/XMark.svelte';\n\timport AdvancedParams from '../Settings/Advanced/AdvancedParams.svelte';\n\timport Valves from '$lib/components/chat/Controls/Valves.svelte';\n\timport FileItem from '$lib/components/common/FileItem.svelte';\n\timport Collapsible from '$lib/components/common/Collapsible.svelte';\n\n\timport { user } from '$lib/stores';\n\texport let models = [];\n\texport let chatFiles = [];\n\texport let params = {};\n\n\tlet showValves = false;\n</script>\n\n<div class=\" dark:text-white\">\n\t<div class=\" flex items-center justify-between dark:text-gray-100 mb-2\">\n\t\t<div class=\" text-lg font-medium self-center font-primary\">{$i18n.t('Chat Controls')}</div>\n\t\t<button\n\t\t\tclass=\"self-center\"\n\t\t\ton:click={() => {\n\t\t\t\tdispatch('close');\n\t\t\t}}\n\t\t>\n\t\t\t<XMark className=\"size-3.5\" />\n\t\t</button>\n\t</div>\n\n\t{#if $user.role === 'admin' || $user?.permissions.chat?.controls}\n\t\t<div class=\" dark:text-gray-200 text-sm font-primary py-0.5 px-0.5\">\n\t\t\t{#if chatFiles.length > 0}\n\t\t\t\t<Collapsible title={$i18n.t('Files')} open={true} buttonClassName=\"w-full\">\n\t\t\t\t\t<div class=\"flex flex-col gap-1 mt-1.5\" slot=\"content\">\n\t\t\t\t\t\t{#each chatFiles as file, fileIdx}\n\t\t\t\t\t\t\t<FileItem\n\t\t\t\t\t\t\t\tclassName=\"w-full\"\n\t\t\t\t\t\t\t\titem={file}\n\t\t\t\t\t\t\t\tedit={true}\n\t\t\t\t\t\t\t\turl={file?.url ? file.url : null}\n\t\t\t\t\t\t\t\tname={file.name}\n\t\t\t\t\t\t\t\ttype={file.type}\n\t\t\t\t\t\t\t\tsize={file?.size}\n\t\t\t\t\t\t\t\tdismissible={true}\n\t\t\t\t\t\t\t\ton:dismiss={() => {\n\t\t\t\t\t\t\t\t\t// Remove the file from the chatFiles array\n\n\t\t\t\t\t\t\t\t\tchatFiles.splice(fileIdx, 1);\n\t\t\t\t\t\t\t\t\tchatFiles = chatFiles;\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\tconsole.log(file);\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t{/each}\n\t\t\t\t\t</div>\n\t\t\t\t</Collapsible>\n\n\t\t\t\t<hr class=\"my-2 border-gray-50 dark:border-gray-700/10\" />\n\t\t\t{/if}\n\n\t\t\t<Collapsible bind:open={showValves} title={$i18n.t('Valves')} buttonClassName=\"w-full\">\n\t\t\t\t<div class=\"text-sm\" slot=\"content\">\n\t\t\t\t\t<Valves show={showValves} />\n\t\t\t\t</div>\n\t\t\t</Collapsible>\n\n\t\t\t<hr class=\"my-2 border-gray-50 dark:border-gray-700/10\" />\n\n\t\t\t<Collapsible title={$i18n.t('System Prompt')} open={true} buttonClassName=\"w-full\">\n\t\t\t\t<div class=\"\" slot=\"content\">\n\t\t\t\t\t<textarea\n\t\t\t\t\t\tbind:value={params.system}\n\t\t\t\t\t\tclass=\"w-full text-xs py-1.5 bg-transparent outline-hidden resize-none\"\n\t\t\t\t\t\trows=\"4\"\n\t\t\t\t\t\tplaceholder={$i18n.t('Enter system prompt')}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</Collapsible>\n\n\t\t\t<hr class=\"my-2 border-gray-50 dark:border-gray-700/10\" />\n\n\t\t\t<Collapsible title={$i18n.t('Advanced Params')} open={true} buttonClassName=\"w-full\">\n\t\t\t\t<div class=\"text-sm mt-1.5\" slot=\"content\">\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<AdvancedParams admin={$user?.role === 'admin'} bind:params />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</Collapsible>\n\t\t</div>\n\t{:else}\n\t\t<div class=\"text-sm dark:text-gray-300 text-center py-2 px-10\">\n\t\t\t{$i18n.t('You do not have permission to access this feature.')}\n\t\t</div>\n\t{/if}\n</div>\n","<script lang=\"ts\">\n\timport { DropdownMenu } from 'bits-ui';\n\timport { flyAndScale } from '$lib/utils/transitions';\n\timport { getContext, createEventDispatcher } from 'svelte';\n\n\tconst i18n = getContext('i18n');\n\tconst dispatch = createEventDispatcher();\n\n\timport Dropdown from '$lib/components/common/Dropdown.svelte';\n\n\texport let onClose: Function = () => {};\n\texport let devices: any;\n\n\tlet show = false;\n</script>\n\n<Dropdown\n\tbind:show\n\ton:change={(e) => {\n\t\tif (e.detail === false) {\n\t\t\tonClose();\n\t\t}\n\t}}\n>\n\t<slot />\n\n\t<div slot=\"content\">\n\t\t<DropdownMenu.Content\n\t\t\tclass=\"w-full max-w-[180px] rounded-lg px-1 py-1.5 border border-gray-300/30 dark:border-gray-700/50 z-9999 bg-white dark:bg-gray-900 dark:text-white shadow-xs\"\n\t\t\tsideOffset={6}\n\t\t\tside=\"top\"\n\t\t\talign=\"start\"\n\t\t\ttransition={flyAndScale}\n\t\t>\n\t\t\t{#each devices as device}\n\t\t\t\t<DropdownMenu.Item\n\t\t\t\t\tclass=\"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md\"\n\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\tdispatch('change', device.deviceId);\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<div class=\"flex items-center\">\n\t\t\t\t\t\t<div class=\" line-clamp-1\">\n\t\t\t\t\t\t\t{device?.label ?? 'Camera'}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</DropdownMenu.Item>\n\t\t\t{/each}\n\t\t</DropdownMenu.Content>\n\t</div>\n</Dropdown>\n","<script lang=\"ts\">\n\timport { config, models, settings, showCallOverlay, TTSWorker } from '$lib/stores';\n\timport { onMount, tick, getContext, onDestroy, createEventDispatcher } from 'svelte';\n\n\tconst dispatch = createEventDispatcher();\n\n\timport { blobToFile } from '$lib/utils';\n\timport { generateEmoji } from '$lib/apis';\n\timport { synthesizeOpenAISpeech, transcribeAudio } from '$lib/apis/audio';\n\n\timport { toast } from 'svelte-sonner';\n\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\n\timport VideoInputMenu from './CallOverlay/VideoInputMenu.svelte';\n\timport { KokoroWorker } from '$lib/workers/KokoroWorker';\n\n\tconst i18n = getContext('i18n');\n\n\texport let eventTarget: EventTarget;\n\texport let submitPrompt: Function;\n\texport let stopResponse: Function;\n\texport let files;\n\texport let chatId;\n\texport let modelId;\n\n\tlet wakeLock = null;\n\n\tlet model = null;\n\n\tlet loading = false;\n\tlet confirmed = false;\n\tlet interrupted = false;\n\tlet assistantSpeaking = false;\n\n\tlet emoji = null;\n\tlet camera = false;\n\tlet cameraStream = null;\n\n\tlet chatStreaming = false;\n\tlet rmsLevel = 0;\n\tlet hasStartedSpeaking = false;\n\tlet mediaRecorder;\n\tlet audioStream = null;\n\tlet audioChunks = [];\n\n\tlet videoInputDevices = [];\n\tlet selectedVideoInputDeviceId = null;\n\n\tconst getVideoInputDevices = async () => {\n\t\tconst devices = await navigator.mediaDevices.enumerateDevices();\n\t\tvideoInputDevices = devices.filter((device) => device.kind === 'videoinput');\n\n\t\tif (!!navigator.mediaDevices.getDisplayMedia) {\n\t\t\tvideoInputDevices = [\n\t\t\t\t...videoInputDevices,\n\t\t\t\t{\n\t\t\t\t\tdeviceId: 'screen',\n\t\t\t\t\tlabel: 'Screen Share'\n\t\t\t\t}\n\t\t\t];\n\t\t}\n\n\t\tconsole.log(videoInputDevices);\n\t\tif (selectedVideoInputDeviceId === null && videoInputDevices.length > 0) {\n\t\t\tselectedVideoInputDeviceId = videoInputDevices[0].deviceId;\n\t\t}\n\t};\n\n\tconst startCamera = async () => {\n\t\tawait getVideoInputDevices();\n\n\t\tif (cameraStream === null) {\n\t\t\tcamera = true;\n\t\t\tawait tick();\n\t\t\ttry {\n\t\t\t\tawait startVideoStream();\n\t\t\t} catch (err) {\n\t\t\t\tconsole.error('Error accessing webcam: ', err);\n\t\t\t}\n\t\t}\n\t};\n\n\tconst startVideoStream = async () => {\n\t\tconst video = document.getElementById('camera-feed');\n\t\tif (video) {\n\t\t\tif (selectedVideoInputDeviceId === 'screen') {\n\t\t\t\tcameraStream = await navigator.mediaDevices.getDisplayMedia({\n\t\t\t\t\tvideo: {\n\t\t\t\t\t\tcursor: 'always'\n\t\t\t\t\t},\n\t\t\t\t\taudio: false\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tcameraStream = await navigator.mediaDevices.getUserMedia({\n\t\t\t\t\tvideo: {\n\t\t\t\t\t\tdeviceId: selectedVideoInputDeviceId ? { exact: selectedVideoInputDeviceId } : undefined\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (cameraStream) {\n\t\t\t\tawait getVideoInputDevices();\n\t\t\t\tvideo.srcObject = cameraStream;\n\t\t\t\tawait video.play();\n\t\t\t}\n\t\t}\n\t};\n\n\tconst stopVideoStream = async () => {\n\t\tif (cameraStream) {\n\t\t\tconst tracks = cameraStream.getTracks();\n\t\t\ttracks.forEach((track) => track.stop());\n\t\t}\n\n\t\tcameraStream = null;\n\t};\n\n\tconst takeScreenshot = () => {\n\t\tconst video = document.getElementById('camera-feed');\n\t\tconst canvas = document.getElementById('camera-canvas');\n\n\t\tif (!canvas) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst context = canvas.getContext('2d');\n\n\t\t// Make the canvas match the video dimensions\n\t\tcanvas.width = video.videoWidth;\n\t\tcanvas.height = video.videoHeight;\n\n\t\t// Draw the image from the video onto the canvas\n\t\tcontext.drawImage(video, 0, 0, video.videoWidth, video.videoHeight);\n\n\t\t// Convert the canvas to a data base64 URL and console log it\n\t\tconst dataURL = canvas.toDataURL('image/png');\n\t\tconsole.log(dataURL);\n\n\t\treturn dataURL;\n\t};\n\n\tconst stopCamera = async () => {\n\t\tawait stopVideoStream();\n\t\tcamera = false;\n\t};\n\n\tconst MIN_DECIBELS = -55;\n\tconst VISUALIZER_BUFFER_LENGTH = 300;\n\n\tconst transcribeHandler = async (audioBlob) => {\n\t\t// Create a blob from the audio chunks\n\n\t\tawait tick();\n\t\tconst file = blobToFile(audioBlob, 'recording.wav');\n\n\t\tconst res = await transcribeAudio(localStorage.token, file).catch((error) => {\n\t\t\ttoast.error(`${error}`);\n\t\t\treturn null;\n\t\t});\n\n\t\tif (res) {\n\t\t\tconsole.log(res.text);\n\n\t\t\tif (res.text !== '') {\n\t\t\t\tconst _responses = await submitPrompt(res.text, { _raw: true });\n\t\t\t\tconsole.log(_responses);\n\t\t\t}\n\t\t}\n\t};\n\n\tconst stopRecordingCallback = async (_continue = true) => {\n\t\tif ($showCallOverlay) {\n\t\t\tconsole.log('%c%s', 'color: red; font-size: 20px;', '🚨 stopRecordingCallback 🚨');\n\n\t\t\t// deep copy the audioChunks array\n\t\t\tconst _audioChunks = audioChunks.slice(0);\n\n\t\t\taudioChunks = [];\n\t\t\tmediaRecorder = false;\n\n\t\t\tif (_continue) {\n\t\t\t\tstartRecording();\n\t\t\t}\n\n\t\t\tif (confirmed) {\n\t\t\t\tloading = true;\n\t\t\t\temoji = null;\n\n\t\t\t\tif (cameraStream) {\n\t\t\t\t\tconst imageUrl = takeScreenshot();\n\n\t\t\t\t\tfiles = [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttype: 'image',\n\t\t\t\t\t\t\turl: imageUrl\n\t\t\t\t\t\t}\n\t\t\t\t\t];\n\t\t\t\t}\n\n\t\t\t\tconst audioBlob = new Blob(_audioChunks, { type: 'audio/wav' });\n\t\t\t\tawait transcribeHandler(audioBlob);\n\n\t\t\t\tconfirmed = false;\n\t\t\t\tloading = false;\n\t\t\t}\n\t\t} else {\n\t\t\taudioChunks = [];\n\t\t\tmediaRecorder = false;\n\n\t\t\tif (audioStream) {\n\t\t\t\tconst tracks = audioStream.getTracks();\n\t\t\t\ttracks.forEach((track) => track.stop());\n\t\t\t}\n\t\t\taudioStream = null;\n\t\t}\n\t};\n\n\tconst startRecording = async () => {\n\t\tif ($showCallOverlay) {\n\t\t\tif (!audioStream) {\n\t\t\t\taudioStream = await navigator.mediaDevices.getUserMedia({\n\t\t\t\t\taudio: {\n\t\t\t\t\t\techoCancellation: true,\n\t\t\t\t\t\tnoiseSuppression: true,\n\t\t\t\t\t\tautoGainControl: true\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\tmediaRecorder = new MediaRecorder(audioStream);\n\n\t\t\tmediaRecorder.onstart = () => {\n\t\t\t\tconsole.log('Recording started');\n\t\t\t\taudioChunks = [];\n\t\t\t\tanalyseAudio(audioStream);\n\t\t\t};\n\n\t\t\tmediaRecorder.ondataavailable = (event) => {\n\t\t\t\tif (hasStartedSpeaking) {\n\t\t\t\t\taudioChunks.push(event.data);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tmediaRecorder.onstop = (e) => {\n\t\t\t\tconsole.log('Recording stopped', audioStream, e);\n\t\t\t\tstopRecordingCallback();\n\t\t\t};\n\n\t\t\tmediaRecorder.start();\n\t\t}\n\t};\n\n\tconst stopAudioStream = async () => {\n\t\ttry {\n\t\t\tif (mediaRecorder) {\n\t\t\t\tmediaRecorder.stop();\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tconsole.log('Error stopping audio stream:', error);\n\t\t}\n\n\t\tif (!audioStream) return;\n\n\t\taudioStream.getAudioTracks().forEach(function (track) {\n\t\t\ttrack.stop();\n\t\t});\n\n\t\taudioStream = null;\n\t};\n\n\t// Function to calculate the RMS level from time domain data\n\tconst calculateRMS = (data: Uint8Array) => {\n\t\tlet sumSquares = 0;\n\t\tfor (let i = 0; i < data.length; i++) {\n\t\t\tconst normalizedValue = (data[i] - 128) / 128; // Normalize the data\n\t\t\tsumSquares += normalizedValue * normalizedValue;\n\t\t}\n\t\treturn Math.sqrt(sumSquares / data.length);\n\t};\n\n\tconst analyseAudio = (stream) => {\n\t\tconst audioContext = new AudioContext();\n\t\tconst audioStreamSource = audioContext.createMediaStreamSource(stream);\n\n\t\tconst analyser = audioContext.createAnalyser();\n\t\tanalyser.minDecibels = MIN_DECIBELS;\n\t\taudioStreamSource.connect(analyser);\n\n\t\tconst bufferLength = analyser.frequencyBinCount;\n\n\t\tconst domainData = new Uint8Array(bufferLength);\n\t\tconst timeDomainData = new Uint8Array(analyser.fftSize);\n\n\t\tlet lastSoundTime = Date.now();\n\t\thasStartedSpeaking = false;\n\n\t\tconsole.log('🔊 Sound detection started', lastSoundTime, hasStartedSpeaking);\n\n\t\tconst detectSound = () => {\n\t\t\tconst processFrame = () => {\n\t\t\t\tif (!mediaRecorder || !$showCallOverlay) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (assistantSpeaking && !($settings?.voiceInterruption ?? false)) {\n\t\t\t\t\t// Mute the audio if the assistant is speaking\n\t\t\t\t\tanalyser.maxDecibels = 0;\n\t\t\t\t\tanalyser.minDecibels = -1;\n\t\t\t\t} else {\n\t\t\t\t\tanalyser.minDecibels = MIN_DECIBELS;\n\t\t\t\t\tanalyser.maxDecibels = -30;\n\t\t\t\t}\n\n\t\t\t\tanalyser.getByteTimeDomainData(timeDomainData);\n\t\t\t\tanalyser.getByteFrequencyData(domainData);\n\n\t\t\t\t// Calculate RMS level from time domain data\n\t\t\t\trmsLevel = calculateRMS(timeDomainData);\n\n\t\t\t\t// Check if initial speech/noise has started\n\t\t\t\tconst hasSound = domainData.some((value) => value > 0);\n\t\t\t\tif (hasSound) {\n\t\t\t\t\t// BIG RED TEXT\n\t\t\t\t\tconsole.log('%c%s', 'color: red; font-size: 20px;', '🔊 Sound detected');\n\n\t\t\t\t\tif (!hasStartedSpeaking) {\n\t\t\t\t\t\thasStartedSpeaking = true;\n\t\t\t\t\t\tstopAllAudio();\n\t\t\t\t\t}\n\n\t\t\t\t\tlastSoundTime = Date.now();\n\t\t\t\t}\n\n\t\t\t\t// Start silence detection only after initial speech/noise has been detected\n\t\t\t\tif (hasStartedSpeaking) {\n\t\t\t\t\tif (Date.now() - lastSoundTime > 2000) {\n\t\t\t\t\t\tconfirmed = true;\n\n\t\t\t\t\t\tif (mediaRecorder) {\n\t\t\t\t\t\t\tconsole.log('%c%s', 'color: red; font-size: 20px;', '🔇 Silence detected');\n\t\t\t\t\t\t\tmediaRecorder.stop();\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\twindow.requestAnimationFrame(processFrame);\n\t\t\t};\n\n\t\t\twindow.requestAnimationFrame(processFrame);\n\t\t};\n\n\t\tdetectSound();\n\t};\n\n\tlet finishedMessages = {};\n\tlet currentMessageId = null;\n\tlet currentUtterance = null;\n\n\tconst speakSpeechSynthesisHandler = (content) => {\n\t\tif ($showCallOverlay) {\n\t\t\treturn new Promise((resolve) => {\n\t\t\t\tlet voices = [];\n\t\t\t\tconst getVoicesLoop = setInterval(async () => {\n\t\t\t\t\tvoices = await speechSynthesis.getVoices();\n\t\t\t\t\tif (voices.length > 0) {\n\t\t\t\t\t\tclearInterval(getVoicesLoop);\n\n\t\t\t\t\t\tconst voice =\n\t\t\t\t\t\t\tvoices\n\t\t\t\t\t\t\t\t?.filter(\n\t\t\t\t\t\t\t\t\t(v) => v.voiceURI === ($settings?.audio?.tts?.voice ?? $config?.audio?.tts?.voice)\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t?.at(0) ?? undefined;\n\n\t\t\t\t\t\tcurrentUtterance = new SpeechSynthesisUtterance(content);\n\t\t\t\t\t\tcurrentUtterance.rate = $settings.audio?.tts?.playbackRate ?? 1;\n\n\t\t\t\t\t\tif (voice) {\n\t\t\t\t\t\t\tcurrentUtterance.voice = voice;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tspeechSynthesis.speak(currentUtterance);\n\t\t\t\t\t\tcurrentUtterance.onend = async (e) => {\n\t\t\t\t\t\t\tawait new Promise((r) => setTimeout(r, 200));\n\t\t\t\t\t\t\tresolve(e);\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t}, 100);\n\t\t\t});\n\t\t} else {\n\t\t\treturn Promise.resolve();\n\t\t}\n\t};\n\n\tconst playAudio = (audio) => {\n\t\tif ($showCallOverlay) {\n\t\t\treturn new Promise((resolve) => {\n\t\t\t\tconst audioElement = document.getElementById('audioElement') as HTMLAudioElement;\n\n\t\t\t\tif (audioElement) {\n\t\t\t\t\taudioElement.src = audio.src;\n\t\t\t\t\taudioElement.muted = true;\n\t\t\t\t\taudioElement.playbackRate = $settings.audio?.tts?.playbackRate ?? 1;\n\n\t\t\t\t\taudioElement\n\t\t\t\t\t\t.play()\n\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\taudioElement.muted = false;\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch((error) => {\n\t\t\t\t\t\t\tconsole.error(error);\n\t\t\t\t\t\t});\n\n\t\t\t\t\taudioElement.onended = async (e) => {\n\t\t\t\t\t\tawait new Promise((r) => setTimeout(r, 100));\n\t\t\t\t\t\tresolve(e);\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\treturn Promise.resolve();\n\t\t}\n\t};\n\n\tconst stopAllAudio = async () => {\n\t\tassistantSpeaking = false;\n\t\tinterrupted = true;\n\n\t\tif (chatStreaming) {\n\t\t\tstopResponse();\n\t\t}\n\n\t\tif (currentUtterance) {\n\t\t\tspeechSynthesis.cancel();\n\t\t\tcurrentUtterance = null;\n\t\t}\n\n\t\tconst audioElement = document.getElementById('audioElement');\n\t\tif (audioElement) {\n\t\t\taudioElement.muted = true;\n\t\t\taudioElement.pause();\n\t\t\taudioElement.currentTime = 0;\n\t\t}\n\t};\n\n\tlet audioAbortController = new AbortController();\n\n\t// Audio cache map where key is the content and value is the Audio object.\n\tconst audioCache = new Map();\n\tconst emojiCache = new Map();\n\n\tconst fetchAudio = async (content) => {\n\t\tif (!audioCache.has(content)) {\n\t\t\ttry {\n\t\t\t\t// Set the emoji for the content if needed\n\t\t\t\tif ($settings?.showEmojiInCall ?? false) {\n\t\t\t\t\tconst emoji = await generateEmoji(localStorage.token, modelId, content, chatId);\n\t\t\t\t\tif (emoji) {\n\t\t\t\t\t\temojiCache.set(content, emoji);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ($settings.audio?.tts?.engine === 'browser-kokoro') {\n\t\t\t\t\tconst blob = await $TTSWorker\n\t\t\t\t\t\t.generate({\n\t\t\t\t\t\t\ttext: content,\n\t\t\t\t\t\t\tvoice: $settings?.audio?.tts?.voice ?? $config?.audio?.tts?.voice\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch((error) => {\n\t\t\t\t\t\t\tconsole.error(error);\n\t\t\t\t\t\t\ttoast.error(`${error}`);\n\t\t\t\t\t\t});\n\n\t\t\t\t\tif (blob) {\n\t\t\t\t\t\taudioCache.set(content, new Audio(blob));\n\t\t\t\t\t}\n\t\t\t\t} else if ($config.audio.tts.engine !== '') {\n\t\t\t\t\tconst res = await synthesizeOpenAISpeech(\n\t\t\t\t\t\tlocalStorage.token,\n\t\t\t\t\t\t$settings?.audio?.tts?.defaultVoice === $config.audio.tts.voice\n\t\t\t\t\t\t\t? ($settings?.audio?.tts?.voice ?? $config?.audio?.tts?.voice)\n\t\t\t\t\t\t\t: $config?.audio?.tts?.voice,\n\t\t\t\t\t\tcontent\n\t\t\t\t\t).catch((error) => {\n\t\t\t\t\t\tconsole.error(error);\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t});\n\n\t\t\t\t\tif (res) {\n\t\t\t\t\t\tconst blob = await res.blob();\n\t\t\t\t\t\tconst blobUrl = URL.createObjectURL(blob);\n\t\t\t\t\t\taudioCache.set(content, new Audio(blobUrl));\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\taudioCache.set(content, true);\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error('Error synthesizing speech:', error);\n\t\t\t}\n\t\t}\n\n\t\treturn audioCache.get(content);\n\t};\n\n\tlet messages = {};\n\n\tconst monitorAndPlayAudio = async (id, signal) => {\n\t\twhile (!signal.aborted) {\n\t\t\tif (messages[id] && messages[id].length > 0) {\n\t\t\t\t// Retrieve the next content string from the queue\n\t\t\t\tconst content = messages[id].shift(); // Dequeues the content for playing\n\n\t\t\t\tif (audioCache.has(content)) {\n\t\t\t\t\t// If content is available in the cache, play it\n\n\t\t\t\t\t// Set the emoji for the content if available\n\t\t\t\t\tif (($settings?.showEmojiInCall ?? false) && emojiCache.has(content)) {\n\t\t\t\t\t\temoji = emojiCache.get(content);\n\t\t\t\t\t} else {\n\t\t\t\t\t\temoji = null;\n\t\t\t\t\t}\n\n\t\t\t\t\tif ($config.audio.tts.engine !== '') {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tconsole.log(\n\t\t\t\t\t\t\t\t'%c%s',\n\t\t\t\t\t\t\t\t'color: red; font-size: 20px;',\n\t\t\t\t\t\t\t\t`Playing audio for content: ${content}`\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tconst audio = audioCache.get(content);\n\t\t\t\t\t\t\tawait playAudio(audio); // Here ensure that playAudio is indeed correct method to execute\n\t\t\t\t\t\t\tconsole.log(`Played audio for content: ${content}`);\n\t\t\t\t\t\t\tawait new Promise((resolve) => setTimeout(resolve, 200)); // Wait before retrying to reduce tight loop\n\t\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t\tconsole.error('Error playing audio:', error);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tawait speakSpeechSynthesisHandler(content);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// If not available in the cache, push it back to the queue and delay\n\t\t\t\t\tmessages[id].unshift(content); // Re-queue the content at the start\n\t\t\t\t\tconsole.log(`Audio for \"${content}\" not yet available in the cache, re-queued...`);\n\t\t\t\t\tawait new Promise((resolve) => setTimeout(resolve, 200)); // Wait before retrying to reduce tight loop\n\t\t\t\t}\n\t\t\t} else if (finishedMessages[id] && messages[id] && messages[id].length === 0) {\n\t\t\t\t// If the message is finished and there are no more messages to process, break the loop\n\t\t\t\tassistantSpeaking = false;\n\t\t\t\tbreak;\n\t\t\t} else {\n\t\t\t\t// No messages to process, sleep for a bit\n\t\t\t\tawait new Promise((resolve) => setTimeout(resolve, 200));\n\t\t\t}\n\t\t}\n\t\tconsole.log(`Audio monitoring and playing stopped for message ID ${id}`);\n\t};\n\n\tconst chatStartHandler = async (e) => {\n\t\tconst { id } = e.detail;\n\n\t\tchatStreaming = true;\n\n\t\tif (currentMessageId !== id) {\n\t\t\tconsole.log(`Received chat start event for message ID ${id}`);\n\n\t\t\tcurrentMessageId = id;\n\t\t\tif (audioAbortController) {\n\t\t\t\taudioAbortController.abort();\n\t\t\t}\n\t\t\taudioAbortController = new AbortController();\n\n\t\t\tassistantSpeaking = true;\n\t\t\t// Start monitoring and playing audio for the message ID\n\t\t\tmonitorAndPlayAudio(id, audioAbortController.signal);\n\t\t}\n\t};\n\n\tconst chatEventHandler = async (e) => {\n\t\tconst { id, content } = e.detail;\n\t\t// \"id\" here is message id\n\t\t// if \"id\" is not the same as \"currentMessageId\" then do not process\n\t\t// \"content\" here is a sentence from the assistant,\n\t\t// there will be many sentences for the same \"id\"\n\n\t\tif (currentMessageId === id) {\n\t\t\tconsole.log(`Received chat event for message ID ${id}: ${content}`);\n\n\t\t\ttry {\n\t\t\t\tif (messages[id] === undefined) {\n\t\t\t\t\tmessages[id] = [content];\n\t\t\t\t} else {\n\t\t\t\t\tmessages[id].push(content);\n\t\t\t\t}\n\n\t\t\t\tconsole.log(content);\n\n\t\t\t\tfetchAudio(content);\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error('Failed to fetch or play audio:', error);\n\t\t\t}\n\t\t}\n\t};\n\n\tconst chatFinishHandler = async (e) => {\n\t\tconst { id, content } = e.detail;\n\t\t// \"content\" here is the entire message from the assistant\n\t\tfinishedMessages[id] = true;\n\n\t\tchatStreaming = false;\n\t};\n\n\tonMount(async () => {\n\t\tconst setWakeLock = async () => {\n\t\t\ttry {\n\t\t\t\twakeLock = await navigator.wakeLock.request('screen');\n\t\t\t} catch (err) {\n\t\t\t\t// The Wake Lock request has failed - usually system related, such as battery.\n\t\t\t\tconsole.log(err);\n\t\t\t}\n\n\t\t\tif (wakeLock) {\n\t\t\t\t// Add a listener to release the wake lock when the page is unloaded\n\t\t\t\twakeLock.addEventListener('release', () => {\n\t\t\t\t\t// the wake lock has been released\n\t\t\t\t\tconsole.log('Wake Lock released');\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\n\t\tif ('wakeLock' in navigator) {\n\t\t\tawait setWakeLock();\n\n\t\t\tdocument.addEventListener('visibilitychange', async () => {\n\t\t\t\t// Re-request the wake lock if the document becomes visible\n\t\t\t\tif (wakeLock !== null && document.visibilityState === 'visible') {\n\t\t\t\t\tawait setWakeLock();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tmodel = $models.find((m) => m.id === modelId);\n\n\t\tstartRecording();\n\n\t\teventTarget.addEventListener('chat:start', chatStartHandler);\n\t\teventTarget.addEventListener('chat', chatEventHandler);\n\t\teventTarget.addEventListener('chat:finish', chatFinishHandler);\n\n\t\treturn async () => {\n\t\t\tawait stopAllAudio();\n\n\t\t\tstopAudioStream();\n\n\t\t\teventTarget.removeEventListener('chat:start', chatStartHandler);\n\t\t\teventTarget.removeEventListener('chat', chatEventHandler);\n\t\t\teventTarget.removeEventListener('chat:finish', chatFinishHandler);\n\n\t\t\taudioAbortController.abort();\n\t\t\tawait tick();\n\n\t\t\tawait stopAllAudio();\n\n\t\t\tawait stopRecordingCallback(false);\n\t\t\tawait stopCamera();\n\t\t};\n\t});\n\n\tonDestroy(async () => {\n\t\tawait stopAllAudio();\n\t\tawait stopRecordingCallback(false);\n\t\tawait stopCamera();\n\n\t\tawait stopAudioStream();\n\t\teventTarget.removeEventListener('chat:start', chatStartHandler);\n\t\teventTarget.removeEventListener('chat', chatEventHandler);\n\t\teventTarget.removeEventListener('chat:finish', chatFinishHandler);\n\t\taudioAbortController.abort();\n\n\t\tawait tick();\n\n\t\tawait stopAllAudio();\n\t});\n</script>\n\n{#if $showCallOverlay}\n\t<div class=\"max-w-lg w-full h-full max-h-[100dvh] flex flex-col justify-between p-3 md:p-6\">\n\t\t{#if camera}\n\t\t\t<button\n\t\t\t\ttype=\"button\"\n\t\t\t\tclass=\"flex justify-center items-center w-full h-20 min-h-20\"\n\t\t\t\ton:click={() => {\n\t\t\t\t\tif (assistantSpeaking) {\n\t\t\t\t\t\tstopAllAudio();\n\t\t\t\t\t}\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t{#if emoji}\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"  transition-all rounded-full\"\n\t\t\t\t\t\tstyle=\"font-size:{rmsLevel * 100 > 4\n\t\t\t\t\t\t\t? '4.5'\n\t\t\t\t\t\t\t: rmsLevel * 100 > 2\n\t\t\t\t\t\t\t\t? '4.25'\n\t\t\t\t\t\t\t\t: rmsLevel * 100 > 1\n\t\t\t\t\t\t\t\t\t? '3.75'\n\t\t\t\t\t\t\t\t\t: '3.5'}rem;width: 100%; text-align:center;\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{emoji}\n\t\t\t\t\t</div>\n\t\t\t\t{:else if loading || assistantSpeaking}\n\t\t\t\t\t<svg\n\t\t\t\t\t\tclass=\"size-12 text-gray-900 dark:text-gray-400\"\n\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t><style>\n\t\t\t\t\t\t\t.spinner_qM83 {\n\t\t\t\t\t\t\t\tanimation: spinner_8HQG 1.05s infinite;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t.spinner_oXPr {\n\t\t\t\t\t\t\t\tanimation-delay: 0.1s;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t.spinner_ZTLf {\n\t\t\t\t\t\t\t\tanimation-delay: 0.2s;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t@keyframes spinner_8HQG {\n\t\t\t\t\t\t\t\t0%,\n\t\t\t\t\t\t\t\t57.14% {\n\t\t\t\t\t\t\t\t\tanimation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);\n\t\t\t\t\t\t\t\t\ttransform: translate(0);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t28.57% {\n\t\t\t\t\t\t\t\t\tanimation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);\n\t\t\t\t\t\t\t\t\ttransform: translateY(-6px);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t100% {\n\t\t\t\t\t\t\t\t\ttransform: translate(0);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t</style><circle class=\"spinner_qM83\" cx=\"4\" cy=\"12\" r=\"3\" /><circle\n\t\t\t\t\t\t\tclass=\"spinner_qM83 spinner_oXPr\"\n\t\t\t\t\t\t\tcx=\"12\"\n\t\t\t\t\t\t\tcy=\"12\"\n\t\t\t\t\t\t\tr=\"3\"\n\t\t\t\t\t\t/><circle class=\"spinner_qM83 spinner_ZTLf\" cx=\"20\" cy=\"12\" r=\"3\" /></svg\n\t\t\t\t\t>\n\t\t\t\t{:else}\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\" {rmsLevel * 100 > 4\n\t\t\t\t\t\t\t? ' size-[4.5rem]'\n\t\t\t\t\t\t\t: rmsLevel * 100 > 2\n\t\t\t\t\t\t\t\t? ' size-16'\n\t\t\t\t\t\t\t\t: rmsLevel * 100 > 1\n\t\t\t\t\t\t\t\t\t? 'size-14'\n\t\t\t\t\t\t\t\t\t: 'size-12'}  transition-all rounded-full {(model?.info?.meta\n\t\t\t\t\t\t\t?.profile_image_url ?? '/static/favicon.png') !== '/static/favicon.png'\n\t\t\t\t\t\t\t? ' bg-cover bg-center bg-no-repeat'\n\t\t\t\t\t\t\t: 'bg-black dark:bg-white'}  bg-black dark:bg-white\"\n\t\t\t\t\t\tstyle={(model?.info?.meta?.profile_image_url ?? '/static/favicon.png') !==\n\t\t\t\t\t\t'/static/favicon.png'\n\t\t\t\t\t\t\t? `background-image: url('${model?.info?.meta?.profile_image_url}');`\n\t\t\t\t\t\t\t: ''}\n\t\t\t\t\t/>\n\t\t\t\t{/if}\n\t\t\t\t<!-- navbar -->\n\t\t\t</button>\n\t\t{/if}\n\n\t\t<div class=\"flex justify-center items-center flex-1 h-full w-full max-h-full\">\n\t\t\t{#if !camera}\n\t\t\t\t<button\n\t\t\t\t\ttype=\"button\"\n\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\tif (assistantSpeaking) {\n\t\t\t\t\t\t\tstopAllAudio();\n\t\t\t\t\t\t}\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t{#if emoji}\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclass=\"  transition-all rounded-full\"\n\t\t\t\t\t\t\tstyle=\"font-size:{rmsLevel * 100 > 4\n\t\t\t\t\t\t\t\t? '13'\n\t\t\t\t\t\t\t\t: rmsLevel * 100 > 2\n\t\t\t\t\t\t\t\t\t? '12'\n\t\t\t\t\t\t\t\t\t: rmsLevel * 100 > 1\n\t\t\t\t\t\t\t\t\t\t? '11.5'\n\t\t\t\t\t\t\t\t\t\t: '11'}rem;width:100%;text-align:center;\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{emoji}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{:else if loading || assistantSpeaking}\n\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\tclass=\"size-44 text-gray-900 dark:text-gray-400\"\n\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t><style>\n\t\t\t\t\t\t\t\t.spinner_qM83 {\n\t\t\t\t\t\t\t\t\tanimation: spinner_8HQG 1.05s infinite;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t.spinner_oXPr {\n\t\t\t\t\t\t\t\t\tanimation-delay: 0.1s;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t.spinner_ZTLf {\n\t\t\t\t\t\t\t\t\tanimation-delay: 0.2s;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t@keyframes spinner_8HQG {\n\t\t\t\t\t\t\t\t\t0%,\n\t\t\t\t\t\t\t\t\t57.14% {\n\t\t\t\t\t\t\t\t\t\tanimation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);\n\t\t\t\t\t\t\t\t\t\ttransform: translate(0);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t28.57% {\n\t\t\t\t\t\t\t\t\t\tanimation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);\n\t\t\t\t\t\t\t\t\t\ttransform: translateY(-6px);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t100% {\n\t\t\t\t\t\t\t\t\t\ttransform: translate(0);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t</style><circle class=\"spinner_qM83\" cx=\"4\" cy=\"12\" r=\"3\" /><circle\n\t\t\t\t\t\t\t\tclass=\"spinner_qM83 spinner_oXPr\"\n\t\t\t\t\t\t\t\tcx=\"12\"\n\t\t\t\t\t\t\t\tcy=\"12\"\n\t\t\t\t\t\t\t\tr=\"3\"\n\t\t\t\t\t\t\t/><circle class=\"spinner_qM83 spinner_ZTLf\" cx=\"20\" cy=\"12\" r=\"3\" /></svg\n\t\t\t\t\t\t>\n\t\t\t\t\t{:else}\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclass=\" {rmsLevel * 100 > 4\n\t\t\t\t\t\t\t\t? ' size-52'\n\t\t\t\t\t\t\t\t: rmsLevel * 100 > 2\n\t\t\t\t\t\t\t\t\t? 'size-48'\n\t\t\t\t\t\t\t\t\t: rmsLevel * 100 > 1\n\t\t\t\t\t\t\t\t\t\t? 'size-44'\n\t\t\t\t\t\t\t\t\t\t: 'size-40'}  transition-all rounded-full {(model?.info?.meta\n\t\t\t\t\t\t\t\t?.profile_image_url ?? '/static/favicon.png') !== '/static/favicon.png'\n\t\t\t\t\t\t\t\t? ' bg-cover bg-center bg-no-repeat'\n\t\t\t\t\t\t\t\t: 'bg-black dark:bg-white'} \"\n\t\t\t\t\t\t\tstyle={(model?.info?.meta?.profile_image_url ?? '/static/favicon.png') !==\n\t\t\t\t\t\t\t'/static/favicon.png'\n\t\t\t\t\t\t\t\t? `background-image: url('${model?.info?.meta?.profile_image_url}');`\n\t\t\t\t\t\t\t\t: ''}\n\t\t\t\t\t\t/>\n\t\t\t\t\t{/if}\n\t\t\t\t</button>\n\t\t\t{:else}\n\t\t\t\t<div class=\"relative flex video-container w-full max-h-full pt-2 pb-4 md:py-6 px-2 h-full\">\n\t\t\t\t\t<video\n\t\t\t\t\t\tid=\"camera-feed\"\n\t\t\t\t\t\tautoplay\n\t\t\t\t\t\tclass=\"rounded-2xl h-full min-w-full object-cover object-center\"\n\t\t\t\t\t\tplaysinline\n\t\t\t\t\t/>\n\n\t\t\t\t\t<canvas id=\"camera-canvas\" style=\"display:none;\" />\n\n\t\t\t\t\t<div class=\" absolute top-4 md:top-8 left-4\">\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\tclass=\"p-1.5 text-white cursor-pointer backdrop-blur-xl bg-black/10 rounded-full\"\n\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\tstopCamera();\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\tviewBox=\"0 0 16 16\"\n\t\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\t\tclass=\"size-6\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\td=\"M5.28 4.22a.75.75 0 0 0-1.06 1.06L6.94 8l-2.72 2.72a.75.75 0 1 0 1.06 1.06L8 9.06l2.72 2.72a.75.75 0 1 0 1.06-1.06L9.06 8l2.72-2.72a.75.75 0 0 0-1.06-1.06L8 6.94 5.28 4.22Z\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t{/if}\n\t\t</div>\n\n\t\t<div class=\"flex justify-between items-center pb-2 w-full\">\n\t\t\t<div>\n\t\t\t\t{#if camera}\n\t\t\t\t\t<VideoInputMenu\n\t\t\t\t\t\tdevices={videoInputDevices}\n\t\t\t\t\t\ton:change={async (e) => {\n\t\t\t\t\t\t\tconsole.log(e.detail);\n\t\t\t\t\t\t\tselectedVideoInputDeviceId = e.detail;\n\t\t\t\t\t\t\tawait stopVideoStream();\n\t\t\t\t\t\t\tawait startVideoStream();\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<button class=\" p-3 rounded-full bg-gray-50 dark:bg-gray-900\" type=\"button\">\n\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\tviewBox=\"0 0 20 20\"\n\t\t\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\t\t\tclass=\"size-5\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t\td=\"M15.312 11.424a5.5 5.5 0 0 1-9.201 2.466l-.312-.311h2.433a.75.75 0 0 0 0-1.5H3.989a.75.75 0 0 0-.75.75v4.242a.75.75 0 0 0 1.5 0v-2.43l.31.31a7 7 0 0 0 11.712-3.138.75.75 0 0 0-1.449-.39Zm1.23-3.723a.75.75 0 0 0 .219-.53V2.929a.75.75 0 0 0-1.5 0V5.36l-.31-.31A7 7 0 0 0 3.239 8.188a.75.75 0 1 0 1.448.389A5.5 5.5 0 0 1 13.89 6.11l.311.31h-2.432a.75.75 0 0 0 0 1.5h4.243a.75.75 0 0 0 .53-.219Z\"\n\t\t\t\t\t\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</VideoInputMenu>\n\t\t\t\t{:else}\n\t\t\t\t\t<Tooltip content={$i18n.t('Camera')}>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\" p-3 rounded-full bg-gray-50 dark:bg-gray-900\"\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\ton:click={async () => {\n\t\t\t\t\t\t\t\tawait navigator.mediaDevices.getUserMedia({ video: true });\n\t\t\t\t\t\t\t\tstartCamera();\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\t\tstroke-width=\"1.5\"\n\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\tclass=\"size-5\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t\t\td=\"M6.827 6.175A2.31 2.31 0 0 1 5.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 0 0-1.134-.175 2.31 2.31 0 0 1-1.64-1.055l-.822-1.316a2.192 2.192 0 0 0-1.736-1.039 48.774 48.774 0 0 0-5.232 0 2.192 2.192 0 0 0-1.736 1.039l-.821 1.316Z\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t\t\td=\"M16.5 12.75a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0ZM18.75 10.5h.008v.008h-.008V10.5Z\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</Tooltip>\n\t\t\t\t{/if}\n\t\t\t</div>\n\n\t\t\t<div>\n\t\t\t\t<button\n\t\t\t\t\ttype=\"button\"\n\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\tif (assistantSpeaking) {\n\t\t\t\t\t\t\tstopAllAudio();\n\t\t\t\t\t\t}\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<div class=\" line-clamp-1 text-sm font-medium\">\n\t\t\t\t\t\t{#if loading}\n\t\t\t\t\t\t\t{$i18n.t('Thinking...')}\n\t\t\t\t\t\t{:else if assistantSpeaking}\n\t\t\t\t\t\t\t{$i18n.t('Tap to interrupt')}\n\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t{$i18n.t('Listening...')}\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</div>\n\t\t\t\t</button>\n\t\t\t</div>\n\n\t\t\t<div>\n\t\t\t\t<button\n\t\t\t\t\tclass=\" p-3 rounded-full bg-gray-50 dark:bg-gray-900\"\n\t\t\t\t\ton:click={async () => {\n\t\t\t\t\t\tawait stopAudioStream();\n\t\t\t\t\t\tawait stopVideoStream();\n\n\t\t\t\t\t\tconsole.log(audioStream);\n\t\t\t\t\t\tconsole.log(cameraStream);\n\n\t\t\t\t\t\tshowCallOverlay.set(false);\n\t\t\t\t\t\tdispatch('close');\n\t\t\t\t\t}}\n\t\t\t\t\ttype=\"button\"\n\t\t\t\t>\n\t\t\t\t\t<svg\n\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\tviewBox=\"0 0 20 20\"\n\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\tclass=\"size-5\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<path\n\t\t\t\t\t\t\td=\"M6.28 5.22a.75.75 0 0 0-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 1 0 1.06 1.06L10 11.06l3.72 3.72a.75.75 0 1 0 1.06-1.06L11.06 10l3.72-3.72a.75.75 0 0 0-1.06-1.06L10 8.94 6.28 5.22Z\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</svg>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n{/if}\n","<script lang=\"ts\">\n\timport { WEBUI_BASE_URL } from '$lib/constants';\n\timport { Handle, Position, type NodeProps } from '@xyflow/svelte';\n\n\timport ProfileImage from '../Messages/ProfileImage.svelte';\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\n\timport Heart from '$lib/components/icons/Heart.svelte';\n\n\ttype $$Props = NodeProps;\n\texport let data: $$Props['data'];\n</script>\n\n<div\n\tclass=\"px-4 py-3 shadow-md rounded-xl dark:bg-black bg-white border dark:border-gray-900 w-60 h-20 group\"\n>\n\t<Tooltip\n\t\tcontent={data?.message?.error ? data.message.error.content : data.message.content}\n\t\tclass=\"w-full\"\n\t\tallowHTML={false}\n\t>\n\t\t{#if data.message.role === 'user'}\n\t\t\t<div class=\"flex w-full\">\n\t\t\t\t<ProfileImage\n\t\t\t\t\tsrc={data.user?.profile_image_url ?? '/user.png'}\n\t\t\t\t\tclassName={'size-5 -translate-y-[1px]'}\n\t\t\t\t/>\n\t\t\t\t<div class=\"ml-2\">\n\t\t\t\t\t<div class=\" flex justify-between items-center\">\n\t\t\t\t\t\t<div class=\"text-xs text-black dark:text-white font-medium line-clamp-1\">\n\t\t\t\t\t\t\t{data?.user?.name ?? 'User'}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{#if data?.message?.error}\n\t\t\t\t\t\t<div class=\"text-red-500 line-clamp-2 text-xs mt-0.5\">{data.message.error.content}</div>\n\t\t\t\t\t{:else}\n\t\t\t\t\t\t<div class=\"text-gray-500 line-clamp-2 text-xs mt-0.5\">{data.message.content}</div>\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t{:else}\n\t\t\t<div class=\"flex w-full\">\n\t\t\t\t<ProfileImage\n\t\t\t\t\tsrc={data?.model?.info?.meta?.profile_image_url ?? ''}\n\t\t\t\t\tclassName={'size-5 -translate-y-[1px]'}\n\t\t\t\t/>\n\n\t\t\t\t<div class=\"ml-2\">\n\t\t\t\t\t<div class=\" flex justify-between items-center\">\n\t\t\t\t\t\t<div class=\"text-xs text-black dark:text-white font-medium line-clamp-1\">\n\t\t\t\t\t\t\t{data?.model?.name ?? data?.message?.model ?? 'Assistant'}\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass={data?.message?.favorite ? '' : 'invisible group-hover:visible'}\n\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\tdata.message.favorite = !(data?.message?.favorite ?? false);\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Heart\n\t\t\t\t\t\t\t\tclassName=\"size-3 {data?.message?.favorite\n\t\t\t\t\t\t\t\t\t? 'fill-red-500 stroke-red-500'\n\t\t\t\t\t\t\t\t\t: 'hover:fill-red-500 hover:stroke-red-500'} \"\n\t\t\t\t\t\t\t\tstrokeWidth=\"2.5\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{#if data?.message?.error}\n\t\t\t\t\t\t<div class=\"text-red-500 line-clamp-2 text-xs mt-0.5\">\n\t\t\t\t\t\t\t{data.message.error.content}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{:else}\n\t\t\t\t\t\t<div class=\"text-gray-500 line-clamp-2 text-xs mt-0.5\">{data.message.content}</div>\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t{/if}\n\t</Tooltip>\n\t<Handle type=\"target\" position={Position.Top} class=\"w-2 rounded-full dark:bg-gray-900\" />\n\t<Handle type=\"source\" position={Position.Bottom} class=\"w-2 rounded-full dark:bg-gray-900\" />\n</div>\n","<script>\n\timport { createEventDispatcher } from 'svelte';\n\n\tconst dispatch = createEventDispatcher();\n\n\timport { theme } from '$lib/stores';\n\timport { Background, Controls, SvelteFlow, BackgroundVariant } from '@xyflow/svelte';\n\n\texport let nodes;\n\texport let nodeTypes;\n\texport let edges;\n</script>\n\n<SvelteFlow\n\t{nodes}\n\t{nodeTypes}\n\t{edges}\n\tfitView\n\tminZoom={0.001}\n\tcolorMode={$theme.includes('dark')\n\t\t? 'dark'\n\t\t: $theme === 'system'\n\t\t\t? window.matchMedia('(prefers-color-scheme: dark)').matches\n\t\t\t\t? 'dark'\n\t\t\t\t: 'light'\n\t\t\t: 'light'}\n\tnodesConnectable={false}\n\tnodesDraggable={false}\n\ton:nodeclick={(e) => dispatch('nodeclick', e.detail)}\n\toninit={() => {\n\t\tconsole.log('Flow initialized');\n\t}}\n>\n\t<Controls showLock={false} />\n\t<Background variant={BackgroundVariant.Dots} />\n</SvelteFlow>\n","<script lang=\"ts\">\n\texport let className = 'size-4';\n\texport let strokeWidth = '1.5';\n</script>\n\n<svg\n\txmlns=\"http://www.w3.org/2000/svg\"\n\tfill=\"none\"\n\tviewBox=\"0 0 24 24\"\n\tstroke-width={strokeWidth}\n\tstroke=\"currentColor\"\n\tclass={className}\n>\n\t<path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18\" />\n</svg>\n","<script lang=\"ts\">\n\timport { getContext, createEventDispatcher, onDestroy } from 'svelte';\n\timport { useSvelteFlow, useNodesInitialized, useStore } from '@xyflow/svelte';\n\n\tconst dispatch = createEventDispatcher();\n\tconst i18n = getContext('i18n');\n\n\timport { onMount, tick } from 'svelte';\n\n\timport { writable } from 'svelte/store';\n\timport { models, showOverview, theme, user } from '$lib/stores';\n\n\timport '@xyflow/svelte/dist/style.css';\n\n\timport CustomNode from './Overview/Node.svelte';\n\timport Flow from './Overview/Flow.svelte';\n\timport XMark from '../icons/XMark.svelte';\n\timport ArrowLeft from '../icons/ArrowLeft.svelte';\n\n\tconst { width, height } = useStore();\n\n\tconst { fitView, getViewport } = useSvelteFlow();\n\tconst nodesInitialized = useNodesInitialized();\n\n\texport let history;\n\n\tlet selectedMessageId = null;\n\n\tconst nodes = writable([]);\n\tconst edges = writable([]);\n\n\tconst nodeTypes = {\n\t\tcustom: CustomNode\n\t};\n\n\t$: if (history) {\n\t\tdrawFlow();\n\t}\n\n\t$: if (history && history.currentId) {\n\t\tfocusNode();\n\t}\n\n\tconst focusNode = async () => {\n\t\tif (selectedMessageId === null) {\n\t\t\tawait fitView({ nodes: [{ id: history.currentId }] });\n\t\t} else {\n\t\t\tawait fitView({ nodes: [{ id: selectedMessageId }] });\n\t\t}\n\n\t\tselectedMessageId = null;\n\t};\n\n\tconst drawFlow = async () => {\n\t\tconst nodeList = [];\n\t\tconst edgeList = [];\n\t\tconst levelOffset = 150; // Vertical spacing between layers\n\t\tconst siblingOffset = 250; // Horizontal spacing between nodes at the same layer\n\n\t\t// Map to keep track of node positions at each level\n\t\tlet positionMap = new Map();\n\n\t\t// Helper function to truncate labels\n\t\tfunction createLabel(content) {\n\t\t\tconst maxLength = 100;\n\t\t\treturn content.length > maxLength ? content.substr(0, maxLength) + '...' : content;\n\t\t}\n\n\t\t// Create nodes and map children to ensure alignment in width\n\t\tlet layerWidths = {}; // Track widths of each layer\n\n\t\tObject.keys(history.messages).forEach((id) => {\n\t\t\tconst message = history.messages[id];\n\t\t\tconst level = message.parentId ? (positionMap.get(message.parentId)?.level ?? -1) + 1 : 0;\n\t\t\tif (!layerWidths[level]) layerWidths[level] = 0;\n\n\t\t\tpositionMap.set(id, {\n\t\t\t\tid: message.id,\n\t\t\t\tlevel,\n\t\t\t\tposition: layerWidths[level]++\n\t\t\t});\n\t\t});\n\n\t\t// Adjust positions based on siblings count to centralize vertical spacing\n\t\tObject.keys(history.messages).forEach((id) => {\n\t\t\tconst pos = positionMap.get(id);\n\t\t\tconst xOffset = pos.position * siblingOffset;\n\t\t\tconst y = pos.level * levelOffset;\n\t\t\tconst x = xOffset;\n\n\t\t\tnodeList.push({\n\t\t\t\tid: pos.id,\n\t\t\t\ttype: 'custom',\n\t\t\t\tdata: {\n\t\t\t\t\tuser: $user,\n\t\t\t\t\tmessage: history.messages[id],\n\t\t\t\t\tmodel: $models.find((model) => model.id === history.messages[id].model)\n\t\t\t\t},\n\t\t\t\tposition: { x, y }\n\t\t\t});\n\n\t\t\t// Create edges\n\t\t\tconst parentId = history.messages[id].parentId;\n\t\t\tif (parentId) {\n\t\t\t\tedgeList.push({\n\t\t\t\t\tid: parentId + '-' + pos.id,\n\t\t\t\t\tsource: parentId,\n\t\t\t\t\ttarget: pos.id,\n\t\t\t\t\tselectable: false,\n\t\t\t\t\tclass: ' dark:fill-gray-300 fill-gray-300',\n\t\t\t\t\ttype: 'smoothstep',\n\t\t\t\t\tanimated: history.currentId === id || recurseCheckChild(id, history.currentId)\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tawait edges.set([...edgeList]);\n\t\tawait nodes.set([...nodeList]);\n\t};\n\n\tconst recurseCheckChild = (nodeId, currentId) => {\n\t\tconst node = history.messages[nodeId];\n\t\treturn (\n\t\t\tnode.childrenIds &&\n\t\t\tnode.childrenIds.some((id) => id === currentId || recurseCheckChild(id, currentId))\n\t\t);\n\t};\n\n\tonMount(() => {\n\t\tdrawFlow();\n\n\t\tnodesInitialized.subscribe(async (initialized) => {\n\t\t\tif (initialized) {\n\t\t\t\tawait tick();\n\t\t\t\tconst res = await fitView({ nodes: [{ id: history.currentId }] });\n\t\t\t}\n\t\t});\n\n\t\twidth.subscribe((value) => {\n\t\t\tif (value) {\n\t\t\t\t// fitView();\n\t\t\t\tfitView({ nodes: [{ id: history.currentId }] });\n\t\t\t}\n\t\t});\n\n\t\theight.subscribe((value) => {\n\t\t\tif (value) {\n\t\t\t\t// fitView();\n\t\t\t\tfitView({ nodes: [{ id: history.currentId }] });\n\t\t\t}\n\t\t});\n\t});\n\n\tonDestroy(() => {\n\t\tconsole.log('Overview destroyed');\n\n\t\tnodes.set([]);\n\t\tedges.set([]);\n\t});\n</script>\n\n<div class=\"w-full h-full relative\">\n\t<div class=\" absolute z-50 w-full flex justify-between dark:text-gray-100 px-4 py-3.5\">\n\t\t<div class=\"flex items-center gap-2.5\">\n\t\t\t<!-- <button\n\t\t\t\tclass=\"self-center p-0.5\"\n\t\t\t\ton:click={() => {\n\t\t\t\t\tshowOverview.set(false);\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<ArrowLeft className=\"size-3.5\" />\n\t\t\t</button> -->\n\t\t\t<div class=\" text-lg font-medium self-center font-primary\">{$i18n.t('Chat Overview')}</div>\n\t\t</div>\n\t\t<button\n\t\t\tclass=\"self-center p-0.5\"\n\t\t\ton:click={() => {\n\t\t\t\tdispatch('close');\n\t\t\t\tshowOverview.set(false);\n\t\t\t}}\n\t\t>\n\t\t\t<XMark className=\"size-3.5\" />\n\t\t</button>\n\t</div>\n\n\t{#if $nodes.length > 0}\n\t\t<Flow\n\t\t\t{nodes}\n\t\t\t{nodeTypes}\n\t\t\t{edges}\n\t\t\ton:nodeclick={(e) => {\n\t\t\t\tconsole.log(e.detail.node.data);\n\t\t\t\tdispatch('nodeclick', e.detail);\n\t\t\t\tselectedMessageId = e.detail.node.data.message.id;\n\t\t\t\tfitView({ nodes: [{ id: selectedMessageId }] });\n\t\t\t}}\n\t\t/>\n\t{/if}\n</div>\n","<script lang=\"ts\">\n\texport let className = 'size-4';\n\texport let strokeWidth = '1.5';\n</script>\n\n<svg\n\txmlns=\"http://www.w3.org/2000/svg\"\n\tfill=\"none\"\n\tviewBox=\"0 0 24 24\"\n\tstroke-width={strokeWidth}\n\tstroke=\"currentColor\"\n\tclass={className}\n>\n\t<path\n\t\tstroke-linecap=\"round\"\n\t\tstroke-linejoin=\"round\"\n\t\td=\"M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9M3.75 20.25v-4.5m0 4.5h4.5m-4.5 0L9 15M20.25 3.75h-4.5m4.5 0v4.5m0-4.5L15 9m5.25 11.25h-4.5m4.5 0v-4.5m0 4.5L15 15\"\n\t/>\n</svg>\n","<script lang=\"ts\">\n\timport { toast } from 'svelte-sonner';\n\timport { onMount, getContext, createEventDispatcher } from 'svelte';\n\tconst i18n = getContext('i18n');\n\tconst dispatch = createEventDispatcher();\n\n\timport { chatId, showArtifacts, showControls } from '$lib/stores';\n\timport XMark from '../icons/XMark.svelte';\n\timport { copyToClipboard, createMessagesList } from '$lib/utils';\n\timport ArrowsPointingOut from '../icons/ArrowsPointingOut.svelte';\n\timport Tooltip from '../common/Tooltip.svelte';\n\timport SvgPanZoom from '../common/SVGPanZoom.svelte';\n\timport ArrowLeft from '../icons/ArrowLeft.svelte';\n\n\texport let overlay = false;\n\texport let history;\n\tlet messages = [];\n\n\tlet contents: Array<{ type: string; content: string }> = [];\n\tlet selectedContentIdx = 0;\n\n\tlet copied = false;\n\tlet iframeElement: HTMLIFrameElement;\n\n\t$: if (history) {\n\t\tmessages = createMessagesList(history, history.currentId);\n\t\tgetContents();\n\t} else {\n\t\tmessages = [];\n\t\tgetContents();\n\t}\n\n\tconst getContents = () => {\n\t\tcontents = [];\n\t\tmessages.forEach((message) => {\n\t\t\tif (message?.role !== 'user' && message?.content) {\n\t\t\t\tconst codeBlockContents = message.content.match(/```[\\s\\S]*?```/g);\n\t\t\t\tlet codeBlocks = [];\n\n\t\t\t\tif (codeBlockContents) {\n\t\t\t\t\tcodeBlockContents.forEach((block) => {\n\t\t\t\t\t\tconst lang = block.split('\\n')[0].replace('```', '').trim().toLowerCase();\n\t\t\t\t\t\tconst code = block.replace(/```[\\s\\S]*?\\n/, '').replace(/```$/, '');\n\t\t\t\t\t\tcodeBlocks.push({ lang, code });\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tlet htmlContent = '';\n\t\t\t\tlet cssContent = '';\n\t\t\t\tlet jsContent = '';\n\n\t\t\t\tcodeBlocks.forEach((block) => {\n\t\t\t\t\tconst { lang, code } = block;\n\n\t\t\t\t\tif (lang === 'html') {\n\t\t\t\t\t\thtmlContent += code + '\\n';\n\t\t\t\t\t} else if (lang === 'css') {\n\t\t\t\t\t\tcssContent += code + '\\n';\n\t\t\t\t\t} else if (lang === 'javascript' || lang === 'js') {\n\t\t\t\t\t\tjsContent += code + '\\n';\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tconst inlineHtml = message.content.match(/<html>[\\s\\S]*?<\\/html>/gi);\n\t\t\t\tconst inlineCss = message.content.match(/<style>[\\s\\S]*?<\\/style>/gi);\n\t\t\t\tconst inlineJs = message.content.match(/<script>[\\s\\S]*?<\\/script>/gi);\n\n\t\t\t\tif (inlineHtml) {\n\t\t\t\t\tinlineHtml.forEach((block) => {\n\t\t\t\t\t\tconst content = block.replace(/<\\/?html>/gi, ''); // Remove <html> tags\n\t\t\t\t\t\thtmlContent += content + '\\n';\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tif (inlineCss) {\n\t\t\t\t\tinlineCss.forEach((block) => {\n\t\t\t\t\t\tconst content = block.replace(/<\\/?style>/gi, ''); // Remove <style> tags\n\t\t\t\t\t\tcssContent += content + '\\n';\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tif (inlineJs) {\n\t\t\t\t\tinlineJs.forEach((block) => {\n\t\t\t\t\t\tconst content = block.replace(/<\\/?script>/gi, ''); // Remove <script> tags\n\t\t\t\t\t\tjsContent += content + '\\n';\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif (htmlContent || cssContent || jsContent) {\n\t\t\t\t\tconst renderedContent = `\n                        <!DOCTYPE html>\n                        <html lang=\"en\">\n                        <head>\n                            <meta charset=\"UTF-8\">\n                            <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n\t\t\t\t\t\t\t<${''}style>\n\t\t\t\t\t\t\t\tbody {\n\t\t\t\t\t\t\t\t\tbackground-color: white; /* Ensure the iframe has a white background */\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t${cssContent}\n\t\t\t\t\t\t\t</${''}style>\n                        </head>\n                        <body>\n                            ${htmlContent}\n\n\t\t\t\t\t\t\t<${''}script>\n                            \t${jsContent}\n\t\t\t\t\t\t\t</${''}script>\n                        </body>\n                        </html>\n                    `;\n\t\t\t\t\tcontents = [...contents, { type: 'iframe', content: renderedContent }];\n\t\t\t\t} else {\n\t\t\t\t\t// Check for SVG content\n\t\t\t\t\tfor (const block of codeBlocks) {\n\t\t\t\t\t\tif (block.lang === 'svg' || (block.lang === 'xml' && block.code.includes('<svg'))) {\n\t\t\t\t\t\t\tcontents = [...contents, { type: 'svg', content: block.code }];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tif (contents.length === 0) {\n\t\t\tshowControls.set(false);\n\t\t\tshowArtifacts.set(false);\n\t\t}\n\n\t\tselectedContentIdx = contents ? contents.length - 1 : 0;\n\t};\n\n\tfunction navigateContent(direction: 'prev' | 'next') {\n\t\tconsole.log(selectedContentIdx);\n\n\t\tselectedContentIdx =\n\t\t\tdirection === 'prev'\n\t\t\t\t? Math.max(selectedContentIdx - 1, 0)\n\t\t\t\t: Math.min(selectedContentIdx + 1, contents.length - 1);\n\n\t\tconsole.log(selectedContentIdx);\n\t}\n\n\tconst iframeLoadHandler = () => {\n\t\tiframeElement.contentWindow.addEventListener(\n\t\t\t'click',\n\t\t\tfunction (e) {\n\t\t\t\tconst target = e.target.closest('a');\n\t\t\t\tif (target && target.href) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tconst url = new URL(target.href, iframeElement.baseURI);\n\t\t\t\t\tif (url.origin === window.location.origin) {\n\t\t\t\t\t\tiframeElement.contentWindow.history.pushState(\n\t\t\t\t\t\t\tnull,\n\t\t\t\t\t\t\t'',\n\t\t\t\t\t\t\turl.pathname + url.search + url.hash\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconsole.log('External navigation blocked:', url.href);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\ttrue\n\t\t);\n\n\t\t// Cancel drag when hovering over iframe\n\t\tiframeElement.contentWindow.addEventListener('mouseenter', function (e) {\n\t\t\te.preventDefault();\n\t\t\tiframeElement.contentWindow.addEventListener('dragstart', (event) => {\n\t\t\t\tevent.preventDefault();\n\t\t\t});\n\t\t});\n\t};\n\n\tconst showFullScreen = () => {\n\t\tif (iframeElement.requestFullscreen) {\n\t\t\tiframeElement.requestFullscreen();\n\t\t} else if (iframeElement.webkitRequestFullscreen) {\n\t\t\tiframeElement.webkitRequestFullscreen();\n\t\t} else if (iframeElement.msRequestFullscreen) {\n\t\t\tiframeElement.msRequestFullscreen();\n\t\t}\n\t};\n\n\tonMount(() => {});\n</script>\n\n<div class=\" w-full h-full relative flex flex-col bg-gray-50 dark:bg-gray-850\">\n\t<div class=\"w-full h-full flex-1 relative\">\n\t\t{#if overlay}\n\t\t\t<div class=\" absolute top-0 left-0 right-0 bottom-0 z-10\"></div>\n\t\t{/if}\n\n\t\t<div class=\"absolute pointer-events-none z-50 w-full flex items-center justify-start p-4\">\n\t\t\t<button\n\t\t\t\tclass=\"self-center pointer-events-auto p-1 rounded-full bg-white dark:bg-gray-850\"\n\t\t\t\ton:click={() => {\n\t\t\t\t\tshowArtifacts.set(false);\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<ArrowLeft className=\"size-3.5  text-gray-900 dark:text-white\" />\n\t\t\t</button>\n\t\t</div>\n\n\t\t<div class=\" absolute pointer-events-none z-50 w-full flex items-center justify-end p-4\">\n\t\t\t<button\n\t\t\t\tclass=\"self-center pointer-events-auto p-1 rounded-full bg-white dark:bg-gray-850\"\n\t\t\t\ton:click={() => {\n\t\t\t\t\tdispatch('close');\n\t\t\t\t\tshowControls.set(false);\n\t\t\t\t\tshowArtifacts.set(false);\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<XMark className=\"size-3.5 text-gray-900 dark:text-white\" />\n\t\t\t</button>\n\t\t</div>\n\n\t\t<div class=\"flex-1 w-full h-full\">\n\t\t\t<div class=\" h-full flex flex-col\">\n\t\t\t\t{#if contents.length > 0}\n\t\t\t\t\t<div class=\"max-w-full w-full h-full\">\n\t\t\t\t\t\t{#if contents[selectedContentIdx].type === 'iframe'}\n\t\t\t\t\t\t\t<iframe\n\t\t\t\t\t\t\t\tbind:this={iframeElement}\n\t\t\t\t\t\t\t\ttitle=\"Content\"\n\t\t\t\t\t\t\t\tsrcdoc={contents[selectedContentIdx].content}\n\t\t\t\t\t\t\t\tclass=\"w-full border-0 h-full rounded-none\"\n\t\t\t\t\t\t\t\tsandbox=\"allow-scripts allow-forms allow-same-origin\"\n\t\t\t\t\t\t\t\ton:load={iframeLoadHandler}\n\t\t\t\t\t\t\t></iframe>\n\t\t\t\t\t\t{:else if contents[selectedContentIdx].type === 'svg'}\n\t\t\t\t\t\t\t<SvgPanZoom\n\t\t\t\t\t\t\t\tclassName=\" w-full h-full max-h-full overflow-hidden\"\n\t\t\t\t\t\t\t\tsvg={contents[selectedContentIdx].content}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</div>\n\t\t\t\t{:else}\n\t\t\t\t\t<div class=\"m-auto font-medium text-xs text-gray-900 dark:text-white\">\n\t\t\t\t\t\t{$i18n.t('No HTML, CSS, or JavaScript content found.')}\n\t\t\t\t\t</div>\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\n\t{#if contents.length > 0}\n\t\t<div class=\"flex justify-between items-center p-2.5 font-primar text-gray-900 dark:text-white\">\n\t\t\t<div class=\"flex items-center space-x-2\">\n\t\t\t\t<div class=\"flex items-center gap-0.5 self-center min-w-fit\" dir=\"ltr\">\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\"self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition disabled:cursor-not-allowed\"\n\t\t\t\t\t\ton:click={() => navigateContent('prev')}\n\t\t\t\t\t\tdisabled={contents.length <= 1}\n\t\t\t\t\t>\n\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\tstroke-width=\"2.5\"\n\t\t\t\t\t\t\tclass=\"size-3.5\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t\td=\"M15.75 19.5 8.25 12l7.5-7.5\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</button>\n\n\t\t\t\t\t<div class=\"text-xs self-center dark:text-gray-100 min-w-fit\">\n\t\t\t\t\t\t{$i18n.t('Version {{selectedVersion}} of {{totalVersions}}', {\n\t\t\t\t\t\t\tselectedVersion: selectedContentIdx + 1,\n\t\t\t\t\t\t\ttotalVersions: contents.length\n\t\t\t\t\t\t})}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\"self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition disabled:cursor-not-allowed\"\n\t\t\t\t\t\ton:click={() => navigateContent('next')}\n\t\t\t\t\t\tdisabled={contents.length <= 1}\n\t\t\t\t\t>\n\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\tstroke-width=\"2.5\"\n\t\t\t\t\t\t\tclass=\"size-3.5\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"m8.25 4.5 7.5 7.5-7.5 7.5\" />\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\"flex items-center gap-1\">\n\t\t\t\t<button\n\t\t\t\t\tclass=\"copy-code-button bg-none border-none text-xs bg-gray-50 hover:bg-gray-100 dark:bg-gray-850 dark:hover:bg-gray-800 transition rounded-md px-1.5 py-0.5\"\n\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\tcopyToClipboard(contents[selectedContentIdx].content);\n\t\t\t\t\t\tcopied = true;\n\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tcopied = false;\n\t\t\t\t\t\t}, 2000);\n\t\t\t\t\t}}>{copied ? $i18n.t('Copied') : $i18n.t('Copy')}</button\n\t\t\t\t>\n\n\t\t\t\t{#if contents[selectedContentIdx].type === 'iframe'}\n\t\t\t\t\t<Tooltip content={$i18n.t('Open in full screen')}>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\" bg-none border-none text-xs bg-gray-50 hover:bg-gray-100 dark:bg-gray-850 dark:hover:bg-gray-800 transition rounded-md p-0.5\"\n\t\t\t\t\t\t\ton:click={showFullScreen}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<ArrowsPointingOut className=\"size-3.5\" />\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</Tooltip>\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t</div>\n\t{/if}\n</div>\n","<script lang=\"ts\">\n\timport { SvelteFlowProvider } from '@xyflow/svelte';\n\timport { slide } from 'svelte/transition';\n\timport { Pane, PaneResizer } from 'paneforge';\n\n\timport { onDestroy, onMount, tick } from 'svelte';\n\timport { mobile, showControls, showCallOverlay, showOverview, showArtifacts } from '$lib/stores';\n\n\timport Modal from '../common/Modal.svelte';\n\timport Controls from './Controls/Controls.svelte';\n\timport CallOverlay from './MessageInput/CallOverlay.svelte';\n\timport Drawer from '../common/Drawer.svelte';\n\timport Overview from './Overview.svelte';\n\timport EllipsisVertical from '../icons/EllipsisVertical.svelte';\n\timport Artifacts from './Artifacts.svelte';\n\timport { min } from '@floating-ui/utils';\n\n\texport let history;\n\texport let models = [];\n\n\texport let chatId = null;\n\n\texport let chatFiles = [];\n\texport let params = {};\n\n\texport let eventTarget: EventTarget;\n\texport let submitPrompt: Function;\n\texport let stopResponse: Function;\n\texport let showMessage: Function;\n\texport let files;\n\texport let modelId;\n\n\texport let pane;\n\n\tlet mediaQuery;\n\tlet largeScreen = false;\n\tlet dragged = false;\n\n\tlet minSize = 0;\n\n\texport const openPane = () => {\n\t\tif (parseInt(localStorage?.chatControlsSize)) {\n\t\t\tpane.resize(parseInt(localStorage?.chatControlsSize));\n\t\t} else {\n\t\t\tpane.resize(minSize);\n\t\t}\n\t};\n\n\tconst handleMediaQuery = async (e) => {\n\t\tif (e.matches) {\n\t\t\tlargeScreen = true;\n\n\t\t\tif ($showCallOverlay) {\n\t\t\t\tshowCallOverlay.set(false);\n\t\t\t\tawait tick();\n\t\t\t\tshowCallOverlay.set(true);\n\t\t\t}\n\t\t} else {\n\t\t\tlargeScreen = false;\n\n\t\t\tif ($showCallOverlay) {\n\t\t\t\tshowCallOverlay.set(false);\n\t\t\t\tawait tick();\n\t\t\t\tshowCallOverlay.set(true);\n\t\t\t}\n\t\t\tpane = null;\n\t\t}\n\t};\n\n\tconst onMouseDown = (event) => {\n\t\tdragged = true;\n\t};\n\n\tconst onMouseUp = (event) => {\n\t\tdragged = false;\n\t};\n\n\tonMount(() => {\n\t\t// listen to resize 1024px\n\t\tmediaQuery = window.matchMedia('(min-width: 1024px)');\n\n\t\tmediaQuery.addEventListener('change', handleMediaQuery);\n\t\thandleMediaQuery(mediaQuery);\n\n\t\t// Select the container element you want to observe\n\t\tconst container = document.getElementById('chat-container');\n\n\t\t// initialize the minSize based on the container width\n\t\tminSize = Math.floor((350 / container.clientWidth) * 100);\n\n\t\t// Create a new ResizeObserver instance\n\t\tconst resizeObserver = new ResizeObserver((entries) => {\n\t\t\tfor (let entry of entries) {\n\t\t\t\tconst width = entry.contentRect.width;\n\t\t\t\t// calculate the percentage of 200px\n\t\t\t\tconst percentage = (350 / width) * 100;\n\t\t\t\t// set the minSize to the percentage, must be an integer\n\t\t\t\tminSize = Math.floor(percentage);\n\n\t\t\t\tif ($showControls) {\n\t\t\t\t\tif (pane && pane.isExpanded() && pane.getSize() < minSize) {\n\t\t\t\t\t\tpane.resize(minSize);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t// Start observing the container's size changes\n\t\tresizeObserver.observe(container);\n\n\t\tdocument.addEventListener('mousedown', onMouseDown);\n\t\tdocument.addEventListener('mouseup', onMouseUp);\n\t});\n\n\tonDestroy(() => {\n\t\tshowControls.set(false);\n\n\t\tmediaQuery.removeEventListener('change', handleMediaQuery);\n\t\tdocument.removeEventListener('mousedown', onMouseDown);\n\t\tdocument.removeEventListener('mouseup', onMouseUp);\n\t});\n\n\tconst closeHandler = () => {\n\t\tshowControls.set(false);\n\t\tshowOverview.set(false);\n\t\tshowArtifacts.set(false);\n\n\t\tif ($showCallOverlay) {\n\t\t\tshowCallOverlay.set(false);\n\t\t}\n\t};\n\n\t$: if (!chatId) {\n\t\tcloseHandler();\n\t}\n</script>\n\n<SvelteFlowProvider>\n\t{#if !largeScreen}\n\t\t{#if $showControls}\n\t\t\t<Drawer\n\t\t\t\tshow={$showControls}\n\t\t\t\ton:close={() => {\n\t\t\t\t\tshowControls.set(false);\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<div\n\t\t\t\t\tclass=\" {$showCallOverlay || $showOverview || $showArtifacts\n\t\t\t\t\t\t? ' h-screen  w-full'\n\t\t\t\t\t\t: 'px-6 py-4'} h-full\"\n\t\t\t\t>\n\t\t\t\t\t{#if $showCallOverlay}\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclass=\" h-full max-h-[100dvh] bg-white text-gray-700 dark:bg-black dark:text-gray-300 flex justify-center\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<CallOverlay\n\t\t\t\t\t\t\t\tbind:files\n\t\t\t\t\t\t\t\t{submitPrompt}\n\t\t\t\t\t\t\t\t{stopResponse}\n\t\t\t\t\t\t\t\t{modelId}\n\t\t\t\t\t\t\t\t{chatId}\n\t\t\t\t\t\t\t\t{eventTarget}\n\t\t\t\t\t\t\t\ton:close={() => {\n\t\t\t\t\t\t\t\t\tshowControls.set(false);\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{:else if $showArtifacts}\n\t\t\t\t\t\t<Artifacts {history} />\n\t\t\t\t\t{:else if $showOverview}\n\t\t\t\t\t\t<Overview\n\t\t\t\t\t\t\t{history}\n\t\t\t\t\t\t\ton:nodeclick={(e) => {\n\t\t\t\t\t\t\t\tshowMessage(e.detail.node.data.message);\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\ton:close={() => {\n\t\t\t\t\t\t\t\tshowControls.set(false);\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t{:else}\n\t\t\t\t\t\t<Controls\n\t\t\t\t\t\t\ton:close={() => {\n\t\t\t\t\t\t\t\tshowControls.set(false);\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t{models}\n\t\t\t\t\t\t\tbind:chatFiles\n\t\t\t\t\t\t\tbind:params\n\t\t\t\t\t\t/>\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\t\t\t</Drawer>\n\t\t{/if}\n\t{:else}\n\t\t<!-- if $showControls -->\n\n\t\t{#if $showControls}\n\t\t\t<PaneResizer class=\"relative flex w-2 items-center justify-center bg-background group\">\n\t\t\t\t<div class=\"z-10 flex h-7 w-5 items-center justify-center rounded-xs\">\n\t\t\t\t\t<EllipsisVertical className=\"size-4 invisible group-hover:visible\" />\n\t\t\t\t</div>\n\t\t\t</PaneResizer>\n\t\t{/if}\n\n\t\t<Pane\n\t\t\tbind:pane\n\t\t\tdefaultSize={0}\n\t\t\tonResize={(size) => {\n\t\t\t\tconsole.log('size', size, minSize);\n\n\t\t\t\tif ($showControls && pane.isExpanded()) {\n\t\t\t\t\tif (size < minSize) {\n\t\t\t\t\t\tpane.resize(minSize);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (size < minSize) {\n\t\t\t\t\t\tlocalStorage.chatControlsSize = 0;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tlocalStorage.chatControlsSize = size;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}}\n\t\t\tonCollapse={() => {\n\t\t\t\tshowControls.set(false);\n\t\t\t}}\n\t\t\tcollapsible={true}\n\t\t\tclass=\"pt-8\"\n\t\t>\n\t\t\t{#if $showControls}\n\t\t\t\t<div class=\"pr-4 pb-8 flex max-h-full min-h-full\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"w-full {($showOverview || $showArtifacts) && !$showCallOverlay\n\t\t\t\t\t\t\t? ' '\n\t\t\t\t\t\t\t: 'px-4 py-4 bg-white dark:shadow-lg dark:bg-gray-850  border border-gray-100 dark:border-gray-850'}  rounded-xl z-40 pointer-events-auto overflow-y-auto scrollbar-hidden\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{#if $showCallOverlay}\n\t\t\t\t\t\t\t<div class=\"w-full h-full flex justify-center\">\n\t\t\t\t\t\t\t\t<CallOverlay\n\t\t\t\t\t\t\t\t\tbind:files\n\t\t\t\t\t\t\t\t\t{submitPrompt}\n\t\t\t\t\t\t\t\t\t{stopResponse}\n\t\t\t\t\t\t\t\t\t{modelId}\n\t\t\t\t\t\t\t\t\t{chatId}\n\t\t\t\t\t\t\t\t\t{eventTarget}\n\t\t\t\t\t\t\t\t\ton:close={() => {\n\t\t\t\t\t\t\t\t\t\tshowControls.set(false);\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{:else if $showArtifacts}\n\t\t\t\t\t\t\t<Artifacts {history} overlay={dragged} />\n\t\t\t\t\t\t{:else if $showOverview}\n\t\t\t\t\t\t\t<Overview\n\t\t\t\t\t\t\t\t{history}\n\t\t\t\t\t\t\t\ton:nodeclick={(e) => {\n\t\t\t\t\t\t\t\t\tif (e.detail.node.data.message.favorite) {\n\t\t\t\t\t\t\t\t\t\thistory.messages[e.detail.node.data.message.id].favorite = true;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\thistory.messages[e.detail.node.data.message.id].favorite = null;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tshowMessage(e.detail.node.data.message);\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\ton:close={() => {\n\t\t\t\t\t\t\t\t\tshowControls.set(false);\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t<Controls\n\t\t\t\t\t\t\t\ton:close={() => {\n\t\t\t\t\t\t\t\t\tshowControls.set(false);\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t{models}\n\t\t\t\t\t\t\t\tbind:chatFiles\n\t\t\t\t\t\t\t\tbind:params\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t{/if}\n\t\t</Pane>\n\t{/if}\n</SvelteFlowProvider>\n","<script lang=\"ts\">\n\timport { toast } from 'svelte-sonner';\n\timport { marked } from 'marked';\n\n\timport { onMount, getContext, tick, createEventDispatcher } from 'svelte';\n\timport { blur, fade } from 'svelte/transition';\n\n\tconst dispatch = createEventDispatcher();\n\n\timport { config, user, models as _models, temporaryChatEnabled } from '$lib/stores';\n\timport { sanitizeResponseContent, findWordIndices } from '$lib/utils';\n\timport { WEBUI_BASE_URL } from '$lib/constants';\n\n\timport Suggestions from './Suggestions.svelte';\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\n\timport EyeSlash from '$lib/components/icons/EyeSlash.svelte';\n\timport MessageInput from './MessageInput.svelte';\n\n\tconst i18n = getContext('i18n');\n\n\texport let transparentBackground = false;\n\n\texport let createMessagePair: Function;\n\texport let stopResponse: Function;\n\n\texport let autoScroll = false;\n\n\texport let atSelectedModel: Model | undefined;\n\texport let selectedModels: [''];\n\n\texport let history;\n\n\texport let prompt = '';\n\texport let files = [];\n\n\texport let selectedToolIds = [];\n\texport let imageGenerationEnabled = false;\n\texport let codeInterpreterEnabled = false;\n\texport let webSearchEnabled = false;\n\n\tlet models = [];\n\n\tconst selectSuggestionPrompt = async (p) => {\n\t\tlet text = p;\n\n\t\tif (p.includes('{{CLIPBOARD}}')) {\n\t\t\tconst clipboardText = await navigator.clipboard.readText().catch((err) => {\n\t\t\t\ttoast.error($i18n.t('Failed to read clipboard contents'));\n\t\t\t\treturn '{{CLIPBOARD}}';\n\t\t\t});\n\n\t\t\ttext = p.replaceAll('{{CLIPBOARD}}', clipboardText);\n\n\t\t\tconsole.log('Clipboard text:', clipboardText, text);\n\t\t}\n\n\t\tprompt = text;\n\n\t\tconsole.log(prompt);\n\t\tawait tick();\n\n\t\tconst chatInputContainerElement = document.getElementById('chat-input-container');\n\t\tconst chatInputElement = document.getElementById('chat-input');\n\n\t\tif (chatInputContainerElement) {\n\t\t\tchatInputContainerElement.style.height = '';\n\t\t\tchatInputContainerElement.style.height =\n\t\t\t\tMath.min(chatInputContainerElement.scrollHeight, 200) + 'px';\n\t\t}\n\n\t\tawait tick();\n\t\tif (chatInputElement) {\n\t\t\tchatInputElement.focus();\n\t\t\tchatInputElement.dispatchEvent(new Event('input'));\n\t\t}\n\n\t\tawait tick();\n\t};\n\n\tlet selectedModelIdx = 0;\n\n\t$: if (selectedModels.length > 0) {\n\t\tselectedModelIdx = models.length - 1;\n\t}\n\n\t$: models = selectedModels.map((id) => $_models.find((m) => m.id === id));\n\n\tonMount(() => {});\n</script>\n\n<div class=\"m-auto w-full max-w-6xl px-2 @2xl:px-20 translate-y-6 py-24 text-center\">\n\t{#if $temporaryChatEnabled}\n\t\t<Tooltip\n\t\t\tcontent=\"This chat won't appear in history and your messages will not be saved.\"\n\t\t\tclassName=\"w-full flex justify-center mb-0.5\"\n\t\t\tplacement=\"top\"\n\t\t>\n\t\t\t<div class=\"flex items-center gap-2 text-gray-500 font-medium text-lg my-2 w-fit\">\n\t\t\t\t<EyeSlash strokeWidth=\"2.5\" className=\"size-5\" /> Temporary Chat\n\t\t\t</div>\n\t\t</Tooltip>\n\t{/if}\n\n\t<div\n\t\tclass=\"w-full text-3xl text-gray-800 dark:text-gray-100 font-medium text-center flex items-center gap-4 font-primary\"\n\t>\n\t\t<div class=\"w-full flex flex-col justify-center items-center\">\n\t\t\t<div class=\"flex flex-row justify-center gap-3 @sm:gap-3.5 w-fit px-5\">\n\t\t\t\t<div class=\"flex shrink-0 justify-center\">\n\t\t\t\t\t<div class=\"flex -space-x-4 mb-0.5\" in:fade={{ duration: 100 }}>\n\t\t\t\t\t\t{#each models as model, modelIdx}\n\t\t\t\t\t\t\t<Tooltip\n\t\t\t\t\t\t\t\tcontent={(models[modelIdx]?.info?.meta?.tags ?? [])\n\t\t\t\t\t\t\t\t\t.map((tag) => tag.name.toUpperCase())\n\t\t\t\t\t\t\t\t\t.join(', ')}\n\t\t\t\t\t\t\t\tplacement=\"top\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\t\t\t\tselectedModelIdx = modelIdx;\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\t\tcrossorigin=\"anonymous\"\n\t\t\t\t\t\t\t\t\t\tsrc={model?.info?.meta?.profile_image_url ??\n\t\t\t\t\t\t\t\t\t\t\t($i18n.language === 'dg-DG'\n\t\t\t\t\t\t\t\t\t\t\t\t? `/doge.png`\n\t\t\t\t\t\t\t\t\t\t\t\t: `static/favicon.png`)}\n\t\t\t\t\t\t\t\t\t\tclass=\" size-9 @sm:size-10 rounded-full border-[1px] border-gray-200 dark:border-none\"\n\t\t\t\t\t\t\t\t\t\talt=\"logo\"\n\t\t\t\t\t\t\t\t\t\tdraggable=\"false\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t{/each}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\" text-3xl @sm:text-4xl line-clamp-1\" in:fade={{ duration: 100 }}>\n\t\t\t\t\t{#if models[selectedModelIdx]?.name}\n\t\t\t\t\t\t{models[selectedModelIdx]?.name}\n\t\t\t\t\t{:else}\n\t\t\t\t\t\t{$i18n.t('Hello, {{name}}', { name: $user.name })}\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\"flex mt-1 mb-2\">\n\t\t\t\t<div in:fade={{ duration: 100, delay: 50 }}>\n\t\t\t\t\t{#if models[selectedModelIdx]?.info?.meta?.description ?? null}\n\t\t\t\t\t\t<Tooltip\n\t\t\t\t\t\t\tclassName=\" w-fit\"\n\t\t\t\t\t\t\tcontent={marked.parse(\n\t\t\t\t\t\t\t\tsanitizeResponseContent(models[selectedModelIdx]?.info?.meta?.description ?? '')\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\tplacement=\"top\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\"mt-0.5 px-2 text-sm font-normal text-gray-500 dark:text-gray-400 line-clamp-2 max-w-xl markdown\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{@html marked.parse(\n\t\t\t\t\t\t\t\t\tsanitizeResponseContent(models[selectedModelIdx]?.info?.meta?.description)\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</Tooltip>\n\n\t\t\t\t\t\t{#if models[selectedModelIdx]?.info?.meta?.user}\n\t\t\t\t\t\t\t<div class=\"mt-0.5 text-sm font-normal text-gray-400 dark:text-gray-500\">\n\t\t\t\t\t\t\t\tBy\n\t\t\t\t\t\t\t\t{#if models[selectedModelIdx]?.info?.meta?.user.community}\n\t\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\t\thref=\"https://openwebui.com/m/{models[selectedModelIdx]?.info?.meta?.user\n\t\t\t\t\t\t\t\t\t\t\t.username}\"\n\t\t\t\t\t\t\t\t\t\t>{models[selectedModelIdx]?.info?.meta?.user.name\n\t\t\t\t\t\t\t\t\t\t\t? models[selectedModelIdx]?.info?.meta?.user.name\n\t\t\t\t\t\t\t\t\t\t\t: `@${models[selectedModelIdx]?.info?.meta?.user.username}`}</a\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t\t{models[selectedModelIdx]?.info?.meta?.user.name}\n\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\"text-base font-normal @md:max-w-3xl w-full py-3 {atSelectedModel ? 'mt-2' : ''}\">\n\t\t\t\t<MessageInput\n\t\t\t\t\t{history}\n\t\t\t\t\t{selectedModels}\n\t\t\t\t\tbind:files\n\t\t\t\t\tbind:prompt\n\t\t\t\t\tbind:autoScroll\n\t\t\t\t\tbind:selectedToolIds\n\t\t\t\t\tbind:imageGenerationEnabled\n\t\t\t\t\tbind:codeInterpreterEnabled\n\t\t\t\t\tbind:webSearchEnabled\n\t\t\t\t\tbind:atSelectedModel\n\t\t\t\t\t{transparentBackground}\n\t\t\t\t\t{stopResponse}\n\t\t\t\t\t{createMessagePair}\n\t\t\t\t\tplaceholder={$i18n.t('How can I help you today?')}\n\t\t\t\t\ton:upload={(e) => {\n\t\t\t\t\t\tdispatch('upload', e.detail);\n\t\t\t\t\t}}\n\t\t\t\t\ton:submit={(e) => {\n\t\t\t\t\t\tdispatch('submit', e.detail);\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<!-- <div class=\"mx-auto max-w-2xl font-primary\" in:fade={{ duration: 200, delay: 200 }}>\n\t\t<div class=\"mx-5\">\n\t\t\t<Suggestions\n\t\t\t\tsuggestionPrompts={atSelectedModel?.info?.meta?.suggestion_prompts ??\n\t\t\t\t\tmodels[selectedModelIdx]?.info?.meta?.suggestion_prompts ??\n\t\t\t\t\t$config?.default_prompt_suggestions ??\n\t\t\t\t\t[]}\n\t\t\t\tinputValue={prompt}\n\t\t\t\ton:select={(e) => {\n\t\t\t\t\tselectSuggestionPrompt(e.detail);\n\t\t\t\t}}\n\t\t\t/>\n\t\t</div>\n\t</div> -->\n</div>\n","<script lang=\"ts\">\n\timport { v4 as uuidv4 } from 'uuid';\n\timport { toast } from 'svelte-sonner';\n\timport mermaid from 'mermaid';\n\timport { PaneGroup, Pane, PaneResizer } from 'paneforge';\n\n\timport { getContext, onDestroy, onMount, tick } from 'svelte';\n\tconst i18n: Writable<i18nType> = getContext('i18n');\n\n\timport { goto } from '$app/navigation';\n\timport { page } from '$app/stores';\n\n\timport { get, type Unsubscriber, type Writable } from 'svelte/store';\n\timport type { i18n as i18nType } from 'i18next';\n\timport { WEBUI_BASE_URL } from '$lib/constants';\n\n\timport {\n\t\tchatId,\n\t\tchats,\n\t\tconfig,\n\t\ttype Model,\n\t\tmodels,\n\t\ttags as allTags,\n\t\tsettings,\n\t\tshowSidebar,\n\t\tWEBUI_NAME,\n\t\tbanners,\n\t\tuser,\n\t\tsocket,\n\t\tshowControls,\n\t\tshowCallOverlay,\n\t\tcurrentChatPage,\n\t\ttemporaryChatEnabled,\n\t\tmobile,\n\t\tshowOverview,\n\t\tchatTitle,\n\t\tshowArtifacts,\n\t\ttools,\n\t\tuserAPIKey\n\t} from '$lib/stores';\n\timport {\n\t\tconvertMessagesToHistory,\n\t\tcopyToClipboard,\n\t\tgetMessageContentParts,\n\t\tcreateMessagesList,\n\t\textractSentencesForAudio,\n\t\tpromptTemplate,\n\t\tsplitStream,\n\t\tsleep,\n\t\tremoveDetails,\n\t\tgetPromptVariables\n\t} from '$lib/utils';\n\n\timport { generateChatCompletion } from '$lib/apis/ollama';\n\timport {\n\t\taddTagById,\n\t\tcreateNewChat,\n\t\tdeleteTagById,\n\t\tdeleteTagsById,\n\t\tgetAllTags,\n\t\tgetChatById,\n\t\tgetChatList,\n\t\tgetTagsById,\n\t\tupdateChatById\n\t} from '$lib/apis/chats';\n\timport { generateOpenAIChatCompletion } from '$lib/apis/openai';\n\timport { processWeb, processWebSearch, processYoutubeVideo } from '$lib/apis/retrieval';\n\timport { createOpenAITextStream } from '$lib/apis/streaming';\n\timport { queryMemory } from '$lib/apis/memories';\n\timport { getAndUpdateUserLocation, getUserSettings } from '$lib/apis/users';\n\timport {\n\t\tchatCompleted,\n\t\tgenerateQueries,\n\t\tchatAction,\n\t\tgenerateMoACompletion,\n\t\tstopTask\n\t} from '$lib/apis';\n\timport { getTools } from '$lib/apis/tools';\n\n\timport Banner from '../common/Banner.svelte';\n\timport MessageInput from '$lib/components/chat/MessageInput.svelte';\n\timport Messages from '$lib/components/chat/Messages.svelte';\n\timport Navbar from '$lib/components/chat/Navbar.svelte';\n\timport ChatControls from './ChatControls.svelte';\n\timport EventConfirmDialog from '../common/ConfirmDialog.svelte';\n\timport Placeholder from './Placeholder.svelte';\n\timport NotificationToast from '../NotificationToast.svelte';\n\timport Spinner from '../common/Spinner.svelte';\n\n\texport let chatIdProp = '';\n\n\tlet loading = false;\n\n\tconst eventTarget = new EventTarget();\n\tlet controlPane;\n\tlet controlPaneComponent;\n\n\tlet autoScroll = true;\n\tlet processing = '';\n\tlet messagesContainerElement: HTMLDivElement;\n\n\tlet navbarElement;\n\n\tlet showEventConfirmation = false;\n\tlet eventConfirmationTitle = '';\n\tlet eventConfirmationMessage = '';\n\tlet eventConfirmationInput = false;\n\tlet eventConfirmationInputPlaceholder = '';\n\tlet eventConfirmationInputValue = '';\n\tlet eventCallback = null;\n\n\tlet chatIdUnsubscriber: Unsubscriber | undefined;\n\n\tlet selectedModels = [''];\n\tlet atSelectedModel: Model | undefined;\n\tlet selectedModelIds = [];\n\t$: selectedModelIds = atSelectedModel !== undefined ? [atSelectedModel.id] : selectedModels;\n\n\tlet selectedToolIds = [];\n\tlet imageGenerationEnabled = false;\n\tlet webSearchEnabled = false;\n\tlet codeInterpreterEnabled = false;\n\tlet chat = null;\n\tlet tags = [];\n\n\tlet history = {\n\t\tmessages: {},\n\t\tcurrentId: null\n\t};\n\n\tlet taskId = null;\n\n\t// Chat Input\n\tlet prompt = '';\n\tlet chatFiles = [];\n\tlet files = [];\n\tlet params = {};\n\n\t$: if (chatIdProp) {\n\t\t(async () => {\n\t\t\tloading = true;\n\t\t\tconsole.log(chatIdProp);\n\n\t\t\tprompt = '';\n\t\t\tfiles = [];\n\t\t\tselectedToolIds = [];\n\t\t\twebSearchEnabled = false;\n\t\t\timageGenerationEnabled = false;\n\n\t\t\tif (chatIdProp && (await loadChat())) {\n\t\t\t\tawait tick();\n\t\t\t\tloading = false;\n\n\t\t\t\tif (localStorage.getItem(`chat-input-${chatIdProp}`)) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tconst input = JSON.parse(localStorage.getItem(`chat-input-${chatIdProp}`));\n\n\t\t\t\t\t\tprompt = input.prompt;\n\t\t\t\t\t\tfiles = input.files;\n\t\t\t\t\t\tselectedToolIds = input.selectedToolIds;\n\t\t\t\t\t\twebSearchEnabled = input.webSearchEnabled;\n\t\t\t\t\t\timageGenerationEnabled = input.imageGenerationEnabled;\n\t\t\t\t\t} catch (e) {}\n\t\t\t\t}\n\n\t\t\t\twindow.setTimeout(() => scrollToBottom(), 0);\n\t\t\t\tconst chatInput = document.getElementById('chat-input');\n\t\t\t\tchatInput?.focus();\n\t\t\t} else {\n\t\t\t\tawait goto('/');\n\t\t\t}\n\t\t})();\n\t}\n\n\t$: if (selectedModels && chatIdProp !== '') {\n\t\tsaveSessionSelectedModels();\n\t}\n\n\tconst saveSessionSelectedModels = () => {\n\t\tif (selectedModels.length === 0 || (selectedModels.length === 1 && selectedModels[0] === '')) {\n\t\t\treturn;\n\t\t}\n\t\tsessionStorage.selectedModels = JSON.stringify(selectedModels);\n\t\tconsole.log('saveSessionSelectedModels', selectedModels, sessionStorage.selectedModels);\n\t};\n\n\t$: if (selectedModels) {\n\t\tsetToolIds();\n\t}\n\n\t$: if (atSelectedModel || selectedModels) {\n\t\tsetToolIds();\n\t}\n\n\tconst setToolIds = async () => {\n\t\tif (!$tools) {\n\t\t\ttools.set(await getTools(localStorage.token));\n\t\t}\n\n\t\tif (selectedModels.length !== 1 && !atSelectedModel) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst model = atSelectedModel ?? $models.find((m) => m.id === selectedModels[0]);\n\t\tif (model) {\n\t\t\tselectedToolIds = (model?.info?.meta?.toolIds ?? []).filter((id) =>\n\t\t\t\t$tools.find((t) => t.id === id)\n\t\t\t);\n\t\t}\n\t};\n\n\tconst showMessage = async (message) => {\n\t\tconst _chatId = JSON.parse(JSON.stringify($chatId));\n\t\tlet _messageId = JSON.parse(JSON.stringify(message.id));\n\n\t\tlet messageChildrenIds = history.messages[_messageId].childrenIds;\n\n\t\twhile (messageChildrenIds.length !== 0) {\n\t\t\t_messageId = messageChildrenIds.at(-1);\n\t\t\tmessageChildrenIds = history.messages[_messageId].childrenIds;\n\t\t}\n\n\t\thistory.currentId = _messageId;\n\n\t\tawait tick();\n\t\tawait tick();\n\t\tawait tick();\n\n\t\tconst messageElement = document.getElementById(`message-${message.id}`);\n\t\tif (messageElement) {\n\t\t\tmessageElement.scrollIntoView({ behavior: 'smooth' });\n\t\t}\n\n\t\tawait tick();\n\t\tsaveChatHandler(_chatId, history);\n\t};\n\n\t// Improved chat completion event handler to better work with agent responses\n\tconst chatCompletionEventHandler = async (data, message, chatId) => {\n\t\tconsole.log('💬 chatCompletionEventHandler data:', JSON.stringify(data));\n\t\tconsole.log('💬 Message ID:', message.id);\n\t\tconsole.log('💬 Message before update:', message.content ? message.content.substring(0, 50) + '...' : 'empty');\n\n\t\tif (data && chatId === $chatId) {\n\t\t\t// Update the message with the new data\n\t\t\tif (data.content !== undefined) {\n\t\t\t\t// Don't overwrite if empty content is provided\n\t\t\t\tif (data.content !== \"\" || !message.content) {\n\t\t\t\t\t// Stop loading animation if real content arrives\n\t\t\t\t\tif (message.isLoading) {\n\t\t\t\t\t\tmessage.isLoading = false;\n\t\t\t\t\t}\n\t\t\t\t\tmessage.content = data.content;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (data.done !== undefined) {\n\t\t\t\tmessage.done = data.done;\n\t\t\t\t// Make sure we stop the loading animation when done\n\t\t\t\tif (data.done) {\n\t\t\t\t\tmessage.isLoading = false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (data.loading !== undefined) {\n\t\t\t\tmessage.loading = data.loading;\n\t\t\t}\n\n\t\t\tif (data.error !== undefined) {\n\t\t\t\tmessage.error = data.error;\n\t\t\t\t// Stop animation on error\n\t\t\t\tmessage.isLoading = false;\n\t\t\t}\n\n\t\t\tif (data.status !== undefined) {\n\t\t\t\tmessage.status = data.status;\n\t\t\t}\n\n\t\t\t// Handle agent-specific data - check if content is a stringified JSON\n\t\t\ttry {\n\t\t\t\tif (typeof message.content === 'string' && message.content.trim().startsWith('{') && message.content.trim().endsWith('}')) {\n\t\t\t\t\tconst parsedContent = JSON.parse(message.content);\n\t\t\t\t\tif (parsedContent.success && parsedContent.response) {\n\t\t\t\t\t\tconsole.log('🤖 Agent response detected:', parsedContent.response.type);\n\t\t\t\t\t\t// Content is already in the correct format, no need to transform\n\t\t\t\t\t\t// Stop the loading animation as we have a real response\n\t\t\t\t\t\tmessage.isLoading = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\t// Not JSON or not in agent format, continue with normal processing\n\t\t\t}\n\n\t\t\t// Force update in history object to ensure UI updates\n\t\t\tif (history && history.messages) {\n\t\t\t\thistory.messages[message.id] = {...message};\n\t\t\t\tconsole.log('✅ Updated message in history object');\n\t\t\t}\n\t\t\t\n\t\t\t// If loading is complete, scroll to bottom\n\t\t\tif (data.done || data.loading === false) {\n\t\t\t\tif (autoScroll) {\n\t\t\t\t\tscrollToBottom();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Update the message in history to ensure UI updates\n\t\tif (message.done && history && history.messages) {\n\t\t\thistory.messages[message.id] = { ...message };\n\t\t\tconsole.log('📝 Updated final message in history');\n\t\t}\n\t};\n\n\t// Improved socket event handler with better agent response support\n\tconst chatEventHandler = async (event, cb) => {\n\t\tconsole.log('📥 Socket event received:', event && JSON.stringify(event).substring(0, 200) + '...');\n\n\t\tif (event.chat_id === $chatId) {\n\t\t\tawait tick();\n\t\t\tlet message = history.messages[event.message_id];\n\n\t\t\tif (message) {\n\t\t\t\tconst type = event?.data?.type ?? null;\n\t\t\t\tconst data = event?.data?.data ?? null;\n\n\t\t\t\tconsole.log('📥 Event type:', type, 'Data ID:', data?.id);\n\t\t\t\tconsole.log('📥 Content preview:', data?.content ? data.content.substring(0, 50) + '...' : 'No content');\n\n\t\t\t\tif (type === 'chat:completion') {\n\t\t\t\t\tconsole.log('🤖 Processing agent API response from socket event');\n\t\t\t\t\t\n\t\t\t\t\tif (data.content) {\n\t\t\t\t\t\tconsole.log('📝 Content length:', data.content.length);\n\t\t\t\t\t\t\n\t\t\t\t\t\t// If we have real content, stop the loading animation\n\t\t\t\t\t\tif (message.isLoading) {\n\t\t\t\t\t\t\tmessage.isLoading = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tmessage.content = data.content;\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (data.done !== false) {\n\t\t\t\t\t\t\tmessage.done = true;\n\t\t\t\t\t\t\tconsole.log('✅ Marking message as done');\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\t// Force history update\n\t\t\t\t\t\thistory.messages[event.message_id] = { ...message };\n\t\t\t\t\t\tconsole.log('✅ Updated message in history.messages');\n\t\t\t\t\t\t\n\t\t\t\t\t\t// Force UI update\n\t\t\t\t\t\tawait tick();\n\t\t\t\t\t\tconsole.log('✅ Forced UI update');\n\t\t\t\t\t\t\n\t\t\t\t\t\t// If done and autoScroll is enabled, scroll to bottom\n\t\t\t\t\t\tif (data.done && autoScroll) {\n\t\t\t\t\t\t\tscrollToBottom();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else if (type === 'status') {\n\t\t\t\t\tif (message?.statusHistory) {\n\t\t\t\t\t\tmessage.statusHistory.push(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmessage.statusHistory = [data];\n\t\t\t\t\t}\n\t\t\t\t} else if (type === 'source' || type === 'citation') {\n\t\t\t\t\tif (data?.type === 'code_execution') {\n\t\t\t\t\t\t// Code execution; update existing code execution by ID, or add new one.\n\t\t\t\t\t\tif (!message.codeExecutions) {\n\t\t\t\t\t\t\tmessage.codeExecutions = [];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst existingIndex = message.codeExecutions.findIndex(\n\t\t\t\t\t\t\t(exec) => exec.id === data.execution_id\n\t\t\t\t\t\t);\n\t\t\t\t\t\tif (existingIndex !== -1) {\n\t\t\t\t\t\t\tmessage.codeExecutions[existingIndex] = {\n\t\t\t\t\t\t\t\t...message.codeExecutions[existingIndex],\n\t\t\t\t\t\t\t\t...data,\n\t\t\t\t\t\t\t\tupdated: Date.now()\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tmessage.codeExecutions.push({\n\t\t\t\t\t\t\t\t...data,\n\t\t\t\t\t\t\t\tcreated: Date.now(),\n\t\t\t\t\t\t\t\tupdated: Date.now()\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Standard source\n\t\t\t\t\t\tif (!message.sources) {\n\t\t\t\t\t\t\tmessage.sources = [];\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\tmessage.sources.push(data);\n\t\t\t\t\t\t}\n\t\t\t\t} else if (type === 'chat:title') {\n\t\t\t\t\tchatTitle.set(data);\n\t\t\t\t\tcurrentChatPage.set(1);\n\t\t\t\t\tawait chats.set(await getChatList(localStorage.token, $currentChatPage));\n\t\t\t\t} else if (type === 'chat:tags') {\n\t\t\t\t\tchat = await getChatById(localStorage.token, $chatId);\n\t\t\t\t\tallTags.set(await getAllTags(localStorage.token));\n\t\t\t\t} else if (type === 'message') {\n\t\t\t\t\tconsole.log('📝 Appending message content:', data.content);\n\t\t\t\t\t// If we're still in loading state but receiving actual content, stop the animation\n\t\t\t\t\tif (message.isLoading) {\n\t\t\t\t\t\tmessage.isLoading = false;\n\t\t\t\t\t}\n\t\t\t\t\tmessage.content += data.content;\n\t\t\t\t} else if (type === 'replace') {\n\t\t\t\t\tconsole.log('📝 Replacing message content:', data.content);\n\t\t\t\t\t// If we're still in loading state but receiving actual content, stop the animation\n\t\t\t\t\tif (message.isLoading) {\n\t\t\t\t\t\tmessage.isLoading = false;\n\t\t\t\t\t}\n\t\t\t\t\tmessage.content = data.content;\n\t\t\t\t} else if (type === 'action') {\n\t\t\t\t\tif (data.action === 'continue') {\n\t\t\t\t\t\tconst continueButton = document.getElementById('continue-response-button');\n\n\t\t\t\t\t\tif (continueButton) {\n\t\t\t\t\t\t\tcontinueButton.click();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tconsole.log('❓ Unknown message type:', type, data);\n\t\t\t\t}\n\n\t\t\t\t// Force history to update\n\t\t\t\thistory = { ...history };\n\n\t\t\t\t// Callback\n\t\t\t\tif (cb && typeof cb === 'function') {\n\t\t\t\t\tcb(event, message);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\tconsole.warn('⚠️ No message found for ID:', event.message_id);\n\t\t\t}\n\t\t}\n\t};\n\n\tconst onMessageHandler = async (event: {\n\t\torigin: string;\n\t\tdata: { type: string; text: string };\n\t}) => {\n\t\tif (event.origin !== window.origin) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Replace with your iframe's origin\n\t\tif (event.data.type === 'input:prompt') {\n\t\t\tconsole.debug(event.data.text);\n\n\t\t\tconst inputElement = document.getElementById('chat-input');\n\n\t\t\tif (inputElement) {\n\t\t\t\tprompt = event.data.text;\n\t\t\t\tinputElement.focus();\n\t\t\t}\n\t\t}\n\n\t\tif (event.data.type === 'action:submit') {\n\t\t\tconsole.debug(event.data.text);\n\n\t\t\tif (prompt !== '') {\n\t\t\t\tawait tick();\n\t\t\t\tsubmitPrompt(prompt);\n\t\t\t}\n\t\t}\n\n\t\tif (event.data.type === 'input:prompt:submit') {\n\t\t\tconsole.debug(event.data.text);\n\n\t\t\tif (prompt !== '') {\n\t\t\t\tawait tick();\n\t\t\t\tsubmitPrompt(event.data.text);\n\t\t\t}\n\t\t}\n\t};\n\n\tonMount(async () => {\n\t\tconsole.log('mounted');\n\t\tconsole.log(\"Initial userAPIKey value:\", $userAPIKey ? \"Present\" : \"Empty/None\");\n\t\t\n\t\twindow.addEventListener('message', onMessageHandler);\n\t\t$socket?.on('chat-events', chatEventHandler);\n\n\t\tif (!$chatId) {\n\t\t\tchatIdUnsubscriber = chatId.subscribe(async (value) => {\n\t\t\t\tif (!value) {\n\t\t\t\t\tawait initNewChat();\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\tif ($temporaryChatEnabled) {\n\t\t\t\tawait goto('/');\n\t\t\t}\n\t\t}\n\n\t\tif (localStorage.getItem(`chat-input-${chatIdProp}`)) {\n\t\t\ttry {\n\t\t\t\tconst input = JSON.parse(localStorage.getItem(`chat-input-${chatIdProp}`));\n\t\t\t\tprompt = input.prompt;\n\t\t\t\tfiles = input.files;\n\t\t\t\tselectedToolIds = input.selectedToolIds;\n\t\t\t\twebSearchEnabled = input.webSearchEnabled;\n\t\t\t\timageGenerationEnabled = input.imageGenerationEnabled;\n\t\t\t} catch (e) {\n\t\t\t\tprompt = '';\n\t\t\t\tfiles = [];\n\t\t\t\tselectedToolIds = [];\n\t\t\t\twebSearchEnabled = false;\n\t\t\t\timageGenerationEnabled = false;\n\t\t\t}\n\t\t}\n\n\t\tshowControls.subscribe(async (value) => {\n\t\t\tif (controlPane && !$mobile) {\n\t\t\t\ttry {\n\t\t\t\t\tif (value) {\n\t\t\t\t\t\tcontrolPaneComponent.openPane();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcontrolPane.collapse();\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t\t// ignore\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!value) {\n\t\t\t\tshowCallOverlay.set(false);\n\t\t\t\tshowOverview.set(false);\n\t\t\t\tshowArtifacts.set(false);\n\t\t\t}\n\t\t});\n\n\t\tconst chatInput = document.getElementById('chat-input');\n\t\tchatInput?.focus();\n\n\t\tchats.subscribe(() => {});\n\n\t\twindow.addEventListener('beforeunload', (event) => {\n\t\t\tlocalStorage.setItem(`chat-input-${$chatId}`, JSON.stringify({ \n\t\t\t\tprompt,\n\t\t\t\tfiles,\n\t\t\t\tselectedToolIds,\n\t\t\t\twebSearchEnabled,\n\t\t\t\timageGenerationEnabled\n\t\t\t}));\n\t\t});\n\t});\n\n\tonDestroy(() => {\n\t\tchatIdUnsubscriber?.();\n\t\twindow.removeEventListener('message', onMessageHandler);\n\t\t$socket?.off('chat-events', chatEventHandler);\n\t});\n\n\t// File upload functions\n\n\tconst uploadGoogleDriveFile = async (fileData) => {\n\t\tconsole.log('Starting uploadGoogleDriveFile with:', {\n\t\t\tid: fileData.id,\n\t\t\tname: fileData.name,\n\t\t\turl: fileData.url,\n\t\t\theaders: {\n\t\t\t\tAuthorization: `Bearer ${token}`\n\t\t\t}\n\t\t});\n\n\t\t// Validate input\n\t\tif (!fileData?.id || !fileData?.name || !fileData?.url || !fileData?.headers?.Authorization) {\n\t\t\tthrow new Error('Invalid file data provided');\n\t\t}\n\n\t\tconst tempItemId = uuidv4();\n\t\tconst fileItem = {\n\t\t\ttype: 'file',\n\t\t\tfile: '',\n\t\t\tid: null,\n\t\t\turl: fileData.url,\n\t\t\tname: fileData.name,\n\t\t\tcollection_name: '',\n\t\t\tstatus: 'uploading',\n\t\t\terror: '',\n\t\t\titemId: tempItemId,\n\t\t\tsize: 0\n\t\t};\n\n\t\ttry {\n\t\t\tfiles = [...files, fileItem];\n\t\t\tconsole.log('Processing web file with URL:', fileData.url);\n\n\t\t\t// Configure fetch options with proper headers\n\t\t\tconst fetchOptions = {\n\t\t\t\theaders: {\n\t\t\t\t\tAuthorization: fileData.headers.Authorization,\n\t\t\t\t\tAccept: '*/*'\n\t\t\t\t},\n\t\t\t\tmethod: 'GET'\n\t\t\t};\n\n\t\t\t// Attempt to fetch the file\n\t\t\tconsole.log('Fetching file content from Google Drive...');\n\t\t\tconst fileResponse = await fetch(fileData.url, fetchOptions);\n\n\t\t\tif (!fileResponse.ok) {\n\t\t\t\tconst errorText = await fileResponse.text();\n\t\t\t\tthrow new Error(`Failed to fetch file (${fileResponse.status}): ${errorText}`);\n\t\t\t}\n\n\t\t\t// Get content type from response\n\t\t\tconst contentType = fileResponse.headers.get('content-type') || 'application/octet-stream';\n\t\t\tconsole.log('Response received with content-type:', contentType);\n\n\t\t\t// Convert response to blob\n\t\t\tconsole.log('Converting response to blob...');\n\t\t\tconst fileBlob = await fileResponse.blob();\n\n\t\t\tif (fileBlob.size === 0) {\n\t\t\t\tthrow new Error('Retrieved file is empty');\n\t\t\t}\n\n\t\t\tconsole.log('Blob created:', {\n\t\t\t\tsize: fileBlob.size,\n\t\t\t\ttype: fileBlob.type || contentType\n\t\t\t});\n\n\t\t\t// Create File object with proper MIME type\n\t\t\tconst file = new File([fileBlob], fileData.name, {\n\t\t\t\ttype: fileBlob.type || contentType\n\t\t\t});\n\n\t\t\tconsole.log('File object created:', {\n\t\t\t\tname: file.name,\n\t\t\t\tsize: file.size,\n\t\t\t\ttype: file.type\n\t\t\t});\n\n\t\t\tif (file.size === 0) {\n\t\t\t\tthrow new Error('Created file is empty');\n\t\t\t}\n\n\t\t\t// Upload file to server\n\t\t\tconsole.log('Uploading file to server...');\n\t\t\tconst uploadedFile = await uploadFile(localStorage.token, file);\n\n\t\t\tif (!uploadedFile) {\n\t\t\t\tthrow new Error('Server returned null response for file upload');\n\t\t\t}\n\n\t\t\tconsole.log('File uploaded successfully:', uploadedFile);\n\n\t\t\t// Update file item with upload results\n\t\t\tfileItem.status = 'uploaded';\n\t\t\tfileItem.file = uploadedFile;\n\t\t\tfileItem.id = uploadedFile.id;\n\t\t\tfileItem.size = file.size;\n\t\t\tfileItem.collection_name = uploadedFile?.meta?.collection_name;\n\t\t\tfileItem.url = `${WEBUI_API_BASE_URL}/files/${uploadedFile.id}`;\n\n\t\t\tfiles = files;\n\t\t\ttoast.success($i18n.t('File uploaded successfully'));\n\t\t} catch (e) {\n\t\t\tconsole.error('Error uploading file:', e);\n\t\t\tfiles = files.filter((f) => f.itemId !== tempItemId);\n\t\t\ttoast.error(\n\t\t\t\t$i18n.t('Error uploading file: {{error}}', {\n\t\t\t\t\terror: e.message || 'Unknown error'\n\t\t\t\t})\n\t\t\t);\n\t\t}\n\t};\n\n\tconst uploadWeb = async (url) => {\n\t\tconsole.log(url);\n\n\t\tconst fileItem = {\n\t\t\ttype: 'doc',\n\t\t\tname: url,\n\t\t\tcollection_name: '',\n\t\t\tstatus: 'uploading',\n\t\t\turl: url,\n\t\t\terror: ''\n\t\t};\n\n\t\ttry {\n\t\t\tfiles = [...files, fileItem];\n\t\t\tconst res = await processWeb(localStorage.token, '', url);\n\n\t\t\tif (res) {\n\t\t\t\tfileItem.status = 'uploaded';\n\t\t\t\tfileItem.collection_name = res.collection_name;\n\t\t\t\tfileItem.file = {\n\t\t\t\t\t...res.file,\n\t\t\t\t\t...fileItem.file\n\t\t\t\t};\n\n\t\t\t\tfiles = files;\n\t\t\t}\n\t\t} catch (e) {\n\t\t\t// Remove the failed doc from the files array\n\t\t\tfiles = files.filter((f) => f.name !== url);\n\t\t\ttoast.error(JSON.stringify(e));\n\t\t}\n\t};\n\n\tconst uploadYoutubeTranscription = async (url) => {\n\t\tconsole.log(url);\n\n\t\tconst fileItem = {\n\t\t\ttype: 'doc',\n\t\t\tname: url,\n\t\t\tcollection_name: '',\n\t\t\tstatus: 'uploading',\n\t\t\tcontext: 'full',\n\t\t\turl: url,\n\t\t\terror: ''\n\t\t};\n\n\t\ttry {\n\t\t\tfiles = [...files, fileItem];\n\t\t\tconst res = await processYoutubeVideo(localStorage.token, url);\n\n\t\t\tif (res) {\n\t\t\t\tfileItem.status = 'uploaded';\n\t\t\t\tfileItem.collection_name = res.collection_name;\n\t\t\t\tfileItem.file = {\n\t\t\t\t\t...res.file,\n\t\t\t\t\t...fileItem.file\n\t\t\t\t};\n\t\t\t\tfiles = files;\n\t\t\t}\n\t\t} catch (e) {\n\t\t\t// Remove the failed doc from the files array\n\t\t\tfiles = files.filter((f) => f.name !== url);\n\t\t\ttoast.error(`${e}`);\n\t\t}\n\t};\n\n\t//////////////////////////\n\t// Web functions\n\t//////////////////////////\n\n\tconst initNewChat = async () => {\n\t\tif ($page.url.searchParams.get('models')) {\n\t\t\tselectedModels = $page.url.searchParams.get('models')?.split(',');\n\t\t} else if ($page.url.searchParams.get('model')) {\n\t\t\tconst urlModels = $page.url.searchParams.get('model')?.split(',');\n\n\t\t\tif (urlModels.length === 1) {\n\t\t\t\tconst m = $models.find((m) => m.id === urlModels[0]);\n\t\t\t\tif (!m) {\n\t\t\t\t\tconst modelSelectorButton = document.getElementById('model-selector-0-button');\n\t\t\t\t\tif (modelSelectorButton) {\n\t\t\t\t\t\tmodelSelectorButton.click();\n\t\t\t\t\t\tawait tick();\n\n\t\t\t\t\t\tconst modelSelectorInput = document.getElementById('model-search-input');\n\t\t\t\t\t\tif (modelSelectorInput) {\n\t\t\t\t\t\t\tmodelSelectorInput.focus();\n\t\t\t\t\t\t\tmodelSelectorInput.value = urlModels[0];\n\t\t\t\t\t\t\tmodelSelectorInput.dispatchEvent(new Event('input'));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tselectedModels = urlModels;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tselectedModels = urlModels;\n\t\t\t}\n\t\t} else {\n\t\t\tif (sessionStorage.selectedModels) {\n\t\t\t\tselectedModels = JSON.parse(sessionStorage.selectedModels);\n\t\t\t\tsessionStorage.removeItem('selectedModels');\n\t\t\t} else {\n\t\t\t\tif ($settings?.models) {\n\t\t\t\t\tselectedModels = $settings?.models;\n\t\t\t\t} else if ($config?.default_models) {\n\t\t\t\t\tconsole.log($config?.default_models.split(',') ?? '');\n\t\t\t\t\tselectedModels = $config?.default_models.split(',');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tselectedModels = selectedModels.filter((modelId) => $models.map((m) => m.id).includes(modelId));\n\t\tif (selectedModels.length === 0 || (selectedModels.length === 1 && selectedModels[0] === '')) {\n\t\t\tif ($models.length > 0) {\n\t\t\t\tselectedModels = [$models[0].id];\n\t\t\t} else {\n\t\t\t\tselectedModels = [''];\n\t\t\t}\n\t\t}\n\n\t\tawait showControls.set(false);\n\t\tawait showCallOverlay.set(false);\n\t\tawait showOverview.set(false);\n\t\tawait showArtifacts.set(false);\n\n\t\tif ($page.url.pathname.includes('/c/')) {\n\t\t\twindow.history.replaceState(history.state, '', `/`);\n\t\t}\n\n\t\tautoScroll = true;\n\n\t\tawait chatId.set('');\n\t\tawait chatTitle.set('');\n\n\t\thistory = {\n\t\t\tmessages: {},\n\t\t\tcurrentId: null\n\t\t};\n\n\t\tinitHistoryWithGreetings();\n\n\t\tchatFiles = [];\n\t\tparams = {};\n\n\t\tif ($page.url.searchParams.get('youtube')) {\n\t\t\tuploadYoutubeTranscription(\n\t\t\t\t`https://www.youtube.com/watch?v=${$page.url.searchParams.get('youtube')}`\n\t\t\t);\n\t\t}\n\t\tif ($page.url.searchParams.get('web-search') === 'true') {\n\t\t\twebSearchEnabled = true;\n\t\t}\n\n\t\tif ($page.url.searchParams.get('image-generation') === 'true') {\n\t\t\timageGenerationEnabled = true;\n\t\t}\n\n\t\tif ($page.url.searchParams.get('tools')) {\n\t\t\tselectedToolIds = $page.url.searchParams\n\t\t\t\t.get('tools')\n\t\t\t\t?.split(',')\n\t\t\t\t.map((id) => id.trim())\n\t\t\t\t.filter((id) => id);\n\t\t} else if ($page.url.searchParams.get('tool-ids')) {\n\t\t\tselectedToolIds = $page.url.searchParams\n\t\t\t\t.get('tool-ids')\n\t\t\t\t?.split(',')\n\t\t\t\t.map((id) => id.trim())\n\t\t\t\t.filter((id) => id);\n\t\t}\n\n\t\tif ($page.url.searchParams.get('call') === 'true') {\n\t\t\tshowCallOverlay.set(true);\n\t\t\tshowControls.set(true);\n\t\t}\n\n\t\tif ($page.url.searchParams.get('q')) {\n\t\t\tprompt = $page.url.searchParams.get('q') ?? '';\n\n\t\t\tif (prompt) {\n\t\t\t\tawait tick();\n\t\t\t\tsubmitPrompt(prompt);\n\t\t\t}\n\t\t}\n\n\t\tselectedModels = selectedModels.map((modelId) =>\n\t\t\t$models.map((m) => m.id).includes(modelId) ? modelId : ''\n\t\t);\n\n\t\tconst userSettings = await getUserSettings(localStorage.token);\n\n\t\tif (userSettings) {\n\t\t\tsettings.set(userSettings.ui);\n\t\t} else {\n\t\t\tsettings.set(JSON.parse(localStorage.getItem('settings') ?? '{}'));\n\t\t}\n\n\t\tconst chatInput = document.getElementById('chat-input');\n\t\tsetTimeout(() => chatInput?.focus(), 0);\n\t};\n\n\tconst loadChat = async () => {\n\t\tchatId.set(chatIdProp);\n\t\tchat = await getChatById(localStorage.token, $chatId).catch(async (error) => {\n\t\t\tawait goto('/');\n\t\t\treturn null;\n\t\t});\n\n\t\tif (chat) {\n\t\t\ttags = await getTagsById(localStorage.token, $chatId).catch(async (error) => {\n\t\t\t\treturn [];\n\t\t\t});\n\n\t\t\tconst chatContent = chat.chat;\n\n\t\t\tif (chatContent) {\n\t\t\t\tconsole.log(chatContent);\n\n\t\t\t\tselectedModels =\n\t\t\t\t\t(chatContent?.models ?? undefined) !== undefined\n\t\t\t\t\t\t? chatContent.models\n\t\t\t\t\t\t: [chatContent.models ?? ''];\n\t\t\t\thistory =\n\t\t\t\t\t(chatContent?.history ?? undefined) !== undefined\n\t\t\t\t\t\t? chatContent.history\n\t\t\t\t\t\t: convertMessagesToHistory(chatContent.messages);\n\n\t\t\t\tchatTitle.set(chatContent.title);\n\n\t\t\t\tconst userSettings = await getUserSettings(localStorage.token);\n\n\t\t\t\tif (userSettings) {\n\t\t\t\t\tawait settings.set(userSettings.ui);\n\t\t\t\t} else {\n\t\t\t\t\tawait settings.set(JSON.parse(localStorage.getItem('settings') ?? '{}'));\n\t\t\t\t}\n\n\t\t\t\tparams = chatContent?.params ?? {};\n\t\t\t\tchatFiles = chatContent?.files ?? [];\n\n\t\t\t\tautoScroll = true;\n\t\t\t\tawait tick();\n\n\t\t\t\tif (history.currentId) {\n\t\t\t\t\thistory.messages[history.currentId].done = true;\n\t\t\t\t}\n\t\t\t\tawait tick();\n\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t};\n\n\tconst scrollToBottom = async () => {\n\t\tawait tick();\n\t\tif (messagesContainerElement) {\n\t\t\tmessagesContainerElement.scrollTop = messagesContainerElement.scrollHeight;\n\t\t}\n\t};\n\tconst chatCompletedHandler = async (chatId, modelId, responseMessageId, messages) => {\n\t\tconsole.log('✅ chatCompletedHandler called:', { chatId, modelId, responseMessageId });\n\t\tconsole.log('📝 messages to save:', messages.length > 0 ? messages[0].role : 'empty');\n\t\t\n\t\tconst res = await chatCompleted(localStorage.token, {\n\t\t\tmodel: modelId,\n\t\t\tmessages: messages.map((m) => ({\n\t\t\t\tid: m.id,\n\t\t\t\trole: m.role,\n\t\t\t\tcontent: m.content,\n\t\t\t\tmodels: m.models\n\t\t\t})),\n\t\t\tmodel_item: $models.find((m) => m.id === modelId),\n\t\t\tchat_id: chatId,\n\t\t\tsession_id: $socket?.id,\n\t\t\tid: responseMessageId\n\t\t}).catch((error) => {\n\t\t\tconsole.error('❌ Error in chatCompleted:', error);\n\t\t\ttoast.error(`${error}`);\n\t\t\treturn null;\n\t\t});\n\n\t\tconsole.log('✅ chatCompleted response:', res ? 'success' : 'failed');\n\n\t\tif (res !== null && res.messages) {\n\t\t\t// Update chat history with the new messages\n\t\t\tfor (const message of res.messages) {\n\t\t\t\tif (message?.id) {\n\t\t\t\t\t// Add null check for message and message.id\n\t\t\t\t\thistory.messages[message.id] = {\n\t\t\t\t\t\t...history.messages[message.id],\n\t\t\t\t\t\t...(history.messages[message.id].content !== message.content\n\t\t\t\t\t\t\t? { originalContent: history.messages[message.id].content }\n\t\t\t\t\t\t\t: {}),\n\t\t\t\t\t\t...message\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tawait tick();\n\n\t\tif ($chatId == chatId) {\n\t\t\tif (!$temporaryChatEnabled) {\n\t\t\t\tchat = await updateChatById(localStorage.token, chatId, {\n\t\t\t\t\tmodels: selectedModels,\n\t\t\t\t\tmessages: messages,\n\t\t\t\t\thistory: history,\n\t\t\t\t\tparams: params,\n\t\t\t\t\tfiles: chatFiles\n\t\t\t\t});\n\n\t\t\t\tcurrentChatPage.set(1);\n\t\t\t\tawait chats.set(await getChatList(localStorage.token, $currentChatPage));\n\t\t\t}\n\t\t}\n\t};\n\n\tconst chatActionHandler = async (chatId, actionId, modelId, responseMessageId, event = null) => {\n\t\tconst messages = createMessagesList(history, responseMessageId);\n\n\t\tconst res = await chatAction(localStorage.token, actionId, {\n\t\t\tmodel: modelId,\n\t\t\tmessages: messages.map((m) => ({\n\t\t\t\tid: m.id,\n\t\t\t\trole: m.role,\n\t\t\t\tcontent: m.content,\n\t\t\t\tinfo: m.info ? m.info : undefined,\n\t\t\t\ttimestamp: m.timestamp,\n\t\t\t\t...(m.sources ? { sources: m.sources } : {})\n\t\t\t})),\n\t\t\t...(event ? { event: event } : {}),\n\t\t\tmodel_item: $models.find((m) => m.id === modelId),\n\t\t\tchat_id: chatId,\n\t\t\tsession_id: $socket?.id,\n\t\t\tid: responseMessageId\n\t\t}).catch((error) => {\n\t\t\ttoast.error(`${error}`);\n\t\t\tmessages.at(-1).error = { content: error };\n\t\t\treturn null;\n\t\t});\n\n\t\tif (res !== null && res.messages) {\n\t\t\t// Update chat history with the new messages\n\t\t\tfor (const message of res.messages) {\n\t\t\t\thistory.messages[message.id] = {\n\t\t\t\t\t...history.messages[message.id],\n\t\t\t\t\t...(history.messages[message.id].content !== message.content\n\t\t\t\t\t\t? { originalContent: history.messages[message.id].content }\n\t\t\t\t\t\t: {}),\n\t\t\t\t\t...message\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\tif ($chatId == chatId) {\n\t\t\tif (!$temporaryChatEnabled) {\n\t\t\t\tchat = await updateChatById(localStorage.token, chatId, {\n\t\t\t\t\tmodels: selectedModels,\n\t\t\t\t\tmessages: messages,\n\t\t\t\t\thistory: history,\n\t\t\t\t\tparams: params,\n\t\t\t\t\tfiles: chatFiles\n\t\t\t\t});\n\n\t\t\t\tcurrentChatPage.set(1);\n\t\t\t\tawait chats.set(await getChatList(localStorage.token, $currentChatPage));\n\t\t\t}\n\t\t}\n\t};\n\n\tconst getChatEventEmitter = async (modelId: string, chatId: string = '') => {\n\t\treturn setInterval(() => {\n\t\t\t$socket?.emit('usage', {\n\t\t\t\taction: 'chat',\n\t\t\t\tmodel: modelId,\n\t\t\t\tchat_id: chatId\n\t\t\t});\n\t\t}, 1000);\n\t};\n\n\tconst createMessagePair = async (userPrompt) => {\n\t\tprompt = '';\n\t\tif (selectedModels.length === 0) {\n\t\t\ttoast.error($i18n.t('Model not selected'));\n\t\t} else {\n\t\t\tconst modelId = selectedModels[0];\n\t\t\tconst model = $models.filter((m) => m.id === modelId).at(0);\n\n\t\t\tconst messages = createMessagesList(history, history.currentId);\n\t\t\tconst parentMessage = messages.length !== 0 ? messages.at(-1) : null;\n\n\t\t\tconst userMessageId = uuidv4();\n\t\t\tconst responseMessageId = uuidv4();\n\n\t\t\tconst userMessage = {\n\t\t\t\tid: userMessageId,\n\t\t\t\tparentId: parentMessage ? parentMessage.id : null,\n\t\t\t\tchildrenIds: [responseMessageId],\n\t\t\t\trole: 'user',\n\t\t\t\tcontent: userPrompt ? userPrompt : `[PROMPT] ${userMessageId}`,\n\t\t\t\ttimestamp: Math.floor(Date.now() / 1000)\n\t\t\t};\n\n\t\t\tconst responseMessage = {\n\t\t\t\tid: responseMessageId,\n\t\t\t\tparentId: userMessageId,\n\t\t\t\tchildrenIds: [],\n\t\t\t\trole: 'assistant',\n\t\t\t\tcontent: `[RESPONSE] ${responseMessageId}`,\n\t\t\t\tdone: true,\n\n\t\t\t\tmodel: modelId,\n\t\t\t\tmodelName: model.name ?? model.id,\n\t\t\t\tmodelIdx: 0,\n\t\t\t\ttimestamp: Math.floor(Date.now() / 1000)\n\t\t\t};\n\n\t\t\tif (parentMessage) {\n\t\t\t\tparentMessage.childrenIds.push(userMessageId);\n\t\t\t\thistory.messages[parentMessage.id] = parentMessage;\n\t\t\t}\n\t\t\thistory.messages[userMessageId] = userMessage;\n\t\t\thistory.messages[responseMessageId] = responseMessage;\n\n\t\t\thistory.currentId = responseMessageId;\n\n\t\t\tawait tick();\n\n\t\t\tif (autoScroll) {\n\t\t\t\tscrollToBottom();\n\t\t\t}\n\n\t\t\tif (messages.length === 0) {\n\t\t\t\tawait initChatHandler(history);\n\t\t\t} else {\n\t\t\t\tawait saveChatHandler($chatId, history);\n\t\t\t}\n\t\t}\n\t};\n\n\tconst addMessages = async ({ modelId, parentId, messages }) => {\n\t\tconst model = $models.filter((m) => m.id === modelId).at(0);\n\n\t\tlet parentMessage = history.messages[parentId];\n\t\tlet currentParentId = parentMessage ? parentMessage.id : null;\n\t\tfor (const message of messages) {\n\t\t\tlet messageId = uuidv4();\n\n\t\t\tif (message.role === 'user') {\n\t\t\t\tconst userMessage = {\n\t\t\t\t\tid: messageId,\n\t\t\t\t\tparentId: currentParentId,\n\t\t\t\t\tchildrenIds: [],\n\t\t\t\t\ttimestamp: Math.floor(Date.now() / 1000),\n\t\t\t\t\t...message\n\t\t\t\t};\n\n\t\t\t\tif (parentMessage) {\n\t\t\t\t\tparentMessage.childrenIds.push(messageId);\n\t\t\t\t\thistory.messages[parentMessage.id] = parentMessage;\n\t\t\t\t}\n\n\t\t\t\thistory.messages[messageId] = userMessage;\n\t\t\t\tparentMessage = userMessage;\n\t\t\t\tcurrentParentId = messageId;\n\t\t\t} else {\n\t\t\t\tconst responseMessage = {\n\t\t\t\t\tid: messageId,\n\t\t\t\t\tparentId: currentParentId,\n\t\t\t\t\tchildrenIds: [],\n\t\t\t\t\tdone: true,\n\t\t\t\t\tmodel: model.id,\n\t\t\t\t\tmodelName: model.name ?? model.id,\n\t\t\t\t\tmodelIdx: 0,\n\t\t\t\t\ttimestamp: Math.floor(Date.now() / 1000),\n\t\t\t\t\t...message\n\t\t\t\t};\n\n\t\t\t\tif (parentMessage) {\n\t\t\t\t\tparentMessage.childrenIds.push(messageId);\n\t\t\t\t\thistory.messages[parentMessage.id] = parentMessage;\n\t\t\t\t}\n\n\t\t\t\thistory.messages[messageId] = responseMessage;\n\t\t\t\tparentMessage = responseMessage;\n\t\t\t\tcurrentParentId = messageId;\n\t\t\t}\n\t\t}\n\n\t\thistory.currentId = currentParentId;\n\t\tawait tick();\n\n\t\tif (autoScroll) {\n\t\t\tscrollToBottom();\n\t\t}\n\n\t\tif (messages.length === 0) {\n\t\t\tawait initChatHandler(history);\n\t\t} else {\n\t\t\tawait saveChatHandler($chatId, history);\n\t\t}\n\t};\n\n\tconst submitPrompt = async (userPrompt, { _raw = false } = {}) => {\n\t\tconsole.log('🚀 submitPrompt', userPrompt, $chatId);\n\t\tconsole.log('📋 Current history IDs:', { \n\t\t\tcurrentId: history.currentId, \n\t\t\tmessagesCount: Object.keys(history.messages).length \n\t\t});\n\n\t\tconst messages = createMessagesList(history, history.currentId);\n\t\tif (messages) {\n\t\t\tconsole.log('📋 Last message:', messages.length > 0 ? \n\t\t\t\t{ role: messages[messages.length-1].role, content: messages[messages.length-1].content.slice(0, 50) + '...' } : \n\t\t\t\t'No messages');\n\t\t}\n\n\t\tconst _selectedModels = selectedModels.map((modelId) =>\n\t\t\t$models.map((m) => m.id).includes(modelId) ? modelId : ''\n\t\t);\n\t\tif (JSON.stringify(selectedModels) !== JSON.stringify(_selectedModels)) {\n\t\t\tselectedModels = _selectedModels;\n\t\t}\n\n\t\tif (userPrompt === '' && files.length === 0) {\n\t\t\ttoast.error($i18n.t('Please enter a prompt'));\n\t\t\treturn;\n\t\t}\n\t\tif (selectedModels.includes('')) {\n\t\t\ttoast.error($i18n.t('Model not selected'));\n\t\t\treturn;\n\t\t}\n\n\t\tif (messages.length != 0 && messages.at(-1).done != true) {\n\t\t\t// Response not done\n\t\t\treturn;\n\t\t}\n\t\tif (messages.length != 0 && messages.at(-1).error && !messages.at(-1).content) {\n\t\t\t// Error in response\n\t\t\ttoast.error($i18n.t(`Oops! There was an error in the previous response.`));\n\t\t\treturn;\n\t\t}\n\t\tif (\n\t\t\tfiles.length > 0 &&\n\t\t\tfiles.filter((file) => file.type !== 'image' && file.status === 'uploading').length > 0\n\t\t) {\n\t\t\ttoast.error(\n\t\t\t\t$i18n.t(`Oops! There are files still uploading. Please wait for the upload to complete.`)\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\t\tif (\n\t\t\t($config?.file?.max_count ?? null) !== null &&\n\t\t\tfiles.length + chatFiles.length > $config?.file?.max_count\n\t\t) {\n\t\t\ttoast.error(\n\t\t\t\t$i18n.t(`You can only chat with a maximum of {{maxCount}} file(s) at a time.`, {\n\t\t\t\t\tmaxCount: $config?.file?.max_count\n\t\t\t\t})\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\n\t\tprompt = '';\n\n\t\t// Reset chat input textarea\n\t\tconst chatInputElement = document.getElementById('chat-input');\n\n\t\tif (chatInputElement) {\n\t\t\tawait tick();\n\t\t\tchatInputElement.style.height = '';\n\t\t\tchatInputElement.style.height = Math.min(chatInputElement.scrollHeight, 320) + 'px';\n\t\t}\n\n\t\tconst _files = JSON.parse(JSON.stringify(files));\n\t\tchatFiles.push(..._files.filter((item) => ['doc', 'file', 'collection'].includes(item.type)));\n\t\tchatFiles = chatFiles.filter(\n\t\t\t// Remove duplicates\n\t\t\t(item, index, array) =>\n\t\t\t\tarray.findIndex((i) => JSON.stringify(i) === JSON.stringify(item)) === index\n\t\t);\n\n\t\tfiles = [];\n\t\tprompt = '';\n\n\t\t// Create user message\n\t\tlet userMessageId = uuidv4();\n\t\tlet userMessage = {\n\t\t\tid: userMessageId,\n\t\t\tparentId: messages.length !== 0 ? messages.at(-1).id : null,\n\t\t\tchildrenIds: [],\n\t\t\trole: 'user',\n\t\t\tcontent: userPrompt,\n\t\t\tfiles: _files.length > 0 ? _files : undefined,\n\t\t\ttimestamp: Math.floor(Date.now() / 1000), // Unix epoch\n\t\t\tmodels: selectedModels\n\t\t};\n\n\t\t// Add message to history and Set currentId to messageId\n\t\thistory.messages[userMessageId] = userMessage;\n\t\thistory.currentId = userMessageId;\n\n\t\t// Append messageId to childrenIds of parent message\n\t\tif (messages.length !== 0) {\n\t\t\thistory.messages[messages.at(-1).id].childrenIds.push(userMessageId);\n\t\t}\n\n\t\t// focus on chat input\n\t\tconst chatInput = document.getElementById('chat-input');\n\t\tchatInput?.focus();\n\n\t\tsaveSessionSelectedModels();\n\n\t\tawait sendPrompt(history, userPrompt, userMessageId, { newChat: true });\n\t};\n\n\tconst sendPromptSocket = async (_history, model, responseMessageId, _chatId) => {\n\t\tconsole.log('🔌 sendPromptSocket:', { modelId: model.id, responseMessageId, chatId: _chatId });\n\t\tconst responseMessage = _history.messages[responseMessageId];\n\t\tconst userMessage = _history.messages[responseMessage.parentId];\n\n\t\tlet files = JSON.parse(JSON.stringify(chatFiles));\n\t\tfiles.push(\n\t\t\t...(userMessage?.files ?? []).filter((item) =>\n\t\t\t\t['doc', 'file', 'collection'].includes(item.type)\n\t\t\t),\n\t\t\t...(responseMessage?.files ?? []).filter((item) => ['web_search_results'].includes(item.type))\n\t\t);\n\t\t// Remove duplicates\n\t\tfiles = files.filter(\n\t\t\t(item, index, array) =>\n\t\t\t\tarray.findIndex((i) => JSON.stringify(i) === JSON.stringify(item)) === index\n\t\t);\n\n\t\tscrollToBottom();\n\t\teventTarget.dispatchEvent(\n\t\t\tnew CustomEvent('chat:start', {\n\t\t\t\tdetail: {\n\t\t\t\t\tid: responseMessageId\n\t\t\t\t}\n\t\t\t})\n\t\t);\n\t\tawait tick();\n\n\t\t// Get user location if needed\n\t\tconst getUserLocation = async () => {\n\t\t\tif ($settings?.userLocation) {\n\t\t\t\ttry {\n\t\t\t\t\treturn await getAndUpdateUserLocation(localStorage.token);\n\t\t\t\t} catch (err) {\n\t\t\t\t\tconsole.error(err);\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn undefined;\n\t\t};\n\t\t\n\t\t// Get the user location\n\t\tconst userLocation = await getUserLocation();\n\t\t\n\t\t// Log the API key for debugging\n\t\tconsole.log(\"Sending userAPIKey to backend:\", $userAPIKey ? \"Present\" : \"Empty/None\");\n\n\t\t// Set the response message content to processing message (if we have a nice settings)\n\t\tresponseMessage.content = ''\n\t\tif ($settings?.processingMessage ?? false) {\n\t\t\tresponseMessage.content = $settings.processingMessage === true ? '...' : $settings.processingMessage;\n\t\t}\n\n\t\tconst stream =\n\t\t\tmodel?.info?.params?.stream_response ??\n\t\t\t$settings?.params?.stream_response ??\n\t\t\tparams?.stream_response ??\n\t\t\ttrue;\n\n\t\tlet messages = [\n\t\t\tparams?.system || $settings.system || (responseMessage?.userContext ?? null)\n\t\t\t\t? {\n\t\t\t\t\t\trole: 'system',\n\t\t\t\t\t\tcontent: `${promptTemplate(\n\t\t\t\t\t\t\tparams?.system ?? $settings?.system ?? '',\n\t\t\t\t\t\t\t$user.name,\n\t\t\t\t\t\t\tuserLocation,\n\t\t\t\t\t\t\t$userAPIKey\n\t\t\t\t\t\t)}${\n\t\t\t\t\t\t\t(responseMessage?.userContext ?? null)\n\t\t\t\t\t\t\t\t? `\\n\\nUser Context:\\n${responseMessage?.userContext ?? ''}`\n\t\t\t\t\t\t\t\t: ''\n\t\t\t\t\t\t}`\n\t\t\t\t\t}\n\t\t\t\t: undefined,\n\t\t\t...createMessagesList(_history, responseMessageId).map((message) => ({\n\t\t\t\t...message,\n\t\t\t\tcontent: removeDetails(message.content, ['reasoning', 'code_interpreter'])\n\t\t\t}))\n\t\t].filter(Boolean);\n\n\t\tmessages = messages\n\t\t\t.map((message, idx, arr) => ({\n\t\t\t\trole: message.role,\n\t\t\t\t...((message.files?.filter((file) => file.type === 'image').length > 0 ?? false) &&\n\t\t\t\tmessage.role === 'user'\n\t\t\t\t\t? {\n\t\t\t\t\t\t\tcontent: [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttype: 'text',\n\t\t\t\t\t\t\t\t\ttext: message?.merged?.content ?? message.content\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t...message.files\n\t\t\t\t\t\t\t\t\t.filter((file) => file.type === 'image')\n\t\t\t\t\t\t\t\t\t.map((file) => ({\n\t\t\t\t\t\t\t\t\t\ttype: 'image_url',\n\t\t\t\t\t\t\t\t\t\timage_url: {\n\t\t\t\t\t\t\t\t\t\t\turl: file.url\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}))\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t: {\n\t\t\t\t\t\t\tcontent: message?.merged?.content ?? message.content\n\t\t\t\t\t\t})\n\t\t\t}))\n\t\t\t.filter((message) => message?.role === 'user' || message?.content?.trim());\n\n\t\tconst res = await generateOpenAIChatCompletion(\n\t\t\tlocalStorage.token,\n\t\t\t{\n\t\t\t\tstream: stream,\n\t\t\t\tmodel: model.id,\n\t\t\t\tmessages: messages,\n\t\t\t\tparams: {\n\t\t\t\t\t...$settings?.params,\n\t\t\t\t\t...params,\n\n\t\t\t\t\tformat: $settings.requestFormat ?? undefined,\n\t\t\t\t\tkeep_alive: $settings.keepAlive ?? undefined,\n\t\t\t\t\tstop:\n\t\t\t\t\t\t(params?.stop ?? $settings?.params?.stop ?? undefined)\n\t\t\t\t\t\t\t? (params?.stop.split(',').map((token) => token.trim()) ?? $settings.params.stop).map(\n\t\t\t\t\t\t\t\t\t(str) => decodeURIComponent(JSON.parse('\"' + str.replace(/\\\"/g, '\\\\\"') + '\"'))\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t: undefined\n\t\t\t\t},\n\n\t\t\t\tfiles: (files?.length ?? 0) > 0 ? files : undefined,\n\t\t\t\ttool_ids: selectedToolIds.length > 0 ? selectedToolIds : undefined,\n\n\t\t\t\tfeatures: {\n\t\t\t\t\timage_generation:\n\t\t\t\t\t\t$config?.features?.enable_image_generation &&\n\t\t\t\t\t\t($user.role === 'admin' || $user?.permissions?.features?.image_generation)\n\t\t\t\t\t\t\t? imageGenerationEnabled\n\t\t\t\t\t\t\t: false,\n\t\t\t\t\tcode_interpreter:\n\t\t\t\t\t\t$config?.features?.enable_code_interpreter &&\n\t\t\t\t\t\t($user.role === 'admin' || $user?.permissions?.features?.code_interpreter)\n\t\t\t\t\t\t\t? codeInterpreterEnabled\n\t\t\t\t\t\t\t: false,\n\t\t\t\t\tweb_search:\n\t\t\t\t\t\t$config?.features?.enable_web_search &&\n\t\t\t\t\t\t($user.role === 'admin' || $user?.permissions?.features?.web_search)\n\t\t\t\t\t\t\t? webSearchEnabled || ($settings?.webSearch ?? false) === 'always'\n\t\t\t\t\t\t\t: false\n\t\t\t\t},\n\t\t\t\tvariables: (() => {\n\t\t\t\t\tconsole.log(\"Sending userAPIKey to backend:\", $userAPIKey ? \"Present\" : \"Empty/None\");\n\t\t\t\t\t// Create variables without using await\n\t\t\t\t\tconst promptVars = getPromptVariables(\n\t\t\t\t\t\t$user.name,\n\t\t\t\t\t\tuserLocation,\n\t\t\t\t\t\t$userAPIKey\n\t\t\t\t\t);\n\t\t\t\t\treturn promptVars;\n\t\t\t\t})(),\n\t\t\t\tmodel_item: $models.find((m) => m.id === model.id),\n\n\t\t\t\tsession_id: $socket?.id,\n\t\t\t\tchat_id: _chatId,\n\t\t\t\tid: responseMessageId,\n\n\t\t\t\t...(!$temporaryChatEnabled &&\n\t\t\t\t(messages.length == 1 ||\n\t\t\t\t\t(messages.length == 2 &&\n\t\t\t\t\t\tmessages.at(0)?.role === 'system' &&\n\t\t\t\t\t\tmessages.at(1)?.role === 'user')) &&\n\t\t\t\t(selectedModels[0] === model.id || atSelectedModel !== undefined)\n\t\t\t\t\t? {\n\t\t\t\t\t\t\tbackground_tasks: {\n\t\t\t\t\t\t\t\ttitle_generation: $settings?.title?.auto ?? true,\n\t\t\t\t\t\t\t\ttags_generation: $settings?.autoTags ?? true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t: {}),\n\n\t\t\t\t...(stream && (model.info?.meta?.capabilities?.usage ?? false)\n\t\t\t\t\t? {\n\t\t\t\t\t\t\tstream_options: {\n\t\t\t\t\t\t\t\tinclude_usage: true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t: {})\n\t\t\t},\n\t\t\t`${WEBUI_BASE_URL}/api`\n\t\t).catch((error) => {\n\t\t\ttoast.error(`${error}`);\n\n\t\t\tresponseMessage.error = {\n\t\t\t\tcontent: error\n\t\t\t};\n\t\t\tresponseMessage.done = true;\n\n\t\t\thistory.messages[responseMessageId] = responseMessage;\n\t\t\thistory.currentId = responseMessageId;\n\t\t\treturn null;\n\t\t});\n\n\t\tconsole.log(res);\n\n\t\tif (res) {\n\t\t\ttaskId = res.task_id;\n\t\t}\n\n\t\tawait tick();\n\t\tscrollToBottom();\n\t};\n\n\t// Send prompt to backend and handle the response\n\tconst sendPrompt = async (_history, userPrompt, userMessageId, options = {}) => {\n\t\tconst { modelId, modelIdx = 0, newChat = false } = options;\n\t\tlet _chatId = $chatId;\n\t\t\n\t\tif (newChat && !$temporaryChatEnabled && !_chatId) {\n\t\t\tconsole.log('🆕 Creating new chat for prompt');\n\t\t\ttry {\n\t\t\t\tchat = await createNewChat(localStorage.token, {\n\t\t\t\t\tid: _chatId,\n\t\t\t\t\ttitle: $i18n.t('New Chat'),\n\t\t\t\t\tmodels: selectedModels,\n\t\t\t\t\tsystem: $settings.system ?? undefined,\n\t\t\t\t\tparams: params,\n\t\t\t\t\thistory: history,\n\t\t\t\t\tmessages: createMessagesList(history, history.currentId),\n\t\t\t\t\ttags: [],\n\t\t\t\t\ttimestamp: Date.now()\n\t\t\t\t});\n\n\t\t\t\t_chatId = chat.id;\n\t\t\t\tawait chatId.set(_chatId);\n\n\t\t\t\tawait chats.set(await getChatList(localStorage.token, $currentChatPage));\n\t\t\t\tcurrentChatPage.set(1);\n\n\t\t\t\t// Use $app/navigation instead of window.history.replaceState\n\t\t\t\ttry {\n\t\t\t\t\twindow.history.pushState({}, '', `/c/${_chatId}`);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error('❌ Error updating URL:', e);\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\tconsole.error('❌ Error creating chat:', e);\n\t\t\t\t_chatId = null;\n\t\t\t}\n\t\t}\n\t\t\n\t\tconst messages = createMessagesList(_history, userMessageId);\n\t\tconst userMessage = messages.at(-1);\n\n\t\t// Create response message\n\t\tconst responseMessageId = uuidv4();\n\t\tlet model;\n\t\t\n\t\tif (modelId) {\n\t\t\tmodel = $models.find((m) => m.id === modelId);\n\t\t} else {\n\t\t\t// If user message has models defined, use the first one\n\t\t\tconst userModelId = (userMessage?.models ?? selectedModels)[0];\n\t\t\tmodel = $models.find((m) => m.id === userModelId);\n\t\t}\n\n\t\tif (!model) {\n\t\t\ttoast.error($i18n.t('Model not selected'));\n\t\t\treturn;\n\t\t}\n\n\t\t// Special handling for accounting_en model which uses our agent API\n\t\tconst isAgentModel = model.id === 'accounting_en' || model.id.includes('accounting');\n\t\tconsole.log(`🏷️ Model ${model.id} is agent model: ${isAgentModel}`);\n\n\t\t// Create loading message with animation text for agent models\n\t\tconst agentLoadingText = isAgentModel ? $i18n.t('Agent is helping...') : '';\n\t\t\n\t\tconst responseMessage = {\n\t\t\tid: responseMessageId,\n\t\t\tparentId: userMessageId,\n\t\t\tchildrenIds: [],\n\t\t\trole: 'assistant',\n\t\t\tcontent: agentLoadingText,\n\t\t\tmodel: model.id,\n\t\t\tmodelName: model?.name ?? model.id,\n\t\t\tmodelIdx: modelIdx,\n\t\t\ttimestamp: Math.floor(Date.now() / 1000),\n\t\t\t// Flag to indicate this is an agent response\n\t\t\tisAgentResponse: isAgentModel,\n\t\t\t// Add loading indicator for agents\n\t\t\tisLoading: isAgentModel\n\t\t};\n\n\t\t// Add message to history and Set currentId to responseMessageId\n\t\t_history.messages[responseMessageId] = responseMessage;\n\t\t_history.currentId = responseMessageId;\n\t\t_history.messages[userMessageId].childrenIds.push(responseMessageId);\n\n\t\tawait tick();\n\t\t\n\t\tif (autoScroll) {\n\t\t\tscrollToBottom();\n\t\t}\n\n\t\t// If this is an agent model, start the typing animation\n\t\tif (isAgentModel) {\n\t\t\tstartAgentAnimation(responseMessageId);\n\t\t}\n\n\t\t// Send to backend via socket\n\t\tawait sendPromptSocket(_history, model, responseMessageId, _chatId);\n\t\t\n\t\treturn responseMessageId;\n\t};\n\n\t// Animation for agent loading message\n\tconst startAgentAnimation = async (messageId) => {\n\t\tconst loadingTexts = [\n\t\t\t$i18n.t(\"Agent is helping...\"),\n\t\t\t$i18n.t(\"Agent is processing your request...\"),\n\t\t\t$i18n.t(\"Agent is working on it...\"),\n\t\t\t$i18n.t(\"Agent is analyzing...\")\n\t\t];\n\t\tlet textIndex = 0;\n\t\tlet dotCount = 0;\n\t\t\n\t\tconst animateText = () => {\n\t\t\tconst message = history.messages[messageId];\n\t\t\t// Stop animation if message is no longer loading or has content\n\t\t\tif (!message || !message.isLoading || (message.content && message.content.length > 30)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t\n\t\t\tconst baseText = loadingTexts[textIndex];\n\t\t\tconst dots = \".\".repeat(dotCount % 4);\n\t\t\thistory.messages[messageId].content = baseText + dots;\n\t\t\t\n\t\t\t// Force update in history object to ensure UI updates\n\t\t\thistory = { ...history };\n\t\t\t\n\t\t\t// Increment counters\n\t\t\tdotCount++;\n\t\t\tif (dotCount % 12 === 0) {\n\t\t\t\ttextIndex = (textIndex + 1) % loadingTexts.length;\n\t\t\t}\n\t\t\t\n\t\t\t// Continue animation\n\t\t\tsetTimeout(animateText, 400);\n\t\t};\n\t\t\n\t\tanimateText();\n\t};\n\n\tconst handleOpenAIError = async (error, responseMessage) => {\n\t\tlet errorMessage = '';\n\t\tlet innerError;\n\n\t\tif (error) {\n\t\t\tinnerError = error;\n\t\t}\n\n\t\tconsole.error(innerError);\n\t\tif ('detail' in innerError) {\n\t\t\ttoast.error(innerError.detail);\n\t\t\terrorMessage = innerError.detail;\n\t\t} else if ('error' in innerError) {\n\t\t\tif ('message' in innerError.error) {\n\t\t\t\ttoast.error(innerError.error.message);\n\t\t\t\terrorMessage = innerError.error.message;\n\t\t\t} else {\n\t\t\t\ttoast.error(innerError.error);\n\t\t\t\terrorMessage = innerError.error;\n\t\t\t}\n\t\t} else if ('message' in innerError) {\n\t\t\ttoast.error(innerError.message);\n\t\t\terrorMessage = innerError.message;\n\t\t}\n\n\t\tresponseMessage.error = {\n\t\t\tcontent: $i18n.t(`Uh-oh! There was an issue with the response.`) + '\\n' + errorMessage\n\t\t};\n\t\tresponseMessage.done = true;\n\n\t\tif (responseMessage.statusHistory) {\n\t\t\tresponseMessage.statusHistory = responseMessage.statusHistory.filter(\n\t\t\t\t(status) => status.action !== 'knowledge_search'\n\t\t\t);\n\t\t}\n\n\t\thistory.messages[responseMessage.id] = responseMessage;\n\t};\n\n\tconst stopResponse = () => {\n\t\tif (taskId) {\n\t\t\tconst res = stopTask(localStorage.token, taskId).catch((error) => {\n\t\t\t\treturn null;\n\t\t\t});\n\n\t\t\tif (res) {\n\t\t\t\ttaskId = null;\n\n\t\t\t\tconst responseMessage = history.messages[history.currentId];\n\t\t\t\tresponseMessage.done = true;\n\n\t\t\t\thistory.messages[history.currentId] = responseMessage;\n\n\t\t\t\tif (autoScroll) {\n\t\t\t\t\tscrollToBottom();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\tconst submitMessage = async (parentId, prompt) => {\n\t\tlet userPrompt = prompt;\n\t\tlet userMessageId = uuidv4();\n\n\t\tlet userMessage = {\n\t\t\tid: userMessageId,\n\t\t\tparentId: parentId,\n\t\t\tchildrenIds: [],\n\t\t\trole: 'user',\n\t\t\tcontent: userPrompt,\n\t\t\tmodels: selectedModels\n\t\t};\n\n\t\tif (parentId !== null) {\n\t\t\thistory.messages[parentId].childrenIds = [\n\t\t\t\t...history.messages[parentId].childrenIds,\n\t\t\t\tuserMessageId\n\t\t\t];\n\t\t}\n\n\t\thistory.messages[userMessageId] = userMessage;\n\t\thistory.currentId = userMessageId;\n\n\t\tawait tick();\n\t\tawait sendPrompt(history, userPrompt, userMessageId);\n\t};\n\n\tconst regenerateResponse = async (message) => {\n\t\tconsole.log('regenerateResponse');\n\n\t\tif (history.currentId) {\n\t\t\tlet userMessage = history.messages[message.parentId];\n\t\t\tlet userPrompt = userMessage.content;\n\n\t\t\tif ((userMessage?.models ?? [...selectedModels]).length == 1) {\n\t\t\t\t// If user message has only one model selected, sendPrompt automatically selects it for regeneration\n\t\t\t\tawait sendPrompt(history, userPrompt, userMessage.id);\n\t\t\t} else {\n\t\t\t\t// If there are multiple models selected, use the model of the response message for regeneration\n\t\t\t\t// e.g. many model chat\n\t\t\t\tawait sendPrompt(history, userPrompt, userMessage.id, {\n\t\t\t\t\tmodelId: message.model,\n\t\t\t\t\tmodelIdx: message.modelIdx\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t};\n\n\tconst continueResponse = async () => {\n\t\tconsole.log('continueResponse');\n\t\tconst _chatId = JSON.parse(JSON.stringify($chatId));\n\n\t\tif (history.currentId && history.messages[history.currentId].done == true) {\n\t\t\tconst responseMessage = history.messages[history.currentId];\n\t\t\tresponseMessage.done = false;\n\t\t\tawait tick();\n\n\t\t\tconst model = $models\n\t\t\t\t.filter((m) => m.id === (responseMessage?.selectedModelId ?? responseMessage.model))\n\t\t\t\t.at(0);\n\n\t\t\tif (model) {\n\t\t\t\tawait sendPrompt(history, responseMessage.content, responseMessage.parentId, {\n\t\t\t\t\tmodelId: model.id,\n\t\t\t\t\tmodelIdx: responseMessage.modelIdx\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t};\n\n\tconst mergeResponses = async (messageId, responses, _chatId) => {\n\t\tconsole.log('mergeResponses', messageId, responses);\n\t\tconst message = history.messages[messageId];\n\t\tconst mergedResponse = {\n\t\t\tstatus: true,\n\t\t\tcontent: ''\n\t\t};\n\t\tmessage.merged = mergedResponse;\n\t\thistory.messages[messageId] = message;\n\n\t\ttry {\n\t\t\tconst [res, controller] = await generateMoACompletion(\n\t\t\t\tlocalStorage.token,\n\t\t\t\tmessage.model,\n\t\t\t\thistory.messages[message.parentId].content,\n\t\t\t\tresponses\n\t\t\t);\n\n\t\t\tif (res && res.ok && res.body) {\n\t\t\t\tconst textStream = await createOpenAITextStream(res.body, $settings.splitLargeChunks);\n\t\t\t\tfor await (const update of textStream) {\n\t\t\t\t\tconst { value, done, sources, error, usage } = update;\n\t\t\t\t\tif (error || done) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (mergedResponse.content == '' && value == '\\n') {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmergedResponse.content += value;\n\t\t\t\t\t\thistory.messages[messageId] = message;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (autoScroll) {\n\t\t\t\t\t\tscrollToBottom();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tawait saveChatHandler(_chatId, history);\n\t\t\t} else {\n\t\t\t\tconsole.error(res);\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tconsole.error(e);\n\t\t}\n\t};\n\n\tconst initChatHandler = async (history) => {\n\t\tlet _chatId = $chatId;\n\n\t\tif (!$temporaryChatEnabled) {\n\t\t\tchat = await createNewChat(localStorage.token, {\n\t\t\t\tid: _chatId,\n\t\t\t\ttitle: $i18n.t('New Chat'),\n\t\t\t\tmodels: selectedModels,\n\t\t\t\tsystem: $settings.system ?? undefined,\n\t\t\t\tparams: params,\n\t\t\t\thistory: history,\n\t\t\t\tmessages: createMessagesList(history, history.currentId),\n\t\t\t\ttags: [],\n\t\t\t\ttimestamp: Date.now()\n\t\t\t});\n\n\t\t\t_chatId = chat.id;\n\t\t\tawait chatId.set(_chatId);\n\n\t\t\tawait chats.set(await getChatList(localStorage.token, $currentChatPage));\n\t\t\tcurrentChatPage.set(1);\n\n\t\t\twindow.history.replaceState(history.state, '', `/c/${_chatId}`);\n\t\t} else {\n\t\t\t_chatId = 'local';\n\t\t\tawait chatId.set('local');\n\t\t}\n\t\tawait tick();\n\n\t\treturn _chatId;\n\t};\n\n\tconst saveChatHandler = async (_chatId, history) => {\n\t\tif ($chatId == _chatId) {\n\t\t\tif (!$temporaryChatEnabled) {\n\t\t\t\tchat = await updateChatById(localStorage.token, _chatId, {\n\t\t\t\t\tmodels: selectedModels,\n\t\t\t\t\thistory: history,\n\t\t\t\t\tmessages: createMessagesList(history, history.currentId),\n\t\t\t\t\tparams: params,\n\t\t\t\t\tfiles: chatFiles\n\t\t\t\t});\n\t\t\t\tcurrentChatPage.set(1);\n\t\t\t\tawait chats.set(await getChatList(localStorage.token, $currentChatPage));\n\t\t\t}\n\t\t}\n\t};\n\n\tconst initHistoryWithGreetings = () => {\n\t\tlet messageId = uuidv4();\n\t\tconst locale = localStorage.getItem('locale');\n\t\t\n\t\t// Use shorter messages and check locale directly instead of using i18n\n\t\tconst greeting = locale === 'zh-CN' \n\t\t\t? \"您好！我是您的会计助手。请告诉我您需要分析的财务数据或有什么财务问题。\"\n\t\t\t: \"Hello! I'm your accounting assistant. How can I help with your financial data analysis?\";\n\t\t\t\n\t\thistory.messages[messageId] = {\n\t\t\tid: messageId,\n\t\t\trole: 'assistant',\n\t\t\tcontent: greeting,\n\t\t\tmodel: 'Assistant',\n\t\t\tmodelName: 'Assistant',\n\t\t\tparentId: null,\n\t\t\ttimestamp: Math.floor(Date.now() / 1000),\n\t\t\tchildrenIds: [],\n\t\t\tdone: true\n\t\t};\n\t\thistory.currentId = messageId;\n\t};\n</script>\n\n<svelte:head>\n\t<title>\n\t\t{$chatTitle\n\t\t\t? `${$chatTitle.length > 30 ? `${$chatTitle.slice(0, 30)}...` : $chatTitle} | ${$WEBUI_NAME}`\n\t\t\t: `${$WEBUI_NAME}`}\n\t</title>\n</svelte:head>\n\n<audio id=\"audioElement\" src=\"\" style=\"display: none;\" />\n\n<EventConfirmDialog\n\tbind:show={showEventConfirmation}\n\ttitle={eventConfirmationTitle}\n\tmessage={eventConfirmationMessage}\n\tinput={eventConfirmationInput}\n\tinputPlaceholder={eventConfirmationInputPlaceholder}\n\tinputValue={eventConfirmationInputValue}\n\ton:confirm={(e) => {\n\t\tif (e.detail) {\n\t\t\teventCallback(e.detail);\n\t\t} else {\n\t\t\teventCallback(true);\n\t\t}\n\t}}\n\ton:cancel={() => {\n\t\teventCallback(false);\n\t}}\n/>\n\n<div\n\tclass=\"h-screen max-h-[100dvh] transition-width duration-200 ease-in-out {$showSidebar\n\t\t? '  md:max-w-[calc(100%-260px)]'\n\t\t: ' '} w-full max-w-full flex flex-col\"\n\tid=\"chat-container\"\n>\n\t{#if chatIdProp === '' || (!loading && chatIdProp)}\n\t\t{#if $settings?.backgroundImageUrl ?? null}\n\t\t\t<div\n\t\t\t\tclass=\"absolute {$showSidebar\n\t\t\t\t\t? 'md:max-w-[calc(100%-260px)] md:translate-x-[260px]'\n\t\t\t\t\t: ''} top-0 left-0 w-full h-full bg-cover bg-center bg-no-repeat\"\n\t\t\t\tstyle=\"background-image: url({$settings.backgroundImageUrl})  \"\n\t\t\t/>\n\n\t\t\t<div\n\t\t\t\tclass=\"absolute top-0 left-0 w-full h-full bg-linear-to-t from-white to-white/85 dark:from-gray-900 dark:to-gray-900/90 z-0\"\n\t\t\t/>\n\t\t{/if}\n\n\t\t<Navbar\n\t\t\tbind:this={navbarElement}\n\t\t\tchat={{\n\t\t\t\tid: $chatId,\n\t\t\t\tchat: {\n\t\t\t\t\ttitle: $chatTitle,\n\t\t\t\t\tmodels: selectedModels,\n\t\t\t\t\tsystem: $settings.system ?? undefined,\n\t\t\t\t\tparams: params,\n\t\t\t\t\thistory: history,\n\t\t\t\t\ttimestamp: Date.now()\n\t\t\t\t}\n\t\t\t}}\n\t\t\ttitle={$chatTitle}\n\t\t\tbind:selectedModels\n\t\t\tshareEnabled={!!history.currentId}\n\t\t\t{initNewChat}\n\t\t/>\n\n\t\t<PaneGroup direction=\"horizontal\" class=\"w-full h-full\">\n\t\t\t<Pane defaultSize={50} class=\"h-full flex w-full relative\">\n\t\t\t\t{#if $banners.length > 0 && !history.currentId && !$chatId && selectedModels.length <= 1}\n\t\t\t\t\t<div class=\"absolute top-12 left-0 right-0 w-full z-30\">\n\t\t\t\t\t\t<div class=\" flex flex-col gap-1 w-full\">\n\t\t\t\t\t\t\t{#each $banners.filter( (b) => (b.dismissible ? !JSON.parse(localStorage.getItem('dismissedBannerIds') ?? '[]').includes(b.id) : true) ) as banner}\n\t\t\t\t\t\t\t\t<Banner\n\t\t\t\t\t\t\t\t\t{banner}\n\t\t\t\t\t\t\t\t\ton:dismiss={(e) => {\n\t\t\t\t\t\t\t\t\t\tconst bannerId = e.detail;\n\n\t\t\t\t\t\t\t\t\t\tlocalStorage.setItem(\n\t\t\t\t\t\t\t\t\t\t\t'dismissedBannerIds',\n\t\t\t\t\t\t\t\t\t\t\tJSON.stringify(\n\t\t\t\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\t\t\t\tbannerId,\n\t\t\t\t\t\t\t\t\t\t\t\t\t...JSON.parse(localStorage.getItem('dismissedBannerIds') ?? '[]')\n\t\t\t\t\t\t\t\t\t\t\t\t].filter((id) => $banners.find((b) => b.id === id))\n\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t{/if}\n\n\t\t\t\t<div class=\"flex flex-col flex-auto z-10 w-full @container\">\n\t\t\t\t\t{#if $settings?.landingPageMode === 'chat' || createMessagesList(history, history.currentId).length > 0 || true}\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclass=\" pb-2.5 flex flex-col justify-between w-full flex-auto overflow-auto h-0 max-w-full z-10 scrollbar-hidden\"\n\t\t\t\t\t\t\tid=\"messages-container\"\n\t\t\t\t\t\t\tbind:this={messagesContainerElement}\n\t\t\t\t\t\t\ton:scroll={(e) => {\n\t\t\t\t\t\t\t\tautoScroll =\n\t\t\t\t\t\t\t\t\tmessagesContainerElement.scrollHeight - messagesContainerElement.scrollTop <=\n\t\t\t\t\t\t\t\t\tmessagesContainerElement.clientHeight + 5;\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div class=\" h-full w-full flex flex-col\">\n\t\t\t\t\t\t\t\t<Messages\n\t\t\t\t\t\t\t\t\tchatId={$chatId}\n\t\t\t\t\t\t\t\t\tbind:history\n\t\t\t\t\t\t\t\t\tbind:autoScroll\n\t\t\t\t\t\t\t\t\tbind:prompt\n\t\t\t\t\t\t\t\t\t{selectedModels}\n\t\t\t\t\t\t\t\t\t{atSelectedModel}\n\t\t\t\t\t\t\t\t\t{sendPrompt}\n\t\t\t\t\t\t\t\t\t{showMessage}\n\t\t\t\t\t\t\t\t\t{submitMessage}\n\t\t\t\t\t\t\t\t\t{continueResponse}\n\t\t\t\t\t\t\t\t\t{regenerateResponse}\n\t\t\t\t\t\t\t\t\t{mergeResponses}\n\t\t\t\t\t\t\t\t\t{chatActionHandler}\n\t\t\t\t\t\t\t\t\t{addMessages}\n\t\t\t\t\t\t\t\t\tbottomPadding={files.length > 0}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class=\" pb-[1rem]\">\n\t\t\t\t\t\t\t<MessageInput\n\t\t\t\t\t\t\t\t{history}\n\t\t\t\t\t\t\t\t{selectedModels}\n\t\t\t\t\t\t\t\tbind:files\n\t\t\t\t\t\t\t\tbind:prompt\n\t\t\t\t\t\t\t\tbind:autoScroll\n\t\t\t\t\t\t\t\tbind:selectedToolIds\n\t\t\t\t\t\t\t\tbind:imageGenerationEnabled\n\t\t\t\t\t\t\t\tbind:codeInterpreterEnabled\n\t\t\t\t\t\t\t\tbind:webSearchEnabled\n\t\t\t\t\t\t\t\tbind:atSelectedModel\n\t\t\t\t\t\t\t\ttransparentBackground={$settings?.backgroundImageUrl ?? false}\n\t\t\t\t\t\t\t\t{stopResponse}\n\t\t\t\t\t\t\t\t{createMessagePair}\n\t\t\t\t\t\t\t\tonChange={(input) => {\n\t\t\t\t\t\t\t\t\tif (input.prompt) {\n\t\t\t\t\t\t\t\t\t\tlocalStorage.setItem(`chat-input-${$chatId}`, JSON.stringify(input));\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tlocalStorage.removeItem(`chat-input-${$chatId}`);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\ton:upload={async (e) => {\n\t\t\t\t\t\t\t\t\tconst { type, data } = e.detail;\n\n\t\t\t\t\t\t\t\t\tif (type === 'web') {\n\t\t\t\t\t\t\t\t\t\tawait uploadWeb(data);\n\t\t\t\t\t\t\t\t\t} else if (type === 'youtube') {\n\t\t\t\t\t\t\t\t\t\tawait uploadYoutubeTranscription(data);\n\t\t\t\t\t\t\t\t\t} else if (type === 'google-drive') {\n\t\t\t\t\t\t\t\t\t\tawait uploadGoogleDriveFile(data);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\ton:submit={async (e) => {\n\t\t\t\t\t\t\t\t\tif (e.detail || files.length > 0) {\n\t\t\t\t\t\t\t\t\t\tawait tick();\n\t\t\t\t\t\t\t\t\t\tsubmitPrompt(\n\t\t\t\t\t\t\t\t\t\t\t($settings?.richTextInput ?? true)\n\t\t\t\t\t\t\t\t\t\t\t\t? e.detail.replaceAll('\\n\\n', '\\n')\n\t\t\t\t\t\t\t\t\t\t\t\t: e.detail\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\"absolute bottom-1 text-xs text-gray-500 text-center line-clamp-1 right-0 left-0\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<!-- {$i18n.t('LLMs can make mistakes. Verify important information.')} -->\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{:else}\n\t\t\t\t\t\t<div class=\"overflow-auto w-full h-full flex items-center\">\n\t\t\t\t\t\t\t<Placeholder\n\t\t\t\t\t\t\t\t{history}\n\t\t\t\t\t\t\t\t{selectedModels}\n\t\t\t\t\t\t\t\tbind:files\n\t\t\t\t\t\t\t\tbind:prompt\n\t\t\t\t\t\t\t\tbind:autoScroll\n\t\t\t\t\t\t\t\tbind:selectedToolIds\n\t\t\t\t\t\t\t\tbind:imageGenerationEnabled\n\t\t\t\t\t\t\t\tbind:codeInterpreterEnabled\n\t\t\t\t\t\t\t\tbind:webSearchEnabled\n\t\t\t\t\t\t\t\tbind:atSelectedModel\n\t\t\t\t\t\t\t\ttransparentBackground={$settings?.backgroundImageUrl ?? false}\n\t\t\t\t\t\t\t\t{stopResponse}\n\t\t\t\t\t\t\t\t{createMessagePair}\n\t\t\t\t\t\t\t\ton:upload={async (e) => {\n\t\t\t\t\t\t\t\t\tconst { type, data } = e.detail;\n\n\t\t\t\t\t\t\t\t\tif (type === 'web') {\n\t\t\t\t\t\t\t\t\t\tawait uploadWeb(data);\n\t\t\t\t\t\t\t\t\t} else if (type === 'youtube') {\n\t\t\t\t\t\t\t\t\t\tawait uploadYoutubeTranscription(data);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\ton:submit={async (e) => {\n\t\t\t\t\t\t\t\t\tif (e.detail || files.length > 0) {\n\t\t\t\t\t\t\t\t\t\tawait tick();\n\t\t\t\t\t\t\t\t\t\tsubmitPrompt(\n\t\t\t\t\t\t\t\t\t\t\t($settings?.richTextInput ?? true)\n\t\t\t\t\t\t\t\t\t\t\t\t? e.detail.replaceAll('\\n\\n', '\\n')\n\t\t\t\t\t\t\t\t\t\t\t\t: e.detail\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\t\t\t</Pane>\n\n\t\t\t<ChatControls\n\t\t\t\tbind:this={controlPaneComponent}\n\t\t\t\tbind:history\n\t\t\t\tbind:chatFiles\n\t\t\t\tbind:params\n\t\t\t\tbind:files\n\t\t\t\tbind:pane={controlPane}\n\t\t\t\tchatId={$chatId}\n\t\t\t\tmodelId={selectedModelIds?.at(0) ?? null}\n\t\t\t\tmodels={selectedModelIds.reduce((a, e, i, arr) => {\n\t\t\t\t\tconst model = $models.find((m) => m.id === e);\n\t\t\t\t\tif (model) {\n\t\t\t\t\t\treturn [...a, model];\n\t\t\t\t\t}\n\t\t\t\t\treturn a;\n\t\t\t\t}, [])}\n\t\t\t\t{submitPrompt}\n\t\t\t\t{stopResponse}\n\t\t\t\t{showMessage}\n\t\t\t\t{eventTarget}\n\t\t\t/>\n\t\t</PaneGroup>\n\t{:else if loading}\n\t\t<div class=\" flex items-center justify-center h-full w-full\">\n\t\t\t<div class=\"m-auto\">\n\t\t\t\t<Spinner />\n\t\t\t</div>\n\t\t</div>\n\t{/if}\n</div>\n","<script lang=\"ts\">\n\timport { getContext } from 'svelte';\n\timport Modal from '../common/Modal.svelte';\n\n\tconst i18n = getContext('i18n');\n\n\texport let show = false;\n</script>\n\n<Modal bind:show>\n\t<div class=\"text-gray-700 dark:text-gray-100\">\n\t\t<div class=\" flex justify-between dark:text-gray-300 px-5 pt-4\">\n\t\t\t<div class=\" text-lg font-medium self-center\">{$i18n.t('Keyboard shortcuts')}</div>\n\t\t\t<button\n\t\t\t\tclass=\"self-center\"\n\t\t\t\ton:click={() => {\n\t\t\t\t\tshow = false;\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<svg\n\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\tviewBox=\"0 0 20 20\"\n\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\tclass=\"w-5 h-5\"\n\t\t\t\t>\n\t\t\t\t\t<path\n\t\t\t\t\t\td=\"M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z\"\n\t\t\t\t\t/>\n\t\t\t\t</svg>\n\t\t\t</button>\n\t\t</div>\n\n\t\t<div class=\"flex flex-col md:flex-row w-full p-5 md:space-x-4 dark:text-gray-200\">\n\t\t\t<div class=\" flex flex-col w-full sm:flex-row sm:justify-center sm:space-x-6\">\n\t\t\t\t<div class=\"flex flex-col space-y-3 w-full self-start\">\n\t\t\t\t\t<div class=\"w-full flex justify-between items-center\">\n\t\t\t\t\t\t<div class=\" text-sm\">{$i18n.t('Open new chat')}</div>\n\n\t\t\t\t\t\t<div class=\"flex space-x-1 text-xs\">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\" h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tCtrl/⌘\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\" h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tShift\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\" h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tO\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"w-full flex justify-between items-center\">\n\t\t\t\t\t\t<div class=\" text-sm\">{$i18n.t('Focus chat input')}</div>\n\n\t\t\t\t\t\t<div class=\"flex space-x-1 text-xs\">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\" h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tShift\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\" h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tEsc\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"w-full flex justify-between items-center\">\n\t\t\t\t\t\t<div class=\" text-sm\">{$i18n.t('Copy last code block')}</div>\n\n\t\t\t\t\t\t<div class=\"flex space-x-1 text-xs\">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\" h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tCtrl/⌘\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\" h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tShift\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\" h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t;\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"w-full flex justify-between items-center\">\n\t\t\t\t\t\t<div class=\" text-sm\">{$i18n.t('Copy last response')}</div>\n\n\t\t\t\t\t\t<div class=\"flex space-x-1 text-xs\">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\" h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tCtrl/⌘\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\" h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tShift\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\" h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tC\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"w-full flex justify-between items-center\">\n\t\t\t\t\t\t<div class=\" text-sm\">{$i18n.t('Generate prompt pair')}</div>\n\n\t\t\t\t\t\t<div class=\"flex space-x-1 text-xs\">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\" h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tCtrl/⌘\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\" h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tShift\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\" h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tEnter\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"flex flex-col space-y-3 w-full self-start\">\n\t\t\t\t\t<div class=\"w-full flex justify-between items-center\">\n\t\t\t\t\t\t<div class=\" text-sm\">{$i18n.t('Toggle settings')}</div>\n\n\t\t\t\t\t\t<div class=\"flex space-x-1 text-xs\">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\" h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tCtrl/⌘\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\" h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t.\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"w-full flex justify-between items-center\">\n\t\t\t\t\t\t<div class=\" text-sm\">{$i18n.t('Toggle sidebar')}</div>\n\n\t\t\t\t\t\t<div class=\"flex space-x-1 text-xs\">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\" h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tCtrl/⌘\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\" h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tShift\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\" h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tS\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"w-full flex justify-between items-center\">\n\t\t\t\t\t\t<div class=\" text-sm\">{$i18n.t('Delete chat')}</div>\n\n\t\t\t\t\t\t<div class=\"flex space-x-1 text-xs\">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\" h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tCtrl/⌘\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\" h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tShift\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\" h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t⌫/Delete\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"w-full flex justify-between items-center\">\n\t\t\t\t\t\t<div class=\" text-sm\">{$i18n.t('Show shortcuts')}</div>\n\n\t\t\t\t\t\t<div class=\"flex space-x-1 text-xs\">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\" h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tCtrl/⌘\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\" h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t/\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class=\" flex justify-between dark:text-gray-300 px-5\">\n\t\t\t<div class=\" text-lg font-medium self-center\">{$i18n.t('Input commands')}</div>\n\t\t</div>\n\n\t\t<div class=\"flex flex-col md:flex-row w-full p-5 md:space-x-4 dark:text-gray-200\">\n\t\t\t<div class=\" flex flex-col w-full sm:flex-row sm:justify-center sm:space-x-6\">\n\t\t\t\t<div class=\"flex flex-col space-y-3 w-full self-start\">\n\t\t\t\t\t<div class=\"w-full flex justify-between items-center\">\n\t\t\t\t\t\t<div class=\" text-sm\">\n\t\t\t\t\t\t\t{$i18n.t('Attach file from knowledge')}\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class=\"flex space-x-1 text-xs\">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\" h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t#\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"w-full flex justify-between items-center\">\n\t\t\t\t\t\t<div class=\" text-sm\">\n\t\t\t\t\t\t\t{$i18n.t('Add custom prompt')}\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class=\"flex space-x-1 text-xs\">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\" h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t/\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"w-full flex justify-between items-center\">\n\t\t\t\t\t\t<div class=\" text-sm\">\n\t\t\t\t\t\t\t{$i18n.t('Talk to model')}\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class=\"flex space-x-1 text-xs\">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\" h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t@\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"w-full flex justify-between items-center\">\n\t\t\t\t\t\t<div class=\" text-sm\">\n\t\t\t\t\t\t\t{$i18n.t('Accept autocomplete generation / Jump to prompt variable')}\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class=\"flex space-x-1 text-xs\">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\" h-fit py-1 px-2 flex items-center justify-center rounded-sm border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tTAB\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</Modal>\n\n<style>\n\tinput::-webkit-outer-spin-button,\n\tinput::-webkit-inner-spin-button {\n\t\t/* display: none; <- Crashes Chrome on hover */\n\t\t-webkit-appearance: none;\n\t\tmargin: 0; /* <-- Apparently some margin are still there even though it's hidden */\n\t}\n\n\t.tabs::-webkit-scrollbar {\n\t\tdisplay: none; /* for Chrome, Safari and Opera */\n\t}\n\n\t.tabs {\n\t\t-ms-overflow-style: none; /* IE and Edge */\n\t\tscrollbar-width: none; /* Firefox */\n\t}\n\n\tinput[type='number'] {\n\t\t-moz-appearance: textfield; /* Firefox */\n\t}\n</style>\n","<script lang=\"ts\">\n\texport let className = 'w-4 h-4';\n\texport let strokeWidth = '2';\n</script>\n\n<svg\n\txmlns=\"http://www.w3.org/2000/svg\"\n\tfill=\"none\"\n\tviewBox=\"0 0 24 24\"\n\tstroke-width={strokeWidth}\n\tstroke=\"currentColor\"\n\tclass={className}\n>\n\t<path\n\t\tstroke-linecap=\"round\"\n\t\tstroke-linejoin=\"round\"\n\t\td=\"M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 5.25h.008v.008H12v-.008Z\"\n\t/>\n</svg>\n","<script lang=\"ts\">\n\texport let className = 'size-4';\n\texport let strokeWidth = '2';\n</script>\n\n<svg\n\taria-hidden=\"true\"\n\txmlns=\"http://www.w3.org/2000/svg\"\n\tfill=\"currentColor\"\n\tviewBox=\"0 0 24 24\"\n\tstroke-width={strokeWidth}\n\tclass={className}\n>\n\t<path\n\t\tfill-rule=\"evenodd\"\n\t\td=\"M2 7a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V7Zm5.01 1H5v2.01h2.01V8Zm3 0H8v2.01h2.01V8Zm3 0H11v2.01h2.01V8Zm3 0H14v2.01h2.01V8Zm3 0H17v2.01h2.01V8Zm-12 3H5v2.01h2.01V11Zm3 0H8v2.01h2.01V11Zm3 0H11v2.01h2.01V11Zm3 0H14v2.01h2.01V11Zm3 0H17v2.01h2.01V11Zm-12 3H5v2.01h2.01V14ZM8 14l-.001 2 8.011.01V14H8Zm11.01 0H17v2.01h2.01V14Z\"\n\t\tclip-rule=\"evenodd\"\n\t/>\n</svg>\n","<script lang=\"ts\">\n\timport { DropdownMenu } from 'bits-ui';\n\timport { getContext } from 'svelte';\n\n\timport { showSettings } from '$lib/stores';\n\timport { flyAndScale } from '$lib/utils/transitions';\n\n\timport Dropdown from '$lib/components/common/Dropdown.svelte';\n\timport QuestionMarkCircle from '$lib/components/icons/QuestionMarkCircle.svelte';\n\timport Lifebuoy from '$lib/components/icons/Lifebuoy.svelte';\n\timport Keyboard from '$lib/components/icons/Keyboard.svelte';\n\tconst i18n = getContext('i18n');\n\n\texport let showDocsHandler: Function;\n\texport let showShortcutsHandler: Function;\n\n\texport let onClose: Function = () => {};\n</script>\n\n<Dropdown\n\ton:change={(e) => {\n\t\tif (e.detail === false) {\n\t\t\tonClose();\n\t\t}\n\t}}\n>\n\t<slot />\n\n\t<div slot=\"content\">\n\t\t<DropdownMenu.Content\n\t\t\tclass=\"w-full max-w-[200px] rounded-xl px-1 py-1.5 border border-gray-300/30 dark:border-gray-700/50 z-50 bg-white dark:bg-gray-850 dark:text-white shadow-lg\"\n\t\t\tsideOffset={4}\n\t\t\tside=\"top\"\n\t\t\talign=\"end\"\n\t\t\ttransition={flyAndScale}\n\t\t>\n\t\t\t<DropdownMenu.Item\n\t\t\t\tclass=\"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md\"\n\t\t\t\tid=\"chat-share-button\"\n\t\t\t\ton:click={() => {\n\t\t\t\t\twindow.open('https://docs.openwebui.com', '_blank');\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<QuestionMarkCircle className=\"size-5\" />\n\t\t\t\t<div class=\"flex items-center\">{$i18n.t('Documentation')}</div>\n\t\t\t</DropdownMenu.Item>\n\n\t\t\t<DropdownMenu.Item\n\t\t\t\tclass=\"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md\"\n\t\t\t\tid=\"chat-share-button\"\n\t\t\t\ton:click={() => {\n\t\t\t\t\tshowShortcutsHandler();\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<Keyboard className=\"size-5\" />\n\t\t\t\t<div class=\"flex items-center\">{$i18n.t('Keyboard shortcuts')}</div>\n\t\t\t</DropdownMenu.Item>\n\t\t</DropdownMenu.Content>\n\t</div>\n</Dropdown>\n","<script lang=\"ts\">\n\timport { onMount, tick, getContext } from 'svelte';\n\n\tconst i18n = getContext('i18n');\n\n\timport ShortcutsModal from '../chat/ShortcutsModal.svelte';\n\timport Tooltip from '../common/Tooltip.svelte';\n\timport HelpMenu from './Help/HelpMenu.svelte';\n\n\tlet showShortcuts = false;\n</script>\n\n<div class=\" hidden lg:flex fixed bottom-0 right-0 px-1 py-1 z-20\">\n\t<button\n\t\tid=\"show-shortcuts-button\"\n\t\tclass=\"hidden\"\n\t\ton:click={() => {\n\t\t\tshowShortcuts = !showShortcuts;\n\t\t}}\n\t/>\n\n\t<HelpMenu\n\t\tshowDocsHandler={() => {\n\t\t\tshowShortcuts = !showShortcuts;\n\t\t}}\n\t\tshowShortcutsHandler={() => {\n\t\t\tshowShortcuts = !showShortcuts;\n\t\t}}\n\t>\n\t\t<Tooltip content={$i18n.t('Help')} placement=\"left\">\n\t\t\t<button\n\t\t\t\tclass=\"text-gray-600 dark:text-gray-300 bg-gray-300/20 size-4 flex items-center justify-center text-[0.7rem] rounded-full\"\n\t\t\t>\n\t\t\t\t?\n\t\t\t</button>\n\t\t</Tooltip>\n\t</HelpMenu>\n</div>\n\n<ShortcutsModal bind:show={showShortcuts} />\n"],"names":["sourceEvent","event","pointer","node","svg","point","rect","nonpassive","nonpassivecapture","nopropagation","noevent$1","dragDisable","view","root","selection","select","noevent","yesdrag","noclick","constant$1","x","DragEvent","type","subject","target","identifier","active","y","dx","dy","dispatch","value","defaultFilter","defaultContainer","defaultSubject","d","defaultTouchable","drag$1","filter","container","touchable","gestures","listeners","mousedownx","mousedowny","mousemoving","touchending","clickDistance2","drag","mousedowned","touchstarted","touchmoved","touchended","gesture","beforestart","mousemoved","mouseupped","nodrag","touches","c","n","i","that","touch","p","s","p0","_","constant","epsilon2","cosh","sinh","tanh","interpolateZoom","zoomRho","rho","rho2","rho4","zoom","p1","ux0","uy0","w0","ux1","uy1","w1","d2","S","t","d1","b0","b1","r0","r1","coshr0","u","_1","_2","_4","ZoomEvent","transform","defaultExtent","e","defaultTransform","identity","defaultWheelDelta","defaultConstrain","extent","translateExtent","dx0","dx1","dy0","dy1","zoom$1","constrain","wheelDelta","scaleExtent","duration","interpolate","touchstarting","touchfirst","touchDelay","wheelDelay","tapDistance","wheeled","dblclicked","collection","schedule","k","k0","k1","t0","centroid","translate","scale","Transform","transition","args","g","w","a","b","l","clean","Gesture","key","interrupt","wheelidled","currentTarget","v","x0","y0","dragEnable","t1","started","l0","l1","dp","dl","createParser","onParse","isFirstChunk","buffer","startingPosition","startingFieldLength","eventId","eventName","data","reset","feed","chunk","hasBom","BOM","length","position","discardTrailingNewline","lineLength","fieldLength","character","index","parseEventStreamLine","lineBuffer","noValue","field","step","valueLength","retry","charCode","EventSourceParserStream","parser","controller","createOpenAITextStream","responseBody","splitLargeDeltas","eventStream","iterator","openAIStreamToIterator","streamLargeDeltasAsRandomChunks","reader","done","parsedData","_c","_b","_a","textStreamUpdate","content","chunkSize","sleep","ms","resolve","ctx","create_if_block_1","t0_value","marked","DOMPurify","if_block0","create_if_block_4","if_block1","create_if_block_3","if_block2","create_if_block_2","attr","div0","div0_class_value","insert_hydration","div5","anchor","append_hydration","div3","div1","div2","div4","current","dirty","set_data","html_tag","raw_value","div5_transition","create_bidirectional_transition","fade","button","create_if_block","createEventDispatcher","banner","dismissed","$$props","mounted","classNames","dismiss","id","onMount","API_KEY","CLIENT_ID","getCredentials","response","config","SCOPE","validateCredentials","oauthToken","initialized","loadGoogleDriveApi","reject","script","loadGoogleAuthApi","getAuthToken","error","initialize","createPicker","token","doc","fileId","fileName","fileUrl","mimeType","downloadUrl","exportFormat","errorText","blob","result","loadMsalScript","msalInstance","initializeMsal","msalParams","win","getToken","authParams","accessToken","resp","baseUrl","params","uuidv4","downloadOneDriveFile","fileInfo","fileInfoUrl","downloadResponse","openOneDrivePicker","pickerWindow","channelPort","handleWindowMessage","message","handlePortMessage","portEvent","portData","command","newToken","err","cleanup","authToken","queryString","url","form","input","pickAndDownloadFile","pickerResult","selectedFile","div","hr","each_blocks","t1_value","tooltip_changes","path0","path1","path2","path3","path4","path5","mask","defs","linearGradient0","stop0","stop1","linearGradient1","stop2","stop3","linearGradient2","stop4","stop5","linearGradient3","stop6","stop7","show_if","_d","flyAndScale","i18n","getContext","screenCaptureHandler","uploadFilesHandler","inputFilesHandler","uploadGoogleDriveHandler","uploadOneDriveHandler","selectedToolIds","onClose","tools","show","fileUploadEnabled","init","$_tools","_tools","getTools","$$invalidate","tool","arr","detectMobile","userAgent","handleFileChange","inputFiles","state","tick","toolId","cameraInputElement","$user","div6","t2","t2_value","button_class_value","files","prompt","selectedPromptIdx","filteredPrompts","selectUp","selectDown","confirmPrompt","text","clipboardText","toast","$i18n","clipboardItems","imageUrl","item","location","getUserPosition","name","language","$userAPIKey","apiKey","date","getFormattedDate","time","getFormattedTime","dateTime","getCurrentDateTime","timezone","getUserTimezone","weekday","getWeekday","chatInputContainerElement","chatInputElement","promptIdx","$prompts","func","show_if_1","t3_value","create_if_block_5","t3","dayjs","relativeTime","selectedIdx","items","fuse","filteredItems","confirmSelect","removeLastWordFromString","confirmSelectWeb","confirmSelectYoutube","legacy_documents","$knowledge","legacy_collections","tag","collections","collection_files","file","Fuse","idx","isValidHttpUrl","src_url_equal","img","img_src_value","img_alt_value","$models","model","_e","modelIdx","dbReferences","filteredReferences","reference","refIdx","query","ref","show_if_2","history","loading","commandElement","useDbReferences","dbReferencesList","extractDbReferences","references","highestGeneratedTable","generatedMatch","tableNumber","prompts","getPrompts","knowledge","getKnowledgeBases","$$value","f","path","className","strokeWidth","create_if_block_20","create_if_block_13","div7","create_if_block_18","create_if_block_17","create_if_block_16","create_if_block_15","if_block4","create_if_block_14","each_value_1","ensure_array_like","t_value","span","if_block","create_if_block_19","create_if_block_9","fileitem_changes","create_if_block_11","image_changes","isExcelFile","textarea","richtextinput_changes","create_if_block_7","_g","_f","_j","_i","_h","create_if_block_6","button_disabled_value","excelTypes","excelExtensions","ext","transparentBackground","onChange","createMessagePair","stopResponse","autoScroll","atSelectedModel","selectedModels","selectedModelIds","imageGenerationEnabled","webSearchEnabled","codeInterpreterEnabled","loaded","recording","filesInputElement","commandsElement","dragged","placeholder","visionCapableModels","scrollToBottom","element","mediaStream","video","canvas","track","uploadFileHandler","fullContext","fileExtension","isExcel","tempItemId","fileItem","formData","excelMetadata","extractExcelMetadata","metadataError","conversionResponse","conversionResult","uploadedFile","uploadFile","WEBUI_API_BASE_URL","workbook","XLSX.read","firstSheetName","worksheet","headers","XLSX.utils","jsonData","rowCount","sampleRows","$config","$settings","width","height","compressImage","fileWithMetadata","handleKeyDown","onDragOver","onDragLeave","onDrop","chatInput","dropzoneElement","onDestroy","$tools","func_1","_inputFiles","filename","func_2","fileIdx","deleteFileById","res","generateAutoCompletion","createMessagesList","isCtrlPressed","commandsContainerElement","regenerateButton","userMessageElement","editButton","commandOptionButton","$mobile","clipboardData","PASTED_TEXT_CHARACTER_LIMIT","words","findWordIndices","word","fullPrompt","fileData","click_handler_4","click_handler_5","click_handler_6","m","selector_changes","disabled","showSetDefault","saveDefaultModel","it","settings","updateUserSettings","selectedModelIdx","tags","Tags","tags_changes","saveAs","fileSaver","shareEnabled","shareHandler","downloadHandler","chat","getChatAsText","downloadTxt","chatText","downloadPdf","messages","downloadChatAsPDF","downloadJSONExport","chatObj","$temporaryChatEnabled","getChatById","showControls","showOverview","showArtifacts","copyToClipboard","usermenu_changes","nav","initNewChat","title","$WEBUI_NAME","showModelSelector","showShareChatModal","showDownloadChatModal","showSidebar","$showSidebar","showArchivedChats","cc","names","out","tmp","errorMessages","nodeType","handleType","sourceHandle","targetHandle","edgeType","lib","infiniteExtent","ConnectionMode","PanOnScrollMode","SelectionMode","initialConnection","ConnectionLineType","MarkerType","Position","oppositePosition","areConnectionMapsEqual","handleConnectionChange","cb","diff","connection","getConnectionStatus","isValid","isEdgeBase","isNodeBase","isInternalNodeBase","getNodePositionWithOrigin","nodeOrigin","getNodeDimensions","origin","offsetX","offsetY","getNodesBounds","nodes","box","currBox","nodeOrId","isId","currentNode","nodeBox","nodeToBox","getBoundsOfBoxes","boxToRect","getInternalNodesBounds","nodeLookup","getNodesInside","tx","ty","tScale","partially","excludeNonSelectableNodes","paneRect","pointToRendererPoint","visibleNodes","measured","selectable","hidden","overlappingArea","getOverlappingArea","nodeToRect","area","partiallyVisible","getConnectedEdges","edges","nodeIds","edge","getFitViewNodes","options","fitViewNodes","optionNodeIds","fitViewport","panZoom","minZoom","maxZoom","nodesToFit","bounds","viewport","getViewportForBounds","calculateNodePosition","nodeId","nextPosition","nodeExtent","onError","parentNode","parentX","parentY","parentWidth","parentHeight","isCoordinateExtent","positionAbsolute","clampPosition","getElementsToRemove","nodesToRemove","edgesToRemove","onBeforeDelete","matchingNodes","isIncluded","parentHit","edgeIds","deletableEdges","matchingEdges","onBeforeDeleteResult","clamp","val","min","max","dimensions","clampPositionToParent","childPosition","childDimensions","parent","calcAutoPanVelocity","calcAutoPan","pos","speed","distance","xMovement","yMovement","box1","box2","rectToBox","x2","y2","getBoundsOfRects","rect1","rect2","rectA","rectB","xOverlap","yOverlap","isRectObject","obj","isNumeric","devWarn","snapPosition","snapGrid","snapToGrid","rendererPointToPoint","parsePadding","padding","paddingValue","parsePaddings","paddingY","paddingX","top","bottom","left","right","calculateAppliedPaddings","boundRight","boundBottom","xZoom","yZoom","clampedZoom","boundsCenterX","boundsCenterY","newPadding","offset","isMacOs","nodeHasDimensions","evaluateAbsolutePosition","parentId","withResolvers","rej","getPointerPosition","containerBounds","getEventPosition","pointerPos","xSnapped","ySnapped","getDimensions","getHostForElement","inputTags","isInputDOMNode","isMouseEvent","isMouse","evtX","evtY","getHandleBounds","nodeElement","nodeBounds","handles","handle","handleBounds","getBezierEdgeCenter","sourceX","sourceY","targetX","targetY","sourceControlX","sourceControlY","targetControlX","targetControlY","centerX","centerY","calculateControlOffset","curvature","getControlWithCurvature","x1","y1","getBezierPath","sourcePosition","targetPosition","labelX","labelY","getEdgeCenter","xOffset","yOffset","getElevatedEdgeZIndex","sourceNode","targetNode","selected","zIndex","elevateOnSelect","edgeOrConnectedNodeSelected","selectedZIndex","isEdgeVisible","edgeBox","viewRect","getEdgeId","source","connectionExists","el","addEdge","edgeParams","getStraightPath","handleDirections","getDirection","getPoints","center","sourceDir","targetDir","sourceGapped","targetGapped","dir","dirAccessor","currDir","points","sourceGapOffset","targetGapOffset","defaultCenterX","defaultCenterY","defaultOffsetX","defaultOffsetY","verticalSplit","horizontalSplit","sourceTarget","targetSource","gapOffset","dirAccessorOpposite","isSameDir","sourceGtTargetOppo","sourceLtTargetOppo","sourceGapPoint","targetGapPoint","maxXDistance","maxYDistance","getBend","size","bendSize","xDir","yDir","getSmoothStepPath","borderRadius","segment","isNodeInitialized","getEdgePosition","sourceHandleBounds","toHandleBounds","targetHandleBounds","getHandle$1","getHandlePosition","fallbackPosition","handleId","getMarkerId","marker","createMarkerIds","defaultColor","defaultMarkerStart","defaultMarkerEnd","ids","markers","markerId","defaultOptions","adoptUserNodesDefaultOptions","mergeObjects","base","incoming","updateAbsolutePositions","parentLookup","_options","updateChildNode","positionWithOrigin","clampedPosition","adoptUserNodes","nodesInitialized","tmpLookup","selectedNodeZ","userNode","internalNode","calculateZ","updateParentLookup","childNodes","elevateNodesOnSelect","z","calculateChildXYZ","positionChanged","childNode","absolutePosition","childZ","parentZ","handleExpandParent","children","changes","parentExpansions","child","parentRect","expandedRect","xChange","yChange","newWidth","newHeight","widthChange","heightChange","updateNodeInternals","updates","domNode","viewportNode","updatedInternals","style","parentExpandChildren","update","dimensionChanged","newNode","parentExpandChanges","panBy","delta","nextViewport","transformChanged","addConnectionToLookup","connectionKey","connectionLookup","nodeMap","typeMap","handleMap","updateConnectionLookup","edgeLookup","sourceKey","targetKey","isParentSelected","hasSelector","selector","getDragItems","nodesDraggable","mousePos","dragItems","getEventHandlerParams","dragging","nodesFromDragItems","dragItem","XYDrag","onNodeMouseDown","getStoreItems","onDragStart","onDrag","onDragStop","lastPos","autoPanId","autoPanStarted","mousePosition","dragStarted","d3Selection","abortDrag","noDragClassName","handleSelector","isSelectable","nodeClickDistance","updateNodes","dragEvent","onNodeDrag","onSelectionDrag","updateNodePositions","hasChange","nodesBox","adjustedNodeExtent","currentNodes","autoPan","autoPanSpeed","autoPanOnNodeDrag","startDrag","multiSelectionActive","selectNodesOnDrag","onNodeDragStart","onSelectionDragStart","unselectNodesAndEdges","d3DragInstance","nodeDragThreshold","onNodeDragStop","onSelectionDragStop","destroy","getNodesWithinDistance","ADDITIONAL_DISTANCE","getClosestHandle","connectionRadius","fromHandle","closestHandles","minDistance","closeNodes","allHandles","oppositeHandleType","getHandle","connectionMode","withAbsolutePosition","h","getHandleType","edgeUpdaterType","handleDomNode","isConnectionValid","isInsideConnectionRadius","isHandleValid","alwaysValid","onPointerDown","isTarget","autoPanOnConnect","flowId","cancelConnection","onConnectStart","onConnect","onConnectEnd","isValidConnection","onReconnectEnd","updateConnection","getTransform","getFromHandle","closestHandle","clickedHandle","fromHandleInternal","fromNodeInternal","newConnection","previousConnection","onPointerMove","onPointerUp","isValidHandle","inProgress","connectionState","finalConnectionState","fromNodeId","fromHandleId","fromType","handleBelow","handleToCheck","handleNodeId","connectable","connectableEnd","XYHandle","viewChanged","prevViewport","eventViewport","transformToViewport","viewportToTransform","zoomIdentity","isWrappedWithClass","isRightClickPan","panOnDrag","usedButton","getD3Transition","onEnd","hasDuration","factor","createPanOnScrollHandler","zoomPanValues","noWheelClassName","d3Zoom","panOnScrollMode","panOnScrollSpeed","zoomOnPinch","onPanZoomStart","onPanZoom","onPanZoomEnd","currentZoom","pinchDelta","deltaNormalize","deltaX","deltaY","createZoomOnScrollHandler","preventScrolling","d3ZoomHandler","isWheel","preventZoom","hasNoWheelClass","createPanZoomStartHandler","onDraggingChange","createPanZoomHandler","onPaneContextMenu","onTransformChange","createPanZoomEndHandler","panOnScroll","createFilter","zoomActivationKeyPressed","zoomOnScroll","zoomOnDoubleClick","userSelectionActive","noPanClassName","zoomScroll","pinchZoom","buttonAllowed","XYPanZoom","paneClickDistance","bbox","d3ZoomInstance","setViewportConstrained","d3DblClickZoomHandler","setTransform","wheelHandler","startHandler","panZoomHandler","panZoomEndHandler","nextTransform","contrainedTransform","setViewport","syncViewport","currentTransform","getViewport","zoomTransform","scaleTo","scaleBy","setScaleExtent","setTranslateExtent","setClickDistance","validDistance","ResizeControlVariant","div_data_id_value","onconnect","ondisconnect","isConnectableProp","store","useStore","isValidConnectionStore","onedgecreate","onConnectAction","onConnectStartAction","onConnectEndAction","isMouseTriggered","$connectionRadius","$domNode","$nodeLookup","$connectionMode","$lib","$autoPanOnConnect","$flowId","$isValidConnectionStore","$onedgecreate","$onConnectAction","startParams","$onConnectStartAction","$onConnectEndAction","$viewport","$connection","prevConnections","connections","isConnectable","$connectable","$connectionLookup","_connections","connectionInProcess","connectingFrom","connectingTo","isPossibleEndHandle","valid","tryToMount","targetEl","portal","useHandleEdgeSelect","selectionRect","selectionRectMode","multiselectionKeyPressed","addSelectedEdges","elementsSelectable","get","style_transform","div_style_value","style_changed","handleEdgeSelect","path_1","label","labelStyle","markerStart","markerEnd","interactionWidth","interactionWidthValue","syncNodeStores","nodesStore","userNodesStore","nodesStoreSetter","userNodesStoreSetter","currentNodesStore","currentUserNodesStore","_set","nds","updatedNodes","fn","syncEdgeStores","edgesStore","userEdgesStore","userEdgesStoreSetter","eds","syncViewportStores","panZoomStore","viewportStore","userViewportStore","viewportStoreSetter","userViewportStoreSetter","vp","createNodesStore","fitViewQueued","fitViewOptions","fitViewResolver","subscribe","set","writable","defaults","_update","setDefaultOptions","setOptions","createEdgesStore","nextEdges","initialNodeTypes","InputNode","OutputNode","DefaultNode","GroupNode","initialEdgeTypes","StraightEdgeInternal","SmoothStepEdgeInternal","BezierEdgeInternal","StepEdgeInternal","getInitialStore","fitView","storeNodeOrigin","storeNodeExtent","widthStore","heightStore","readable","getVisibleEdges","visibleEdges","derived","onlyRenderVisibleElements","onerror","edgePosition","getVisibleNodes","createStore","fitViewOnCreate","setNodeTypes","nodeTypes","setEdgeTypes","edgeTypes","addEdgeUtil","nodeDragItems","updateNodeInternalsSystem","change","zoomBy","zoomIn","zoomOut","setMinZoom","setMaxZoom","resetSelectedElements","elements","elementsChanged","setPaneClickDistance","deleteKeyPressed","selectedNodes","selectedEdges","mN","mE","addSelectedNodes","isMultiSelection","ns","nodeWillBeSelected","es","edgeWillBeSelected","handleNodeSelection","panBySystem","_connection","initialNodesLength","initialEdgesLength","edgesInitialized","viewportInitialized","createStoreContext","setContext","initialViewport","panZoomInstance","currentViewport","onMoveStart","onMove","onMoveEnd","panActivationKeyPressed","set_store_value","$viewportInitialized","viewPort","_panOnDrag","$panActivationKeyPressed","_panOnScroll","toggle_class","wrapHandler","handler","toggleSelected","isSelected","selectionOnDrag","selectionKeyPressed","selectionMode","selectionInProgress","onClick","isSelecting","$selectionRect","startX","startY","nextUserSelectRect","prevSelectedNodeIds","prevSelectedEdgeIds","$edges","$selectionMode","selectedEdgeIds","selectedNodeIds","$selectionRectMode","$selectionKeyPressed","onContextMenu","hasActiveSelection","$elementsSelectable","dragInstance","updateDrag","getNodeInlineStyleDimensions","initialWidth","initialHeight","measuredWidth","measuredHeight","styleWidth","styleHeight","switch_instance_changes","draggable","deletable","resizeObserver","isParent","positionX","positionY","dragHandle","nodeRef","prevNodeRef","dispatchNodeEvent","connectableStore","prevType","prevSourcePosition","prevTargetPosition","onSelectNodeHandler","drag_function","drag_function_1","drag_function_2","mouseenter_handler","mouseleave_handler","mousemove_handler","contextmenu_handler","nodeTypeValid","$nodeTypes","nodeComponent","inlineStyleDimensions","nodewrapper_changes","get_key","nodesConnectable","entries","entry","g_aria_label_value","animated","ariaLabel","$edgeLookup","onMouseEvent","edgeComponent","$edgeTypes","markerStartUrl","markerEndUrl","_onMount","_onDestroy","polyline","markerUnits","orient","color","edgewrapper_changes","defaultEdgeOptions","$edgesInitialized","set_style","isVisible","selection_changes","$nodes","__","shortcut","param","enabled","trigger","normalizedTriggers","modifiedMap","mergedTrigger","modifier","callback","preventDefault","triggerEnabled","def","detail","newEnabled","newType","getShortcutTrigger","isKeyObject","getModifier","getKeyString","_key","keyString","selectionKey","multiSelectionKey","deleteKey","panActivationKey","zoomActivationKey","resetKeysAndSelection","containerStyle","isCustomComponent","connectionLineType","from","to","fromPosition","toPosition","pathParams","$connectionLineType","div_class_value","positionClasses","proOptions","updateStore","getKeys","updateStoreByKeys","keys","prop","getMediaQuery","useColorModeClass","colorMode","mediaQuery","updateColorModeClass","connectionline_changes","pane_changes","zoom_changes","connectionLineStyle","connectionLineContainerStyle","ondelete","attributionPosition","onconnectstart","onconnectend","onbeforedelete","oninit","defaultMarkerColor","clientWidth","clientHeight","initViewport","hasContext","onInitCalled","$initialized","$$subscribe_colorModeClass","colorModeClass","initialNodes","initialEdges","bgColor","bgColorHover","colorHover","borderColor","panel_changes","showZoom","showFitView","showLock","buttonBgColor","buttonBgColorHover","buttonColor","buttonColorHover","buttonBorderColor","orientation","buttonProps","onZoomInHandler","onZoomOutHandler","onFitViewHandler","onToggleInteractivity","isInteractive","$nodesDraggable","$nodesConnectable","minZoomReached","$minZoom","maxZoomReached","$maxZoom","orientationClass","BackgroundVariant","circle","circle_class_value","radius","path_d_value","lineWidth","variant","dotpattern_changes","pattern","pattern_x_value","pattern_y_value","pattern_width_value","pattern_height_value","pattern_patternTransform_value","defaultSize","gap","patternColor","patternClass","patternSize","isDots","isCross","gapXY","patternId","scaledGap","scaledSize","patternDimensions","patternOffset","isNode","useSvelteFlow","getNodeRect","nodeToUse","nodeWithPosition","updateNode","nodeUpdate","nextNode","getInternalNode","getElements","zoomLevel","currentPanZoom","nextZoom","nodeOrRect","nodesToIntersect","isRect","nodeRect","currNodeRect","_domNode","_snapGrid","domX","domY","correctedPosition","rendererPosition","dataUpdate","nextData","_nodeLookup","_nodeOrigin","lookup","useNodesInitialized","add_render_callback","select0","select1","option0","option1","option","option_value_value","tab","selectedId","valvesSpec","valves","debounceTimer","debounceSubmitHandler","submitHandler","getUserValves","getToolUserValvesById","getToolUserValvesSpecById","getFunctionUserValvesById","getFunctionUserValvesSpecById","property","updateToolUserValvesById","updateFunctionUserValvesById","$functions","functions","getFunctions","select_value","hr0","hr1","set_input_value","models","chatFiles","showValves","devices","device","button0","button1","create_if_block_8","circle0","circle1","circle2","eventTarget","submitPrompt","chatId","modelId","wakeLock","confirmed","assistantSpeaking","emoji","camera","cameraStream","chatStreaming","rmsLevel","hasStartedSpeaking","mediaRecorder","audioStream","audioChunks","videoInputDevices","selectedVideoInputDeviceId","getVideoInputDevices","startCamera","startVideoStream","stopVideoStream","takeScreenshot","context","dataURL","stopCamera","MIN_DECIBELS","transcribeHandler","audioBlob","blobToFile","transcribeAudio","_responses","stopRecordingCallback","_continue","$showCallOverlay","_audioChunks","startRecording","analyseAudio","stopAudioStream","calculateRMS","sumSquares","normalizedValue","stream","audioContext","audioStreamSource","analyser","bufferLength","domainData","timeDomainData","lastSoundTime","processFrame","stopAllAudio","finishedMessages","currentMessageId","currentUtterance","speakSpeechSynthesisHandler","voices","getVoicesLoop","voice","r","playAudio","audio","audioElement","audioAbortController","audioCache","emojiCache","fetchAudio","generateEmoji","$TTSWorker","synthesizeOpenAISpeech","_l","_k","_n","_m","blobUrl","monitorAndPlayAudio","signal","chatStartHandler","chatEventHandler","chatFinishHandler","setWakeLock","showCallOverlay","profileimage_changes","nodeclick_handler","selectedMessageId","CustomNode","focusNode","drawFlow","nodeList","edgeList","positionMap","layerWidths","level","recurseCheckChild","currentId","iframe","svg0","svg1","button2","t4","t4_value","overlay","contents","selectedContentIdx","copied","iframeElement","getContents","codeBlockContents","codeBlocks","block","lang","code","htmlContent","cssContent","jsContent","inlineHtml","inlineCss","inlineJs","renderedContent","navigateContent","direction","iframeLoadHandler","showFullScreen","click_handler_2","click_handler_3","showMessage","pane","largeScreen","minSize","openPane","handleMediaQuery","onMouseDown","onMouseUp","percentage","$showControls","closeHandler","sanitizeResponseContent","div9","div8","div0_intro","create_in_transition","div2_intro","div4_intro","$_models","navbar_changes","each_value","chatcontrols_changes","eventConfirmationTitle","eventConfirmationMessage","eventConfirmationInput","eventConfirmationInputPlaceholder","eventConfirmationInputValue","eventCallback","chatIdProp","controlPane","controlPaneComponent","messagesContainerElement","navbarElement","showEventConfirmation","chatIdUnsubscriber","taskId","saveSessionSelectedModels","setToolIds","_chatId","$chatId","_messageId","messageChildrenIds","messageElement","saveChatHandler","existingIndex","exec","chatTitle","currentChatPage","chats","getChatList","$currentChatPage","allTags","getAllTags","continueButton","onMessageHandler","inputElement","$socket","goto","uploadGoogleDriveFile","fetchOptions","fileResponse","contentType","fileBlob","uploadWeb","processWeb","uploadYoutubeTranscription","processYoutubeVideo","$page","urlModels","modelSelectorButton","modelSelectorInput","initHistoryWithGreetings","userSettings","getUserSettings","loadChat","getTagsById","chatContent","convertMessagesToHistory","chatActionHandler","actionId","responseMessageId","chatAction","updateChatById","userPrompt","parentMessage","userMessageId","userMessage","responseMessage","initChatHandler","addMessages","currentParentId","messageId","_raw","_selectedModels","_files","array","sendPrompt","sendPromptSocket","_history","userLocation","getAndUpdateUserLocation","promptTemplate","removeDetails","generateOpenAIChatCompletion","str","getPromptVariables","_o","_p","_s","_r","_q","WEBUI_BASE_URL","newChat","createNewChat","userModelId","isAgentModel","agentLoadingText","startAgentAnimation","loadingTexts","textIndex","dotCount","animateText","baseText","dots","stopTask","submitMessage","regenerateResponse","continueResponse","mergeResponses","responses","mergedResponse","generateMoACompletion","textStream","sources","usage","greeting","bannerId","$banners","div78","div56","div55","div31","div12","div11","div18","div13","div17","div24","div19","div23","div30","div25","div29","div54","div36","div32","div35","div42","div37","div41","div48","div43","div47","div53","div49","div52","div58","div57","div77","div76","div75","div62","div59","div61","div66","div63","div65","div70","div67","div69","div74","div71","div73","t11","t11_value","t17","t17_value","t25","t25_value","t33","t33_value","t41","t41_value","t47","t47_value","t55","t55_value","t63","t63_value","t69","t69_value","t71","t71_value","t75","t75_value","t79","t79_value","t83","t83_value","showDocsHandler","showShortcutsHandler","showShortcuts"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90]}