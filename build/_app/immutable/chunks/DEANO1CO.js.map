{"version":3,"file":"DEANO1CO.js","sources":["../../../../../../src/lib/components/common/FileItem.svelte"],"sourcesContent":["<script lang=\"ts\">\n\t// FileItem.svelte 修改\n\timport { createEventDispatcher, getContext } from 'svelte';\n\timport { formatFileSize } from '$lib/utils';\n\n\timport FileItemModal from './FileItemModal.svelte';\n\timport GarbageBin from '../icons/GarbageBin.svelte';\n\timport Spinner from './Spinner.svelte';\n\timport Tooltip from './Tooltip.svelte';\n\timport { WEBUI_API_BASE_URL } from '$lib/constants';\n\n\tconst i18n = getContext('i18n');\n\tconst dispatch = createEventDispatcher();\n\n\texport let className = 'w-60';\n\texport let colorClassName = 'bg-white dark:bg-gray-850 border border-gray-50 dark:border-white/5';\n\texport let url: string | null = null;\n\n\texport let dismissible = false;\n\texport let loading = false;\n\n\texport let item = null;\n\texport let edit = false;\n\texport let small = false;\n\n\texport let name: string;\n\texport let type: string;\n\texport let size: number;\n\n\timport { deleteFileById } from '$lib/apis/files';\n\n\tlet showModal = false;\n\t\n\t// Function to check if this is an Excel file\n\tfunction isExcelFile(fileName: string) {\n\t\tconst excelExtensions = ['.xls', '.xlsx', '.csv', '.ods'];\n\t\treturn excelExtensions.some(ext => fileName.toLowerCase().endsWith(ext));\n\t}\n\t\n\t// Function to check if this is a PDF file\n\tfunction isPdfFile(fileName: string) {\n\t\treturn fileName.toLowerCase().endsWith('.pdf');\n\t}\n\t\n\t// Determine the file type for icon display\n\tconst fileType = isExcelFile(name) ? 'excel' : type;\n</script>\n\n{#if item}\n\t<FileItemModal bind:show={showModal} bind:item {edit} />\n{/if}\n\n<button\n\tclass=\"relative group p-1.5 {className} flex items-center gap-1 {colorClassName} {small\n\t\t? 'rounded-xl'\n\t\t: 'rounded-2xl'} text-left\"\n\ttype=\"button\"\n\ton:click={async () => {\n\t\tif (isExcelFile(name) && item?.id) {\n\t\t\t// Excel文件打开专用的Excel预览页面，而不是直接打开文件\n\t\t\t// 假设预览页面的路径是 /excel-viewer，并通过查询参数传递文件ID\n\t\t\tconst viewerUrl = `/excel-viewer?fileId=${item.id}&fileName=${encodeURIComponent(name)}`;\n\t\t\twindow.open(viewerUrl, '_blank').focus();\n\t\t} else if (item?.file?.data?.content || isPdfFile(name)) {\n\t\t\t// PDF文件或有内容的文件使用modal打开\n\t\t\tshowModal = !showModal;\n\t\t} else {\n\t\t\t// 其他文件如果有URL则在新标签页打开\n\t\t\tif (url) {\n\t\t\t\tif (type === 'file') {\n\t\t\t\t\twindow.open(`${url}/content`, '_blank').focus();\n\t\t\t\t} else {\n\t\t\t\t\twindow.open(`${url}`, '_blank').focus();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tdispatch('click');\n\t}}\n>\n\t{#if !small}\n\t\t<div class=\"p-3 {isExcelFile(name) ? 'bg-green-600/20 dark:bg-green-500/20 text-green-600 dark:text-green-500' : 'bg-black/20 dark:bg-white/10 text-white'} rounded-xl\">\n\t\t\t{#if !loading}\n\t\t\t\t{#if isExcelFile(name)}\n\t\t\t\t\t<!-- Excel Icon -->\n\t\t\t\t\t<svg \n\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\" \n\t\t\t\t\t\tviewBox=\"0 0 24 24\" \n\t\t\t\t\t\tfill=\"currentColor\" \n\t\t\t\t\t\tclass=\"size-5\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<path \n\t\t\t\t\t\t\tfill-rule=\"evenodd\" \n\t\t\t\t\t\t\td=\"M5.625 1.5c-1.036 0-1.875.84-1.875 1.875v17.25c0 1.035.84 1.875 1.875 1.875h12.75c1.035 0 1.875-.84 1.875-1.875V12.75A3.75 3.75 0 0 0 16.5 9h-1.875a1.875 1.875 0 0 1-1.875-1.875V5.25A3.75 3.75 0 0 0 9 1.5H5.625ZM7.5 15a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 7.5 15Zm.75 2.25a.75.75 0 0 0 0 1.5H12a.75.75 0 0 0 0-1.5H8.25Z\" \n\t\t\t\t\t\t\tclip-rule=\"evenodd\" \n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<path \n\t\t\t\t\t\t\td=\"M12.971 1.816A5.23 5.23 0 0 1 14.25 5.25v1.875c0 .207.168.375.375.375H16.5a5.23 5.23 0 0 1 3.434 1.279 9.768 9.768 0 0 0-6.963-6.963Z\" \n\t\t\t\t\t\t/>\n\t\t\t\t\t</svg>\n\t\t\t\t{:else}\n\t\t\t\t\t<!-- Default document icon -->\n\t\t\t\t\t<svg\n\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\tclass=\"size-5\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<path\n\t\t\t\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\t\t\t\td=\"M5.625 1.5c-1.036 0-1.875.84-1.875 1.875v17.25c0 1.035.84 1.875 1.875 1.875h12.75c1.035 0 1.875-.84 1.875-1.875V12.75A3.75 3.75 0 0 0 16.5 9h-1.875a1.875 1.875 0 0 1-1.875-1.875V5.25A3.75 3.75 0 0 0 9 1.5H5.625ZM7.5 15a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 7.5 15Zm.75 2.25a.75.75 0 0 0 0 1.5H12a.75.75 0 0 0 0-1.5H8.25Z\"\n\t\t\t\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<path\n\t\t\t\t\t\t\td=\"M12.971 1.816A5.23 5.23 0 0 1 14.25 5.25v1.875c0 .207.168.375.375.375H16.5a5.23 5.23 0 0 1 3.434 1.279 9.768 9.768 0 0 0-6.963-6.963Z\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</svg>\n\t\t\t\t{/if}\n\t\t\t{:else}\n\t\t\t\t<Spinner />\n\t\t\t{/if}\n\t\t</div>\n\t{/if}\n\n\t{#if !small}\n\t\t<div class=\"flex flex-col justify-center -space-y-0.5 px-2.5 w-full\">\n\t\t\t<div class=\"dark:text-gray-100 text-sm font-medium line-clamp-1 mb-1\">\n\t\t\t\t{name}\n\t\t\t</div>\n\n\t\t\t<div class=\"flex justify-between text-gray-500 text-xs line-clamp-1\">\n\t\t\t\t{#if isExcelFile(name)}\n\t\t\t\t\t{$i18n.t('Excel')}\n\t\t\t\t{:else if type === 'file'}\n\t\t\t\t\t{$i18n.t('File')}\n\t\t\t\t{:else if type === 'doc'}\n\t\t\t\t\t{$i18n.t('Document')}\n\t\t\t\t{:else if type === 'collection'}\n\t\t\t\t\t{$i18n.t('Collection')}\n\t\t\t\t{:else}\n\t\t\t\t\t<span class=\"capitalize line-clamp-1\">{type}</span>\n\t\t\t\t{/if}\n\t\t\t\t{#if size}\n\t\t\t\t\t<span class=\"capitalize\">{formatFileSize(size)}</span>\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t</div>\n\t{:else}\n\t\t<Tooltip content={name} className=\"flex flex-col w-full\" placement=\"top-start\">\n\t\t\t<div class=\"flex flex-col justify-center -space-y-0.5 px-2.5 w-full\">\n\t\t\t\t<div class=\"dark:text-gray-100 text-sm flex justify-between items-center\">\n\t\t\t\t\t{#if loading}\n\t\t\t\t\t\t<div class=\"shrink-0 mr-2\">\n\t\t\t\t\t\t\t<Spinner className=\"size-4\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n\t\t\t\t\t<div class=\"font-medium line-clamp-1 flex-1\">{name}</div>\n\t\t\t\t\t<div class=\"text-gray-500 text-xs capitalize shrink-0\">{formatFileSize(size)}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</Tooltip>\n\t{/if}\n\n\t{#if dismissible}\n\t\t<div class=\"absolute -top-1 -right-1\">\n\t\t\t<button\n\t\t\t\tclass=\"bg-white text-black border border-white rounded-full group-hover:visible invisible transition\"\n\t\t\t\ttype=\"button\"\n\t\t\t\ton:click|stopPropagation={() => {\n\t\t\t\t\tdispatch('dismiss');\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<svg\n\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\tviewBox=\"0 0 20 20\"\n\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\tclass=\"w-4 h-4\"\n\t\t\t\t>\n\t\t\t\t\t<path\n\t\t\t\t\t\td=\"M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z\"\n\t\t\t\t\t/>\n\t\t\t\t</svg>\n\t\t\t</button>\n\t\t</div>\n\t{/if}\n</button>"],"names":["ctx","attr","div","div_class_value","isExcelFile","insert_hydration","target","anchor","current","dirty","show_if","svg","append_hydration","path0","path1","create_if_block_4","create_if_block_5","create_if_block_6","create_if_block_2","div2","div0","div1","t3_value","formatFileSize","create_if_block_7","div3","set_data","t3","span","t","t_value","button","create_if_block_11","create_if_block_8","create_if_block","button_class_value","fileName","ext","isPdfFile","i18n","getContext","dispatch","createEventDispatcher","className","$$props","colorClassName","url","dismissible","loading","item","edit","small","name","type","size","showModal","value","viewerUrl","_b","_a","$$invalidate"],"mappings":"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"}