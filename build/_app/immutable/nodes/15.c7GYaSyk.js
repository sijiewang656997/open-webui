import{s as ca,d as ne,i as Le,c as ee,l as Ae,k as ua,e as he,f as pe,o as Se,h as de,j as sn,p as fa,q as ha,G as ar,a as Be,b as J,x as tt,a0 as da,g as Oe,N as Ft,t as De,m as Ni,n as dt,O as fi,B as Pt,D as St,E as kt,R as as,Q as pa,M as Oi,P as ma,a4 as qr,a5 as Xr}from"../chunks/CgRTDwF2.js";import{S as ga,i as wa,t as st,a as Qe,c as $t,g as Vt,d as lr,m as cr,b as ur,e as fr}from"../chunks/Bnxgdxyh.js";import{g as ya}from"../chunks/D0QH3NT1.js";import{e as tr}from"../chunks/C3QokUWv.js";import{t as Je}from"../chunks/Fny8-CkQ.js";import{w as va}from"../chunks/-NlMIP-u.js";import{S as hr}from"../chunks/CnJpwmt-.js";import{s as ba,l as _a}from"../chunks/D-bUEbUi.js";import"../chunks/C_2ZPrHa.js";import{P as xa,D as Ea,c as Ta,d as Aa}from"../chunks/BTG4jZN5.js";import{F as Sa}from"../chunks/0n0hRmjK.js";import{b as Di}from"../chunks/CisIfe-u.js";import{g as ka}from"../chunks/cKvFHznx.js";var Ca=Object.defineProperty,Ra=Object.defineProperties,Ia=Object.getOwnPropertyDescriptors,Bi=Object.getOwnPropertySymbols,Na=Object.prototype.hasOwnProperty,Oa=Object.prototype.propertyIsEnumerable,ti=(r,e,t)=>e in r?Ca(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,ze=(r,e)=>{for(var t in e||(e={}))Na.call(e,t)&&ti(r,t,e[t]);if(Bi)for(var t of Bi(e))Oa.call(e,t)&&ti(r,t,e[t]);return r},Tr=(r,e)=>Ra(r,Ia(e)),me=(r,e,t)=>(ti(r,typeof e!="symbol"?e+"":e,t),t),Nr=(r,e,t)=>new Promise((a,l)=>{var i=u=>{try{n(t.next(u))}catch(w){l(w)}},c=u=>{try{n(t.throw(u))}catch(w){l(w)}},n=u=>u.done?a(u.value):Promise.resolve(u.value).then(i,c);n((t=t.apply(r,e)).next())});class $r{constructor(e){me(this,"rootKey"),this.rootKey=e}}const Da=Object.seal({});class ye extends $r{constructor(e){super(e),me(this,"root"),this.root=new Array}prepForXml(e){var t;e.stack.push(this);const a=this.root.map(l=>l instanceof $r?l.prepForXml(e):l).filter(l=>l!==void 0);return e.stack.pop(),{[this.rootKey]:a.length?a.length===1&&((t=a[0])!=null&&t._attr)?a[0]:a:Da}}addChildElement(e){return this.root.push(e),this}}class Zr extends ye{prepForXml(e){const t=super.prepForXml(e);if(t&&(typeof t[this.rootKey]!="object"||Object.keys(t[this.rootKey]).length))return t}}class Fe extends $r{constructor(e){super("_attr"),me(this,"xmlKeys"),this.root=e}prepForXml(e){const t={};return Object.keys(this.root).forEach(a=>{const l=this.root[a];if(l!==void 0){const i=this.xmlKeys&&this.xmlKeys[a]||a;t[i]=l}}),{_attr:t}}}class Sr extends $r{constructor(e){super("_attr"),this.root=e}prepForXml(e){return{_attr:Object.values(this.root).filter(({value:a})=>a!==void 0).reduce((a,{key:l,value:i})=>Tr(ze({},a),{[l]:i}),{})}}}class nt extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{val:"w:val",color:"w:color",fill:"w:fill",space:"w:space",sz:"w:sz",type:"w:type",rsidR:"w:rsidR",rsidRPr:"w:rsidRPr",rsidSect:"w:rsidSect",w:"w:w",h:"w:h",top:"w:top",right:"w:right",bottom:"w:bottom",left:"w:left",header:"w:header",footer:"w:footer",gutter:"w:gutter",linePitch:"w:linePitch",pos:"w:pos"})}}var Rt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ls(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var cs={},hi={exports:{}},Zt=typeof Reflect=="object"?Reflect:null,Fi=Zt&&typeof Zt.apply=="function"?Zt.apply:function(e,t,a){return Function.prototype.apply.call(e,t,a)},Wr;Zt&&typeof Zt.ownKeys=="function"?Wr=Zt.ownKeys:Object.getOwnPropertySymbols?Wr=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Wr=function(e){return Object.getOwnPropertyNames(e)};function Ba(r){console&&console.warn&&console.warn(r)}var us=Number.isNaN||function(e){return e!==e};function qe(){qe.init.call(this)}hi.exports=qe;hi.exports.once=Ua;qe.EventEmitter=qe;qe.prototype._events=void 0;qe.prototype._eventsCount=0;qe.prototype._maxListeners=void 0;var Pi=10;function Yr(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(qe,"defaultMaxListeners",{enumerable:!0,get:function(){return Pi},set:function(r){if(typeof r!="number"||r<0||us(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");Pi=r}});qe.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};qe.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||us(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function fs(r){return r._maxListeners===void 0?qe.defaultMaxListeners:r._maxListeners}qe.prototype.getMaxListeners=function(){return fs(this)};qe.prototype.emit=function(e){for(var t=[],a=1;a<arguments.length;a++)t.push(arguments[a]);var l=e==="error",i=this._events;if(i!==void 0)l=l&&i.error===void 0;else if(!l)return!1;if(l){var c;if(t.length>0&&(c=t[0]),c instanceof Error)throw c;var n=new Error("Unhandled error."+(c?" ("+c.message+")":""));throw n.context=c,n}var u=i[e];if(u===void 0)return!1;if(typeof u=="function")Fi(u,this,t);else for(var w=u.length,y=gs(u,w),a=0;a<w;++a)Fi(y[a],this,t);return!0};function hs(r,e,t,a){var l,i,c;if(Yr(t),i=r._events,i===void 0?(i=r._events=Object.create(null),r._eventsCount=0):(i.newListener!==void 0&&(r.emit("newListener",e,t.listener?t.listener:t),i=r._events),c=i[e]),c===void 0)c=i[e]=t,++r._eventsCount;else if(typeof c=="function"?c=i[e]=a?[t,c]:[c,t]:a?c.unshift(t):c.push(t),l=fs(r),l>0&&c.length>l&&!c.warned){c.warned=!0;var n=new Error("Possible EventEmitter memory leak detected. "+c.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");n.name="MaxListenersExceededWarning",n.emitter=r,n.type=e,n.count=c.length,Ba(n)}return r}qe.prototype.addListener=function(e,t){return hs(this,e,t,!1)};qe.prototype.on=qe.prototype.addListener;qe.prototype.prependListener=function(e,t){return hs(this,e,t,!0)};function Fa(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function ds(r,e,t){var a={fired:!1,wrapFn:void 0,target:r,type:e,listener:t},l=Fa.bind(a);return l.listener=t,a.wrapFn=l,l}qe.prototype.once=function(e,t){return Yr(t),this.on(e,ds(this,e,t)),this};qe.prototype.prependOnceListener=function(e,t){return Yr(t),this.prependListener(e,ds(this,e,t)),this};qe.prototype.removeListener=function(e,t){var a,l,i,c,n;if(Yr(t),l=this._events,l===void 0)return this;if(a=l[e],a===void 0)return this;if(a===t||a.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete l[e],l.removeListener&&this.emit("removeListener",e,a.listener||t));else if(typeof a!="function"){for(i=-1,c=a.length-1;c>=0;c--)if(a[c]===t||a[c].listener===t){n=a[c].listener,i=c;break}if(i<0)return this;i===0?a.shift():Pa(a,i),a.length===1&&(l[e]=a[0]),l.removeListener!==void 0&&this.emit("removeListener",e,n||t)}return this};qe.prototype.off=qe.prototype.removeListener;qe.prototype.removeAllListeners=function(e){var t,a,l;if(a=this._events,a===void 0)return this;if(a.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):a[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete a[e]),this;if(arguments.length===0){var i=Object.keys(a),c;for(l=0;l<i.length;++l)c=i[l],c!=="removeListener"&&this.removeAllListeners(c);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=a[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(l=t.length-1;l>=0;l--)this.removeListener(e,t[l]);return this};function ps(r,e,t){var a=r._events;if(a===void 0)return[];var l=a[e];return l===void 0?[]:typeof l=="function"?t?[l.listener||l]:[l]:t?La(l):gs(l,l.length)}qe.prototype.listeners=function(e){return ps(this,e,!0)};qe.prototype.rawListeners=function(e){return ps(this,e,!1)};qe.listenerCount=function(r,e){return typeof r.listenerCount=="function"?r.listenerCount(e):ms.call(r,e)};qe.prototype.listenerCount=ms;function ms(r){var e=this._events;if(e!==void 0){var t=e[r];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}qe.prototype.eventNames=function(){return this._eventsCount>0?Wr(this._events):[]};function gs(r,e){for(var t=new Array(e),a=0;a<e;++a)t[a]=r[a];return t}function Pa(r,e){for(;e+1<r.length;e++)r[e]=r[e+1];r.pop()}function La(r){for(var e=new Array(r.length),t=0;t<e.length;++t)e[t]=r[t].listener||r[t];return e}function Ua(r,e){return new Promise(function(t,a){function l(c){r.removeListener(e,i),a(c)}function i(){typeof r.removeListener=="function"&&r.removeListener("error",l),t([].slice.call(arguments))}ws(r,e,i,{once:!0}),e!=="error"&&Ma(r,l,{once:!0})})}function Ma(r,e,t){typeof r.on=="function"&&ws(r,"error",e,t)}function ws(r,e,t,a){if(typeof r.on=="function")a.once?r.once(e,t):r.on(e,t);else if(typeof r.addEventListener=="function")r.addEventListener(e,function l(i){a.once&&r.removeEventListener(e,l),t(i)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}var di=hi.exports,ri={exports:{}};typeof Object.create=="function"?ri.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:ri.exports=function(e,t){if(t){e.super_=t;var a=function(){};a.prototype=t.prototype,e.prototype=new a,e.prototype.constructor=e}};var Kt=ri.exports;function ja(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var ys={exports:{}},it=ys.exports={},Tt,At;function ni(){throw new Error("setTimeout has not been defined")}function ii(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?Tt=setTimeout:Tt=ni}catch{Tt=ni}try{typeof clearTimeout=="function"?At=clearTimeout:At=ii}catch{At=ii}})();function vs(r){if(Tt===setTimeout)return setTimeout(r,0);if((Tt===ni||!Tt)&&setTimeout)return Tt=setTimeout,setTimeout(r,0);try{return Tt(r,0)}catch{try{return Tt.call(null,r,0)}catch{return Tt.call(this,r,0)}}}function za(r){if(At===clearTimeout)return clearTimeout(r);if((At===ii||!At)&&clearTimeout)return At=clearTimeout,clearTimeout(r);try{return At(r)}catch{try{return At.call(null,r)}catch{return At.call(this,r)}}}var Ot=[],Yt=!1,Wt,Hr=-1;function Wa(){!Yt||!Wt||(Yt=!1,Wt.length?Ot=Wt.concat(Ot):Hr=-1,Ot.length&&bs())}function bs(){if(!Yt){var r=vs(Wa);Yt=!0;for(var e=Ot.length;e;){for(Wt=Ot,Ot=[];++Hr<e;)Wt&&Wt[Hr].run();Hr=-1,e=Ot.length}Wt=null,Yt=!1,za(r)}}it.nextTick=function(r){var e=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)e[t-1]=arguments[t];Ot.push(new _s(r,e)),Ot.length===1&&!Yt&&vs(bs)};function _s(r,e){this.fun=r,this.array=e}_s.prototype.run=function(){this.fun.apply(null,this.array)};it.title="browser";it.browser=!0;it.env={};it.argv=[];it.version="";it.versions={};function Dt(){}it.on=Dt;it.addListener=Dt;it.once=Dt;it.off=Dt;it.removeListener=Dt;it.removeAllListeners=Dt;it.emit=Dt;it.prependListener=Dt;it.prependOnceListener=Dt;it.listeners=function(r){return[]};it.binding=function(r){throw new Error("process.binding is not supported")};it.cwd=function(){return"/"};it.chdir=function(r){throw new Error("process.chdir is not supported")};it.umask=function(){return 0};var Ha=ys.exports;const Ue=ja(Ha);var an,Li;function xs(){return Li||(Li=1,an=di.EventEmitter),an}var ln={},br={},Ui;function $a(){if(Ui)return br;Ui=1,br.byteLength=n,br.toByteArray=w,br.fromByteArray=E;for(var r=[],e=[],t=typeof Uint8Array<"u"?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l=0,i=a.length;l<i;++l)r[l]=a[l],e[a.charCodeAt(l)]=l;e[45]=62,e[95]=63;function c(p){var T=p.length;if(T%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var m=p.indexOf("=");m===-1&&(m=T);var S=m===T?0:4-m%4;return[m,S]}function n(p){var T=c(p),m=T[0],S=T[1];return(m+S)*3/4-S}function u(p,T,m){return(T+m)*3/4-m}function w(p){var T,m=c(p),S=m[0],f=m[1],x=new t(u(p,S,f)),k=0,N=f>0?S-4:S,C;for(C=0;C<N;C+=4)T=e[p.charCodeAt(C)]<<18|e[p.charCodeAt(C+1)]<<12|e[p.charCodeAt(C+2)]<<6|e[p.charCodeAt(C+3)],x[k++]=T>>16&255,x[k++]=T>>8&255,x[k++]=T&255;return f===2&&(T=e[p.charCodeAt(C)]<<2|e[p.charCodeAt(C+1)]>>4,x[k++]=T&255),f===1&&(T=e[p.charCodeAt(C)]<<10|e[p.charCodeAt(C+1)]<<4|e[p.charCodeAt(C+2)]>>2,x[k++]=T>>8&255,x[k++]=T&255),x}function y(p){return r[p>>18&63]+r[p>>12&63]+r[p>>6&63]+r[p&63]}function _(p,T,m){for(var S,f=[],x=T;x<m;x+=3)S=(p[x]<<16&16711680)+(p[x+1]<<8&65280)+(p[x+2]&255),f.push(y(S));return f.join("")}function E(p){for(var T,m=p.length,S=m%3,f=[],x=16383,k=0,N=m-S;k<N;k+=x)f.push(_(p,k,k+x>N?N:k+x));return S===1?(T=p[m-1],f.push(r[T>>2]+r[T<<4&63]+"==")):S===2&&(T=(p[m-2]<<8)+p[m-1],f.push(r[T>>10]+r[T>>4&63]+r[T<<2&63]+"=")),f.join("")}return br}var Or={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var Mi;function Va(){return Mi||(Mi=1,Or.read=function(r,e,t,a,l){var i,c,n=l*8-a-1,u=(1<<n)-1,w=u>>1,y=-7,_=t?l-1:0,E=t?-1:1,p=r[e+_];for(_+=E,i=p&(1<<-y)-1,p>>=-y,y+=n;y>0;i=i*256+r[e+_],_+=E,y-=8);for(c=i&(1<<-y)-1,i>>=-y,y+=a;y>0;c=c*256+r[e+_],_+=E,y-=8);if(i===0)i=1-w;else{if(i===u)return c?NaN:(p?-1:1)*(1/0);c=c+Math.pow(2,a),i=i-w}return(p?-1:1)*c*Math.pow(2,i-a)},Or.write=function(r,e,t,a,l,i){var c,n,u,w=i*8-l-1,y=(1<<w)-1,_=y>>1,E=l===23?Math.pow(2,-24)-Math.pow(2,-77):0,p=a?0:i-1,T=a?1:-1,m=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(n=isNaN(e)?1:0,c=y):(c=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-c))<1&&(c--,u*=2),c+_>=1?e+=E/u:e+=E*Math.pow(2,1-_),e*u>=2&&(c++,u/=2),c+_>=y?(n=0,c=y):c+_>=1?(n=(e*u-1)*Math.pow(2,l),c=c+_):(n=e*Math.pow(2,_-1)*Math.pow(2,l),c=0));l>=8;r[t+p]=n&255,p+=T,n/=256,l-=8);for(c=c<<l|n,w+=l;w>0;r[t+p]=c&255,p+=T,c/=256,w-=8);r[t+p-T]|=m*128}),Or}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var ji;function Jr(){return ji||(ji=1,function(r){var e=$a(),t=Va(),a=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;r.Buffer=n,r.SlowBuffer=x,r.INSPECT_MAX_BYTES=50;var l=2147483647;r.kMaxLength=l,n.TYPED_ARRAY_SUPPORT=i(),!n.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function i(){try{var b=new Uint8Array(1),o={foo:function(){return 42}};return Object.setPrototypeOf(o,Uint8Array.prototype),Object.setPrototypeOf(b,o),b.foo()===42}catch{return!1}}Object.defineProperty(n.prototype,"parent",{enumerable:!0,get:function(){if(n.isBuffer(this))return this.buffer}}),Object.defineProperty(n.prototype,"offset",{enumerable:!0,get:function(){if(n.isBuffer(this))return this.byteOffset}});function c(b){if(b>l)throw new RangeError('The value "'+b+'" is invalid for option "size"');var o=new Uint8Array(b);return Object.setPrototypeOf(o,n.prototype),o}function n(b,o,s){if(typeof b=="number"){if(typeof o=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return _(b)}return u(b,o,s)}n.poolSize=8192;function u(b,o,s){if(typeof b=="string")return E(b,o);if(ArrayBuffer.isView(b))return T(b);if(b==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof b);if(se(b,ArrayBuffer)||b&&se(b.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(se(b,SharedArrayBuffer)||b&&se(b.buffer,SharedArrayBuffer)))return m(b,o,s);if(typeof b=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var d=b.valueOf&&b.valueOf();if(d!=null&&d!==b)return n.from(d,o,s);var F=S(b);if(F)return F;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof b[Symbol.toPrimitive]=="function")return n.from(b[Symbol.toPrimitive]("string"),o,s);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof b)}n.from=function(b,o,s){return u(b,o,s)},Object.setPrototypeOf(n.prototype,Uint8Array.prototype),Object.setPrototypeOf(n,Uint8Array);function w(b){if(typeof b!="number")throw new TypeError('"size" argument must be of type number');if(b<0)throw new RangeError('The value "'+b+'" is invalid for option "size"')}function y(b,o,s){return w(b),b<=0?c(b):o!==void 0?typeof s=="string"?c(b).fill(o,s):c(b).fill(o):c(b)}n.alloc=function(b,o,s){return y(b,o,s)};function _(b){return w(b),c(b<0?0:f(b)|0)}n.allocUnsafe=function(b){return _(b)},n.allocUnsafeSlow=function(b){return _(b)};function E(b,o){if((typeof o!="string"||o==="")&&(o="utf8"),!n.isEncoding(o))throw new TypeError("Unknown encoding: "+o);var s=k(b,o)|0,d=c(s),F=d.write(b,o);return F!==s&&(d=d.slice(0,F)),d}function p(b){for(var o=b.length<0?0:f(b.length)|0,s=c(o),d=0;d<o;d+=1)s[d]=b[d]&255;return s}function T(b){if(se(b,Uint8Array)){var o=new Uint8Array(b);return m(o.buffer,o.byteOffset,o.byteLength)}return p(b)}function m(b,o,s){if(o<0||b.byteLength<o)throw new RangeError('"offset" is outside of buffer bounds');if(b.byteLength<o+(s||0))throw new RangeError('"length" is outside of buffer bounds');var d;return o===void 0&&s===void 0?d=new Uint8Array(b):s===void 0?d=new Uint8Array(b,o):d=new Uint8Array(b,o,s),Object.setPrototypeOf(d,n.prototype),d}function S(b){if(n.isBuffer(b)){var o=f(b.length)|0,s=c(o);return s.length===0||b.copy(s,0,0,o),s}if(b.length!==void 0)return typeof b.length!="number"||h(b.length)?c(0):p(b);if(b.type==="Buffer"&&Array.isArray(b.data))return p(b.data)}function f(b){if(b>=l)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+l.toString(16)+" bytes");return b|0}function x(b){return+b!=b&&(b=0),n.alloc(+b)}n.isBuffer=function(o){return o!=null&&o._isBuffer===!0&&o!==n.prototype},n.compare=function(o,s){if(se(o,Uint8Array)&&(o=n.from(o,o.offset,o.byteLength)),se(s,Uint8Array)&&(s=n.from(s,s.offset,s.byteLength)),!n.isBuffer(o)||!n.isBuffer(s))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(o===s)return 0;for(var d=o.length,F=s.length,K=0,L=Math.min(d,F);K<L;++K)if(o[K]!==s[K]){d=o[K],F=s[K];break}return d<F?-1:F<d?1:0},n.isEncoding=function(o){switch(String(o).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},n.concat=function(o,s){if(!Array.isArray(o))throw new TypeError('"list" argument must be an Array of Buffers');if(o.length===0)return n.alloc(0);var d;if(s===void 0)for(s=0,d=0;d<o.length;++d)s+=o[d].length;var F=n.allocUnsafe(s),K=0;for(d=0;d<o.length;++d){var L=o[d];if(se(L,Uint8Array))K+L.length>F.length?n.from(L).copy(F,K):Uint8Array.prototype.set.call(F,L,K);else if(n.isBuffer(L))L.copy(F,K);else throw new TypeError('"list" argument must be an Array of Buffers');K+=L.length}return F};function k(b,o){if(n.isBuffer(b))return b.length;if(ArrayBuffer.isView(b)||se(b,ArrayBuffer))return b.byteLength;if(typeof b!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof b);var s=b.length,d=arguments.length>2&&arguments[2]===!0;if(!d&&s===0)return 0;for(var F=!1;;)switch(o){case"ascii":case"latin1":case"binary":return s;case"utf8":case"utf-8":return g(b).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return s*2;case"hex":return s>>>1;case"base64":return O(b).length;default:if(F)return d?-1:g(b).length;o=(""+o).toLowerCase(),F=!0}}n.byteLength=k;function N(b,o,s){var d=!1;if((o===void 0||o<0)&&(o=0),o>this.length||((s===void 0||s>this.length)&&(s=this.length),s<=0)||(s>>>=0,o>>>=0,s<=o))return"";for(b||(b="utf8");;)switch(b){case"hex":return Y(this,o,s);case"utf8":case"utf-8":return A(this,o,s);case"ascii":return G(this,o,s);case"latin1":case"binary":return we(this,o,s);case"base64":return V(this,o,s);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return te(this,o,s);default:if(d)throw new TypeError("Unknown encoding: "+b);b=(b+"").toLowerCase(),d=!0}}n.prototype._isBuffer=!0;function C(b,o,s){var d=b[o];b[o]=b[s],b[s]=d}n.prototype.swap16=function(){var o=this.length;if(o%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var s=0;s<o;s+=2)C(this,s,s+1);return this},n.prototype.swap32=function(){var o=this.length;if(o%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var s=0;s<o;s+=4)C(this,s,s+3),C(this,s+1,s+2);return this},n.prototype.swap64=function(){var o=this.length;if(o%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var s=0;s<o;s+=8)C(this,s,s+7),C(this,s+1,s+6),C(this,s+2,s+5),C(this,s+3,s+4);return this},n.prototype.toString=function(){var o=this.length;return o===0?"":arguments.length===0?A(this,0,o):N.apply(this,arguments)},n.prototype.toLocaleString=n.prototype.toString,n.prototype.equals=function(o){if(!n.isBuffer(o))throw new TypeError("Argument must be a Buffer");return this===o?!0:n.compare(this,o)===0},n.prototype.inspect=function(){var o="",s=r.INSPECT_MAX_BYTES;return o=this.toString("hex",0,s).replace(/(.{2})/g,"$1 ").trim(),this.length>s&&(o+=" ... "),"<Buffer "+o+">"},a&&(n.prototype[a]=n.prototype.inspect),n.prototype.compare=function(o,s,d,F,K){if(se(o,Uint8Array)&&(o=n.from(o,o.offset,o.byteLength)),!n.isBuffer(o))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof o);if(s===void 0&&(s=0),d===void 0&&(d=o?o.length:0),F===void 0&&(F=0),K===void 0&&(K=this.length),s<0||d>o.length||F<0||K>this.length)throw new RangeError("out of range index");if(F>=K&&s>=d)return 0;if(F>=K)return-1;if(s>=d)return 1;if(s>>>=0,d>>>=0,F>>>=0,K>>>=0,this===o)return 0;for(var L=K-F,ue=d-s,ve=Math.min(L,ue),ae=this.slice(F,K),Ee=o.slice(s,d),ke=0;ke<ve;++ke)if(ae[ke]!==Ee[ke]){L=ae[ke],ue=Ee[ke];break}return L<ue?-1:ue<L?1:0};function H(b,o,s,d,F){if(b.length===0)return-1;if(typeof s=="string"?(d=s,s=0):s>2147483647?s=2147483647:s<-2147483648&&(s=-2147483648),s=+s,h(s)&&(s=F?0:b.length-1),s<0&&(s=b.length+s),s>=b.length){if(F)return-1;s=b.length-1}else if(s<0)if(F)s=0;else return-1;if(typeof o=="string"&&(o=n.from(o,d)),n.isBuffer(o))return o.length===0?-1:$(b,o,s,d,F);if(typeof o=="number")return o=o&255,typeof Uint8Array.prototype.indexOf=="function"?F?Uint8Array.prototype.indexOf.call(b,o,s):Uint8Array.prototype.lastIndexOf.call(b,o,s):$(b,[o],s,d,F);throw new TypeError("val must be string, number or Buffer")}function $(b,o,s,d,F){var K=1,L=b.length,ue=o.length;if(d!==void 0&&(d=String(d).toLowerCase(),d==="ucs2"||d==="ucs-2"||d==="utf16le"||d==="utf-16le")){if(b.length<2||o.length<2)return-1;K=2,L/=2,ue/=2,s/=2}function ve(ot,mt){return K===1?ot[mt]:ot.readUInt16BE(mt*K)}var ae;if(F){var Ee=-1;for(ae=s;ae<L;ae++)if(ve(b,ae)===ve(o,Ee===-1?0:ae-Ee)){if(Ee===-1&&(Ee=ae),ae-Ee+1===ue)return Ee*K}else Ee!==-1&&(ae-=ae-Ee),Ee=-1}else for(s+ue>L&&(s=L-ue),ae=s;ae>=0;ae--){for(var ke=!0,Ne=0;Ne<ue;Ne++)if(ve(b,ae+Ne)!==ve(o,Ne)){ke=!1;break}if(ke)return ae}return-1}n.prototype.includes=function(o,s,d){return this.indexOf(o,s,d)!==-1},n.prototype.indexOf=function(o,s,d){return H(this,o,s,d,!0)},n.prototype.lastIndexOf=function(o,s,d){return H(this,o,s,d,!1)};function Z(b,o,s,d){s=Number(s)||0;var F=b.length-s;d?(d=Number(d),d>F&&(d=F)):d=F;var K=o.length;d>K/2&&(d=K/2);for(var L=0;L<d;++L){var ue=parseInt(o.substr(L*2,2),16);if(h(ue))return L;b[s+L]=ue}return L}function R(b,o,s,d){return B(g(o,b.length-s),b,s,d)}function ce(b,o,s,d){return B(U(o),b,s,d)}function ge(b,o,s,d){return B(O(o),b,s,d)}function I(b,o,s,d){return B(P(o,b.length-s),b,s,d)}n.prototype.write=function(o,s,d,F){if(s===void 0)F="utf8",d=this.length,s=0;else if(d===void 0&&typeof s=="string")F=s,d=this.length,s=0;else if(isFinite(s))s=s>>>0,isFinite(d)?(d=d>>>0,F===void 0&&(F="utf8")):(F=d,d=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var K=this.length-s;if((d===void 0||d>K)&&(d=K),o.length>0&&(d<0||s<0)||s>this.length)throw new RangeError("Attempt to write outside buffer bounds");F||(F="utf8");for(var L=!1;;)switch(F){case"hex":return Z(this,o,s,d);case"utf8":case"utf-8":return R(this,o,s,d);case"ascii":case"latin1":case"binary":return ce(this,o,s,d);case"base64":return ge(this,o,s,d);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,o,s,d);default:if(L)throw new TypeError("Unknown encoding: "+F);F=(""+F).toLowerCase(),L=!0}},n.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function V(b,o,s){return o===0&&s===b.length?e.fromByteArray(b):e.fromByteArray(b.slice(o,s))}function A(b,o,s){s=Math.min(b.length,s);for(var d=[],F=o;F<s;){var K=b[F],L=null,ue=K>239?4:K>223?3:K>191?2:1;if(F+ue<=s){var ve,ae,Ee,ke;switch(ue){case 1:K<128&&(L=K);break;case 2:ve=b[F+1],(ve&192)===128&&(ke=(K&31)<<6|ve&63,ke>127&&(L=ke));break;case 3:ve=b[F+1],ae=b[F+2],(ve&192)===128&&(ae&192)===128&&(ke=(K&15)<<12|(ve&63)<<6|ae&63,ke>2047&&(ke<55296||ke>57343)&&(L=ke));break;case 4:ve=b[F+1],ae=b[F+2],Ee=b[F+3],(ve&192)===128&&(ae&192)===128&&(Ee&192)===128&&(ke=(K&15)<<18|(ve&63)<<12|(ae&63)<<6|Ee&63,ke>65535&&ke<1114112&&(L=ke))}}L===null?(L=65533,ue=1):L>65535&&(L-=65536,d.push(L>>>10&1023|55296),L=56320|L&1023),d.push(L),F+=ue}return oe(d)}var j=4096;function oe(b){var o=b.length;if(o<=j)return String.fromCharCode.apply(String,b);for(var s="",d=0;d<o;)s+=String.fromCharCode.apply(String,b.slice(d,d+=j));return s}function G(b,o,s){var d="";s=Math.min(b.length,s);for(var F=o;F<s;++F)d+=String.fromCharCode(b[F]&127);return d}function we(b,o,s){var d="";s=Math.min(b.length,s);for(var F=o;F<s;++F)d+=String.fromCharCode(b[F]);return d}function Y(b,o,s){var d=b.length;(!o||o<0)&&(o=0),(!s||s<0||s>d)&&(s=d);for(var F="",K=o;K<s;++K)F+=Q[b[K]];return F}function te(b,o,s){for(var d=b.slice(o,s),F="",K=0;K<d.length-1;K+=2)F+=String.fromCharCode(d[K]+d[K+1]*256);return F}n.prototype.slice=function(o,s){var d=this.length;o=~~o,s=s===void 0?d:~~s,o<0?(o+=d,o<0&&(o=0)):o>d&&(o=d),s<0?(s+=d,s<0&&(s=0)):s>d&&(s=d),s<o&&(s=o);var F=this.subarray(o,s);return Object.setPrototypeOf(F,n.prototype),F};function M(b,o,s){if(b%1!==0||b<0)throw new RangeError("offset is not uint");if(b+o>s)throw new RangeError("Trying to access beyond buffer length")}n.prototype.readUintLE=n.prototype.readUIntLE=function(o,s,d){o=o>>>0,s=s>>>0,d||M(o,s,this.length);for(var F=this[o],K=1,L=0;++L<s&&(K*=256);)F+=this[o+L]*K;return F},n.prototype.readUintBE=n.prototype.readUIntBE=function(o,s,d){o=o>>>0,s=s>>>0,d||M(o,s,this.length);for(var F=this[o+--s],K=1;s>0&&(K*=256);)F+=this[o+--s]*K;return F},n.prototype.readUint8=n.prototype.readUInt8=function(o,s){return o=o>>>0,s||M(o,1,this.length),this[o]},n.prototype.readUint16LE=n.prototype.readUInt16LE=function(o,s){return o=o>>>0,s||M(o,2,this.length),this[o]|this[o+1]<<8},n.prototype.readUint16BE=n.prototype.readUInt16BE=function(o,s){return o=o>>>0,s||M(o,2,this.length),this[o]<<8|this[o+1]},n.prototype.readUint32LE=n.prototype.readUInt32LE=function(o,s){return o=o>>>0,s||M(o,4,this.length),(this[o]|this[o+1]<<8|this[o+2]<<16)+this[o+3]*16777216},n.prototype.readUint32BE=n.prototype.readUInt32BE=function(o,s){return o=o>>>0,s||M(o,4,this.length),this[o]*16777216+(this[o+1]<<16|this[o+2]<<8|this[o+3])},n.prototype.readIntLE=function(o,s,d){o=o>>>0,s=s>>>0,d||M(o,s,this.length);for(var F=this[o],K=1,L=0;++L<s&&(K*=256);)F+=this[o+L]*K;return K*=128,F>=K&&(F-=Math.pow(2,8*s)),F},n.prototype.readIntBE=function(o,s,d){o=o>>>0,s=s>>>0,d||M(o,s,this.length);for(var F=s,K=1,L=this[o+--F];F>0&&(K*=256);)L+=this[o+--F]*K;return K*=128,L>=K&&(L-=Math.pow(2,8*s)),L},n.prototype.readInt8=function(o,s){return o=o>>>0,s||M(o,1,this.length),this[o]&128?(255-this[o]+1)*-1:this[o]},n.prototype.readInt16LE=function(o,s){o=o>>>0,s||M(o,2,this.length);var d=this[o]|this[o+1]<<8;return d&32768?d|4294901760:d},n.prototype.readInt16BE=function(o,s){o=o>>>0,s||M(o,2,this.length);var d=this[o+1]|this[o]<<8;return d&32768?d|4294901760:d},n.prototype.readInt32LE=function(o,s){return o=o>>>0,s||M(o,4,this.length),this[o]|this[o+1]<<8|this[o+2]<<16|this[o+3]<<24},n.prototype.readInt32BE=function(o,s){return o=o>>>0,s||M(o,4,this.length),this[o]<<24|this[o+1]<<16|this[o+2]<<8|this[o+3]},n.prototype.readFloatLE=function(o,s){return o=o>>>0,s||M(o,4,this.length),t.read(this,o,!0,23,4)},n.prototype.readFloatBE=function(o,s){return o=o>>>0,s||M(o,4,this.length),t.read(this,o,!1,23,4)},n.prototype.readDoubleLE=function(o,s){return o=o>>>0,s||M(o,8,this.length),t.read(this,o,!0,52,8)},n.prototype.readDoubleBE=function(o,s){return o=o>>>0,s||M(o,8,this.length),t.read(this,o,!1,52,8)};function D(b,o,s,d,F,K){if(!n.isBuffer(b))throw new TypeError('"buffer" argument must be a Buffer instance');if(o>F||o<K)throw new RangeError('"value" argument is out of bounds');if(s+d>b.length)throw new RangeError("Index out of range")}n.prototype.writeUintLE=n.prototype.writeUIntLE=function(o,s,d,F){if(o=+o,s=s>>>0,d=d>>>0,!F){var K=Math.pow(2,8*d)-1;D(this,o,s,d,K,0)}var L=1,ue=0;for(this[s]=o&255;++ue<d&&(L*=256);)this[s+ue]=o/L&255;return s+d},n.prototype.writeUintBE=n.prototype.writeUIntBE=function(o,s,d,F){if(o=+o,s=s>>>0,d=d>>>0,!F){var K=Math.pow(2,8*d)-1;D(this,o,s,d,K,0)}var L=d-1,ue=1;for(this[s+L]=o&255;--L>=0&&(ue*=256);)this[s+L]=o/ue&255;return s+d},n.prototype.writeUint8=n.prototype.writeUInt8=function(o,s,d){return o=+o,s=s>>>0,d||D(this,o,s,1,255,0),this[s]=o&255,s+1},n.prototype.writeUint16LE=n.prototype.writeUInt16LE=function(o,s,d){return o=+o,s=s>>>0,d||D(this,o,s,2,65535,0),this[s]=o&255,this[s+1]=o>>>8,s+2},n.prototype.writeUint16BE=n.prototype.writeUInt16BE=function(o,s,d){return o=+o,s=s>>>0,d||D(this,o,s,2,65535,0),this[s]=o>>>8,this[s+1]=o&255,s+2},n.prototype.writeUint32LE=n.prototype.writeUInt32LE=function(o,s,d){return o=+o,s=s>>>0,d||D(this,o,s,4,4294967295,0),this[s+3]=o>>>24,this[s+2]=o>>>16,this[s+1]=o>>>8,this[s]=o&255,s+4},n.prototype.writeUint32BE=n.prototype.writeUInt32BE=function(o,s,d){return o=+o,s=s>>>0,d||D(this,o,s,4,4294967295,0),this[s]=o>>>24,this[s+1]=o>>>16,this[s+2]=o>>>8,this[s+3]=o&255,s+4},n.prototype.writeIntLE=function(o,s,d,F){if(o=+o,s=s>>>0,!F){var K=Math.pow(2,8*d-1);D(this,o,s,d,K-1,-K)}var L=0,ue=1,ve=0;for(this[s]=o&255;++L<d&&(ue*=256);)o<0&&ve===0&&this[s+L-1]!==0&&(ve=1),this[s+L]=(o/ue>>0)-ve&255;return s+d},n.prototype.writeIntBE=function(o,s,d,F){if(o=+o,s=s>>>0,!F){var K=Math.pow(2,8*d-1);D(this,o,s,d,K-1,-K)}var L=d-1,ue=1,ve=0;for(this[s+L]=o&255;--L>=0&&(ue*=256);)o<0&&ve===0&&this[s+L+1]!==0&&(ve=1),this[s+L]=(o/ue>>0)-ve&255;return s+d},n.prototype.writeInt8=function(o,s,d){return o=+o,s=s>>>0,d||D(this,o,s,1,127,-128),o<0&&(o=255+o+1),this[s]=o&255,s+1},n.prototype.writeInt16LE=function(o,s,d){return o=+o,s=s>>>0,d||D(this,o,s,2,32767,-32768),this[s]=o&255,this[s+1]=o>>>8,s+2},n.prototype.writeInt16BE=function(o,s,d){return o=+o,s=s>>>0,d||D(this,o,s,2,32767,-32768),this[s]=o>>>8,this[s+1]=o&255,s+2},n.prototype.writeInt32LE=function(o,s,d){return o=+o,s=s>>>0,d||D(this,o,s,4,2147483647,-2147483648),this[s]=o&255,this[s+1]=o>>>8,this[s+2]=o>>>16,this[s+3]=o>>>24,s+4},n.prototype.writeInt32BE=function(o,s,d){return o=+o,s=s>>>0,d||D(this,o,s,4,2147483647,-2147483648),o<0&&(o=4294967295+o+1),this[s]=o>>>24,this[s+1]=o>>>16,this[s+2]=o>>>8,this[s+3]=o&255,s+4};function q(b,o,s,d,F,K){if(s+d>b.length)throw new RangeError("Index out of range");if(s<0)throw new RangeError("Index out of range")}function X(b,o,s,d,F){return o=+o,s=s>>>0,F||q(b,o,s,4),t.write(b,o,s,d,23,4),s+4}n.prototype.writeFloatLE=function(o,s,d){return X(this,o,s,!0,d)},n.prototype.writeFloatBE=function(o,s,d){return X(this,o,s,!1,d)};function ie(b,o,s,d,F){return o=+o,s=s>>>0,F||q(b,o,s,8),t.write(b,o,s,d,52,8),s+8}n.prototype.writeDoubleLE=function(o,s,d){return ie(this,o,s,!0,d)},n.prototype.writeDoubleBE=function(o,s,d){return ie(this,o,s,!1,d)},n.prototype.copy=function(o,s,d,F){if(!n.isBuffer(o))throw new TypeError("argument should be a Buffer");if(d||(d=0),!F&&F!==0&&(F=this.length),s>=o.length&&(s=o.length),s||(s=0),F>0&&F<d&&(F=d),F===d||o.length===0||this.length===0)return 0;if(s<0)throw new RangeError("targetStart out of bounds");if(d<0||d>=this.length)throw new RangeError("Index out of range");if(F<0)throw new RangeError("sourceEnd out of bounds");F>this.length&&(F=this.length),o.length-s<F-d&&(F=o.length-s+d);var K=F-d;return this===o&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(s,d,F):Uint8Array.prototype.set.call(o,this.subarray(d,F),s),K},n.prototype.fill=function(o,s,d,F){if(typeof o=="string"){if(typeof s=="string"?(F=s,s=0,d=this.length):typeof d=="string"&&(F=d,d=this.length),F!==void 0&&typeof F!="string")throw new TypeError("encoding must be a string");if(typeof F=="string"&&!n.isEncoding(F))throw new TypeError("Unknown encoding: "+F);if(o.length===1){var K=o.charCodeAt(0);(F==="utf8"&&K<128||F==="latin1")&&(o=K)}}else typeof o=="number"?o=o&255:typeof o=="boolean"&&(o=Number(o));if(s<0||this.length<s||this.length<d)throw new RangeError("Out of range index");if(d<=s)return this;s=s>>>0,d=d===void 0?this.length:d>>>0,o||(o=0);var L;if(typeof o=="number")for(L=s;L<d;++L)this[L]=o;else{var ue=n.isBuffer(o)?o:n.from(o,F),ve=ue.length;if(ve===0)throw new TypeError('The value "'+o+'" is invalid for argument "value"');for(L=0;L<d-s;++L)this[L+s]=ue[L%ve]}return this};var z=/[^+/0-9A-Za-z-_]/g;function v(b){if(b=b.split("=")[0],b=b.trim().replace(z,""),b.length<2)return"";for(;b.length%4!==0;)b=b+"=";return b}function g(b,o){o=o||1/0;for(var s,d=b.length,F=null,K=[],L=0;L<d;++L){if(s=b.charCodeAt(L),s>55295&&s<57344){if(!F){if(s>56319){(o-=3)>-1&&K.push(239,191,189);continue}else if(L+1===d){(o-=3)>-1&&K.push(239,191,189);continue}F=s;continue}if(s<56320){(o-=3)>-1&&K.push(239,191,189),F=s;continue}s=(F-55296<<10|s-56320)+65536}else F&&(o-=3)>-1&&K.push(239,191,189);if(F=null,s<128){if((o-=1)<0)break;K.push(s)}else if(s<2048){if((o-=2)<0)break;K.push(s>>6|192,s&63|128)}else if(s<65536){if((o-=3)<0)break;K.push(s>>12|224,s>>6&63|128,s&63|128)}else if(s<1114112){if((o-=4)<0)break;K.push(s>>18|240,s>>12&63|128,s>>6&63|128,s&63|128)}else throw new Error("Invalid code point")}return K}function U(b){for(var o=[],s=0;s<b.length;++s)o.push(b.charCodeAt(s)&255);return o}function P(b,o){for(var s,d,F,K=[],L=0;L<b.length&&!((o-=2)<0);++L)s=b.charCodeAt(L),d=s>>8,F=s%256,K.push(F),K.push(d);return K}function O(b){return e.toByteArray(v(b))}function B(b,o,s,d){for(var F=0;F<d&&!(F+s>=o.length||F>=b.length);++F)o[F+s]=b[F];return F}function se(b,o){return b instanceof o||b!=null&&b.constructor!=null&&b.constructor.name!=null&&b.constructor.name===o.name}function h(b){return b!==b}var Q=function(){for(var b="0123456789abcdef",o=new Array(256),s=0;s<16;++s)for(var d=s*16,F=0;F<16;++F)o[d+F]=b[s]+b[F];return o}()}(ln)),ln}var cn={},un={},fn,zi;function Es(){return zi||(zi=1,fn=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},t=Symbol("test"),a=Object(t);if(typeof t=="string"||Object.prototype.toString.call(t)!=="[object Symbol]"||Object.prototype.toString.call(a)!=="[object Symbol]")return!1;var l=42;e[t]=l;for(t in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var i=Object.getOwnPropertySymbols(e);if(i.length!==1||i[0]!==t||!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var c=Object.getOwnPropertyDescriptor(e,t);if(c.value!==l||c.enumerable!==!0)return!1}return!0}),fn}var hn,Wi;function pi(){if(Wi)return hn;Wi=1;var r=Es();return hn=function(){return r()&&!!Symbol.toStringTag},hn}var dn,Hi;function Ka(){if(Hi)return dn;Hi=1;var r=typeof Symbol<"u"&&Symbol,e=Es();return dn=function(){return typeof r!="function"||typeof Symbol!="function"||typeof r("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:e()},dn}var pn,$i;function Ga(){if($i)return pn;$i=1;var r={foo:{}},e=Object;return pn=function(){return{__proto__:r}.foo===r.foo&&!({__proto__:null}instanceof e)},pn}var mn,Vi;function qa(){if(Vi)return mn;Vi=1;var r="Function.prototype.bind called on incompatible ",e=Object.prototype.toString,t=Math.max,a="[object Function]",l=function(u,w){for(var y=[],_=0;_<u.length;_+=1)y[_]=u[_];for(var E=0;E<w.length;E+=1)y[E+u.length]=w[E];return y},i=function(u,w){for(var y=[],_=w,E=0;_<u.length;_+=1,E+=1)y[E]=u[_];return y},c=function(n,u){for(var w="",y=0;y<n.length;y+=1)w+=n[y],y+1<n.length&&(w+=u);return w};return mn=function(u){var w=this;if(typeof w!="function"||e.apply(w)!==a)throw new TypeError(r+w);for(var y=i(arguments,1),_,E=function(){if(this instanceof _){var f=w.apply(this,l(y,arguments));return Object(f)===f?f:this}return w.apply(u,l(y,arguments))},p=t(0,w.length-y.length),T=[],m=0;m<p;m++)T[m]="$"+m;if(_=Function("binder","return function ("+c(T,",")+"){ return binder.apply(this,arguments); }")(E),w.prototype){var S=function(){};S.prototype=w.prototype,_.prototype=new S,S.prototype=null}return _},mn}var gn,Ki;function mi(){if(Ki)return gn;Ki=1;var r=qa();return gn=Function.prototype.bind||r,gn}var wn,Gi;function Xa(){if(Gi)return wn;Gi=1;var r=Function.prototype.call,e=Object.prototype.hasOwnProperty,t=mi();return wn=t.call(r,e),wn}var yn,qi;function dr(){if(qi)return yn;qi=1;var r,e=SyntaxError,t=Function,a=TypeError,l=function(I){try{return t('"use strict"; return ('+I+").constructor;")()}catch{}},i=Object.getOwnPropertyDescriptor;if(i)try{i({},"")}catch{i=null}var c=function(){throw new a},n=i?function(){try{return arguments.callee,c}catch{try{return i(arguments,"callee").get}catch{return c}}}():c,u=Ka()(),w=Ga()(),y=Object.getPrototypeOf||(w?function(I){return I.__proto__}:null),_={},E=typeof Uint8Array>"u"||!y?r:y(Uint8Array),p={"%AggregateError%":typeof AggregateError>"u"?r:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?r:ArrayBuffer,"%ArrayIteratorPrototype%":u&&y?y([][Symbol.iterator]()):r,"%AsyncFromSyncIteratorPrototype%":r,"%AsyncFunction%":_,"%AsyncGenerator%":_,"%AsyncGeneratorFunction%":_,"%AsyncIteratorPrototype%":_,"%Atomics%":typeof Atomics>"u"?r:Atomics,"%BigInt%":typeof BigInt>"u"?r:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?r:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?r:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?r:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?r:Float32Array,"%Float64Array%":typeof Float64Array>"u"?r:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?r:FinalizationRegistry,"%Function%":t,"%GeneratorFunction%":_,"%Int8Array%":typeof Int8Array>"u"?r:Int8Array,"%Int16Array%":typeof Int16Array>"u"?r:Int16Array,"%Int32Array%":typeof Int32Array>"u"?r:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":u&&y?y(y([][Symbol.iterator]())):r,"%JSON%":typeof JSON=="object"?JSON:r,"%Map%":typeof Map>"u"?r:Map,"%MapIteratorPrototype%":typeof Map>"u"||!u||!y?r:y(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?r:Promise,"%Proxy%":typeof Proxy>"u"?r:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?r:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?r:Set,"%SetIteratorPrototype%":typeof Set>"u"||!u||!y?r:y(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?r:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":u&&y?y(""[Symbol.iterator]()):r,"%Symbol%":u?Symbol:r,"%SyntaxError%":e,"%ThrowTypeError%":n,"%TypedArray%":E,"%TypeError%":a,"%Uint8Array%":typeof Uint8Array>"u"?r:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?r:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?r:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?r:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?r:WeakMap,"%WeakRef%":typeof WeakRef>"u"?r:WeakRef,"%WeakSet%":typeof WeakSet>"u"?r:WeakSet};if(y)try{null.error}catch(I){var T=y(y(I));p["%Error.prototype%"]=T}var m=function I(V){var A;if(V==="%AsyncFunction%")A=l("async function () {}");else if(V==="%GeneratorFunction%")A=l("function* () {}");else if(V==="%AsyncGeneratorFunction%")A=l("async function* () {}");else if(V==="%AsyncGenerator%"){var j=I("%AsyncGeneratorFunction%");j&&(A=j.prototype)}else if(V==="%AsyncIteratorPrototype%"){var oe=I("%AsyncGenerator%");oe&&y&&(A=y(oe.prototype))}return p[V]=A,A},S={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},f=mi(),x=Xa(),k=f.call(Function.call,Array.prototype.concat),N=f.call(Function.apply,Array.prototype.splice),C=f.call(Function.call,String.prototype.replace),H=f.call(Function.call,String.prototype.slice),$=f.call(Function.call,RegExp.prototype.exec),Z=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,R=/\\(\\)?/g,ce=function(V){var A=H(V,0,1),j=H(V,-1);if(A==="%"&&j!=="%")throw new e("invalid intrinsic syntax, expected closing `%`");if(j==="%"&&A!=="%")throw new e("invalid intrinsic syntax, expected opening `%`");var oe=[];return C(V,Z,function(G,we,Y,te){oe[oe.length]=Y?C(te,R,"$1"):we||G}),oe},ge=function(V,A){var j=V,oe;if(x(S,j)&&(oe=S[j],j="%"+oe[0]+"%"),x(p,j)){var G=p[j];if(G===_&&(G=m(j)),typeof G>"u"&&!A)throw new a("intrinsic "+V+" exists, but is not available. Please file an issue!");return{alias:oe,name:j,value:G}}throw new e("intrinsic "+V+" does not exist!")};return yn=function(V,A){if(typeof V!="string"||V.length===0)throw new a("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof A!="boolean")throw new a('"allowMissing" argument must be a boolean');if($(/^%?[^%]*%?$/,V)===null)throw new e("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var j=ce(V),oe=j.length>0?j[0]:"",G=ge("%"+oe+"%",A),we=G.name,Y=G.value,te=!1,M=G.alias;M&&(oe=M[0],N(j,k([0,1],M)));for(var D=1,q=!0;D<j.length;D+=1){var X=j[D],ie=H(X,0,1),z=H(X,-1);if((ie==='"'||ie==="'"||ie==="`"||z==='"'||z==="'"||z==="`")&&ie!==z)throw new e("property names with quotes must have matching quotes");if((X==="constructor"||!q)&&(te=!0),oe+="."+X,we="%"+oe+"%",x(p,we))Y=p[we];else if(Y!=null){if(!(X in Y)){if(!A)throw new a("base intrinsic for "+V+" exists, but the property is not available.");return}if(i&&D+1>=j.length){var v=i(Y,X);q=!!v,q&&"get"in v&&!("originalValue"in v.get)?Y=v.get:Y=Y[X]}else q=x(Y,X),Y=Y[X];q&&!te&&(p[we]=Y)}}return Y},yn}var vn={exports:{}},bn,Xi;function Ts(){if(Xi)return bn;Xi=1;var r=dr(),e=r("%Object.defineProperty%",!0),t=function(){if(e)try{return e({},"a",{value:1}),!0}catch{return!1}return!1};return t.hasArrayLengthDefineBug=function(){if(!t())return null;try{return e([],"length",{value:1}).length!==1}catch{return!0}},bn=t,bn}var _n,Zi;function gi(){if(Zi)return _n;Zi=1;var r=dr(),e=r("%Object.getOwnPropertyDescriptor%",!0);if(e)try{e([],"length")}catch{e=null}return _n=e,_n}var xn,Yi;function Za(){if(Yi)return xn;Yi=1;var r=Ts()(),e=dr(),t=r&&e("%Object.defineProperty%",!0);if(t)try{t({},"a",{value:1})}catch{t=!1}var a=e("%SyntaxError%"),l=e("%TypeError%"),i=gi();return xn=function(n,u,w){if(!n||typeof n!="object"&&typeof n!="function")throw new l("`obj` must be an object or a function`");if(typeof u!="string"&&typeof u!="symbol")throw new l("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new l("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new l("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new l("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new l("`loose`, if provided, must be a boolean");var y=arguments.length>3?arguments[3]:null,_=arguments.length>4?arguments[4]:null,E=arguments.length>5?arguments[5]:null,p=arguments.length>6?arguments[6]:!1,T=!!i&&i(n,u);if(t)t(n,u,{configurable:E===null&&T?T.configurable:!E,enumerable:y===null&&T?T.enumerable:!y,value:w,writable:_===null&&T?T.writable:!_});else if(p||!y&&!_&&!E)n[u]=w;else throw new a("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},xn}var En,Ji;function Ya(){if(Ji)return En;Ji=1;var r=dr(),e=Za(),t=Ts()(),a=gi(),l=r("%TypeError%"),i=r("%Math.floor%");return En=function(n,u){if(typeof n!="function")throw new l("`fn` is not a function");if(typeof u!="number"||u<0||u>4294967295||i(u)!==u)throw new l("`length` must be a positive 32-bit integer");var w=arguments.length>2&&!!arguments[2],y=!0,_=!0;if("length"in n&&a){var E=a(n,"length");E&&!E.configurable&&(y=!1),E&&!E.writable&&(_=!1)}return(y||_||!w)&&(t?e(n,"length",u,!0,!0):e(n,"length",u)),n},En}var Qi;function As(){return Qi||(Qi=1,function(r){var e=mi(),t=dr(),a=Ya(),l=t("%TypeError%"),i=t("%Function.prototype.apply%"),c=t("%Function.prototype.call%"),n=t("%Reflect.apply%",!0)||e.call(c,i),u=t("%Object.defineProperty%",!0),w=t("%Math.max%");if(u)try{u({},"a",{value:1})}catch{u=null}r.exports=function(E){if(typeof E!="function")throw new l("a function is required");var p=n(e,c,arguments);return a(p,1+w(0,E.length-(arguments.length-1)),!0)};var y=function(){return n(e,i,arguments)};u?u(r.exports,"apply",{value:y}):r.exports.apply=y}(vn)),vn.exports}var Tn,eo;function Ss(){if(eo)return Tn;eo=1;var r=dr(),e=As(),t=e(r("String.prototype.indexOf"));return Tn=function(l,i){var c=r(l,!!i);return typeof c=="function"&&t(l,".prototype.")>-1?e(c):c},Tn}var An,to;function Ja(){if(to)return An;to=1;var r=pi()(),e=Ss(),t=e("Object.prototype.toString"),a=function(n){return r&&n&&typeof n=="object"&&Symbol.toStringTag in n?!1:t(n)==="[object Arguments]"},l=function(n){return a(n)?!0:n!==null&&typeof n=="object"&&typeof n.length=="number"&&n.length>=0&&t(n)!=="[object Array]"&&t(n.callee)==="[object Function]"},i=function(){return a(arguments)}();return a.isLegacyArguments=l,An=i?a:l,An}var Sn,ro;function Qa(){if(ro)return Sn;ro=1;var r=Object.prototype.toString,e=Function.prototype.toString,t=/^\s*(?:function)?\*/,a=pi()(),l=Object.getPrototypeOf,i=function(){if(!a)return!1;try{return Function("return function*() {}")()}catch{}},c;return Sn=function(u){if(typeof u!="function")return!1;if(t.test(e.call(u)))return!0;if(!a){var w=r.call(u);return w==="[object GeneratorFunction]"}if(!l)return!1;if(typeof c>"u"){var y=i();c=y?l(y):!1}return l(u)===c},Sn}var kn,no;function el(){if(no)return kn;no=1;var r=Function.prototype.toString,e=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,t,a;if(typeof e=="function"&&typeof Object.defineProperty=="function")try{t=Object.defineProperty({},"length",{get:function(){throw a}}),a={},e(function(){throw 42},null,t)}catch(x){x!==a&&(e=null)}else e=null;var l=/^\s*class\b/,i=function(k){try{var N=r.call(k);return l.test(N)}catch{return!1}},c=function(k){try{return i(k)?!1:(r.call(k),!0)}catch{return!1}},n=Object.prototype.toString,u="[object Object]",w="[object Function]",y="[object GeneratorFunction]",_="[object HTMLAllCollection]",E="[object HTML document.all class]",p="[object HTMLCollection]",T=typeof Symbol=="function"&&!!Symbol.toStringTag,m=!(0 in[,]),S=function(){return!1};if(typeof document=="object"){var f=document.all;n.call(f)===n.call(document.all)&&(S=function(k){if((m||!k)&&(typeof k>"u"||typeof k=="object"))try{var N=n.call(k);return(N===_||N===E||N===p||N===u)&&k("")==null}catch{}return!1})}return kn=e?function(k){if(S(k))return!0;if(!k||typeof k!="function"&&typeof k!="object")return!1;try{e(k,null,t)}catch(N){if(N!==a)return!1}return!i(k)&&c(k)}:function(k){if(S(k))return!0;if(!k||typeof k!="function"&&typeof k!="object")return!1;if(T)return c(k);if(i(k))return!1;var N=n.call(k);return N!==w&&N!==y&&!/^\[object HTML/.test(N)?!1:c(k)},kn}var Cn,io;function tl(){if(io)return Cn;io=1;var r=el(),e=Object.prototype.toString,t=Object.prototype.hasOwnProperty,a=function(u,w,y){for(var _=0,E=u.length;_<E;_++)t.call(u,_)&&(y==null?w(u[_],_,u):w.call(y,u[_],_,u))},l=function(u,w,y){for(var _=0,E=u.length;_<E;_++)y==null?w(u.charAt(_),_,u):w.call(y,u.charAt(_),_,u)},i=function(u,w,y){for(var _ in u)t.call(u,_)&&(y==null?w(u[_],_,u):w.call(y,u[_],_,u))},c=function(u,w,y){if(!r(w))throw new TypeError("iterator must be a function");var _;arguments.length>=3&&(_=y),e.call(u)==="[object Array]"?a(u,w,_):typeof u=="string"?l(u,w,_):i(u,w,_)};return Cn=c,Cn}var Rn,oo;function rl(){if(oo)return Rn;oo=1;var r=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"],e=typeof globalThis>"u"?Rt:globalThis;return Rn=function(){for(var a=[],l=0;l<r.length;l++)typeof e[r[l]]=="function"&&(a[a.length]=r[l]);return a},Rn}var In,so;function ks(){if(so)return In;so=1;var r=tl(),e=rl(),t=As(),a=Ss(),l=gi(),i=a("Object.prototype.toString"),c=pi()(),n=typeof globalThis>"u"?Rt:globalThis,u=e(),w=a("String.prototype.slice"),y=Object.getPrototypeOf,_=a("Array.prototype.indexOf",!0)||function(S,f){for(var x=0;x<S.length;x+=1)if(S[x]===f)return x;return-1},E={__proto__:null};c&&l&&y?r(u,function(m){var S=new n[m];if(Symbol.toStringTag in S){var f=y(S),x=l(f,Symbol.toStringTag);if(!x){var k=y(f);x=l(k,Symbol.toStringTag)}E["$"+m]=t(x.get)}}):r(u,function(m){var S=new n[m],f=S.slice||S.set;f&&(E["$"+m]=t(f))});var p=function(S){var f=!1;return r(E,function(x,k){if(!f)try{"$"+x(S)===k&&(f=w(k,1))}catch{}}),f},T=function(S){var f=!1;return r(E,function(x,k){if(!f)try{x(S),f=w(k,1)}catch{}}),f};return In=function(S){if(!S||typeof S!="object")return!1;if(!c){var f=w(i(S),8,-1);return _(u,f)>-1?f:f!=="Object"?!1:T(S)}return l?p(S):null},In}var Nn,ao;function nl(){if(ao)return Nn;ao=1;var r=ks();return Nn=function(t){return!!r(t)},Nn}var lo;function il(){return lo||(lo=1,function(r){var e=Ja(),t=Qa(),a=ks(),l=nl();function i(d){return d.call.bind(d)}var c=typeof BigInt<"u",n=typeof Symbol<"u",u=i(Object.prototype.toString),w=i(Number.prototype.valueOf),y=i(String.prototype.valueOf),_=i(Boolean.prototype.valueOf);if(c)var E=i(BigInt.prototype.valueOf);if(n)var p=i(Symbol.prototype.valueOf);function T(d,F){if(typeof d!="object")return!1;try{return F(d),!0}catch{return!1}}r.isArgumentsObject=e,r.isGeneratorFunction=t,r.isTypedArray=l;function m(d){return typeof Promise<"u"&&d instanceof Promise||d!==null&&typeof d=="object"&&typeof d.then=="function"&&typeof d.catch=="function"}r.isPromise=m;function S(d){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(d):l(d)||q(d)}r.isArrayBufferView=S;function f(d){return a(d)==="Uint8Array"}r.isUint8Array=f;function x(d){return a(d)==="Uint8ClampedArray"}r.isUint8ClampedArray=x;function k(d){return a(d)==="Uint16Array"}r.isUint16Array=k;function N(d){return a(d)==="Uint32Array"}r.isUint32Array=N;function C(d){return a(d)==="Int8Array"}r.isInt8Array=C;function H(d){return a(d)==="Int16Array"}r.isInt16Array=H;function $(d){return a(d)==="Int32Array"}r.isInt32Array=$;function Z(d){return a(d)==="Float32Array"}r.isFloat32Array=Z;function R(d){return a(d)==="Float64Array"}r.isFloat64Array=R;function ce(d){return a(d)==="BigInt64Array"}r.isBigInt64Array=ce;function ge(d){return a(d)==="BigUint64Array"}r.isBigUint64Array=ge;function I(d){return u(d)==="[object Map]"}I.working=typeof Map<"u"&&I(new Map);function V(d){return typeof Map>"u"?!1:I.working?I(d):d instanceof Map}r.isMap=V;function A(d){return u(d)==="[object Set]"}A.working=typeof Set<"u"&&A(new Set);function j(d){return typeof Set>"u"?!1:A.working?A(d):d instanceof Set}r.isSet=j;function oe(d){return u(d)==="[object WeakMap]"}oe.working=typeof WeakMap<"u"&&oe(new WeakMap);function G(d){return typeof WeakMap>"u"?!1:oe.working?oe(d):d instanceof WeakMap}r.isWeakMap=G;function we(d){return u(d)==="[object WeakSet]"}we.working=typeof WeakSet<"u"&&we(new WeakSet);function Y(d){return we(d)}r.isWeakSet=Y;function te(d){return u(d)==="[object ArrayBuffer]"}te.working=typeof ArrayBuffer<"u"&&te(new ArrayBuffer);function M(d){return typeof ArrayBuffer>"u"?!1:te.working?te(d):d instanceof ArrayBuffer}r.isArrayBuffer=M;function D(d){return u(d)==="[object DataView]"}D.working=typeof ArrayBuffer<"u"&&typeof DataView<"u"&&D(new DataView(new ArrayBuffer(1),0,1));function q(d){return typeof DataView>"u"?!1:D.working?D(d):d instanceof DataView}r.isDataView=q;var X=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:void 0;function ie(d){return u(d)==="[object SharedArrayBuffer]"}function z(d){return typeof X>"u"?!1:(typeof ie.working>"u"&&(ie.working=ie(new X)),ie.working?ie(d):d instanceof X)}r.isSharedArrayBuffer=z;function v(d){return u(d)==="[object AsyncFunction]"}r.isAsyncFunction=v;function g(d){return u(d)==="[object Map Iterator]"}r.isMapIterator=g;function U(d){return u(d)==="[object Set Iterator]"}r.isSetIterator=U;function P(d){return u(d)==="[object Generator]"}r.isGeneratorObject=P;function O(d){return u(d)==="[object WebAssembly.Module]"}r.isWebAssemblyCompiledModule=O;function B(d){return T(d,w)}r.isNumberObject=B;function se(d){return T(d,y)}r.isStringObject=se;function h(d){return T(d,_)}r.isBooleanObject=h;function Q(d){return c&&T(d,E)}r.isBigIntObject=Q;function b(d){return n&&T(d,p)}r.isSymbolObject=b;function o(d){return B(d)||se(d)||h(d)||Q(d)||b(d)}r.isBoxedPrimitive=o;function s(d){return typeof Uint8Array<"u"&&(M(d)||z(d))}r.isAnyArrayBuffer=s,["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(d){Object.defineProperty(r,d,{enumerable:!1,value:function(){throw new Error(d+" is not supported in userland")}})})}(un)),un}var On,co;function ol(){return co||(co=1,On=function(e){return e&&typeof e=="object"&&typeof e.copy=="function"&&typeof e.fill=="function"&&typeof e.readUInt8=="function"}),On}var uo;function Cs(){return uo||(uo=1,function(r){var e=Object.getOwnPropertyDescriptors||function(q){for(var X=Object.keys(q),ie={},z=0;z<X.length;z++)ie[X[z]]=Object.getOwnPropertyDescriptor(q,X[z]);return ie},t=/%[sdj%]/g;r.format=function(D){if(!C(D)){for(var q=[],X=0;X<arguments.length;X++)q.push(c(arguments[X]));return q.join(" ")}for(var X=1,ie=arguments,z=ie.length,v=String(D).replace(t,function(U){if(U==="%%")return"%";if(X>=z)return U;switch(U){case"%s":return String(ie[X++]);case"%d":return Number(ie[X++]);case"%j":try{return JSON.stringify(ie[X++])}catch{return"[Circular]"}default:return U}}),g=ie[X];X<z;g=ie[++X])x(g)||!R(g)?v+=" "+g:v+=" "+c(g);return v},r.deprecate=function(D,q){if(typeof Ue<"u"&&Ue.noDeprecation===!0)return D;if(typeof Ue>"u")return function(){return r.deprecate(D,q).apply(this,arguments)};var X=!1;function ie(){if(!X){if(Ue.throwDeprecation)throw new Error(q);Ue.traceDeprecation?console.trace(q):console.error(q),X=!0}return D.apply(this,arguments)}return ie};var a={},l=/^$/;if(Ue.env.NODE_DEBUG){var i=Ue.env.NODE_DEBUG;i=i.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),l=new RegExp("^"+i+"$","i")}r.debuglog=function(D){if(D=D.toUpperCase(),!a[D])if(l.test(D)){var q=Ue.pid;a[D]=function(){var X=r.format.apply(r,arguments);console.error("%s %d: %s",D,q,X)}}else a[D]=function(){};return a[D]};function c(D,q){var X={seen:[],stylize:u};return arguments.length>=3&&(X.depth=arguments[2]),arguments.length>=4&&(X.colors=arguments[3]),f(q)?X.showHidden=q:q&&r._extend(X,q),$(X.showHidden)&&(X.showHidden=!1),$(X.depth)&&(X.depth=2),$(X.colors)&&(X.colors=!1),$(X.customInspect)&&(X.customInspect=!0),X.colors&&(X.stylize=n),y(X,D,X.depth)}r.inspect=c,c.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},c.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function n(D,q){var X=c.styles[q];return X?"\x1B["+c.colors[X][0]+"m"+D+"\x1B["+c.colors[X][1]+"m":D}function u(D,q){return D}function w(D){var q={};return D.forEach(function(X,ie){q[X]=!0}),q}function y(D,q,X){if(D.customInspect&&q&&I(q.inspect)&&q.inspect!==r.inspect&&!(q.constructor&&q.constructor.prototype===q)){var ie=q.inspect(X,D);return C(ie)||(ie=y(D,ie,X)),ie}var z=_(D,q);if(z)return z;var v=Object.keys(q),g=w(v);if(D.showHidden&&(v=Object.getOwnPropertyNames(q)),ge(q)&&(v.indexOf("message")>=0||v.indexOf("description")>=0))return E(q);if(v.length===0){if(I(q)){var U=q.name?": "+q.name:"";return D.stylize("[Function"+U+"]","special")}if(Z(q))return D.stylize(RegExp.prototype.toString.call(q),"regexp");if(ce(q))return D.stylize(Date.prototype.toString.call(q),"date");if(ge(q))return E(q)}var P="",O=!1,B=["{","}"];if(S(q)&&(O=!0,B=["[","]"]),I(q)){var se=q.name?": "+q.name:"";P=" [Function"+se+"]"}if(Z(q)&&(P=" "+RegExp.prototype.toString.call(q)),ce(q)&&(P=" "+Date.prototype.toUTCString.call(q)),ge(q)&&(P=" "+E(q)),v.length===0&&(!O||q.length==0))return B[0]+P+B[1];if(X<0)return Z(q)?D.stylize(RegExp.prototype.toString.call(q),"regexp"):D.stylize("[Object]","special");D.seen.push(q);var h;return O?h=p(D,q,X,g,v):h=v.map(function(Q){return T(D,q,X,g,Q,O)}),D.seen.pop(),m(h,P,B)}function _(D,q){if($(q))return D.stylize("undefined","undefined");if(C(q)){var X="'"+JSON.stringify(q).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return D.stylize(X,"string")}if(N(q))return D.stylize(""+q,"number");if(f(q))return D.stylize(""+q,"boolean");if(x(q))return D.stylize("null","null")}function E(D){return"["+Error.prototype.toString.call(D)+"]"}function p(D,q,X,ie,z){for(var v=[],g=0,U=q.length;g<U;++g)we(q,String(g))?v.push(T(D,q,X,ie,String(g),!0)):v.push("");return z.forEach(function(P){P.match(/^\d+$/)||v.push(T(D,q,X,ie,P,!0))}),v}function T(D,q,X,ie,z,v){var g,U,P;if(P=Object.getOwnPropertyDescriptor(q,z)||{value:q[z]},P.get?P.set?U=D.stylize("[Getter/Setter]","special"):U=D.stylize("[Getter]","special"):P.set&&(U=D.stylize("[Setter]","special")),we(ie,z)||(g="["+z+"]"),U||(D.seen.indexOf(P.value)<0?(x(X)?U=y(D,P.value,null):U=y(D,P.value,X-1),U.indexOf(`
`)>-1&&(v?U=U.split(`
`).map(function(O){return"  "+O}).join(`
`).slice(2):U=`
`+U.split(`
`).map(function(O){return"   "+O}).join(`
`))):U=D.stylize("[Circular]","special")),$(g)){if(v&&z.match(/^\d+$/))return U;g=JSON.stringify(""+z),g.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(g=g.slice(1,-1),g=D.stylize(g,"name")):(g=g.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),g=D.stylize(g,"string"))}return g+": "+U}function m(D,q,X){var ie=D.reduce(function(z,v){return v.indexOf(`
`)>=0,z+v.replace(/\u001b\[\d\d?m/g,"").length+1},0);return ie>60?X[0]+(q===""?"":q+`
 `)+" "+D.join(`,
  `)+" "+X[1]:X[0]+q+" "+D.join(", ")+" "+X[1]}r.types=il();function S(D){return Array.isArray(D)}r.isArray=S;function f(D){return typeof D=="boolean"}r.isBoolean=f;function x(D){return D===null}r.isNull=x;function k(D){return D==null}r.isNullOrUndefined=k;function N(D){return typeof D=="number"}r.isNumber=N;function C(D){return typeof D=="string"}r.isString=C;function H(D){return typeof D=="symbol"}r.isSymbol=H;function $(D){return D===void 0}r.isUndefined=$;function Z(D){return R(D)&&A(D)==="[object RegExp]"}r.isRegExp=Z,r.types.isRegExp=Z;function R(D){return typeof D=="object"&&D!==null}r.isObject=R;function ce(D){return R(D)&&A(D)==="[object Date]"}r.isDate=ce,r.types.isDate=ce;function ge(D){return R(D)&&(A(D)==="[object Error]"||D instanceof Error)}r.isError=ge,r.types.isNativeError=ge;function I(D){return typeof D=="function"}r.isFunction=I;function V(D){return D===null||typeof D=="boolean"||typeof D=="number"||typeof D=="string"||typeof D=="symbol"||typeof D>"u"}r.isPrimitive=V,r.isBuffer=ol();function A(D){return Object.prototype.toString.call(D)}function j(D){return D<10?"0"+D.toString(10):D.toString(10)}var oe=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function G(){var D=new Date,q=[j(D.getHours()),j(D.getMinutes()),j(D.getSeconds())].join(":");return[D.getDate(),oe[D.getMonth()],q].join(" ")}r.log=function(){console.log("%s - %s",G(),r.format.apply(r,arguments))},r.inherits=Kt,r._extend=function(D,q){if(!q||!R(q))return D;for(var X=Object.keys(q),ie=X.length;ie--;)D[X[ie]]=q[X[ie]];return D};function we(D,q){return Object.prototype.hasOwnProperty.call(D,q)}var Y=typeof Symbol<"u"?Symbol("util.promisify.custom"):void 0;r.promisify=function(q){if(typeof q!="function")throw new TypeError('The "original" argument must be of type Function');if(Y&&q[Y]){var X=q[Y];if(typeof X!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(X,Y,{value:X,enumerable:!1,writable:!1,configurable:!0}),X}function X(){for(var ie,z,v=new Promise(function(P,O){ie=P,z=O}),g=[],U=0;U<arguments.length;U++)g.push(arguments[U]);g.push(function(P,O){P?z(P):ie(O)});try{q.apply(this,g)}catch(P){z(P)}return v}return Object.setPrototypeOf(X,Object.getPrototypeOf(q)),Y&&Object.defineProperty(X,Y,{value:X,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(X,e(q))},r.promisify.custom=Y;function te(D,q){if(!D){var X=new Error("Promise was rejected with a falsy value");X.reason=D,D=X}return q(D)}function M(D){if(typeof D!="function")throw new TypeError('The "original" argument must be of type Function');function q(){for(var X=[],ie=0;ie<arguments.length;ie++)X.push(arguments[ie]);var z=X.pop();if(typeof z!="function")throw new TypeError("The last argument must be of type Function");var v=this,g=function(){return z.apply(v,arguments)};D.apply(this,X).then(function(U){Ue.nextTick(g.bind(null,null,U))},function(U){Ue.nextTick(te.bind(null,U,g))})}return Object.setPrototypeOf(q,Object.getPrototypeOf(D)),Object.defineProperties(q,e(D)),q}r.callbackify=M}(cn)),cn}var Dn,fo;function sl(){if(fo)return Dn;fo=1;function r(E,p){var T=Object.keys(E);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(E);p&&(m=m.filter(function(S){return Object.getOwnPropertyDescriptor(E,S).enumerable})),T.push.apply(T,m)}return T}function e(E){for(var p=1;p<arguments.length;p++){var T=arguments[p]!=null?arguments[p]:{};p%2?r(Object(T),!0).forEach(function(m){t(E,m,T[m])}):Object.getOwnPropertyDescriptors?Object.defineProperties(E,Object.getOwnPropertyDescriptors(T)):r(Object(T)).forEach(function(m){Object.defineProperty(E,m,Object.getOwnPropertyDescriptor(T,m))})}return E}function t(E,p,T){return p in E?Object.defineProperty(E,p,{value:T,enumerable:!0,configurable:!0,writable:!0}):E[p]=T,E}function a(E,p){if(!(E instanceof p))throw new TypeError("Cannot call a class as a function")}function l(E,p){for(var T=0;T<p.length;T++){var m=p[T];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(E,m.key,m)}}function i(E,p,T){return p&&l(E.prototype,p),E}var c=Jr(),n=c.Buffer,u=Cs(),w=u.inspect,y=w&&w.custom||"inspect";function _(E,p,T){n.prototype.copy.call(E,p,T)}return Dn=function(){function E(){a(this,E),this.head=null,this.tail=null,this.length=0}return i(E,[{key:"push",value:function(T){var m={data:T,next:null};this.length>0?this.tail.next=m:this.head=m,this.tail=m,++this.length}},{key:"unshift",value:function(T){var m={data:T,next:this.head};this.length===0&&(this.tail=m),this.head=m,++this.length}},{key:"shift",value:function(){if(this.length!==0){var T=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,T}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(T){if(this.length===0)return"";for(var m=this.head,S=""+m.data;m=m.next;)S+=T+m.data;return S}},{key:"concat",value:function(T){if(this.length===0)return n.alloc(0);for(var m=n.allocUnsafe(T>>>0),S=this.head,f=0;S;)_(S.data,m,f),f+=S.data.length,S=S.next;return m}},{key:"consume",value:function(T,m){var S;return T<this.head.data.length?(S=this.head.data.slice(0,T),this.head.data=this.head.data.slice(T)):T===this.head.data.length?S=this.shift():S=m?this._getString(T):this._getBuffer(T),S}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(T){var m=this.head,S=1,f=m.data;for(T-=f.length;m=m.next;){var x=m.data,k=T>x.length?x.length:T;if(k===x.length?f+=x:f+=x.slice(0,T),T-=k,T===0){k===x.length?(++S,m.next?this.head=m.next:this.head=this.tail=null):(this.head=m,m.data=x.slice(k));break}++S}return this.length-=S,f}},{key:"_getBuffer",value:function(T){var m=n.allocUnsafe(T),S=this.head,f=1;for(S.data.copy(m),T-=S.data.length;S=S.next;){var x=S.data,k=T>x.length?x.length:T;if(x.copy(m,m.length-T,0,k),T-=k,T===0){k===x.length?(++f,S.next?this.head=S.next:this.head=this.tail=null):(this.head=S,S.data=x.slice(k));break}++f}return this.length-=f,m}},{key:y,value:function(T,m){return w(this,e({},m,{depth:0,customInspect:!1}))}}]),E}(),Dn}var Bn,ho;function Rs(){if(ho)return Bn;ho=1;function r(c,n){var u=this,w=this._readableState&&this._readableState.destroyed,y=this._writableState&&this._writableState.destroyed;return w||y?(n?n(c):c&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,Ue.nextTick(l,this,c)):Ue.nextTick(l,this,c)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(c||null,function(_){!n&&_?u._writableState?u._writableState.errorEmitted?Ue.nextTick(t,u):(u._writableState.errorEmitted=!0,Ue.nextTick(e,u,_)):Ue.nextTick(e,u,_):n?(Ue.nextTick(t,u),n(_)):Ue.nextTick(t,u)}),this)}function e(c,n){l(c,n),t(c)}function t(c){c._writableState&&!c._writableState.emitClose||c._readableState&&!c._readableState.emitClose||c.emit("close")}function a(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function l(c,n){c.emit("error",n)}function i(c,n){var u=c._readableState,w=c._writableState;u&&u.autoDestroy||w&&w.autoDestroy?c.destroy(n):c.emit("error",n)}return Bn={destroy:r,undestroy:a,errorOrDestroy:i},Bn}var Fn={},po;function pr(){if(po)return Fn;po=1;function r(n,u){n.prototype=Object.create(u.prototype),n.prototype.constructor=n,n.__proto__=u}var e={};function t(n,u,w){w||(w=Error);function y(E,p,T){return typeof u=="string"?u:u(E,p,T)}var _=function(E){r(p,E);function p(T,m,S){return E.call(this,y(T,m,S))||this}return p}(w);_.prototype.name=w.name,_.prototype.code=n,e[n]=_}function a(n,u){if(Array.isArray(n)){var w=n.length;return n=n.map(function(y){return String(y)}),w>2?"one of ".concat(u," ").concat(n.slice(0,w-1).join(", "),", or ")+n[w-1]:w===2?"one of ".concat(u," ").concat(n[0]," or ").concat(n[1]):"of ".concat(u," ").concat(n[0])}else return"of ".concat(u," ").concat(String(n))}function l(n,u,w){return n.substr(0,u.length)===u}function i(n,u,w){return(w===void 0||w>n.length)&&(w=n.length),n.substring(w-u.length,w)===u}function c(n,u,w){return typeof w!="number"&&(w=0),w+u.length>n.length?!1:n.indexOf(u,w)!==-1}return t("ERR_INVALID_OPT_VALUE",function(n,u){return'The value "'+u+'" is invalid for option "'+n+'"'},TypeError),t("ERR_INVALID_ARG_TYPE",function(n,u,w){var y;typeof u=="string"&&l(u,"not ")?(y="must not be",u=u.replace(/^not /,"")):y="must be";var _;if(i(n," argument"))_="The ".concat(n," ").concat(y," ").concat(a(u,"type"));else{var E=c(n,".")?"property":"argument";_='The "'.concat(n,'" ').concat(E," ").concat(y," ").concat(a(u,"type"))}return _+=". Received type ".concat(typeof w),_},TypeError),t("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),t("ERR_METHOD_NOT_IMPLEMENTED",function(n){return"The "+n+" method is not implemented"}),t("ERR_STREAM_PREMATURE_CLOSE","Premature close"),t("ERR_STREAM_DESTROYED",function(n){return"Cannot call "+n+" after a stream was destroyed"}),t("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),t("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),t("ERR_STREAM_WRITE_AFTER_END","write after end"),t("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),t("ERR_UNKNOWN_ENCODING",function(n){return"Unknown encoding: "+n},TypeError),t("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),Fn.codes=e,Fn}var Pn,mo;function Is(){if(mo)return Pn;mo=1;var r=pr().codes.ERR_INVALID_OPT_VALUE;function e(a,l,i){return a.highWaterMark!=null?a.highWaterMark:l?a[i]:null}function t(a,l,i,c){var n=e(l,c,i);if(n!=null){if(!(isFinite(n)&&Math.floor(n)===n)||n<0){var u=c?i:"highWaterMark";throw new r(u,n)}return Math.floor(n)}return a.objectMode?16:16*1024}return Pn={getHighWaterMark:t},Pn}var Ln,go;function al(){if(go)return Ln;go=1,Ln=r;function r(t,a){if(e("noDeprecation"))return t;var l=!1;function i(){if(!l){if(e("throwDeprecation"))throw new Error(a);e("traceDeprecation")?console.trace(a):console.warn(a),l=!0}return t.apply(this,arguments)}return i}function e(t){try{if(!Rt.localStorage)return!1}catch{return!1}var a=Rt.localStorage[t];return a==null?!1:String(a).toLowerCase()==="true"}return Ln}var Un,wo;function Ns(){if(wo)return Un;wo=1,Un=Z;function r(z){var v=this;this.next=null,this.entry=null,this.finish=function(){ie(v,z)}}var e;Z.WritableState=H;var t={deprecate:al()},a=xs(),l=Jr().Buffer,i=Rt.Uint8Array||function(){};function c(z){return l.from(z)}function n(z){return l.isBuffer(z)||z instanceof i}var u=Rs(),w=Is(),y=w.getHighWaterMark,_=pr().codes,E=_.ERR_INVALID_ARG_TYPE,p=_.ERR_METHOD_NOT_IMPLEMENTED,T=_.ERR_MULTIPLE_CALLBACK,m=_.ERR_STREAM_CANNOT_PIPE,S=_.ERR_STREAM_DESTROYED,f=_.ERR_STREAM_NULL_VALUES,x=_.ERR_STREAM_WRITE_AFTER_END,k=_.ERR_UNKNOWN_ENCODING,N=u.errorOrDestroy;Kt(Z,a);function C(){}function H(z,v,g){e=e||rr(),z=z||{},typeof g!="boolean"&&(g=v instanceof e),this.objectMode=!!z.objectMode,g&&(this.objectMode=this.objectMode||!!z.writableObjectMode),this.highWaterMark=y(this,z,"writableHighWaterMark",g),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var U=z.decodeStrings===!1;this.decodeStrings=!U,this.defaultEncoding=z.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(P){oe(v,P)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=z.emitClose!==!1,this.autoDestroy=!!z.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new r(this)}H.prototype.getBuffer=function(){for(var v=this.bufferedRequest,g=[];v;)g.push(v),v=v.next;return g},function(){try{Object.defineProperty(H.prototype,"buffer",{get:t.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var $;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?($=Function.prototype[Symbol.hasInstance],Object.defineProperty(Z,Symbol.hasInstance,{value:function(v){return $.call(this,v)?!0:this!==Z?!1:v&&v._writableState instanceof H}})):$=function(v){return v instanceof this};function Z(z){e=e||rr();var v=this instanceof e;if(!v&&!$.call(Z,this))return new Z(z);this._writableState=new H(z,this,v),this.writable=!0,z&&(typeof z.write=="function"&&(this._write=z.write),typeof z.writev=="function"&&(this._writev=z.writev),typeof z.destroy=="function"&&(this._destroy=z.destroy),typeof z.final=="function"&&(this._final=z.final)),a.call(this)}Z.prototype.pipe=function(){N(this,new m)};function R(z,v){var g=new x;N(z,g),Ue.nextTick(v,g)}function ce(z,v,g,U){var P;return g===null?P=new f:typeof g!="string"&&!v.objectMode&&(P=new E("chunk",["string","Buffer"],g)),P?(N(z,P),Ue.nextTick(U,P),!1):!0}Z.prototype.write=function(z,v,g){var U=this._writableState,P=!1,O=!U.objectMode&&n(z);return O&&!l.isBuffer(z)&&(z=c(z)),typeof v=="function"&&(g=v,v=null),O?v="buffer":v||(v=U.defaultEncoding),typeof g!="function"&&(g=C),U.ending?R(this,g):(O||ce(this,U,z,g))&&(U.pendingcb++,P=I(this,U,O,z,v,g)),P},Z.prototype.cork=function(){this._writableState.corked++},Z.prototype.uncork=function(){var z=this._writableState;z.corked&&(z.corked--,!z.writing&&!z.corked&&!z.bufferProcessing&&z.bufferedRequest&&Y(this,z))},Z.prototype.setDefaultEncoding=function(v){if(typeof v=="string"&&(v=v.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((v+"").toLowerCase())>-1))throw new k(v);return this._writableState.defaultEncoding=v,this},Object.defineProperty(Z.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function ge(z,v,g){return!z.objectMode&&z.decodeStrings!==!1&&typeof v=="string"&&(v=l.from(v,g)),v}Object.defineProperty(Z.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function I(z,v,g,U,P,O){if(!g){var B=ge(v,U,P);U!==B&&(g=!0,P="buffer",U=B)}var se=v.objectMode?1:U.length;v.length+=se;var h=v.length<v.highWaterMark;if(h||(v.needDrain=!0),v.writing||v.corked){var Q=v.lastBufferedRequest;v.lastBufferedRequest={chunk:U,encoding:P,isBuf:g,callback:O,next:null},Q?Q.next=v.lastBufferedRequest:v.bufferedRequest=v.lastBufferedRequest,v.bufferedRequestCount+=1}else V(z,v,!1,se,U,P,O);return h}function V(z,v,g,U,P,O,B){v.writelen=U,v.writecb=B,v.writing=!0,v.sync=!0,v.destroyed?v.onwrite(new S("write")):g?z._writev(P,v.onwrite):z._write(P,O,v.onwrite),v.sync=!1}function A(z,v,g,U,P){--v.pendingcb,g?(Ue.nextTick(P,U),Ue.nextTick(q,z,v),z._writableState.errorEmitted=!0,N(z,U)):(P(U),z._writableState.errorEmitted=!0,N(z,U),q(z,v))}function j(z){z.writing=!1,z.writecb=null,z.length-=z.writelen,z.writelen=0}function oe(z,v){var g=z._writableState,U=g.sync,P=g.writecb;if(typeof P!="function")throw new T;if(j(g),v)A(z,g,U,v,P);else{var O=te(g)||z.destroyed;!O&&!g.corked&&!g.bufferProcessing&&g.bufferedRequest&&Y(z,g),U?Ue.nextTick(G,z,g,O,P):G(z,g,O,P)}}function G(z,v,g,U){g||we(z,v),v.pendingcb--,U(),q(z,v)}function we(z,v){v.length===0&&v.needDrain&&(v.needDrain=!1,z.emit("drain"))}function Y(z,v){v.bufferProcessing=!0;var g=v.bufferedRequest;if(z._writev&&g&&g.next){var U=v.bufferedRequestCount,P=new Array(U),O=v.corkedRequestsFree;O.entry=g;for(var B=0,se=!0;g;)P[B]=g,g.isBuf||(se=!1),g=g.next,B+=1;P.allBuffers=se,V(z,v,!0,v.length,P,"",O.finish),v.pendingcb++,v.lastBufferedRequest=null,O.next?(v.corkedRequestsFree=O.next,O.next=null):v.corkedRequestsFree=new r(v),v.bufferedRequestCount=0}else{for(;g;){var h=g.chunk,Q=g.encoding,b=g.callback,o=v.objectMode?1:h.length;if(V(z,v,!1,o,h,Q,b),g=g.next,v.bufferedRequestCount--,v.writing)break}g===null&&(v.lastBufferedRequest=null)}v.bufferedRequest=g,v.bufferProcessing=!1}Z.prototype._write=function(z,v,g){g(new p("_write()"))},Z.prototype._writev=null,Z.prototype.end=function(z,v,g){var U=this._writableState;return typeof z=="function"?(g=z,z=null,v=null):typeof v=="function"&&(g=v,v=null),z!=null&&this.write(z,v),U.corked&&(U.corked=1,this.uncork()),U.ending||X(this,U,g),this},Object.defineProperty(Z.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function te(z){return z.ending&&z.length===0&&z.bufferedRequest===null&&!z.finished&&!z.writing}function M(z,v){z._final(function(g){v.pendingcb--,g&&N(z,g),v.prefinished=!0,z.emit("prefinish"),q(z,v)})}function D(z,v){!v.prefinished&&!v.finalCalled&&(typeof z._final=="function"&&!v.destroyed?(v.pendingcb++,v.finalCalled=!0,Ue.nextTick(M,z,v)):(v.prefinished=!0,z.emit("prefinish")))}function q(z,v){var g=te(v);if(g&&(D(z,v),v.pendingcb===0&&(v.finished=!0,z.emit("finish"),v.autoDestroy))){var U=z._readableState;(!U||U.autoDestroy&&U.endEmitted)&&z.destroy()}return g}function X(z,v,g){v.ending=!0,q(z,v),g&&(v.finished?Ue.nextTick(g):z.once("finish",g)),v.ended=!0,z.writable=!1}function ie(z,v,g){var U=z.entry;for(z.entry=null;U;){var P=U.callback;v.pendingcb--,P(g),U=U.next}v.corkedRequestsFree.next=z}return Object.defineProperty(Z.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(v){this._writableState&&(this._writableState.destroyed=v)}}),Z.prototype.destroy=u.destroy,Z.prototype._undestroy=u.undestroy,Z.prototype._destroy=function(z,v){v(z)},Un}var Mn,yo;function rr(){if(yo)return Mn;yo=1;var r=Object.keys||function(w){var y=[];for(var _ in w)y.push(_);return y};Mn=c;var e=Os(),t=Ns();Kt(c,e);for(var a=r(t.prototype),l=0;l<a.length;l++){var i=a[l];c.prototype[i]||(c.prototype[i]=t.prototype[i])}function c(w){if(!(this instanceof c))return new c(w);e.call(this,w),t.call(this,w),this.allowHalfOpen=!0,w&&(w.readable===!1&&(this.readable=!1),w.writable===!1&&(this.writable=!1),w.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",n)))}Object.defineProperty(c.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(c.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(c.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function n(){this._writableState.ended||Ue.nextTick(u,this)}function u(w){w.end()}return Object.defineProperty(c.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(y){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=y,this._writableState.destroyed=y)}}),Mn}var jn={},Dr={exports:{}},vo;function ll(){return vo||(vo=1,function(r,e){var t=Jr(),a=t.Buffer;function l(c,n){for(var u in c)n[u]=c[u]}a.from&&a.alloc&&a.allocUnsafe&&a.allocUnsafeSlow?r.exports=t:(l(t,e),e.Buffer=i);function i(c,n,u){return a(c,n,u)}l(a,i),i.from=function(c,n,u){if(typeof c=="number")throw new TypeError("Argument must not be a number");return a(c,n,u)},i.alloc=function(c,n,u){if(typeof c!="number")throw new TypeError("Argument must be a number");var w=a(c);return n!==void 0?typeof u=="string"?w.fill(n,u):w.fill(n):w.fill(0),w},i.allocUnsafe=function(c){if(typeof c!="number")throw new TypeError("Argument must be a number");return a(c)},i.allocUnsafeSlow=function(c){if(typeof c!="number")throw new TypeError("Argument must be a number");return t.SlowBuffer(c)}}(Dr,Dr.exports)),Dr.exports}var bo;function oi(){if(bo)return jn;bo=1;var r=ll().Buffer,e=r.isEncoding||function(f){switch(f=""+f,f&&f.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function t(f){if(!f)return"utf8";for(var x;;)switch(f){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return f;default:if(x)return;f=(""+f).toLowerCase(),x=!0}}function a(f){var x=t(f);if(typeof x!="string"&&(r.isEncoding===e||!e(f)))throw new Error("Unknown encoding: "+f);return x||f}jn.StringDecoder=l;function l(f){this.encoding=a(f);var x;switch(this.encoding){case"utf16le":this.text=_,this.end=E,x=4;break;case"utf8":this.fillLast=u,x=4;break;case"base64":this.text=p,this.end=T,x=3;break;default:this.write=m,this.end=S;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(x)}l.prototype.write=function(f){if(f.length===0)return"";var x,k;if(this.lastNeed){if(x=this.fillLast(f),x===void 0)return"";k=this.lastNeed,this.lastNeed=0}else k=0;return k<f.length?x?x+this.text(f,k):this.text(f,k):x||""},l.prototype.end=y,l.prototype.text=w,l.prototype.fillLast=function(f){if(this.lastNeed<=f.length)return f.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);f.copy(this.lastChar,this.lastTotal-this.lastNeed,0,f.length),this.lastNeed-=f.length};function i(f){return f<=127?0:f>>5===6?2:f>>4===14?3:f>>3===30?4:f>>6===2?-1:-2}function c(f,x,k){var N=x.length-1;if(N<k)return 0;var C=i(x[N]);return C>=0?(C>0&&(f.lastNeed=C-1),C):--N<k||C===-2?0:(C=i(x[N]),C>=0?(C>0&&(f.lastNeed=C-2),C):--N<k||C===-2?0:(C=i(x[N]),C>=0?(C>0&&(C===2?C=0:f.lastNeed=C-3),C):0))}function n(f,x,k){if((x[0]&192)!==128)return f.lastNeed=0,"";if(f.lastNeed>1&&x.length>1){if((x[1]&192)!==128)return f.lastNeed=1,"";if(f.lastNeed>2&&x.length>2&&(x[2]&192)!==128)return f.lastNeed=2,""}}function u(f){var x=this.lastTotal-this.lastNeed,k=n(this,f);if(k!==void 0)return k;if(this.lastNeed<=f.length)return f.copy(this.lastChar,x,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);f.copy(this.lastChar,x,0,f.length),this.lastNeed-=f.length}function w(f,x){var k=c(this,f,x);if(!this.lastNeed)return f.toString("utf8",x);this.lastTotal=k;var N=f.length-(k-this.lastNeed);return f.copy(this.lastChar,0,N),f.toString("utf8",x,N)}function y(f){var x=f&&f.length?this.write(f):"";return this.lastNeed?x+"":x}function _(f,x){if((f.length-x)%2===0){var k=f.toString("utf16le",x);if(k){var N=k.charCodeAt(k.length-1);if(N>=55296&&N<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=f[f.length-2],this.lastChar[1]=f[f.length-1],k.slice(0,-1)}return k}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=f[f.length-1],f.toString("utf16le",x,f.length-1)}function E(f){var x=f&&f.length?this.write(f):"";if(this.lastNeed){var k=this.lastTotal-this.lastNeed;return x+this.lastChar.toString("utf16le",0,k)}return x}function p(f,x){var k=(f.length-x)%3;return k===0?f.toString("base64",x):(this.lastNeed=3-k,this.lastTotal=3,k===1?this.lastChar[0]=f[f.length-1]:(this.lastChar[0]=f[f.length-2],this.lastChar[1]=f[f.length-1]),f.toString("base64",x,f.length-k))}function T(f){var x=f&&f.length?this.write(f):"";return this.lastNeed?x+this.lastChar.toString("base64",0,3-this.lastNeed):x}function m(f){return f.toString(this.encoding)}function S(f){return f&&f.length?this.write(f):""}return jn}var zn,_o;function wi(){if(_o)return zn;_o=1;var r=pr().codes.ERR_STREAM_PREMATURE_CLOSE;function e(i){var c=!1;return function(){if(!c){c=!0;for(var n=arguments.length,u=new Array(n),w=0;w<n;w++)u[w]=arguments[w];i.apply(this,u)}}}function t(){}function a(i){return i.setHeader&&typeof i.abort=="function"}function l(i,c,n){if(typeof c=="function")return l(i,null,c);c||(c={}),n=e(n||t);var u=c.readable||c.readable!==!1&&i.readable,w=c.writable||c.writable!==!1&&i.writable,y=function(){i.writable||E()},_=i._writableState&&i._writableState.finished,E=function(){w=!1,_=!0,u||n.call(i)},p=i._readableState&&i._readableState.endEmitted,T=function(){u=!1,p=!0,w||n.call(i)},m=function(k){n.call(i,k)},S=function(){var k;if(u&&!p)return(!i._readableState||!i._readableState.ended)&&(k=new r),n.call(i,k);if(w&&!_)return(!i._writableState||!i._writableState.ended)&&(k=new r),n.call(i,k)},f=function(){i.req.on("finish",E)};return a(i)?(i.on("complete",E),i.on("abort",S),i.req?f():i.on("request",f)):w&&!i._writableState&&(i.on("end",y),i.on("close",y)),i.on("end",T),i.on("finish",E),c.error!==!1&&i.on("error",m),i.on("close",S),function(){i.removeListener("complete",E),i.removeListener("abort",S),i.removeListener("request",f),i.req&&i.req.removeListener("finish",E),i.removeListener("end",y),i.removeListener("close",y),i.removeListener("finish",E),i.removeListener("end",T),i.removeListener("error",m),i.removeListener("close",S)}}return zn=l,zn}var Wn,xo;function cl(){if(xo)return Wn;xo=1;var r;function e(f,x,k){return x in f?Object.defineProperty(f,x,{value:k,enumerable:!0,configurable:!0,writable:!0}):f[x]=k,f}var t=wi(),a=Symbol("lastResolve"),l=Symbol("lastReject"),i=Symbol("error"),c=Symbol("ended"),n=Symbol("lastPromise"),u=Symbol("handlePromise"),w=Symbol("stream");function y(f,x){return{value:f,done:x}}function _(f){var x=f[a];if(x!==null){var k=f[w].read();k!==null&&(f[n]=null,f[a]=null,f[l]=null,x(y(k,!1)))}}function E(f){Ue.nextTick(_,f)}function p(f,x){return function(k,N){f.then(function(){if(x[c]){k(y(void 0,!0));return}x[u](k,N)},N)}}var T=Object.getPrototypeOf(function(){}),m=Object.setPrototypeOf((r={get stream(){return this[w]},next:function(){var x=this,k=this[i];if(k!==null)return Promise.reject(k);if(this[c])return Promise.resolve(y(void 0,!0));if(this[w].destroyed)return new Promise(function($,Z){Ue.nextTick(function(){x[i]?Z(x[i]):$(y(void 0,!0))})});var N=this[n],C;if(N)C=new Promise(p(N,this));else{var H=this[w].read();if(H!==null)return Promise.resolve(y(H,!1));C=new Promise(this[u])}return this[n]=C,C}},e(r,Symbol.asyncIterator,function(){return this}),e(r,"return",function(){var x=this;return new Promise(function(k,N){x[w].destroy(null,function(C){if(C){N(C);return}k(y(void 0,!0))})})}),r),T),S=function(x){var k,N=Object.create(m,(k={},e(k,w,{value:x,writable:!0}),e(k,a,{value:null,writable:!0}),e(k,l,{value:null,writable:!0}),e(k,i,{value:null,writable:!0}),e(k,c,{value:x._readableState.endEmitted,writable:!0}),e(k,u,{value:function(H,$){var Z=N[w].read();Z?(N[n]=null,N[a]=null,N[l]=null,H(y(Z,!1))):(N[a]=H,N[l]=$)},writable:!0}),k));return N[n]=null,t(x,function(C){if(C&&C.code!=="ERR_STREAM_PREMATURE_CLOSE"){var H=N[l];H!==null&&(N[n]=null,N[a]=null,N[l]=null,H(C)),N[i]=C;return}var $=N[a];$!==null&&(N[n]=null,N[a]=null,N[l]=null,$(y(void 0,!0))),N[c]=!0}),x.on("readable",E.bind(null,N)),N};return Wn=S,Wn}var Hn,Eo;function ul(){return Eo||(Eo=1,Hn=function(){throw new Error("Readable.from is not available in the browser")}),Hn}var $n,To;function Os(){if(To)return $n;To=1,$n=R;var r;R.ReadableState=Z,di.EventEmitter;var e=function(B,se){return B.listeners(se).length},t=xs(),a=Jr().Buffer,l=Rt.Uint8Array||function(){};function i(O){return a.from(O)}function c(O){return a.isBuffer(O)||O instanceof l}var n=Cs(),u;n&&n.debuglog?u=n.debuglog("stream"):u=function(){};var w=sl(),y=Rs(),_=Is(),E=_.getHighWaterMark,p=pr().codes,T=p.ERR_INVALID_ARG_TYPE,m=p.ERR_STREAM_PUSH_AFTER_EOF,S=p.ERR_METHOD_NOT_IMPLEMENTED,f=p.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,x,k,N;Kt(R,t);var C=y.errorOrDestroy,H=["error","close","destroy","pause","resume"];function $(O,B,se){if(typeof O.prependListener=="function")return O.prependListener(B,se);!O._events||!O._events[B]?O.on(B,se):Array.isArray(O._events[B])?O._events[B].unshift(se):O._events[B]=[se,O._events[B]]}function Z(O,B,se){r=r||rr(),O=O||{},typeof se!="boolean"&&(se=B instanceof r),this.objectMode=!!O.objectMode,se&&(this.objectMode=this.objectMode||!!O.readableObjectMode),this.highWaterMark=E(this,O,"readableHighWaterMark",se),this.buffer=new w,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=O.emitClose!==!1,this.autoDestroy=!!O.autoDestroy,this.destroyed=!1,this.defaultEncoding=O.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,O.encoding&&(x||(x=oi().StringDecoder),this.decoder=new x(O.encoding),this.encoding=O.encoding)}function R(O){if(r=r||rr(),!(this instanceof R))return new R(O);var B=this instanceof r;this._readableState=new Z(O,this,B),this.readable=!0,O&&(typeof O.read=="function"&&(this._read=O.read),typeof O.destroy=="function"&&(this._destroy=O.destroy)),t.call(this)}Object.defineProperty(R.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(B){this._readableState&&(this._readableState.destroyed=B)}}),R.prototype.destroy=y.destroy,R.prototype._undestroy=y.undestroy,R.prototype._destroy=function(O,B){B(O)},R.prototype.push=function(O,B){var se=this._readableState,h;return se.objectMode?h=!0:typeof O=="string"&&(B=B||se.defaultEncoding,B!==se.encoding&&(O=a.from(O,B),B=""),h=!0),ce(this,O,B,!1,h)},R.prototype.unshift=function(O){return ce(this,O,null,!0,!1)};function ce(O,B,se,h,Q){u("readableAddChunk",B);var b=O._readableState;if(B===null)b.reading=!1,oe(O,b);else{var o;if(Q||(o=I(b,B)),o)C(O,o);else if(b.objectMode||B&&B.length>0)if(typeof B!="string"&&!b.objectMode&&Object.getPrototypeOf(B)!==a.prototype&&(B=i(B)),h)b.endEmitted?C(O,new f):ge(O,b,B,!0);else if(b.ended)C(O,new m);else{if(b.destroyed)return!1;b.reading=!1,b.decoder&&!se?(B=b.decoder.write(B),b.objectMode||B.length!==0?ge(O,b,B,!1):Y(O,b)):ge(O,b,B,!1)}else h||(b.reading=!1,Y(O,b))}return!b.ended&&(b.length<b.highWaterMark||b.length===0)}function ge(O,B,se,h){B.flowing&&B.length===0&&!B.sync?(B.awaitDrain=0,O.emit("data",se)):(B.length+=B.objectMode?1:se.length,h?B.buffer.unshift(se):B.buffer.push(se),B.needReadable&&G(O)),Y(O,B)}function I(O,B){var se;return!c(B)&&typeof B!="string"&&B!==void 0&&!O.objectMode&&(se=new T("chunk",["string","Buffer","Uint8Array"],B)),se}R.prototype.isPaused=function(){return this._readableState.flowing===!1},R.prototype.setEncoding=function(O){x||(x=oi().StringDecoder);var B=new x(O);this._readableState.decoder=B,this._readableState.encoding=this._readableState.decoder.encoding;for(var se=this._readableState.buffer.head,h="";se!==null;)h+=B.write(se.data),se=se.next;return this._readableState.buffer.clear(),h!==""&&this._readableState.buffer.push(h),this._readableState.length=h.length,this};var V=1073741824;function A(O){return O>=V?O=V:(O--,O|=O>>>1,O|=O>>>2,O|=O>>>4,O|=O>>>8,O|=O>>>16,O++),O}function j(O,B){return O<=0||B.length===0&&B.ended?0:B.objectMode?1:O!==O?B.flowing&&B.length?B.buffer.head.data.length:B.length:(O>B.highWaterMark&&(B.highWaterMark=A(O)),O<=B.length?O:B.ended?B.length:(B.needReadable=!0,0))}R.prototype.read=function(O){u("read",O),O=parseInt(O,10);var B=this._readableState,se=O;if(O!==0&&(B.emittedReadable=!1),O===0&&B.needReadable&&((B.highWaterMark!==0?B.length>=B.highWaterMark:B.length>0)||B.ended))return u("read: emitReadable",B.length,B.ended),B.length===0&&B.ended?g(this):G(this),null;if(O=j(O,B),O===0&&B.ended)return B.length===0&&g(this),null;var h=B.needReadable;u("need readable",h),(B.length===0||B.length-O<B.highWaterMark)&&(h=!0,u("length less than watermark",h)),B.ended||B.reading?(h=!1,u("reading or ended",h)):h&&(u("do read"),B.reading=!0,B.sync=!0,B.length===0&&(B.needReadable=!0),this._read(B.highWaterMark),B.sync=!1,B.reading||(O=j(se,B)));var Q;return O>0?Q=v(O,B):Q=null,Q===null?(B.needReadable=B.length<=B.highWaterMark,O=0):(B.length-=O,B.awaitDrain=0),B.length===0&&(B.ended||(B.needReadable=!0),se!==O&&B.ended&&g(this)),Q!==null&&this.emit("data",Q),Q};function oe(O,B){if(u("onEofChunk"),!B.ended){if(B.decoder){var se=B.decoder.end();se&&se.length&&(B.buffer.push(se),B.length+=B.objectMode?1:se.length)}B.ended=!0,B.sync?G(O):(B.needReadable=!1,B.emittedReadable||(B.emittedReadable=!0,we(O)))}}function G(O){var B=O._readableState;u("emitReadable",B.needReadable,B.emittedReadable),B.needReadable=!1,B.emittedReadable||(u("emitReadable",B.flowing),B.emittedReadable=!0,Ue.nextTick(we,O))}function we(O){var B=O._readableState;u("emitReadable_",B.destroyed,B.length,B.ended),!B.destroyed&&(B.length||B.ended)&&(O.emit("readable"),B.emittedReadable=!1),B.needReadable=!B.flowing&&!B.ended&&B.length<=B.highWaterMark,z(O)}function Y(O,B){B.readingMore||(B.readingMore=!0,Ue.nextTick(te,O,B))}function te(O,B){for(;!B.reading&&!B.ended&&(B.length<B.highWaterMark||B.flowing&&B.length===0);){var se=B.length;if(u("maybeReadMore read 0"),O.read(0),se===B.length)break}B.readingMore=!1}R.prototype._read=function(O){C(this,new S("_read()"))},R.prototype.pipe=function(O,B){var se=this,h=this._readableState;switch(h.pipesCount){case 0:h.pipes=O;break;case 1:h.pipes=[h.pipes,O];break;default:h.pipes.push(O);break}h.pipesCount+=1,u("pipe count=%d opts=%j",h.pipesCount,B);var Q=(!B||B.end!==!1)&&O!==Ue.stdout&&O!==Ue.stderr,b=Q?s:Ee;h.endEmitted?Ue.nextTick(b):se.once("end",b),O.on("unpipe",o);function o(ke,Ne){u("onunpipe"),ke===se&&Ne&&Ne.hasUnpiped===!1&&(Ne.hasUnpiped=!0,K())}function s(){u("onend"),O.end()}var d=M(se);O.on("drain",d);var F=!1;function K(){u("cleanup"),O.removeListener("close",ve),O.removeListener("finish",ae),O.removeListener("drain",d),O.removeListener("error",ue),O.removeListener("unpipe",o),se.removeListener("end",s),se.removeListener("end",Ee),se.removeListener("data",L),F=!0,h.awaitDrain&&(!O._writableState||O._writableState.needDrain)&&d()}se.on("data",L);function L(ke){u("ondata");var Ne=O.write(ke);u("dest.write",Ne),Ne===!1&&((h.pipesCount===1&&h.pipes===O||h.pipesCount>1&&P(h.pipes,O)!==-1)&&!F&&(u("false write response, pause",h.awaitDrain),h.awaitDrain++),se.pause())}function ue(ke){u("onerror",ke),Ee(),O.removeListener("error",ue),e(O,"error")===0&&C(O,ke)}$(O,"error",ue);function ve(){O.removeListener("finish",ae),Ee()}O.once("close",ve);function ae(){u("onfinish"),O.removeListener("close",ve),Ee()}O.once("finish",ae);function Ee(){u("unpipe"),se.unpipe(O)}return O.emit("pipe",se),h.flowing||(u("pipe resume"),se.resume()),O};function M(O){return function(){var se=O._readableState;u("pipeOnDrain",se.awaitDrain),se.awaitDrain&&se.awaitDrain--,se.awaitDrain===0&&e(O,"data")&&(se.flowing=!0,z(O))}}R.prototype.unpipe=function(O){var B=this._readableState,se={hasUnpiped:!1};if(B.pipesCount===0)return this;if(B.pipesCount===1)return O&&O!==B.pipes?this:(O||(O=B.pipes),B.pipes=null,B.pipesCount=0,B.flowing=!1,O&&O.emit("unpipe",this,se),this);if(!O){var h=B.pipes,Q=B.pipesCount;B.pipes=null,B.pipesCount=0,B.flowing=!1;for(var b=0;b<Q;b++)h[b].emit("unpipe",this,{hasUnpiped:!1});return this}var o=P(B.pipes,O);return o===-1?this:(B.pipes.splice(o,1),B.pipesCount-=1,B.pipesCount===1&&(B.pipes=B.pipes[0]),O.emit("unpipe",this,se),this)},R.prototype.on=function(O,B){var se=t.prototype.on.call(this,O,B),h=this._readableState;return O==="data"?(h.readableListening=this.listenerCount("readable")>0,h.flowing!==!1&&this.resume()):O==="readable"&&!h.endEmitted&&!h.readableListening&&(h.readableListening=h.needReadable=!0,h.flowing=!1,h.emittedReadable=!1,u("on readable",h.length,h.reading),h.length?G(this):h.reading||Ue.nextTick(q,this)),se},R.prototype.addListener=R.prototype.on,R.prototype.removeListener=function(O,B){var se=t.prototype.removeListener.call(this,O,B);return O==="readable"&&Ue.nextTick(D,this),se},R.prototype.removeAllListeners=function(O){var B=t.prototype.removeAllListeners.apply(this,arguments);return(O==="readable"||O===void 0)&&Ue.nextTick(D,this),B};function D(O){var B=O._readableState;B.readableListening=O.listenerCount("readable")>0,B.resumeScheduled&&!B.paused?B.flowing=!0:O.listenerCount("data")>0&&O.resume()}function q(O){u("readable nexttick read 0"),O.read(0)}R.prototype.resume=function(){var O=this._readableState;return O.flowing||(u("resume"),O.flowing=!O.readableListening,X(this,O)),O.paused=!1,this};function X(O,B){B.resumeScheduled||(B.resumeScheduled=!0,Ue.nextTick(ie,O,B))}function ie(O,B){u("resume",B.reading),B.reading||O.read(0),B.resumeScheduled=!1,O.emit("resume"),z(O),B.flowing&&!B.reading&&O.read(0)}R.prototype.pause=function(){return u("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(u("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function z(O){var B=O._readableState;for(u("flow",B.flowing);B.flowing&&O.read()!==null;);}R.prototype.wrap=function(O){var B=this,se=this._readableState,h=!1;O.on("end",function(){if(u("wrapped end"),se.decoder&&!se.ended){var o=se.decoder.end();o&&o.length&&B.push(o)}B.push(null)}),O.on("data",function(o){if(u("wrapped data"),se.decoder&&(o=se.decoder.write(o)),!(se.objectMode&&o==null)&&!(!se.objectMode&&(!o||!o.length))){var s=B.push(o);s||(h=!0,O.pause())}});for(var Q in O)this[Q]===void 0&&typeof O[Q]=="function"&&(this[Q]=function(s){return function(){return O[s].apply(O,arguments)}}(Q));for(var b=0;b<H.length;b++)O.on(H[b],this.emit.bind(this,H[b]));return this._read=function(o){u("wrapped _read",o),h&&(h=!1,O.resume())},this},typeof Symbol=="function"&&(R.prototype[Symbol.asyncIterator]=function(){return k===void 0&&(k=cl()),k(this)}),Object.defineProperty(R.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(R.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(R.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(B){this._readableState&&(this._readableState.flowing=B)}}),R._fromList=v,Object.defineProperty(R.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function v(O,B){if(B.length===0)return null;var se;return B.objectMode?se=B.buffer.shift():!O||O>=B.length?(B.decoder?se=B.buffer.join(""):B.buffer.length===1?se=B.buffer.first():se=B.buffer.concat(B.length),B.buffer.clear()):se=B.buffer.consume(O,B.decoder),se}function g(O){var B=O._readableState;u("endReadable",B.endEmitted),B.endEmitted||(B.ended=!0,Ue.nextTick(U,B,O))}function U(O,B){if(u("endReadableNT",O.endEmitted,O.length),!O.endEmitted&&O.length===0&&(O.endEmitted=!0,B.readable=!1,B.emit("end"),O.autoDestroy)){var se=B._writableState;(!se||se.autoDestroy&&se.finished)&&B.destroy()}}typeof Symbol=="function"&&(R.from=function(O,B){return N===void 0&&(N=ul()),N(R,O,B)});function P(O,B){for(var se=0,h=O.length;se<h;se++)if(O[se]===B)return se;return-1}return $n}var Vn,Ao;function Ds(){if(Ao)return Vn;Ao=1,Vn=n;var r=pr().codes,e=r.ERR_METHOD_NOT_IMPLEMENTED,t=r.ERR_MULTIPLE_CALLBACK,a=r.ERR_TRANSFORM_ALREADY_TRANSFORMING,l=r.ERR_TRANSFORM_WITH_LENGTH_0,i=rr();Kt(n,i);function c(y,_){var E=this._transformState;E.transforming=!1;var p=E.writecb;if(p===null)return this.emit("error",new t);E.writechunk=null,E.writecb=null,_!=null&&this.push(_),p(y);var T=this._readableState;T.reading=!1,(T.needReadable||T.length<T.highWaterMark)&&this._read(T.highWaterMark)}function n(y){if(!(this instanceof n))return new n(y);i.call(this,y),this._transformState={afterTransform:c.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,y&&(typeof y.transform=="function"&&(this._transform=y.transform),typeof y.flush=="function"&&(this._flush=y.flush)),this.on("prefinish",u)}function u(){var y=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(_,E){w(y,_,E)}):w(this,null,null)}n.prototype.push=function(y,_){return this._transformState.needTransform=!1,i.prototype.push.call(this,y,_)},n.prototype._transform=function(y,_,E){E(new e("_transform()"))},n.prototype._write=function(y,_,E){var p=this._transformState;if(p.writecb=E,p.writechunk=y,p.writeencoding=_,!p.transforming){var T=this._readableState;(p.needTransform||T.needReadable||T.length<T.highWaterMark)&&this._read(T.highWaterMark)}},n.prototype._read=function(y){var _=this._transformState;_.writechunk!==null&&!_.transforming?(_.transforming=!0,this._transform(_.writechunk,_.writeencoding,_.afterTransform)):_.needTransform=!0},n.prototype._destroy=function(y,_){i.prototype._destroy.call(this,y,function(E){_(E)})};function w(y,_,E){if(_)return y.emit("error",_);if(E!=null&&y.push(E),y._writableState.length)throw new l;if(y._transformState.transforming)throw new a;return y.push(null)}return Vn}var Kn,So;function fl(){if(So)return Kn;So=1,Kn=e;var r=Ds();Kt(e,r);function e(t){if(!(this instanceof e))return new e(t);r.call(this,t)}return e.prototype._transform=function(t,a,l){l(null,t)},Kn}var Gn,ko;function hl(){if(ko)return Gn;ko=1;var r;function e(E){var p=!1;return function(){p||(p=!0,E.apply(void 0,arguments))}}var t=pr().codes,a=t.ERR_MISSING_ARGS,l=t.ERR_STREAM_DESTROYED;function i(E){if(E)throw E}function c(E){return E.setHeader&&typeof E.abort=="function"}function n(E,p,T,m){m=e(m);var S=!1;E.on("close",function(){S=!0}),r===void 0&&(r=wi()),r(E,{readable:p,writable:T},function(x){if(x)return m(x);S=!0,m()});var f=!1;return function(x){if(!S&&!f){if(f=!0,c(E))return E.abort();if(typeof E.destroy=="function")return E.destroy();m(x||new l("pipe"))}}}function u(E){E()}function w(E,p){return E.pipe(p)}function y(E){return!E.length||typeof E[E.length-1]!="function"?i:E.pop()}function _(){for(var E=arguments.length,p=new Array(E),T=0;T<E;T++)p[T]=arguments[T];var m=y(p);if(Array.isArray(p[0])&&(p=p[0]),p.length<2)throw new a("streams");var S,f=p.map(function(x,k){var N=k<p.length-1,C=k>0;return n(x,N,C,function(H){S||(S=H),H&&f.forEach(u),!N&&(f.forEach(u),m(S))})});return p.reduce(w)}return Gn=_,Gn}var yi=yt,vi=di.EventEmitter,dl=Kt;dl(yt,vi);yt.Readable=Os();yt.Writable=Ns();yt.Duplex=rr();yt.Transform=Ds();yt.PassThrough=fl();yt.finished=wi();yt.pipeline=hl();yt.Stream=yt;function yt(){vi.call(this)}yt.prototype.pipe=function(r,e){var t=this;function a(y){r.writable&&r.write(y)===!1&&t.pause&&t.pause()}t.on("data",a);function l(){t.readable&&t.resume&&t.resume()}r.on("drain",l),!r._isStdio&&(!e||e.end!==!1)&&(t.on("end",c),t.on("close",n));var i=!1;function c(){i||(i=!0,r.end())}function n(){i||(i=!0,typeof r.destroy=="function"&&r.destroy())}function u(y){if(w(),vi.listenerCount(this,"error")===0)throw y}t.on("error",u),r.on("error",u);function w(){t.removeListener("data",a),r.removeListener("drain",l),t.removeListener("end",c),t.removeListener("close",n),t.removeListener("error",u),r.removeListener("error",u),t.removeListener("end",w),t.removeListener("close",w),r.removeListener("close",w)}return t.on("end",w),t.on("close",w),r.on("close",w),r.emit("pipe",t),r};(function(r){(function(e){e.parser=function(v,g){return new a(v,g)},e.SAXParser=a,e.SAXStream=y,e.createStream=w,e.MAX_BUFFER_LENGTH=64*1024;var t=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];e.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function a(v,g){if(!(this instanceof a))return new a(v,g);var U=this;i(U),U.q=U.c="",U.bufferCheckPosition=e.MAX_BUFFER_LENGTH,U.opt=g||{},U.opt.lowercase=U.opt.lowercase||U.opt.lowercasetags,U.looseCase=U.opt.lowercase?"toLowerCase":"toUpperCase",U.tags=[],U.closed=U.closedRoot=U.sawRoot=!1,U.tag=U.error=null,U.strict=!!v,U.noscript=!!(v||U.opt.noscript),U.state=R.BEGIN,U.strictEntities=U.opt.strictEntities,U.ENTITIES=U.strictEntities?Object.create(e.XML_ENTITIES):Object.create(e.ENTITIES),U.attribList=[],U.opt.xmlns&&(U.ns=Object.create(m)),U.trackPosition=U.opt.position!==!1,U.trackPosition&&(U.position=U.line=U.column=0),ge(U,"onready")}Object.create||(Object.create=function(v){function g(){}g.prototype=v;var U=new g;return U}),Object.keys||(Object.keys=function(v){var g=[];for(var U in v)v.hasOwnProperty(U)&&g.push(U);return g});function l(v){for(var g=Math.max(e.MAX_BUFFER_LENGTH,10),U=0,P=0,O=t.length;P<O;P++){var B=v[t[P]].length;if(B>g)switch(t[P]){case"textNode":V(v);break;case"cdata":I(v,"oncdata",v.cdata),v.cdata="";break;case"script":I(v,"onscript",v.script),v.script="";break;default:j(v,"Max buffer length exceeded: "+t[P])}U=Math.max(U,B)}var se=e.MAX_BUFFER_LENGTH-U;v.bufferCheckPosition=se+v.position}function i(v){for(var g=0,U=t.length;g<U;g++)v[t[g]]=""}function c(v){V(v),v.cdata!==""&&(I(v,"oncdata",v.cdata),v.cdata=""),v.script!==""&&(I(v,"onscript",v.script),v.script="")}a.prototype={end:function(){oe(this)},write:z,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){c(this)}};var n;try{n=yi.Stream}catch{n=function(){}}var u=e.EVENTS.filter(function(v){return v!=="error"&&v!=="end"});function w(v,g){return new y(v,g)}function y(v,g){if(!(this instanceof y))return new y(v,g);n.apply(this),this._parser=new a(v,g),this.writable=!0,this.readable=!0;var U=this;this._parser.onend=function(){U.emit("end")},this._parser.onerror=function(P){U.emit("error",P),U._parser.error=null},this._decoder=null,u.forEach(function(P){Object.defineProperty(U,"on"+P,{get:function(){return U._parser["on"+P]},set:function(O){if(!O)return U.removeAllListeners(P),U._parser["on"+P]=O,O;U.on(P,O)},enumerable:!0,configurable:!1})})}y.prototype=Object.create(n.prototype,{constructor:{value:y}}),y.prototype.write=function(v){if(typeof Buffer=="function"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(v)){if(!this._decoder){var g=oi().StringDecoder;this._decoder=new g("utf8")}v=this._decoder.write(v)}return this._parser.write(v.toString()),this.emit("data",v),!0},y.prototype.end=function(v){return v&&v.length&&this.write(v),this._parser.end(),!0},y.prototype.on=function(v,g){var U=this;return!U._parser["on"+v]&&u.indexOf(v)!==-1&&(U._parser["on"+v]=function(){var P=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);P.splice(0,0,v),U.emit.apply(U,P)}),n.prototype.on.call(U,v,g)};var _="[CDATA[",E="DOCTYPE",p="http://www.w3.org/XML/1998/namespace",T="http://www.w3.org/2000/xmlns/",m={xml:p,xmlns:T},S=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,f=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,x=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,k=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function N(v){return v===" "||v===`
`||v==="\r"||v==="	"}function C(v){return v==='"'||v==="'"}function H(v){return v===">"||N(v)}function $(v,g){return v.test(g)}function Z(v,g){return!$(v,g)}var R=0;e.STATE={BEGIN:R++,BEGIN_WHITESPACE:R++,TEXT:R++,TEXT_ENTITY:R++,OPEN_WAKA:R++,SGML_DECL:R++,SGML_DECL_QUOTED:R++,DOCTYPE:R++,DOCTYPE_QUOTED:R++,DOCTYPE_DTD:R++,DOCTYPE_DTD_QUOTED:R++,COMMENT_STARTING:R++,COMMENT:R++,COMMENT_ENDING:R++,COMMENT_ENDED:R++,CDATA:R++,CDATA_ENDING:R++,CDATA_ENDING_2:R++,PROC_INST:R++,PROC_INST_BODY:R++,PROC_INST_ENDING:R++,OPEN_TAG:R++,OPEN_TAG_SLASH:R++,ATTRIB:R++,ATTRIB_NAME:R++,ATTRIB_NAME_SAW_WHITE:R++,ATTRIB_VALUE:R++,ATTRIB_VALUE_QUOTED:R++,ATTRIB_VALUE_CLOSED:R++,ATTRIB_VALUE_UNQUOTED:R++,ATTRIB_VALUE_ENTITY_Q:R++,ATTRIB_VALUE_ENTITY_U:R++,CLOSE_TAG:R++,CLOSE_TAG_SAW_WHITE:R++,SCRIPT:R++,SCRIPT_ENDING:R++},e.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},e.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(e.ENTITIES).forEach(function(v){var g=e.ENTITIES[v],U=typeof g=="number"?String.fromCharCode(g):g;e.ENTITIES[v]=U});for(var ce in e.STATE)e.STATE[e.STATE[ce]]=ce;R=e.STATE;function ge(v,g,U){v[g]&&v[g](U)}function I(v,g,U){v.textNode&&V(v),ge(v,g,U)}function V(v){v.textNode=A(v.opt,v.textNode),v.textNode&&ge(v,"ontext",v.textNode),v.textNode=""}function A(v,g){return v.trim&&(g=g.trim()),v.normalize&&(g=g.replace(/\s+/g," ")),g}function j(v,g){return V(v),v.trackPosition&&(g+=`
Line: `+v.line+`
Column: `+v.column+`
Char: `+v.c),g=new Error(g),v.error=g,ge(v,"onerror",g),v}function oe(v){return v.sawRoot&&!v.closedRoot&&G(v,"Unclosed root tag"),v.state!==R.BEGIN&&v.state!==R.BEGIN_WHITESPACE&&v.state!==R.TEXT&&j(v,"Unexpected end"),V(v),v.c="",v.closed=!0,ge(v,"onend"),a.call(v,v.strict,v.opt),v}function G(v,g){if(typeof v!="object"||!(v instanceof a))throw new Error("bad call to strictFail");v.strict&&j(v,g)}function we(v){v.strict||(v.tagName=v.tagName[v.looseCase]());var g=v.tags[v.tags.length-1]||v,U=v.tag={name:v.tagName,attributes:{}};v.opt.xmlns&&(U.ns=g.ns),v.attribList.length=0,I(v,"onopentagstart",U)}function Y(v,g){var U=v.indexOf(":"),P=U<0?["",v]:v.split(":"),O=P[0],B=P[1];return g&&v==="xmlns"&&(O="xmlns",B=""),{prefix:O,local:B}}function te(v){if(v.strict||(v.attribName=v.attribName[v.looseCase]()),v.attribList.indexOf(v.attribName)!==-1||v.tag.attributes.hasOwnProperty(v.attribName)){v.attribName=v.attribValue="";return}if(v.opt.xmlns){var g=Y(v.attribName,!0),U=g.prefix,P=g.local;if(U==="xmlns")if(P==="xml"&&v.attribValue!==p)G(v,"xml: prefix must be bound to "+p+`
Actual: `+v.attribValue);else if(P==="xmlns"&&v.attribValue!==T)G(v,"xmlns: prefix must be bound to "+T+`
Actual: `+v.attribValue);else{var O=v.tag,B=v.tags[v.tags.length-1]||v;O.ns===B.ns&&(O.ns=Object.create(B.ns)),O.ns[P]=v.attribValue}v.attribList.push([v.attribName,v.attribValue])}else v.tag.attributes[v.attribName]=v.attribValue,I(v,"onattribute",{name:v.attribName,value:v.attribValue});v.attribName=v.attribValue=""}function M(v,g){if(v.opt.xmlns){var U=v.tag,P=Y(v.tagName);U.prefix=P.prefix,U.local=P.local,U.uri=U.ns[P.prefix]||"",U.prefix&&!U.uri&&(G(v,"Unbound namespace prefix: "+JSON.stringify(v.tagName)),U.uri=P.prefix);var O=v.tags[v.tags.length-1]||v;U.ns&&O.ns!==U.ns&&Object.keys(U.ns).forEach(function(L){I(v,"onopennamespace",{prefix:L,uri:U.ns[L]})});for(var B=0,se=v.attribList.length;B<se;B++){var h=v.attribList[B],Q=h[0],b=h[1],o=Y(Q,!0),s=o.prefix,d=o.local,F=s===""?"":U.ns[s]||"",K={name:Q,value:b,prefix:s,local:d,uri:F};s&&s!=="xmlns"&&!F&&(G(v,"Unbound namespace prefix: "+JSON.stringify(s)),K.uri=s),v.tag.attributes[Q]=K,I(v,"onattribute",K)}v.attribList.length=0}v.tag.isSelfClosing=!!g,v.sawRoot=!0,v.tags.push(v.tag),I(v,"onopentag",v.tag),g||(!v.noscript&&v.tagName.toLowerCase()==="script"?v.state=R.SCRIPT:v.state=R.TEXT,v.tag=null,v.tagName=""),v.attribName=v.attribValue="",v.attribList.length=0}function D(v){if(!v.tagName){G(v,"Weird empty close tag."),v.textNode+="</>",v.state=R.TEXT;return}if(v.script){if(v.tagName!=="script"){v.script+="</"+v.tagName+">",v.tagName="",v.state=R.SCRIPT;return}I(v,"onscript",v.script),v.script=""}var g=v.tags.length,U=v.tagName;v.strict||(U=U[v.looseCase]());for(var P=U;g--;){var O=v.tags[g];if(O.name!==P)G(v,"Unexpected close tag");else break}if(g<0){G(v,"Unmatched closing tag: "+v.tagName),v.textNode+="</"+v.tagName+">",v.state=R.TEXT;return}v.tagName=U;for(var B=v.tags.length;B-- >g;){var se=v.tag=v.tags.pop();v.tagName=v.tag.name,I(v,"onclosetag",v.tagName);var h={};for(var Q in se.ns)h[Q]=se.ns[Q];var b=v.tags[v.tags.length-1]||v;v.opt.xmlns&&se.ns!==b.ns&&Object.keys(se.ns).forEach(function(o){var s=se.ns[o];I(v,"onclosenamespace",{prefix:o,uri:s})})}g===0&&(v.closedRoot=!0),v.tagName=v.attribValue=v.attribName="",v.attribList.length=0,v.state=R.TEXT}function q(v){var g=v.entity,U=g.toLowerCase(),P,O="";return v.ENTITIES[g]?v.ENTITIES[g]:v.ENTITIES[U]?v.ENTITIES[U]:(g=U,g.charAt(0)==="#"&&(g.charAt(1)==="x"?(g=g.slice(2),P=parseInt(g,16),O=P.toString(16)):(g=g.slice(1),P=parseInt(g,10),O=P.toString(10))),g=g.replace(/^0+/,""),isNaN(P)||O.toLowerCase()!==g?(G(v,"Invalid character entity"),"&"+v.entity+";"):String.fromCodePoint(P))}function X(v,g){g==="<"?(v.state=R.OPEN_WAKA,v.startTagPosition=v.position):N(g)||(G(v,"Non-whitespace before first tag."),v.textNode=g,v.state=R.TEXT)}function ie(v,g){var U="";return g<v.length&&(U=v.charAt(g)),U}function z(v){var g=this;if(this.error)throw this.error;if(g.closed)return j(g,"Cannot write after close. Assign an onready handler.");if(v===null)return oe(g);typeof v=="object"&&(v=v.toString());for(var U=0,P="";P=ie(v,U++),g.c=P,!!P;)switch(g.trackPosition&&(g.position++,P===`
`?(g.line++,g.column=0):g.column++),g.state){case R.BEGIN:if(g.state=R.BEGIN_WHITESPACE,P==="\uFEFF")continue;X(g,P);continue;case R.BEGIN_WHITESPACE:X(g,P);continue;case R.TEXT:if(g.sawRoot&&!g.closedRoot){for(var O=U-1;P&&P!=="<"&&P!=="&";)P=ie(v,U++),P&&g.trackPosition&&(g.position++,P===`
`?(g.line++,g.column=0):g.column++);g.textNode+=v.substring(O,U-1)}P==="<"&&!(g.sawRoot&&g.closedRoot&&!g.strict)?(g.state=R.OPEN_WAKA,g.startTagPosition=g.position):(!N(P)&&(!g.sawRoot||g.closedRoot)&&G(g,"Text data outside of root node."),P==="&"?g.state=R.TEXT_ENTITY:g.textNode+=P);continue;case R.SCRIPT:P==="<"?g.state=R.SCRIPT_ENDING:g.script+=P;continue;case R.SCRIPT_ENDING:P==="/"?g.state=R.CLOSE_TAG:(g.script+="<"+P,g.state=R.SCRIPT);continue;case R.OPEN_WAKA:if(P==="!")g.state=R.SGML_DECL,g.sgmlDecl="";else if(!N(P))if($(S,P))g.state=R.OPEN_TAG,g.tagName=P;else if(P==="/")g.state=R.CLOSE_TAG,g.tagName="";else if(P==="?")g.state=R.PROC_INST,g.procInstName=g.procInstBody="";else{if(G(g,"Unencoded <"),g.startTagPosition+1<g.position){var B=g.position-g.startTagPosition;P=new Array(B).join(" ")+P}g.textNode+="<"+P,g.state=R.TEXT}continue;case R.SGML_DECL:(g.sgmlDecl+P).toUpperCase()===_?(I(g,"onopencdata"),g.state=R.CDATA,g.sgmlDecl="",g.cdata=""):g.sgmlDecl+P==="--"?(g.state=R.COMMENT,g.comment="",g.sgmlDecl=""):(g.sgmlDecl+P).toUpperCase()===E?(g.state=R.DOCTYPE,(g.doctype||g.sawRoot)&&G(g,"Inappropriately located doctype declaration"),g.doctype="",g.sgmlDecl=""):P===">"?(I(g,"onsgmldeclaration",g.sgmlDecl),g.sgmlDecl="",g.state=R.TEXT):(C(P)&&(g.state=R.SGML_DECL_QUOTED),g.sgmlDecl+=P);continue;case R.SGML_DECL_QUOTED:P===g.q&&(g.state=R.SGML_DECL,g.q=""),g.sgmlDecl+=P;continue;case R.DOCTYPE:P===">"?(g.state=R.TEXT,I(g,"ondoctype",g.doctype),g.doctype=!0):(g.doctype+=P,P==="["?g.state=R.DOCTYPE_DTD:C(P)&&(g.state=R.DOCTYPE_QUOTED,g.q=P));continue;case R.DOCTYPE_QUOTED:g.doctype+=P,P===g.q&&(g.q="",g.state=R.DOCTYPE);continue;case R.DOCTYPE_DTD:g.doctype+=P,P==="]"?g.state=R.DOCTYPE:C(P)&&(g.state=R.DOCTYPE_DTD_QUOTED,g.q=P);continue;case R.DOCTYPE_DTD_QUOTED:g.doctype+=P,P===g.q&&(g.state=R.DOCTYPE_DTD,g.q="");continue;case R.COMMENT:P==="-"?g.state=R.COMMENT_ENDING:g.comment+=P;continue;case R.COMMENT_ENDING:P==="-"?(g.state=R.COMMENT_ENDED,g.comment=A(g.opt,g.comment),g.comment&&I(g,"oncomment",g.comment),g.comment=""):(g.comment+="-"+P,g.state=R.COMMENT);continue;case R.COMMENT_ENDED:P!==">"?(G(g,"Malformed comment"),g.comment+="--"+P,g.state=R.COMMENT):g.state=R.TEXT;continue;case R.CDATA:P==="]"?g.state=R.CDATA_ENDING:g.cdata+=P;continue;case R.CDATA_ENDING:P==="]"?g.state=R.CDATA_ENDING_2:(g.cdata+="]"+P,g.state=R.CDATA);continue;case R.CDATA_ENDING_2:P===">"?(g.cdata&&I(g,"oncdata",g.cdata),I(g,"onclosecdata"),g.cdata="",g.state=R.TEXT):P==="]"?g.cdata+="]":(g.cdata+="]]"+P,g.state=R.CDATA);continue;case R.PROC_INST:P==="?"?g.state=R.PROC_INST_ENDING:N(P)?g.state=R.PROC_INST_BODY:g.procInstName+=P;continue;case R.PROC_INST_BODY:if(!g.procInstBody&&N(P))continue;P==="?"?g.state=R.PROC_INST_ENDING:g.procInstBody+=P;continue;case R.PROC_INST_ENDING:P===">"?(I(g,"onprocessinginstruction",{name:g.procInstName,body:g.procInstBody}),g.procInstName=g.procInstBody="",g.state=R.TEXT):(g.procInstBody+="?"+P,g.state=R.PROC_INST_BODY);continue;case R.OPEN_TAG:$(f,P)?g.tagName+=P:(we(g),P===">"?M(g):P==="/"?g.state=R.OPEN_TAG_SLASH:(N(P)||G(g,"Invalid character in tag name"),g.state=R.ATTRIB));continue;case R.OPEN_TAG_SLASH:P===">"?(M(g,!0),D(g)):(G(g,"Forward-slash in opening tag not followed by >"),g.state=R.ATTRIB);continue;case R.ATTRIB:if(N(P))continue;P===">"?M(g):P==="/"?g.state=R.OPEN_TAG_SLASH:$(S,P)?(g.attribName=P,g.attribValue="",g.state=R.ATTRIB_NAME):G(g,"Invalid attribute name");continue;case R.ATTRIB_NAME:P==="="?g.state=R.ATTRIB_VALUE:P===">"?(G(g,"Attribute without value"),g.attribValue=g.attribName,te(g),M(g)):N(P)?g.state=R.ATTRIB_NAME_SAW_WHITE:$(f,P)?g.attribName+=P:G(g,"Invalid attribute name");continue;case R.ATTRIB_NAME_SAW_WHITE:if(P==="=")g.state=R.ATTRIB_VALUE;else{if(N(P))continue;G(g,"Attribute without value"),g.tag.attributes[g.attribName]="",g.attribValue="",I(g,"onattribute",{name:g.attribName,value:""}),g.attribName="",P===">"?M(g):$(S,P)?(g.attribName=P,g.state=R.ATTRIB_NAME):(G(g,"Invalid attribute name"),g.state=R.ATTRIB)}continue;case R.ATTRIB_VALUE:if(N(P))continue;C(P)?(g.q=P,g.state=R.ATTRIB_VALUE_QUOTED):(G(g,"Unquoted attribute value"),g.state=R.ATTRIB_VALUE_UNQUOTED,g.attribValue=P);continue;case R.ATTRIB_VALUE_QUOTED:if(P!==g.q){P==="&"?g.state=R.ATTRIB_VALUE_ENTITY_Q:g.attribValue+=P;continue}te(g),g.q="",g.state=R.ATTRIB_VALUE_CLOSED;continue;case R.ATTRIB_VALUE_CLOSED:N(P)?g.state=R.ATTRIB:P===">"?M(g):P==="/"?g.state=R.OPEN_TAG_SLASH:$(S,P)?(G(g,"No whitespace between attributes"),g.attribName=P,g.attribValue="",g.state=R.ATTRIB_NAME):G(g,"Invalid attribute name");continue;case R.ATTRIB_VALUE_UNQUOTED:if(!H(P)){P==="&"?g.state=R.ATTRIB_VALUE_ENTITY_U:g.attribValue+=P;continue}te(g),P===">"?M(g):g.state=R.ATTRIB;continue;case R.CLOSE_TAG:if(g.tagName)P===">"?D(g):$(f,P)?g.tagName+=P:g.script?(g.script+="</"+g.tagName,g.tagName="",g.state=R.SCRIPT):(N(P)||G(g,"Invalid tagname in closing tag"),g.state=R.CLOSE_TAG_SAW_WHITE);else{if(N(P))continue;Z(S,P)?g.script?(g.script+="</"+P,g.state=R.SCRIPT):G(g,"Invalid tagname in closing tag."):g.tagName=P}continue;case R.CLOSE_TAG_SAW_WHITE:if(N(P))continue;P===">"?D(g):G(g,"Invalid characters in closing tag");continue;case R.TEXT_ENTITY:case R.ATTRIB_VALUE_ENTITY_Q:case R.ATTRIB_VALUE_ENTITY_U:var se,h;switch(g.state){case R.TEXT_ENTITY:se=R.TEXT,h="textNode";break;case R.ATTRIB_VALUE_ENTITY_Q:se=R.ATTRIB_VALUE_QUOTED,h="attribValue";break;case R.ATTRIB_VALUE_ENTITY_U:se=R.ATTRIB_VALUE_UNQUOTED,h="attribValue";break}P===";"?(g[h]+=q(g),g.entity="",g.state=se):$(g.entity.length?k:x,P)?g.entity+=P:(G(g,"Invalid character in entity name"),g[h]+="&"+g.entity+P,g.entity="",g.state=se);continue;default:throw new Error(g,"Unknown state: "+g.state)}return g.position>=g.bufferCheckPosition&&l(g),g}/*! http://mths.be/fromcodepoint v0.1.0 by @mathias */String.fromCodePoint||function(){var v=String.fromCharCode,g=Math.floor,U=function(){var P=16384,O=[],B,se,h=-1,Q=arguments.length;if(!Q)return"";for(var b="";++h<Q;){var o=Number(arguments[h]);if(!isFinite(o)||o<0||o>1114111||g(o)!==o)throw RangeError("Invalid code point: "+o);o<=65535?O.push(o):(o-=65536,B=(o>>10)+55296,se=o%1024+56320,O.push(B,se)),(h+1===Q||O.length>P)&&(b+=v.apply(null,O),O.length=0)}return b};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:U,configurable:!0,writable:!0}):String.fromCodePoint=U}()})(r)})(cs);var bi={isArray:function(r){return Array.isArray?Array.isArray(r):Object.prototype.toString.call(r)==="[object Array]"}},pl=bi.isArray,_i={copyOptions:function(r){var e,t={};for(e in r)r.hasOwnProperty(e)&&(t[e]=r[e]);return t},ensureFlagExists:function(r,e){(!(r in e)||typeof e[r]!="boolean")&&(e[r]=!1)},ensureSpacesExists:function(r){(!("spaces"in r)||typeof r.spaces!="number"&&typeof r.spaces!="string")&&(r.spaces=0)},ensureAlwaysArrayExists:function(r){(!("alwaysArray"in r)||typeof r.alwaysArray!="boolean"&&!pl(r.alwaysArray))&&(r.alwaysArray=!1)},ensureKeyExists:function(r,e){(!(r+"Key"in e)||typeof e[r+"Key"]!="string")&&(e[r+"Key"]=e.compact?"_"+r:r)},checkFnExists:function(r,e){return r+"Fn"in e}},ml=cs,He=_i,Jt=bi.isArray,le,Pe;function gl(r){return le=He.copyOptions(r),He.ensureFlagExists("ignoreDeclaration",le),He.ensureFlagExists("ignoreInstruction",le),He.ensureFlagExists("ignoreAttributes",le),He.ensureFlagExists("ignoreText",le),He.ensureFlagExists("ignoreComment",le),He.ensureFlagExists("ignoreCdata",le),He.ensureFlagExists("ignoreDoctype",le),He.ensureFlagExists("compact",le),He.ensureFlagExists("alwaysChildren",le),He.ensureFlagExists("addParent",le),He.ensureFlagExists("trim",le),He.ensureFlagExists("nativeType",le),He.ensureFlagExists("nativeTypeAttributes",le),He.ensureFlagExists("sanitize",le),He.ensureFlagExists("instructionHasAttributes",le),He.ensureFlagExists("captureSpacesBetweenElements",le),He.ensureAlwaysArrayExists(le),He.ensureKeyExists("declaration",le),He.ensureKeyExists("instruction",le),He.ensureKeyExists("attributes",le),He.ensureKeyExists("text",le),He.ensureKeyExists("comment",le),He.ensureKeyExists("cdata",le),He.ensureKeyExists("doctype",le),He.ensureKeyExists("type",le),He.ensureKeyExists("name",le),He.ensureKeyExists("elements",le),He.ensureKeyExists("parent",le),le}function Bs(r){var e=Number(r);if(!isNaN(e))return e;var t=r.toLowerCase();return t==="true"?!0:t==="false"?!1:r}function kr(r,e){var t;if(le.compact){if(!Pe[le[r+"Key"]]&&(Jt(le.alwaysArray)?le.alwaysArray.indexOf(le[r+"Key"])!==-1:le.alwaysArray)&&(Pe[le[r+"Key"]]=[]),Pe[le[r+"Key"]]&&!Jt(Pe[le[r+"Key"]])&&(Pe[le[r+"Key"]]=[Pe[le[r+"Key"]]]),r+"Fn"in le&&typeof e=="string"&&(e=le[r+"Fn"](e,Pe)),r==="instruction"&&("instructionFn"in le||"instructionNameFn"in le)){for(t in e)if(e.hasOwnProperty(t))if("instructionFn"in le)e[t]=le.instructionFn(e[t],t,Pe);else{var a=e[t];delete e[t],e[le.instructionNameFn(t,a,Pe)]=a}}Jt(Pe[le[r+"Key"]])?Pe[le[r+"Key"]].push(e):Pe[le[r+"Key"]]=e}else{Pe[le.elementsKey]||(Pe[le.elementsKey]=[]);var l={};if(l[le.typeKey]=r,r==="instruction"){for(t in e)if(e.hasOwnProperty(t))break;l[le.nameKey]="instructionNameFn"in le?le.instructionNameFn(t,e,Pe):t,le.instructionHasAttributes?(l[le.attributesKey]=e[t][le.attributesKey],"instructionFn"in le&&(l[le.attributesKey]=le.instructionFn(l[le.attributesKey],t,Pe))):("instructionFn"in le&&(e[t]=le.instructionFn(e[t],t,Pe)),l[le.instructionKey]=e[t])}else r+"Fn"in le&&(e=le[r+"Fn"](e,Pe)),l[le[r+"Key"]]=e;le.addParent&&(l[le.parentKey]=Pe),Pe[le.elementsKey].push(l)}}function Fs(r){if("attributesFn"in le&&r&&(r=le.attributesFn(r,Pe)),(le.trim||"attributeValueFn"in le||"attributeNameFn"in le||le.nativeTypeAttributes)&&r){var e;for(e in r)if(r.hasOwnProperty(e)&&(le.trim&&(r[e]=r[e].trim()),le.nativeTypeAttributes&&(r[e]=Bs(r[e])),"attributeValueFn"in le&&(r[e]=le.attributeValueFn(r[e],e,Pe)),"attributeNameFn"in le)){var t=r[e];delete r[e],r[le.attributeNameFn(e,r[e],Pe)]=t}}return r}function wl(r){var e={};if(r.body&&(r.name.toLowerCase()==="xml"||le.instructionHasAttributes)){for(var t=/([\w:-]+)\s*=\s*(?:"([^"]*)"|'([^']*)'|(\w+))\s*/g,a;(a=t.exec(r.body))!==null;)e[a[1]]=a[2]||a[3]||a[4];e=Fs(e)}if(r.name.toLowerCase()==="xml"){if(le.ignoreDeclaration)return;Pe[le.declarationKey]={},Object.keys(e).length&&(Pe[le.declarationKey][le.attributesKey]=e),le.addParent&&(Pe[le.declarationKey][le.parentKey]=Pe)}else{if(le.ignoreInstruction)return;le.trim&&(r.body=r.body.trim());var l={};le.instructionHasAttributes&&Object.keys(e).length?(l[r.name]={},l[r.name][le.attributesKey]=e):l[r.name]=r.body,kr("instruction",l)}}function yl(r,e){var t;if(typeof r=="object"&&(e=r.attributes,r=r.name),e=Fs(e),"elementNameFn"in le&&(r=le.elementNameFn(r,Pe)),le.compact){if(t={},!le.ignoreAttributes&&e&&Object.keys(e).length){t[le.attributesKey]={};var a;for(a in e)e.hasOwnProperty(a)&&(t[le.attributesKey][a]=e[a])}!(r in Pe)&&(Jt(le.alwaysArray)?le.alwaysArray.indexOf(r)!==-1:le.alwaysArray)&&(Pe[r]=[]),Pe[r]&&!Jt(Pe[r])&&(Pe[r]=[Pe[r]]),Jt(Pe[r])?Pe[r].push(t):Pe[r]=t}else Pe[le.elementsKey]||(Pe[le.elementsKey]=[]),t={},t[le.typeKey]="element",t[le.nameKey]=r,!le.ignoreAttributes&&e&&Object.keys(e).length&&(t[le.attributesKey]=e),le.alwaysChildren&&(t[le.elementsKey]=[]),Pe[le.elementsKey].push(t);t[le.parentKey]=Pe,Pe=t}function vl(r){le.ignoreText||!r.trim()&&!le.captureSpacesBetweenElements||(le.trim&&(r=r.trim()),le.nativeType&&(r=Bs(r)),le.sanitize&&(r=r.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),kr("text",r))}function bl(r){le.ignoreComment||(le.trim&&(r=r.trim()),kr("comment",r))}function _l(r){var e=Pe[le.parentKey];le.addParent||delete Pe[le.parentKey],Pe=e}function xl(r){le.ignoreCdata||(le.trim&&(r=r.trim()),kr("cdata",r))}function El(r){le.ignoreDoctype||(r=r.replace(/^ /,""),le.trim&&(r=r.trim()),kr("doctype",r))}function Tl(r){r.note=r}var Ps=function(r,e){var t=ml.parser(!0,{}),a={};if(Pe=a,le=gl(e),t.opt={strictEntities:!0},t.onopentag=yl,t.ontext=vl,t.oncomment=bl,t.onclosetag=_l,t.onerror=Tl,t.oncdata=xl,t.ondoctype=El,t.onprocessinginstruction=wl,t.write(r).close(),a[le.elementsKey]){var l=a[le.elementsKey];delete a[le.elementsKey],a[le.elementsKey]=l,delete a.text}return a},Co=_i,Al=Ps;function Sl(r){var e=Co.copyOptions(r);return Co.ensureSpacesExists(e),e}var kl=function(r,e){var t,a,l,i;return t=Sl(e),a=Al(r,t),i="compact"in t&&t.compact?"_parent":"parent","addParent"in t&&t.addParent?l=JSON.stringify(a,function(c,n){return c===i?"_":n},t.spaces):l=JSON.stringify(a,null,t.spaces),l.replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")},Ye=_i,Cl=bi.isArray,ct,ut;function Rl(r){var e=Ye.copyOptions(r);return Ye.ensureFlagExists("ignoreDeclaration",e),Ye.ensureFlagExists("ignoreInstruction",e),Ye.ensureFlagExists("ignoreAttributes",e),Ye.ensureFlagExists("ignoreText",e),Ye.ensureFlagExists("ignoreComment",e),Ye.ensureFlagExists("ignoreCdata",e),Ye.ensureFlagExists("ignoreDoctype",e),Ye.ensureFlagExists("compact",e),Ye.ensureFlagExists("indentText",e),Ye.ensureFlagExists("indentCdata",e),Ye.ensureFlagExists("indentAttributes",e),Ye.ensureFlagExists("indentInstruction",e),Ye.ensureFlagExists("fullTagEmptyElement",e),Ye.ensureFlagExists("noQuotesForNativeAttributes",e),Ye.ensureSpacesExists(e),typeof e.spaces=="number"&&(e.spaces=Array(e.spaces+1).join(" ")),Ye.ensureKeyExists("declaration",e),Ye.ensureKeyExists("instruction",e),Ye.ensureKeyExists("attributes",e),Ye.ensureKeyExists("text",e),Ye.ensureKeyExists("comment",e),Ye.ensureKeyExists("cdata",e),Ye.ensureKeyExists("doctype",e),Ye.ensureKeyExists("type",e),Ye.ensureKeyExists("name",e),Ye.ensureKeyExists("elements",e),e}function Ct(r,e,t){return(!t&&r.spaces?`
`:"")+Array(e+1).join(r.spaces)}function Qr(r,e,t){if(e.ignoreAttributes)return"";"attributesFn"in e&&(r=e.attributesFn(r,ut,ct));var a,l,i,c,n=[];for(a in r)r.hasOwnProperty(a)&&r[a]!==null&&r[a]!==void 0&&(c=e.noQuotesForNativeAttributes&&typeof r[a]!="string"?"":'"',l=""+r[a],l=l.replace(/"/g,"&quot;"),i="attributeNameFn"in e?e.attributeNameFn(a,l,ut,ct):a,n.push(e.spaces&&e.indentAttributes?Ct(e,t+1,!1):" "),n.push(i+"="+c+("attributeValueFn"in e?e.attributeValueFn(l,a,ut,ct):l)+c));return r&&Object.keys(r).length&&e.spaces&&e.indentAttributes&&n.push(Ct(e,t,!1)),n.join("")}function Ls(r,e,t){return ct=r,ut="xml",e.ignoreDeclaration?"":"<?xml"+Qr(r[e.attributesKey],e,t)+"?>"}function Us(r,e,t){if(e.ignoreInstruction)return"";var a;for(a in r)if(r.hasOwnProperty(a))break;var l="instructionNameFn"in e?e.instructionNameFn(a,r[a],ut,ct):a;if(typeof r[a]=="object")return ct=r,ut=l,"<?"+l+Qr(r[a][e.attributesKey],e,t)+"?>";var i=r[a]?r[a]:"";return"instructionFn"in e&&(i=e.instructionFn(i,a,ut,ct)),"<?"+l+(i?" "+i:"")+"?>"}function Ms(r,e){return e.ignoreComment?"":"<!--"+("commentFn"in e?e.commentFn(r,ut,ct):r)+"-->"}function js(r,e){return e.ignoreCdata?"":"<![CDATA["+("cdataFn"in e?e.cdataFn(r,ut,ct):r.replace("]]>","]]]]><![CDATA[>"))+"]]>"}function zs(r,e){return e.ignoreDoctype?"":"<!DOCTYPE "+("doctypeFn"in e?e.doctypeFn(r,ut,ct):r)+">"}function xi(r,e){return e.ignoreText?"":(r=""+r,r=r.replace(/&amp;/g,"&"),r=r.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"textFn"in e?e.textFn(r,ut,ct):r)}function Il(r,e){var t;if(r.elements&&r.elements.length)for(t=0;t<r.elements.length;++t)switch(r.elements[t][e.typeKey]){case"text":if(e.indentText)return!0;break;case"cdata":if(e.indentCdata)return!0;break;case"instruction":if(e.indentInstruction)return!0;break;case"doctype":case"comment":case"element":return!0;default:return!0}return!1}function Nl(r,e,t){ct=r,ut=r.name;var a=[],l="elementNameFn"in e?e.elementNameFn(r.name,r):r.name;a.push("<"+l),r[e.attributesKey]&&a.push(Qr(r[e.attributesKey],e,t));var i=r[e.elementsKey]&&r[e.elementsKey].length||r[e.attributesKey]&&r[e.attributesKey]["xml:space"]==="preserve";return i||("fullTagEmptyElementFn"in e?i=e.fullTagEmptyElementFn(r.name,r):i=e.fullTagEmptyElement),i?(a.push(">"),r[e.elementsKey]&&r[e.elementsKey].length&&(a.push(Ws(r[e.elementsKey],e,t+1)),ct=r,ut=r.name),a.push(e.spaces&&Il(r,e)?`
`+Array(t+1).join(e.spaces):""),a.push("</"+l+">")):a.push("/>"),a.join("")}function Ws(r,e,t,a){return r.reduce(function(l,i){var c=Ct(e,t,a&&!l);switch(i.type){case"element":return l+c+Nl(i,e,t);case"comment":return l+c+Ms(i[e.commentKey],e);case"doctype":return l+c+zs(i[e.doctypeKey],e);case"cdata":return l+(e.indentCdata?c:"")+js(i[e.cdataKey],e);case"text":return l+(e.indentText?c:"")+xi(i[e.textKey],e);case"instruction":var n={};return n[i[e.nameKey]]=i[e.attributesKey]?i:i[e.instructionKey],l+(e.indentInstruction?c:"")+Us(n,e,t)}},"")}function Hs(r,e,t){var a;for(a in r)if(r.hasOwnProperty(a))switch(a){case e.parentKey:case e.attributesKey:break;case e.textKey:if(e.indentText||t)return!0;break;case e.cdataKey:if(e.indentCdata||t)return!0;break;case e.instructionKey:if(e.indentInstruction||t)return!0;break;case e.doctypeKey:case e.commentKey:return!0;default:return!0}return!1}function Ol(r,e,t,a,l){ct=r,ut=e;var i="elementNameFn"in t?t.elementNameFn(e,r):e;if(typeof r>"u"||r===null||r==="")return"fullTagEmptyElementFn"in t&&t.fullTagEmptyElementFn(e,r)||t.fullTagEmptyElement?"<"+i+"></"+i+">":"<"+i+"/>";var c=[];if(e){if(c.push("<"+i),typeof r!="object")return c.push(">"+xi(r,t)+"</"+i+">"),c.join("");r[t.attributesKey]&&c.push(Qr(r[t.attributesKey],t,a));var n=Hs(r,t,!0)||r[t.attributesKey]&&r[t.attributesKey]["xml:space"]==="preserve";if(n||("fullTagEmptyElementFn"in t?n=t.fullTagEmptyElementFn(e,r):n=t.fullTagEmptyElement),n)c.push(">");else return c.push("/>"),c.join("")}return c.push($s(r,t,a+1,!1)),ct=r,ut=e,e&&c.push((l?Ct(t,a,!1):"")+"</"+i+">"),c.join("")}function $s(r,e,t,a){var l,i,c,n=[];for(i in r)if(r.hasOwnProperty(i))for(c=Cl(r[i])?r[i]:[r[i]],l=0;l<c.length;++l){switch(i){case e.declarationKey:n.push(Ls(c[l],e,t));break;case e.instructionKey:n.push((e.indentInstruction?Ct(e,t,a):"")+Us(c[l],e,t));break;case e.attributesKey:case e.parentKey:break;case e.textKey:n.push((e.indentText?Ct(e,t,a):"")+xi(c[l],e));break;case e.cdataKey:n.push((e.indentCdata?Ct(e,t,a):"")+js(c[l],e));break;case e.doctypeKey:n.push(Ct(e,t,a)+zs(c[l],e));break;case e.commentKey:n.push(Ct(e,t,a)+Ms(c[l],e));break;default:n.push(Ct(e,t,a)+Ol(c[l],i,e,t,Hs(c[l],e)))}a=a&&!n.length}return n.join("")}var Vs=function(r,e){e=Rl(e);var t=[];return ct=r,ut="_root_",e.compact?t.push($s(r,e,0,!0)):(r[e.declarationKey]&&t.push(Ls(r[e.declarationKey],e,0)),r[e.elementsKey]&&r[e.elementsKey].length&&t.push(Ws(r[e.elementsKey],e,0,!t.length))),t.join("")},Dl=Vs,Bl=function(r,e){r instanceof Buffer&&(r=r.toString());var t=null;if(typeof r=="string")try{t=JSON.parse(r)}catch{throw new Error("The JSON structure is invalid")}else t=r;return Dl(t,e)},Fl=Ps,Pl=kl,Ll=Vs,Ul=Bl,Ks={xml2js:Fl,xml2json:Pl,js2xml:Ll,json2xml:Ul};const Ei=r=>{switch(r.type){case void 0:case"element":const e=new jl(r.name,r.attributes),t=r.elements||[];for(const a of t){const l=Ei(a);l!==void 0&&e.push(l)}return e;case"text":return r.text;default:return}};class Ml extends Fe{}class jl extends ye{static fromXmlString(e){const t=Ks.xml2js(e,{compact:!1});return Ei(t)}constructor(e,t){super(e),t&&this.root.push(new Ml(t))}push(e){this.root.push(e)}}class zl extends ye{constructor(e){super(""),this._attr=e}prepForXml(e){return{_attr:this._attr}}}class Gs extends ye{constructor(e,t){super(e),t&&(this.root=t.root)}}const pt=r=>{if(isNaN(r))throw new Error(`Invalid value '${r}' specified. Must be an integer.`);return Math.floor(r)},en=r=>{const e=pt(r);if(e<0)throw new Error(`Invalid value '${r}' specified. Must be a positive integer.`);return e},qs=(r,e)=>{const t=e*2;if(r.length!==t||isNaN(+`0x${r}`))throw new Error(`Invalid hex value '${r}'. Expected ${t} digit hex value`);return r},Ro=r=>qs(r,1),Xs=r=>{const e=r.slice(-2),t=r.substring(0,r.length-2);return`${Number(t)}${e}`},Zs=r=>{const e=Xs(r);if(parseFloat(e)<0)throw new Error(`Invalid value '${e}' specified. Expected a positive number.`);return e},nr=r=>{if(r==="auto")return r;const e=r.charAt(0)==="#"?r.substring(1):r;return qs(e,3)},Ht=r=>typeof r=="string"?Xs(r):pt(r),Wl=r=>typeof r=="string"?Zs(r):en(r),bt=r=>typeof r=="string"?Zs(r):en(r),Hl=en,$l=en,Vl=r=>r.toISOString();class _e extends ye{constructor(e,t=!0){super(e),t!==!0&&this.root.push(new nt({val:t}))}}class qn extends ye{constructor(e,t){super(e),this.root.push(new nt({val:Wl(t)}))}}class Qt extends ye{constructor(e,t){super(e),this.root.push(new nt({val:t}))}}const _r=(r,e)=>new Lt({name:r,attributes:{value:{key:"w:val",value:e}}});class Ti extends ye{constructor(e,t){super(e),this.root.push(new nt({val:t}))}}class jt extends ye{constructor(e,t){super(e),this.root.push(t)}}class Lt extends ye{constructor({name:e,attributes:t,children:a}){super(e),t&&this.root.push(new Sr(t)),a&&this.root.push(...a)}}const Et={START:"start",LEFT:"left"};class Kl extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{val:"w:val"})}}class Gl extends ye{constructor(e){super("w:jc"),this.root.push(new Kl({val:e}))}}class et extends ye{constructor(e,{color:t,size:a,space:l,style:i}){super(e),this.root.push(new ql({style:i,color:t===void 0?void 0:nr(t),size:a===void 0?void 0:Hl(a),space:l===void 0?void 0:$l(l)}))}}class ql extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{style:"w:val",color:"w:color",size:"w:sz",space:"w:space"})}}const Ai={SINGLE:"single",NONE:"none"};class Xl extends Zr{constructor(e){super("w:pBdr"),e.top&&this.root.push(new et("w:top",e.top)),e.bottom&&this.root.push(new et("w:bottom",e.bottom)),e.left&&this.root.push(new et("w:left",e.left)),e.right&&this.root.push(new et("w:right",e.right))}}class Zl extends ye{constructor(){super("w:pBdr");const e=new et("w:bottom",{color:"auto",space:1,style:Ai.SINGLE,size:6});this.root.push(e)}}class Yl extends ye{constructor({start:e,end:t,left:a,right:l,hanging:i,firstLine:c}){super("w:ind"),this.root.push(new Sr({start:{key:"w:start",value:e===void 0?void 0:Ht(e)},end:{key:"w:end",value:t===void 0?void 0:Ht(t)},left:{key:"w:left",value:a===void 0?void 0:Ht(a)},right:{key:"w:right",value:l===void 0?void 0:Ht(l)},hanging:{key:"w:hanging",value:i===void 0?void 0:bt(i)},firstLine:{key:"w:firstLine",value:c===void 0?void 0:bt(c)}}))}}let Jl=class extends ye{constructor(){super("w:br")}};const Si={BEGIN:"begin",END:"end",SEPARATE:"separate"};class ki extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{type:"w:fldCharType",dirty:"w:dirty"})}}class Br extends ye{constructor(e){super("w:fldChar"),this.root.push(new ki({type:Si.BEGIN,dirty:e}))}}class Fr extends ye{constructor(e){super("w:fldChar"),this.root.push(new ki({type:Si.SEPARATE,dirty:e}))}}class Pr extends ye{constructor(e){super("w:fldChar"),this.root.push(new ki({type:Si.END,dirty:e}))}}const ir={DEFAULT:"default",PRESERVE:"preserve"};class or extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{space:"xml:space"})}}let Ql=class extends ye{constructor(){super("w:instrText"),this.root.push(new or({space:ir.PRESERVE})),this.root.push("PAGE")}};class ec extends ye{constructor(){super("w:instrText"),this.root.push(new or({space:ir.PRESERVE})),this.root.push("NUMPAGES")}}class tc extends ye{constructor(){super("w:instrText"),this.root.push(new or({space:ir.PRESERVE})),this.root.push("SECTIONPAGES")}}class rc extends ye{constructor(){super("w:instrText"),this.root.push(new or({space:ir.PRESERVE})),this.root.push("SECTION")}}class nc extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{fill:"w:fill",color:"w:color",type:"w:val"})}}class Ys extends ye{constructor({fill:e,color:t,type:a}){super("w:shd"),this.root.push(new nc({fill:e===void 0?void 0:nr(e),color:t===void 0?void 0:nr(t),type:a}))}}class ic extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{id:"w:id",author:"w:author",date:"w:date"})}}const oc={DOT:"dot"};class sc extends ye{constructor(e){super("w:em"),this.root.push(new nt({val:e}))}}class ac extends sc{constructor(e=oc.DOT){super(e)}}class lc extends ye{constructor(e){super("w:spacing"),this.root.push(new nt({val:Ht(e)}))}}class cc extends ye{constructor(e){super("w:color"),this.root.push(new nt({val:nr(e)}))}}class uc extends ye{constructor(e){super("w:highlight"),this.root.push(new nt({val:e}))}}class fc extends ye{constructor(e){super("w:highlightCs"),this.root.push(new nt({val:e}))}}const hc=r=>new Lt({name:"w:lang",attributes:{value:{key:"w:val",value:r.value},eastAsia:{key:"w:eastAsia",value:r.eastAsia},bidirectional:{key:"w:bidi",value:r.bidirectional}}});class Io extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{ascii:"w:ascii",cs:"w:cs",eastAsia:"w:eastAsia",hAnsi:"w:hAnsi",hint:"w:hint"})}}class Xn extends ye{constructor(e,t){if(super("w:rFonts"),typeof e=="string"){const a=e;this.root.push(new Io({ascii:a,cs:a,eastAsia:a,hAnsi:a,hint:t}))}else{const a=e;this.root.push(new Io(a))}}}let Js=class extends ye{constructor(e){super("w:vertAlign"),this.root.push(new nt({val:e}))}};class dc extends Js{constructor(){super("superscript")}}class pc extends Js{constructor(){super("subscript")}}const Qs={SINGLE:"single"};class mc extends ye{constructor(e=Qs.SINGLE,t){super("w:u"),this.root.push(new nt({val:e,color:t===void 0?void 0:nr(t)}))}}class Gt extends Zr{constructor(e){var t,a;if(super("w:rPr"),!e)return;e.noProof!==void 0&&this.push(new _e("w:noProof",e.noProof)),e.bold!==void 0&&this.push(new _e("w:b",e.bold)),(e.boldComplexScript===void 0&&e.bold!==void 0||e.boldComplexScript)&&this.push(new _e("w:bCs",(t=e.boldComplexScript)!=null?t:e.bold)),e.italics!==void 0&&this.push(new _e("w:i",e.italics)),(e.italicsComplexScript===void 0&&e.italics!==void 0||e.italicsComplexScript)&&this.push(new _e("w:iCs",(a=e.italicsComplexScript)!=null?a:e.italics)),e.underline&&this.push(new mc(e.underline.type,e.underline.color)),e.effect&&this.push(new Qt("w:effect",e.effect)),e.emphasisMark&&this.push(new ac(e.emphasisMark.type)),e.color&&this.push(new cc(e.color)),e.kern&&this.push(new qn("w:kern",e.kern)),e.position&&this.push(new Qt("w:position",e.position)),e.size!==void 0&&this.push(new qn("w:sz",e.size));const l=e.sizeComplexScript===void 0||e.sizeComplexScript===!0?e.size:e.sizeComplexScript;l&&this.push(new qn("w:szCs",l)),e.rightToLeft!==void 0&&this.push(new _e("w:rtl",e.rightToLeft)),e.smallCaps!==void 0?this.push(new _e("w:smallCaps",e.smallCaps)):e.allCaps!==void 0&&this.push(new _e("w:caps",e.allCaps)),e.strike!==void 0&&this.push(new _e("w:strike",e.strike)),e.doubleStrike!==void 0&&this.push(new _e("w:dstrike",e.doubleStrike)),e.subScript&&this.push(new pc),e.superScript&&this.push(new dc),e.style&&this.push(new Qt("w:rStyle",e.style)),e.font&&(typeof e.font=="string"?this.push(new Xn(e.font)):"name"in e.font?this.push(new Xn(e.font.name,e.font.hint)):this.push(new Xn(e.font))),e.highlight&&this.push(new uc(e.highlight));const i=e.highlightComplexScript===void 0||e.highlightComplexScript===!0?e.highlight:e.highlightComplexScript;i&&this.push(new fc(i)),e.characterSpacing&&this.push(new lc(e.characterSpacing)),e.emboss!==void 0&&this.push(new _e("w:emboss",e.emboss)),e.imprint!==void 0&&this.push(new _e("w:imprint",e.imprint)),e.shading&&this.push(new Ys(e.shading)),e.revision&&this.push(new gc(e.revision)),e.border&&this.push(new et("w:bdr",e.border)),e.snapToGrid!==void 0&&this.push(new _e("w:snapToGrid",e.snapToGrid)),e.vanish&&this.push(new _e("w:vanish",e.vanish)),e.specVanish&&this.push(new _e("w:specVanish",e.vanish)),e.scale!==void 0&&this.push(new Ti("w:w",e.scale)),e.language&&this.push(hc(e.language)),e.math&&this.push(new _e("w:oMath",e.math))}push(e){this.root.push(e)}}class gc extends ye{constructor(e){super("w:rPrChange"),this.root.push(new ic({id:e.id,author:e.author,date:e.date})),this.addChildElement(new Gt(e))}}class si extends ye{constructor(e){var t;return super("w:t"),typeof e=="string"?(this.root.push(new or({space:ir.PRESERVE})),this.root.push(e),this):(this.root.push(new or({space:(t=e.space)!=null?t:ir.DEFAULT})),this.root.push(e.text),this)}}const Lr={CURRENT:"CURRENT",TOTAL_PAGES:"TOTAL_PAGES",TOTAL_PAGES_IN_SECTION:"TOTAL_PAGES_IN_SECTION",CURRENT_SECTION:"SECTION"};class tn extends ye{constructor(e){if(super("w:r"),me(this,"properties"),this.properties=new Gt(e),this.root.push(this.properties),e.break)for(let t=0;t<e.break;t++)this.root.push(new Jl);if(e.children)for(const t of e.children){if(typeof t=="string"){switch(t){case Lr.CURRENT:this.root.push(new Br),this.root.push(new Ql),this.root.push(new Fr),this.root.push(new Pr);break;case Lr.TOTAL_PAGES:this.root.push(new Br),this.root.push(new ec),this.root.push(new Fr),this.root.push(new Pr);break;case Lr.TOTAL_PAGES_IN_SECTION:this.root.push(new Br),this.root.push(new tc),this.root.push(new Fr),this.root.push(new Pr);break;case Lr.CURRENT_SECTION:this.root.push(new Br),this.root.push(new rc),this.root.push(new Fr),this.root.push(new Pr);break;default:this.root.push(new si(t));break}continue}this.root.push(t)}else e.text&&this.root.push(new si(e.text))}}class Vr extends tn{constructor(e){if(typeof e=="string")return super({}),this.root.push(new si(e)),this;super(e)}}let wc="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",yc=(r,e=21)=>(t=e)=>{let a="",l=t;for(;l--;)a+=r[Math.random()*r.length|0];return a},vc=(r=21)=>{let e="",t=r;for(;t--;)e+=wc[Math.random()*64|0];return e};const vt=r=>Math.floor(r*72*20),Ci=(r=0)=>{let e=r;return()=>++e},bc=()=>Ci(),_c=()=>Ci(1),xc=()=>Ci(),Ec=()=>vc().toLowerCase(),xr=r=>yc("1234567890abcdef",r)(),Tc=()=>`${xr(8)}-${xr(4)}-${xr(4)}-${xr(4)}-${xr(12)}`;class Ac extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{id:"w:id",initials:"w:initials",author:"w:author",date:"w:date"})}}class Sc extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{"xmlns:cx":"xmlns:cx","xmlns:cx1":"xmlns:cx1","xmlns:cx2":"xmlns:cx2","xmlns:cx3":"xmlns:cx3","xmlns:cx4":"xmlns:cx4","xmlns:cx5":"xmlns:cx5","xmlns:cx6":"xmlns:cx6","xmlns:cx7":"xmlns:cx7","xmlns:cx8":"xmlns:cx8","xmlns:mc":"xmlns:mc","xmlns:aink":"xmlns:aink","xmlns:am3d":"xmlns:am3d","xmlns:o":"xmlns:o","xmlns:r":"xmlns:r","xmlns:m":"xmlns:m","xmlns:v":"xmlns:v","xmlns:wp14":"xmlns:wp14","xmlns:wp":"xmlns:wp","xmlns:w10":"xmlns:w10","xmlns:w":"xmlns:w","xmlns:w14":"xmlns:w14","xmlns:w15":"xmlns:w15","xmlns:w16cex":"xmlns:w16cex","xmlns:w16cid":"xmlns:w16cid","xmlns:w16":"xmlns:w16","xmlns:w16sdtdh":"xmlns:w16sdtdh","xmlns:w16se":"xmlns:w16se","xmlns:wpg":"xmlns:wpg","xmlns:wpi":"xmlns:wpi","xmlns:wne":"xmlns:wne","xmlns:wps":"xmlns:wps"})}}class kc extends ye{constructor({id:e,initials:t,author:a,date:l=new Date,children:i}){super("w:comment"),this.root.push(new Ac({id:e,initials:t,author:a,date:l.toISOString()}));for(const c of i)this.root.push(c)}}class Cc extends ye{constructor({children:e}){super("w:comments"),this.root.push(new Sc({"xmlns:cx":"http://schemas.microsoft.com/office/drawing/2014/chartex","xmlns:cx1":"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex","xmlns:cx2":"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex","xmlns:cx3":"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex","xmlns:cx4":"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex","xmlns:cx5":"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex","xmlns:cx6":"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex","xmlns:cx7":"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex","xmlns:cx8":"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","xmlns:aink":"http://schemas.microsoft.com/office/drawing/2016/ink","xmlns:am3d":"http://schemas.microsoft.com/office/drawing/2017/model3d","xmlns:o":"urn:schemas-microsoft-com:office:office","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:m":"http://schemas.openxmlformats.org/officeDocument/2006/math","xmlns:v":"urn:schemas-microsoft-com:vml","xmlns:wp14":"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing","xmlns:wp":"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing","xmlns:w10":"urn:schemas-microsoft-com:office:word","xmlns:w":"http://schemas.openxmlformats.org/wordprocessingml/2006/main","xmlns:w14":"http://schemas.microsoft.com/office/word/2010/wordml","xmlns:w15":"http://schemas.microsoft.com/office/word/2012/wordml","xmlns:w16cex":"http://schemas.microsoft.com/office/word/2018/wordml/cex","xmlns:w16cid":"http://schemas.microsoft.com/office/word/2016/wordml/cid","xmlns:w16":"http://schemas.microsoft.com/office/word/2018/wordml","xmlns:w16sdtdh":"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash","xmlns:w16se":"http://schemas.microsoft.com/office/word/2015/wordml/symex","xmlns:wpg":"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup","xmlns:wpi":"http://schemas.microsoft.com/office/word/2010/wordprocessingInk","xmlns:wne":"http://schemas.microsoft.com/office/word/2006/wordml","xmlns:wps":"http://schemas.microsoft.com/office/word/2010/wordprocessingShape"}));for(const t of e)this.root.push(new kc(t))}}class Rc extends ye{constructor(){super("w:pageBreakBefore")}}const ai={AUTO:"auto"};class Ic extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{after:"w:after",before:"w:before",line:"w:line",lineRule:"w:lineRule"})}}class Nc extends ye{constructor(e){super("w:spacing"),this.root.push(new Ic(e))}}let Ur=class extends ye{constructor(e){super("w:pStyle"),this.root.push(new nt({val:e}))}};class Oc extends ye{constructor(e){super("w:tabs");for(const t of e)this.root.push(new Bc(t))}}const No={LEFT:"left",RIGHT:"right"};class Dc extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{val:"w:val",pos:"w:pos",leader:"w:leader"})}}class Bc extends ye{constructor({type:e,position:t,leader:a}){super("w:tab"),this.root.push(new Dc({val:e,pos:t,leader:a}))}}class Oo extends ye{constructor(e,t){super("w:numPr"),this.root.push(new Fc(t)),this.root.push(new Pc(e))}}class Fc extends ye{constructor(e){if(super("w:ilvl"),e>9)throw new Error("Level cannot be greater than 9. Read more here: https://answers.microsoft.com/en-us/msoffice/forum/all/does-word-support-more-than-9-list-levels/d130fdcd-1781-446d-8c84-c6c79124e4d7");this.root.push(new nt({val:e}))}}class Pc extends ye{constructor(e){super("w:numId"),this.root.push(new nt({val:typeof e=="string"?`{${e}}`:e}))}}class Lc extends ye{constructor(){super(...arguments),me(this,"fileChild",Symbol())}}class Uc extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{id:"Id",type:"Type",target:"Target",targetMode:"TargetMode"})}}const Mc={EXTERNAL:"External"};class jc extends ye{constructor(e,t,a,l){super("Relationship"),this.root.push(new Uc({id:e,type:t,target:a,targetMode:l}))}}class zc extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{id:"r:id",history:"w:history",anchor:"w:anchor"})}}class Wc extends ye{constructor(e,t,a){super("w:hyperlink"),me(this,"linkId"),this.linkId=t;const l={history:1,anchor:a||void 0,id:a?void 0:`rId${this.linkId}`},i=new zc(l);this.root.push(i),e.forEach(c=>{this.root.push(c)})}}class Hc extends ye{constructor(e){super("w:externalHyperlink"),this.options=e}}class $c extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{id:"w:id",name:"w:name"})}}class Vc extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{id:"w:id"})}}class Kc{constructor(e){me(this,"bookmarkUniqueNumericId",xc()),me(this,"start"),me(this,"children"),me(this,"end");const t=this.bookmarkUniqueNumericId();this.start=new Gc(e.id,t),this.children=e.children,this.end=new qc(t)}}class Gc extends ye{constructor(e,t){super("w:bookmarkStart");const a=new $c({name:e,id:t});this.root.push(a)}}class qc extends ye{constructor(e){super("w:bookmarkEnd");const t=new Vc({id:e});this.root.push(t)}}class Xc extends ye{constructor(e){super("w:outlineLvl"),this.level=e,this.root.push(new nt({val:e}))}}class Zc extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{verticalAlign:"w:val"})}}class Yc extends ye{constructor(e){super("w:vAlign"),this.root.push(new Zc({verticalAlign:e}))}}const er={DEFAULT:"default",FIRST:"first",EVEN:"even"};class Jc extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{type:"w:type",id:"r:id"})}}const Do={HEADER:"w:headerReference",FOOTER:"w:footerReference"};class Zn extends ye{constructor(e,t){super(e),this.root.push(new Jc({type:t.type||er.DEFAULT,id:`rId${t.id}`}))}}class Qc extends ye{constructor({space:e,count:t,separate:a,equalWidth:l,children:i}){super("w:cols"),this.root.push(new Sr({space:{key:"w:space",value:e===void 0?void 0:bt(e)},count:{key:"w:num",value:t===void 0?void 0:pt(t)},separate:{key:"w:sep",value:a},equalWidth:{key:"w:equalWidth",value:l}})),!l&&i&&i.forEach(c=>this.addChildElement(c))}}class eu extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{type:"w:type",linePitch:"w:linePitch",charSpace:"w:charSpace"})}}class tu extends ye{constructor(e,t,a){super("w:docGrid"),this.root.push(new eu({type:a,linePitch:pt(e),charSpace:t?pt(t):void 0}))}}const ru=({countBy:r,start:e,restart:t,distance:a})=>new Lt({name:"w:lnNumType",attributes:{countBy:{key:"w:countBy",value:r===void 0?void 0:pt(r)},start:{key:"w:start",value:e===void 0?void 0:pt(e)},restart:{key:"w:restart",value:t},distance:{key:"w:distance",value:a===void 0?void 0:bt(a)}}});class Bo extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{display:"w:display",offsetFrom:"w:offsetFrom",zOrder:"w:zOrder"})}}class nu extends Zr{constructor(e){if(super("w:pgBorders"),!e)return this;e.pageBorders?this.root.push(new Bo({display:e.pageBorders.display,offsetFrom:e.pageBorders.offsetFrom,zOrder:e.pageBorders.zOrder})):this.root.push(new Bo({})),e.pageBorderTop&&this.root.push(new et("w:top",e.pageBorderTop)),e.pageBorderLeft&&this.root.push(new et("w:left",e.pageBorderLeft)),e.pageBorderBottom&&this.root.push(new et("w:bottom",e.pageBorderBottom)),e.pageBorderRight&&this.root.push(new et("w:right",e.pageBorderRight))}}class iu extends ye{constructor(e,t,a,l,i,c,n){super("w:pgMar"),this.root.push(new Sr({top:{key:"w:top",value:Ht(e)},right:{key:"w:right",value:bt(t)},bottom:{key:"w:bottom",value:Ht(a)},left:{key:"w:left",value:bt(l)},header:{key:"w:header",value:bt(i)},footer:{key:"w:footer",value:bt(c)},gutter:{key:"w:gutter",value:bt(n)}}))}}class ou extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{start:"w:start",formatType:"w:fmt",separator:"w:chapSep"})}}class su extends ye{constructor({start:e,formatType:t,separator:a}){super("w:pgNumType"),this.root.push(new ou({start:e===void 0?void 0:pt(e),formatType:t,separator:a}))}}const ea={PORTRAIT:"portrait",LANDSCAPE:"landscape"};class au extends ye{constructor(e,t,a){super("w:pgSz");const l=a===ea.LANDSCAPE,i=bt(e),c=bt(t);this.root.push(new Sr({width:{key:"w:w",value:l?c:i},height:{key:"w:h",value:l?i:c},orientation:{key:"w:orient",value:a}}))}}class lu extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{val:"w:val"})}}class cu extends ye{constructor(e){super("w:textDirection"),this.root.push(new lu({val:e}))}}class uu extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{val:"w:val"})}}class fu extends ye{constructor(e){super("w:type"),this.root.push(new uu({val:e}))}}const zt={TOP:1440,RIGHT:1440,BOTTOM:1440,LEFT:1440,HEADER:708,FOOTER:708,GUTTER:0},Yn={WIDTH:11906,HEIGHT:16838,ORIENTATION:ea.PORTRAIT};class hu extends ye{constructor({page:{size:{width:e=Yn.WIDTH,height:t=Yn.HEIGHT,orientation:a=Yn.ORIENTATION}={},margin:{top:l=zt.TOP,right:i=zt.RIGHT,bottom:c=zt.BOTTOM,left:n=zt.LEFT,header:u=zt.HEADER,footer:w=zt.FOOTER,gutter:y=zt.GUTTER}={},pageNumbers:_={},borders:E,textDirection:p}={},grid:{linePitch:T=360,charSpace:m,type:S}={},headerWrapperGroup:f={},footerWrapperGroup:x={},lineNumbers:k,titlePage:N,verticalAlign:C,column:H,type:$}={}){super("w:sectPr"),this.addHeaderFooterGroup(Do.HEADER,f),this.addHeaderFooterGroup(Do.FOOTER,x),$&&this.root.push(new fu($)),this.root.push(new au(e,t,a)),this.root.push(new iu(l,i,c,n,u,w,y)),E&&this.root.push(new nu(E)),k&&this.root.push(ru(k)),this.root.push(new su(_)),H&&this.root.push(new Qc(H)),C&&this.root.push(new Yc(C)),N!==void 0&&this.root.push(new _e("w:titlePg",N)),p&&this.root.push(new cu(p)),this.root.push(new tu(T,m,S))}addHeaderFooterGroup(e,t){t.default&&this.root.push(new Zn(e,{type:er.DEFAULT,id:t.default.View.ReferenceId})),t.first&&this.root.push(new Zn(e,{type:er.FIRST,id:t.first.View.ReferenceId})),t.even&&this.root.push(new Zn(e,{type:er.EVEN,id:t.even.View.ReferenceId}))}}class du extends ye{constructor(){super("w:body"),me(this,"sections",[])}addSection(e){const t=this.sections.pop();this.root.push(this.createSectionParagraph(t)),this.sections.push(new hu(e))}prepForXml(e){return this.sections.length===1&&(this.root.splice(0,1),this.root.push(this.sections.pop())),super.prepForXml(e)}push(e){this.root.push(e)}createSectionParagraph(e){const t=new Ar({}),a=new sr({});return a.push(e),t.addChildElement(a),t}}class Cr extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",Ignorable:"mc:Ignorable",cp:"xmlns:cp",dc:"xmlns:dc",dcterms:"xmlns:dcterms",dcmitype:"xmlns:dcmitype",xsi:"xmlns:xsi",type:"xsi:type",cx:"xmlns:cx",cx1:"xmlns:cx1",cx2:"xmlns:cx2",cx3:"xmlns:cx3",cx4:"xmlns:cx4",cx5:"xmlns:cx5",cx6:"xmlns:cx6",cx7:"xmlns:cx7",cx8:"xmlns:cx8",aink:"xmlns:aink",am3d:"xmlns:am3d",w16cex:"xmlns:w16cex",w16cid:"xmlns:w16cid",w16:"xmlns:w16",w16sdtdh:"xmlns:w16sdtdh",w16se:"xmlns:w16se"})}}class pu extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{color:"w:color",themeColor:"w:themeColor",themeShade:"w:themeShade",themeTint:"w:themeTint"})}}class mu extends ye{constructor(e){super("w:background"),this.root.push(new pu({color:e.color===void 0?void 0:nr(e.color),themeColor:e.themeColor,themeShade:e.themeShade===void 0?void 0:Ro(e.themeShade),themeTint:e.themeTint===void 0?void 0:Ro(e.themeTint)}))}}class gu extends ye{constructor(e){super("w:document"),me(this,"body"),this.root.push(new Cr({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",cx:"http://schemas.microsoft.com/office/drawing/2014/chartex",cx1:"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex",cx2:"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex",cx3:"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex",cx4:"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex",cx5:"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex",cx6:"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex",cx7:"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex",cx8:"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex",aink:"http://schemas.microsoft.com/office/drawing/2016/ink",am3d:"http://schemas.microsoft.com/office/drawing/2017/model3d",w16cex:"http://schemas.microsoft.com/office/word/2018/wordml/cex",w16cid:"http://schemas.microsoft.com/office/word/2016/wordml/cid",w16:"http://schemas.microsoft.com/office/word/2018/wordml",w16sdtdh:"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash",w16se:"http://schemas.microsoft.com/office/word/2015/wordml/symex",Ignorable:"w14 w15 wp14"})),this.body=new du,e.background&&this.root.push(new mu(e.background)),this.root.push(this.body)}add(e){return this.body.push(e),this}get Body(){return this.body}}class wu extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{xmlns:"xmlns"})}}class mr extends ye{constructor(){super("Relationships"),this.root.push(new wu({xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"}))}createRelationship(e,t,a,l){const i=new jc(`rId${e}`,t,a,l);return this.root.push(i),i}get RelationshipCount(){return this.root.length-1}}class ta{constructor(e){me(this,"document"),me(this,"relationships"),this.document=new gu(e),this.relationships=new mr}get View(){return this.document}get Relationships(){return this.relationships}}class yu extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{val:"w:val"})}}class vu extends ye{constructor(){super("w:wordWrap"),this.root.push(new yu({val:0}))}}const bu=r=>{var e,t;return new Lt({name:"w:framePr",attributes:{anchorLock:{key:"w:anchorLock",value:r.anchorLock},dropCap:{key:"w:dropCap",value:r.dropCap},width:{key:"w:w",value:r.width},height:{key:"w:h",value:r.height},x:{key:"w:x",value:r.position?r.position.x:void 0},y:{key:"w:y",value:r.position?r.position.y:void 0},anchorHorizontal:{key:"w:hAnchor",value:r.anchor.horizontal},anchorVertical:{key:"w:vAnchor",value:r.anchor.vertical},spaceHorizontal:{key:"w:hSpace",value:(e=r.space)==null?void 0:e.horizontal},spaceVertical:{key:"w:vSpace",value:(t=r.space)==null?void 0:t.vertical},rule:{key:"w:hRule",value:r.rule},alignmentX:{key:"w:xAlign",value:r.alignment?r.alignment.x:void 0},alignmentY:{key:"w:yAlign",value:r.alignment?r.alignment.y:void 0},lines:{key:"w:lines",value:r.lines},wrap:{key:"w:wrap",value:r.wrap}}})};class sr extends Zr{constructor(e){var t,a;if(super("w:pPr"),me(this,"numberingReferences",[]),!e)return this;e.heading&&this.push(new Ur(e.heading)),e.bullet&&this.push(new Ur("ListParagraph")),e.numbering&&!e.style&&!e.heading&&(e.numbering.custom||this.push(new Ur("ListParagraph"))),e.style&&this.push(new Ur(e.style)),e.keepNext!==void 0&&this.push(new _e("w:keepNext",e.keepNext)),e.keepLines!==void 0&&this.push(new _e("w:keepLines",e.keepLines)),e.pageBreakBefore&&this.push(new Rc),e.frame&&this.push(bu(e.frame)),e.widowControl!==void 0&&this.push(new _e("w:widowControl",e.widowControl)),e.bullet&&this.push(new Oo(1,e.bullet.level)),e.numbering&&(this.numberingReferences.push({reference:e.numbering.reference,instance:(t=e.numbering.instance)!=null?t:0}),this.push(new Oo(`${e.numbering.reference}-${(a=e.numbering.instance)!=null?a:0}`,e.numbering.level))),e.border&&this.push(new Xl(e.border)),e.thematicBreak&&this.push(new Zl),e.shading&&this.push(new Ys(e.shading)),e.wordWrap&&this.push(new vu),e.overflowPunctuation&&this.push(new _e("w:overflowPunct",e.overflowPunctuation));const l=[...e.rightTabStop!==void 0?[{type:No.RIGHT,position:e.rightTabStop}]:[],...e.tabStops?e.tabStops:[],...e.leftTabStop!==void 0?[{type:No.LEFT,position:e.leftTabStop}]:[]];l.length>0&&this.push(new Oc(l)),e.bidirectional!==void 0&&this.push(new _e("w:bidi",e.bidirectional)),e.spacing&&this.push(new Nc(e.spacing)),e.indent&&this.push(new Yl(e.indent)),e.contextualSpacing!==void 0&&this.push(new _e("w:contextualSpacing",e.contextualSpacing)),e.alignment&&this.push(new Gl(e.alignment)),e.outlineLevel!==void 0&&this.push(new Xc(e.outlineLevel)),e.suppressLineNumbers!==void 0&&this.push(new _e("w:suppressLineNumbers",e.suppressLineNumbers)),e.autoSpaceEastAsianText!==void 0&&this.push(new _e("w:autoSpaceDN",e.autoSpaceEastAsianText)),e.run&&this.push(new Gt(e.run))}push(e){this.root.push(e)}prepForXml(e){if(e.viewWrapper instanceof ta)for(const t of this.numberingReferences)e.file.Numbering.createConcreteNumberingInstance(t.reference,t.instance);return super.prepForXml(e)}}class Ar extends Lc{constructor(e){if(super("w:p"),me(this,"properties"),typeof e=="string")return this.properties=new sr({}),this.root.push(this.properties),this.root.push(new Vr(e)),this;if(this.properties=new sr(e),this.root.push(this.properties),e.text&&this.root.push(new Vr(e.text)),e.children)for(const t of e.children){if(t instanceof Kc){this.root.push(t.start);for(const a of t.children)this.root.push(a);this.root.push(t.end);continue}this.root.push(t)}}prepForXml(e){for(const t of this.root)if(t instanceof Hc){const a=this.root.indexOf(t),l=new Wc(t.options.children,Ec());e.viewWrapper.Relationships.createRelationship(l.linkId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",t.options.link,Mc.EXTERNAL),this.root[a]=l}return super.prepForXml(e)}addRunToFront(e){return this.root.splice(1,0,e),this}}const qt={style:Ai.NONE,size:0,color:"auto"},Xt={style:Ai.SINGLE,size:4,color:"auto"};class _u extends ye{constructor(e){super("w:tblBorders"),e.top?this.root.push(new et("w:top",e.top)):this.root.push(new et("w:top",Xt)),e.left?this.root.push(new et("w:left",e.left)):this.root.push(new et("w:left",Xt)),e.bottom?this.root.push(new et("w:bottom",e.bottom)):this.root.push(new et("w:bottom",Xt)),e.right?this.root.push(new et("w:right",e.right)):this.root.push(new et("w:right",Xt)),e.insideHorizontal?this.root.push(new et("w:insideH",e.insideHorizontal)):this.root.push(new et("w:insideH",Xt)),e.insideVertical?this.root.push(new et("w:insideV",e.insideVertical)):this.root.push(new et("w:insideV",Xt))}}me(_u,"NONE",{top:qt,bottom:qt,left:qt,right:qt,insideHorizontal:qt,insideVertical:qt});class xu extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{xmlns:"xmlns",vt:"xmlns:vt"})}}class Eu extends ye{constructor(){super("Properties"),this.root.push(new xu({xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"}))}}class Tu extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{xmlns:"xmlns"})}}class Au extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{contentType:"ContentType",extension:"Extension"})}}class Bt extends ye{constructor(e,t){super("Default"),this.root.push(new Au({contentType:e,extension:t}))}}class Su extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{contentType:"ContentType",partName:"PartName"})}}class wt extends ye{constructor(e,t){super("Override"),this.root.push(new Su({contentType:e,partName:t}))}}class ku extends ye{constructor(){super("Types"),this.root.push(new Tu({xmlns:"http://schemas.openxmlformats.org/package/2006/content-types"})),this.root.push(new Bt("image/png","png")),this.root.push(new Bt("image/jpeg","jpeg")),this.root.push(new Bt("image/jpeg","jpg")),this.root.push(new Bt("image/bmp","bmp")),this.root.push(new Bt("image/gif","gif")),this.root.push(new Bt("application/vnd.openxmlformats-package.relationships+xml","rels")),this.root.push(new Bt("application/xml","xml")),this.root.push(new Bt("application/vnd.openxmlformats-officedocument.obfuscatedFont","odttf")),this.root.push(new wt("application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml","/word/document.xml")),this.root.push(new wt("application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml","/word/styles.xml")),this.root.push(new wt("application/vnd.openxmlformats-package.core-properties+xml","/docProps/core.xml")),this.root.push(new wt("application/vnd.openxmlformats-officedocument.custom-properties+xml","/docProps/custom.xml")),this.root.push(new wt("application/vnd.openxmlformats-officedocument.extended-properties+xml","/docProps/app.xml")),this.root.push(new wt("application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml","/word/numbering.xml")),this.root.push(new wt("application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml","/word/footnotes.xml")),this.root.push(new wt("application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml","/word/settings.xml")),this.root.push(new wt("application/vnd.openxmlformats-officedocument.wordprocessingml.comments+xml","/word/comments.xml")),this.root.push(new wt("application/vnd.openxmlformats-officedocument.wordprocessingml.fontTable+xml","/word/fontTable.xml"))}addFooter(e){this.root.push(new wt("application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml",`/word/footer${e}.xml`))}addHeader(e){this.root.push(new wt("application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml",`/word/header${e}.xml`))}}class Cu extends ye{constructor(e){super("cp:coreProperties"),this.root.push(new Cr({cp:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",xsi:"http://www.w3.org/2001/XMLSchema-instance"})),e.title&&this.root.push(new jt("dc:title",e.title)),e.subject&&this.root.push(new jt("dc:subject",e.subject)),e.creator&&this.root.push(new jt("dc:creator",e.creator)),e.keywords&&this.root.push(new jt("cp:keywords",e.keywords)),e.description&&this.root.push(new jt("dc:description",e.description)),e.lastModifiedBy&&this.root.push(new jt("cp:lastModifiedBy",e.lastModifiedBy)),e.revision&&this.root.push(new jt("cp:revision",String(e.revision))),this.root.push(new Fo("dcterms:created")),this.root.push(new Fo("dcterms:modified"))}}class Fo extends ye{constructor(e){super(e),this.root.push(new Cr({type:"dcterms:W3CDTF"})),this.root.push(Vl(new Date))}}class Ru extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{xmlns:"xmlns",vt:"xmlns:vt"})}}class Iu extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{fmtid:"fmtid",pid:"pid",name:"name"})}}class Nu extends ye{constructor(e,t){super("property"),this.root.push(new Iu({fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:e.toString(),name:t.name})),this.root.push(new Ou(t.value))}}class Ou extends ye{constructor(e){super("vt:lpwstr"),this.root.push(e)}}class Du extends ye{constructor(e){super("Properties"),me(this,"nextId"),me(this,"properties",[]),this.root.push(new Ru({xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"})),this.nextId=2;for(const t of e)this.addCustomProperty(t)}prepForXml(e){return this.properties.forEach(t=>this.root.push(t)),super.prepForXml(e)}addCustomProperty(e){this.properties.push(new Nu(this.nextId++,e))}}class Bu extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",cp:"xmlns:cp",dc:"xmlns:dc",dcterms:"xmlns:dcterms",dcmitype:"xmlns:dcmitype",xsi:"xmlns:xsi",type:"xsi:type"})}}let Fu=class extends Gs{constructor(e,t){super("w:ftr",t),me(this,"refId"),this.refId=e,t||this.root.push(new Bu({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape"}))}get ReferenceId(){return this.refId}add(e){this.root.push(e)}};class Pu{constructor(e,t,a){me(this,"footer"),me(this,"relationships"),this.media=e,this.footer=new Fu(t,a),this.relationships=new mr}add(e){this.footer.add(e)}addChildElement(e){this.footer.addChildElement(e)}get View(){return this.footer}get Relationships(){return this.relationships}get Media(){return this.media}}class Lu extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{type:"w:type",id:"w:id"})}}class Uu extends ye{constructor(){super("w:footnoteRef")}}class Mu extends tn{constructor(){super({style:"FootnoteReference"}),this.root.push(new Uu)}}const Po={SEPERATOR:"separator",CONTINUATION_SEPERATOR:"continuationSeparator"};class Jn extends ye{constructor(e){super("w:footnote"),this.root.push(new Lu({type:e.type,id:e.id}));for(let t=0;t<e.children.length;t++){const a=e.children[t];t===0&&a.addRunToFront(new Mu),this.root.push(a)}}}class ju extends ye{constructor(){super("w:continuationSeparator")}}class zu extends tn{constructor(){super({}),this.root.push(new ju)}}class Wu extends ye{constructor(){super("w:separator")}}class Hu extends tn{constructor(){super({}),this.root.push(new Wu)}}class $u extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",Ignorable:"mc:Ignorable"})}}class Vu extends ye{constructor(){super("w:footnotes"),this.root.push(new $u({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",Ignorable:"w14 w15 wp14"}));const e=new Jn({id:-1,type:Po.SEPERATOR,children:[new Ar({spacing:{after:0,line:240,lineRule:ai.AUTO},children:[new Hu]})]});this.root.push(e);const t=new Jn({id:0,type:Po.CONTINUATION_SEPERATOR,children:[new Ar({spacing:{after:0,line:240,lineRule:ai.AUTO},children:[new zu]})]});this.root.push(t)}createFootNote(e,t){const a=new Jn({id:e,children:t});this.root.push(a)}}class Ku{constructor(){me(this,"footnotess"),me(this,"relationships"),this.footnotess=new Vu,this.relationships=new mr}get View(){return this.footnotess}get Relationships(){return this.relationships}}class Gu extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",cp:"xmlns:cp",dc:"xmlns:dc",dcterms:"xmlns:dcterms",dcmitype:"xmlns:dcmitype",xsi:"xmlns:xsi",type:"xsi:type",cx:"xmlns:cx",cx1:"xmlns:cx1",cx2:"xmlns:cx2",cx3:"xmlns:cx3",cx4:"xmlns:cx4",cx5:"xmlns:cx5",cx6:"xmlns:cx6",cx7:"xmlns:cx7",cx8:"xmlns:cx8",w16cid:"xmlns:w16cid",w16se:"xmlns:w16se"})}}let qu=class extends Gs{constructor(e,t){super("w:hdr",t),me(this,"refId"),this.refId=e,t||this.root.push(new Gu({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",cx:"http://schemas.microsoft.com/office/drawing/2014/chartex",cx1:"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex",cx2:"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex",cx3:"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex",cx4:"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex",cx5:"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex",cx6:"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex",cx7:"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex",cx8:"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex",w16cid:"http://schemas.microsoft.com/office/word/2016/wordml/cid",w16se:"http://schemas.microsoft.com/office/word/2015/wordml/symex"}))}get ReferenceId(){return this.refId}add(e){this.root.push(e)}};class Xu{constructor(e,t,a){me(this,"header"),me(this,"relationships"),this.media=e,this.header=new qu(t,a),this.relationships=new mr}add(e){return this.header.add(e),this}addChildElement(e){this.header.addChildElement(e)}get View(){return this.header}get Relationships(){return this.relationships}get Media(){return this.media}}class Zu{constructor(){me(this,"map"),this.map=new Map}addImage(e,t){this.map.set(e,t)}get Array(){return Array.from(this.map.values())}}const Nt={BULLET:"bullet"};class Yu extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{ilvl:"w:ilvl",tentative:"w15:tentative"})}}class Ju extends ye{constructor(e){super("w:numFmt"),this.root.push(new nt({val:e}))}}class Qu extends ye{constructor(e){super("w:lvlText"),this.root.push(new nt({val:e}))}}class ef extends ye{constructor(e){super("w:lvlJc"),this.root.push(new nt({val:e}))}}class tf extends ye{constructor(e){super("w:suff"),this.root.push(new nt({val:e}))}}class rf extends ye{constructor(){super("w:isLgl")}}class nf extends ye{constructor({level:e,format:t,text:a,alignment:l=Et.START,start:i=1,style:c,suffix:n,isLegalNumberingStyle:u}){if(super("w:lvl"),me(this,"paragraphProperties"),me(this,"runProperties"),this.root.push(new Ti("w:start",pt(i))),t&&this.root.push(new Ju(t)),n&&this.root.push(new tf(n)),u&&this.root.push(new rf),a&&this.root.push(new Qu(a)),this.root.push(new ef(l)),this.paragraphProperties=new sr(c&&c.paragraph),this.runProperties=new Gt(c&&c.run),this.root.push(this.paragraphProperties),this.root.push(this.runProperties),e>9)throw new Error("Level cannot be greater than 9. Read more here: https://answers.microsoft.com/en-us/msoffice/forum/all/does-word-support-more-than-9-list-levels/d130fdcd-1781-446d-8c84-c6c79124e4d7");this.root.push(new Yu({ilvl:pt(e),tentative:1}))}}class of extends nf{}class sf extends ye{constructor(e){super("w:multiLevelType"),this.root.push(new nt({val:e}))}}class af extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{abstractNumId:"w:abstractNumId",restartNumberingAfterBreak:"w15:restartNumberingAfterBreak"})}}class Lo extends ye{constructor(e,t){super("w:abstractNum"),me(this,"id"),this.root.push(new af({abstractNumId:pt(e),restartNumberingAfterBreak:0})),this.root.push(new sf("hybridMultilevel")),this.id=e;for(const a of t)this.root.push(new of(a))}}class lf extends ye{constructor(e){super("w:abstractNumId"),this.root.push(new nt({val:e}))}}class cf extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{numId:"w:numId"})}}class Uo extends ye{constructor(e){if(super("w:num"),me(this,"numId"),me(this,"reference"),me(this,"instance"),this.numId=e.numId,this.reference=e.reference,this.instance=e.instance,this.root.push(new cf({numId:pt(e.numId)})),this.root.push(new lf(pt(e.abstractNumId))),e.overrideLevels&&e.overrideLevels.length)for(const t of e.overrideLevels)this.root.push(new ff(t.num,t.start))}}class uf extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{ilvl:"w:ilvl"})}}class ff extends ye{constructor(e,t){super("w:lvlOverride"),this.root.push(new uf({ilvl:e})),t!==void 0&&this.root.push(new df(t))}}class hf extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{val:"w:val"})}}class df extends ye{constructor(e){super("w:startOverride"),this.root.push(new hf({val:e}))}}class pf extends ye{constructor(e){super("w:numbering"),me(this,"abstractNumberingMap",new Map),me(this,"concreteNumberingMap",new Map),me(this,"referenceConfigMap",new Map),me(this,"abstractNumUniqueNumericId",bc()),me(this,"concreteNumUniqueNumericId",_c()),this.root.push(new Cr({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",Ignorable:"w14 w15 wp14"}));const t=new Lo(this.abstractNumUniqueNumericId(),[{level:0,format:Nt.BULLET,text:"",alignment:Et.LEFT,style:{paragraph:{indent:{left:vt(.5),hanging:vt(.25)}}}},{level:1,format:Nt.BULLET,text:"",alignment:Et.LEFT,style:{paragraph:{indent:{left:vt(1),hanging:vt(.25)}}}},{level:2,format:Nt.BULLET,text:"",alignment:Et.LEFT,style:{paragraph:{indent:{left:2160,hanging:vt(.25)}}}},{level:3,format:Nt.BULLET,text:"",alignment:Et.LEFT,style:{paragraph:{indent:{left:2880,hanging:vt(.25)}}}},{level:4,format:Nt.BULLET,text:"",alignment:Et.LEFT,style:{paragraph:{indent:{left:3600,hanging:vt(.25)}}}},{level:5,format:Nt.BULLET,text:"",alignment:Et.LEFT,style:{paragraph:{indent:{left:4320,hanging:vt(.25)}}}},{level:6,format:Nt.BULLET,text:"",alignment:Et.LEFT,style:{paragraph:{indent:{left:5040,hanging:vt(.25)}}}},{level:7,format:Nt.BULLET,text:"",alignment:Et.LEFT,style:{paragraph:{indent:{left:5760,hanging:vt(.25)}}}},{level:8,format:Nt.BULLET,text:"",alignment:Et.LEFT,style:{paragraph:{indent:{left:6480,hanging:vt(.25)}}}}]);this.concreteNumberingMap.set("default-bullet-numbering",new Uo({numId:1,abstractNumId:t.id,reference:"default-bullet-numbering",instance:0,overrideLevels:[{num:0,start:1}]})),this.abstractNumberingMap.set("default-bullet-numbering",t);for(const a of e.config)this.abstractNumberingMap.set(a.reference,new Lo(this.abstractNumUniqueNumericId(),a.levels)),this.referenceConfigMap.set(a.reference,a.levels)}prepForXml(e){for(const t of this.abstractNumberingMap.values())this.root.push(t);for(const t of this.concreteNumberingMap.values())this.root.push(t);return super.prepForXml(e)}createConcreteNumberingInstance(e,t){const a=this.abstractNumberingMap.get(e);if(!a)return;const l=`${e}-${t}`;if(this.concreteNumberingMap.has(l))return;const i=this.referenceConfigMap.get(e),c=i&&i[0].start,n={numId:this.concreteNumUniqueNumericId(),abstractNumId:a.id,reference:e,instance:t,overrideLevels:[c&&Number.isInteger(c)?{num:0,start:c}:{num:0,start:1}]};this.concreteNumberingMap.set(l,new Uo(n))}get ConcreteNumbering(){return Array.from(this.concreteNumberingMap.values())}get ReferenceConfig(){return Array.from(this.referenceConfigMap.values())}}class mf extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{version:"w:val",name:"w:name",uri:"w:uri"})}}class gf extends ye{constructor(e){super("w:compatSetting"),this.root.push(new mf({version:e,uri:"http://schemas.microsoft.com/office/word",name:"compatibilityMode"}))}}class wf extends ye{constructor(e){super("w:compat"),e.version&&this.root.push(new gf(e.version)),e.useSingleBorderforContiguousCells&&this.root.push(new _e("w:useSingleBorderforContiguousCells",e.useSingleBorderforContiguousCells)),e.wordPerfectJustification&&this.root.push(new _e("w:wpJustification",e.wordPerfectJustification)),e.noTabStopForHangingIndent&&this.root.push(new _e("w:noTabHangInd",e.noTabStopForHangingIndent)),e.noLeading&&this.root.push(new _e("w:noLeading",e.noLeading)),e.spaceForUnderline&&this.root.push(new _e("w:spaceForUL",e.spaceForUnderline)),e.noColumnBalance&&this.root.push(new _e("w:noColumnBalance",e.noColumnBalance)),e.balanceSingleByteDoubleByteWidth&&this.root.push(new _e("w:balanceSingleByteDoubleByteWidth",e.balanceSingleByteDoubleByteWidth)),e.noExtraLineSpacing&&this.root.push(new _e("w:noExtraLineSpacing",e.noExtraLineSpacing)),e.doNotLeaveBackslashAlone&&this.root.push(new _e("w:doNotLeaveBackslashAlone",e.doNotLeaveBackslashAlone)),e.underlineTrailingSpaces&&this.root.push(new _e("w:ulTrailSpace",e.underlineTrailingSpaces)),e.doNotExpandShiftReturn&&this.root.push(new _e("w:doNotExpandShiftReturn",e.doNotExpandShiftReturn)),e.spacingInWholePoints&&this.root.push(new _e("w:spacingInWholePoints",e.spacingInWholePoints)),e.lineWrapLikeWord6&&this.root.push(new _e("w:lineWrapLikeWord6",e.lineWrapLikeWord6)),e.printBodyTextBeforeHeader&&this.root.push(new _e("w:printBodyTextBeforeHeader",e.printBodyTextBeforeHeader)),e.printColorsBlack&&this.root.push(new _e("w:printColBlack",e.printColorsBlack)),e.spaceWidth&&this.root.push(new _e("w:wpSpaceWidth",e.spaceWidth)),e.showBreaksInFrames&&this.root.push(new _e("w:showBreaksInFrames",e.showBreaksInFrames)),e.subFontBySize&&this.root.push(new _e("w:subFontBySize",e.subFontBySize)),e.suppressBottomSpacing&&this.root.push(new _e("w:suppressBottomSpacing",e.suppressBottomSpacing)),e.suppressTopSpacing&&this.root.push(new _e("w:suppressTopSpacing",e.suppressTopSpacing)),e.suppressSpacingAtTopOfPage&&this.root.push(new _e("w:suppressSpacingAtTopOfPage",e.suppressSpacingAtTopOfPage)),e.suppressTopSpacingWP&&this.root.push(new _e("w:suppressTopSpacingWP",e.suppressTopSpacingWP)),e.suppressSpBfAfterPgBrk&&this.root.push(new _e("w:suppressSpBfAfterPgBrk",e.suppressSpBfAfterPgBrk)),e.swapBordersFacingPages&&this.root.push(new _e("w:swapBordersFacingPages",e.swapBordersFacingPages)),e.convertMailMergeEsc&&this.root.push(new _e("w:convMailMergeEsc",e.convertMailMergeEsc)),e.truncateFontHeightsLikeWP6&&this.root.push(new _e("w:truncateFontHeightsLikeWP6",e.truncateFontHeightsLikeWP6)),e.macWordSmallCaps&&this.root.push(new _e("w:mwSmallCaps",e.macWordSmallCaps)),e.usePrinterMetrics&&this.root.push(new _e("w:usePrinterMetrics",e.usePrinterMetrics)),e.doNotSuppressParagraphBorders&&this.root.push(new _e("w:doNotSuppressParagraphBorders",e.doNotSuppressParagraphBorders)),e.wrapTrailSpaces&&this.root.push(new _e("w:wrapTrailSpaces",e.wrapTrailSpaces)),e.footnoteLayoutLikeWW8&&this.root.push(new _e("w:footnoteLayoutLikeWW8",e.footnoteLayoutLikeWW8)),e.shapeLayoutLikeWW8&&this.root.push(new _e("w:shapeLayoutLikeWW8",e.shapeLayoutLikeWW8)),e.alignTablesRowByRow&&this.root.push(new _e("w:alignTablesRowByRow",e.alignTablesRowByRow)),e.forgetLastTabAlignment&&this.root.push(new _e("w:forgetLastTabAlignment",e.forgetLastTabAlignment)),e.adjustLineHeightInTable&&this.root.push(new _e("w:adjustLineHeightInTable",e.adjustLineHeightInTable)),e.autoSpaceLikeWord95&&this.root.push(new _e("w:autoSpaceLikeWord95",e.autoSpaceLikeWord95)),e.noSpaceRaiseLower&&this.root.push(new _e("w:noSpaceRaiseLower",e.noSpaceRaiseLower)),e.doNotUseHTMLParagraphAutoSpacing&&this.root.push(new _e("w:doNotUseHTMLParagraphAutoSpacing",e.doNotUseHTMLParagraphAutoSpacing)),e.layoutRawTableWidth&&this.root.push(new _e("w:layoutRawTableWidth",e.layoutRawTableWidth)),e.layoutTableRowsApart&&this.root.push(new _e("w:layoutTableRowsApart",e.layoutTableRowsApart)),e.useWord97LineBreakRules&&this.root.push(new _e("w:useWord97LineBreakRules",e.useWord97LineBreakRules)),e.doNotBreakWrappedTables&&this.root.push(new _e("w:doNotBreakWrappedTables",e.doNotBreakWrappedTables)),e.doNotSnapToGridInCell&&this.root.push(new _e("w:doNotSnapToGridInCell",e.doNotSnapToGridInCell)),e.selectFieldWithFirstOrLastCharacter&&this.root.push(new _e("w:selectFldWithFirstOrLastChar",e.selectFieldWithFirstOrLastCharacter)),e.applyBreakingRules&&this.root.push(new _e("w:applyBreakingRules",e.applyBreakingRules)),e.doNotWrapTextWithPunctuation&&this.root.push(new _e("w:doNotWrapTextWithPunct",e.doNotWrapTextWithPunctuation)),e.doNotUseEastAsianBreakRules&&this.root.push(new _e("w:doNotUseEastAsianBreakRules",e.doNotUseEastAsianBreakRules)),e.useWord2002TableStyleRules&&this.root.push(new _e("w:useWord2002TableStyleRules",e.useWord2002TableStyleRules)),e.growAutofit&&this.root.push(new _e("w:growAutofit",e.growAutofit)),e.useFELayout&&this.root.push(new _e("w:useFELayout",e.useFELayout)),e.useNormalStyleForList&&this.root.push(new _e("w:useNormalStyleForList",e.useNormalStyleForList)),e.doNotUseIndentAsNumberingTabStop&&this.root.push(new _e("w:doNotUseIndentAsNumberingTabStop",e.doNotUseIndentAsNumberingTabStop)),e.useAlternateEastAsianLineBreakRules&&this.root.push(new _e("w:useAltKinsokuLineBreakRules",e.useAlternateEastAsianLineBreakRules)),e.allowSpaceOfSameStyleInTable&&this.root.push(new _e("w:allowSpaceOfSameStyleInTable",e.allowSpaceOfSameStyleInTable)),e.doNotSuppressIndentation&&this.root.push(new _e("w:doNotSuppressIndentation",e.doNotSuppressIndentation)),e.doNotAutofitConstrainedTables&&this.root.push(new _e("w:doNotAutofitConstrainedTables",e.doNotAutofitConstrainedTables)),e.autofitToFirstFixedWidthCell&&this.root.push(new _e("w:autofitToFirstFixedWidthCell",e.autofitToFirstFixedWidthCell)),e.underlineTabInNumberingList&&this.root.push(new _e("w:underlineTabInNumList",e.underlineTabInNumberingList)),e.displayHangulFixedWidth&&this.root.push(new _e("w:displayHangulFixedWidth",e.displayHangulFixedWidth)),e.splitPgBreakAndParaMark&&this.root.push(new _e("w:splitPgBreakAndParaMark",e.splitPgBreakAndParaMark)),e.doNotVerticallyAlignCellWithSp&&this.root.push(new _e("w:doNotVertAlignCellWithSp",e.doNotVerticallyAlignCellWithSp)),e.doNotBreakConstrainedForcedTable&&this.root.push(new _e("w:doNotBreakConstrainedForcedTable",e.doNotBreakConstrainedForcedTable)),e.ignoreVerticalAlignmentInTextboxes&&this.root.push(new _e("w:doNotVertAlignInTxbx",e.ignoreVerticalAlignmentInTextboxes)),e.useAnsiKerningPairs&&this.root.push(new _e("w:useAnsiKerningPairs",e.useAnsiKerningPairs)),e.cachedColumnBalance&&this.root.push(new _e("w:cachedColBalance",e.cachedColumnBalance))}}class yf extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",Ignorable:"mc:Ignorable"})}}class vf extends ye{constructor(e){var t,a,l,i;super("w:settings"),this.root.push(new yf({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",Ignorable:"w14 w15 wp14"})),this.root.push(new _e("w:displayBackgroundShape",!0)),e.trackRevisions!==void 0&&this.root.push(new _e("w:trackRevisions",e.trackRevisions)),e.evenAndOddHeaders!==void 0&&this.root.push(new _e("w:evenAndOddHeaders",e.evenAndOddHeaders)),e.updateFields!==void 0&&this.root.push(new _e("w:updateFields",e.updateFields)),e.defaultTabStop!==void 0&&this.root.push(new Ti("w:defaultTabStop",e.defaultTabStop)),this.root.push(new wf(Tr(ze({},(t=e.compatibility)!=null?t:{}),{version:(i=(l=(a=e.compatibility)==null?void 0:a.version)!=null?l:e.compatibilityModeVersion)!=null?i:15})))}}class ra extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{val:"w:val"})}}class bf extends ye{constructor(e){super("w:name"),this.root.push(new ra({val:e}))}}class _f extends ye{constructor(e){super("w:uiPriority"),this.root.push(new ra({val:pt(e)}))}}class xf extends Fe{constructor(){super(...arguments),me(this,"xmlKeys",{type:"w:type",styleId:"w:styleId",default:"w:default",customStyle:"w:customStyle"})}}class na extends ye{constructor(e,t){super("w:style"),this.root.push(new xf(e)),t.name&&this.root.push(new bf(t.name)),t.basedOn&&this.root.push(new Qt("w:basedOn",t.basedOn)),t.next&&this.root.push(new Qt("w:next",t.next)),t.link&&this.root.push(new Qt("w:link",t.link)),t.uiPriority!==void 0&&this.root.push(new _f(t.uiPriority)),t.semiHidden!==void 0&&this.root.push(new _e("w:semiHidden",t.semiHidden)),t.unhideWhenUsed!==void 0&&this.root.push(new _e("w:unhideWhenUsed",t.unhideWhenUsed)),t.quickFormat!==void 0&&this.root.push(new _e("w:qFormat",t.quickFormat))}}class rn extends na{constructor(e){super({type:"paragraph",styleId:e.id},e),me(this,"paragraphProperties"),me(this,"runProperties"),this.paragraphProperties=new sr(e.paragraph),this.runProperties=new Gt(e.run),this.root.push(this.paragraphProperties),this.root.push(this.runProperties)}}class nn extends na{constructor(e){super({type:"character",styleId:e.id},ze({uiPriority:99,unhideWhenUsed:!0},e)),me(this,"runProperties"),this.runProperties=new Gt(e.run),this.root.push(this.runProperties)}}class Ut extends rn{constructor(e){super(ze({basedOn:"Normal",next:"Normal",quickFormat:!0},e))}}class Ef extends Ut{constructor(e){super(ze({id:"Title",name:"Title"},e))}}class Tf extends Ut{constructor(e){super(ze({id:"Heading1",name:"Heading 1"},e))}}class Af extends Ut{constructor(e){super(ze({id:"Heading2",name:"Heading 2"},e))}}class Sf extends Ut{constructor(e){super(ze({id:"Heading3",name:"Heading 3"},e))}}class kf extends Ut{constructor(e){super(ze({id:"Heading4",name:"Heading 4"},e))}}class Cf extends Ut{constructor(e){super(ze({id:"Heading5",name:"Heading 5"},e))}}class Rf extends Ut{constructor(e){super(ze({id:"Heading6",name:"Heading 6"},e))}}class If extends Ut{constructor(e){super(ze({id:"Strong",name:"Strong"},e))}}class Nf extends rn{constructor(e){super(ze({id:"ListParagraph",name:"List Paragraph",basedOn:"Normal",quickFormat:!0},e))}}class Of extends rn{constructor(e){super(ze({id:"FootnoteText",name:"footnote text",link:"FootnoteTextChar",basedOn:"Normal",uiPriority:99,semiHidden:!0,unhideWhenUsed:!0,paragraph:{spacing:{after:0,line:240,lineRule:ai.AUTO}},run:{size:20}},e))}}class Df extends nn{constructor(e){super(ze({id:"FootnoteReference",name:"footnote reference",basedOn:"DefaultParagraphFont",semiHidden:!0,run:{superScript:!0}},e))}}class Bf extends nn{constructor(e){super(ze({id:"FootnoteTextChar",name:"Footnote Text Char",basedOn:"DefaultParagraphFont",link:"FootnoteText",semiHidden:!0,run:{size:20}},e))}}class Ff extends nn{constructor(e){super(ze({id:"Hyperlink",name:"Hyperlink",basedOn:"DefaultParagraphFont",run:{color:"0563C1",underline:{type:Qs.SINGLE}}},e))}}class li extends ye{constructor(e){if(super("w:styles"),e.initialStyles&&this.root.push(e.initialStyles),e.importedStyles)for(const t of e.importedStyles)this.root.push(t);if(e.paragraphStyles)for(const t of e.paragraphStyles)this.root.push(new rn(t));if(e.characterStyles)for(const t of e.characterStyles)this.root.push(new nn(t))}}class Pf extends ye{constructor(e){super("w:pPrDefault"),this.root.push(new sr(e))}}class Lf extends ye{constructor(e){super("w:rPrDefault"),this.root.push(new Gt(e))}}class Uf extends ye{constructor(e){super("w:docDefaults"),me(this,"runPropertiesDefaults"),me(this,"paragraphPropertiesDefaults"),this.runPropertiesDefaults=new Lf(e.run),this.paragraphPropertiesDefaults=new Pf(e.paragraph),this.root.push(this.runPropertiesDefaults),this.root.push(this.paragraphPropertiesDefaults)}}class Mf{newInstance(e){const t=Ks.xml2js(e,{compact:!1});let a;for(const c of t.elements||[])c.name==="w:styles"&&(a=c);if(a===void 0)throw new Error("can not find styles element");const l=a.elements||[];return new li({initialStyles:new zl(a.attributes),importedStyles:l.map(c=>Ei(c))})}}class Mo{newInstance(e={}){var t;return{initialStyles:new Cr({mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",Ignorable:"w14 w15"}),importedStyles:[new Uf((t=e.document)!=null?t:{}),new Ef(ze({run:{size:56}},e.title)),new Tf(ze({run:{color:"2E74B5",size:32}},e.heading1)),new Af(ze({run:{color:"2E74B5",size:26}},e.heading2)),new Sf(ze({run:{color:"1F4D78",size:24}},e.heading3)),new kf(ze({run:{color:"2E74B5",italics:!0}},e.heading4)),new Cf(ze({run:{color:"2E74B5"}},e.heading5)),new Rf(ze({run:{color:"1F4D78"}},e.heading6)),new If(ze({run:{bold:!0}},e.strong)),new Nf(e.listParagraph||{}),new Ff(e.hyperlink||{}),new Df(e.footnoteReference||{}),new Of(e.footnoteText||{}),new Bf(e.footnoteTextChar||{})]}}}const Mr=({id:r,fontKey:e,subsetted:t},a)=>new Lt({name:a,attributes:ze({id:{key:"r:id",value:r}},e?{fontKey:{key:"w:fontKey",value:`{${e}}`}}:{}),children:[...t?[new _e("w:subsetted",t)]:[]]}),jf=({name:r,altName:e,panose1:t,charset:a,family:l,notTrueType:i,pitch:c,sig:n,embedRegular:u,embedBold:w,embedItalic:y,embedBoldItalic:_})=>new Lt({name:"w:font",attributes:{name:{key:"w:name",value:r}},children:[...e?[_r("w:altName",e)]:[],...t?[_r("w:panose1",t)]:[],...a?[_r("w:charset",a)]:[],_r("w:family",l),...i?[new _e("w:notTrueType",i)]:[],_r("w:pitch",c),...n?[new Lt({name:"w:sig",attributes:{usb0:{key:"w:usb0",value:n.usb0},usb1:{key:"w:usb1",value:n.usb1},usb2:{key:"w:usb2",value:n.usb2},usb3:{key:"w:usb3",value:n.usb3},csb0:{key:"w:csb0",value:n.csb0},csb1:{key:"w:csb1",value:n.csb1}}})]:[],...u?[Mr(u,"w:embedRegular")]:[],...w?[Mr(w,"w:embedBold")]:[],...y?[Mr(y,"w:embedItalic")]:[],..._?[Mr(_,"w:embedBoldItalic")]:[]]}),zf=({name:r,index:e,fontKey:t,characterSet:a})=>jf({name:r,sig:{usb0:"E0002AFF",usb1:"C000247B",usb2:"00000009",usb3:"00000000",csb0:"000001FF",csb1:"00000000"},charset:a,family:"auto",pitch:"variable",embedRegular:{fontKey:t,id:`rId${e}`}}),Wf=r=>new Lt({name:"w:fonts",attributes:{mc:{key:"xmlns:mc",value:"http://schemas.openxmlformats.org/markup-compatibility/2006"},r:{key:"xmlns:r",value:"http://schemas.openxmlformats.org/officeDocument/2006/relationships"},w:{key:"xmlns:w",value:"http://schemas.openxmlformats.org/wordprocessingml/2006/main"},w14:{key:"xmlns:w14",value:"http://schemas.microsoft.com/office/word/2010/wordml"},w15:{key:"xmlns:w15",value:"http://schemas.microsoft.com/office/word/2012/wordml"},w16cex:{key:"xmlns:w16cex",value:"http://schemas.microsoft.com/office/word/2018/wordml/cex"},w16cid:{key:"xmlns:w16cid",value:"http://schemas.microsoft.com/office/word/2016/wordml/cid"},w16:{key:"xmlns:w16",value:"http://schemas.microsoft.com/office/word/2018/wordml"},w16sdtdh:{key:"xmlns:w16sdtdh",value:"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash"},w16se:{key:"xmlns:w16se",value:"http://schemas.microsoft.com/office/word/2015/wordml/symex"},Ignorable:{key:"mc:Ignorable",value:"w14 w15 w16se w16cid w16 w16cex w16sdtdh"}},children:r.map((e,t)=>zf({name:e.name,index:t+1,fontKey:e.fontKey}))});class Hf{constructor(e){me(this,"fontTable"),me(this,"relationships"),me(this,"fontOptionsWithKey",[]),this.options=e,this.fontOptionsWithKey=e.map(t=>Tr(ze({},t),{fontKey:Tc()})),this.fontTable=Wf(this.fontOptionsWithKey),this.relationships=new mr;for(let t=0;t<e.length;t++)this.relationships.createRelationship(t+1,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/font",`fonts/${e[t].name}.odttf`)}get View(){return this.fontTable}get Relationships(){return this.relationships}}class $f{constructor(e){me(this,"currentRelationshipId",1),me(this,"documentWrapper"),me(this,"headers",[]),me(this,"footers",[]),me(this,"coreProperties"),me(this,"numbering"),me(this,"media"),me(this,"fileRelationships"),me(this,"footnotesWrapper"),me(this,"settings"),me(this,"contentTypes"),me(this,"customProperties"),me(this,"appProperties"),me(this,"styles"),me(this,"comments"),me(this,"fontWrapper");var t,a,l,i,c,n,u,w;if(this.coreProperties=new Cu(Tr(ze({},e),{creator:(t=e.creator)!=null?t:"Un-named",revision:(a=e.revision)!=null?a:1,lastModifiedBy:(l=e.lastModifiedBy)!=null?l:"Un-named"})),this.numbering=new pf(e.numbering?e.numbering:{config:[]}),this.comments=new Cc((i=e.comments)!=null?i:{children:[]}),this.fileRelationships=new mr,this.customProperties=new Du((c=e.customProperties)!=null?c:[]),this.appProperties=new Eu,this.footnotesWrapper=new Ku,this.contentTypes=new ku,this.documentWrapper=new ta({background:e.background}),this.settings=new vf({compatibilityModeVersion:e.compatabilityModeVersion,compatibility:e.compatibility,evenAndOddHeaders:!!e.evenAndOddHeaderAndFooters,trackRevisions:(n=e.features)==null?void 0:n.trackRevisions,updateFields:(u=e.features)==null?void 0:u.updateFields,defaultTabStop:e.defaultTabStop}),this.media=new Zu,e.externalStyles){const y=new Mf;this.styles=y.newInstance(e.externalStyles)}else if(e.styles){const _=new Mo().newInstance(e.styles.default);this.styles=new li(ze(ze({},_),e.styles))}else{const y=new Mo;this.styles=new li(y.newInstance())}this.addDefaultRelationships();for(const y of e.sections)this.addSection(y);if(e.footnotes)for(const y in e.footnotes)this.footnotesWrapper.View.createFootNote(parseFloat(y),e.footnotes[y].children);this.fontWrapper=new Hf((w=e.fonts)!=null?w:[])}addSection({headers:e={},footers:t={},children:a,properties:l}){this.documentWrapper.View.Body.addSection(Tr(ze({},l),{headerWrapperGroup:{default:e.default?this.createHeader(e.default):void 0,first:e.first?this.createHeader(e.first):void 0,even:e.even?this.createHeader(e.even):void 0},footerWrapperGroup:{default:t.default?this.createFooter(t.default):void 0,first:t.first?this.createFooter(t.first):void 0,even:t.even?this.createFooter(t.even):void 0}}));for(const i of a)this.documentWrapper.View.add(i)}createHeader(e){const t=new Xu(this.media,this.currentRelationshipId++);for(const a of e.options.children)t.add(a);return this.addHeaderToDocument(t),t}createFooter(e){const t=new Pu(this.media,this.currentRelationshipId++);for(const a of e.options.children)t.add(a);return this.addFooterToDocument(t),t}addHeaderToDocument(e,t=er.DEFAULT){this.headers.push({header:e,type:t}),this.documentWrapper.Relationships.createRelationship(e.View.ReferenceId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/header",`header${this.headers.length}.xml`),this.contentTypes.addHeader(this.headers.length)}addFooterToDocument(e,t=er.DEFAULT){this.footers.push({footer:e,type:t}),this.documentWrapper.Relationships.createRelationship(e.View.ReferenceId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer",`footer${this.footers.length}.xml`),this.contentTypes.addFooter(this.footers.length)}addDefaultRelationships(){this.fileRelationships.createRelationship(1,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument","word/document.xml"),this.fileRelationships.createRelationship(2,"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties","docProps/core.xml"),this.fileRelationships.createRelationship(3,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties","docProps/app.xml"),this.fileRelationships.createRelationship(4,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties","docProps/custom.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles","styles.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/numbering","numbering.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes","footnotes.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings","settings.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments","comments.xml")}get Document(){return this.documentWrapper}get Styles(){return this.styles}get CoreProperties(){return this.coreProperties}get Numbering(){return this.numbering}get Media(){return this.media}get FileRelationships(){return this.fileRelationships}get Headers(){return this.headers.map(e=>e.header)}get Footers(){return this.footers.map(e=>e.footer)}get ContentTypes(){return this.contentTypes}get CustomProperties(){return this.customProperties}get AppProperties(){return this.appProperties}get FootNotes(){return this.footnotesWrapper}get Settings(){return this.settings}get Comments(){return this.comments}get FontTable(){return this.fontWrapper}}function jr(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var ia={exports:{}};(function(r,e){(function(t){r.exports=t()})(function(){return function t(a,l,i){function c(w,y){if(!l[w]){if(!a[w]){var _=typeof jr=="function"&&jr;if(!y&&_)return _(w,!0);if(n)return n(w,!0);var E=new Error("Cannot find module '"+w+"'");throw E.code="MODULE_NOT_FOUND",E}var p=l[w]={exports:{}};a[w][0].call(p.exports,function(T){var m=a[w][1][T];return c(m||T)},p,p.exports,t,a,l,i)}return l[w].exports}for(var n=typeof jr=="function"&&jr,u=0;u<i.length;u++)c(i[u]);return c}({1:[function(t,a,l){var i=t("./utils"),c=t("./support"),n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";l.encode=function(u){for(var w,y,_,E,p,T,m,S=[],f=0,x=u.length,k=x,N=i.getTypeOf(u)!=="string";f<u.length;)k=x-f,_=N?(w=u[f++],y=f<x?u[f++]:0,f<x?u[f++]:0):(w=u.charCodeAt(f++),y=f<x?u.charCodeAt(f++):0,f<x?u.charCodeAt(f++):0),E=w>>2,p=(3&w)<<4|y>>4,T=1<k?(15&y)<<2|_>>6:64,m=2<k?63&_:64,S.push(n.charAt(E)+n.charAt(p)+n.charAt(T)+n.charAt(m));return S.join("")},l.decode=function(u){var w,y,_,E,p,T,m=0,S=0,f="data:";if(u.substr(0,f.length)===f)throw new Error("Invalid base64 input, it looks like a data url.");var x,k=3*(u=u.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(u.charAt(u.length-1)===n.charAt(64)&&k--,u.charAt(u.length-2)===n.charAt(64)&&k--,k%1!=0)throw new Error("Invalid base64 input, bad content length.");for(x=c.uint8array?new Uint8Array(0|k):new Array(0|k);m<u.length;)w=n.indexOf(u.charAt(m++))<<2|(E=n.indexOf(u.charAt(m++)))>>4,y=(15&E)<<4|(p=n.indexOf(u.charAt(m++)))>>2,_=(3&p)<<6|(T=n.indexOf(u.charAt(m++))),x[S++]=w,p!==64&&(x[S++]=y),T!==64&&(x[S++]=_);return x}},{"./support":30,"./utils":32}],2:[function(t,a,l){var i=t("./external"),c=t("./stream/DataWorker"),n=t("./stream/Crc32Probe"),u=t("./stream/DataLengthProbe");function w(y,_,E,p,T){this.compressedSize=y,this.uncompressedSize=_,this.crc32=E,this.compression=p,this.compressedContent=T}w.prototype={getContentWorker:function(){var y=new c(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new u("data_length")),_=this;return y.on("end",function(){if(this.streamInfo.data_length!==_.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),y},getCompressedWorker:function(){return new c(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},w.createWorkerFrom=function(y,_,E){return y.pipe(new n).pipe(new u("uncompressedSize")).pipe(_.compressWorker(E)).pipe(new u("compressedSize")).withStreamInfo("compression",_)},a.exports=w},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,a,l){var i=t("./stream/GenericWorker");l.STORE={magic:"\0\0",compressWorker:function(){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},l.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,a,l){var i=t("./utils"),c=function(){for(var n,u=[],w=0;w<256;w++){n=w;for(var y=0;y<8;y++)n=1&n?3988292384^n>>>1:n>>>1;u[w]=n}return u}();a.exports=function(n,u){return n!==void 0&&n.length?i.getTypeOf(n)!=="string"?function(w,y,_,E){var p=c,T=E+_;w^=-1;for(var m=E;m<T;m++)w=w>>>8^p[255&(w^y[m])];return-1^w}(0|u,n,n.length,0):function(w,y,_,E){var p=c,T=E+_;w^=-1;for(var m=E;m<T;m++)w=w>>>8^p[255&(w^y.charCodeAt(m))];return-1^w}(0|u,n,n.length,0):0}},{"./utils":32}],5:[function(t,a,l){l.base64=!1,l.binary=!1,l.dir=!1,l.createFolders=!0,l.date=null,l.compression=null,l.compressionOptions=null,l.comment=null,l.unixPermissions=null,l.dosPermissions=null},{}],6:[function(t,a,l){var i=null;i=typeof Promise<"u"?Promise:t("lie"),a.exports={Promise:i}},{lie:37}],7:[function(t,a,l){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",c=t("pako"),n=t("./utils"),u=t("./stream/GenericWorker"),w=i?"uint8array":"array";function y(_,E){u.call(this,"FlateWorker/"+_),this._pako=null,this._pakoAction=_,this._pakoOptions=E,this.meta={}}l.magic="\b\0",n.inherits(y,u),y.prototype.processChunk=function(_){this.meta=_.meta,this._pako===null&&this._createPako(),this._pako.push(n.transformTo(w,_.data),!1)},y.prototype.flush=function(){u.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},y.prototype.cleanUp=function(){u.prototype.cleanUp.call(this),this._pako=null},y.prototype._createPako=function(){this._pako=new c[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var _=this;this._pako.onData=function(E){_.push({data:E,meta:_.meta})}},l.compressWorker=function(_){return new y("Deflate",_)},l.uncompressWorker=function(){return new y("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,a,l){function i(p,T){var m,S="";for(m=0;m<T;m++)S+=String.fromCharCode(255&p),p>>>=8;return S}function c(p,T,m,S,f,x){var k,N,C=p.file,H=p.compression,$=x!==w.utf8encode,Z=n.transformTo("string",x(C.name)),R=n.transformTo("string",w.utf8encode(C.name)),ce=C.comment,ge=n.transformTo("string",x(ce)),I=n.transformTo("string",w.utf8encode(ce)),V=R.length!==C.name.length,A=I.length!==ce.length,j="",oe="",G="",we=C.dir,Y=C.date,te={crc32:0,compressedSize:0,uncompressedSize:0};T&&!m||(te.crc32=p.crc32,te.compressedSize=p.compressedSize,te.uncompressedSize=p.uncompressedSize);var M=0;T&&(M|=8),$||!V&&!A||(M|=2048);var D=0,q=0;we&&(D|=16),f==="UNIX"?(q=798,D|=function(ie,z){var v=ie;return ie||(v=z?16893:33204),(65535&v)<<16}(C.unixPermissions,we)):(q=20,D|=function(ie){return 63&(ie||0)}(C.dosPermissions)),k=Y.getUTCHours(),k<<=6,k|=Y.getUTCMinutes(),k<<=5,k|=Y.getUTCSeconds()/2,N=Y.getUTCFullYear()-1980,N<<=4,N|=Y.getUTCMonth()+1,N<<=5,N|=Y.getUTCDate(),V&&(oe=i(1,1)+i(y(Z),4)+R,j+="up"+i(oe.length,2)+oe),A&&(G=i(1,1)+i(y(ge),4)+I,j+="uc"+i(G.length,2)+G);var X="";return X+=`
\0`,X+=i(M,2),X+=H.magic,X+=i(k,2),X+=i(N,2),X+=i(te.crc32,4),X+=i(te.compressedSize,4),X+=i(te.uncompressedSize,4),X+=i(Z.length,2),X+=i(j.length,2),{fileRecord:_.LOCAL_FILE_HEADER+X+Z+j,dirRecord:_.CENTRAL_FILE_HEADER+i(q,2)+X+i(ge.length,2)+"\0\0\0\0"+i(D,4)+i(S,4)+Z+j+ge}}var n=t("../utils"),u=t("../stream/GenericWorker"),w=t("../utf8"),y=t("../crc32"),_=t("../signature");function E(p,T,m,S){u.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=T,this.zipPlatform=m,this.encodeFileName=S,this.streamFiles=p,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}n.inherits(E,u),E.prototype.push=function(p){var T=p.meta.percent||0,m=this.entriesCount,S=this._sources.length;this.accumulate?this.contentBuffer.push(p):(this.bytesWritten+=p.data.length,u.prototype.push.call(this,{data:p.data,meta:{currentFile:this.currentFile,percent:m?(T+100*(m-S-1))/m:100}}))},E.prototype.openedSource=function(p){this.currentSourceOffset=this.bytesWritten,this.currentFile=p.file.name;var T=this.streamFiles&&!p.file.dir;if(T){var m=c(p,T,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:m.fileRecord,meta:{percent:0}})}else this.accumulate=!0},E.prototype.closedSource=function(p){this.accumulate=!1;var T=this.streamFiles&&!p.file.dir,m=c(p,T,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(m.dirRecord),T)this.push({data:function(S){return _.DATA_DESCRIPTOR+i(S.crc32,4)+i(S.compressedSize,4)+i(S.uncompressedSize,4)}(p),meta:{percent:100}});else for(this.push({data:m.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},E.prototype.flush=function(){for(var p=this.bytesWritten,T=0;T<this.dirRecords.length;T++)this.push({data:this.dirRecords[T],meta:{percent:100}});var m=this.bytesWritten-p,S=function(f,x,k,N,C){var H=n.transformTo("string",C(N));return _.CENTRAL_DIRECTORY_END+"\0\0\0\0"+i(f,2)+i(f,2)+i(x,4)+i(k,4)+i(H.length,2)+H}(this.dirRecords.length,m,p,this.zipComment,this.encodeFileName);this.push({data:S,meta:{percent:100}})},E.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},E.prototype.registerPrevious=function(p){this._sources.push(p);var T=this;return p.on("data",function(m){T.processChunk(m)}),p.on("end",function(){T.closedSource(T.previous.streamInfo),T._sources.length?T.prepareNextSource():T.end()}),p.on("error",function(m){T.error(m)}),this},E.prototype.resume=function(){return!!u.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},E.prototype.error=function(p){var T=this._sources;if(!u.prototype.error.call(this,p))return!1;for(var m=0;m<T.length;m++)try{T[m].error(p)}catch{}return!0},E.prototype.lock=function(){u.prototype.lock.call(this);for(var p=this._sources,T=0;T<p.length;T++)p[T].lock()},a.exports=E},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,a,l){var i=t("../compressions"),c=t("./ZipFileWorker");l.generateWorker=function(n,u,w){var y=new c(u.streamFiles,w,u.platform,u.encodeFileName),_=0;try{n.forEach(function(E,p){_++;var T=function(x,k){var N=x||k,C=i[N];if(!C)throw new Error(N+" is not a valid compression method !");return C}(p.options.compression,u.compression),m=p.options.compressionOptions||u.compressionOptions||{},S=p.dir,f=p.date;p._compressWorker(T,m).withStreamInfo("file",{name:E,dir:S,date:f,comment:p.comment||"",unixPermissions:p.unixPermissions,dosPermissions:p.dosPermissions}).pipe(y)}),y.entriesCount=_}catch(E){y.error(E)}return y}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,a,l){function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var c=new i;for(var n in this)typeof this[n]!="function"&&(c[n]=this[n]);return c}}(i.prototype=t("./object")).loadAsync=t("./load"),i.support=t("./support"),i.defaults=t("./defaults"),i.version="3.10.1",i.loadAsync=function(c,n){return new i().loadAsync(c,n)},i.external=t("./external"),a.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,a,l){var i=t("./utils"),c=t("./external"),n=t("./utf8"),u=t("./zipEntries"),w=t("./stream/Crc32Probe"),y=t("./nodejsUtils");function _(E){return new c.Promise(function(p,T){var m=E.decompressed.getContentWorker().pipe(new w);m.on("error",function(S){T(S)}).on("end",function(){m.streamInfo.crc32!==E.decompressed.crc32?T(new Error("Corrupted zip : CRC32 mismatch")):p()}).resume()})}a.exports=function(E,p){var T=this;return p=i.extend(p||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:n.utf8decode}),y.isNode&&y.isStream(E)?c.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",E,!0,p.optimizedBinaryString,p.base64).then(function(m){var S=new u(p);return S.load(m),S}).then(function(m){var S=[c.Promise.resolve(m)],f=m.files;if(p.checkCRC32)for(var x=0;x<f.length;x++)S.push(_(f[x]));return c.Promise.all(S)}).then(function(m){for(var S=m.shift(),f=S.files,x=0;x<f.length;x++){var k=f[x],N=k.fileNameStr,C=i.resolve(k.fileNameStr);T.file(C,k.decompressed,{binary:!0,optimizedBinaryString:!0,date:k.date,dir:k.dir,comment:k.fileCommentStr.length?k.fileCommentStr:null,unixPermissions:k.unixPermissions,dosPermissions:k.dosPermissions,createFolders:p.createFolders}),k.dir||(T.file(C).unsafeOriginalName=N)}return S.zipComment.length&&(T.comment=S.zipComment),T})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,a,l){var i=t("../utils"),c=t("../stream/GenericWorker");function n(u,w){c.call(this,"Nodejs stream input adapter for "+u),this._upstreamEnded=!1,this._bindStream(w)}i.inherits(n,c),n.prototype._bindStream=function(u){var w=this;(this._stream=u).pause(),u.on("data",function(y){w.push({data:y,meta:{percent:0}})}).on("error",function(y){w.isPaused?this.generatedError=y:w.error(y)}).on("end",function(){w.isPaused?w._upstreamEnded=!0:w.end()})},n.prototype.pause=function(){return!!c.prototype.pause.call(this)&&(this._stream.pause(),!0)},n.prototype.resume=function(){return!!c.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},a.exports=n},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,a,l){var i=t("readable-stream").Readable;function c(n,u,w){i.call(this,u),this._helper=n;var y=this;n.on("data",function(_,E){y.push(_)||y._helper.pause(),w&&w(E)}).on("error",function(_){y.emit("error",_)}).on("end",function(){y.push(null)})}t("../utils").inherits(c,i),c.prototype._read=function(){this._helper.resume()},a.exports=c},{"../utils":32,"readable-stream":16}],14:[function(t,a,l){a.exports={isNode:typeof Buffer<"u",newBufferFrom:function(i,c){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(i,c);if(typeof i=="number")throw new Error('The "data" argument must not be a number');return new Buffer(i,c)},allocBuffer:function(i){if(Buffer.alloc)return Buffer.alloc(i);var c=new Buffer(i);return c.fill(0),c},isBuffer:function(i){return Buffer.isBuffer(i)},isStream:function(i){return i&&typeof i.on=="function"&&typeof i.pause=="function"&&typeof i.resume=="function"}}},{}],15:[function(t,a,l){function i(C,H,$){var Z,R=n.getTypeOf(H),ce=n.extend($||{},y);ce.date=ce.date||new Date,ce.compression!==null&&(ce.compression=ce.compression.toUpperCase()),typeof ce.unixPermissions=="string"&&(ce.unixPermissions=parseInt(ce.unixPermissions,8)),ce.unixPermissions&&16384&ce.unixPermissions&&(ce.dir=!0),ce.dosPermissions&&16&ce.dosPermissions&&(ce.dir=!0),ce.dir&&(C=f(C)),ce.createFolders&&(Z=S(C))&&x.call(this,Z,!0);var ge=R==="string"&&ce.binary===!1&&ce.base64===!1;$&&$.binary!==void 0||(ce.binary=!ge),(H instanceof _&&H.uncompressedSize===0||ce.dir||!H||H.length===0)&&(ce.base64=!1,ce.binary=!0,H="",ce.compression="STORE",R="string");var I=null;I=H instanceof _||H instanceof u?H:T.isNode&&T.isStream(H)?new m(C,H):n.prepareContent(C,H,ce.binary,ce.optimizedBinaryString,ce.base64);var V=new E(C,I,ce);this.files[C]=V}var c=t("./utf8"),n=t("./utils"),u=t("./stream/GenericWorker"),w=t("./stream/StreamHelper"),y=t("./defaults"),_=t("./compressedObject"),E=t("./zipObject"),p=t("./generate"),T=t("./nodejsUtils"),m=t("./nodejs/NodejsStreamInputAdapter"),S=function(C){C.slice(-1)==="/"&&(C=C.substring(0,C.length-1));var H=C.lastIndexOf("/");return 0<H?C.substring(0,H):""},f=function(C){return C.slice(-1)!=="/"&&(C+="/"),C},x=function(C,H){return H=H!==void 0?H:y.createFolders,C=f(C),this.files[C]||i.call(this,C,null,{dir:!0,createFolders:H}),this.files[C]};function k(C){return Object.prototype.toString.call(C)==="[object RegExp]"}var N={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(C){var H,$,Z;for(H in this.files)Z=this.files[H],($=H.slice(this.root.length,H.length))&&H.slice(0,this.root.length)===this.root&&C($,Z)},filter:function(C){var H=[];return this.forEach(function($,Z){C($,Z)&&H.push(Z)}),H},file:function(C,H,$){if(arguments.length!==1)return C=this.root+C,i.call(this,C,H,$),this;if(k(C)){var Z=C;return this.filter(function(ce,ge){return!ge.dir&&Z.test(ce)})}var R=this.files[this.root+C];return R&&!R.dir?R:null},folder:function(C){if(!C)return this;if(k(C))return this.filter(function(R,ce){return ce.dir&&C.test(R)});var H=this.root+C,$=x.call(this,H),Z=this.clone();return Z.root=$.name,Z},remove:function(C){C=this.root+C;var H=this.files[C];if(H||(C.slice(-1)!=="/"&&(C+="/"),H=this.files[C]),H&&!H.dir)delete this.files[C];else for(var $=this.filter(function(R,ce){return ce.name.slice(0,C.length)===C}),Z=0;Z<$.length;Z++)delete this.files[$[Z].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(C){var H,$={};try{if(($=n.extend(C||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:c.utf8encode})).type=$.type.toLowerCase(),$.compression=$.compression.toUpperCase(),$.type==="binarystring"&&($.type="string"),!$.type)throw new Error("No output type specified.");n.checkSupport($.type),$.platform!=="darwin"&&$.platform!=="freebsd"&&$.platform!=="linux"&&$.platform!=="sunos"||($.platform="UNIX"),$.platform==="win32"&&($.platform="DOS");var Z=$.comment||this.comment||"";H=p.generateWorker(this,$,Z)}catch(R){(H=new u("error")).error(R)}return new w(H,$.type||"string",$.mimeType)},generateAsync:function(C,H){return this.generateInternalStream(C).accumulate(H)},generateNodeStream:function(C,H){return(C=C||{}).type||(C.type="nodebuffer"),this.generateInternalStream(C).toNodejsStream(H)}};a.exports=N},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,a,l){a.exports=t("stream")},{stream:void 0}],17:[function(t,a,l){var i=t("./DataReader");function c(n){i.call(this,n);for(var u=0;u<this.data.length;u++)n[u]=255&n[u]}t("../utils").inherits(c,i),c.prototype.byteAt=function(n){return this.data[this.zero+n]},c.prototype.lastIndexOfSignature=function(n){for(var u=n.charCodeAt(0),w=n.charCodeAt(1),y=n.charCodeAt(2),_=n.charCodeAt(3),E=this.length-4;0<=E;--E)if(this.data[E]===u&&this.data[E+1]===w&&this.data[E+2]===y&&this.data[E+3]===_)return E-this.zero;return-1},c.prototype.readAndCheckSignature=function(n){var u=n.charCodeAt(0),w=n.charCodeAt(1),y=n.charCodeAt(2),_=n.charCodeAt(3),E=this.readData(4);return u===E[0]&&w===E[1]&&y===E[2]&&_===E[3]},c.prototype.readData=function(n){if(this.checkOffset(n),n===0)return[];var u=this.data.slice(this.zero+this.index,this.zero+this.index+n);return this.index+=n,u},a.exports=c},{"../utils":32,"./DataReader":18}],18:[function(t,a,l){var i=t("../utils");function c(n){this.data=n,this.length=n.length,this.index=0,this.zero=0}c.prototype={checkOffset:function(n){this.checkIndex(this.index+n)},checkIndex:function(n){if(this.length<this.zero+n||n<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+n+"). Corrupted zip ?")},setIndex:function(n){this.checkIndex(n),this.index=n},skip:function(n){this.setIndex(this.index+n)},byteAt:function(){},readInt:function(n){var u,w=0;for(this.checkOffset(n),u=this.index+n-1;u>=this.index;u--)w=(w<<8)+this.byteAt(u);return this.index+=n,w},readString:function(n){return i.transformTo("string",this.readData(n))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var n=this.readInt(4);return new Date(Date.UTC(1980+(n>>25&127),(n>>21&15)-1,n>>16&31,n>>11&31,n>>5&63,(31&n)<<1))}},a.exports=c},{"../utils":32}],19:[function(t,a,l){var i=t("./Uint8ArrayReader");function c(n){i.call(this,n)}t("../utils").inherits(c,i),c.prototype.readData=function(n){this.checkOffset(n);var u=this.data.slice(this.zero+this.index,this.zero+this.index+n);return this.index+=n,u},a.exports=c},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,a,l){var i=t("./DataReader");function c(n){i.call(this,n)}t("../utils").inherits(c,i),c.prototype.byteAt=function(n){return this.data.charCodeAt(this.zero+n)},c.prototype.lastIndexOfSignature=function(n){return this.data.lastIndexOf(n)-this.zero},c.prototype.readAndCheckSignature=function(n){return n===this.readData(4)},c.prototype.readData=function(n){this.checkOffset(n);var u=this.data.slice(this.zero+this.index,this.zero+this.index+n);return this.index+=n,u},a.exports=c},{"../utils":32,"./DataReader":18}],21:[function(t,a,l){var i=t("./ArrayReader");function c(n){i.call(this,n)}t("../utils").inherits(c,i),c.prototype.readData=function(n){if(this.checkOffset(n),n===0)return new Uint8Array(0);var u=this.data.subarray(this.zero+this.index,this.zero+this.index+n);return this.index+=n,u},a.exports=c},{"../utils":32,"./ArrayReader":17}],22:[function(t,a,l){var i=t("../utils"),c=t("../support"),n=t("./ArrayReader"),u=t("./StringReader"),w=t("./NodeBufferReader"),y=t("./Uint8ArrayReader");a.exports=function(_){var E=i.getTypeOf(_);return i.checkSupport(E),E!=="string"||c.uint8array?E==="nodebuffer"?new w(_):c.uint8array?new y(i.transformTo("uint8array",_)):new n(i.transformTo("array",_)):new u(_)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,a,l){l.LOCAL_FILE_HEADER="PK",l.CENTRAL_FILE_HEADER="PK",l.CENTRAL_DIRECTORY_END="PK",l.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",l.ZIP64_CENTRAL_DIRECTORY_END="PK",l.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,a,l){var i=t("./GenericWorker"),c=t("../utils");function n(u){i.call(this,"ConvertWorker to "+u),this.destType=u}c.inherits(n,i),n.prototype.processChunk=function(u){this.push({data:c.transformTo(this.destType,u.data),meta:u.meta})},a.exports=n},{"../utils":32,"./GenericWorker":28}],25:[function(t,a,l){var i=t("./GenericWorker"),c=t("../crc32");function n(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(n,i),n.prototype.processChunk=function(u){this.streamInfo.crc32=c(u.data,this.streamInfo.crc32||0),this.push(u)},a.exports=n},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,a,l){var i=t("../utils"),c=t("./GenericWorker");function n(u){c.call(this,"DataLengthProbe for "+u),this.propName=u,this.withStreamInfo(u,0)}i.inherits(n,c),n.prototype.processChunk=function(u){if(u){var w=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=w+u.data.length}c.prototype.processChunk.call(this,u)},a.exports=n},{"../utils":32,"./GenericWorker":28}],27:[function(t,a,l){var i=t("../utils"),c=t("./GenericWorker");function n(u){c.call(this,"DataWorker");var w=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,u.then(function(y){w.dataIsReady=!0,w.data=y,w.max=y&&y.length||0,w.type=i.getTypeOf(y),w.isPaused||w._tickAndRepeat()},function(y){w.error(y)})}i.inherits(n,c),n.prototype.cleanUp=function(){c.prototype.cleanUp.call(this),this.data=null},n.prototype.resume=function(){return!!c.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},n.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},n.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var u=null,w=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":u=this.data.substring(this.index,w);break;case"uint8array":u=this.data.subarray(this.index,w);break;case"array":case"nodebuffer":u=this.data.slice(this.index,w)}return this.index=w,this.push({data:u,meta:{percent:this.max?this.index/this.max*100:0}})},a.exports=n},{"../utils":32,"./GenericWorker":28}],28:[function(t,a,l){function i(c){this.name=c||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(c){this.emit("data",c)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(c){this.emit("error",c)}return!0},error:function(c){return!this.isFinished&&(this.isPaused?this.generatedError=c:(this.isFinished=!0,this.emit("error",c),this.previous&&this.previous.error(c),this.cleanUp()),!0)},on:function(c,n){return this._listeners[c].push(n),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(c,n){if(this._listeners[c])for(var u=0;u<this._listeners[c].length;u++)this._listeners[c][u].call(this,n)},pipe:function(c){return c.registerPrevious(this)},registerPrevious:function(c){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=c.streamInfo,this.mergeStreamInfo(),this.previous=c;var n=this;return c.on("data",function(u){n.processChunk(u)}),c.on("end",function(){n.end()}),c.on("error",function(u){n.error(u)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var c=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),c=!0),this.previous&&this.previous.resume(),!c},flush:function(){},processChunk:function(c){this.push(c)},withStreamInfo:function(c,n){return this.extraStreamInfo[c]=n,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var c in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,c)&&(this.streamInfo[c]=this.extraStreamInfo[c])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var c="Worker "+this.name;return this.previous?this.previous+" -> "+c:c}},a.exports=i},{}],29:[function(t,a,l){var i=t("../utils"),c=t("./ConvertWorker"),n=t("./GenericWorker"),u=t("../base64"),w=t("../support"),y=t("../external"),_=null;if(w.nodestream)try{_=t("../nodejs/NodejsStreamOutputAdapter")}catch{}function E(T,m){return new y.Promise(function(S,f){var x=[],k=T._internalType,N=T._outputType,C=T._mimeType;T.on("data",function(H,$){x.push(H),m&&m($)}).on("error",function(H){x=[],f(H)}).on("end",function(){try{var H=function($,Z,R){switch($){case"blob":return i.newBlob(i.transformTo("arraybuffer",Z),R);case"base64":return u.encode(Z);default:return i.transformTo($,Z)}}(N,function($,Z){var R,ce=0,ge=null,I=0;for(R=0;R<Z.length;R++)I+=Z[R].length;switch($){case"string":return Z.join("");case"array":return Array.prototype.concat.apply([],Z);case"uint8array":for(ge=new Uint8Array(I),R=0;R<Z.length;R++)ge.set(Z[R],ce),ce+=Z[R].length;return ge;case"nodebuffer":return Buffer.concat(Z);default:throw new Error("concat : unsupported type '"+$+"'")}}(k,x),C);S(H)}catch($){f($)}x=[]}).resume()})}function p(T,m,S){var f=m;switch(m){case"blob":case"arraybuffer":f="uint8array";break;case"base64":f="string"}try{this._internalType=f,this._outputType=m,this._mimeType=S,i.checkSupport(f),this._worker=T.pipe(new c(f)),T.lock()}catch(x){this._worker=new n("error"),this._worker.error(x)}}p.prototype={accumulate:function(T){return E(this,T)},on:function(T,m){var S=this;return T==="data"?this._worker.on(T,function(f){m.call(S,f.data,f.meta)}):this._worker.on(T,function(){i.delay(m,arguments,S)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(T){if(i.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new _(this,{objectMode:this._outputType!=="nodebuffer"},T)}},a.exports=p},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,a,l){if(l.base64=!0,l.array=!0,l.string=!0,l.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",l.nodebuffer=typeof Buffer<"u",l.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")l.blob=!1;else{var i=new ArrayBuffer(0);try{l.blob=new Blob([i],{type:"application/zip"}).size===0}catch{try{var c=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);c.append(i),l.blob=c.getBlob("application/zip").size===0}catch{l.blob=!1}}}try{l.nodestream=!!t("readable-stream").Readable}catch{l.nodestream=!1}},{"readable-stream":16}],31:[function(t,a,l){for(var i=t("./utils"),c=t("./support"),n=t("./nodejsUtils"),u=t("./stream/GenericWorker"),w=new Array(256),y=0;y<256;y++)w[y]=252<=y?6:248<=y?5:240<=y?4:224<=y?3:192<=y?2:1;w[254]=w[254]=1;function _(){u.call(this,"utf-8 decode"),this.leftOver=null}function E(){u.call(this,"utf-8 encode")}l.utf8encode=function(p){return c.nodebuffer?n.newBufferFrom(p,"utf-8"):function(T){var m,S,f,x,k,N=T.length,C=0;for(x=0;x<N;x++)(64512&(S=T.charCodeAt(x)))==55296&&x+1<N&&(64512&(f=T.charCodeAt(x+1)))==56320&&(S=65536+(S-55296<<10)+(f-56320),x++),C+=S<128?1:S<2048?2:S<65536?3:4;for(m=c.uint8array?new Uint8Array(C):new Array(C),x=k=0;k<C;x++)(64512&(S=T.charCodeAt(x)))==55296&&x+1<N&&(64512&(f=T.charCodeAt(x+1)))==56320&&(S=65536+(S-55296<<10)+(f-56320),x++),S<128?m[k++]=S:(S<2048?m[k++]=192|S>>>6:(S<65536?m[k++]=224|S>>>12:(m[k++]=240|S>>>18,m[k++]=128|S>>>12&63),m[k++]=128|S>>>6&63),m[k++]=128|63&S);return m}(p)},l.utf8decode=function(p){return c.nodebuffer?i.transformTo("nodebuffer",p).toString("utf-8"):function(T){var m,S,f,x,k=T.length,N=new Array(2*k);for(m=S=0;m<k;)if((f=T[m++])<128)N[S++]=f;else if(4<(x=w[f]))N[S++]=65533,m+=x-1;else{for(f&=x===2?31:x===3?15:7;1<x&&m<k;)f=f<<6|63&T[m++],x--;1<x?N[S++]=65533:f<65536?N[S++]=f:(f-=65536,N[S++]=55296|f>>10&1023,N[S++]=56320|1023&f)}return N.length!==S&&(N.subarray?N=N.subarray(0,S):N.length=S),i.applyFromCharCode(N)}(p=i.transformTo(c.uint8array?"uint8array":"array",p))},i.inherits(_,u),_.prototype.processChunk=function(p){var T=i.transformTo(c.uint8array?"uint8array":"array",p.data);if(this.leftOver&&this.leftOver.length){if(c.uint8array){var m=T;(T=new Uint8Array(m.length+this.leftOver.length)).set(this.leftOver,0),T.set(m,this.leftOver.length)}else T=this.leftOver.concat(T);this.leftOver=null}var S=function(x,k){var N;for((k=k||x.length)>x.length&&(k=x.length),N=k-1;0<=N&&(192&x[N])==128;)N--;return N<0||N===0?k:N+w[x[N]]>k?N:k}(T),f=T;S!==T.length&&(c.uint8array?(f=T.subarray(0,S),this.leftOver=T.subarray(S,T.length)):(f=T.slice(0,S),this.leftOver=T.slice(S,T.length))),this.push({data:l.utf8decode(f),meta:p.meta})},_.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:l.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},l.Utf8DecodeWorker=_,i.inherits(E,u),E.prototype.processChunk=function(p){this.push({data:l.utf8encode(p.data),meta:p.meta})},l.Utf8EncodeWorker=E},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,a,l){var i=t("./support"),c=t("./base64"),n=t("./nodejsUtils"),u=t("./external");function w(m){return m}function y(m,S){for(var f=0;f<m.length;++f)S[f]=255&m.charCodeAt(f);return S}t("setimmediate"),l.newBlob=function(m,S){l.checkSupport("blob");try{return new Blob([m],{type:S})}catch{try{var f=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return f.append(m),f.getBlob(S)}catch{throw new Error("Bug : can't construct the Blob.")}}};var _={stringifyByChunk:function(m,S,f){var x=[],k=0,N=m.length;if(N<=f)return String.fromCharCode.apply(null,m);for(;k<N;)S==="array"||S==="nodebuffer"?x.push(String.fromCharCode.apply(null,m.slice(k,Math.min(k+f,N)))):x.push(String.fromCharCode.apply(null,m.subarray(k,Math.min(k+f,N)))),k+=f;return x.join("")},stringifyByChar:function(m){for(var S="",f=0;f<m.length;f++)S+=String.fromCharCode(m[f]);return S},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&String.fromCharCode.apply(null,n.allocBuffer(1)).length===1}catch{return!1}}()}};function E(m){var S=65536,f=l.getTypeOf(m),x=!0;if(f==="uint8array"?x=_.applyCanBeUsed.uint8array:f==="nodebuffer"&&(x=_.applyCanBeUsed.nodebuffer),x)for(;1<S;)try{return _.stringifyByChunk(m,f,S)}catch{S=Math.floor(S/2)}return _.stringifyByChar(m)}function p(m,S){for(var f=0;f<m.length;f++)S[f]=m[f];return S}l.applyFromCharCode=E;var T={};T.string={string:w,array:function(m){return y(m,new Array(m.length))},arraybuffer:function(m){return T.string.uint8array(m).buffer},uint8array:function(m){return y(m,new Uint8Array(m.length))},nodebuffer:function(m){return y(m,n.allocBuffer(m.length))}},T.array={string:E,array:w,arraybuffer:function(m){return new Uint8Array(m).buffer},uint8array:function(m){return new Uint8Array(m)},nodebuffer:function(m){return n.newBufferFrom(m)}},T.arraybuffer={string:function(m){return E(new Uint8Array(m))},array:function(m){return p(new Uint8Array(m),new Array(m.byteLength))},arraybuffer:w,uint8array:function(m){return new Uint8Array(m)},nodebuffer:function(m){return n.newBufferFrom(new Uint8Array(m))}},T.uint8array={string:E,array:function(m){return p(m,new Array(m.length))},arraybuffer:function(m){return m.buffer},uint8array:w,nodebuffer:function(m){return n.newBufferFrom(m)}},T.nodebuffer={string:E,array:function(m){return p(m,new Array(m.length))},arraybuffer:function(m){return T.nodebuffer.uint8array(m).buffer},uint8array:function(m){return p(m,new Uint8Array(m.length))},nodebuffer:w},l.transformTo=function(m,S){if(S=S||"",!m)return S;l.checkSupport(m);var f=l.getTypeOf(S);return T[f][m](S)},l.resolve=function(m){for(var S=m.split("/"),f=[],x=0;x<S.length;x++){var k=S[x];k==="."||k===""&&x!==0&&x!==S.length-1||(k===".."?f.pop():f.push(k))}return f.join("/")},l.getTypeOf=function(m){return typeof m=="string"?"string":Object.prototype.toString.call(m)==="[object Array]"?"array":i.nodebuffer&&n.isBuffer(m)?"nodebuffer":i.uint8array&&m instanceof Uint8Array?"uint8array":i.arraybuffer&&m instanceof ArrayBuffer?"arraybuffer":void 0},l.checkSupport=function(m){if(!i[m.toLowerCase()])throw new Error(m+" is not supported by this platform")},l.MAX_VALUE_16BITS=65535,l.MAX_VALUE_32BITS=-1,l.pretty=function(m){var S,f,x="";for(f=0;f<(m||"").length;f++)x+="\\x"+((S=m.charCodeAt(f))<16?"0":"")+S.toString(16).toUpperCase();return x},l.delay=function(m,S,f){setImmediate(function(){m.apply(f||null,S||[])})},l.inherits=function(m,S){function f(){}f.prototype=S.prototype,m.prototype=new f},l.extend=function(){var m,S,f={};for(m=0;m<arguments.length;m++)for(S in arguments[m])Object.prototype.hasOwnProperty.call(arguments[m],S)&&f[S]===void 0&&(f[S]=arguments[m][S]);return f},l.prepareContent=function(m,S,f,x,k){return u.Promise.resolve(S).then(function(N){return i.blob&&(N instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(N))!==-1)&&typeof FileReader<"u"?new u.Promise(function(C,H){var $=new FileReader;$.onload=function(Z){C(Z.target.result)},$.onerror=function(Z){H(Z.target.error)},$.readAsArrayBuffer(N)}):N}).then(function(N){var C=l.getTypeOf(N);return C?(C==="arraybuffer"?N=l.transformTo("uint8array",N):C==="string"&&(k?N=c.decode(N):f&&x!==!0&&(N=function(H){return y(H,i.uint8array?new Uint8Array(H.length):new Array(H.length))}(N))),N):u.Promise.reject(new Error("Can't read the data of '"+m+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,a,l){var i=t("./reader/readerFor"),c=t("./utils"),n=t("./signature"),u=t("./zipEntry"),w=t("./support");function y(_){this.files=[],this.loadOptions=_}y.prototype={checkSignature:function(_){if(!this.reader.readAndCheckSignature(_)){this.reader.index-=4;var E=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+c.pretty(E)+", expected "+c.pretty(_)+")")}},isSignature:function(_,E){var p=this.reader.index;this.reader.setIndex(_);var T=this.reader.readString(4)===E;return this.reader.setIndex(p),T},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var _=this.reader.readData(this.zipCommentLength),E=w.uint8array?"uint8array":"array",p=c.transformTo(E,_);this.zipComment=this.loadOptions.decodeFileName(p)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var _,E,p,T=this.zip64EndOfCentralSize-44;0<T;)_=this.reader.readInt(2),E=this.reader.readInt(4),p=this.reader.readData(E),this.zip64ExtensibleData[_]={id:_,length:E,value:p}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var _,E;for(_=0;_<this.files.length;_++)E=this.files[_],this.reader.setIndex(E.localHeaderOffset),this.checkSignature(n.LOCAL_FILE_HEADER),E.readLocalPart(this.reader),E.handleUTF8(),E.processAttributes()},readCentralDir:function(){var _;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(n.CENTRAL_FILE_HEADER);)(_=new u({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(_);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var _=this.reader.lastIndexOfSignature(n.CENTRAL_DIRECTORY_END);if(_<0)throw this.isSignature(0,n.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(_);var E=_;if(this.checkSignature(n.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===c.MAX_VALUE_16BITS||this.diskWithCentralDirStart===c.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===c.MAX_VALUE_16BITS||this.centralDirRecords===c.MAX_VALUE_16BITS||this.centralDirSize===c.MAX_VALUE_32BITS||this.centralDirOffset===c.MAX_VALUE_32BITS){if(this.zip64=!0,(_=this.reader.lastIndexOfSignature(n.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(_),this.checkSignature(n.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,n.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(n.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(n.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var p=this.centralDirOffset+this.centralDirSize;this.zip64&&(p+=20,p+=12+this.zip64EndOfCentralSize);var T=E-p;if(0<T)this.isSignature(E,n.CENTRAL_FILE_HEADER)||(this.reader.zero=T);else if(T<0)throw new Error("Corrupted zip: missing "+Math.abs(T)+" bytes.")},prepareReader:function(_){this.reader=i(_)},load:function(_){this.prepareReader(_),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},a.exports=y},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,a,l){var i=t("./reader/readerFor"),c=t("./utils"),n=t("./compressedObject"),u=t("./crc32"),w=t("./utf8"),y=t("./compressions"),_=t("./support");function E(p,T){this.options=p,this.loadOptions=T}E.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(p){var T,m;if(p.skip(22),this.fileNameLength=p.readInt(2),m=p.readInt(2),this.fileName=p.readData(this.fileNameLength),p.skip(m),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((T=function(S){for(var f in y)if(Object.prototype.hasOwnProperty.call(y,f)&&y[f].magic===S)return y[f];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+c.pretty(this.compressionMethod)+" unknown (inner file : "+c.transformTo("string",this.fileName)+")");this.decompressed=new n(this.compressedSize,this.uncompressedSize,this.crc32,T,p.readData(this.compressedSize))},readCentralPart:function(p){this.versionMadeBy=p.readInt(2),p.skip(2),this.bitFlag=p.readInt(2),this.compressionMethod=p.readString(2),this.date=p.readDate(),this.crc32=p.readInt(4),this.compressedSize=p.readInt(4),this.uncompressedSize=p.readInt(4);var T=p.readInt(2);if(this.extraFieldsLength=p.readInt(2),this.fileCommentLength=p.readInt(2),this.diskNumberStart=p.readInt(2),this.internalFileAttributes=p.readInt(2),this.externalFileAttributes=p.readInt(4),this.localHeaderOffset=p.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");p.skip(T),this.readExtraFields(p),this.parseZIP64ExtraField(p),this.fileComment=p.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var p=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),p==0&&(this.dosPermissions=63&this.externalFileAttributes),p==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var p=i(this.extraFields[1].value);this.uncompressedSize===c.MAX_VALUE_32BITS&&(this.uncompressedSize=p.readInt(8)),this.compressedSize===c.MAX_VALUE_32BITS&&(this.compressedSize=p.readInt(8)),this.localHeaderOffset===c.MAX_VALUE_32BITS&&(this.localHeaderOffset=p.readInt(8)),this.diskNumberStart===c.MAX_VALUE_32BITS&&(this.diskNumberStart=p.readInt(4))}},readExtraFields:function(p){var T,m,S,f=p.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});p.index+4<f;)T=p.readInt(2),m=p.readInt(2),S=p.readData(m),this.extraFields[T]={id:T,length:m,value:S};p.setIndex(f)},handleUTF8:function(){var p=_.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=w.utf8decode(this.fileName),this.fileCommentStr=w.utf8decode(this.fileComment);else{var T=this.findExtraFieldUnicodePath();if(T!==null)this.fileNameStr=T;else{var m=c.transformTo(p,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(m)}var S=this.findExtraFieldUnicodeComment();if(S!==null)this.fileCommentStr=S;else{var f=c.transformTo(p,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(f)}}},findExtraFieldUnicodePath:function(){var p=this.extraFields[28789];if(p){var T=i(p.value);return T.readInt(1)!==1||u(this.fileName)!==T.readInt(4)?null:w.utf8decode(T.readData(p.length-5))}return null},findExtraFieldUnicodeComment:function(){var p=this.extraFields[25461];if(p){var T=i(p.value);return T.readInt(1)!==1||u(this.fileComment)!==T.readInt(4)?null:w.utf8decode(T.readData(p.length-5))}return null}},a.exports=E},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,a,l){function i(T,m,S){this.name=T,this.dir=S.dir,this.date=S.date,this.comment=S.comment,this.unixPermissions=S.unixPermissions,this.dosPermissions=S.dosPermissions,this._data=m,this._dataBinary=S.binary,this.options={compression:S.compression,compressionOptions:S.compressionOptions}}var c=t("./stream/StreamHelper"),n=t("./stream/DataWorker"),u=t("./utf8"),w=t("./compressedObject"),y=t("./stream/GenericWorker");i.prototype={internalStream:function(T){var m=null,S="string";try{if(!T)throw new Error("No output type specified.");var f=(S=T.toLowerCase())==="string"||S==="text";S!=="binarystring"&&S!=="text"||(S="string"),m=this._decompressWorker();var x=!this._dataBinary;x&&!f&&(m=m.pipe(new u.Utf8EncodeWorker)),!x&&f&&(m=m.pipe(new u.Utf8DecodeWorker))}catch(k){(m=new y("error")).error(k)}return new c(m,S,"")},async:function(T,m){return this.internalStream(T).accumulate(m)},nodeStream:function(T,m){return this.internalStream(T||"nodebuffer").toNodejsStream(m)},_compressWorker:function(T,m){if(this._data instanceof w&&this._data.compression.magic===T.magic)return this._data.getCompressedWorker();var S=this._decompressWorker();return this._dataBinary||(S=S.pipe(new u.Utf8EncodeWorker)),w.createWorkerFrom(S,T,m)},_decompressWorker:function(){return this._data instanceof w?this._data.getContentWorker():this._data instanceof y?this._data:new n(this._data)}};for(var _=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],E=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},p=0;p<_.length;p++)i.prototype[_[p]]=E;a.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,a,l){(function(i){var c,n,u=i.MutationObserver||i.WebKitMutationObserver;if(u){var w=0,y=new u(T),_=i.document.createTextNode("");y.observe(_,{characterData:!0}),c=function(){_.data=w=++w%2}}else if(i.setImmediate||i.MessageChannel===void 0)c="document"in i&&"onreadystatechange"in i.document.createElement("script")?function(){var m=i.document.createElement("script");m.onreadystatechange=function(){T(),m.onreadystatechange=null,m.parentNode.removeChild(m),m=null},i.document.documentElement.appendChild(m)}:function(){setTimeout(T,0)};else{var E=new i.MessageChannel;E.port1.onmessage=T,c=function(){E.port2.postMessage(0)}}var p=[];function T(){var m,S;n=!0;for(var f=p.length;f;){for(S=p,p=[],m=-1;++m<f;)S[m]();f=p.length}n=!1}a.exports=function(m){p.push(m)!==1||n||c()}}).call(this,typeof Rt<"u"?Rt:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(t,a,l){var i=t("immediate");function c(){}var n={},u=["REJECTED"],w=["FULFILLED"],y=["PENDING"];function _(f){if(typeof f!="function")throw new TypeError("resolver must be a function");this.state=y,this.queue=[],this.outcome=void 0,f!==c&&m(this,f)}function E(f,x,k){this.promise=f,typeof x=="function"&&(this.onFulfilled=x,this.callFulfilled=this.otherCallFulfilled),typeof k=="function"&&(this.onRejected=k,this.callRejected=this.otherCallRejected)}function p(f,x,k){i(function(){var N;try{N=x(k)}catch(C){return n.reject(f,C)}N===f?n.reject(f,new TypeError("Cannot resolve promise with itself")):n.resolve(f,N)})}function T(f){var x=f&&f.then;if(f&&(typeof f=="object"||typeof f=="function")&&typeof x=="function")return function(){x.apply(f,arguments)}}function m(f,x){var k=!1;function N($){k||(k=!0,n.reject(f,$))}function C($){k||(k=!0,n.resolve(f,$))}var H=S(function(){x(C,N)});H.status==="error"&&N(H.value)}function S(f,x){var k={};try{k.value=f(x),k.status="success"}catch(N){k.status="error",k.value=N}return k}(a.exports=_).prototype.finally=function(f){if(typeof f!="function")return this;var x=this.constructor;return this.then(function(k){return x.resolve(f()).then(function(){return k})},function(k){return x.resolve(f()).then(function(){throw k})})},_.prototype.catch=function(f){return this.then(null,f)},_.prototype.then=function(f,x){if(typeof f!="function"&&this.state===w||typeof x!="function"&&this.state===u)return this;var k=new this.constructor(c);return this.state!==y?p(k,this.state===w?f:x,this.outcome):this.queue.push(new E(k,f,x)),k},E.prototype.callFulfilled=function(f){n.resolve(this.promise,f)},E.prototype.otherCallFulfilled=function(f){p(this.promise,this.onFulfilled,f)},E.prototype.callRejected=function(f){n.reject(this.promise,f)},E.prototype.otherCallRejected=function(f){p(this.promise,this.onRejected,f)},n.resolve=function(f,x){var k=S(T,x);if(k.status==="error")return n.reject(f,k.value);var N=k.value;if(N)m(f,N);else{f.state=w,f.outcome=x;for(var C=-1,H=f.queue.length;++C<H;)f.queue[C].callFulfilled(x)}return f},n.reject=function(f,x){f.state=u,f.outcome=x;for(var k=-1,N=f.queue.length;++k<N;)f.queue[k].callRejected(x);return f},_.resolve=function(f){return f instanceof this?f:n.resolve(new this(c),f)},_.reject=function(f){var x=new this(c);return n.reject(x,f)},_.all=function(f){var x=this;if(Object.prototype.toString.call(f)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=f.length,N=!1;if(!k)return this.resolve([]);for(var C=new Array(k),H=0,$=-1,Z=new this(c);++$<k;)R(f[$],$);return Z;function R(ce,ge){x.resolve(ce).then(function(I){C[ge]=I,++H!==k||N||(N=!0,n.resolve(Z,C))},function(I){N||(N=!0,n.reject(Z,I))})}},_.race=function(f){var x=this;if(Object.prototype.toString.call(f)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=f.length,N=!1;if(!k)return this.resolve([]);for(var C=-1,H=new this(c);++C<k;)$=f[C],x.resolve($).then(function(Z){N||(N=!0,n.resolve(H,Z))},function(Z){N||(N=!0,n.reject(H,Z))});var $;return H}},{immediate:36}],38:[function(t,a,l){var i={};(0,t("./lib/utils/common").assign)(i,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),a.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,a,l){var i=t("./zlib/deflate"),c=t("./utils/common"),n=t("./utils/strings"),u=t("./zlib/messages"),w=t("./zlib/zstream"),y=Object.prototype.toString,_=0,E=-1,p=0,T=8;function m(f){if(!(this instanceof m))return new m(f);this.options=c.assign({level:E,method:T,chunkSize:16384,windowBits:15,memLevel:8,strategy:p,to:""},f||{});var x=this.options;x.raw&&0<x.windowBits?x.windowBits=-x.windowBits:x.gzip&&0<x.windowBits&&x.windowBits<16&&(x.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new w,this.strm.avail_out=0;var k=i.deflateInit2(this.strm,x.level,x.method,x.windowBits,x.memLevel,x.strategy);if(k!==_)throw new Error(u[k]);if(x.header&&i.deflateSetHeader(this.strm,x.header),x.dictionary){var N;if(N=typeof x.dictionary=="string"?n.string2buf(x.dictionary):y.call(x.dictionary)==="[object ArrayBuffer]"?new Uint8Array(x.dictionary):x.dictionary,(k=i.deflateSetDictionary(this.strm,N))!==_)throw new Error(u[k]);this._dict_set=!0}}function S(f,x){var k=new m(x);if(k.push(f,!0),k.err)throw k.msg||u[k.err];return k.result}m.prototype.push=function(f,x){var k,N,C=this.strm,H=this.options.chunkSize;if(this.ended)return!1;N=x===~~x?x:x===!0?4:0,typeof f=="string"?C.input=n.string2buf(f):y.call(f)==="[object ArrayBuffer]"?C.input=new Uint8Array(f):C.input=f,C.next_in=0,C.avail_in=C.input.length;do{if(C.avail_out===0&&(C.output=new c.Buf8(H),C.next_out=0,C.avail_out=H),(k=i.deflate(C,N))!==1&&k!==_)return this.onEnd(k),!(this.ended=!0);C.avail_out!==0&&(C.avail_in!==0||N!==4&&N!==2)||(this.options.to==="string"?this.onData(n.buf2binstring(c.shrinkBuf(C.output,C.next_out))):this.onData(c.shrinkBuf(C.output,C.next_out)))}while((0<C.avail_in||C.avail_out===0)&&k!==1);return N===4?(k=i.deflateEnd(this.strm),this.onEnd(k),this.ended=!0,k===_):N!==2||(this.onEnd(_),!(C.avail_out=0))},m.prototype.onData=function(f){this.chunks.push(f)},m.prototype.onEnd=function(f){f===_&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=c.flattenChunks(this.chunks)),this.chunks=[],this.err=f,this.msg=this.strm.msg},l.Deflate=m,l.deflate=S,l.deflateRaw=function(f,x){return(x=x||{}).raw=!0,S(f,x)},l.gzip=function(f,x){return(x=x||{}).gzip=!0,S(f,x)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,a,l){var i=t("./zlib/inflate"),c=t("./utils/common"),n=t("./utils/strings"),u=t("./zlib/constants"),w=t("./zlib/messages"),y=t("./zlib/zstream"),_=t("./zlib/gzheader"),E=Object.prototype.toString;function p(m){if(!(this instanceof p))return new p(m);this.options=c.assign({chunkSize:16384,windowBits:0,to:""},m||{});var S=this.options;S.raw&&0<=S.windowBits&&S.windowBits<16&&(S.windowBits=-S.windowBits,S.windowBits===0&&(S.windowBits=-15)),!(0<=S.windowBits&&S.windowBits<16)||m&&m.windowBits||(S.windowBits+=32),15<S.windowBits&&S.windowBits<48&&!(15&S.windowBits)&&(S.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new y,this.strm.avail_out=0;var f=i.inflateInit2(this.strm,S.windowBits);if(f!==u.Z_OK)throw new Error(w[f]);this.header=new _,i.inflateGetHeader(this.strm,this.header)}function T(m,S){var f=new p(S);if(f.push(m,!0),f.err)throw f.msg||w[f.err];return f.result}p.prototype.push=function(m,S){var f,x,k,N,C,H,$=this.strm,Z=this.options.chunkSize,R=this.options.dictionary,ce=!1;if(this.ended)return!1;x=S===~~S?S:S===!0?u.Z_FINISH:u.Z_NO_FLUSH,typeof m=="string"?$.input=n.binstring2buf(m):E.call(m)==="[object ArrayBuffer]"?$.input=new Uint8Array(m):$.input=m,$.next_in=0,$.avail_in=$.input.length;do{if($.avail_out===0&&($.output=new c.Buf8(Z),$.next_out=0,$.avail_out=Z),(f=i.inflate($,u.Z_NO_FLUSH))===u.Z_NEED_DICT&&R&&(H=typeof R=="string"?n.string2buf(R):E.call(R)==="[object ArrayBuffer]"?new Uint8Array(R):R,f=i.inflateSetDictionary(this.strm,H)),f===u.Z_BUF_ERROR&&ce===!0&&(f=u.Z_OK,ce=!1),f!==u.Z_STREAM_END&&f!==u.Z_OK)return this.onEnd(f),!(this.ended=!0);$.next_out&&($.avail_out!==0&&f!==u.Z_STREAM_END&&($.avail_in!==0||x!==u.Z_FINISH&&x!==u.Z_SYNC_FLUSH)||(this.options.to==="string"?(k=n.utf8border($.output,$.next_out),N=$.next_out-k,C=n.buf2string($.output,k),$.next_out=N,$.avail_out=Z-N,N&&c.arraySet($.output,$.output,k,N,0),this.onData(C)):this.onData(c.shrinkBuf($.output,$.next_out)))),$.avail_in===0&&$.avail_out===0&&(ce=!0)}while((0<$.avail_in||$.avail_out===0)&&f!==u.Z_STREAM_END);return f===u.Z_STREAM_END&&(x=u.Z_FINISH),x===u.Z_FINISH?(f=i.inflateEnd(this.strm),this.onEnd(f),this.ended=!0,f===u.Z_OK):x!==u.Z_SYNC_FLUSH||(this.onEnd(u.Z_OK),!($.avail_out=0))},p.prototype.onData=function(m){this.chunks.push(m)},p.prototype.onEnd=function(m){m===u.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=c.flattenChunks(this.chunks)),this.chunks=[],this.err=m,this.msg=this.strm.msg},l.Inflate=p,l.inflate=T,l.inflateRaw=function(m,S){return(S=S||{}).raw=!0,T(m,S)},l.ungzip=T},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,a,l){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";l.assign=function(u){for(var w=Array.prototype.slice.call(arguments,1);w.length;){var y=w.shift();if(y){if(typeof y!="object")throw new TypeError(y+"must be non-object");for(var _ in y)y.hasOwnProperty(_)&&(u[_]=y[_])}}return u},l.shrinkBuf=function(u,w){return u.length===w?u:u.subarray?u.subarray(0,w):(u.length=w,u)};var c={arraySet:function(u,w,y,_,E){if(w.subarray&&u.subarray)u.set(w.subarray(y,y+_),E);else for(var p=0;p<_;p++)u[E+p]=w[y+p]},flattenChunks:function(u){var w,y,_,E,p,T;for(w=_=0,y=u.length;w<y;w++)_+=u[w].length;for(T=new Uint8Array(_),w=E=0,y=u.length;w<y;w++)p=u[w],T.set(p,E),E+=p.length;return T}},n={arraySet:function(u,w,y,_,E){for(var p=0;p<_;p++)u[E+p]=w[y+p]},flattenChunks:function(u){return[].concat.apply([],u)}};l.setTyped=function(u){u?(l.Buf8=Uint8Array,l.Buf16=Uint16Array,l.Buf32=Int32Array,l.assign(l,c)):(l.Buf8=Array,l.Buf16=Array,l.Buf32=Array,l.assign(l,n))},l.setTyped(i)},{}],42:[function(t,a,l){var i=t("./common"),c=!0,n=!0;try{String.fromCharCode.apply(null,[0])}catch{c=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{n=!1}for(var u=new i.Buf8(256),w=0;w<256;w++)u[w]=252<=w?6:248<=w?5:240<=w?4:224<=w?3:192<=w?2:1;function y(_,E){if(E<65537&&(_.subarray&&n||!_.subarray&&c))return String.fromCharCode.apply(null,i.shrinkBuf(_,E));for(var p="",T=0;T<E;T++)p+=String.fromCharCode(_[T]);return p}u[254]=u[254]=1,l.string2buf=function(_){var E,p,T,m,S,f=_.length,x=0;for(m=0;m<f;m++)(64512&(p=_.charCodeAt(m)))==55296&&m+1<f&&(64512&(T=_.charCodeAt(m+1)))==56320&&(p=65536+(p-55296<<10)+(T-56320),m++),x+=p<128?1:p<2048?2:p<65536?3:4;for(E=new i.Buf8(x),m=S=0;S<x;m++)(64512&(p=_.charCodeAt(m)))==55296&&m+1<f&&(64512&(T=_.charCodeAt(m+1)))==56320&&(p=65536+(p-55296<<10)+(T-56320),m++),p<128?E[S++]=p:(p<2048?E[S++]=192|p>>>6:(p<65536?E[S++]=224|p>>>12:(E[S++]=240|p>>>18,E[S++]=128|p>>>12&63),E[S++]=128|p>>>6&63),E[S++]=128|63&p);return E},l.buf2binstring=function(_){return y(_,_.length)},l.binstring2buf=function(_){for(var E=new i.Buf8(_.length),p=0,T=E.length;p<T;p++)E[p]=_.charCodeAt(p);return E},l.buf2string=function(_,E){var p,T,m,S,f=E||_.length,x=new Array(2*f);for(p=T=0;p<f;)if((m=_[p++])<128)x[T++]=m;else if(4<(S=u[m]))x[T++]=65533,p+=S-1;else{for(m&=S===2?31:S===3?15:7;1<S&&p<f;)m=m<<6|63&_[p++],S--;1<S?x[T++]=65533:m<65536?x[T++]=m:(m-=65536,x[T++]=55296|m>>10&1023,x[T++]=56320|1023&m)}return y(x,T)},l.utf8border=function(_,E){var p;for((E=E||_.length)>_.length&&(E=_.length),p=E-1;0<=p&&(192&_[p])==128;)p--;return p<0||p===0?E:p+u[_[p]]>E?p:E}},{"./common":41}],43:[function(t,a,l){a.exports=function(i,c,n,u){for(var w=65535&i|0,y=i>>>16&65535|0,_=0;n!==0;){for(n-=_=2e3<n?2e3:n;y=y+(w=w+c[u++]|0)|0,--_;);w%=65521,y%=65521}return w|y<<16|0}},{}],44:[function(t,a,l){a.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,a,l){var i=function(){for(var c,n=[],u=0;u<256;u++){c=u;for(var w=0;w<8;w++)c=1&c?3988292384^c>>>1:c>>>1;n[u]=c}return n}();a.exports=function(c,n,u,w){var y=i,_=w+u;c^=-1;for(var E=w;E<_;E++)c=c>>>8^y[255&(c^n[E])];return-1^c}},{}],46:[function(t,a,l){var i,c=t("../utils/common"),n=t("./trees"),u=t("./adler32"),w=t("./crc32"),y=t("./messages"),_=0,E=4,p=0,T=-2,m=-1,S=4,f=2,x=8,k=9,N=286,C=30,H=19,$=2*N+1,Z=15,R=3,ce=258,ge=ce+R+1,I=42,V=113,A=1,j=2,oe=3,G=4;function we(h,Q){return h.msg=y[Q],Q}function Y(h){return(h<<1)-(4<h?9:0)}function te(h){for(var Q=h.length;0<=--Q;)h[Q]=0}function M(h){var Q=h.state,b=Q.pending;b>h.avail_out&&(b=h.avail_out),b!==0&&(c.arraySet(h.output,Q.pending_buf,Q.pending_out,b,h.next_out),h.next_out+=b,Q.pending_out+=b,h.total_out+=b,h.avail_out-=b,Q.pending-=b,Q.pending===0&&(Q.pending_out=0))}function D(h,Q){n._tr_flush_block(h,0<=h.block_start?h.block_start:-1,h.strstart-h.block_start,Q),h.block_start=h.strstart,M(h.strm)}function q(h,Q){h.pending_buf[h.pending++]=Q}function X(h,Q){h.pending_buf[h.pending++]=Q>>>8&255,h.pending_buf[h.pending++]=255&Q}function ie(h,Q){var b,o,s=h.max_chain_length,d=h.strstart,F=h.prev_length,K=h.nice_match,L=h.strstart>h.w_size-ge?h.strstart-(h.w_size-ge):0,ue=h.window,ve=h.w_mask,ae=h.prev,Ee=h.strstart+ce,ke=ue[d+F-1],Ne=ue[d+F];h.prev_length>=h.good_match&&(s>>=2),K>h.lookahead&&(K=h.lookahead);do if(ue[(b=Q)+F]===Ne&&ue[b+F-1]===ke&&ue[b]===ue[d]&&ue[++b]===ue[d+1]){d+=2,b++;do;while(ue[++d]===ue[++b]&&ue[++d]===ue[++b]&&ue[++d]===ue[++b]&&ue[++d]===ue[++b]&&ue[++d]===ue[++b]&&ue[++d]===ue[++b]&&ue[++d]===ue[++b]&&ue[++d]===ue[++b]&&d<Ee);if(o=ce-(Ee-d),d=Ee-ce,F<o){if(h.match_start=Q,K<=(F=o))break;ke=ue[d+F-1],Ne=ue[d+F]}}while((Q=ae[Q&ve])>L&&--s!=0);return F<=h.lookahead?F:h.lookahead}function z(h){var Q,b,o,s,d,F,K,L,ue,ve,ae=h.w_size;do{if(s=h.window_size-h.lookahead-h.strstart,h.strstart>=ae+(ae-ge)){for(c.arraySet(h.window,h.window,ae,ae,0),h.match_start-=ae,h.strstart-=ae,h.block_start-=ae,Q=b=h.hash_size;o=h.head[--Q],h.head[Q]=ae<=o?o-ae:0,--b;);for(Q=b=ae;o=h.prev[--Q],h.prev[Q]=ae<=o?o-ae:0,--b;);s+=ae}if(h.strm.avail_in===0)break;if(F=h.strm,K=h.window,L=h.strstart+h.lookahead,ue=s,ve=void 0,ve=F.avail_in,ue<ve&&(ve=ue),b=ve===0?0:(F.avail_in-=ve,c.arraySet(K,F.input,F.next_in,ve,L),F.state.wrap===1?F.adler=u(F.adler,K,ve,L):F.state.wrap===2&&(F.adler=w(F.adler,K,ve,L)),F.next_in+=ve,F.total_in+=ve,ve),h.lookahead+=b,h.lookahead+h.insert>=R)for(d=h.strstart-h.insert,h.ins_h=h.window[d],h.ins_h=(h.ins_h<<h.hash_shift^h.window[d+1])&h.hash_mask;h.insert&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[d+R-1])&h.hash_mask,h.prev[d&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=d,d++,h.insert--,!(h.lookahead+h.insert<R)););}while(h.lookahead<ge&&h.strm.avail_in!==0)}function v(h,Q){for(var b,o;;){if(h.lookahead<ge){if(z(h),h.lookahead<ge&&Q===_)return A;if(h.lookahead===0)break}if(b=0,h.lookahead>=R&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+R-1])&h.hash_mask,b=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart),b!==0&&h.strstart-b<=h.w_size-ge&&(h.match_length=ie(h,b)),h.match_length>=R)if(o=n._tr_tally(h,h.strstart-h.match_start,h.match_length-R),h.lookahead-=h.match_length,h.match_length<=h.max_lazy_match&&h.lookahead>=R){for(h.match_length--;h.strstart++,h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+R-1])&h.hash_mask,b=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart,--h.match_length!=0;);h.strstart++}else h.strstart+=h.match_length,h.match_length=0,h.ins_h=h.window[h.strstart],h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+1])&h.hash_mask;else o=n._tr_tally(h,0,h.window[h.strstart]),h.lookahead--,h.strstart++;if(o&&(D(h,!1),h.strm.avail_out===0))return A}return h.insert=h.strstart<R-1?h.strstart:R-1,Q===E?(D(h,!0),h.strm.avail_out===0?oe:G):h.last_lit&&(D(h,!1),h.strm.avail_out===0)?A:j}function g(h,Q){for(var b,o,s;;){if(h.lookahead<ge){if(z(h),h.lookahead<ge&&Q===_)return A;if(h.lookahead===0)break}if(b=0,h.lookahead>=R&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+R-1])&h.hash_mask,b=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart),h.prev_length=h.match_length,h.prev_match=h.match_start,h.match_length=R-1,b!==0&&h.prev_length<h.max_lazy_match&&h.strstart-b<=h.w_size-ge&&(h.match_length=ie(h,b),h.match_length<=5&&(h.strategy===1||h.match_length===R&&4096<h.strstart-h.match_start)&&(h.match_length=R-1)),h.prev_length>=R&&h.match_length<=h.prev_length){for(s=h.strstart+h.lookahead-R,o=n._tr_tally(h,h.strstart-1-h.prev_match,h.prev_length-R),h.lookahead-=h.prev_length-1,h.prev_length-=2;++h.strstart<=s&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+R-1])&h.hash_mask,b=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart),--h.prev_length!=0;);if(h.match_available=0,h.match_length=R-1,h.strstart++,o&&(D(h,!1),h.strm.avail_out===0))return A}else if(h.match_available){if((o=n._tr_tally(h,0,h.window[h.strstart-1]))&&D(h,!1),h.strstart++,h.lookahead--,h.strm.avail_out===0)return A}else h.match_available=1,h.strstart++,h.lookahead--}return h.match_available&&(o=n._tr_tally(h,0,h.window[h.strstart-1]),h.match_available=0),h.insert=h.strstart<R-1?h.strstart:R-1,Q===E?(D(h,!0),h.strm.avail_out===0?oe:G):h.last_lit&&(D(h,!1),h.strm.avail_out===0)?A:j}function U(h,Q,b,o,s){this.good_length=h,this.max_lazy=Q,this.nice_length=b,this.max_chain=o,this.func=s}function P(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=x,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new c.Buf16(2*$),this.dyn_dtree=new c.Buf16(2*(2*C+1)),this.bl_tree=new c.Buf16(2*(2*H+1)),te(this.dyn_ltree),te(this.dyn_dtree),te(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new c.Buf16(Z+1),this.heap=new c.Buf16(2*N+1),te(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new c.Buf16(2*N+1),te(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function O(h){var Q;return h&&h.state?(h.total_in=h.total_out=0,h.data_type=f,(Q=h.state).pending=0,Q.pending_out=0,Q.wrap<0&&(Q.wrap=-Q.wrap),Q.status=Q.wrap?I:V,h.adler=Q.wrap===2?0:1,Q.last_flush=_,n._tr_init(Q),p):we(h,T)}function B(h){var Q=O(h);return Q===p&&function(b){b.window_size=2*b.w_size,te(b.head),b.max_lazy_match=i[b.level].max_lazy,b.good_match=i[b.level].good_length,b.nice_match=i[b.level].nice_length,b.max_chain_length=i[b.level].max_chain,b.strstart=0,b.block_start=0,b.lookahead=0,b.insert=0,b.match_length=b.prev_length=R-1,b.match_available=0,b.ins_h=0}(h.state),Q}function se(h,Q,b,o,s,d){if(!h)return T;var F=1;if(Q===m&&(Q=6),o<0?(F=0,o=-o):15<o&&(F=2,o-=16),s<1||k<s||b!==x||o<8||15<o||Q<0||9<Q||d<0||S<d)return we(h,T);o===8&&(o=9);var K=new P;return(h.state=K).strm=h,K.wrap=F,K.gzhead=null,K.w_bits=o,K.w_size=1<<K.w_bits,K.w_mask=K.w_size-1,K.hash_bits=s+7,K.hash_size=1<<K.hash_bits,K.hash_mask=K.hash_size-1,K.hash_shift=~~((K.hash_bits+R-1)/R),K.window=new c.Buf8(2*K.w_size),K.head=new c.Buf16(K.hash_size),K.prev=new c.Buf16(K.w_size),K.lit_bufsize=1<<s+6,K.pending_buf_size=4*K.lit_bufsize,K.pending_buf=new c.Buf8(K.pending_buf_size),K.d_buf=1*K.lit_bufsize,K.l_buf=3*K.lit_bufsize,K.level=Q,K.strategy=d,K.method=b,B(h)}i=[new U(0,0,0,0,function(h,Q){var b=65535;for(b>h.pending_buf_size-5&&(b=h.pending_buf_size-5);;){if(h.lookahead<=1){if(z(h),h.lookahead===0&&Q===_)return A;if(h.lookahead===0)break}h.strstart+=h.lookahead,h.lookahead=0;var o=h.block_start+b;if((h.strstart===0||h.strstart>=o)&&(h.lookahead=h.strstart-o,h.strstart=o,D(h,!1),h.strm.avail_out===0)||h.strstart-h.block_start>=h.w_size-ge&&(D(h,!1),h.strm.avail_out===0))return A}return h.insert=0,Q===E?(D(h,!0),h.strm.avail_out===0?oe:G):(h.strstart>h.block_start&&(D(h,!1),h.strm.avail_out),A)}),new U(4,4,8,4,v),new U(4,5,16,8,v),new U(4,6,32,32,v),new U(4,4,16,16,g),new U(8,16,32,32,g),new U(8,16,128,128,g),new U(8,32,128,256,g),new U(32,128,258,1024,g),new U(32,258,258,4096,g)],l.deflateInit=function(h,Q){return se(h,Q,x,15,8,0)},l.deflateInit2=se,l.deflateReset=B,l.deflateResetKeep=O,l.deflateSetHeader=function(h,Q){return h&&h.state?h.state.wrap!==2?T:(h.state.gzhead=Q,p):T},l.deflate=function(h,Q){var b,o,s,d;if(!h||!h.state||5<Q||Q<0)return h?we(h,T):T;if(o=h.state,!h.output||!h.input&&h.avail_in!==0||o.status===666&&Q!==E)return we(h,h.avail_out===0?-5:T);if(o.strm=h,b=o.last_flush,o.last_flush=Q,o.status===I)if(o.wrap===2)h.adler=0,q(o,31),q(o,139),q(o,8),o.gzhead?(q(o,(o.gzhead.text?1:0)+(o.gzhead.hcrc?2:0)+(o.gzhead.extra?4:0)+(o.gzhead.name?8:0)+(o.gzhead.comment?16:0)),q(o,255&o.gzhead.time),q(o,o.gzhead.time>>8&255),q(o,o.gzhead.time>>16&255),q(o,o.gzhead.time>>24&255),q(o,o.level===9?2:2<=o.strategy||o.level<2?4:0),q(o,255&o.gzhead.os),o.gzhead.extra&&o.gzhead.extra.length&&(q(o,255&o.gzhead.extra.length),q(o,o.gzhead.extra.length>>8&255)),o.gzhead.hcrc&&(h.adler=w(h.adler,o.pending_buf,o.pending,0)),o.gzindex=0,o.status=69):(q(o,0),q(o,0),q(o,0),q(o,0),q(o,0),q(o,o.level===9?2:2<=o.strategy||o.level<2?4:0),q(o,3),o.status=V);else{var F=x+(o.w_bits-8<<4)<<8;F|=(2<=o.strategy||o.level<2?0:o.level<6?1:o.level===6?2:3)<<6,o.strstart!==0&&(F|=32),F+=31-F%31,o.status=V,X(o,F),o.strstart!==0&&(X(o,h.adler>>>16),X(o,65535&h.adler)),h.adler=1}if(o.status===69)if(o.gzhead.extra){for(s=o.pending;o.gzindex<(65535&o.gzhead.extra.length)&&(o.pending!==o.pending_buf_size||(o.gzhead.hcrc&&o.pending>s&&(h.adler=w(h.adler,o.pending_buf,o.pending-s,s)),M(h),s=o.pending,o.pending!==o.pending_buf_size));)q(o,255&o.gzhead.extra[o.gzindex]),o.gzindex++;o.gzhead.hcrc&&o.pending>s&&(h.adler=w(h.adler,o.pending_buf,o.pending-s,s)),o.gzindex===o.gzhead.extra.length&&(o.gzindex=0,o.status=73)}else o.status=73;if(o.status===73)if(o.gzhead.name){s=o.pending;do{if(o.pending===o.pending_buf_size&&(o.gzhead.hcrc&&o.pending>s&&(h.adler=w(h.adler,o.pending_buf,o.pending-s,s)),M(h),s=o.pending,o.pending===o.pending_buf_size)){d=1;break}d=o.gzindex<o.gzhead.name.length?255&o.gzhead.name.charCodeAt(o.gzindex++):0,q(o,d)}while(d!==0);o.gzhead.hcrc&&o.pending>s&&(h.adler=w(h.adler,o.pending_buf,o.pending-s,s)),d===0&&(o.gzindex=0,o.status=91)}else o.status=91;if(o.status===91)if(o.gzhead.comment){s=o.pending;do{if(o.pending===o.pending_buf_size&&(o.gzhead.hcrc&&o.pending>s&&(h.adler=w(h.adler,o.pending_buf,o.pending-s,s)),M(h),s=o.pending,o.pending===o.pending_buf_size)){d=1;break}d=o.gzindex<o.gzhead.comment.length?255&o.gzhead.comment.charCodeAt(o.gzindex++):0,q(o,d)}while(d!==0);o.gzhead.hcrc&&o.pending>s&&(h.adler=w(h.adler,o.pending_buf,o.pending-s,s)),d===0&&(o.status=103)}else o.status=103;if(o.status===103&&(o.gzhead.hcrc?(o.pending+2>o.pending_buf_size&&M(h),o.pending+2<=o.pending_buf_size&&(q(o,255&h.adler),q(o,h.adler>>8&255),h.adler=0,o.status=V)):o.status=V),o.pending!==0){if(M(h),h.avail_out===0)return o.last_flush=-1,p}else if(h.avail_in===0&&Y(Q)<=Y(b)&&Q!==E)return we(h,-5);if(o.status===666&&h.avail_in!==0)return we(h,-5);if(h.avail_in!==0||o.lookahead!==0||Q!==_&&o.status!==666){var K=o.strategy===2?function(L,ue){for(var ve;;){if(L.lookahead===0&&(z(L),L.lookahead===0)){if(ue===_)return A;break}if(L.match_length=0,ve=n._tr_tally(L,0,L.window[L.strstart]),L.lookahead--,L.strstart++,ve&&(D(L,!1),L.strm.avail_out===0))return A}return L.insert=0,ue===E?(D(L,!0),L.strm.avail_out===0?oe:G):L.last_lit&&(D(L,!1),L.strm.avail_out===0)?A:j}(o,Q):o.strategy===3?function(L,ue){for(var ve,ae,Ee,ke,Ne=L.window;;){if(L.lookahead<=ce){if(z(L),L.lookahead<=ce&&ue===_)return A;if(L.lookahead===0)break}if(L.match_length=0,L.lookahead>=R&&0<L.strstart&&(ae=Ne[Ee=L.strstart-1])===Ne[++Ee]&&ae===Ne[++Ee]&&ae===Ne[++Ee]){ke=L.strstart+ce;do;while(ae===Ne[++Ee]&&ae===Ne[++Ee]&&ae===Ne[++Ee]&&ae===Ne[++Ee]&&ae===Ne[++Ee]&&ae===Ne[++Ee]&&ae===Ne[++Ee]&&ae===Ne[++Ee]&&Ee<ke);L.match_length=ce-(ke-Ee),L.match_length>L.lookahead&&(L.match_length=L.lookahead)}if(L.match_length>=R?(ve=n._tr_tally(L,1,L.match_length-R),L.lookahead-=L.match_length,L.strstart+=L.match_length,L.match_length=0):(ve=n._tr_tally(L,0,L.window[L.strstart]),L.lookahead--,L.strstart++),ve&&(D(L,!1),L.strm.avail_out===0))return A}return L.insert=0,ue===E?(D(L,!0),L.strm.avail_out===0?oe:G):L.last_lit&&(D(L,!1),L.strm.avail_out===0)?A:j}(o,Q):i[o.level].func(o,Q);if(K!==oe&&K!==G||(o.status=666),K===A||K===oe)return h.avail_out===0&&(o.last_flush=-1),p;if(K===j&&(Q===1?n._tr_align(o):Q!==5&&(n._tr_stored_block(o,0,0,!1),Q===3&&(te(o.head),o.lookahead===0&&(o.strstart=0,o.block_start=0,o.insert=0))),M(h),h.avail_out===0))return o.last_flush=-1,p}return Q!==E?p:o.wrap<=0?1:(o.wrap===2?(q(o,255&h.adler),q(o,h.adler>>8&255),q(o,h.adler>>16&255),q(o,h.adler>>24&255),q(o,255&h.total_in),q(o,h.total_in>>8&255),q(o,h.total_in>>16&255),q(o,h.total_in>>24&255)):(X(o,h.adler>>>16),X(o,65535&h.adler)),M(h),0<o.wrap&&(o.wrap=-o.wrap),o.pending!==0?p:1)},l.deflateEnd=function(h){var Q;return h&&h.state?(Q=h.state.status)!==I&&Q!==69&&Q!==73&&Q!==91&&Q!==103&&Q!==V&&Q!==666?we(h,T):(h.state=null,Q===V?we(h,-3):p):T},l.deflateSetDictionary=function(h,Q){var b,o,s,d,F,K,L,ue,ve=Q.length;if(!h||!h.state||(d=(b=h.state).wrap)===2||d===1&&b.status!==I||b.lookahead)return T;for(d===1&&(h.adler=u(h.adler,Q,ve,0)),b.wrap=0,ve>=b.w_size&&(d===0&&(te(b.head),b.strstart=0,b.block_start=0,b.insert=0),ue=new c.Buf8(b.w_size),c.arraySet(ue,Q,ve-b.w_size,b.w_size,0),Q=ue,ve=b.w_size),F=h.avail_in,K=h.next_in,L=h.input,h.avail_in=ve,h.next_in=0,h.input=Q,z(b);b.lookahead>=R;){for(o=b.strstart,s=b.lookahead-(R-1);b.ins_h=(b.ins_h<<b.hash_shift^b.window[o+R-1])&b.hash_mask,b.prev[o&b.w_mask]=b.head[b.ins_h],b.head[b.ins_h]=o,o++,--s;);b.strstart=o,b.lookahead=R-1,z(b)}return b.strstart+=b.lookahead,b.block_start=b.strstart,b.insert=b.lookahead,b.lookahead=0,b.match_length=b.prev_length=R-1,b.match_available=0,h.next_in=K,h.input=L,h.avail_in=F,b.wrap=d,p},l.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,a,l){a.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,a,l){a.exports=function(i,c){var n,u,w,y,_,E,p,T,m,S,f,x,k,N,C,H,$,Z,R,ce,ge,I,V,A,j;n=i.state,u=i.next_in,A=i.input,w=u+(i.avail_in-5),y=i.next_out,j=i.output,_=y-(c-i.avail_out),E=y+(i.avail_out-257),p=n.dmax,T=n.wsize,m=n.whave,S=n.wnext,f=n.window,x=n.hold,k=n.bits,N=n.lencode,C=n.distcode,H=(1<<n.lenbits)-1,$=(1<<n.distbits)-1;e:do{k<15&&(x+=A[u++]<<k,k+=8,x+=A[u++]<<k,k+=8),Z=N[x&H];t:for(;;){if(x>>>=R=Z>>>24,k-=R,(R=Z>>>16&255)===0)j[y++]=65535&Z;else{if(!(16&R)){if(!(64&R)){Z=N[(65535&Z)+(x&(1<<R)-1)];continue t}if(32&R){n.mode=12;break e}i.msg="invalid literal/length code",n.mode=30;break e}ce=65535&Z,(R&=15)&&(k<R&&(x+=A[u++]<<k,k+=8),ce+=x&(1<<R)-1,x>>>=R,k-=R),k<15&&(x+=A[u++]<<k,k+=8,x+=A[u++]<<k,k+=8),Z=C[x&$];r:for(;;){if(x>>>=R=Z>>>24,k-=R,!(16&(R=Z>>>16&255))){if(!(64&R)){Z=C[(65535&Z)+(x&(1<<R)-1)];continue r}i.msg="invalid distance code",n.mode=30;break e}if(ge=65535&Z,k<(R&=15)&&(x+=A[u++]<<k,(k+=8)<R&&(x+=A[u++]<<k,k+=8)),p<(ge+=x&(1<<R)-1)){i.msg="invalid distance too far back",n.mode=30;break e}if(x>>>=R,k-=R,(R=y-_)<ge){if(m<(R=ge-R)&&n.sane){i.msg="invalid distance too far back",n.mode=30;break e}if(V=f,(I=0)===S){if(I+=T-R,R<ce){for(ce-=R;j[y++]=f[I++],--R;);I=y-ge,V=j}}else if(S<R){if(I+=T+S-R,(R-=S)<ce){for(ce-=R;j[y++]=f[I++],--R;);if(I=0,S<ce){for(ce-=R=S;j[y++]=f[I++],--R;);I=y-ge,V=j}}}else if(I+=S-R,R<ce){for(ce-=R;j[y++]=f[I++],--R;);I=y-ge,V=j}for(;2<ce;)j[y++]=V[I++],j[y++]=V[I++],j[y++]=V[I++],ce-=3;ce&&(j[y++]=V[I++],1<ce&&(j[y++]=V[I++]))}else{for(I=y-ge;j[y++]=j[I++],j[y++]=j[I++],j[y++]=j[I++],2<(ce-=3););ce&&(j[y++]=j[I++],1<ce&&(j[y++]=j[I++]))}break}}break}}while(u<w&&y<E);u-=ce=k>>3,x&=(1<<(k-=ce<<3))-1,i.next_in=u,i.next_out=y,i.avail_in=u<w?w-u+5:5-(u-w),i.avail_out=y<E?E-y+257:257-(y-E),n.hold=x,n.bits=k}},{}],49:[function(t,a,l){var i=t("../utils/common"),c=t("./adler32"),n=t("./crc32"),u=t("./inffast"),w=t("./inftrees"),y=1,_=2,E=0,p=-2,T=1,m=852,S=592;function f(I){return(I>>>24&255)+(I>>>8&65280)+((65280&I)<<8)+((255&I)<<24)}function x(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function k(I){var V;return I&&I.state?(V=I.state,I.total_in=I.total_out=V.total=0,I.msg="",V.wrap&&(I.adler=1&V.wrap),V.mode=T,V.last=0,V.havedict=0,V.dmax=32768,V.head=null,V.hold=0,V.bits=0,V.lencode=V.lendyn=new i.Buf32(m),V.distcode=V.distdyn=new i.Buf32(S),V.sane=1,V.back=-1,E):p}function N(I){var V;return I&&I.state?((V=I.state).wsize=0,V.whave=0,V.wnext=0,k(I)):p}function C(I,V){var A,j;return I&&I.state?(j=I.state,V<0?(A=0,V=-V):(A=1+(V>>4),V<48&&(V&=15)),V&&(V<8||15<V)?p:(j.window!==null&&j.wbits!==V&&(j.window=null),j.wrap=A,j.wbits=V,N(I))):p}function H(I,V){var A,j;return I?(j=new x,(I.state=j).window=null,(A=C(I,V))!==E&&(I.state=null),A):p}var $,Z,R=!0;function ce(I){if(R){var V;for($=new i.Buf32(512),Z=new i.Buf32(32),V=0;V<144;)I.lens[V++]=8;for(;V<256;)I.lens[V++]=9;for(;V<280;)I.lens[V++]=7;for(;V<288;)I.lens[V++]=8;for(w(y,I.lens,0,288,$,0,I.work,{bits:9}),V=0;V<32;)I.lens[V++]=5;w(_,I.lens,0,32,Z,0,I.work,{bits:5}),R=!1}I.lencode=$,I.lenbits=9,I.distcode=Z,I.distbits=5}function ge(I,V,A,j){var oe,G=I.state;return G.window===null&&(G.wsize=1<<G.wbits,G.wnext=0,G.whave=0,G.window=new i.Buf8(G.wsize)),j>=G.wsize?(i.arraySet(G.window,V,A-G.wsize,G.wsize,0),G.wnext=0,G.whave=G.wsize):(j<(oe=G.wsize-G.wnext)&&(oe=j),i.arraySet(G.window,V,A-j,oe,G.wnext),(j-=oe)?(i.arraySet(G.window,V,A-j,j,0),G.wnext=j,G.whave=G.wsize):(G.wnext+=oe,G.wnext===G.wsize&&(G.wnext=0),G.whave<G.wsize&&(G.whave+=oe))),0}l.inflateReset=N,l.inflateReset2=C,l.inflateResetKeep=k,l.inflateInit=function(I){return H(I,15)},l.inflateInit2=H,l.inflate=function(I,V){var A,j,oe,G,we,Y,te,M,D,q,X,ie,z,v,g,U,P,O,B,se,h,Q,b,o,s=0,d=new i.Buf8(4),F=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!I||!I.state||!I.output||!I.input&&I.avail_in!==0)return p;(A=I.state).mode===12&&(A.mode=13),we=I.next_out,oe=I.output,te=I.avail_out,G=I.next_in,j=I.input,Y=I.avail_in,M=A.hold,D=A.bits,q=Y,X=te,Q=E;e:for(;;)switch(A.mode){case T:if(A.wrap===0){A.mode=13;break}for(;D<16;){if(Y===0)break e;Y--,M+=j[G++]<<D,D+=8}if(2&A.wrap&&M===35615){d[A.check=0]=255&M,d[1]=M>>>8&255,A.check=n(A.check,d,2,0),D=M=0,A.mode=2;break}if(A.flags=0,A.head&&(A.head.done=!1),!(1&A.wrap)||(((255&M)<<8)+(M>>8))%31){I.msg="incorrect header check",A.mode=30;break}if((15&M)!=8){I.msg="unknown compression method",A.mode=30;break}if(D-=4,h=8+(15&(M>>>=4)),A.wbits===0)A.wbits=h;else if(h>A.wbits){I.msg="invalid window size",A.mode=30;break}A.dmax=1<<h,I.adler=A.check=1,A.mode=512&M?10:12,D=M=0;break;case 2:for(;D<16;){if(Y===0)break e;Y--,M+=j[G++]<<D,D+=8}if(A.flags=M,(255&A.flags)!=8){I.msg="unknown compression method",A.mode=30;break}if(57344&A.flags){I.msg="unknown header flags set",A.mode=30;break}A.head&&(A.head.text=M>>8&1),512&A.flags&&(d[0]=255&M,d[1]=M>>>8&255,A.check=n(A.check,d,2,0)),D=M=0,A.mode=3;case 3:for(;D<32;){if(Y===0)break e;Y--,M+=j[G++]<<D,D+=8}A.head&&(A.head.time=M),512&A.flags&&(d[0]=255&M,d[1]=M>>>8&255,d[2]=M>>>16&255,d[3]=M>>>24&255,A.check=n(A.check,d,4,0)),D=M=0,A.mode=4;case 4:for(;D<16;){if(Y===0)break e;Y--,M+=j[G++]<<D,D+=8}A.head&&(A.head.xflags=255&M,A.head.os=M>>8),512&A.flags&&(d[0]=255&M,d[1]=M>>>8&255,A.check=n(A.check,d,2,0)),D=M=0,A.mode=5;case 5:if(1024&A.flags){for(;D<16;){if(Y===0)break e;Y--,M+=j[G++]<<D,D+=8}A.length=M,A.head&&(A.head.extra_len=M),512&A.flags&&(d[0]=255&M,d[1]=M>>>8&255,A.check=n(A.check,d,2,0)),D=M=0}else A.head&&(A.head.extra=null);A.mode=6;case 6:if(1024&A.flags&&(Y<(ie=A.length)&&(ie=Y),ie&&(A.head&&(h=A.head.extra_len-A.length,A.head.extra||(A.head.extra=new Array(A.head.extra_len)),i.arraySet(A.head.extra,j,G,ie,h)),512&A.flags&&(A.check=n(A.check,j,ie,G)),Y-=ie,G+=ie,A.length-=ie),A.length))break e;A.length=0,A.mode=7;case 7:if(2048&A.flags){if(Y===0)break e;for(ie=0;h=j[G+ie++],A.head&&h&&A.length<65536&&(A.head.name+=String.fromCharCode(h)),h&&ie<Y;);if(512&A.flags&&(A.check=n(A.check,j,ie,G)),Y-=ie,G+=ie,h)break e}else A.head&&(A.head.name=null);A.length=0,A.mode=8;case 8:if(4096&A.flags){if(Y===0)break e;for(ie=0;h=j[G+ie++],A.head&&h&&A.length<65536&&(A.head.comment+=String.fromCharCode(h)),h&&ie<Y;);if(512&A.flags&&(A.check=n(A.check,j,ie,G)),Y-=ie,G+=ie,h)break e}else A.head&&(A.head.comment=null);A.mode=9;case 9:if(512&A.flags){for(;D<16;){if(Y===0)break e;Y--,M+=j[G++]<<D,D+=8}if(M!==(65535&A.check)){I.msg="header crc mismatch",A.mode=30;break}D=M=0}A.head&&(A.head.hcrc=A.flags>>9&1,A.head.done=!0),I.adler=A.check=0,A.mode=12;break;case 10:for(;D<32;){if(Y===0)break e;Y--,M+=j[G++]<<D,D+=8}I.adler=A.check=f(M),D=M=0,A.mode=11;case 11:if(A.havedict===0)return I.next_out=we,I.avail_out=te,I.next_in=G,I.avail_in=Y,A.hold=M,A.bits=D,2;I.adler=A.check=1,A.mode=12;case 12:if(V===5||V===6)break e;case 13:if(A.last){M>>>=7&D,D-=7&D,A.mode=27;break}for(;D<3;){if(Y===0)break e;Y--,M+=j[G++]<<D,D+=8}switch(A.last=1&M,D-=1,3&(M>>>=1)){case 0:A.mode=14;break;case 1:if(ce(A),A.mode=20,V!==6)break;M>>>=2,D-=2;break e;case 2:A.mode=17;break;case 3:I.msg="invalid block type",A.mode=30}M>>>=2,D-=2;break;case 14:for(M>>>=7&D,D-=7&D;D<32;){if(Y===0)break e;Y--,M+=j[G++]<<D,D+=8}if((65535&M)!=(M>>>16^65535)){I.msg="invalid stored block lengths",A.mode=30;break}if(A.length=65535&M,D=M=0,A.mode=15,V===6)break e;case 15:A.mode=16;case 16:if(ie=A.length){if(Y<ie&&(ie=Y),te<ie&&(ie=te),ie===0)break e;i.arraySet(oe,j,G,ie,we),Y-=ie,G+=ie,te-=ie,we+=ie,A.length-=ie;break}A.mode=12;break;case 17:for(;D<14;){if(Y===0)break e;Y--,M+=j[G++]<<D,D+=8}if(A.nlen=257+(31&M),M>>>=5,D-=5,A.ndist=1+(31&M),M>>>=5,D-=5,A.ncode=4+(15&M),M>>>=4,D-=4,286<A.nlen||30<A.ndist){I.msg="too many length or distance symbols",A.mode=30;break}A.have=0,A.mode=18;case 18:for(;A.have<A.ncode;){for(;D<3;){if(Y===0)break e;Y--,M+=j[G++]<<D,D+=8}A.lens[F[A.have++]]=7&M,M>>>=3,D-=3}for(;A.have<19;)A.lens[F[A.have++]]=0;if(A.lencode=A.lendyn,A.lenbits=7,b={bits:A.lenbits},Q=w(0,A.lens,0,19,A.lencode,0,A.work,b),A.lenbits=b.bits,Q){I.msg="invalid code lengths set",A.mode=30;break}A.have=0,A.mode=19;case 19:for(;A.have<A.nlen+A.ndist;){for(;U=(s=A.lencode[M&(1<<A.lenbits)-1])>>>16&255,P=65535&s,!((g=s>>>24)<=D);){if(Y===0)break e;Y--,M+=j[G++]<<D,D+=8}if(P<16)M>>>=g,D-=g,A.lens[A.have++]=P;else{if(P===16){for(o=g+2;D<o;){if(Y===0)break e;Y--,M+=j[G++]<<D,D+=8}if(M>>>=g,D-=g,A.have===0){I.msg="invalid bit length repeat",A.mode=30;break}h=A.lens[A.have-1],ie=3+(3&M),M>>>=2,D-=2}else if(P===17){for(o=g+3;D<o;){if(Y===0)break e;Y--,M+=j[G++]<<D,D+=8}D-=g,h=0,ie=3+(7&(M>>>=g)),M>>>=3,D-=3}else{for(o=g+7;D<o;){if(Y===0)break e;Y--,M+=j[G++]<<D,D+=8}D-=g,h=0,ie=11+(127&(M>>>=g)),M>>>=7,D-=7}if(A.have+ie>A.nlen+A.ndist){I.msg="invalid bit length repeat",A.mode=30;break}for(;ie--;)A.lens[A.have++]=h}}if(A.mode===30)break;if(A.lens[256]===0){I.msg="invalid code -- missing end-of-block",A.mode=30;break}if(A.lenbits=9,b={bits:A.lenbits},Q=w(y,A.lens,0,A.nlen,A.lencode,0,A.work,b),A.lenbits=b.bits,Q){I.msg="invalid literal/lengths set",A.mode=30;break}if(A.distbits=6,A.distcode=A.distdyn,b={bits:A.distbits},Q=w(_,A.lens,A.nlen,A.ndist,A.distcode,0,A.work,b),A.distbits=b.bits,Q){I.msg="invalid distances set",A.mode=30;break}if(A.mode=20,V===6)break e;case 20:A.mode=21;case 21:if(6<=Y&&258<=te){I.next_out=we,I.avail_out=te,I.next_in=G,I.avail_in=Y,A.hold=M,A.bits=D,u(I,X),we=I.next_out,oe=I.output,te=I.avail_out,G=I.next_in,j=I.input,Y=I.avail_in,M=A.hold,D=A.bits,A.mode===12&&(A.back=-1);break}for(A.back=0;U=(s=A.lencode[M&(1<<A.lenbits)-1])>>>16&255,P=65535&s,!((g=s>>>24)<=D);){if(Y===0)break e;Y--,M+=j[G++]<<D,D+=8}if(U&&!(240&U)){for(O=g,B=U,se=P;U=(s=A.lencode[se+((M&(1<<O+B)-1)>>O)])>>>16&255,P=65535&s,!(O+(g=s>>>24)<=D);){if(Y===0)break e;Y--,M+=j[G++]<<D,D+=8}M>>>=O,D-=O,A.back+=O}if(M>>>=g,D-=g,A.back+=g,A.length=P,U===0){A.mode=26;break}if(32&U){A.back=-1,A.mode=12;break}if(64&U){I.msg="invalid literal/length code",A.mode=30;break}A.extra=15&U,A.mode=22;case 22:if(A.extra){for(o=A.extra;D<o;){if(Y===0)break e;Y--,M+=j[G++]<<D,D+=8}A.length+=M&(1<<A.extra)-1,M>>>=A.extra,D-=A.extra,A.back+=A.extra}A.was=A.length,A.mode=23;case 23:for(;U=(s=A.distcode[M&(1<<A.distbits)-1])>>>16&255,P=65535&s,!((g=s>>>24)<=D);){if(Y===0)break e;Y--,M+=j[G++]<<D,D+=8}if(!(240&U)){for(O=g,B=U,se=P;U=(s=A.distcode[se+((M&(1<<O+B)-1)>>O)])>>>16&255,P=65535&s,!(O+(g=s>>>24)<=D);){if(Y===0)break e;Y--,M+=j[G++]<<D,D+=8}M>>>=O,D-=O,A.back+=O}if(M>>>=g,D-=g,A.back+=g,64&U){I.msg="invalid distance code",A.mode=30;break}A.offset=P,A.extra=15&U,A.mode=24;case 24:if(A.extra){for(o=A.extra;D<o;){if(Y===0)break e;Y--,M+=j[G++]<<D,D+=8}A.offset+=M&(1<<A.extra)-1,M>>>=A.extra,D-=A.extra,A.back+=A.extra}if(A.offset>A.dmax){I.msg="invalid distance too far back",A.mode=30;break}A.mode=25;case 25:if(te===0)break e;if(ie=X-te,A.offset>ie){if((ie=A.offset-ie)>A.whave&&A.sane){I.msg="invalid distance too far back",A.mode=30;break}z=ie>A.wnext?(ie-=A.wnext,A.wsize-ie):A.wnext-ie,ie>A.length&&(ie=A.length),v=A.window}else v=oe,z=we-A.offset,ie=A.length;for(te<ie&&(ie=te),te-=ie,A.length-=ie;oe[we++]=v[z++],--ie;);A.length===0&&(A.mode=21);break;case 26:if(te===0)break e;oe[we++]=A.length,te--,A.mode=21;break;case 27:if(A.wrap){for(;D<32;){if(Y===0)break e;Y--,M|=j[G++]<<D,D+=8}if(X-=te,I.total_out+=X,A.total+=X,X&&(I.adler=A.check=A.flags?n(A.check,oe,X,we-X):c(A.check,oe,X,we-X)),X=te,(A.flags?M:f(M))!==A.check){I.msg="incorrect data check",A.mode=30;break}D=M=0}A.mode=28;case 28:if(A.wrap&&A.flags){for(;D<32;){if(Y===0)break e;Y--,M+=j[G++]<<D,D+=8}if(M!==(4294967295&A.total)){I.msg="incorrect length check",A.mode=30;break}D=M=0}A.mode=29;case 29:Q=1;break e;case 30:Q=-3;break e;case 31:return-4;case 32:default:return p}return I.next_out=we,I.avail_out=te,I.next_in=G,I.avail_in=Y,A.hold=M,A.bits=D,(A.wsize||X!==I.avail_out&&A.mode<30&&(A.mode<27||V!==4))&&ge(I,I.output,I.next_out,X-I.avail_out)?(A.mode=31,-4):(q-=I.avail_in,X-=I.avail_out,I.total_in+=q,I.total_out+=X,A.total+=X,A.wrap&&X&&(I.adler=A.check=A.flags?n(A.check,oe,X,I.next_out-X):c(A.check,oe,X,I.next_out-X)),I.data_type=A.bits+(A.last?64:0)+(A.mode===12?128:0)+(A.mode===20||A.mode===15?256:0),(q==0&&X===0||V===4)&&Q===E&&(Q=-5),Q)},l.inflateEnd=function(I){if(!I||!I.state)return p;var V=I.state;return V.window&&(V.window=null),I.state=null,E},l.inflateGetHeader=function(I,V){var A;return I&&I.state&&2&(A=I.state).wrap?((A.head=V).done=!1,E):p},l.inflateSetDictionary=function(I,V){var A,j=V.length;return I&&I.state?(A=I.state).wrap!==0&&A.mode!==11?p:A.mode===11&&c(1,V,j,0)!==A.check?-3:ge(I,V,j,j)?(A.mode=31,-4):(A.havedict=1,E):p},l.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,a,l){var i=t("../utils/common"),c=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],n=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],u=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],w=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];a.exports=function(y,_,E,p,T,m,S,f){var x,k,N,C,H,$,Z,R,ce,ge=f.bits,I=0,V=0,A=0,j=0,oe=0,G=0,we=0,Y=0,te=0,M=0,D=null,q=0,X=new i.Buf16(16),ie=new i.Buf16(16),z=null,v=0;for(I=0;I<=15;I++)X[I]=0;for(V=0;V<p;V++)X[_[E+V]]++;for(oe=ge,j=15;1<=j&&X[j]===0;j--);if(j<oe&&(oe=j),j===0)return T[m++]=20971520,T[m++]=20971520,f.bits=1,0;for(A=1;A<j&&X[A]===0;A++);for(oe<A&&(oe=A),I=Y=1;I<=15;I++)if(Y<<=1,(Y-=X[I])<0)return-1;if(0<Y&&(y===0||j!==1))return-1;for(ie[1]=0,I=1;I<15;I++)ie[I+1]=ie[I]+X[I];for(V=0;V<p;V++)_[E+V]!==0&&(S[ie[_[E+V]]++]=V);if($=y===0?(D=z=S,19):y===1?(D=c,q-=257,z=n,v-=257,256):(D=u,z=w,-1),I=A,H=m,we=V=M=0,N=-1,C=(te=1<<(G=oe))-1,y===1&&852<te||y===2&&592<te)return 1;for(;;){for(Z=I-we,ce=S[V]<$?(R=0,S[V]):S[V]>$?(R=z[v+S[V]],D[q+S[V]]):(R=96,0),x=1<<I-we,A=k=1<<G;T[H+(M>>we)+(k-=x)]=Z<<24|R<<16|ce|0,k!==0;);for(x=1<<I-1;M&x;)x>>=1;if(x!==0?(M&=x-1,M+=x):M=0,V++,--X[I]==0){if(I===j)break;I=_[E+S[V]]}if(oe<I&&(M&C)!==N){for(we===0&&(we=oe),H+=A,Y=1<<(G=I-we);G+we<j&&!((Y-=X[G+we])<=0);)G++,Y<<=1;if(te+=1<<G,y===1&&852<te||y===2&&592<te)return 1;T[N=M&C]=oe<<24|G<<16|H-m|0}}return M!==0&&(T[H+M]=I-we<<24|64<<16|0),f.bits=oe,0}},{"../utils/common":41}],51:[function(t,a,l){a.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,a,l){var i=t("../utils/common"),c=0,n=1;function u(s){for(var d=s.length;0<=--d;)s[d]=0}var w=0,y=29,_=256,E=_+1+y,p=30,T=19,m=2*E+1,S=15,f=16,x=7,k=256,N=16,C=17,H=18,$=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Z=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],R=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],ce=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ge=new Array(2*(E+2));u(ge);var I=new Array(2*p);u(I);var V=new Array(512);u(V);var A=new Array(256);u(A);var j=new Array(y);u(j);var oe,G,we,Y=new Array(p);function te(s,d,F,K,L){this.static_tree=s,this.extra_bits=d,this.extra_base=F,this.elems=K,this.max_length=L,this.has_stree=s&&s.length}function M(s,d){this.dyn_tree=s,this.max_code=0,this.stat_desc=d}function D(s){return s<256?V[s]:V[256+(s>>>7)]}function q(s,d){s.pending_buf[s.pending++]=255&d,s.pending_buf[s.pending++]=d>>>8&255}function X(s,d,F){s.bi_valid>f-F?(s.bi_buf|=d<<s.bi_valid&65535,q(s,s.bi_buf),s.bi_buf=d>>f-s.bi_valid,s.bi_valid+=F-f):(s.bi_buf|=d<<s.bi_valid&65535,s.bi_valid+=F)}function ie(s,d,F){X(s,F[2*d],F[2*d+1])}function z(s,d){for(var F=0;F|=1&s,s>>>=1,F<<=1,0<--d;);return F>>>1}function v(s,d,F){var K,L,ue=new Array(S+1),ve=0;for(K=1;K<=S;K++)ue[K]=ve=ve+F[K-1]<<1;for(L=0;L<=d;L++){var ae=s[2*L+1];ae!==0&&(s[2*L]=z(ue[ae]++,ae))}}function g(s){var d;for(d=0;d<E;d++)s.dyn_ltree[2*d]=0;for(d=0;d<p;d++)s.dyn_dtree[2*d]=0;for(d=0;d<T;d++)s.bl_tree[2*d]=0;s.dyn_ltree[2*k]=1,s.opt_len=s.static_len=0,s.last_lit=s.matches=0}function U(s){8<s.bi_valid?q(s,s.bi_buf):0<s.bi_valid&&(s.pending_buf[s.pending++]=s.bi_buf),s.bi_buf=0,s.bi_valid=0}function P(s,d,F,K){var L=2*d,ue=2*F;return s[L]<s[ue]||s[L]===s[ue]&&K[d]<=K[F]}function O(s,d,F){for(var K=s.heap[F],L=F<<1;L<=s.heap_len&&(L<s.heap_len&&P(d,s.heap[L+1],s.heap[L],s.depth)&&L++,!P(d,K,s.heap[L],s.depth));)s.heap[F]=s.heap[L],F=L,L<<=1;s.heap[F]=K}function B(s,d,F){var K,L,ue,ve,ae=0;if(s.last_lit!==0)for(;K=s.pending_buf[s.d_buf+2*ae]<<8|s.pending_buf[s.d_buf+2*ae+1],L=s.pending_buf[s.l_buf+ae],ae++,K===0?ie(s,L,d):(ie(s,(ue=A[L])+_+1,d),(ve=$[ue])!==0&&X(s,L-=j[ue],ve),ie(s,ue=D(--K),F),(ve=Z[ue])!==0&&X(s,K-=Y[ue],ve)),ae<s.last_lit;);ie(s,k,d)}function se(s,d){var F,K,L,ue=d.dyn_tree,ve=d.stat_desc.static_tree,ae=d.stat_desc.has_stree,Ee=d.stat_desc.elems,ke=-1;for(s.heap_len=0,s.heap_max=m,F=0;F<Ee;F++)ue[2*F]!==0?(s.heap[++s.heap_len]=ke=F,s.depth[F]=0):ue[2*F+1]=0;for(;s.heap_len<2;)ue[2*(L=s.heap[++s.heap_len]=ke<2?++ke:0)]=1,s.depth[L]=0,s.opt_len--,ae&&(s.static_len-=ve[2*L+1]);for(d.max_code=ke,F=s.heap_len>>1;1<=F;F--)O(s,ue,F);for(L=Ee;F=s.heap[1],s.heap[1]=s.heap[s.heap_len--],O(s,ue,1),K=s.heap[1],s.heap[--s.heap_max]=F,s.heap[--s.heap_max]=K,ue[2*L]=ue[2*F]+ue[2*K],s.depth[L]=(s.depth[F]>=s.depth[K]?s.depth[F]:s.depth[K])+1,ue[2*F+1]=ue[2*K+1]=L,s.heap[1]=L++,O(s,ue,1),2<=s.heap_len;);s.heap[--s.heap_max]=s.heap[1],function(Ne,ot){var mt,ft,_t,$e,xt,gr,W=ot.dyn_tree,re=ot.max_code,fe=ot.stat_desc.static_tree,be=ot.stat_desc.has_stree,Te=ot.stat_desc.extra_bits,xe=ot.stat_desc.extra_base,Ce=ot.stat_desc.max_length,Re=0;for($e=0;$e<=S;$e++)Ne.bl_count[$e]=0;for(W[2*Ne.heap[Ne.heap_max]+1]=0,mt=Ne.heap_max+1;mt<m;mt++)Ce<($e=W[2*W[2*(ft=Ne.heap[mt])+1]+1]+1)&&($e=Ce,Re++),W[2*ft+1]=$e,re<ft||(Ne.bl_count[$e]++,xt=0,xe<=ft&&(xt=Te[ft-xe]),gr=W[2*ft],Ne.opt_len+=gr*($e+xt),be&&(Ne.static_len+=gr*(fe[2*ft+1]+xt)));if(Re!==0){do{for($e=Ce-1;Ne.bl_count[$e]===0;)$e--;Ne.bl_count[$e]--,Ne.bl_count[$e+1]+=2,Ne.bl_count[Ce]--,Re-=2}while(0<Re);for($e=Ce;$e!==0;$e--)for(ft=Ne.bl_count[$e];ft!==0;)re<(_t=Ne.heap[--mt])||(W[2*_t+1]!==$e&&(Ne.opt_len+=($e-W[2*_t+1])*W[2*_t],W[2*_t+1]=$e),ft--)}}(s,d),v(ue,ke,s.bl_count)}function h(s,d,F){var K,L,ue=-1,ve=d[1],ae=0,Ee=7,ke=4;for(ve===0&&(Ee=138,ke=3),d[2*(F+1)+1]=65535,K=0;K<=F;K++)L=ve,ve=d[2*(K+1)+1],++ae<Ee&&L===ve||(ae<ke?s.bl_tree[2*L]+=ae:L!==0?(L!==ue&&s.bl_tree[2*L]++,s.bl_tree[2*N]++):ae<=10?s.bl_tree[2*C]++:s.bl_tree[2*H]++,ue=L,ke=(ae=0)===ve?(Ee=138,3):L===ve?(Ee=6,3):(Ee=7,4))}function Q(s,d,F){var K,L,ue=-1,ve=d[1],ae=0,Ee=7,ke=4;for(ve===0&&(Ee=138,ke=3),K=0;K<=F;K++)if(L=ve,ve=d[2*(K+1)+1],!(++ae<Ee&&L===ve)){if(ae<ke)for(;ie(s,L,s.bl_tree),--ae!=0;);else L!==0?(L!==ue&&(ie(s,L,s.bl_tree),ae--),ie(s,N,s.bl_tree),X(s,ae-3,2)):ae<=10?(ie(s,C,s.bl_tree),X(s,ae-3,3)):(ie(s,H,s.bl_tree),X(s,ae-11,7));ue=L,ke=(ae=0)===ve?(Ee=138,3):L===ve?(Ee=6,3):(Ee=7,4)}}u(Y);var b=!1;function o(s,d,F,K){X(s,(w<<1)+(K?1:0),3),function(L,ue,ve,ae){U(L),q(L,ve),q(L,~ve),i.arraySet(L.pending_buf,L.window,ue,ve,L.pending),L.pending+=ve}(s,d,F)}l._tr_init=function(s){b||(function(){var d,F,K,L,ue,ve=new Array(S+1);for(L=K=0;L<y-1;L++)for(j[L]=K,d=0;d<1<<$[L];d++)A[K++]=L;for(A[K-1]=L,L=ue=0;L<16;L++)for(Y[L]=ue,d=0;d<1<<Z[L];d++)V[ue++]=L;for(ue>>=7;L<p;L++)for(Y[L]=ue<<7,d=0;d<1<<Z[L]-7;d++)V[256+ue++]=L;for(F=0;F<=S;F++)ve[F]=0;for(d=0;d<=143;)ge[2*d+1]=8,d++,ve[8]++;for(;d<=255;)ge[2*d+1]=9,d++,ve[9]++;for(;d<=279;)ge[2*d+1]=7,d++,ve[7]++;for(;d<=287;)ge[2*d+1]=8,d++,ve[8]++;for(v(ge,E+1,ve),d=0;d<p;d++)I[2*d+1]=5,I[2*d]=z(d,5);oe=new te(ge,$,_+1,E,S),G=new te(I,Z,0,p,S),we=new te(new Array(0),R,0,T,x)}(),b=!0),s.l_desc=new M(s.dyn_ltree,oe),s.d_desc=new M(s.dyn_dtree,G),s.bl_desc=new M(s.bl_tree,we),s.bi_buf=0,s.bi_valid=0,g(s)},l._tr_stored_block=o,l._tr_flush_block=function(s,d,F,K){var L,ue,ve=0;0<s.level?(s.strm.data_type===2&&(s.strm.data_type=function(ae){var Ee,ke=4093624447;for(Ee=0;Ee<=31;Ee++,ke>>>=1)if(1&ke&&ae.dyn_ltree[2*Ee]!==0)return c;if(ae.dyn_ltree[18]!==0||ae.dyn_ltree[20]!==0||ae.dyn_ltree[26]!==0)return n;for(Ee=32;Ee<_;Ee++)if(ae.dyn_ltree[2*Ee]!==0)return n;return c}(s)),se(s,s.l_desc),se(s,s.d_desc),ve=function(ae){var Ee;for(h(ae,ae.dyn_ltree,ae.l_desc.max_code),h(ae,ae.dyn_dtree,ae.d_desc.max_code),se(ae,ae.bl_desc),Ee=T-1;3<=Ee&&ae.bl_tree[2*ce[Ee]+1]===0;Ee--);return ae.opt_len+=3*(Ee+1)+5+5+4,Ee}(s),L=s.opt_len+3+7>>>3,(ue=s.static_len+3+7>>>3)<=L&&(L=ue)):L=ue=F+5,F+4<=L&&d!==-1?o(s,d,F,K):s.strategy===4||ue===L?(X(s,2+(K?1:0),3),B(s,ge,I)):(X(s,4+(K?1:0),3),function(ae,Ee,ke,Ne){var ot;for(X(ae,Ee-257,5),X(ae,ke-1,5),X(ae,Ne-4,4),ot=0;ot<Ne;ot++)X(ae,ae.bl_tree[2*ce[ot]+1],3);Q(ae,ae.dyn_ltree,Ee-1),Q(ae,ae.dyn_dtree,ke-1)}(s,s.l_desc.max_code+1,s.d_desc.max_code+1,ve+1),B(s,s.dyn_ltree,s.dyn_dtree)),g(s),K&&U(s)},l._tr_tally=function(s,d,F){return s.pending_buf[s.d_buf+2*s.last_lit]=d>>>8&255,s.pending_buf[s.d_buf+2*s.last_lit+1]=255&d,s.pending_buf[s.l_buf+s.last_lit]=255&F,s.last_lit++,d===0?s.dyn_ltree[2*F]++:(s.matches++,d--,s.dyn_ltree[2*(A[F]+_+1)]++,s.dyn_dtree[2*D(d)]++),s.last_lit===s.lit_bufsize-1},l._tr_align=function(s){X(s,2,3),ie(s,k,ge),function(d){d.bi_valid===16?(q(d,d.bi_buf),d.bi_buf=0,d.bi_valid=0):8<=d.bi_valid&&(d.pending_buf[d.pending++]=255&d.bi_buf,d.bi_buf>>=8,d.bi_valid-=8)}(s)}},{"../utils/common":41}],53:[function(t,a,l){a.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,a,l){(function(i){(function(c,n){if(!c.setImmediate){var u,w,y,_,E=1,p={},T=!1,m=c.document,S=Object.getPrototypeOf&&Object.getPrototypeOf(c);S=S&&S.setTimeout?S:c,u={}.toString.call(c.process)==="[object process]"?function(N){Ue.nextTick(function(){x(N)})}:function(){if(c.postMessage&&!c.importScripts){var N=!0,C=c.onmessage;return c.onmessage=function(){N=!1},c.postMessage("","*"),c.onmessage=C,N}}()?(_="setImmediate$"+Math.random()+"$",c.addEventListener?c.addEventListener("message",k,!1):c.attachEvent("onmessage",k),function(N){c.postMessage(_+N,"*")}):c.MessageChannel?((y=new MessageChannel).port1.onmessage=function(N){x(N.data)},function(N){y.port2.postMessage(N)}):m&&"onreadystatechange"in m.createElement("script")?(w=m.documentElement,function(N){var C=m.createElement("script");C.onreadystatechange=function(){x(N),C.onreadystatechange=null,w.removeChild(C),C=null},w.appendChild(C)}):function(N){setTimeout(x,0,N)},S.setImmediate=function(N){typeof N!="function"&&(N=new Function(""+N));for(var C=new Array(arguments.length-1),H=0;H<C.length;H++)C[H]=arguments[H+1];var $={callback:N,args:C};return p[E]=$,u(E),E++},S.clearImmediate=f}function f(N){delete p[N]}function x(N){if(T)setTimeout(x,0,N);else{var C=p[N];if(C){T=!0;try{(function(H){var $=H.callback,Z=H.args;switch(Z.length){case 0:$();break;case 1:$(Z[0]);break;case 2:$(Z[0],Z[1]);break;case 3:$(Z[0],Z[1],Z[2]);break;default:$.apply(n,Z)}})(C)}finally{f(N),T=!1}}}}function k(N){N.source===c&&typeof N.data=="string"&&N.data.indexOf(_)===0&&x(+N.data.slice(_.length))}})(typeof self>"u"?i===void 0?this:i:self)}).call(this,typeof Rt<"u"?Rt:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(ia);var Vf=ia.exports;const Kf=ls(Vf);var Kr={exports:{}},Gf={"&":"&amp;",'"':"&quot;","'":"&apos;","<":"&lt;",">":"&gt;"};function qf(r){return r&&r.replace?r.replace(/([&"<>'])/g,function(e,t){return Gf[t]}):r}var Xf=qf,ci=Xf,jo=yi.Stream,Zf="    ";function Yf(r,e){typeof e!="object"&&(e={indent:e});var t=e.stream?new jo:null,a="",l=!1,i=e.indent?e.indent===!0?Zf:e.indent:"",c=!0;function n(E){c?Ue.nextTick(E):E()}function u(E,p){if(p!==void 0&&(a+=p),E&&!l&&(t=t||new jo,l=!0),E&&l){var T=a;n(function(){t.emit("data",T)}),a=""}}function w(E,p){Ri(u,Gr(E,i,i?1:0),p)}function y(){if(t){var E=a;n(function(){t.emit("data",E),t.emit("end"),t.readable=!1,t.emit("close")})}}function _(E){var p=E.encoding||"UTF-8",T={version:"1.0",encoding:p};E.standalone&&(T.standalone=E.standalone),w({"?xml":{_attr:T}}),a=a.replace("/>","?>")}return n(function(){c=!1}),e.declaration&&_(e.declaration),r&&r.forEach?r.forEach(function(E,p){var T;p+1===r.length&&(T=y),w(E,T)}):w(r,y),t?(t.readable=!0,t):a}function Jf(){var r=Array.prototype.slice.call(arguments),e={_elem:Gr(r)};return e.push=function(t){if(!this.append)throw new Error("not assigned to a parent!");var a=this,l=this._elem.indent;Ri(this.append,Gr(t,l,this._elem.icount+(l?1:0)),function(){a.append(!0)})},e.close=function(t){t!==void 0&&this.push(t),this.end&&this.end()},e}function Qf(r,e){return new Array(e||0).join(r||"")}function Gr(r,e,t){t=t||0;var a=Qf(e,t),l,i=r,c=!1;if(typeof r=="object"){var n=Object.keys(r);if(l=n[0],i=r[l],i&&i._elem)return i._elem.name=l,i._elem.icount=t,i._elem.indent=e,i._elem.indents=a,i._elem.interrupt=i,i._elem}var u=[],w=[],y;function _(E){var p=Object.keys(E);p.forEach(function(T){u.push(eh(T,E[T]))})}switch(typeof i){case"object":if(i===null)break;i._attr&&_(i._attr),i._cdata&&w.push(("<![CDATA["+i._cdata).replace(/\]\]>/g,"]]]]><![CDATA[>")+"]]>"),i.forEach&&(y=!1,w.push(""),i.forEach(function(E){if(typeof E=="object"){var p=Object.keys(E)[0];p=="_attr"?_(E._attr):w.push(Gr(E,e,t+1))}else w.pop(),y=!0,w.push(ci(E))}),y||w.push(""));break;default:w.push(ci(i))}return{name:l,interrupt:c,attributes:u,content:w,icount:t,indents:a,indent:e}}function Ri(r,e,t){if(typeof e!="object")return r(!1,e);var a=e.interrupt?1:e.content.length;function l(){for(;e.content.length;){var c=e.content.shift();if(c!==void 0){if(i(c))return;Ri(r,c)}}r(!1,(a>1?e.indents:"")+(e.name?"</"+e.name+">":"")+(e.indent&&!t?`
`:"")),t&&t()}function i(c){return c.interrupt?(c.interrupt.append=r,c.interrupt.end=l,c.interrupt=!1,r(!0),!0):!1}if(r(!1,e.indents+(e.name?"<"+e.name:"")+(e.attributes.length?" "+e.attributes.join(" "):"")+(a?e.name?">":"":e.name?"/>":"")+(e.indent&&a>1?`
`:"")),!a)return r(!1,e.indent?`
`:"");i(e)||l()}function eh(r,e){return r+'="'+ci(e)+'"'}Kr.exports=Yf;Kr.exports.element=Kr.exports.Element=Jf;var th=Kr.exports;const rt=ls(th),zo=0,Wo=32,rh=32,nh=(r,e)=>{const t=e.replace(/-/g,"");if(t.length!==rh)throw new Error(`Error: Cannot extract GUID from font filename: ${e}`);const l=t.replace(/(..)/g,"$1 ").trim().split(" ").map(u=>parseInt(u,16));l.reverse();const c=r.slice(zo,Wo).map((u,w)=>u^l[w%l.length]);return Buffer.concat([r.slice(0,zo),c,r.slice(Wo)])};class ih{format(e,t={stack:[]}){const a=e.prepForXml(t);if(a)return a;throw Error("XMLComponent did not format correctly")}}class oh{replace(e,t,a){let l=e;return t.forEach((i,c)=>{l=l.replace(new RegExp(`{${i.fileName}}`,"g"),(a+c).toString())}),l}getMediaData(e,t){return t.Array.filter(a=>e.search(`{${a.fileName}}`)>0)}}class sh{replace(e,t){let a=e;for(const l of t)a=a.replace(new RegExp(`{${l.reference}-${l.instance}}`,"g"),l.numId.toString());return a}}class ah{constructor(){me(this,"formatter"),me(this,"imageReplacer"),me(this,"numberingReplacer"),this.formatter=new ih,this.imageReplacer=new oh,this.numberingReplacer=new sh}compile(e,t){const a=new Kf,l=this.xmlifyFile(e,t),i=new Map(Object.entries(l));for(const[,c]of i)if(Array.isArray(c))for(const n of c)a.file(n.path,n.data);else a.file(c.path,c.data);for(const{stream:c,fileName:n}of e.Media.Array)a.file(`word/media/${n}`,c);for(const{data:c,name:n,fontKey:u}of e.FontTable.fontOptionsWithKey){const[w]=n.split(".");a.file(`word/fonts/${w}.odttf`,nh(c,u))}return a}xmlifyFile(e,t){const a=e.Document.Relationships.RelationshipCount+1,l=rt(this.formatter.format(e.Document.View,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),i=this.imageReplacer.getMediaData(l,e.Media);return{Relationships:{data:(i.forEach((c,n)=>{e.Document.Relationships.createRelationship(a+n,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${c.fileName}`)}),rt(this.formatter.format(e.Document.Relationships,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}})),path:"word/_rels/document.xml.rels"},Document:{data:(()=>{const c=this.imageReplacer.replace(l,i,a);return this.numberingReplacer.replace(c,e.Numbering.ConcreteNumbering)})(),path:"word/document.xml"},Styles:{data:(()=>{const c=rt(this.formatter.format(e.Styles,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}});return this.numberingReplacer.replace(c,e.Numbering.ConcreteNumbering)})(),path:"word/styles.xml"},Properties:{data:rt(this.formatter.format(e.CoreProperties,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/core.xml"},Numbering:{data:rt(this.formatter.format(e.Numbering,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/numbering.xml"},FileRelationships:{data:rt(this.formatter.format(e.FileRelationships,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),path:"_rels/.rels"},HeaderRelationships:e.Headers.map((c,n)=>{const u=rt(this.formatter.format(c.View,{viewWrapper:c,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}});return this.imageReplacer.getMediaData(u,e.Media).forEach((y,_)=>{c.Relationships.createRelationship(_,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${y.fileName}`)}),{data:rt(this.formatter.format(c.Relationships,{viewWrapper:c,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),path:`word/_rels/header${n+1}.xml.rels`}}),FooterRelationships:e.Footers.map((c,n)=>{const u=rt(this.formatter.format(c.View,{viewWrapper:c,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}});return this.imageReplacer.getMediaData(u,e.Media).forEach((y,_)=>{c.Relationships.createRelationship(_,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${y.fileName}`)}),{data:rt(this.formatter.format(c.Relationships,{viewWrapper:c,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),path:`word/_rels/footer${n+1}.xml.rels`}}),Headers:e.Headers.map((c,n)=>{const u=rt(this.formatter.format(c.View,{viewWrapper:c,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),w=this.imageReplacer.getMediaData(u,e.Media),y=this.imageReplacer.replace(u,w,0);return{data:this.numberingReplacer.replace(y,e.Numbering.ConcreteNumbering),path:`word/header${n+1}.xml`}}),Footers:e.Footers.map((c,n)=>{const u=rt(this.formatter.format(c.View,{viewWrapper:c,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),w=this.imageReplacer.getMediaData(u,e.Media),y=this.imageReplacer.replace(u,w,0);return{data:this.numberingReplacer.replace(y,e.Numbering.ConcreteNumbering),path:`word/footer${n+1}.xml`}}),ContentTypes:{data:rt(this.formatter.format(e.ContentTypes,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),path:"[Content_Types].xml"},CustomProperties:{data:rt(this.formatter.format(e.CustomProperties,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/custom.xml"},AppProperties:{data:rt(this.formatter.format(e.AppProperties,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/app.xml"},FootNotes:{data:rt(this.formatter.format(e.FootNotes.View,{viewWrapper:e.FootNotes,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),path:"word/footnotes.xml"},FootNotesRelationships:{data:rt(this.formatter.format(e.FootNotes.Relationships,{viewWrapper:e.FootNotes,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),path:"word/_rels/footnotes.xml.rels"},Settings:{data:rt(this.formatter.format(e.Settings,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/settings.xml"},Comments:{data:rt(this.formatter.format(e.Comments,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/comments.xml"},FontTable:{data:rt(this.formatter.format(e.FontTable.View,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/fontTable.xml"},FontTableRelationships:{data:rt(this.formatter.format(e.FontTable.Relationships,{viewWrapper:e.Document,file:e,stack:[]}),{indent:t,declaration:{encoding:"UTF-8"}}),path:"word/_rels/fontTable.xml.rels"}}}}const lh={WITH_2_BLANKS:"  "},Er=r=>r===!0?lh.WITH_2_BLANKS:r===!1?void 0:r;class oa{static toString(e,t){return Nr(this,null,function*(){return yield this.compiler.compile(e,Er(t)).generateAsync({type:"string",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"})})}static toBuffer(e,t){return Nr(this,null,function*(){return yield this.compiler.compile(e,Er(t)).generateAsync({type:"nodebuffer",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"})})}static toBase64String(e,t){return Nr(this,null,function*(){return yield this.compiler.compile(e,Er(t)).generateAsync({type:"base64",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"})})}static toBlob(e,t){return Nr(this,null,function*(){return yield this.compiler.compile(e,Er(t)).generateAsync({type:"blob",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"})})}static toStream(e,t){const a=new yi.Stream;return this.compiler.compile(e,Er(t)).generateAsync({type:"nodebuffer",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"}).then(i=>{a.emit("data",i),a.emit("end")}),a}}me(oa,"compiler",new ah);async function ch(r,e){console.log("[DOCX DEBUG] Creating minimal document");try{console.log("[DOCX DEBUG] Using Docxtemplater for simple document");const t=`
      <w:document xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main">
        <w:body>
          <w:p>
            <w:pPr>
              <w:pStyle w:val="Heading1"/>
              <w:jc w:val="center"/>
            </w:pPr>
            <w:r>
              <w:t>{title}</w:t>
            </w:r>
          </w:p>
          
          <w:p><w:r><w:t>{content}</w:t></w:r></w:p>
        </w:body>
      </w:document>
    `,a=new xa(t),l=new Ea(a,{paragraphLoop:!0,linebreaks:!0}),i=e?String(e).trim():"Analysis Report",c=r?String(r).trim():"";l.setData({title:i,content:c}),l.render();const n=l.getZip().generate({type:"blob",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"});return console.log("[DOCX DEBUG] Document created successfully with size:",n.size),n}catch(t){console.error("[DOCX DEBUG] Docxtemplater failed, falling back to original method:",t);try{const a=e?String(e).trim():"Analysis Report",c=(r?String(r).trim():"").split(`
`).map(y=>new Ar({children:[new Vr({text:y||" ",size:24})]})),n=new Ar({children:[new Vr({text:a,bold:!0,size:32})],spacing:{after:400}}),u=new $f({sections:[{children:[n,...c]}]});console.log("[DOCX DEBUG] Document created, generating blob");const w=await oa.toBlob(u);return console.log("[DOCX DEBUG] Blob generated, size:",w.size),w}catch(a){console.error("[DOCX DEBUG] Error creating document:",a);const l=`${e||"Analysis Report"}

${r||""}`,i=new Blob([l],{type:"text/plain"});return console.log("[DOCX DEBUG] Created fallback text blob"),i}}}function uh(r,e){try{console.log("[DOCX DEBUG] Downloading document, blob size:",r.size),Sa.saveAs(r,e),console.log("[DOCX DEBUG] Download initiated")}catch(t){throw console.error("[DOCX DEBUG] Download error:",t),t}}const{document:Ho}=ya;function $o(r,e,t){const a=r.slice();return a[73]=e[t],a}function Qn(r){const e=r.slice(),t=[...new Set(e[10].map(i=>i.document))];e[76]=t;const a=e[10].reduce((i,c)=>i+(c.debit||0),0);e[77]=a;const l=e[10].reduce((i,c)=>i+(c.credit||0),0);return e[78]=l,e}function Vo(r,e,t){const a=r.slice();return a[70]=e[t],a}function Ko(r,e,t){const a=r.slice();return a[79]=e[t],a}function Go(r){let e,t,a,l,i=r[16].title+"",c,n,u,w='<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg>',y,_,E,p,T,m;const S=[dh,hh,fh],f=[];function x(k,N){return k[16].isLoading?0:k[16].isEditing?1:2}return _=x(r),E=f[_]=S[_](r),{c(){e=de("div"),t=de("div"),a=de("div"),l=de("h2"),c=De(i),n=Se(),u=de("button"),u.innerHTML=w,y=Se(),E.c(),this.h()},l(k){e=he(k,"DIV",{class:!0});var N=pe(e);t=he(N,"DIV",{class:!0});var C=pe(t);a=he(C,"DIV",{class:!0});var H=pe(a);l=he(H,"H2",{class:!0});var $=pe(l);c=Oe($,i),$.forEach(ne),n=Ae(H),u=he(H,"BUTTON",{class:!0,"data-svelte-h":!0}),Ft(u)!=="svelte-1xal31m"&&(u.innerHTML=w),H.forEach(ne),y=Ae(C),E.l(C),C.forEach(ne),N.forEach(ne),this.h()},h(){ee(l,"class","text-xl font-bold"),ee(u,"class","p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full"),ee(a,"class","flex justify-between items-center mb-4"),ee(t,"class","w-full max-w-2xl bg-white dark:bg-gray-900 rounded-xl p-6 max-h-[80vh] overflow-auto"),ee(e,"class","fixed inset-0 z-50 flex items-center justify-center bg-black/60")},m(k,N){Le(k,e,N),J(e,t),J(t,a),J(a,l),J(l,c),J(a,n),J(a,u),J(t,y),f[_].m(t,null),p=!0,T||(m=[tt(u,"click",r[19]),tt(e,"click",da(r[19]))],T=!0)},p(k,N){(!p||N[0]&65536)&&i!==(i=k[16].title+"")&&Be(c,i);let C=_;_=x(k),_===C?f[_].p(k,N):(Vt(),st(f[C],1,1,()=>{f[C]=null}),$t(),E=f[_],E?E.p(k,N):(E=f[_]=S[_](k),E.c()),Qe(E,1),E.m(t,null))},i(k){p||(Qe(E),p=!0)},o(k){st(E),p=!1},d(k){k&&ne(e),f[_].d(),T=!1,ar(m)}}}function fh(r){let e,t,a,l,i,c,n,u=r[15].t("Download Report")+"",w,y,_,E=r[15].t("Edit Analysis")+"",p,T,m,S=tr((r[16].content||"").split(";")),f=[];for(let x=0;x<S.length;x+=1)f[x]=qo(Ko(r,S,x));return{c(){e=de("div");for(let x=0;x<f.length;x+=1)f[x].c();t=Se(),a=de("div"),l=de("button"),i=kt("svg"),c=kt("path"),n=Se(),w=De(u),y=Se(),_=de("button"),p=De(E),this.h()},l(x){e=he(x,"DIV",{class:!0});var k=pe(e);for(let Z=0;Z<f.length;Z+=1)f[Z].l(k);k.forEach(ne),t=Ae(x),a=he(x,"DIV",{class:!0});var N=pe(a);l=he(N,"BUTTON",{class:!0});var C=pe(l);i=St(C,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var H=pe(i);c=St(H,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),pe(c).forEach(ne),H.forEach(ne),n=Ae(C),w=Oe(C,u),C.forEach(ne),y=Ae(N),_=he(N,"BUTTON",{class:!0});var $=pe(_);p=Oe($,E),$.forEach(ne),N.forEach(ne),this.h()},h(){ee(e,"class","analysis-content prose dark:prose-invert max-w-none"),ee(c,"stroke-linecap","round"),ee(c,"stroke-linejoin","round"),ee(c,"stroke-width","2"),ee(c,"d","M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l2.414 2.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"),ee(i,"xmlns","http://www.w3.org/2000/svg"),ee(i,"class","h-5 w-5 mr-2"),ee(i,"fill","none"),ee(i,"viewBox","0 0 24 24"),ee(i,"stroke","currentColor"),ee(l,"class","px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition flex items-center"),ee(_,"class","px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition"),ee(a,"class","mt-4 flex justify-end space-x-3")},m(x,k){Le(x,e,k);for(let N=0;N<f.length;N+=1)f[N]&&f[N].m(e,null);Le(x,t,k),Le(x,a,k),J(a,l),J(l,i),J(i,c),J(l,n),J(l,w),J(a,y),J(a,_),J(_,p),T||(m=[tt(l,"click",r[40]),tt(_,"click",r[20])],T=!0)},p(x,k){if(k[0]&65536){S=tr((x[16].content||"").split(";"));let N;for(N=0;N<S.length;N+=1){const C=Ko(x,S,N);f[N]?f[N].p(C,k):(f[N]=qo(C),f[N].c(),f[N].m(e,null))}for(;N<f.length;N+=1)f[N].d(1);f.length=S.length}k[0]&32768&&u!==(u=x[15].t("Download Report")+"")&&Be(w,u),k[0]&32768&&E!==(E=x[15].t("Edit Analysis")+"")&&Be(p,E)},i:dt,o:dt,d(x){x&&(ne(e),ne(t),ne(a)),fi(f,x),T=!1,ar(m)}}}function hh(r){let e,t,a,l,i,c,n=r[15].t("Cancel")+"",u,w,y,_=r[15].t("Save")+"",E,p,T;return{c(){e=de("div"),t=de("textarea"),l=Se(),i=de("div"),c=de("button"),u=De(n),w=Se(),y=de("button"),E=De(_),this.h()},l(m){e=he(m,"DIV",{class:!0});var S=pe(e);t=he(S,"TEXTAREA",{class:!0,placeholder:!0}),pe(t).forEach(ne),S.forEach(ne),l=Ae(m),i=he(m,"DIV",{class:!0});var f=pe(i);c=he(f,"BUTTON",{class:!0});var x=pe(c);u=Oe(x,n),x.forEach(ne),w=Ae(f),y=he(f,"BUTTON",{class:!0});var k=pe(y);E=Oe(k,_),k.forEach(ne),f.forEach(ne),this.h()},h(){ee(t,"class","w-full h-64 px-3 py-2 text-sm rounded border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800"),ee(t,"placeholder",a=r[15].t("Enter your analysis here...")),ee(e,"class","mb-4"),ee(c,"class","px-4 py-2 rounded-lg bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 transition"),ee(y,"class","px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 transition"),ee(i,"class","flex justify-end space-x-3")},m(m,S){Le(m,e,S),J(e,t),Pt(t,r[16].editText),Le(m,l,S),Le(m,i,S),J(i,c),J(c,u),J(i,w),J(i,y),J(y,E),p||(T=[tt(t,"input",r[39]),tt(c,"click",r[20]),tt(y,"click",r[21])],p=!0)},p(m,S){S[0]&32768&&a!==(a=m[15].t("Enter your analysis here..."))&&ee(t,"placeholder",a),S[0]&65536&&Pt(t,m[16].editText),S[0]&32768&&n!==(n=m[15].t("Cancel")+"")&&Be(u,n),S[0]&32768&&_!==(_=m[15].t("Save")+"")&&Be(E,_)},i:dt,o:dt,d(m){m&&(ne(e),ne(l),ne(i)),p=!1,ar(T)}}}function dh(r){let e,t,a,l,i=r[15].t("Generating analysis...")+"",c,n;return t=new hr({props:{className:"size-8"}}),{c(){e=de("div"),fr(t.$$.fragment),a=Se(),l=de("p"),c=De(i),this.h()},l(u){e=he(u,"DIV",{class:!0});var w=pe(e);ur(t.$$.fragment,w),a=Ae(w),l=he(w,"P",{class:!0});var y=pe(l);c=Oe(y,i),y.forEach(ne),w.forEach(ne),this.h()},h(){ee(l,"class","ml-3 text-gray-600 dark:text-gray-400"),ee(e,"class","flex justify-center items-center py-8")},m(u,w){Le(u,e,w),cr(t,e,null),J(e,a),J(e,l),J(l,c),n=!0},p(u,w){(!n||w[0]&32768)&&i!==(i=u[15].t("Generating analysis...")+"")&&Be(c,i)},i(u){n||(Qe(t.$$.fragment,u),n=!0)},o(u){st(t.$$.fragment,u),n=!1},d(u){u&&ne(e),lr(t)}}}function qo(r){let e,t,a=r[79]+"";return{c(){e=de("p"),t=new Xr(!1),this.h()},l(l){e=he(l,"P",{class:!0});var i=pe(e);t=qr(i,!1),i.forEach(ne),this.h()},h(){t.a=null,ee(e,"class","mb-1")},m(l,i){Le(l,e,i),t.m(a,e)},p(l,i){i[0]&65536&&a!==(a=l[79]+"")&&t.p(a)},d(l){l&&ne(e)}}}function ph(r){let e,t,a,l,i='<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path></svg>',c,n,u=r[15].t("Edit Analysis")+"",w,y,_,E,p,T,m,S,f,x=r[15].t("Cancel")+"",k,N,C,H,$,Z,R=r[15].t("Download")+"",ce,ge,I,V,A=r[15].t("Save")+"",j,oe,G,we,Y=r[13]&&Xo(r);return{c(){e=de("div"),t=de("div"),a=de("div"),l=de("button"),l.innerHTML=i,c=Se(),n=de("h2"),w=De(u),y=Se(),_=de("div"),E=de("textarea"),T=Se(),Y&&Y.c(),m=Se(),S=de("div"),f=de("button"),k=De(x),N=Se(),C=de("button"),H=kt("svg"),$=kt("path"),Z=Se(),ce=De(R),I=Se(),V=de("button"),j=De(A),this.h()},l(te){e=he(te,"DIV",{class:!0});var M=pe(e);t=he(M,"DIV",{class:!0});var D=pe(t);a=he(D,"DIV",{class:!0});var q=pe(a);l=he(q,"BUTTON",{class:!0,"data-svelte-h":!0}),Ft(l)!=="svelte-1hnzekv"&&(l.innerHTML=i),c=Ae(q),n=he(q,"H2",{class:!0});var X=pe(n);w=Oe(X,u),X.forEach(ne),q.forEach(ne),D.forEach(ne),y=Ae(M),_=he(M,"DIV",{class:!0});var ie=pe(_);E=he(ie,"TEXTAREA",{class:!0,placeholder:!0}),pe(E).forEach(ne),T=Ae(ie),Y&&Y.l(ie),ie.forEach(ne),m=Ae(M),S=he(M,"DIV",{class:!0});var z=pe(S);f=he(z,"BUTTON",{class:!0});var v=pe(f);k=Oe(v,x),v.forEach(ne),N=Ae(z),C=he(z,"BUTTON",{class:!0});var g=pe(C);H=St(g,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var U=pe(H);$=St(U,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),pe($).forEach(ne),U.forEach(ne),Z=Ae(g),ce=Oe(g,R),g.forEach(ne),I=Ae(z),V=he(z,"BUTTON",{class:!0});var P=pe(V);j=Oe(P,A),P.forEach(ne),z.forEach(ne),M.forEach(ne),this.h()},h(){ee(l,"class","mr-2 p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full"),ee(n,"class","text-xl font-bold"),ee(a,"class","flex items-center"),ee(t,"class","flex justify-between items-center mb-4"),ee(E,"class","w-full h-64 px-3 py-2 text-sm rounded border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800"),ee(E,"placeholder",p=r[15].t("Enter your analysis here...")),E.disabled=r[13],ee(_,"class","mb-4 relative"),ee(f,"class","px-4 py-2 rounded-lg bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 transition"),ee($,"stroke-linecap","round"),ee($,"stroke-linejoin","round"),ee($,"stroke-width","2"),ee($,"d","M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l2.414 2.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"),ee(H,"xmlns","http://www.w3.org/2000/svg"),ee(H,"class","h-5 w-5 mr-2"),ee(H,"fill","none"),ee(H,"viewBox","0 0 24 24"),ee(H,"stroke","currentColor"),ee(C,"class","px-4 py-2 rounded-lg bg-green-600 text-white hover:bg-green-700 transition flex items-center"),C.disabled=ge=!r[12]||r[13],ee(V,"class","px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 transition"),V.disabled=r[13],ee(S,"class","flex justify-end space-x-3"),ee(e,"class","bg-white dark:bg-gray-800 p-6 rounded-lg shadow")},m(te,M){Le(te,e,M),J(e,t),J(t,a),J(a,l),J(a,c),J(a,n),J(n,w),J(e,y),J(e,_),J(_,E),Pt(E,r[12]),J(_,T),Y&&Y.m(_,null),J(e,m),J(e,S),J(S,f),J(f,k),J(S,N),J(S,C),J(C,H),J(H,$),J(C,Z),J(C,ce),J(S,I),J(S,V),J(V,j),oe=!0,G||(we=[tt(l,"click",r[31]),tt(E,"input",r[44]),tt(f,"click",r[31]),tt(C,"click",r[45]),tt(V,"click",r[26])],G=!0)},p(te,M){(!oe||M[0]&32768)&&u!==(u=te[15].t("Edit Analysis")+"")&&Be(w,u),(!oe||M[0]&32768&&p!==(p=te[15].t("Enter your analysis here...")))&&ee(E,"placeholder",p),(!oe||M[0]&8192)&&(E.disabled=te[13]),M[0]&4096&&Pt(E,te[12]),te[13]?Y?(Y.p(te,M),M[0]&8192&&Qe(Y,1)):(Y=Xo(te),Y.c(),Qe(Y,1),Y.m(_,null)):Y&&(Vt(),st(Y,1,1,()=>{Y=null}),$t()),(!oe||M[0]&32768)&&x!==(x=te[15].t("Cancel")+"")&&Be(k,x),(!oe||M[0]&32768)&&R!==(R=te[15].t("Download")+"")&&Be(ce,R),(!oe||M[0]&12288&&ge!==(ge=!te[12]||te[13]))&&(C.disabled=ge),(!oe||M[0]&32768)&&A!==(A=te[15].t("Save")+"")&&Be(j,A),(!oe||M[0]&8192)&&(V.disabled=te[13])},i(te){oe||(Qe(Y),oe=!0)},o(te){st(Y),oe=!1},d(te){te&&ne(e),Y&&Y.d(),G=!1,ar(we)}}}function mh(r){let e,t,a,l,i='<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path></svg>',c,n,u,w,y,_,E,p,T;const m=[vh,yh],S=[];function f(x,k){return x[3]?0:1}return y=f(r),_=S[y]=m[y](r),{c(){e=de("div"),t=de("div"),a=de("div"),l=de("button"),l.innerHTML=i,c=Se(),n=de("h2"),u=De(r[4]),w=Se(),_.c(),this.h()},l(x){e=he(x,"DIV",{class:!0});var k=pe(e);t=he(k,"DIV",{class:!0});var N=pe(t);a=he(N,"DIV",{class:!0});var C=pe(a);l=he(C,"BUTTON",{class:!0,"data-svelte-h":!0}),Ft(l)!=="svelte-1hnzekv"&&(l.innerHTML=i),c=Ae(C),n=he(C,"H2",{class:!0});var H=pe(n);u=Oe(H,r[4]),H.forEach(ne),C.forEach(ne),N.forEach(ne),w=Ae(k),_.l(k),k.forEach(ne),this.h()},h(){ee(l,"class","mr-2 p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full"),ee(n,"class","text-xl font-bold"),ee(a,"class","flex items-center"),ee(t,"class","flex justify-between items-center mb-6"),ee(e,"class","bg-white dark:bg-gray-800 p-6 rounded-lg shadow")},m(x,k){Le(x,e,k),J(e,t),J(t,a),J(a,l),J(a,c),J(a,n),J(n,u),J(e,w),S[y].m(e,null),E=!0,p||(T=tt(l,"click",r[31]),p=!0)},p(x,k){(!E||k[0]&16)&&Be(u,x[4]);let N=y;y=f(x),y===N?S[y].p(x,k):(Vt(),st(S[N],1,1,()=>{S[N]=null}),$t(),_=S[y],_?_.p(x,k):(_=S[y]=m[y](x),_.c()),Qe(_,1),_.m(e,null))},i(x){E||(Qe(_),E=!0)},o(x){st(_),E=!1},d(x){x&&ne(e),S[y].d(),p=!1,T()}}}function gh(r){let e,t,a,l,i='<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path></svg>',c,n,u,w,y,_,E,p,T,m,S,f=r[15].t("Date")+"",x,k,N,C=r[15].t("Journal Entry")+"",H,$,Z,R=r[15].t("Account")+"",ce,ge,I,V=r[15].t("Note")+"",A,j,oe,G=r[15].t("Debit")+"",we,Y,te,M=r[15].t("Credit")+"",D,q,X,ie=r[15].t("Flags")+"",z,v,g,U,P,O,B=r[10].length>0&&Zo(Qn(r)),se=tr(r[10]),h=[];for(let b=0;b<se.length;b+=1)h[b]=rs($o(r,se,b));let Q=r[10].length===0&&ns(r);return{c(){e=de("div"),t=de("div"),a=de("div"),l=de("button"),l.innerHTML=i,c=Se(),n=de("h2"),u=De(r[11]),w=Se(),y=de("div"),B&&B.c(),_=Se(),E=de("div"),p=de("table"),T=de("thead"),m=de("tr"),S=de("th"),x=De(f),k=Se(),N=de("th"),H=De(C),$=Se(),Z=de("th"),ce=De(R),ge=Se(),I=de("th"),A=De(V),j=Se(),oe=de("th"),we=De(G),Y=Se(),te=de("th"),D=De(M),q=Se(),X=de("th"),z=De(ie),v=Se(),g=de("tbody");for(let b=0;b<h.length;b+=1)h[b].c();U=Se(),Q&&Q.c(),this.h()},l(b){e=he(b,"DIV",{class:!0});var o=pe(e);t=he(o,"DIV",{class:!0});var s=pe(t);a=he(s,"DIV",{class:!0});var d=pe(a);l=he(d,"BUTTON",{class:!0,"data-svelte-h":!0}),Ft(l)!=="svelte-1hnzekv"&&(l.innerHTML=i),c=Ae(d),n=he(d,"H2",{class:!0});var F=pe(n);u=Oe(F,r[11]),F.forEach(ne),d.forEach(ne),s.forEach(ne),w=Ae(o),y=he(o,"DIV",{class:!0});var K=pe(y);B&&B.l(K),K.forEach(ne),_=Ae(o),E=he(o,"DIV",{class:!0});var L=pe(E);p=he(L,"TABLE",{class:!0});var ue=pe(p);T=he(ue,"THEAD",{class:!0});var ve=pe(T);m=he(ve,"TR",{});var ae=pe(m);S=he(ae,"TH",{class:!0});var Ee=pe(S);x=Oe(Ee,f),Ee.forEach(ne),k=Ae(ae),N=he(ae,"TH",{class:!0});var ke=pe(N);H=Oe(ke,C),ke.forEach(ne),$=Ae(ae),Z=he(ae,"TH",{class:!0});var Ne=pe(Z);ce=Oe(Ne,R),Ne.forEach(ne),ge=Ae(ae),I=he(ae,"TH",{class:!0});var ot=pe(I);A=Oe(ot,V),ot.forEach(ne),j=Ae(ae),oe=he(ae,"TH",{class:!0});var mt=pe(oe);we=Oe(mt,G),mt.forEach(ne),Y=Ae(ae),te=he(ae,"TH",{class:!0});var ft=pe(te);D=Oe(ft,M),ft.forEach(ne),q=Ae(ae),X=he(ae,"TH",{class:!0});var _t=pe(X);z=Oe(_t,ie),_t.forEach(ne),ae.forEach(ne),ve.forEach(ne),v=Ae(ue),g=he(ue,"TBODY",{});var $e=pe(g);for(let xt=0;xt<h.length;xt+=1)h[xt].l($e);U=Ae($e),Q&&Q.l($e),$e.forEach(ne),ue.forEach(ne),L.forEach(ne),o.forEach(ne),this.h()},h(){ee(l,"class","mr-2 p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full"),ee(n,"class","text-xl font-bold"),ee(a,"class","flex items-center"),ee(t,"class","flex justify-between items-center mb-6"),ee(y,"class","transaction-summary mb-6 grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3"),ee(S,"class","px-4 py-2 text-left"),ee(N,"class","px-4 py-2 text-left"),ee(Z,"class","px-4 py-2 text-left"),ee(I,"class","px-4 py-2 text-left"),ee(oe,"class","px-4 py-2 text-right"),ee(te,"class","px-4 py-2 text-right"),ee(X,"class","px-4 py-2 text-center"),ee(T,"class","bg-gray-50 dark:bg-gray-700 text-gray-500 dark:text-gray-300"),ee(p,"class","w-full text-sm"),ee(E,"class","overflow-x-auto"),ee(e,"class","bg-white dark:bg-gray-800 p-6 rounded-lg shadow")},m(b,o){Le(b,e,o),J(e,t),J(t,a),J(a,l),J(a,c),J(a,n),J(n,u),J(e,w),J(e,y),B&&B.m(y,null),J(e,_),J(e,E),J(E,p),J(p,T),J(T,m),J(m,S),J(S,x),J(m,k),J(m,N),J(N,H),J(m,$),J(m,Z),J(Z,ce),J(m,ge),J(m,I),J(I,A),J(m,j),J(m,oe),J(oe,we),J(m,Y),J(m,te),J(te,D),J(m,q),J(m,X),J(X,z),J(p,v),J(p,g);for(let s=0;s<h.length;s+=1)h[s]&&h[s].m(g,null);J(g,U),Q&&Q.m(g,null),P||(O=tt(l,"click",r[31]),P=!0)},p(b,o){if(o[0]&2048&&Be(u,b[11]),b[10].length>0?B?B.p(Qn(b),o):(B=Zo(Qn(b)),B.c(),B.m(y,null)):B&&(B.d(1),B=null),o[0]&32768&&f!==(f=b[15].t("Date")+"")&&Be(x,f),o[0]&32768&&C!==(C=b[15].t("Journal Entry")+"")&&Be(H,C),o[0]&32768&&R!==(R=b[15].t("Account")+"")&&Be(ce,R),o[0]&32768&&V!==(V=b[15].t("Note")+"")&&Be(A,V),o[0]&32768&&G!==(G=b[15].t("Debit")+"")&&Be(we,G),o[0]&32768&&M!==(M=b[15].t("Credit")+"")&&Be(D,M),o[0]&32768&&ie!==(ie=b[15].t("Flags")+"")&&Be(z,ie),o[0]&268469248){se=tr(b[10]);let s;for(s=0;s<se.length;s+=1){const d=$o(b,se,s);h[s]?h[s].p(d,o):(h[s]=rs(d),h[s].c(),h[s].m(g,U))}for(;s<h.length;s+=1)h[s].d(1);h.length=se.length}b[10].length===0?Q?Q.p(b,o):(Q=ns(b),Q.c(),Q.m(g,null)):Q&&(Q.d(1),Q=null)},i:dt,o:dt,d(b){b&&ne(e),B&&B.d(),fi(h,b),Q&&Q.d(),P=!1,O()}}}function wh(r){let e,t,a='<div class="m-auto self-center"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="size-5"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25H12"></path></svg></div>',l,i,c=r[15].t("Account Analysis")+"",n,u,w,y="",_,E,p,T,m,S,f;const x=[Eh,xh,_h,bh],k=[];function N(C,H){return C[6]?0:C[7]?C[0]?2:3:1}return E=N(r),p=k[E]=x[E](r),{c(){e=de("div"),t=de("button"),t.innerHTML=a,l=Se(),i=de("h1"),n=De(c),u=Se(),w=de("div"),w.innerHTML=y,_=Se(),p.c(),T=Ni(),this.h()},l(C){e=he(C,"DIV",{class:!0});var H=pe(e);t=he(H,"BUTTON",{class:!0,"aria-label":!0,"data-svelte-h":!0}),Ft(t)!=="svelte-eetc7p"&&(t.innerHTML=a),l=Ae(H),i=he(H,"H1",{class:!0});var $=pe(i);n=Oe($,c),$.forEach(ne),u=Ae(H),w=he(H,"DIV",{class:!0,"data-svelte-h":!0}),Ft(w)!=="svelte-prv37y"&&(w.innerHTML=y),H.forEach(ne),_=Ae(C),p.l(C),T=Ni(),this.h()},h(){ee(t,"class","cursor-pointer p-[7px] flex rounded-xl hover:bg-gray-100 dark:hover:bg-gray-900 transition"),ee(t,"aria-label","Toggle Sidebar"),ee(i,"class","text-2xl font-bold text-blue-800 dark:text-blue-300"),ee(w,"class","flex items-center space-x-2"),ee(e,"class","flex justify-between items-center mb-6")},m(C,H){Le(C,e,H),J(e,t),J(e,l),J(e,i),J(i,n),J(e,u),J(e,w),Le(C,_,H),k[E].m(C,H),Le(C,T,H),m=!0,S||(f=tt(t,"click",r[34]),S=!0)},p(C,H){(!m||H[0]&32768)&&c!==(c=C[15].t("Account Analysis")+"")&&Be(n,c);let $=E;E=N(C),E===$?k[E].p(C,H):(Vt(),st(k[$],1,1,()=>{k[$]=null}),$t(),p=k[E],p?p.p(C,H):(p=k[E]=x[E](C),p.c()),Qe(p,1),p.m(T.parentNode,T))},i(C){m||(Qe(p),m=!0)},o(C){st(p),m=!1},d(C){C&&(ne(e),ne(_),ne(T)),k[E].d(C),S=!1,f()}}}function Xo(r){let e,t,a,l,i,c=r[15].t("Generating analysis...")+"",n,u;return a=new hr({props:{className:"size-8 mb-2"}}),{c(){e=de("div"),t=de("div"),fr(a.$$.fragment),l=Se(),i=de("div"),n=De(c),this.h()},l(w){e=he(w,"DIV",{class:!0});var y=pe(e);t=he(y,"DIV",{class:!0});var _=pe(t);ur(a.$$.fragment,_),l=Ae(_),i=he(_,"DIV",{class:!0});var E=pe(i);n=Oe(E,c),E.forEach(ne),_.forEach(ne),y.forEach(ne),this.h()},h(){ee(i,"class","text-sm font-medium"),ee(t,"class","flex flex-col items-center"),ee(e,"class","absolute inset-0 bg-black/10 flex items-center justify-center")},m(w,y){Le(w,e,y),J(e,t),cr(a,t,null),J(t,l),J(t,i),J(i,n),u=!0},p(w,y){(!u||y[0]&32768)&&c!==(c=w[15].t("Generating analysis...")+"")&&Be(n,c)},i(w){u||(Qe(a.$$.fragment,w),u=!0)},o(w){st(a.$$.fragment,w),u=!1},d(w){w&&ne(e),lr(a)}}}function yh(r){let e,t,a;return t=new hr({props:{className:"size-8"}}),{c(){e=de("div"),fr(t.$$.fragment),this.h()},l(l){e=he(l,"DIV",{class:!0});var i=pe(e);ur(t.$$.fragment,i),i.forEach(ne),this.h()},h(){ee(e,"class","flex justify-center items-center h-64")},m(l,i){Le(l,e,i),cr(t,e,null),a=!0},p:dt,i(l){a||(Qe(t.$$.fragment,l),a=!0)},o(l){st(t.$$.fragment,l),a=!1},d(l){l&&ne(e),lr(t)}}}function vh(r){let e,t,a,l=r[32]()+"";return{c(){e=de("div"),t=de("div"),a=new Xr(!1),this.h()},l(i){e=he(i,"DIV",{class:!0});var c=pe(e);t=he(c,"DIV",{class:!0});var n=pe(t);a=qr(n,!1),n.forEach(ne),c.forEach(ne),this.h()},h(){a.a=null,ee(t,"class","timeline-section mb-6"),ee(e,"class","chart-content svelte-126e3bb")},m(i,c){Le(i,e,c),J(e,t),a.m(l,t)},p:dt,i:dt,o:dt,d(i){i&&ne(e)}}}function Zo(r){let e,t,a=r[15].t("Total Transactions")+"",l,i,c,n=r[76].length+"",u,w,y,_,E=r[15].t("Total Debits")+"",p,T,m,S=lt(r[77])+"",f,x,k,N,C=r[15].t("Total Credits")+"",H,$,Z,R=lt(r[78])+"",ce,ge,I,V,A=r[15].t("Net Amount")+"",j,oe,G,we=lt(r[77]-r[78])+"",Y;return{c(){e=de("div"),t=de("div"),l=De(a),i=Se(),c=de("div"),u=De(n),w=Se(),y=de("div"),_=de("div"),p=De(E),T=Se(),m=de("div"),f=De(S),x=Se(),k=de("div"),N=de("div"),H=De(C),$=Se(),Z=de("div"),ce=De(R),ge=Se(),I=de("div"),V=de("div"),j=De(A),oe=Se(),G=de("div"),Y=De(we),this.h()},l(te){e=he(te,"DIV",{class:!0});var M=pe(e);t=he(M,"DIV",{class:!0});var D=pe(t);l=Oe(D,a),D.forEach(ne),i=Ae(M),c=he(M,"DIV",{class:!0});var q=pe(c);u=Oe(q,n),q.forEach(ne),M.forEach(ne),w=Ae(te),y=he(te,"DIV",{class:!0});var X=pe(y);_=he(X,"DIV",{class:!0});var ie=pe(_);p=Oe(ie,E),ie.forEach(ne),T=Ae(X),m=he(X,"DIV",{class:!0});var z=pe(m);f=Oe(z,S),z.forEach(ne),X.forEach(ne),x=Ae(te),k=he(te,"DIV",{class:!0});var v=pe(k);N=he(v,"DIV",{class:!0});var g=pe(N);H=Oe(g,C),g.forEach(ne),$=Ae(v),Z=he(v,"DIV",{class:!0});var U=pe(Z);ce=Oe(U,R),U.forEach(ne),v.forEach(ne),ge=Ae(te),I=he(te,"DIV",{class:!0});var P=pe(I);V=he(P,"DIV",{class:!0});var O=pe(V);j=Oe(O,A),O.forEach(ne),oe=Ae(P),G=he(P,"DIV",{class:!0});var B=pe(G);Y=Oe(B,we),B.forEach(ne),P.forEach(ne),this.h()},h(){ee(t,"class","text-xs text-blue-600 dark:text-blue-400"),ee(c,"class","text-xl font-bold"),ee(e,"class","p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg"),ee(_,"class","text-xs text-green-600 dark:text-green-400"),ee(m,"class","text-xl font-bold"),ee(y,"class","p-3 bg-green-50 dark:bg-green-900/20 rounded-lg"),ee(N,"class","text-xs text-red-600 dark:text-red-400"),ee(Z,"class","text-xl font-bold"),ee(k,"class","p-3 bg-red-50 dark:bg-red-900/20 rounded-lg"),ee(V,"class","text-xs text-purple-600 dark:text-purple-400"),ee(G,"class","text-xl font-bold"),ee(I,"class","p-3 bg-purple-50 dark:bg-purple-900/20 rounded-lg")},m(te,M){Le(te,e,M),J(e,t),J(t,l),J(e,i),J(e,c),J(c,u),Le(te,w,M),Le(te,y,M),J(y,_),J(_,p),J(y,T),J(y,m),J(m,f),Le(te,x,M),Le(te,k,M),J(k,N),J(N,H),J(k,$),J(k,Z),J(Z,ce),Le(te,ge,M),Le(te,I,M),J(I,V),J(V,j),J(I,oe),J(I,G),J(G,Y)},p(te,M){M[0]&32768&&a!==(a=te[15].t("Total Transactions")+"")&&Be(l,a),M[0]&1024&&n!==(n=te[76].length+"")&&Be(u,n),M[0]&32768&&E!==(E=te[15].t("Total Debits")+"")&&Be(p,E),M[0]&1024&&S!==(S=lt(te[77])+"")&&Be(f,S),M[0]&32768&&C!==(C=te[15].t("Total Credits")+"")&&Be(H,C),M[0]&1024&&R!==(R=lt(te[78])+"")&&Be(ce,R),M[0]&32768&&A!==(A=te[15].t("Net Amount")+"")&&Be(j,A),M[0]&1024&&we!==(we=lt(te[77]-te[78])+"")&&Be(Y,we)},d(te){te&&(ne(e),ne(w),ne(y),ne(x),ne(k),ne(ge),ne(I))}}}function Yo(r){let e,t=lt(r[73].debit)+"",a;return{c(){e=de("span"),a=De(t),this.h()},l(l){e=he(l,"SPAN",{class:!0});var i=pe(e);a=Oe(i,t),i.forEach(ne),this.h()},h(){ee(e,"class","font-medium")},m(l,i){Le(l,e,i),J(e,a)},p(l,i){i[0]&1024&&t!==(t=lt(l[73].debit)+"")&&Be(a,t)},d(l){l&&ne(e)}}}function Jo(r){let e,t=lt(r[73].credit)+"",a;return{c(){e=de("span"),a=De(t),this.h()},l(l){e=he(l,"SPAN",{class:!0});var i=pe(e);a=Oe(i,t),i.forEach(ne),this.h()},h(){ee(e,"class","font-medium")},m(l,i){Le(l,e,i),J(e,a)},p(l,i){i[0]&1024&&t!==(t=lt(l[73].credit)+"")&&Be(a,t)},d(l){l&&ne(e)}}}function Qo(r){let e,t=r[15].t("Recurring")+"",a;return{c(){e=de("span"),a=De(t),this.h()},l(l){e=he(l,"SPAN",{class:!0});var i=pe(e);a=Oe(i,t),i.forEach(ne),this.h()},h(){ee(e,"class","inline-flex items-center px-1.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300")},m(l,i){Le(l,e,i),J(e,a)},p(l,i){i[0]&32768&&t!==(t=l[15].t("Recurring")+"")&&Be(a,t)},d(l){l&&ne(e)}}}function es(r){let e,t=r[15].t("Unusual")+"",a;return{c(){e=de("span"),a=De(t),this.h()},l(l){e=he(l,"SPAN",{class:!0});var i=pe(e);a=Oe(i,t),i.forEach(ne),this.h()},h(){ee(e,"class","inline-flex items-center px-1.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300")},m(l,i){Le(l,e,i),J(e,a)},p(l,i){i[0]&32768&&t!==(t=l[15].t("Unusual")+"")&&Be(a,t)},d(l){l&&ne(e)}}}function ts(r){let e,t,a=r[28](r[73].iqr_flag)+"";return{c(){e=de("span"),t=new Xr(!1),this.h()},l(l){e=he(l,"SPAN",{class:!0});var i=pe(e);t=qr(i,!1),i.forEach(ne),this.h()},h(){t.a=null,ee(e,"class","ml-1")},m(l,i){Le(l,e,i),t.m(a,e)},p(l,i){i[0]&1024&&a!==(a=l[28](l[73].iqr_flag)+"")&&t.p(a)},d(l){l&&ne(e)}}}function rs(r){let e,t,a=r[73].postingDate+"",l,i,c,n=r[73].document+"",u,w,y,_,E=r[73].account+"",p,T,m,S=r[73].accountName+"",f,x,k,N=r[73].text+"",C,H,$,Z,R,ce,ge,I,V,A=r[73].debit&&Yo(r),j=r[73].credit&&Jo(r),oe=r[73].isRecurring&&Qo(r),G=r[73].isUnusual&&es(r),we=r[73].iqr_flag!==void 0&&ts(r);return{c(){e=de("tr"),t=de("td"),l=De(a),i=Se(),c=de("td"),u=De(n),w=Se(),y=de("td"),_=de("div"),p=De(E),T=Se(),m=de("div"),f=De(S),x=Se(),k=de("td"),C=De(N),H=Se(),$=de("td"),A&&A.c(),Z=Se(),R=de("td"),j&&j.c(),ce=Se(),ge=de("td"),oe&&oe.c(),I=Se(),G&&G.c(),V=Se(),we&&we.c(),this.h()},l(Y){e=he(Y,"TR",{class:!0});var te=pe(e);t=he(te,"TD",{class:!0});var M=pe(t);l=Oe(M,a),M.forEach(ne),i=Ae(te),c=he(te,"TD",{class:!0});var D=pe(c);u=Oe(D,n),D.forEach(ne),w=Ae(te),y=he(te,"TD",{class:!0});var q=pe(y);_=he(q,"DIV",{class:!0});var X=pe(_);p=Oe(X,E),X.forEach(ne),T=Ae(q),m=he(q,"DIV",{});var ie=pe(m);f=Oe(ie,S),ie.forEach(ne),q.forEach(ne),x=Ae(te),k=he(te,"TD",{class:!0});var z=pe(k);C=Oe(z,N),z.forEach(ne),H=Ae(te),$=he(te,"TD",{class:!0});var v=pe($);A&&A.l(v),v.forEach(ne),Z=Ae(te),R=he(te,"TD",{class:!0});var g=pe(R);j&&j.l(g),g.forEach(ne),ce=Ae(te),ge=he(te,"TD",{class:!0});var U=pe(ge);oe&&oe.l(U),I=Ae(U),G&&G.l(U),V=Ae(U),we&&we.l(U),U.forEach(ne),te.forEach(ne),this.h()},h(){ee(t,"class","px-4 py-2"),ee(c,"class","px-4 py-2 font-medium"),ee(_,"class","font-mono text-xs"),ee(y,"class","px-4 py-2"),ee(k,"class","px-4 py-2"),ee($,"class","px-4 py-2 text-right"),ee(R,"class","px-4 py-2 text-right"),ee(ge,"class","px-4 py-2 text-center"),ee(e,"class","border-t border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800/50")},m(Y,te){Le(Y,e,te),J(e,t),J(t,l),J(e,i),J(e,c),J(c,u),J(e,w),J(e,y),J(y,_),J(_,p),J(y,T),J(y,m),J(m,f),J(e,x),J(e,k),J(k,C),J(e,H),J(e,$),A&&A.m($,null),J(e,Z),J(e,R),j&&j.m(R,null),J(e,ce),J(e,ge),oe&&oe.m(ge,null),J(ge,I),G&&G.m(ge,null),J(ge,V),we&&we.m(ge,null)},p(Y,te){te[0]&1024&&a!==(a=Y[73].postingDate+"")&&Be(l,a),te[0]&1024&&n!==(n=Y[73].document+"")&&Be(u,n),te[0]&1024&&E!==(E=Y[73].account+"")&&Be(p,E),te[0]&1024&&S!==(S=Y[73].accountName+"")&&Be(f,S),te[0]&1024&&N!==(N=Y[73].text+"")&&Be(C,N),Y[73].debit?A?A.p(Y,te):(A=Yo(Y),A.c(),A.m($,null)):A&&(A.d(1),A=null),Y[73].credit?j?j.p(Y,te):(j=Jo(Y),j.c(),j.m(R,null)):j&&(j.d(1),j=null),Y[73].isRecurring?oe?oe.p(Y,te):(oe=Qo(Y),oe.c(),oe.m(ge,I)):oe&&(oe.d(1),oe=null),Y[73].isUnusual?G?G.p(Y,te):(G=es(Y),G.c(),G.m(ge,V)):G&&(G.d(1),G=null),Y[73].iqr_flag!==void 0?we?we.p(Y,te):(we=ts(Y),we.c(),we.m(ge,null)):we&&(we.d(1),we=null)},d(Y){Y&&ne(e),A&&A.d(),j&&j.d(),oe&&oe.d(),G&&G.d(),we&&we.d()}}}function ns(r){let e,t,a=r[15].t("No transactions found for this period")+"",l;return{c(){e=de("tr"),t=de("td"),l=De(a),this.h()},l(i){e=he(i,"TR",{});var c=pe(e);t=he(c,"TD",{colspan:!0,class:!0});var n=pe(t);l=Oe(n,a),n.forEach(ne),c.forEach(ne),this.h()},h(){ee(t,"colspan","7"),ee(t,"class","px-4 py-8 text-center text-gray-500")},m(i,c){Le(i,e,c),J(e,t),J(t,l)},p(i,c){c[0]&32768&&a!==(a=i[15].t("No transactions found for this period")+"")&&Be(l,a)},d(i){i&&ne(e)}}}function bh(r){let e,t,a,l,i="Loading account data...",c;return t=new hr({props:{className:"size-8"}}),{c(){e=de("div"),fr(t.$$.fragment),a=Se(),l=de("div"),l.textContent=i,this.h()},l(n){e=he(n,"DIV",{class:!0});var u=pe(e);ur(t.$$.fragment,u),a=Ae(u),l=he(u,"DIV",{class:!0,"data-svelte-h":!0}),Ft(l)!=="svelte-1xgbd6n"&&(l.textContent=i),u.forEach(ne),this.h()},h(){ee(l,"class","ml-3"),ee(e,"class","flex justify-center items-center h-64")},m(n,u){Le(n,e,u),cr(t,e,null),J(e,a),J(e,l),c=!0},p:dt,i(n){c||(Qe(t.$$.fragment,n),c=!0)},o(n){st(t.$$.fragment,n),c=!1},d(n){n&&ne(e),lr(t)}}}function _h(r){let e,t,a,l,i,c=r[15].t("Significance Threshold")+"",n,u,w,y,_,E,p="%",T,m,S,f,x,k,N,C,H,$,Z=r[29]()+"",R,ce,ge,I=tr(r[8]),V=[];for(let j=0;j<I.length;j+=1)V[j]=is(Vo(r,I,j));let A=r[6]&&os(r);return{c(){e=de("div"),t=de("div"),a=de("div"),l=de("div"),i=de("span"),n=De(c),u=De(":"),w=Se(),y=de("input"),_=Se(),E=de("span"),E.textContent=p,T=Se(),m=de("div"),S=de("select");for(let j=0;j<V.length;j+=1)V[j].c();f=Se(),x=de("div"),k=De(r[14]),N=Se(),C=de("div"),A&&A.c(),H=Se(),$=new Xr(!1),this.h()},l(j){e=he(j,"DIV",{class:!0});var oe=pe(e);t=he(oe,"DIV",{class:!0});var G=pe(t);a=he(G,"DIV",{class:!0});var we=pe(a);l=he(we,"DIV",{class:!0});var Y=pe(l);i=he(Y,"SPAN",{class:!0});var te=pe(i);n=Oe(te,c),u=Oe(te,":"),te.forEach(ne),w=Ae(Y),y=he(Y,"INPUT",{type:!0,min:!0,max:!0,class:!0}),_=Ae(Y),E=he(Y,"SPAN",{class:!0,"data-svelte-h":!0}),Ft(E)!=="svelte-opx6g7"&&(E.textContent=p),Y.forEach(ne),T=Ae(we),m=he(we,"DIV",{class:!0});var M=pe(m);S=he(M,"SELECT",{id:!0,class:!0});var D=pe(S);for(let ie=0;ie<V.length;ie+=1)V[ie].l(D);D.forEach(ne),M.forEach(ne),we.forEach(ne),G.forEach(ne),f=Ae(oe),x=he(oe,"DIV",{class:!0});var q=pe(x);k=Oe(q,r[14]),q.forEach(ne),N=Ae(oe),C=he(oe,"DIV",{class:!0,"data-tree-container":!0});var X=pe(C);A&&A.l(X),H=Ae(X),$=qr(X,!1),X.forEach(ne),oe.forEach(ne),this.h()},h(){ee(i,"class","mr-2 text-sm font-medium text-gray-700 dark:text-gray-300"),ee(y,"type","number"),ee(y,"min","0"),ee(y,"max","100"),ee(y,"class","w-16 h-8 px-3 py-1 text-sm border border-blue-200 dark:border-blue-800 rounded-md bg-white dark:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"),ee(E,"class","ml-1 text-sm text-gray-700 dark:text-gray-300"),ee(l,"class","flex items-center"),ee(S,"id","monthSelector"),ee(S,"class","h-8 px-3 py-1 min-w-[130px] border border-blue-200 dark:border-blue-800 rounded-md bg-white dark:bg-gray-800 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"),r[1]===void 0&&ma(()=>r[43].call(S)),ee(m,"class","ml-auto"),ee(a,"class","flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3"),ee(t,"class","controls-section mb-6 p-4 rounded-lg bg-blue-50 dark:bg-blue-950/30 border border-blue-200 dark:border-blue-900/50 shadow-sm"),ee(x,"class","hidden"),$.a=null,ee(C,"class","analysis-content rounded-lg border border-blue-200 dark:border-blue-800 overflow-hidden bg-white dark:bg-gray-800 shadow-md shadow-blue-100 dark:shadow-none relative"),ee(C,"data-tree-container","true"),ee(e,"class","mb-6")},m(j,oe){Le(j,e,oe),J(e,t),J(t,a),J(a,l),J(l,i),J(i,n),J(i,u),J(l,w),J(l,y),Pt(y,r[9]),J(l,_),J(l,E),J(a,T),J(a,m),J(m,S);for(let G=0;G<V.length;G+=1)V[G]&&V[G].m(S,null);Oi(S,r[1],!0),J(e,f),J(e,x),J(x,k),J(e,N),J(e,C),A&&A.m(C,null),J(C,H),$.m(Z,C),R=!0,ce||(ge=[tt(y,"input",r[42]),tt(y,"change",r[24]),tt(S,"change",r[43]),tt(S,"change",r[25]),tt(C,"click",r[30])],ce=!0)},p(j,oe){if((!R||oe[0]&32768)&&c!==(c=j[15].t("Significance Threshold")+"")&&Be(n,c),oe[0]&512&&as(y.value)!==j[9]&&Pt(y,j[9]),oe[0]&256){I=tr(j[8]);let G;for(G=0;G<I.length;G+=1){const we=Vo(j,I,G);V[G]?V[G].p(we,oe):(V[G]=is(we),V[G].c(),V[G].m(S,null))}for(;G<V.length;G+=1)V[G].d(1);V.length=I.length}oe[0]&258&&Oi(S,j[1]),(!R||oe[0]&16384)&&Be(k,j[14]),j[6]?A?(A.p(j,oe),oe[0]&64&&Qe(A,1)):(A=os(j),A.c(),Qe(A,1),A.m(C,H)):A&&(Vt(),st(A,1,1,()=>{A=null}),$t())},i(j){R||(Qe(A),R=!0)},o(j){st(A),R=!1},d(j){j&&ne(e),fi(V,j),A&&A.d(),ce=!1,ar(ge)}}}function xh(r){let e,t,a,l,i,c=r[15].t("Account Tree Missing")+"",n,u,w,y=r[15].t("To use the Account Analysis feature, you need to upload an account tree file first.")+"",_,E,p,T,m,S,f,x=r[15].t("Download Template")+"",k,N,C,H,$,Z,R=r[15].t("Upload Account Tree")+"",ce,ge,I,V,A;return{c(){e=de("div"),t=kt("svg"),a=kt("path"),l=Se(),i=de("p"),n=De(c),u=Se(),w=de("p"),_=De(y),E=Se(),p=de("div"),T=de("button"),m=kt("svg"),S=kt("path"),f=Se(),k=De(x),N=Se(),C=de("label"),H=kt("svg"),$=kt("path"),Z=Se(),ce=De(R),ge=Se(),I=de("input"),this.h()},l(j){e=he(j,"DIV",{class:!0});var oe=pe(e);t=St(oe,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var G=pe(t);a=St(G,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),pe(a).forEach(ne),G.forEach(ne),l=Ae(oe),i=he(oe,"P",{class:!0});var we=pe(i);n=Oe(we,c),we.forEach(ne),u=Ae(oe),w=he(oe,"P",{class:!0});var Y=pe(w);_=Oe(Y,y),Y.forEach(ne),E=Ae(oe),p=he(oe,"DIV",{class:!0});var te=pe(p);T=he(te,"BUTTON",{class:!0});var M=pe(T);m=St(M,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var D=pe(m);S=St(D,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),pe(S).forEach(ne),D.forEach(ne),f=Ae(M),k=Oe(M,x),M.forEach(ne),N=Ae(te),C=he(te,"LABEL",{class:!0});var q=pe(C);H=St(q,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var X=pe(H);$=St(X,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),pe($).forEach(ne),X.forEach(ne),Z=Ae(q),ce=Oe(q,R),ge=Ae(q),I=he(q,"INPUT",{type:!0,class:!0,accept:!0}),q.forEach(ne),te.forEach(ne),oe.forEach(ne),this.h()},h(){ee(a,"stroke-linecap","round"),ee(a,"stroke-linejoin","round"),ee(a,"stroke-width","2"),ee(a,"d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"),ee(t,"xmlns","http://www.w3.org/2000/svg"),ee(t,"class","h-12 w-12 mx-auto mb-4 text-gray-400"),ee(t,"fill","none"),ee(t,"viewBox","0 0 24 24"),ee(t,"stroke","currentColor"),ee(i,"class","text-lg font-medium"),ee(w,"class","text-sm mt-1 mb-4"),ee(S,"stroke-linecap","round"),ee(S,"stroke-linejoin","round"),ee(S,"stroke-width","2"),ee(S,"d","M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l2.414 2.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"),ee(m,"xmlns","http://www.w3.org/2000/svg"),ee(m,"class","h-5 w-5 mr-2"),ee(m,"fill","none"),ee(m,"viewBox","0 0 24 24"),ee(m,"stroke","currentColor"),ee(T,"class","px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition flex items-center"),ee($,"stroke-linecap","round"),ee($,"stroke-linejoin","round"),ee($,"stroke-width","2"),ee($,"d","M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"),ee(H,"xmlns","http://www.w3.org/2000/svg"),ee(H,"class","h-5 w-5 mr-2"),ee(H,"fill","none"),ee(H,"viewBox","0 0 24 24"),ee(H,"stroke","currentColor"),ee(I,"type","file"),ee(I,"class","hidden"),ee(I,"accept",".xlsx,.xls,.csv"),ee(C,"class","px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition cursor-pointer flex items-center"),ee(p,"class","flex justify-center space-x-3"),ee(e,"class","text-center py-12 bg-white dark:bg-gray-800 rounded-lg shadow")},m(j,oe){Le(j,e,oe),J(e,t),J(t,a),J(e,l),J(e,i),J(i,n),J(e,u),J(e,w),J(w,_),J(e,E),J(e,p),J(p,T),J(T,m),J(m,S),J(T,f),J(T,k),J(p,N),J(p,C),J(C,H),J(H,$),J(C,Z),J(C,ce),J(C,ge),J(C,I),V||(A=[tt(T,"click",r[27]),tt(I,"change",r[41])],V=!0)},p(j,oe){oe[0]&32768&&c!==(c=j[15].t("Account Tree Missing")+"")&&Be(n,c),oe[0]&32768&&y!==(y=j[15].t("To use the Account Analysis feature, you need to upload an account tree file first.")+"")&&Be(_,y),oe[0]&32768&&x!==(x=j[15].t("Download Template")+"")&&Be(k,x),oe[0]&32768&&R!==(R=j[15].t("Upload Account Tree")+"")&&Be(ce,R)},i:dt,o:dt,d(j){j&&ne(e),V=!1,ar(A)}}}function Eh(r){let e,t,a;return t=new hr({props:{className:"size-8"}}),{c(){e=de("div"),fr(t.$$.fragment),this.h()},l(l){e=he(l,"DIV",{class:!0});var i=pe(e);ur(t.$$.fragment,i),i.forEach(ne),this.h()},h(){ee(e,"class","flex justify-center items-center h-64")},m(l,i){Le(l,e,i),cr(t,e,null),a=!0},p:dt,i(l){a||(Qe(t.$$.fragment,l),a=!0)},o(l){st(t.$$.fragment,l),a=!1},d(l){l&&ne(e),lr(t)}}}function is(r){let e,t=r[70]+"",a,l;return{c(){e=de("option"),a=De(t),this.h()},l(i){e=he(i,"OPTION",{});var c=pe(e);a=Oe(c,t),c.forEach(ne),this.h()},h(){e.__value=l=r[70],Pt(e,e.__value)},m(i,c){Le(i,e,c),J(e,a)},p(i,c){c[0]&256&&t!==(t=i[70]+"")&&Be(a,t),c[0]&256&&l!==(l=i[70])&&(e.__value=l,Pt(e,e.__value))},d(i){i&&ne(e)}}}function os(r){let e,t,a,l,i,c=r[15].t("Loading...")+"",n,u;return a=new hr({props:{className:"size-10"}}),{c(){e=de("div"),t=de("div"),fr(a.$$.fragment),l=Se(),i=de("p"),n=De(c),this.h()},l(w){e=he(w,"DIV",{class:!0});var y=pe(e);t=he(y,"DIV",{class:!0});var _=pe(t);ur(a.$$.fragment,_),l=Ae(_),i=he(_,"P",{class:!0});var E=pe(i);n=Oe(E,c),E.forEach(ne),_.forEach(ne),y.forEach(ne),this.h()},h(){ee(i,"class","mt-2 text-gray-600 dark:text-gray-400"),ee(t,"class","flex flex-col items-center"),ee(e,"class","absolute inset-0 bg-white/60 dark:bg-gray-900/60 flex items-center justify-center z-10")},m(w,y){Le(w,e,y),J(e,t),cr(a,t,null),J(t,l),J(t,i),J(i,n),u=!0},p(w,y){(!u||y[0]&32768)&&c!==(c=w[15].t("Loading...")+"")&&Be(n,c)},i(w){u||(Qe(a.$$.fragment,w),u=!0)},o(w){st(a.$$.fragment,w),u=!1},d(w){w&&ne(e),lr(a)}}}function Th(r){let e,t,a,l,i,c,n=r[16].isOpen&&Go(r);const u=[wh,gh,mh,ph],w=[];function y(_,E){return _[2]==="main"?0:_[2]==="transactions"?1:_[2]==="chart"?2:_[2]==="analysis"?3:-1}return~(l=y(r))&&(i=w[l]=u[l](r)),{c(){n&&n.c(),e=Se(),t=Se(),a=de("div"),i&&i.c(),this.h()},l(_){n&&n.l(_),e=Ae(_),ua("svelte-ktehck",Ho.head).forEach(ne),t=Ae(_),a=he(_,"DIV",{class:!0});var p=pe(a);i&&i.l(p),p.forEach(ne),this.h()},h(){Ho.title="Account Analysis",ee(a,"class","page-container w-full max-w-7xl mx-auto px-4 py-6 svelte-126e3bb")},m(_,E){n&&n.m(_,E),Le(_,e,E),Le(_,t,E),Le(_,a,E),~l&&w[l].m(a,null),c=!0},p(_,E){_[16].isOpen?n?(n.p(_,E),E[0]&65536&&Qe(n,1)):(n=Go(_),n.c(),Qe(n,1),n.m(e.parentNode,e)):n&&(Vt(),st(n,1,1,()=>{n=null}),$t());let p=l;l=y(_),l===p?~l&&w[l].p(_,E):(i&&(Vt(),st(w[p],1,1,()=>{w[p]=null}),$t()),~l?(i=w[l],i?i.p(_,E):(i=w[l]=u[l](_),i.c()),Qe(i,1),i.m(a,null)):i=null)},i(_){c||(Qe(n),Qe(i),c=!0)},o(_){st(n),st(i),c=!1},d(_){_&&(ne(e),ne(t),ne(a)),n&&n.d(_),~l&&w[l].d()}}}function ei(r){if(!r||!r.name)return!1;const e=r.name;return/^\d/.test(e)||/\(A\d+\)/.test(e)||/\[A\d+\]/.test(e)||r.accounts&&Array.isArray(r.accounts)&&r.accounts.length>0?!0:r.level>=2&&(!r.children||Object.keys(r.children).length===0)?["account","acct","a/c","",""].some(a=>e.toLowerCase().includes(a)):!1}function sa(r){if(!r)return console.error("Invalid node provided to structureAccountTree"),{name:"Unknown",level:1,currentTotal:0,previousTotal:0,children:{}};const e={name:r.name||"Unknown",level:r.level||1,currentTotal:0,previousTotal:0,children:{}};return r.children&&Object.entries(r.children).forEach(([t,a])=>{e.children[t]=sa(a)}),e}function ui(r,e,t,a=[]){if(!t)return null;const l=t.name||"",c=l.split(" ")[0];if(console.log("Searching for account in tree:",{searchingFor:{account:r,accountName:e},currentNode:{nodeName:l,nodeAccountNumber:c,level:t.level},currentPath:a}),c===r||l===r){const n=[...a,l];return console.log("Found exact account match:",{account:r,foundPath:n}),n}if(l.includes(r)||e&&l.includes(e)){const n=[...a,l];return console.log("Found account number/name in node name:",{account:r,nodeName:l,foundPath:n}),n}if(t.accounts&&Array.isArray(t.accounts)&&t.accounts.some(u=>u===r||u.startsWith(r+" ")||e&&u.includes(e))){const u=[...a,l];return console.log("Found account in accounts array:",{account:r,foundPath:u}),u}if(t.children)for(const[n,u]of Object.entries(t.children)){const w=a.length===0&&t.level===0?[]:[...a,l],y=ui(r,e,u,w);if(y)return console.log("Found account in child node:",{account:r,childKey:n,childLevel:u.level,foundPath:y}),y}return null}function aa(r){r&&(r.currentTotal=0,r.previousTotal=0,r.children&&Object.values(r.children).forEach(e=>{aa(e)}))}function Ah(r,e,t,a){let l=r,i=1;if(console.log("Updating category totals:",{path:e,currentAmount:t,previousAmount:a,rootNodeName:r==null?void 0:r.name}),!e||e.length===0){console.log("Empty path provided to updateCategoryTotals");return}let c=0;e[0]===(r==null?void 0:r.name)&&(console.log("First path element matches root node name, skipping:",{rootNodeName:r.name,firstPathElement:e[0]}),c=1);for(let n=c;n<e.length;n++){const u=e[n];if(!u){console.log("Undefined category in path",{index:n,path:e});continue}u.startsWith("-")&&(i*=-1,console.log("Negating values for category:",{category:u,multiplier:i}));const w=(u.startsWith("-"),u);if(l.children&&(l.children[u]||l.children[w])){const y=l.children[u]||l.children[w];n===e.length-1&&(y.currentTotal+=t*i,y.previousTotal+=a*i,console.log("Updated leaf node totals:",{category:u,newTotals:{currentTotal:y.currentTotal,previousTotal:y.previousTotal},addedAmount:{current:t*i,previous:a*i}})),l=y}else{console.log("Category not found in children",{category:u,pathIndex:n,availableChildren:l.children?Object.keys(l.children):"none"});return}}}function la(r){if(!r)return console.log("Null category in rollUpCategoryTotals"),{current:0,previous:0};let e=0,t=0;return!r.children||Object.keys(r.children).length===0?(e=r.currentTotal,t=r.previousTotal,{current:e,previous:t}):(Object.entries(r.children).forEach(([a,l])=>{const i=la(l),c=a.startsWith("-")||l.name&&l.name.startsWith("-")?-1:1;e+=i.current*c,t+=i.previous*c}),r.currentTotal=e,r.previousTotal=t,{current:e,previous:t})}function lt(r){return r==null?"-":new Intl.NumberFormat("en-US",{minimumFractionDigits:0,maximumFractionDigits:0}).format(r)}function ss(r){return r==null?"-":`${r>0?"+":""}${r.toFixed(1)}%`}function zr(r){return r?String(r).replace(/\n/g,"<br>"):""}function Sh(r,e,t){let a,l,i,c,n;sn(r,_a,W=>t(50,n=W));const u=fa("i18n");sn(r,u,W=>t(15,i=W));const w=va({isOpen:!1,title:"",content:"",isLoading:!1,company:"",account:"",isEditing:!1,editText:""});sn(r,w,W=>t(16,c=W));function y(W,re,fe){w.update(be=>({...be,isOpen:!0,title:W,isLoading:!0,company:re,account:fe,isEditing:!1,editText:""}))}function _(){w.update(W=>({...W,isOpen:!1}))}function E(){w.update(W=>{const re=W.isEditing?W.editText:W.content.replace(/<br>/g,`
`);return{...W,isEditing:!W.isEditing,editText:re}})}function p(){w.update(W=>{if(!W.isEditing)return W;const re=zr(W.editText);if(W.company&&W.account&&C){const fe=`${W.company}-${W.account}-${C}`,be=`${W.company}-${W.account}`;t(37,Z={...Z,[fe]:W.editText,[be]:W.editText}),h(W.company,W.account,W.editText).then(()=>{Je.success(i.t("Analysis saved"))}).catch(Te=>{console.error("Error saving analysis:",Te),Je.error(i.t("Failed to save analysis"))})}return{...W,content:re,isEditing:!1}})}let T={baseUrl:Di,userToken:"",languageLocal:"en"};const m=Di;let S=!1,f=null,x=null,k={},N={},C=null,H=[],$=10,Z={},R="main",ce=[],ge="",I=null,V="",A=null,j="",oe=!1,G=!1,we={month:null,company:null,account:null,timestamp:0},Y=!1;ha(async()=>{console.log("Current user language:",i.language),console.log("Current user API key:",n);try{t(5,T=await ka(u)),console.log("API config initialized:",T)}catch(re){console.error("Failed to initialize API config:",re)}if(console.log("Component mounted, loading account tree..."),te(),document.addEventListener("select-month",re=>{if(console.log("Custom select-month event received:",re.detail),Y){console.log("Already processing an event, skipping new event");return}if(re.detail){const{month:fe,company:be,account:Te}=re.detail;console.log("Extracted values from event:",{month:fe,company:be||"null/undefined",account:Te||"null/undefined",typeofCompany:typeof be,typeofAccount:typeof Te});const xe=Date.now();if(we.month===fe&&we.company===be&&we.account===Te&&xe-we.timestamp<500){console.log("Ignoring duplicate event within debounce period");return}Y=!0,we={month:fe,company:be,account:Te,timestamp:xe},fe?(console.log("Setting selected month to:",fe),t(1,C=fe),t(13,oe=!0),setTimeout(async()=>{try{if(be&&Te&&be!=="undefined"&&Te!=="undefined"){console.log("Using company/account from event:",be,Te);const Re=`${be}-${Te}-${fe}`,Me=`${be}-${Te}`;console.log("Analysis keys to check:",{analysisKey:Re,generalKey:Me,hasMonthSpecificAnalysis:!!Z[Re],hasGeneralAnalysis:!!Z[Me]}),await O(be,Te)}else if(I&&I.company&&I.account){console.log("Using company/account from chartData:",I.company,I.account);const Re=`${I.company}-${I.account}-${fe}`,Me=`${I.company}-${I.account}`;console.log("Analysis keys to check:",{analysisKey:Re,generalKey:Me,hasMonthSpecificAnalysis:!!Z[Re],hasGeneralAnalysis:!!Z[Me]}),await O(I.company,I.account)}else console.error("Cannot fetch analysis: missing company or account information",{fromEvent:{company:be,account:Te},fromChartData:I?{company:I.company,account:I.account}:"chartData is null",chartData:I}),t(13,oe=!1)}finally{console.log("Finished processing select-month event"),Y=!1}},50)):Y=!1}else Y=!1}),setTimeout(()=>{const re=document.getElementById("monthSelector");re&&(console.log("Adding event listener to month selector"),re.addEventListener("change",fe=>{R==="chart"&&I&&(console.log("Month selector changed, updating chart"),setTimeout(()=>ae(),50))}))},500),typeof window<"u"&&!window.hasOwnProperty("Chart")){const re=document.createElement("script");re.src="https://cdn.jsdelivr.net/npm/chart.js",re.async=!0,document.head.appendChild(re)}const W=new MutationObserver(re=>{re.forEach(fe=>{if(fe.type==="attributes"&&fe.attributeName==="data-ready"){const be=document.getElementById("trendChart");be&&be.getAttribute("data-ready")==="true"&&ae()}})});setTimeout(()=>{const re=document.getElementById("trendChart");re&&(W.observe(re,{attributes:!0}),re.getAttribute("data-ready")==="true"&&ae())},200)});async function te(){try{t(6,S=!0),console.log("=== REQUEST ==="),console.log(`URL: ${m}/proxy/api/account_tree`),console.log("Method: GET"),console.log("Headers:",{"Content-Type":"application/json","Accept-Language":T.languageLocal,Authorization:`Bearer ${T.userToken}`}),console.log(`
`);const W=await fetch(`${m}/proxy/api/account_tree`,{method:"GET",headers:{"Content-Type":"application/json","Accept-Language":T.languageLocal,Authorization:`Bearer ${T.userToken}`}});console.log("=== RESPONSE ==="),console.log("Status:",W.status),console.log("Headers:",Object.fromEntries([...W.headers.entries()]));const re=await W.json();console.log("Body:",re),console.log(`
`),re.success&&re.data?(console.log("Account tree loaded successfully"),t(7,x=re.data),M(x),await D()):(console.error("Account tree response indicates failure:",re.error||"Unknown error"),t(7,x=null))}catch(W){console.error("Error loading account tree:",W),Je.error(i.t("Failed to load account tree")),t(7,x=null)}finally{t(6,S=!1)}}function M(W){if(!W)return;const re=Object.keys(W);t(35,k={}),t(36,N={}),re.length>0&&(re.forEach(fe=>{t(35,k[fe]=!0,k),Object.keys(W).forEach(Te=>{const xe=W[Te];if(xe&&typeof xe=="object"){const Ce=`${fe}/${Te}`;t(36,N[Ce]=!0,N),xe.children&&Object.entries(xe.children).forEach(([Re,Me])=>{const je=(Me==null?void 0:Me.name)||Re;if(je.includes("Operating")||je.includes("Profit")||je.includes("Revenue")||je.includes("Sales")||je.includes("Costs")||je.includes("Expenses")){const Ie=`${fe}/${Te}/${Re}`;t(36,N[Ie]=!0,N),console.log(`Auto-expanded category: ${je}, Path: ${Ie}`)}})}})}),console.log("Initialized expanded states:",{companies:Object.keys(k),categories:Object.keys(N).length}))}async function D(){if(!x)return console.log("fetchData: No account tree available, returning early"),Promise.resolve();try{const W=C?`${m}/proxy/api/is_analysis?month=${C}`:`${m}/proxy/api/is_analysis`;console.log("=== REQUEST ==="),console.log(`URL: ${W}`),console.log("Method: GET"),console.log("Headers:",{"Content-Type":"application/json","Accept-Language":T.languageLocal,Authorization:`Bearer ${T.userToken}`}),console.log(`
`);const re=await fetch(W,{method:"GET",headers:{"Content-Type":"application/json","Accept-Language":T.languageLocal,Authorization:`Bearer ${T.userToken}`}});console.log("=== RESPONSE ==="),console.log("Status:",re.status),console.log("Headers:",Object.fromEntries([...re.headers.entries()]));const fe=await re.json();if(console.log("Body:",fe),console.log(`
`),fe.success&&fe.data)return console.log("IS analysis data loaded successfully"),t(0,f=q(fe.data)),t(8,H=fe.data.monthOptions||[]),C||t(1,C=fe.data.selectedMonth),console.log("Selected month:",C),console.log("Available months:",H),console.log("Processed data:",f),Promise.resolve();throw console.error("IS analysis response indicates failure:",fe.error||"Unknown error"),new Error(fe.error||"Invalid data structure received")}catch(W){return console.error("Error loading IS analysis data:",W),Je.error(i.t("Failed to load analysis data")),Promise.reject(W)}}function q(W){if(!x)return{companies:{}};try{const re={companies:{}};return console.log("Processing data with account tree:",{companiesCount:Object.keys(W.companies||{}).length,hasAccountTree:!!x}),Object.entries(W.companies||{}).forEach(([fe,be])=>{re.companies[fe]={accounts:{},categories:sa(X()),currentTotal:0,previousTotal:0},console.log("Processing company data:",{company:fe,accountsCount:Object.keys(be.accounts||{}).length}),Object.entries(be.accounts||{}).forEach(([xe,Ce])=>{const Re=ui(xe,Ce.name,X());console.log("Account category path found:",{account:xe,accountName:Ce.name,categoryPath:Re||"Not found"}),Re?re.companies[fe].accounts[xe]={...Ce,categoryPath:Re}:console.log("No category path found for account",{account:xe,accountName:Ce.name})}),aa(re.companies[fe].categories);const Te=[];Object.entries(be.accounts||{}).forEach(([xe,Ce])=>{const Re=ui(xe,Ce.name,X());Re&&Te.push({account:xe,accountName:Ce.name,categoryPath:Re,currentTotal:Ce.currentTotal||0,previousTotal:Ce.previousTotal||0})}),Te.sort((xe,Ce)=>Ce.categoryPath.length-xe.categoryPath.length),Te.forEach(({account:xe,accountName:Ce,categoryPath:Re,currentTotal:Me,previousTotal:je})=>{Ah(re.companies[fe].categories,Re,Me,je)}),la(re.companies[fe].categories)}),console.log("Processed data structure:",re),re}catch(re){return console.error("Error processing data with tree:",re),{companies:{}}}}function X(){if(!x||typeof x!="object")return console.error("Invalid account tree structure",{tree:x}),null;const W=Object.keys(x);if(W.length===0)return console.error("Account tree has no root nodes",{tree:x}),null;const re={name:"Root",level:0,children:{}};return W.forEach(fe=>{x[fe]&&(re.children[fe]=x[fe])}),console.log("Using merged root node for account tree:",{rootKeys:W,childrenCount:Object.keys(re.children).length,childrenNames:Object.keys(re.children).join(", ")}),re}function ie(W){if(!W){console.error("Invalid company name in toggleCompany");return}console.log("Toggling company:",W,"Current state:",k[W]);const re={...k};re[W]=!k[W],t(35,k=re),console.log("New expanded state for company:",W,k[W]),t(14,a=Date.now().toString()),setTimeout(()=>{const fe=document.querySelector('[data-tree-container="true"]');fe?fe.innerHTML=L():console.error("Analysis content container not found")},10)}function z(W){if(!W||W==="Unknown"||W==="undefined"){console.error("Invalid category path in toggleCategory:",W);return}console.log("Toggling category:",W,"Current state:",N[W]);const re={...N};re[W]=!N[W],t(36,N=re),console.log("New expanded state for category:",W,N[W]),t(14,a=Date.now().toString()),setTimeout(()=>{const fe=document.querySelector('[data-tree-container="true"]');fe?fe.innerHTML=L():console.error("Analysis content container not found")},10)}function v(W){const re=W.target.value.replace(/^0+/,"")||"0";t(9,$=Number(re))}function g(W){t(1,C=W.target.value),console.log("Month changed to:",C),t(6,S=!0),D().then(()=>{console.log("Data fetched for new month, updating UI"),t(14,a=Date.now().toString()),R==="chart"&&I&&(console.log("Updating chart with new month:",C),setTimeout(()=>ae(),50)),t(6,S=!1)})}async function U(W,re,fe,be=!1){try{const Te=`${m}/proxy/api/transactions?company=${encodeURIComponent(W)}&account=${encodeURIComponent(re)}&month=${encodeURIComponent(fe)}`;console.log("=== REQUEST ==="),console.log(`URL: ${Te}`),console.log("Method: GET"),console.log("Headers:",{"Content-Type":"application/json","Accept-Language":T.languageLocal,Authorization:`Bearer ${T.userToken}`}),console.log(`
`);const xe=await fetch(Te,{method:"GET",headers:{"Content-Type":"application/json","Accept-Language":T.languageLocal,Authorization:`Bearer ${T.userToken}`}});console.log("=== RESPONSE ==="),console.log("Status:",xe.status),console.log("Headers:",Object.fromEntries([...xe.headers.entries()]));const Ce=await xe.json();if(console.log("Body:",Ce),console.log(`
`),Ce.success&&Ce.data)t(10,ce=Ce.data.transactions),t(11,ge=`${W} - ${re} - ${fe} ${be?"(Previous)":"(Current)"}`),t(2,R="transactions");else throw console.error("Transactions response indicates failure:",Ce.error||"Unknown error"),new Error(Ce.error||"Failed to load transactions")}catch(Te){console.error("Error loading transactions:",Te),Je.error(i.t("Failed to load transactions"))}}async function P(W,re,fe){console.log("handleAccountClick called with:",{company:W,account:re,accountName:fe});try{const be=`${m}/proxy/api/account_trend?company=${encodeURIComponent(W)}&account=${encodeURIComponent(re)}`;console.log("=== REQUEST ==="),console.log(`URL: ${be}`),console.log("Method: GET"),console.log("Headers:",{"Content-Type":"application/json","Accept-Language":T.languageLocal,Authorization:`Bearer ${T.userToken}`}),console.log(`
`);const Te=await fetch(be,{method:"GET",headers:{"Content-Type":"application/json","Accept-Language":T.languageLocal,Authorization:`Bearer ${T.userToken}`}});console.log("=== RESPONSE ==="),console.log("Status:",Te.status),console.log("Headers:",Object.fromEntries([...Te.headers.entries()]));const xe=await Te.json();if(console.log("Body:",xe),console.log(`
`),xe.success&&xe.data)t(3,I={...xe.data,company:W,account:re}),console.log("ChartData set with explicit company/account:",I),t(4,V=`${W} - ${re} - ${fe}`),t(2,R="chart"),Z[`${W}-${re}`]||O(W,re);else throw console.error("Account trend response indicates failure:",xe.error||"Unknown error"),new Error(xe.error||"Failed to load trend data")}catch(be){console.error("Error loading trend data:",be),Je.error(i.t("Failed to load trend data"))}}async function O(W,re){var be,Te,xe,Ce;if(console.log("Fetching auto analysis for:",W,re,"with selected month:",C),!W||!re||W==="undefined"||re==="undefined"){console.error("Invalid company or account for auto analysis:",{company:W,account:re}),Je.error(i.t("Missing company or account information")),w.update(Re=>({...Re,isLoading:!1,content:`<p class="text-red-500">${i.t("Missing company or account information")}</p>`}));return}if(!C){console.error("Missing selected month for analysis"),Je.error(i.t("Missing month information")),w.update(Re=>({...Re,isLoading:!1,content:`<p class="text-red-500">${i.t("Missing month information")}</p>`}));return}if(!((xe=(Te=(be=f==null?void 0:f.companies)==null?void 0:be[W])==null?void 0:Te.accounts)!=null&&xe[re])){console.debug("Data for auto analysis not available yet:",{company:W,account:re,dataAvailable:!!f,companiesAvailable:f?Object.keys(f.companies||{}):[],accountsAvailable:(Ce=f==null?void 0:f.companies)!=null&&Ce[W]?Object.keys(f.companies[W].accounts||{}):[]});const Re=re;y(`${W} - ${re} - ${Re}`,W,re);const Me={name:Re,currentTotal:0,previousTotal:0,months:[{previousMonth:""}]};try{await B(W,re,Me)}catch(je){console.debug("Error in analysis with fallback data:",je),w.update(Ve=>({...Ve,isLoading:!1,content:`<p>${i.t("Analysis data not available for this account yet. Please try again later.")}</p>`}))}return}const fe=f.companies[W].accounts[re];y(`${W} - ${re} - ${fe.name}`,W,re),await B(W,re,fe)}async function B(W,re,fe){var Te,xe;const be=setTimeout(()=>{w.update(Ce=>Ce.isLoading?(console.log("Analysis request timed out after 15 seconds"),Je.error(i.t("Analysis request timed out. Please try again.")),{...Ce,isLoading:!1,content:`<p class="text-red-500">${i.t("Analysis request timed out. Please try again.")}</p>`}):Ce)},15e3);try{console.log("Account data for analysis:",fe);const Ce={company:W,account:re,accountName:fe.name,currentMonth:C,previousMonth:(xe=(Te=fe.months)==null?void 0:Te[0])==null?void 0:xe.previousMonth,changePercentage:(fe.currentTotal-fe.previousTotal)/Math.abs(fe.previousTotal||1)*100};console.log("Auto analysis request data:",Ce);const Re=new AbortController,Me=setTimeout(()=>Re.abort(),1e4);let je,Ve;try{if(je=await fetch(`${m}/proxy/api/auto_analysis`,{method:"POST",headers:{"Content-Type":"application/json","Accept-Language":T.languageLocal,Authorization:`Bearer ${T.userToken}`},body:JSON.stringify(Ce),signal:Re.signal}),clearTimeout(Me),console.log("Auto analysis response status:",je.status),!je.ok)throw new Error(`Server responded with ${je.status}: ${je.statusText}`);Ve=await je.json(),console.log("Auto analysis response data:",Ve)}catch(Ie){Ie.name==="AbortError"?(console.error("Analysis request aborted due to timeout"),Je.error(i.t("Analysis request timed out")),w.update(We=>({...We,isLoading:!1,content:`<p class="text-red-500">${i.t("Analysis request timed out")}</p>`}))):(console.error("Error during fetch:",Ie),Je.error(i.t("Error communicating with server")),w.update(We=>({...We,isLoading:!1,content:`<p class="text-red-500">${i.t("Error communicating with server")}</p>`}))),clearTimeout(be);return}if(Ve&&Ve.success){console.log("Auto analysis generated successfully");const Ie=typeof Ve.analysis=="string"?Ve.analysis:String(Ve.analysis||""),We=`${W}-${re}-${C}`;t(37,Z={...Z,[We]:Ie,[`${W}-${re}`]:Ie}),console.log("Analysis stored with keys:",{monthSpecificKey:We,generalKey:`${W}-${re}`}),w.update(at=>({...at,isLoading:!1,content:zr(Ie),editText:Ie})),t(12,j=Ie),A=We}else{console.error("Auto analysis response indicates failure:",(Ve==null?void 0:Ve.error)||"Unknown error"),Je.error(i.t("Failed to generate analysis")),w.update(at=>({...at,isLoading:!1,content:`<p class="text-red-500">${i.t("Failed to generate analysis")}</p>`}));const Ie=`${W}-${re}-${C}`,We=`${W}-${re}`;t(12,j=Z[Ie]||Z[We]||""),A=Ie}}catch(Ce){console.error("Error generating analysis:",Ce),Je.error(i.t("Error generating analysis")),w.update(je=>({...je,isLoading:!1,content:`<p class="text-red-500">${i.t("Error generating analysis")}</p>`}));const Re=`${W}-${re}-${C}`,Me=`${W}-${re}`;t(12,j=Z[Re]||Z[Me]||""),A=Re}finally{clearTimeout(be)}}async function se(){if(!A)return;const W=A.split("-"),re=W[0],fe=W[1],be=W.length>2?W.slice(2).join("-"):C;try{const Te=`${re}-${fe}-${be}`,xe=`${re}-${fe}`;t(37,Z={...Z,[Te]:j,[xe]:j}),await h(re,fe,j),t(2,R="main"),Je.success(i.t("Analysis saved"))}catch(Te){console.error("Error saving analysis:",Te),Je.error(i.t("Failed to save analysis"))}}async function h(W,re,fe){try{const be=f.companies[W].accounts[re],xe=await(await fetch(`${m}/proxy/api/update_graph_analysis`,{method:"POST",headers:{"Content-Type":"application/json","Accept-Language":T.languageLocal,Authorization:`Bearer ${T.userToken}`},body:JSON.stringify({company:W,account:re,accountName:be.name,currentMonth:C,llm_analysis:fe})})).json();if(!xe.success)throw new Error(xe.error||"Failed to update graph analysis")}catch(be){throw console.error("Error updating graph node analysis:",be),be}}async function Q(){try{const W=await fetch(`${m}/proxy/api/download_account_tree_template`,{method:"GET",headers:{"Content-Type":"application/json","Accept-Language":T.languageLocal,Authorization:`Bearer ${T.userToken}`}});if(!W.ok)throw new Error("Failed to download template");const re=await W.blob(),fe=window.URL.createObjectURL(re),be=document.createElement("a");be.style.display="none",be.href=fe,be.download="account_tree_template.xlsx",document.body.appendChild(be),be.click(),setTimeout(()=>{window.URL.revokeObjectURL(fe),document.body.removeChild(be)},100),Je.success(i.t("Template downloaded"))}catch(W){console.error("Error downloading template:",W),Je.error(i.t("Failed to download template"))}}function b(W){return W?Math.abs(W)>=$:!1}function o(W){return W===1?`<span title="${i.t("Above normal range")}"> +</span>`:W===-1?`<span title="${i.t("Below normal range")}"> -</span>`:W===0?`<span title="${i.t("Within normal range")}"></span>`:"-"}function s(){return`
      <div class="table-header w-full grid grid-cols-5 text-sm font-semibold py-2 px-3 bg-blue-100 dark:bg-blue-900/30 border-b border-blue-200 dark:border-blue-900/50 rounded-t-lg">
        <div class="col-span-1">${i.t("Account")}</div>
        <div class="text-right pr-4">${i.t("Current")}</div>
        <div class="text-right pr-4">${i.t("Previous")}</div>
        <div class="text-right pr-4">${i.t("Variance")}</div>
        <div class="text-right pr-4">${i.t("Change %")}</div>
      </div>
    `}function d(W,re,fe,be){var Ce,Re;const Te=be.previousTotal!==0?(be.currentTotal-be.previousTotal)/Math.abs(be.previousTotal)*100:0,xe=b(Te);return`
      <div class="account-row w-full grid grid-cols-5 text-sm py-2 px-3 border-b border-blue-100 dark:border-blue-900/20 hover:bg-blue-50 dark:hover:bg-blue-900/10 ${xe?"bg-yellow-50 dark:bg-yellow-900/10":""}">
        <div class="flex items-center" style="padding-left: 16px;">
          <span class="font-mono text-xs mr-2 text-gray-500 dark:text-gray-400">${re}</span>
          <span class="cursor-pointer hover:text-blue-600 dark:hover:text-blue-400" 
             data-action="account-click" 
             data-company="${W}" 
             data-account="${re}" 
             data-name="${fe}">
            ${fe}
          </span>
        </div>
        <div class="text-right pr-4 cursor-pointer hover:text-blue-600 dark:hover:text-blue-400" 
           data-action="transactions" 
           data-company="${W}" 
           data-account="${re}" 
           data-month="${C}">
          ${lt(be.currentTotal)}
        </div>
        <div class="text-right pr-4 cursor-pointer hover:text-blue-600 dark:hover:text-blue-400" 
           data-action="transactions-prev" 
           data-company="${W}" 
           data-account="${re}" 
           data-month="${((Re=(Ce=be.months)==null?void 0:Ce[0])==null?void 0:Re.previousMonth)||""}">
          ${lt(be.previousTotal)}
        </div>
        <div class="text-right pr-4">
          ${lt(be.currentTotal-be.previousTotal)}
        </div>
        <div class="text-right pr-4 ${xe?"text-red-600 dark:text-red-400 font-semibold":""}">
          ${ss(Te)}
          <i class="edit-icon ml-2 cursor-pointer" 
             data-action="show-analysis" 
             data-company="${W}" 
             data-account="${re}"
             data-name="${fe}"
             title="${i.t("View Analysis")}">
            
          </i>
        </div>
      </div>
    `}function F(W,re,fe,be){var We,at,Xe;if(!re)return"";let Te="";const xe=re.name||"";if(!xe)return console.error("Category has no name:",re),"";if(fe===0&&xe==="Root")return console.log("Rendering root node children as categories:",xe),re.children&&Object.entries(re.children).sort((Ke,Ge)=>{const gt=Ke[1].name||Ke[0],ht=Ge[1].name||Ge[0];return gt.includes("Operating Profit")||gt.includes("Profit")?-1:ht.includes("Operating Profit")||ht.includes("Profit")||gt.includes("Operating Costs")||gt.includes("Costs")?1:ht.includes("Operating Costs")||ht.includes("Costs")?-1:String(gt).localeCompare(String(ht))}).forEach(([Ke,Ge])=>{console.log(`Rendering top-level category: ${Ke}`),Te+=F(W,Ge,fe+1,[...be,xe])}),Te;if(fe!==0&&(xe===""||xe.toLowerCase()==="profit"))return console.log("Bypassing profit/loss node:",xe),re.children&&Object.entries(re.children).forEach(([Ze,Ke])=>{Te+=F(W,Ke,fe+1,[...be,xe])}),Te;if(ei(re)){console.log("Rendering account node:",xe);const Ze=xe.split(" ")[0],Ke=xe.substring(Ze.length+1).trim(),Ge=((Xe=(at=(We=f==null?void 0:f.companies)==null?void 0:We[W])==null?void 0:at.accounts)==null?void 0:Xe[Ze])||{currentTotal:re.currentTotal||0,previousTotal:re.previousTotal||0};return d(W,Ze,Ke,Ge)}const Ce=[...be,xe].join("/"),Re=!!N[Ce],Me=xe.startsWith("-")?xe.substring(1):xe;console.log(`Rendering category: ${xe}, Path: ${Ce}, Level: ${fe}`);const je=re.currentTotal||0,Ve=re.previousTotal||0,Ie=Ve!==0&&Ve!=null?(je-Ve)/Math.abs(Ve)*100:0;if(Te+=`
      <div class="category-section">
        <div 
          class="category-header w-full grid grid-cols-5 text-sm py-2 px-3 
          ${fe>0?"bg-blue-50/70 dark:bg-blue-900/20":"bg-blue-100 dark:bg-blue-900/30"} 
          cursor-pointer hover:bg-blue-100 dark:hover:bg-blue-900/40 border-b border-blue-200 dark:border-blue-900/30"
          data-action="toggle-category" 
          data-path="${Ce}"
          style="padding-left: ${fe*20+12}px">
          <div class="flex items-center">
            <div class="toggle-icon mr-2 text-blue-600 dark:text-blue-400">${Re?"":""}</div>
            <div class="font-medium text-blue-800 dark:text-blue-300">${Me}</div>
          </div>
          <div class="text-right pr-4">${lt(je)}</div>
          <div class="text-right pr-4">${lt(Ve)}</div>
          <div class="text-right pr-4">${lt(je-Ve)}</div>
          <div class="text-right pr-4 ${b(Ie)?"text-red-600 dark:text-red-400 font-semibold":""}">
            ${ss(Ie)}
          </div>
        </div>
    `,Re&&re.children){Te+='<div class="category-content">';try{Object.entries(re.children).sort((Ke,Ge)=>{const gt=ei(Ke[1]),ht=ei(Ge[1]);if(gt&&!ht)return 1;if(!gt&&ht)return-1;const It=Ke[1].name||Ke[0],Mt=Ge[1].name||Ge[0];return String(It).localeCompare(String(Mt))}).forEach(([Ke,Ge])=>{Ge&&(Te+=F(W,Ge,fe+1,[...be,xe]))})}catch(Ze){console.error("Error rendering category children:",Ze),Te+=`<div class="error p-2 text-red-500">Error rendering children: ${Ze.message||"Unknown error"}</div>`}Te+="</div>"}return Te+="</div>",Te}function K(W,re){if(!re)return console.error("Invalid company data:",W),"";console.log("Rendering company:",W,re);const fe=!!k[W];let be=`
      <div class="company-section mb-4">
        <div class="company-header flex items-center justify-between p-3 bg-blue-50 dark:bg-blue-950/30 border border-blue-200 dark:border-blue-900/50 rounded-t-lg cursor-pointer transition duration-150 hover:bg-blue-100 dark:hover:bg-blue-900/50"
             data-action="toggle-company" 
             data-company="${W}">
          <div class="flex items-center">
            <div class="toggle-icon mr-2 text-blue-600 dark:text-blue-400">${fe?"":""}</div>
            <div class="font-bold text-blue-800 dark:text-blue-300">${W}</div>
          </div>
        </div>
    `;return fe&&(be+=`
        <div class="company-content">
          <div class="company-data border border-blue-200 dark:border-blue-900/50 rounded-b-lg bg-white dark:bg-gray-800">
            ${s()}
    `,re.categories&&(be+=F(W,re.categories,0,[])),be+=`
        </div>
      </div>
    `),be+="</div>",be}function L(){if(!x||!f)return console.log("Cannot render tree: missing accountTree or data"),"";let W="";return console.log("Rendering tree structure with data:",f),Object.entries(f.companies||{}).forEach(([re,fe])=>{W+=K(re,fe)}),W}function ue(W){const fe=W.target.closest("[data-action]");if(!fe)return;const be=fe.dataset.action;switch(console.log("Modal action clicked:",be,fe.dataset),be){case"toggle-company":const Te=fe.dataset.company;if(!Te){console.error("No company key provided in toggle-company action");return}console.log("Toggle company clicked for:",Te),ie(Te);break;case"toggle-category":const xe=fe.dataset.path;if(!xe){console.error("No path provided in toggle-category action");return}console.log("Toggle category path:",xe),z(xe);break;case"select-month":const Ce=fe.dataset.month;if(Ce&&I){console.log("Month selected:",Ce),t(1,C=Ce);const wr=`${I.company}-${I.account}-${Ce}`,yr=`${I.company}-${I.account}`;!Z[wr]&&!Z[yr]&&O(I.company,I.account)}break;case"close-popup":t(1,C=null);break;case"account-click":const Re=fe.dataset.company,Me=fe.dataset.account,je=fe.dataset.name;if(console.log("Account click action with data:",{company:Re,account:Me,name:je}),!Re||!Me){console.error("Missing company or account data for account-click action");return}P(Re,Me,je);break;case"transactions":const Ve=fe.dataset.company,Ie=fe.dataset.account,We=fe.dataset.month;U(Ve,Ie,We);break;case"transactions-prev":const at=fe.dataset.company,Xe=fe.dataset.account;let Ze=fe.dataset.month;if(!Ze)if(C){const[wr,yr]=C.split("-").map(Number);let vr=yr-1,Ii=wr;vr===0&&(vr=12,Ii--),Ze=`${Ii}-${vr.toString().padStart(2,"0")}`,console.log("Calculated previous month:",Ze)}else Ze=C;Ze&&U(at,Xe,Ze,!0);break;case"show-analysis":const Ke=fe.dataset.company,Ge=fe.dataset.account,gt=fe.dataset.name;console.log("Show analysis for:",Ke,Ge,gt);const ht=`${Ke} - ${Ge} - ${gt}`,It=`${Ke}-${Ge}-${C}`,Mt=`${Ke}-${Ge}`;if(Z[It]||Z[Mt]){const wr=zr(Z[It]||Z[Mt]),yr=Z[It]||Z[Mt]||"";w.update(vr=>({...vr,isOpen:!0,title:ht,content:wr,isLoading:!1,company:Ke||"",account:Ge||"",isEditing:!1,editText:yr}))}else O(Ke,Ge);break;case"generate-analysis":const Rr=fe.dataset.company,Ir=fe.dataset.account,on=fe.dataset.month;A=`${Rr}-${Ir}-${on}`,O(Rr,Ir);break}}function ve(){console.log("Navigating back from view:",R),t(2,R="main")}function ae(){if(typeof window>"u")return;const W=document.getElementById("trendChart");if(!W||!I)return;const re=W.getAttribute("data-company"),fe=W.getAttribute("data-account");if(console.log("Chart initialization with data attributes:",{company:re,account:fe,hasChartData:!!I,dataReady:W.getAttribute("data-ready"),selectedMonth:C}),typeof Chart>"u"){console.log("Chart.js not loaded yet, trying again in 100ms"),setTimeout(ae,100);return}try{const be=W.getContext("2d");if(!be)return;window.trendChartInstance&&(console.log("Destroying previous chart instance"),window.trendChartInstance.destroy());const Te=I.months.map((Ie,We)=>({month:Ie,value:I.values[We]||0,dateValue:Ie.split("-").map(Number).reduce((at,Xe)=>at*100+Xe,0),originalIndex:We})).sort((Ie,We)=>Ie.dateValue-We.dateValue),xe=Te.map(Ie=>Ie.month),Ce=Te.map(Ie=>Ie.value),Re=xe.map((Ie,We)=>{if(C===Ie)return"#8b5cf6";if(!C&&We===xe.length-1)return"#3b82f6";const at=`${I.company}-${I.account}-${Ie}`,Xe=`${I.company}-${I.account}`;return Z[at]||Z[Xe]?"#60a5fa":"#94a3b8"}),Me=be.createLinearGradient(0,0,800,0);Me.addColorStop(0,"rgba(59, 130, 246, 0.8)"),Me.addColorStop(1,"rgba(139, 92, 246, 0.8)"),console.log("Creating chart with following configuration:",{labels:xe,company:re,account:fe,selectedMonth:C,canvasDataAttributes:{company:W.getAttribute("data-company"),account:W.getAttribute("data-account")},pointColors:Re});const je=xe.map(Ie=>Ie===C?8:6),Ve=xe.map(Ie=>Ie===C?10:8);window.trendChartInstance=new Chart(be,{type:"line",data:{labels:xe,datasets:[{label:"Monthly Values",data:Ce,borderColor:Me,backgroundColor:Me,pointBackgroundColor:Re,pointBorderColor:xe.map(Ie=>"#ffffff"),pointBorderWidth:xe.map(Ie=>Ie===C?2:1.5),pointRadius:je,pointHoverRadius:Ve,borderWidth:3,tension:.1,fill:!1}]},options:{responsive:!0,maintainAspectRatio:!1,animation:{duration:500},plugins:{legend:{display:!1},tooltip:{callbacks:{label(Ie){return new Intl.NumberFormat().format(Ie.parsed.y)},title(Ie){return Ie[0].label}},backgroundColor:"rgba(0, 0, 0, 0.7)",titleFont:{size:14,weight:"bold"},bodyFont:{size:13},padding:10,displayColors:!1}},scales:{x:{ticks:{callback(Ie,We){return xe[We].split("-")[1]||""},maxRotation:0,color(Ie){return xe[Ie.index]===C?"#8b5cf6":void 0},font:{size:10,weight(Ie){return xe[Ie.index]===C?"bold":"normal"}}},grid:{display:!1}},y:{beginAtZero:!0,ticks:{callback(Ie){return new Intl.NumberFormat().format(Ie)},font:{size:10}},grid:{color:"rgba(0, 0, 0, 0.05)"}}},onClick(Ie,We){if(We.length===0){console.log("Chart background clicked, clearing selected month"),t(1,C=null),setTimeout(()=>ae(),50);return}const at=We[0].index,Xe=xe[at];console.log("Chart point clicked:",{month:Xe,index:at,chartDataCompany:I==null?void 0:I.company,chartDataAccount:I==null?void 0:I.account}),t(1,C=Xe),setTimeout(()=>ae(),50);const Ze=document.getElementById("trendChart"),Ke=Ze?Ze.getAttribute("data-company"):null,Ge=Ze?Ze.getAttribute("data-account"):null,gt=V+` - ${Xe}`,ht=`${Ke}-${Ge}-${Xe}`,It=`${Ke}-${Ge}`;if(Z[ht]||Z[It]){const Rr=zr(Z[ht]||Z[It]),Ir=Z[ht]||Z[It]||"";w.update(on=>({...on,isOpen:!0,title:gt,content:Rr,isLoading:!1,company:Ke||"",account:Ge||"",isEditing:!1,editText:Ir}))}else Ke&&Ge&&O(Ke,Ge);const Mt=new CustomEvent("select-month",{detail:{month:Xe,company:Ke,account:Ge}});console.log("Dispatching select-month event with:",{month:Xe,company:Ke,account:Ge}),document.dispatchEvent(Mt)}}}),console.log("Chart initialized successfully")}catch(be){console.error("Error initializing chart:",be)}}function Ee(){if(!I||!I.months||I.months.length===0)return console.log("No chart data available"),"";const W=l;console.log("Rendering timeline with data:",{company:I.company,account:I.account,months:I.months.length,refreshTimestamp:W,selectedMonth:C,isGeneratingAnalysis:oe});const re=I.company||"",fe=I.account||"";console.log("Setting chart data attributes:",{company:re,account:fe});let be='<div class="chart-visualization relative bg-gradient-to-b from-blue-100/50 to-purple-100/30 dark:from-blue-900/20 dark:to-purple-900/10 p-6 pt-8 pb-12 rounded-xl shadow-sm border border-blue-100 dark:border-blue-900/30 mb-6">';if(be+=`<h3 class="text-lg font-medium mb-4 text-gray-700 dark:text-gray-300">${i.t("Monthly Trend")}</h3>`,be+='<div class="chart-container h-64 relative">',be+=`<canvas id="trendChart" width="800" height="250" data-company="${re}" data-account="${fe}" data-ready="true"></canvas>`,be+="</div>",C){const Te=I.months.findIndex(Xe=>Xe===C),xe=Te!==-1?I.values[Te]:null;let Ce=null,Re=null,Me=null;const je=[...I.months].map((Xe,Ze)=>({month:Xe,value:I.values[Ze],date:new Date(Xe.split("-")[0],parseInt(Xe.split("-")[1])-1)})).sort((Xe,Ze)=>Xe.date.getTime()-Ze.date.getTime()),Ve=je.findIndex(Xe=>Xe.month===C);Ve>0&&(Ce=je[Ve-1].month,Re=je[Ve-1].value,Re&&Re!==0&&(Me=(xe-Re)/Math.abs(Re)*100));const[Ie,We]=C.split("-"),at=`${We}/${Ie}`;if(be+='<div class="selected-month-indicator flex flex-col md:flex-row justify-between items-start md:items-center mt-4 p-4 bg-white dark:bg-gray-800 rounded-lg border border-blue-100 dark:border-blue-900/30 shadow-sm animate-fade-in">',be+='<div class="flex items-center mb-3 md:mb-0">',be+='<div class="w-3 h-3 rounded-full bg-purple-500 mr-2"></div>',be+=`<span class="font-medium text-gray-700 dark:text-gray-300">${at}</span>`,be+="</div>",be+='<div class="flex flex-col items-end">',be+=`<div class="text-xl font-bold">${lt(xe)}</div>`,Me!==null){const Xe=Me>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400";be+=`<div class="text-sm ${Xe}">`,be+=`${Me>=0?"+":""}${Me.toFixed(1)}% vs ${Ce.split("-")[1]}/${Ce.split("-")[0]}`,be+="</div>"}be+="</div>",be+="</div>"}return be+="</div>",be}async function ke(){try{console.log("[DEBUG] Starting Word document download");let W="",re="";if(c.isOpen?(console.log("[DEBUG] Getting content from modal"),W=c.editText||"",re=c.title||"Analysis Report",!W&&c.content&&(W=c.content.replace(/<br>/g,`
`).replace(/<[^>]*>/g,""))):j&&(console.log("[DEBUG] Using input text"),W=j,re=A||"Analysis Report"),!W){console.error("[DEBUG] No analysis content available"),Je.error(i.t("No analysis content to download"));return}console.log("[DEBUG] Creating document with Docxtemplater"),console.log("[DEBUG] Content length:",W.length),console.log("[DEBUG] Title:",re);const Te=`${(re||"analysis").replace(/[^a-z0-9]/gi,"_").toLowerCase()}_${new Date().toISOString().replace(/[-:.]/g,"").substring(0,14)}.docx`;try{const xe=await Ta(W,re);Aa(xe,Te)}catch(xe){console.error("[DEBUG] Docxtemplater failed, falling back to simple document:",xe);const Ce=await ch(W,re);uh(Ce,Te)}console.log("[DEBUG] Download complete"),Je.success(i.t("Report downloaded successfully"))}catch(W){console.error("[DEBUG] Error downloading Word report:",W),Je.error(i.t("Failed to download report: ")+(W.message||"Unknown error"))}}function Ne(){ba.update(W=>!W)}function ot(){c.editText=this.value,w.set(c)}const mt=async()=>{try{const W=event.currentTarget;W.classList.add("opacity-50","pointer-events-none"),W.innerHTML=`<svg class="animate-spin -ml-1 mr-2 h-4 w-4 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"></path></svg> ${i.t("Downloading...")}`,await ke(),setTimeout(()=>{W.classList.remove("opacity-50","pointer-events-none"),W.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l2.414 2.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg> ${i.t("Download Report")}`},1e3)}catch(W){console.error("Error in download button click handler:",W),Je.error(i.t("Download failed: ")+(W.message||""));const re=event.currentTarget;re.classList.remove("opacity-50","pointer-events-none"),re.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l2.414 2.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg> ${i.t("Download Report")}`}},ft=W=>{if(W.target.files&&W.target.files.length>0){const re=new FormData;re.append("file",W.target.files[0]),fetch(`${m}/proxy/api/upload_account_tree`,{method:"POST",headers:{Authorization:`Bearer ${T.userToken}`},body:re}).then(fe=>fe.json()).then(fe=>{fe.success?(Je.success(i.t("Account tree uploaded successfully")),te()):Je.error(fe.error||i.t("Upload failed"))}).catch(fe=>{console.error("Error uploading account tree:",fe),Je.error(i.t("Upload failed"))})}};function _t(){$=as(this.value),t(9,$)}function $e(){C=pa(this),t(1,C),t(8,H)}function xt(){j=this.value,t(12,j)}const gr=async()=>{try{const W=event.currentTarget;W.classList.add("opacity-50","pointer-events-none"),W.innerHTML=`<svg class="animate-spin -ml-1 mr-2 h-4 w-4 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"></path></svg> ${i.t("Downloading...")}`,await ke(),setTimeout(()=>{W.classList.remove("opacity-50","pointer-events-none"),W.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l2.414 2.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg> ${i.t("Download Report")}`},1e3)}catch(W){console.error("Error in download button click handler:",W),Je.error(i.t("Download failed: ")+(W.message||""));const re=event.currentTarget;re.classList.remove("opacity-50","pointer-events-none"),re.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l2.414 2.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg> ${i.t("Download Report")}`}};return r.$$.update=()=>{if(r.$$.dirty[0]&1|r.$$.dirty[1]&144&&f&&f.companies&&!G){console.log("Initializing expanded states (one-time)"),t(38,G=!0);const W=Object.keys(f.companies)[0];if(W){console.log("Automatically expanding first company:",W);const re={...k};re[W]=!0,t(35,k=re)}}if(r.$$.dirty[1]&16&&console.log("expandedCompanies changed:",k),r.$$.dirty[1]&32&&console.log("expandedCategories changed:",Object.keys(N).length,"categories"),r.$$.dirty[0]&28&&I&&R==="chart"){if(console.log("chartData changed, scheduling chart initialization"),(!I.company||!I.account)&&(console.warn("chartData missing company or account:",I),V)){const W=V.split(" - ");W.length>=2&&(t(3,I={...I,company:W[0],account:W[1]}),console.log("Fixed chartData by extracting from title:",I))}setTimeout(()=>{ae()},200)}r.$$.dirty[0]&14&&C&&I&&(console.log("Reactive update triggered for analysis UI with selected month:",C),l=Date.now(),R==="chart"&&(console.log("Updating chart for new selected month:",C),setTimeout(()=>ae(),50))),r.$$.dirty[1]&64&&Object.keys(Z).length>0&&(console.log("Analysis data updated, refreshing UI"),l=Date.now()),r.$$.dirty[0]&6&&C&&R==="chart"&&(console.log("Selected month changed to:",C),setTimeout(()=>{document.getElementById("trendChart")&&(console.log("Re-initializing chart with new month:",C),ae())},50))},t(14,a=Date.now().toString()),l=Date.now(),[f,C,R,I,V,T,S,x,H,$,ce,ge,j,oe,a,i,c,u,w,_,E,p,m,te,v,g,se,Q,o,L,ue,ve,Ee,ke,Ne,k,N,Z,G,ot,mt,ft,_t,$e,xt,gr]}class Kh extends ga{constructor(e){super(),wa(this,e,Sh,Th,ca,{},null,[-1,-1,-1])}}export{Kh as component};
//# sourceMappingURL=15.c7GYaSyk.js.map
