import{s as ct,d as c,G as He,a as R,i as z,b as r,x as ue,c as a,e as g,f as h,N as ge,l as N,g as M,D as le,m as Ue,h as p,o as H,t as F,E as se,p as ut,j as dt,q as ft,B as qe,H as Ne,n as ve,O as Le,U as ht}from"../chunks/CgRTDwF2.js";import{S as vt,i as _t,t as pe,a as be,c as Ce,g as Ie,d as at,m as rt,b as ot,e as nt}from"../chunks/Bnxgdxyh.js";import{e as _e,u as gt,d as pt}from"../chunks/C3QokUWv.js";import{t as ce}from"../chunks/Fny8-CkQ.js";import{s as bt}from"../chunks/D-bUEbUi.js";import{S as it}from"../chunks/CnJpwmt-.js";import{g as mt}from"../chunks/cKvFHznx.js";import{b as kt}from"../chunks/CisIfe-u.js";function Re(o,e,t){const l=o.slice();return l[47]=e[t],l[49]=t,l}function ze(o,e,t){const l=o.slice();return l[50]=e[t],l}function Je(o,e,t){const l=o.slice();return l[50]=e[t],l}function We(o,e,t){const l=o.slice();return l[44]=e[t],l}function Ye(o,e,t){const l=o.slice();return l[41]=e[t],l}function Et(o){let e,t,l,s,n,d,i=o[6]?"Back to Tables":"Back to Files",u,v,T,y=o[3].name+"",m,w,C,b,k,I,P;const S=[Tt,yt],L=[];function x(V,_){return V[6]?1:0}return C=x(o),b=L[C]=S[C](o),{c(){e=p("div"),t=p("div"),l=p("button"),s=se("svg"),n=se("path"),d=H(),u=F(i),v=H(),T=p("h3"),m=F(y),w=H(),b.c(),this.h()},l(V){e=g(V,"DIV",{class:!0});var _=h(e);t=g(_,"DIV",{class:!0});var f=h(t);l=g(f,"BUTTON",{class:!0});var Q=h(l);s=le(Q,"svg",{xmlns:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0,class:!0});var D=h(s);n=le(D,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),h(n).forEach(c),D.forEach(c),d=N(Q),u=M(Q,i),Q.forEach(c),v=N(f),T=g(f,"H3",{class:!0});var U=h(T);m=M(U,y),U.forEach(c),f.forEach(c),w=N(_),b.l(_),_.forEach(c),this.h()},h(){a(n,"stroke-linecap","round"),a(n,"stroke-linejoin","round"),a(n,"d","M15.75 19.5L8.25 12l7.5-7.5"),a(s,"xmlns","http://www.w3.org/2000/svg"),a(s,"viewBox","0 0 24 24"),a(s,"fill","none"),a(s,"stroke","currentColor"),a(s,"stroke-width","2"),a(s,"class","w-5 h-5"),a(l,"class","back-to-files-button svelte-1310t73"),a(T,"class","text-lg font-semibold text-gray-800 dark:text-gray-200"),a(t,"class","file-detail-header dark:border-gray-700 svelte-1310t73"),a(e,"class","file-detail-container svelte-1310t73")},m(V,_){z(V,e,_),r(e,t),r(t,l),r(l,s),r(s,n),r(l,d),r(l,u),r(t,v),r(t,T),r(T,m),r(e,w),L[C].m(e,null),k=!0,I||(P=ue(l,"click",o[27]),I=!0)},p(V,_){(!k||_[0]&64)&&i!==(i=V[6]?"Back to Tables":"Back to Files")&&R(u,i),(!k||_[0]&8)&&y!==(y=V[3].name+"")&&R(m,y);let f=C;C=x(V),C===f?L[C].p(V,_):(Ie(),pe(L[f],1,1,()=>{L[f]=null}),Ce(),b=L[C],b?b.p(V,_):(b=L[C]=S[C](V),b.c()),be(b,1),b.m(e,null))},i(V){k||(be(b),k=!0)},o(V){pe(b),k=!1},d(V){V&&c(e),L[C].d(),I=!1,P()}}}function wt(o){let e,t,l,s,n=o[13].t("Excel Data Sources")+"",d,i,u,v,T,y,m,w,C,b,k,I,P,S;const L=[Bt,At,Vt,Qt],x=[];function V(_,f){return _[2]?0:_[0].length===0?1:_[12].length===0?2:3}return b=V(o),k=x[b]=L[b](o),{c(){e=p("div"),t=p("div"),l=p("div"),s=p("h3"),d=F(n),i=H(),u=p("div"),v=p("div"),T=se("svg"),y=se("path"),m=H(),w=p("input"),C=H(),k.c(),this.h()},l(_){e=g(_,"DIV",{class:!0});var f=h(e);t=g(f,"DIV",{class:!0});var Q=h(t);l=g(Q,"DIV",{class:!0});var D=h(l);s=g(D,"H3",{class:!0});var U=h(s);d=M(U,n),U.forEach(c),i=N(D),u=g(D,"DIV",{class:!0});var j=h(u);v=g(j,"DIV",{class:!0});var O=h(v);T=le(O,"svg",{xmlns:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0,class:!0});var Y=h(T);y=le(Y,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),h(y).forEach(c),Y.forEach(c),m=N(O),w=g(O,"INPUT",{type:!0,placeholder:!0,class:!0}),O.forEach(c),j.forEach(c),D.forEach(c),Q.forEach(c),C=N(f),k.l(f),f.forEach(c),this.h()},h(){a(s,"class","text-lg font-semibold text-gray-800 dark:text-gray-200"),a(y,"stroke-linecap","round"),a(y,"stroke-linejoin","round"),a(y,"d","M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"),a(T,"xmlns","http://www.w3.org/2000/svg"),a(T,"viewBox","0 0 24 24"),a(T,"fill","none"),a(T,"stroke","currentColor"),a(T,"stroke-width","2"),a(T,"class","w-5 h-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"),a(w,"type","text"),a(w,"placeholder","Search files..."),a(w,"class","pl-10 pr-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 w-full"),a(v,"class","relative"),a(u,"class","search-box"),a(l,"class","flex justify-between items-center"),a(t,"class","file-list-header dark:border-gray-700 svelte-1310t73"),a(e,"class","file-list-container svelte-1310t73")},m(_,f){z(_,e,f),r(e,t),r(t,l),r(l,s),r(s,d),r(l,i),r(l,u),r(u,v),r(v,T),r(T,y),r(v,m),r(v,w),qe(w,o[1]),r(e,C),x[b].m(e,null),I=!0,P||(S=ue(w,"input",o[24]),P=!0)},p(_,f){(!I||f[0]&8192)&&n!==(n=_[13].t("Excel Data Sources")+"")&&R(d,n),f[0]&2&&w.value!==_[1]&&qe(w,_[1]);let Q=b;b=V(_),b===Q?x[b].p(_,f):(Ie(),pe(x[Q],1,1,()=>{x[Q]=null}),Ce(),k=x[b],k?k.p(_,f):(k=x[b]=L[b](_),k.c()),be(k,1),k.m(e,null))},i(_){I||(be(k),I=!0)},o(_){pe(k),I=!1},d(_){_&&c(e),x[b].d(),P=!1,S()}}}function yt(o){let e,t,l,s,n=o[13].t("Table")+"",d,i,u=o[6].table_name+"",v,T,y,m,w='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"></path></svg> <span>Delete Table</span>',C,b,k,I,P,S;const L=[xt,Dt],x=[];function V(_,f){return _[5][_[6].table_name]?0:_[4][_[6].table_name]?1:-1}return~(b=V(o))&&(k=x[b]=L[b](o)),{c(){e=p("div"),t=p("div"),l=p("div"),s=p("h4"),d=F(n),i=F(": "),v=F(u),T=H(),y=p("div"),m=p("button"),m.innerHTML=w,C=H(),k&&k.c(),this.h()},l(_){e=g(_,"DIV",{class:!0});var f=h(e);t=g(f,"DIV",{class:!0});var Q=h(t);l=g(Q,"DIV",{class:!0});var D=h(l);s=g(D,"H4",{class:!0});var U=h(s);d=M(U,n),i=M(U,": "),v=M(U,u),U.forEach(c),T=N(D),y=g(D,"DIV",{class:!0});var j=h(y);m=g(j,"BUTTON",{class:!0,"data-svelte-h":!0}),ge(m)!=="svelte-1yetmxg"&&(m.innerHTML=w),j.forEach(c),D.forEach(c),Q.forEach(c),C=N(f),k&&k.l(f),f.forEach(c),this.h()},h(){a(s,"class","text-lg font-semibold text-gray-800 dark:text-gray-200"),a(m,"class","px-3 py-2 rounded-lg bg-red-600 hover:bg-red-700 text-white transition flex items-center space-x-2"),a(y,"class","flex space-x-2"),a(l,"class","flex justify-between items-center"),a(t,"class","mb-4"),a(e,"class","table-view-section svelte-1310t73")},m(_,f){z(_,e,f),r(e,t),r(t,l),r(l,s),r(s,d),r(s,i),r(s,v),r(l,T),r(l,y),r(y,m),r(e,C),~b&&x[b].m(e,null),I=!0,P||(S=ue(m,"click",o[29]),P=!0)},p(_,f){(!I||f[0]&8192)&&n!==(n=_[13].t("Table")+"")&&R(d,n),(!I||f[0]&64)&&u!==(u=_[6].table_name+"")&&R(v,u);let Q=b;b=V(_),b===Q?~b&&x[b].p(_,f):(k&&(Ie(),pe(x[Q],1,1,()=>{x[Q]=null}),Ce()),~b?(k=x[b],k?k.p(_,f):(k=x[b]=L[b](_),k.c()),be(k,1),k.m(e,null)):k=null)},i(_){I||(be(k),I=!0)},o(_){pe(k),I=!1},d(_){_&&c(e),~b&&x[b].d(),P=!1,S()}}}function Tt(o){let e,t,l,s=o[13].t("Filename")+"",n,d,i,u,v=o[3].name+"",T,y,m,w,C=o[13].t("Upload Date")+"",b,k,I,P,S=o[3].dateUploaded+"",L,x,V,_,f=o[13].t("Tables")+"",Q,D,U,j,O=o[3].tableCount+"",Y,$,J,X,q=o[13].t("Path")+"",A,K,ae,te,re=o[3].savedPath+"",de,oe,ie,E,B,W=o[13].t("Excel Sheets")+"",ne,me,fe,ee=o[3].tables&&o[3].tables.length>0&&$e(o);function ke(G,Z){return!G[3].tables||G[3].tables.length===0?It:Ct}let Ee=ke(o),he=Ee(o);return{c(){e=p("div"),t=p("div"),l=p("span"),n=F(s),d=F(":"),i=H(),u=p("span"),T=F(v),y=H(),m=p("div"),w=p("span"),b=F(C),k=F(":"),I=H(),P=p("span"),L=F(S),x=H(),V=p("div"),_=p("span"),Q=F(f),D=F(":"),U=H(),j=p("span"),Y=F(O),$=H(),J=p("div"),X=p("span"),A=F(q),K=F(":"),ae=H(),te=p("span"),de=F(re),oe=H(),ie=p("div"),E=p("div"),B=p("h4"),ne=F(W),me=H(),ee&&ee.c(),fe=H(),he.c(),this.h()},l(G){e=g(G,"DIV",{class:!0});var Z=h(e);t=g(Z,"DIV",{class:!0});var we=h(t);l=g(we,"SPAN",{class:!0});var Qe=h(l);n=M(Qe,s),d=M(Qe,":"),Qe.forEach(c),i=N(we),u=g(we,"SPAN",{class:!0});var Pe=h(u);T=M(Pe,v),Pe.forEach(c),we.forEach(c),y=N(Z),m=g(Z,"DIV",{class:!0});var ye=h(m);w=g(ye,"SPAN",{class:!0});var Ve=h(w);b=M(Ve,C),k=M(Ve,":"),Ve.forEach(c),I=N(ye),P=g(ye,"SPAN",{class:!0});var je=h(P);L=M(je,S),je.forEach(c),ye.forEach(c),x=N(Z),V=g(Z,"DIV",{class:!0});var Te=h(V);_=g(Te,"SPAN",{class:!0});var Ae=h(_);Q=M(Ae,f),D=M(Ae,":"),Ae.forEach(c),U=N(Te),j=g(Te,"SPAN",{class:!0});var Me=h(j);Y=M(Me,O),Me.forEach(c),Te.forEach(c),$=N(Z),J=g(Z,"DIV",{class:!0});var De=h(J);X=g(De,"SPAN",{class:!0});var Be=h(X);A=M(Be,q),K=M(Be,":"),Be.forEach(c),ae=N(De),te=g(De,"SPAN",{class:!0});var Fe=h(te);de=M(Fe,re),Fe.forEach(c),De.forEach(c),Z.forEach(c),oe=N(G),ie=g(G,"DIV",{class:!0});var xe=h(ie);E=g(xe,"DIV",{class:!0});var Se=h(E);B=g(Se,"H4",{class:!0});var Oe=h(B);ne=M(Oe,W),Oe.forEach(c),me=N(Se),ee&&ee.l(Se),Se.forEach(c),fe=N(xe),he.l(xe),xe.forEach(c),this.h()},h(){a(l,"class","info-label svelte-1310t73"),a(u,"class","info-value svelte-1310t73"),a(t,"class","file-info-item svelte-1310t73"),a(w,"class","info-label svelte-1310t73"),a(P,"class","info-value svelte-1310t73"),a(m,"class","file-info-item svelte-1310t73"),a(_,"class","info-label svelte-1310t73"),a(j,"class","info-value svelte-1310t73"),a(V,"class","file-info-item svelte-1310t73"),a(X,"class","info-label svelte-1310t73"),a(te,"class","info-value text-xs opacity-80 svelte-1310t73"),a(J,"class","file-info-item svelte-1310t73"),a(e,"class","file-info-section dark:border-gray-700 svelte-1310t73"),a(B,"class","section-title svelte-1310t73"),a(E,"class","flex justify-between items-center mb-4"),a(ie,"class","tables-section svelte-1310t73")},m(G,Z){z(G,e,Z),r(e,t),r(t,l),r(l,n),r(l,d),r(t,i),r(t,u),r(u,T),r(e,y),r(e,m),r(m,w),r(w,b),r(w,k),r(m,I),r(m,P),r(P,L),r(e,x),r(e,V),r(V,_),r(_,Q),r(_,D),r(V,U),r(V,j),r(j,Y),r(e,$),r(e,J),r(J,X),r(X,A),r(X,K),r(J,ae),r(J,te),r(te,de),z(G,oe,Z),z(G,ie,Z),r(ie,E),r(E,B),r(B,ne),r(E,me),ee&&ee.m(E,null),r(ie,fe),he.m(ie,null)},p(G,Z){Z[0]&8192&&s!==(s=G[13].t("Filename")+"")&&R(n,s),Z[0]&8&&v!==(v=G[3].name+"")&&R(T,v),Z[0]&8192&&C!==(C=G[13].t("Upload Date")+"")&&R(b,C),Z[0]&8&&S!==(S=G[3].dateUploaded+"")&&R(L,S),Z[0]&8192&&f!==(f=G[13].t("Tables")+"")&&R(Q,f),Z[0]&8&&O!==(O=G[3].tableCount+"")&&R(Y,O),Z[0]&8192&&q!==(q=G[13].t("Path")+"")&&R(A,q),Z[0]&8&&re!==(re=G[3].savedPath+"")&&R(de,re),Z[0]&8192&&W!==(W=G[13].t("Excel Sheets")+"")&&R(ne,W),G[3].tables&&G[3].tables.length>0?ee?ee.p(G,Z):(ee=$e(G),ee.c(),ee.m(E,null)):ee&&(ee.d(1),ee=null),Ee===(Ee=ke(G))&&he?he.p(G,Z):(he.d(1),he=Ee(G),he&&(he.c(),he.m(ie,null)))},i:ve,o:ve,d(G){G&&(c(e),c(oe),c(ie)),ee&&ee.d(),he.d()}}}function Dt(o){let e,t,l,s,n,d,i,u,v,T,y,m,w,C,b;function k(f,Q){return f[9]?Lt:St}let I=k(o),P=I(o),S=o[9]&&Ge(o),L=_e(o[4][o[6].table_name].columns.filter(o[32])),x=[];for(let f=0;f<L.length;f+=1)x[f]=Ke(Je(o,L,f));let V=_e(o[4][o[6].table_name].rows),_=[];for(let f=0;f<V.length;f+=1)_[f]=Ze(Re(o,V,f));return{c(){e=p("div"),t=p("div"),l=p("button"),P.c(),d=H(),S&&S.c(),i=H(),u=p("div"),v=p("table"),T=p("thead"),y=p("tr");for(let f=0;f<x.length;f+=1)x[f].c();m=H(),w=p("tbody");for(let f=0;f<_.length;f+=1)_[f].c();this.h()},l(f){e=g(f,"DIV",{class:!0});var Q=h(e);t=g(Q,"DIV",{class:!0});var D=h(t);l=g(D,"BUTTON",{class:!0});var U=h(l);P.l(U),U.forEach(c),d=N(D),S&&S.l(D),D.forEach(c),Q.forEach(c),i=N(f),u=g(f,"DIV",{class:!0});var j=h(u);v=g(j,"TABLE",{class:!0});var O=h(v);T=g(O,"THEAD",{});var Y=h(T);y=g(Y,"TR",{class:!0});var $=h(y);for(let X=0;X<x.length;X+=1)x[X].l($);$.forEach(c),Y.forEach(c),m=N(O),w=g(O,"TBODY",{});var J=h(w);for(let X=0;X<_.length;X+=1)_[X].l(J);J.forEach(c),O.forEach(c),j.forEach(c),this.h()},h(){a(l,"class",s="px-3 py-2 rounded-lg "+(o[9]?"bg-green-600 hover:bg-green-700":"bg-blue-600 hover:bg-blue-700")+" text-white transition flex items-center space-x-2"),l.disabled=n=o[9]&&!o[8],a(t,"class","flex space-x-4"),a(e,"class","table-controls mb-4"),a(y,"class","svelte-1310t73"),a(v,"class","excel-table w-full svelte-1310t73"),a(u,"class","excel-table-wrapper svelte-1310t73")},m(f,Q){z(f,e,Q),r(e,t),r(t,l),P.m(l,null),r(t,d),S&&S.m(t,null),z(f,i,Q),z(f,u,Q),r(u,v),r(v,T),r(T,y);for(let D=0;D<x.length;D+=1)x[D]&&x[D].m(y,null);r(v,m),r(v,w);for(let D=0;D<_.length;D+=1)_[D]&&_[D].m(w,null);C||(b=ue(l,"click",function(){Ne(o[9]?o[21]:o[30])&&(o[9]?o[21]:o[30]).apply(this,arguments)}),C=!0)},p(f,Q){if(o=f,I!==(I=k(o))&&(P.d(1),P=I(o),P&&(P.c(),P.m(l,null))),Q[0]&512&&s!==(s="px-3 py-2 rounded-lg "+(o[9]?"bg-green-600 hover:bg-green-700":"bg-blue-600 hover:bg-blue-700")+" text-white transition flex items-center space-x-2")&&a(l,"class",s),Q[0]&768&&n!==(n=o[9]&&!o[8])&&(l.disabled=n),o[9]?S?S.p(o,Q):(S=Ge(o),S.c(),S.m(t,null)):S&&(S.d(1),S=null),Q[0]&208){L=_e(o[4][o[6].table_name].columns.filter(o[32]));let D;for(D=0;D<L.length;D+=1){const U=Je(o,L,D);x[D]?x[D].p(U,Q):(x[D]=Ke(U),x[D].c(),x[D].m(y,null))}for(;D<x.length;D+=1)x[D].d(1);x.length=L.length}if(Q[0]&1049296){V=_e(o[4][o[6].table_name].rows);let D;for(D=0;D<V.length;D+=1){const U=Re(o,V,D);_[D]?_[D].p(U,Q):(_[D]=Ze(U),_[D].c(),_[D].m(w,null))}for(;D<_.length;D+=1)_[D].d(1);_.length=V.length}},i:ve,o:ve,d(f){f&&(c(e),c(i),c(u)),P.d(),S&&S.d(),Le(x,f),Le(_,f),C=!1,b()}}}function xt(o){let e,t,l,s,n=o[13].t("Loading table data...")+"",d,i;return t=new it({props:{className:"w-10 h-10"}}),{c(){e=p("div"),nt(t.$$.fragment),l=H(),s=p("span"),d=F(n),this.h()},l(u){e=g(u,"DIV",{class:!0});var v=h(e);ot(t.$$.fragment,v),l=N(v),s=g(v,"SPAN",{class:!0});var T=h(s);d=M(T,n),T.forEach(c),v.forEach(c),this.h()},h(){a(s,"class","ml-4 text-gray-600 dark:text-gray-400"),a(e,"class","flex justify-center items-center h-64")},m(u,v){z(u,e,v),rt(t,e,null),r(e,l),r(e,s),r(s,d),i=!0},p(u,v){(!i||v[0]&8192)&&n!==(n=u[13].t("Loading table data...")+"")&&R(d,n)},i(u){i||(be(t.$$.fragment,u),i=!0)},o(u){pe(t.$$.fragment,u),i=!1},d(u){u&&c(e),at(t)}}}function St(o){let e,t,l,s,n="Edit Data";return{c(){e=se("svg"),t=se("path"),l=H(),s=p("span"),s.textContent=n,this.h()},l(d){e=le(d,"svg",{xmlns:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0,class:!0});var i=h(e);t=le(i,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),h(t).forEach(c),i.forEach(c),l=N(d),s=g(d,"SPAN",{"data-svelte-h":!0}),ge(s)!=="svelte-19wbzee"&&(s.textContent=n),this.h()},h(){a(t,"stroke-linecap","round"),a(t,"stroke-linejoin","round"),a(t,"d","M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"),a(e,"xmlns","http://www.w3.org/2000/svg"),a(e,"viewBox","0 0 24 24"),a(e,"fill","none"),a(e,"stroke","currentColor"),a(e,"stroke-width","2"),a(e,"class","w-5 h-5")},m(d,i){z(d,e,i),r(e,t),z(d,l,i),z(d,s,i)},d(d){d&&(c(e),c(l),c(s))}}}function Lt(o){let e,t,l,s,n="Save Changes";return{c(){e=se("svg"),t=se("path"),l=H(),s=p("span"),s.textContent=n,this.h()},l(d){e=le(d,"svg",{xmlns:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0,class:!0});var i=h(e);t=le(i,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),h(t).forEach(c),i.forEach(c),l=N(d),s=g(d,"SPAN",{"data-svelte-h":!0}),ge(s)!=="svelte-1mlnvx6"&&(s.textContent=n),this.h()},h(){a(t,"stroke-linecap","round"),a(t,"stroke-linejoin","round"),a(t,"d","M17.593 3.322c1.1.128 1.907 1.077 1.907 2.185V21L12 17.25 4.5 21V5.507c0-1.108.806-2.057 1.907-2.185a48.507 48.507 0 0111.186 0z"),a(e,"xmlns","http://www.w3.org/2000/svg"),a(e,"viewBox","0 0 24 24"),a(e,"fill","none"),a(e,"stroke","currentColor"),a(e,"stroke-width","2"),a(e,"class","w-5 h-5")},m(d,i){z(d,e,i),r(e,t),z(d,l,i),z(d,s,i)},d(d){d&&(c(e),c(l),c(s))}}}function Ge(o){let e,t='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path></svg> <span>Cancel</span>',l,s;return{c(){e=p("button"),e.innerHTML=t,this.h()},l(n){e=g(n,"BUTTON",{class:!0,"data-svelte-h":!0}),ge(e)!=="svelte-mt124r"&&(e.innerHTML=t),this.h()},h(){a(e,"class","px-3 py-2 rounded-lg bg-gray-600 hover:bg-gray-700 text-white transition flex items-center space-x-2")},m(n,d){z(n,e,d),l||(s=ue(e,"click",o[31]),l=!0)},p:ve,d(n){n&&c(e),l=!1,s()}}}function Ke(o){let e,t,l,s=o[50].name+"",n,d;return{c(){e=p("th"),t=p("div"),l=p("span"),n=F(s),d=H(),this.h()},l(i){e=g(i,"TH",{class:!0});var u=h(e);t=g(u,"DIV",{class:!0});var v=h(t);l=g(v,"SPAN",{});var T=h(l);n=M(T,s),T.forEach(c),v.forEach(c),d=N(u),u.forEach(c),this.h()},h(){a(t,"class","flex justify-between items-center"),a(e,"class","svelte-1310t73")},m(i,u){z(i,e,u),r(e,t),r(t,l),r(l,n),r(e,d)},p(i,u){u[0]&208&&s!==(s=i[50].name+"")&&R(n,s)},d(i){i&&c(e)}}}function Xe(o){let e,t=(o[47][o[50].name]!==void 0?o[47][o[50].name]:"")+"",l,s,n;function d(...i){return o[34](o[49],o[50],...i)}return{c(){e=p("td"),l=F(t),this.h()},l(i){e=g(i,"TD",{contenteditable:!0,class:!0});var u=h(e);l=M(u,t),u.forEach(c),this.h()},h(){a(e,"contenteditable",o[9]),a(e,"class","svelte-1310t73")},m(i,u){z(i,e,u),r(e,l),s||(n=ue(e,"blur",d),s=!0)},p(i,u){o=i,u[0]&208&&t!==(t=(o[47][o[50].name]!==void 0?o[47][o[50].name]:"")+"")&&ht(l,t,o[9]),u[0]&512&&a(e,"contenteditable",o[9])},d(i){i&&c(e),s=!1,n()}}}function Ze(o){let e,t,l=_e(o[4][o[6].table_name].columns.filter(o[33])),s=[];for(let n=0;n<l.length;n+=1)s[n]=Xe(ze(o,l,n));return{c(){e=p("tr");for(let n=0;n<s.length;n+=1)s[n].c();t=H(),this.h()},l(n){e=g(n,"TR",{class:!0});var d=h(e);for(let i=0;i<s.length;i+=1)s[i].l(d);t=N(d),d.forEach(c),this.h()},h(){a(e,"class","svelte-1310t73")},m(n,d){z(n,e,d);for(let i=0;i<s.length;i+=1)s[i]&&s[i].m(e,null);r(e,t)},p(n,d){if(d[0]&1049296){l=_e(n[4][n[6].table_name].columns.filter(n[33]));let i;for(i=0;i<l.length;i+=1){const u=ze(n,l,i);s[i]?s[i].p(u,d):(s[i]=Xe(u),s[i].c(),s[i].m(e,t))}for(;i<s.length;i+=1)s[i].d(1);s.length=l.length}},d(n){n&&c(e),Le(s,n)}}}function $e(o){let e,t=o[3].tables.length+"",l,s,n=o[3].tables.length===1?"sheet":"sheets",d,i;return{c(){e=p("span"),l=F(t),s=H(),d=F(n),i=F(" available"),this.h()},l(u){e=g(u,"SPAN",{class:!0});var v=h(e);l=M(v,t),s=N(v),d=M(v,n),i=M(v," available"),v.forEach(c),this.h()},h(){a(e,"class","text-gray-500 dark:text-gray-400 text-sm")},m(u,v){z(u,e,v),r(e,l),r(e,s),r(e,d),r(e,i)},p(u,v){v[0]&8&&t!==(t=u[3].tables.length+"")&&R(l,t),v[0]&8&&n!==(n=u[3].tables.length===1?"sheet":"sheets")&&R(d,n)},d(u){u&&c(e)}}}function Ct(o){let e,t,l=_e(o[3].tables),s=[];for(let n=0;n<l.length;n+=1)s[n]=et(We(o,l,n));return{c(){e=p("div"),t=p("div");for(let n=0;n<s.length;n+=1)s[n].c();this.h()},l(n){e=g(n,"DIV",{class:!0});var d=h(e);t=g(d,"DIV",{class:!0});var i=h(t);for(let u=0;u<s.length;u+=1)s[u].l(i);i.forEach(c),d.forEach(c),this.h()},h(){a(t,"class","space-y-2"),a(e,"class","tables-list")},m(n,d){z(n,e,d),r(e,t);for(let i=0;i<s.length;i+=1)s[i]&&s[i].m(t,null)},p(n,d){if(d[0]&524360){l=_e(n[3].tables);let i;for(i=0;i<l.length;i+=1){const u=We(n,l,i);s[i]?s[i].p(u,d):(s[i]=et(u),s[i].c(),s[i].m(t,null))}for(;i<s.length;i+=1)s[i].d(1);s.length=l.length}},d(n){n&&c(e),Le(s,n)}}}function It(o){let e,t,l=o[13].t("No tables found in this file")+"",s;return{c(){e=p("div"),t=p("p"),s=F(l),this.h()},l(n){e=g(n,"DIV",{class:!0});var d=h(e);t=g(d,"P",{class:!0});var i=h(t);s=M(i,l),i.forEach(c),d.forEach(c),this.h()},h(){a(t,"class","text-gray-500 dark:text-gray-400"),a(e,"class","no-content-message")},m(n,d){z(n,e,d),r(e,t),r(t,s)},p(n,d){d[0]&8192&&l!==(l=n[13].t("No tables found in this file")+"")&&R(s,l)},d(n){n&&c(e)}}}function et(o){let e,t,l,s=o[44].table_name+"",n,d,i,u=o[44].row_count+"",v,T,y,m,w,C;function b(){return o[28](o[44])}return{c(){e=p("div"),t=p("div"),l=p("span"),n=F(s),d=H(),i=p("span"),v=F(u),T=F(" rows"),y=H(),this.h()},l(k){e=g(k,"DIV",{class:!0});var I=h(e);t=g(I,"DIV",{class:!0});var P=h(t);l=g(P,"SPAN",{class:!0});var S=h(l);n=M(S,s),S.forEach(c),d=N(P),i=g(P,"SPAN",{class:!0});var L=h(i);v=M(L,u),T=M(L," rows"),L.forEach(c),P.forEach(c),y=N(I),I.forEach(c),this.h()},h(){a(l,"class","text-md text-gray-800 dark:text-gray-200"),a(i,"class","text-sm text-gray-500 dark:text-gray-400"),a(t,"class","flex justify-between items-center w-full"),a(e,"class",m="table-item "+(o[6]&&o[6].table_name===o[44].table_name?"selected":"")+" svelte-1310t73")},m(k,I){z(k,e,I),r(e,t),r(t,l),r(l,n),r(t,d),r(t,i),r(i,v),r(i,T),r(e,y),w||(C=ue(e,"click",b),w=!0)},p(k,I){o=k,I[0]&8&&s!==(s=o[44].table_name+"")&&R(n,s),I[0]&8&&u!==(u=o[44].row_count+"")&&R(v,u),I[0]&72&&m!==(m="table-item "+(o[6]&&o[6].table_name===o[44].table_name?"selected":"")+" svelte-1310t73")&&a(e,"class",m)},d(k){k&&c(e),w=!1,C()}}}function Qt(o){let e,t,l,s,n,d,i,u=o[13].t("Filename")+"",v,T,y,m=o[13].t("Upload Date")+"",w,C,b,k=o[13].t("Tables")+"",I,P,S,L=o[13].t("Actions")+"",x,V,_,f=[],Q=new Map,D=_e(o[12]);const U=j=>j[41].id;for(let j=0;j<D.length;j+=1){let O=Ye(o,D,j),Y=U(O);Q.set(Y,f[j]=tt(Y,O))}return{c(){e=p("div"),t=p("table"),l=p("thead"),s=p("tr"),n=p("th"),d=H(),i=p("th"),v=F(u),T=H(),y=p("th"),w=F(m),C=H(),b=p("th"),I=F(k),P=H(),S=p("th"),x=F(L),V=H(),_=p("tbody");for(let j=0;j<f.length;j+=1)f[j].c();this.h()},l(j){e=g(j,"DIV",{class:!0});var O=h(e);t=g(O,"TABLE",{class:!0});var Y=h(t);l=g(Y,"THEAD",{});var $=h(l);s=g($,"TR",{class:!0});var J=h(s);n=g(J,"TH",{class:!0}),h(n).forEach(c),d=N(J),i=g(J,"TH",{class:!0});var X=h(i);v=M(X,u),X.forEach(c),T=N(J),y=g(J,"TH",{class:!0});var q=h(y);w=M(q,m),q.forEach(c),C=N(J),b=g(J,"TH",{class:!0});var A=h(b);I=M(A,k),A.forEach(c),P=N(J),S=g(J,"TH",{class:!0});var K=h(S);x=M(K,L),K.forEach(c),J.forEach(c),$.forEach(c),V=N(Y),_=g(Y,"TBODY",{class:!0});var ae=h(_);for(let te=0;te<f.length;te+=1)f[te].l(ae);ae.forEach(c),Y.forEach(c),O.forEach(c),this.h()},h(){a(n,"class","py-3 px-4 text-left"),a(i,"class","py-3 px-4 text-left"),a(y,"class","py-3 px-4 text-left"),a(b,"class","py-3 px-4 text-left"),a(S,"class","py-3 px-4 text-left"),a(s,"class","border-b border-gray-200 dark:border-gray-700"),a(_,"class","svelte-1310t73"),a(t,"class","w-full"),a(e,"class","file-list")},m(j,O){z(j,e,O),r(e,t),r(t,l),r(l,s),r(s,n),r(s,d),r(s,i),r(i,v),r(s,T),r(s,y),r(y,w),r(s,C),r(s,b),r(b,I),r(s,P),r(s,S),r(S,x),r(t,V),r(t,_);for(let Y=0;Y<f.length;Y+=1)f[Y]&&f[Y].m(_,null)},p(j,O){O[0]&8192&&u!==(u=j[13].t("Filename")+"")&&R(v,u),O[0]&8192&&m!==(m=j[13].t("Upload Date")+"")&&R(w,m),O[0]&8192&&k!==(k=j[13].t("Tables")+"")&&R(I,k),O[0]&8192&&L!==(L=j[13].t("Actions")+"")&&R(x,L),O[0]&397312&&(D=_e(j[12]),f=gt(f,O,U,1,j,D,Q,_,pt,tt,null,Ye))},i:ve,o:ve,d(j){j&&c(e);for(let O=0;O<f.length;O+=1)f[O].d()}}}function Vt(o){let e,t,l,s,n,d=o[13].t("No files match your search")+"",i,u,v,T=o[13].t("Try a different search term or clear your search")+"",y;return{c(){e=p("div"),t=se("svg"),l=se("path"),s=H(),n=p("h3"),i=F(d),u=H(),v=p("p"),y=F(T),this.h()},l(m){e=g(m,"DIV",{class:!0});var w=h(e);t=le(w,"svg",{xmlns:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0,class:!0});var C=h(t);l=le(C,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),h(l).forEach(c),C.forEach(c),s=N(w),n=g(w,"H3",{class:!0});var b=h(n);i=M(b,d),b.forEach(c),u=N(w),v=g(w,"P",{class:!0});var k=h(v);y=M(k,T),k.forEach(c),w.forEach(c),this.h()},h(){a(l,"stroke-linecap","round"),a(l,"stroke-linejoin","round"),a(l,"d","M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"),a(t,"xmlns","http://www.w3.org/2000/svg"),a(t,"viewBox","0 0 24 24"),a(t,"fill","none"),a(t,"stroke","currentColor"),a(t,"stroke-width","2"),a(t,"class","w-16 h-16 mx-auto mb-4 text-gray-400"),a(n,"class","text-xl font-medium text-gray-700 dark:text-gray-300 mb-2"),a(v,"class","text-gray-500 dark:text-gray-400"),a(e,"class","empty-state svelte-1310t73")},m(m,w){z(m,e,w),r(e,t),r(t,l),r(e,s),r(e,n),r(n,i),r(e,u),r(e,v),r(v,y)},p(m,w){w[0]&8192&&d!==(d=m[13].t("No files match your search")+"")&&R(i,d),w[0]&8192&&T!==(T=m[13].t("Try a different search term or clear your search")+"")&&R(y,T)},i:ve,o:ve,d(m){m&&c(e)}}}function At(o){let e,t,l,s,n,d=o[13].t("No Excel files have been uploaded yet")+"",i,u,v,T=o[13].t("Upload Excel files using the Excel File Handler to see them here")+"",y;return{c(){e=p("div"),t=se("svg"),l=se("path"),s=H(),n=p("h3"),i=F(d),u=H(),v=p("p"),y=F(T),this.h()},l(m){e=g(m,"DIV",{class:!0});var w=h(e);t=le(w,"svg",{xmlns:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0,class:!0});var C=h(t);l=le(C,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),h(l).forEach(c),C.forEach(c),s=N(w),n=g(w,"H3",{class:!0});var b=h(n);i=M(b,d),b.forEach(c),u=N(w),v=g(w,"P",{class:!0});var k=h(v);y=M(k,T),k.forEach(c),w.forEach(c),this.h()},h(){a(l,"stroke-linecap","round"),a(l,"stroke-linejoin","round"),a(l,"d","M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"),a(t,"xmlns","http://www.w3.org/2000/svg"),a(t,"viewBox","0 0 24 24"),a(t,"fill","none"),a(t,"stroke","currentColor"),a(t,"stroke-width","2"),a(t,"class","w-16 h-16 mx-auto mb-4 text-gray-400"),a(n,"class","text-xl font-medium text-gray-700 dark:text-gray-300 mb-2"),a(v,"class","text-gray-500 dark:text-gray-400"),a(e,"class","empty-state svelte-1310t73")},m(m,w){z(m,e,w),r(e,t),r(t,l),r(e,s),r(e,n),r(n,i),r(e,u),r(e,v),r(v,y)},p(m,w){w[0]&8192&&d!==(d=m[13].t("No Excel files have been uploaded yet")+"")&&R(i,d),w[0]&8192&&T!==(T=m[13].t("Upload Excel files using the Excel File Handler to see them here")+"")&&R(y,T)},i:ve,o:ve,d(m){m&&c(e)}}}function Bt(o){let e,t,l,s,n=o[13].t("Loading files...")+"",d,i;return t=new it({props:{className:"w-10 h-10"}}),{c(){e=p("div"),nt(t.$$.fragment),l=H(),s=p("span"),d=F(n),this.h()},l(u){e=g(u,"DIV",{class:!0});var v=h(e);ot(t.$$.fragment,v),l=N(v),s=g(v,"SPAN",{class:!0});var T=h(s);d=M(T,n),T.forEach(c),v.forEach(c),this.h()},h(){a(s,"class","ml-4 text-gray-600 dark:text-gray-400"),a(e,"class","flex justify-center items-center h-64")},m(u,v){z(u,e,v),rt(t,e,null),r(e,l),r(e,s),r(s,d),i=!0},p(u,v){(!i||v[0]&8192)&&n!==(n=u[13].t("Loading files...")+"")&&R(d,n)},i(u){i||(be(t.$$.fragment,u),i=!0)},o(u){pe(t.$$.fragment,u),i=!1},d(u){u&&c(e),at(t)}}}function Nt(o){let e,t;return{c(){e=se("svg"),t=se("path"),this.h()},l(l){e=le(l,"svg",{xmlns:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0,class:!0});var s=h(e);t=le(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),h(t).forEach(c),s.forEach(c),this.h()},h(){a(t,"stroke-linecap","round"),a(t,"stroke-linejoin","round"),a(t,"d","M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"),a(e,"xmlns","http://www.w3.org/2000/svg"),a(e,"viewBox","0 0 24 24"),a(e,"fill","none"),a(e,"stroke","currentColor"),a(e,"stroke-width","2"),a(e,"class","w-6 h-6 text-gray-500")},m(l,s){z(l,e,s),r(e,t)},d(l){l&&c(e)}}}function Ht(o){let e,t;return{c(){e=se("svg"),t=se("path"),this.h()},l(l){e=le(l,"svg",{xmlns:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0,class:!0});var s=h(e);t=le(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),h(t).forEach(c),s.forEach(c),this.h()},h(){a(t,"stroke-linecap","round"),a(t,"stroke-linejoin","round"),a(t,"d","M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"),a(e,"xmlns","http://www.w3.org/2000/svg"),a(e,"viewBox","0 0 24 24"),a(e,"fill","none"),a(e,"stroke","currentColor"),a(e,"stroke-width","2"),a(e,"class","w-6 h-6 text-blue-600")},m(l,s){z(l,e,s),r(e,t)},d(l){l&&c(e)}}}function Pt(o){let e,t;return{c(){e=se("svg"),t=se("path"),this.h()},l(l){e=le(l,"svg",{xmlns:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0,class:!0});var s=h(e);t=le(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),h(t).forEach(c),s.forEach(c),this.h()},h(){a(t,"stroke-linecap","round"),a(t,"stroke-linejoin","round"),a(t,"d","M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"),a(e,"xmlns","http://www.w3.org/2000/svg"),a(e,"viewBox","0 0 24 24"),a(e,"fill","none"),a(e,"stroke","currentColor"),a(e,"stroke-width","2"),a(e,"class","w-6 h-6 text-green-600")},m(l,s){z(l,e,s),r(e,t)},d(l){l&&c(e)}}}function tt(o,e){let t,l,s,n,d,i,u=e[41].name+"",v,T,y,m=e[41].dateUploaded+"",w,C,b,k=e[41].tableCount+"",I,P,S,L,x,V='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z"></path><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>',_,f,Q='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"></path></svg>',D,U,j;function O(q,A){return A[0]&4096&&(s=null),A[0]&4096&&(n=null),s==null&&(s=st(q[41].name)==="SpreadsheetDocument"),s?Pt:(n==null&&(n=st(q[41].name)==="TextDocument"),n?Ht:Nt)}let Y=O(e,[-1,-1]),$=Y(e);function J(){return e[25](e[41])}function X(){return e[26](e[41])}return{key:o,first:null,c(){t=p("tr"),l=p("td"),$.c(),d=H(),i=p("td"),v=F(u),T=H(),y=p("td"),w=F(m),C=H(),b=p("td"),I=F(k),P=H(),S=p("td"),L=p("div"),x=p("button"),x.innerHTML=V,_=H(),f=p("button"),f.innerHTML=Q,D=H(),this.h()},l(q){t=g(q,"TR",{class:!0});var A=h(t);l=g(A,"TD",{class:!0});var K=h(l);$.l(K),K.forEach(c),d=N(A),i=g(A,"TD",{class:!0});var ae=h(i);v=M(ae,u),ae.forEach(c),T=N(A),y=g(A,"TD",{class:!0});var te=h(y);w=M(te,m),te.forEach(c),C=N(A),b=g(A,"TD",{class:!0});var re=h(b);I=M(re,k),re.forEach(c),P=N(A),S=g(A,"TD",{class:!0});var de=h(S);L=g(de,"DIV",{class:!0});var oe=h(L);x=g(oe,"BUTTON",{class:!0,"data-svelte-h":!0}),ge(x)!=="svelte-f80i9f"&&(x.innerHTML=V),_=N(oe),f=g(oe,"BUTTON",{class:!0,"data-svelte-h":!0}),ge(f)!=="svelte-17mkl9c"&&(f.innerHTML=Q),oe.forEach(c),de.forEach(c),D=N(A),A.forEach(c),this.h()},h(){a(l,"class","py-3 px-4"),a(i,"class","py-3 px-4 font-medium text-blue-600 dark:text-blue-400"),a(y,"class","py-3 px-4"),a(b,"class","py-3 px-4"),a(x,"class","p-2 rounded-lg text-blue-600 hover:bg-blue-50 dark:hover:bg-gray-700"),a(f,"class","p-2 rounded-lg text-red-600 hover:bg-red-50 dark:hover:bg-gray-700"),a(L,"class","flex space-x-2"),a(S,"class","py-3 px-4"),a(t,"class","border-b border-gray-200 dark:border-gray-800 hover:bg-gray-50 dark:hover:bg-gray-800 svelte-1310t73"),this.first=t},m(q,A){z(q,t,A),r(t,l),$.m(l,null),r(t,d),r(t,i),r(i,v),r(t,T),r(t,y),r(y,w),r(t,C),r(t,b),r(b,I),r(t,P),r(t,S),r(S,L),r(L,x),r(L,_),r(L,f),r(t,D),U||(j=[ue(x,"click",J),ue(f,"click",X)],U=!0)},p(q,A){e=q,Y!==(Y=O(e,A))&&($.d(1),$=Y(e),$&&($.c(),$.m(l,null))),A[0]&4096&&u!==(u=e[41].name+"")&&R(v,u),A[0]&4096&&m!==(m=e[41].dateUploaded+"")&&R(w,m),A[0]&4096&&k!==(k=e[41].tableCount+"")&&R(I,k)},d(q){q&&c(t),$.d(),U=!1,He(j)}}}function lt(o){let e,t,l,s=o[11].title+"",n,d,i,u=o[11].message+"",v,T,y,m,w="No",C,b,k="Yes",I,P;return{c(){e=p("div"),t=p("div"),l=p("h3"),n=F(s),d=H(),i=p("p"),v=F(u),T=H(),y=p("div"),m=p("button"),m.textContent=w,C=H(),b=p("button"),b.textContent=k,this.h()},l(S){e=g(S,"DIV",{class:!0});var L=h(e);t=g(L,"DIV",{class:!0});var x=h(t);l=g(x,"H3",{class:!0});var V=h(l);n=M(V,s),V.forEach(c),d=N(x),i=g(x,"P",{class:!0});var _=h(i);v=M(_,u),_.forEach(c),T=N(x),y=g(x,"DIV",{class:!0});var f=h(y);m=g(f,"BUTTON",{class:!0,"data-svelte-h":!0}),ge(m)!=="svelte-1qxmt94"&&(m.textContent=w),C=N(f),b=g(f,"BUTTON",{class:!0,"data-svelte-h":!0}),ge(b)!=="svelte-1rmf90w"&&(b.textContent=k),f.forEach(c),x.forEach(c),L.forEach(c),this.h()},h(){a(l,"class","text-xl font-semibold text-gray-900 dark:text-gray-100 mb-4"),a(i,"class","text-gray-700 dark:text-gray-300 mb-6"),a(m,"class","px-4 py-2 rounded-md bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-600 transition"),a(b,"class","px-4 py-2 rounded-md bg-blue-600 text-white hover:bg-blue-700 transition"),a(y,"class","flex justify-end space-x-4"),a(t,"class","bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full p-6"),a(e,"class","fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50")},m(S,L){z(S,e,L),r(e,t),r(t,l),r(l,n),r(t,d),r(t,i),r(i,v),r(t,T),r(t,y),r(y,m),r(y,C),r(y,b),I||(P=[ue(m,"click",function(){Ne(o[11].onCancel)&&o[11].onCancel.apply(this,arguments)}),ue(b,"click",function(){Ne(o[11].onConfirm)&&o[11].onConfirm.apply(this,arguments)})],I=!0)},p(S,L){o=S,L[0]&2048&&s!==(s=o[11].title+"")&&R(n,s),L[0]&2048&&u!==(u=o[11].message+"")&&R(v,u)},d(S){S&&c(e),I=!1,He(P)}}}function jt(o){let e,t,l,s,n,d='<div class="m-auto self-center"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="size-5"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25H12"></path></svg></div>',i,u,v=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5L8.25 12l7.5-7.5"></path></svg>
          Back`,T,y,m=o[13].t("Excel To SQL Management")+"",w,C,b,k,I,P,S,L=o[13].t("Refresh")+"",x,V,_,f,Q,D,U,j,O,Y;const $=[wt,Et],J=[];function X(A,K){return A[3]?1:0}f=X(o),Q=J[f]=$[f](o);let q=o[10]&&lt(o);return{c(){e=p("div"),t=p("div"),l=p("div"),s=p("div"),n=p("button"),n.innerHTML=d,i=H(),u=p("a"),u.innerHTML=v,T=H(),y=p("h2"),w=F(m),C=H(),b=p("button"),k=se("svg"),I=se("path"),P=H(),S=p("span"),x=F(L),V=H(),_=p("div"),Q.c(),D=H(),q&&q.c(),U=Ue(),this.h()},l(A){e=g(A,"DIV",{class:!0});var K=h(e);t=g(K,"DIV",{class:!0});var ae=h(t);l=g(ae,"DIV",{class:!0});var te=h(l);s=g(te,"DIV",{class:!0});var re=h(s);n=g(re,"BUTTON",{class:!0,"aria-label":!0,"data-svelte-h":!0}),ge(n)!=="svelte-1141mtx"&&(n.innerHTML=d),i=N(re),u=g(re,"A",{href:!0,class:!0,"data-svelte-h":!0}),ge(u)!=="svelte-bddq2y"&&(u.innerHTML=v),T=N(re),y=g(re,"H2",{class:!0});var de=h(y);w=M(de,m),de.forEach(c),re.forEach(c),C=N(te),b=g(te,"BUTTON",{class:!0});var oe=h(b);k=le(oe,"svg",{xmlns:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0,class:!0});var ie=h(k);I=le(ie,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),h(I).forEach(c),ie.forEach(c),P=N(oe),S=g(oe,"SPAN",{});var E=h(S);x=M(E,L),E.forEach(c),oe.forEach(c),te.forEach(c),ae.forEach(c),V=N(K),_=g(K,"DIV",{class:!0});var B=h(_);Q.l(B),B.forEach(c),K.forEach(c),D=N(A),q&&q.l(A),U=Ue(),this.h()},h(){a(n,"class","cursor-pointer p-[7px] flex rounded-xl hover:bg-gray-100 dark:hover:bg-gray-900 transition"),a(n,"aria-label","Toggle Sidebar"),a(u,"href","/"),a(u,"class","back-button svelte-1310t73"),a(y,"class","header-title svelte-1310t73"),a(s,"class","header-left svelte-1310t73"),a(I,"stroke-linecap","round"),a(I,"stroke-linejoin","round"),a(I,"d","M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"),a(k,"xmlns","http://www.w3.org/2000/svg"),a(k,"viewBox","0 0 24 24"),a(k,"fill","none"),a(k,"stroke","currentColor"),a(k,"stroke-width","2"),a(k,"class","w-5 h-5"),a(b,"class","flex items-center space-x-2 px-3 py-2 rounded-lg bg-blue-600 hover:bg-blue-700 transition"),a(l,"class","header-title-row svelte-1310t73"),a(t,"class","management-header bg-gray-900 dark:bg-gray-950 text-white svelte-1310t73"),a(_,"class","management-content bg-white dark:bg-gray-900 svelte-1310t73"),a(e,"class","excel-management-container svelte-1310t73")},m(A,K){z(A,e,K),r(e,t),r(t,l),r(l,s),r(s,n),r(s,i),r(s,u),r(s,T),r(s,y),r(y,w),r(l,C),r(l,b),r(b,k),r(k,I),r(b,P),r(b,S),r(S,x),r(e,V),r(e,_),J[f].m(_,null),z(A,D,K),q&&q.m(A,K),z(A,U,K),j=!0,O||(Y=[ue(n,"click",o[23]),ue(b,"click",o[15])],O=!0)},p(A,K){(!j||K[0]&8192)&&m!==(m=A[13].t("Excel To SQL Management")+"")&&R(w,m),(!j||K[0]&8192)&&L!==(L=A[13].t("Refresh")+"")&&R(x,L);let ae=f;f=X(A),f===ae?J[f].p(A,K):(Ie(),pe(J[ae],1,1,()=>{J[ae]=null}),Ce(),Q=J[f],Q?Q.p(A,K):(Q=J[f]=$[f](A),Q.c()),be(Q,1),Q.m(_,null)),A[10]?q?q.p(A,K):(q=lt(A),q.c(),q.m(U.parentNode,U)):q&&(q.d(1),q=null)},i(A){j||(be(Q),j=!0)},o(A){pe(Q),j=!1},d(A){A&&(c(e),c(D),c(U)),J[f].d(),q&&q.d(A),O=!1,He(Y)}}}function st(o){return o.endsWith(".xlsx")||o.endsWith(".xls")?"SpreadsheetDocument":o.endsWith(".csv")?"TextDocument":"Page"}function Mt(o,e,t){let l,s;const n=ut("i18n");dt(o,n,E=>t(13,s=E));let d=!0,i=[],u=null,v={},T={},y="",m=null,w={},C=[],b=!1,k=!1,I=kt,P="token_59b8b43a_aiurmmm0",S="en",L=!1,x={title:"",message:"",onConfirm:()=>{},onCancel:()=>{}};ft(async()=>{try{console.log("Loading API configuration...");const E=await mt(n);I=I,P=E.userToken||P,S=E.languageLocal||S,console.log("Excel-to-SQL page - API Config loaded:",{base_url:I,language_local:S,user_token:P})}catch(E){console.error("Error loading API configuration:",E)}await _()});async function V(E,B={}){const W=`${I}/proxy/api${E}`;console.log(`[ExcelToSQL Debug] Sending request to ${W}`);const ne={method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${P}`,"Accept-Language":S}},me={...ne,...B,headers:{...ne.headers,...B.headers||{}}};console.log("[ExcelToSQL Debug] Full request options:",me);try{const fe=await fetch(W,me);console.log(`[ExcelToSQL Debug] Response status: ${fe.status}`);try{const ee=await fe.json();if(console.log("[ExcelToSQL Debug] RAW API RESPONSE:",JSON.stringify(ee,null,2)),!fe.ok)throw console.error(`[ExcelToSQL Debug] Request failed with status ${fe.status}:`,ee),new Error(ee.error||ee.detail||"An error occurred");return ee}catch(ee){console.error("[ExcelToSQL Debug] Failed to parse JSON response:",ee);const ke=await fe.text();throw console.error("[ExcelToSQL Debug] Text response:",ke),new Error("Invalid JSON response from server")}}catch(fe){throw console.error("[ExcelToSQL Debug] API request failed:",fe),fe}}async function _(){console.log("[ExcelToSQL Debug] Loading files list"),t(2,d=!0);try{const E=await V("/excel_to_sql/list_files",{method:"GET"});if(console.log("[ExcelToSQL Debug] Files loaded:",E),E.success&&E.files){console.log("[ExcelToSQL Debug] LIST_FILES SUCCESS - File count:",E.files.length),console.log("[ExcelToSQL Debug] LIST_FILES DETAILED:",JSON.stringify(E.files,null,2));const B=E.files.map((W,ne)=>({key:ne.toString(),id:W.id||ne.toString(),name:W.original_filename,savedPath:W.saved_path,dateUploaded:new Date(W.created_at||Date.now()).toLocaleString(),tableCount:(W.tables||[]).length,tables:W.tables||[],mappingId:W.mapping_id}));console.log("[ExcelToSQL Debug] Formatted files:",B),t(0,i=B)}else console.error("[ExcelToSQL Debug] Failed to load files:",E),ce.error("Failed to load Excel files")}catch(E){console.error("[ExcelToSQL Debug] Error loading Excel files:",E),ce.error(`Error loading Excel files: ${E.message}`),t(0,i=[])}finally{t(2,d=!1)}}function f(E,B,W){t(11,x={title:E,message:B,onConfirm:()=>{W(),t(10,L=!1)},onCancel:()=>{t(10,L=!1)}}),t(10,L=!0)}async function Q(E){console.log("[ExcelToSQL Debug] Attempting to delete file:",E),f("Delete File",`Are you sure you want to delete the file "${E.name}"?`,async()=>{t(2,d=!0);try{console.log("[ExcelToSQL Debug] Confirmed file deletion for:",E.savedPath);const B=await V("/excel_to_sql/delete_file",{method:"POST",body:JSON.stringify({file_path:E.savedPath})});console.log("[ExcelToSQL Debug] Delete file response:",B),B.success?(ce.success(`File "${E.name}" deleted successfully`),console.log("[ExcelToSQL Debug] File deleted successfully, reloading file list"),await _(),u&&u.id===E.id&&(console.log("[ExcelToSQL Debug] Clearing selected file as it was deleted"),t(3,u=null))):(console.error("[ExcelToSQL Debug] Failed to delete file:",B.error),ce.error(`Failed to delete file: ${B.error}`))}catch(B){console.error("[ExcelToSQL Debug] Error deleting file:",B),ce.error(`Error deleting file: ${B.message}`)}finally{t(2,d=!1)}})}function D(E){console.log("[ExcelToSQL Debug] Viewing file details:",E),t(3,u=E),t(4,v={}),t(5,T={}),t(6,m=null),w={},t(9,k=!1),t(8,b=!1)}async function U(E){console.log("[ExcelToSQL Debug] Loading table data for:",E.table_name),t(6,m=E),t(5,T[E.table_name]=!0,T),t(9,k=!1),t(8,b=!1);try{const B=await V("/excel_to_sql/get_table_data",{method:"POST",body:JSON.stringify({table_name:E.table_name})});if(console.log("[ExcelToSQL Debug] Table data response:",B),B.success){console.log("[ExcelToSQL Debug] Table data loaded successfully:",B.data),t(4,v[E.table_name]=B.data||{},v);const W={};B.data&&B.data.rows&&B.data.rows.forEach((ne,me)=>{W[me]={...ne}}),w=W,B.data&&B.data.columns&&(t(7,C=B.data.columns.map(ne=>ne.name)),console.log("[ExcelToSQL Debug] Selected columns:",C))}else console.error("[ExcelToSQL Debug] Failed to load table data:",B.error),ce.error(`Failed to load table data: ${B.error}`)}catch(B){console.error("[ExcelToSQL Debug] Error loading table data:",B),ce.error(`Error loading table data: ${B.message}`)}finally{t(5,T[E.table_name]=!1,T)}}function j(E,B,W){console.log(`[ExcelToSQL Debug] Editing cell: row ${E}, column ${B}, value:`,W),w[E]={...w[E],[B]:W},t(8,b=!0)}async function O(){if(m){console.log("[ExcelToSQL Debug] Saving edited data for table:",m.table_name);try{t(2,d=!0);const E=Object.values(w);console.log("[ExcelToSQL Debug] Rows to save:",E),console.log("[ExcelToSQL Debug] Columns to include:",C);const B={table_name:m.table_name,rows:E,columns:C};console.log("[ExcelToSQL Debug] Save request payload:",B);const W=await V("/excel_to_sql/update_table_data",{method:"POST",body:JSON.stringify(B)});console.log("[ExcelToSQL Debug] Save response:",W),W.success?(console.log("[ExcelToSQL Debug] Data saved successfully"),ce.success(`Successfully saved changes to ${m.table_name}`),t(8,b=!1),console.log("[ExcelToSQL Debug] Reloading table data after save"),await U(m),t(9,k=!1)):(console.error("[ExcelToSQL Debug] Failed to save changes:",W.error),ce.error(`Failed to save changes: ${W.error}`))}catch(E){console.error("[ExcelToSQL Debug] Error saving data:",E),ce.error(`Error saving data: ${E.message}`)}finally{t(2,d=!1)}}}async function Y(E){console.log("[ExcelToSQL Debug] Requesting to delete table:",E.table_name),f("Delete Table",`Are you sure you want to delete the table "${E.table_name}"?`,async()=>{try{console.log("[ExcelToSQL Debug] Confirmed table deletion for:",E.table_name);const B=await V("/excel_to_sql/delete_table",{method:"POST",body:JSON.stringify({table_name:E.table_name})});if(console.log("[ExcelToSQL Debug] Delete table response:",B),B.success){if(console.log("[ExcelToSQL Debug] Table deleted successfully"),ce.success(`Table "${E.table_name}" deleted successfully`),u){const W=u.tables.filter(ne=>ne.table_name!==E.table_name);console.log("[ExcelToSQL Debug] Updated tables list after deletion:",W),t(3,u={...u,tables:W,tableCount:W.length}),m&&m.table_name===E.table_name&&(console.log("[ExcelToSQL Debug] Clearing selected table as it was deleted"),t(6,m=null))}}else console.error("[ExcelToSQL Debug] Failed to delete table:",B.error),ce.error(`Failed to delete table: ${B.error}`)}catch(B){console.error("[ExcelToSQL Debug] Error deleting table:",B),ce.error(`Error deleting table: ${B.message}`)}})}function $(){bt.update(E=>!E)}function J(){y=this.value,t(1,y)}const X=E=>D(E),q=E=>Q(E),A=()=>{m?(t(6,m=null),t(9,k=!1)):t(3,u=null)},K=E=>U(E),ae=()=>Y(m),te=()=>t(9,k=!0),re=()=>{f("Cancel Editing","Are you sure you want to cancel? All unsaved changes will be lost.",()=>{t(9,k=!1),U(m)})},de=E=>C.includes(E.name),oe=E=>C.includes(E.name),ie=(E,B,W)=>{k&&j(E,B.name,W.target.innerText)};return o.$$.update=()=>{o.$$.dirty[0]&3&&t(12,l=i.filter(E=>y===""||E.name.toLowerCase().includes(y.toLowerCase())))},[i,y,d,u,v,T,m,C,b,k,L,x,l,s,n,_,f,Q,D,U,j,O,Y,$,J,X,q,A,K,ae,te,re,de,oe,ie]}class Yt extends vt{constructor(e){super(),_t(this,e,Mt,jt,ct,{},null,[-1,-1])}}export{Yt as component};
//# sourceMappingURL=19.Dwgn6WWF.js.map
